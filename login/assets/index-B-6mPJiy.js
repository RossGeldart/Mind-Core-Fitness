const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-CCVPrbJC.js","assets/Dashboard-BI21Q1GR.css","assets/AddClient-BzTijwV3.js","assets/AddClient-DH1OFzHo.css","assets/ClientForms-BSrDjP_G.js","assets/ClientForms-GDNtnrAx.css","assets/ClientTools-CYsUpTej.js","assets/ClientTools-DQRPoST3.css","assets/MacroCalculator-jYn2G75o.js","assets/ProteinSnacks-BdKppL5t.js","assets/DailyMotivation-Ds-cdc9r.js","assets/CircuitDashboard-suAndDHq.js","assets/CircuitDashboard-MPNVarsJ.css","assets/CircuitBooking-C0izvzR4.js","assets/CircuitBooking-ruk9Q4Wj.css","assets/Leaderboard-CVGQN7gh.js","assets/Leaderboard-Dq-r5svP.css","assets/UpgradePage-CCwOAvfF.js","assets/stripe-De72hcKj.js","assets/UpgradePage-BB1WAf13.css","assets/Onboarding-WSk1T9SY.js","assets/Onboarding-Ivvu2oeT.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function t(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(o){if(o.ep)return;o.ep=!0;const c=t(o);fetch(o.href,c)}})();var jy={exports:{}},yh={};var uw;function FA(){if(uw)return yh;uw=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(s,o,c){var u=null;if(c!==void 0&&(u=""+c),o.key!==void 0&&(u=""+o.key),"key"in o){c={};for(var d in o)d!=="key"&&(c[d]=o[d])}else c=o;return o=c.ref,{$$typeof:n,type:s,key:u,ref:o!==void 0?o:null,props:c}}return yh.Fragment=e,yh.jsx=t,yh.jsxs=t,yh}var hw;function zA(){return hw||(hw=1,jy.exports=FA()),jy.exports}var a=zA(),Ny={exports:{}},Xt={};var dw;function qA(){if(dw)return Xt;dw=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),u=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),T=Symbol.iterator;function N(O){return O===null||typeof O!="object"?null:(O=T&&O[T]||O["@@iterator"],typeof O=="function"?O:null)}var B={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},M=Object.assign,P={};function Y(O,K,Te){this.props=O,this.context=K,this.refs=P,this.updater=Te||B}Y.prototype.isReactComponent={},Y.prototype.setState=function(O,K){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,K,"setState")},Y.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function $(){}$.prototype=Y.prototype;function J(O,K,Te){this.props=O,this.context=K,this.refs=P,this.updater=Te||B}var de=J.prototype=new $;de.constructor=J,M(de,Y.prototype),de.isPureReactComponent=!0;var Ne=Array.isArray;function we(){}var A={H:null,A:null,T:null,S:null},S=Object.prototype.hasOwnProperty;function D(O,K,Te){var Re=Te.ref;return{$$typeof:n,type:O,key:K,ref:Re!==void 0?Re:null,props:Te}}function U(O,K){return D(O.type,K,O.props)}function V(O){return typeof O=="object"&&O!==null&&O.$$typeof===n}function q(O){var K={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(Te){return K[Te]})}var L=/\/+/g;function He(O,K){return typeof O=="object"&&O!==null&&O.key!=null?q(""+O.key):K.toString(36)}function xt(O){switch(O.status){case"fulfilled":return O.value;case"rejected":throw O.reason;default:switch(typeof O.status=="string"?O.then(we,we):(O.status="pending",O.then(function(K){O.status==="pending"&&(O.status="fulfilled",O.value=K)},function(K){O.status==="pending"&&(O.status="rejected",O.reason=K)})),O.status){case"fulfilled":return O.value;case"rejected":throw O.reason}}throw O}function H(O,K,Te,Re,Ge){var Me=typeof O;(Me==="undefined"||Me==="boolean")&&(O=null);var ut=!1;if(O===null)ut=!0;else switch(Me){case"bigint":case"string":case"number":ut=!0;break;case"object":switch(O.$$typeof){case n:case e:ut=!0;break;case b:return ut=O._init,H(ut(O._payload),K,Te,Re,Ge)}}if(ut)return Ge=Ge(O),ut=Re===""?"."+He(O,0):Re,Ne(Ge)?(Te="",ut!=null&&(Te=ut.replace(L,"$&/")+"/"),H(Ge,K,Te,"",function(qt){return qt})):Ge!=null&&(V(Ge)&&(Ge=U(Ge,Te+(Ge.key==null||O&&O.key===Ge.key?"":(""+Ge.key).replace(L,"$&/")+"/")+ut)),K.push(Ge)),1;ut=0;var gt=Re===""?".":Re+":";if(Ne(O))for(var et=0;et<O.length;et++)Re=O[et],Me=gt+He(Re,et),ut+=H(Re,K,Te,Me,Ge);else if(et=N(O),typeof et=="function")for(O=et.call(O),et=0;!(Re=O.next()).done;)Re=Re.value,Me=gt+He(Re,et++),ut+=H(Re,K,Te,Me,Ge);else if(Me==="object"){if(typeof O.then=="function")return H(xt(O),K,Te,Re,Ge);throw K=String(O),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.")}return ut}function ye(O,K,Te){if(O==null)return O;var Re=[],Ge=0;return H(O,Re,"","",function(Me){return K.call(Te,Me,Ge++)}),Re}function Ve(O){if(O._status===-1){var K=O._result;K=K(),K.then(function(Te){(O._status===0||O._status===-1)&&(O._status=1,O._result=Te)},function(Te){(O._status===0||O._status===-1)&&(O._status=2,O._result=Te)}),O._status===-1&&(O._status=0,O._result=K)}if(O._status===1)return O._result.default;throw O._result}var Ke=typeof reportError=="function"?reportError:function(O){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var K=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof O=="object"&&O!==null&&typeof O.message=="string"?String(O.message):String(O),error:O});if(!window.dispatchEvent(K))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",O);return}console.error(O)},ne={map:ye,forEach:function(O,K,Te){ye(O,function(){K.apply(this,arguments)},Te)},count:function(O){var K=0;return ye(O,function(){K++}),K},toArray:function(O){return ye(O,function(K){return K})||[]},only:function(O){if(!V(O))throw Error("React.Children.only expected to receive a single React element child.");return O}};return Xt.Activity=x,Xt.Children=ne,Xt.Component=Y,Xt.Fragment=t,Xt.Profiler=o,Xt.PureComponent=J,Xt.StrictMode=s,Xt.Suspense=p,Xt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,Xt.__COMPILER_RUNTIME={__proto__:null,c:function(O){return A.H.useMemoCache(O)}},Xt.cache=function(O){return function(){return O.apply(null,arguments)}},Xt.cacheSignal=function(){return null},Xt.cloneElement=function(O,K,Te){if(O==null)throw Error("The argument must be a React element, but you passed "+O+".");var Re=M({},O.props),Ge=O.key;if(K!=null)for(Me in K.key!==void 0&&(Ge=""+K.key),K)!S.call(K,Me)||Me==="key"||Me==="__self"||Me==="__source"||Me==="ref"&&K.ref===void 0||(Re[Me]=K[Me]);var Me=arguments.length-2;if(Me===1)Re.children=Te;else if(1<Me){for(var ut=Array(Me),gt=0;gt<Me;gt++)ut[gt]=arguments[gt+2];Re.children=ut}return D(O.type,Ge,Re)},Xt.createContext=function(O){return O={$$typeof:u,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null},O.Provider=O,O.Consumer={$$typeof:c,_context:O},O},Xt.createElement=function(O,K,Te){var Re,Ge={},Me=null;if(K!=null)for(Re in K.key!==void 0&&(Me=""+K.key),K)S.call(K,Re)&&Re!=="key"&&Re!=="__self"&&Re!=="__source"&&(Ge[Re]=K[Re]);var ut=arguments.length-2;if(ut===1)Ge.children=Te;else if(1<ut){for(var gt=Array(ut),et=0;et<ut;et++)gt[et]=arguments[et+2];Ge.children=gt}if(O&&O.defaultProps)for(Re in ut=O.defaultProps,ut)Ge[Re]===void 0&&(Ge[Re]=ut[Re]);return D(O,Me,Ge)},Xt.createRef=function(){return{current:null}},Xt.forwardRef=function(O){return{$$typeof:d,render:O}},Xt.isValidElement=V,Xt.lazy=function(O){return{$$typeof:b,_payload:{_status:-1,_result:O},_init:Ve}},Xt.memo=function(O,K){return{$$typeof:g,type:O,compare:K===void 0?null:K}},Xt.startTransition=function(O){var K=A.T,Te={};A.T=Te;try{var Re=O(),Ge=A.S;Ge!==null&&Ge(Te,Re),typeof Re=="object"&&Re!==null&&typeof Re.then=="function"&&Re.then(we,Ke)}catch(Me){Ke(Me)}finally{K!==null&&Te.types!==null&&(K.types=Te.types),A.T=K}},Xt.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},Xt.use=function(O){return A.H.use(O)},Xt.useActionState=function(O,K,Te){return A.H.useActionState(O,K,Te)},Xt.useCallback=function(O,K){return A.H.useCallback(O,K)},Xt.useContext=function(O){return A.H.useContext(O)},Xt.useDebugValue=function(){},Xt.useDeferredValue=function(O,K){return A.H.useDeferredValue(O,K)},Xt.useEffect=function(O,K){return A.H.useEffect(O,K)},Xt.useEffectEvent=function(O){return A.H.useEffectEvent(O)},Xt.useId=function(){return A.H.useId()},Xt.useImperativeHandle=function(O,K,Te){return A.H.useImperativeHandle(O,K,Te)},Xt.useInsertionEffect=function(O,K){return A.H.useInsertionEffect(O,K)},Xt.useLayoutEffect=function(O,K){return A.H.useLayoutEffect(O,K)},Xt.useMemo=function(O,K){return A.H.useMemo(O,K)},Xt.useOptimistic=function(O,K){return A.H.useOptimistic(O,K)},Xt.useReducer=function(O,K,Te){return A.H.useReducer(O,K,Te)},Xt.useRef=function(O){return A.H.useRef(O)},Xt.useState=function(O){return A.H.useState(O)},Xt.useSyncExternalStore=function(O,K,Te){return A.H.useSyncExternalStore(O,K,Te)},Xt.useTransition=function(){return A.H.useTransition()},Xt.version="19.2.4",Xt}var fw;function sv(){return fw||(fw=1,Ny.exports=qA()),Ny.exports}var _=sv(),Ay={exports:{}},bh={},Ry={exports:{}},Cy={};var mw;function $A(){return mw||(mw=1,(function(n){function e(H,ye){var Ve=H.length;H.push(ye);e:for(;0<Ve;){var Ke=Ve-1>>>1,ne=H[Ke];if(0<o(ne,ye))H[Ke]=ye,H[Ve]=ne,Ve=Ke;else break e}}function t(H){return H.length===0?null:H[0]}function s(H){if(H.length===0)return null;var ye=H[0],Ve=H.pop();if(Ve!==ye){H[0]=Ve;e:for(var Ke=0,ne=H.length,O=ne>>>1;Ke<O;){var K=2*(Ke+1)-1,Te=H[K],Re=K+1,Ge=H[Re];if(0>o(Te,Ve))Re<ne&&0>o(Ge,Te)?(H[Ke]=Ge,H[Re]=Ve,Ke=Re):(H[Ke]=Te,H[K]=Ve,Ke=K);else if(Re<ne&&0>o(Ge,Ve))H[Ke]=Ge,H[Re]=Ve,Ke=Re;else break e}}return ye}function o(H,ye){var Ve=H.sortIndex-ye.sortIndex;return Ve!==0?Ve:H.id-ye.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var u=Date,d=u.now();n.unstable_now=function(){return u.now()-d}}var p=[],g=[],b=1,x=null,T=3,N=!1,B=!1,M=!1,P=!1,Y=typeof setTimeout=="function"?setTimeout:null,$=typeof clearTimeout=="function"?clearTimeout:null,J=typeof setImmediate<"u"?setImmediate:null;function de(H){for(var ye=t(g);ye!==null;){if(ye.callback===null)s(g);else if(ye.startTime<=H)s(g),ye.sortIndex=ye.expirationTime,e(p,ye);else break;ye=t(g)}}function Ne(H){if(M=!1,de(H),!B)if(t(p)!==null)B=!0,we||(we=!0,q());else{var ye=t(g);ye!==null&&xt(Ne,ye.startTime-H)}}var we=!1,A=-1,S=5,D=-1;function U(){return P?!0:!(n.unstable_now()-D<S)}function V(){if(P=!1,we){var H=n.unstable_now();D=H;var ye=!0;try{e:{B=!1,M&&(M=!1,$(A),A=-1),N=!0;var Ve=T;try{t:{for(de(H),x=t(p);x!==null&&!(x.expirationTime>H&&U());){var Ke=x.callback;if(typeof Ke=="function"){x.callback=null,T=x.priorityLevel;var ne=Ke(x.expirationTime<=H);if(H=n.unstable_now(),typeof ne=="function"){x.callback=ne,de(H),ye=!0;break t}x===t(p)&&s(p),de(H)}else s(p);x=t(p)}if(x!==null)ye=!0;else{var O=t(g);O!==null&&xt(Ne,O.startTime-H),ye=!1}}break e}finally{x=null,T=Ve,N=!1}ye=void 0}}finally{ye?q():we=!1}}}var q;if(typeof J=="function")q=function(){J(V)};else if(typeof MessageChannel<"u"){var L=new MessageChannel,He=L.port2;L.port1.onmessage=V,q=function(){He.postMessage(null)}}else q=function(){Y(V,0)};function xt(H,ye){A=Y(function(){H(n.unstable_now())},ye)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(H){H.callback=null},n.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<H?Math.floor(1e3/H):5},n.unstable_getCurrentPriorityLevel=function(){return T},n.unstable_next=function(H){switch(T){case 1:case 2:case 3:var ye=3;break;default:ye=T}var Ve=T;T=ye;try{return H()}finally{T=Ve}},n.unstable_requestPaint=function(){P=!0},n.unstable_runWithPriority=function(H,ye){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var Ve=T;T=H;try{return ye()}finally{T=Ve}},n.unstable_scheduleCallback=function(H,ye,Ve){var Ke=n.unstable_now();switch(typeof Ve=="object"&&Ve!==null?(Ve=Ve.delay,Ve=typeof Ve=="number"&&0<Ve?Ke+Ve:Ke):Ve=Ke,H){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=Ve+ne,H={id:b++,callback:ye,priorityLevel:H,startTime:Ve,expirationTime:ne,sortIndex:-1},Ve>Ke?(H.sortIndex=Ve,e(g,H),t(p)===null&&H===t(g)&&(M?($(A),A=-1):M=!0,xt(Ne,Ve-Ke))):(H.sortIndex=ne,e(p,H),B||N||(B=!0,we||(we=!0,q()))),H},n.unstable_shouldYield=U,n.unstable_wrapCallback=function(H){var ye=T;return function(){var Ve=T;T=ye;try{return H.apply(this,arguments)}finally{T=Ve}}}})(Cy)),Cy}var pw;function HA(){return pw||(pw=1,Ry.exports=$A()),Ry.exports}var Iy={exports:{}},xr={};var gw;function WA(){if(gw)return xr;gw=1;var n=sv();function e(p){var g="https://react.dev/errors/"+p;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)g+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+p+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var s={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function c(p,g,b){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:x==null?null:""+x,children:p,containerInfo:g,implementation:b}}var u=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(p,g){if(p==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return xr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,xr.createPortal=function(p,g){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(e(299));return c(p,g,null,b)},xr.flushSync=function(p){var g=u.T,b=s.p;try{if(u.T=null,s.p=2,p)return p()}finally{u.T=g,s.p=b,s.d.f()}},xr.preconnect=function(p,g){typeof p=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,s.d.C(p,g))},xr.prefetchDNS=function(p){typeof p=="string"&&s.d.D(p)},xr.preinit=function(p,g){if(typeof p=="string"&&g&&typeof g.as=="string"){var b=g.as,x=d(b,g.crossOrigin),T=typeof g.integrity=="string"?g.integrity:void 0,N=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;b==="style"?s.d.S(p,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:x,integrity:T,fetchPriority:N}):b==="script"&&s.d.X(p,{crossOrigin:x,integrity:T,fetchPriority:N,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},xr.preinitModule=function(p,g){if(typeof p=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var b=d(g.as,g.crossOrigin);s.d.M(p,{crossOrigin:b,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&s.d.M(p)},xr.preload=function(p,g){if(typeof p=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var b=g.as,x=d(b,g.crossOrigin);s.d.L(p,b,{crossOrigin:x,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},xr.preloadModule=function(p,g){if(typeof p=="string")if(g){var b=d(g.as,g.crossOrigin);s.d.m(p,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:b,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else s.d.m(p)},xr.requestFormReset=function(p){s.d.r(p)},xr.unstable_batchedUpdates=function(p,g){return p(g)},xr.useFormState=function(p,g,b){return u.H.useFormState(p,g,b)},xr.useFormStatus=function(){return u.H.useHostTransitionStatus()},xr.version="19.2.4",xr}var yw;function GA(){if(yw)return Iy.exports;yw=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Iy.exports=WA(),Iy.exports}var bw;function KA(){if(bw)return bh;bw=1;var n=HA(),e=sv(),t=GA();function s(r){var i="https://react.dev/errors/"+r;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)i+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+r+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function c(r){var i=r,l=r;if(r.alternate)for(;i.return;)i=i.return;else{r=i;do i=r,(i.flags&4098)!==0&&(l=i.return),r=i.return;while(r)}return i.tag===3?l:null}function u(r){if(r.tag===13){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function d(r){if(r.tag===31){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function p(r){if(c(r)!==r)throw Error(s(188))}function g(r){var i=r.alternate;if(!i){if(i=c(r),i===null)throw Error(s(188));return i!==r?null:r}for(var l=r,h=i;;){var m=l.return;if(m===null)break;var y=m.alternate;if(y===null){if(h=m.return,h!==null){l=h;continue}break}if(m.child===y.child){for(y=m.child;y;){if(y===l)return p(m),r;if(y===h)return p(m),i;y=y.sibling}throw Error(s(188))}if(l.return!==h.return)l=m,h=y;else{for(var w=!1,j=m.child;j;){if(j===l){w=!0,l=m,h=y;break}if(j===h){w=!0,h=m,l=y;break}j=j.sibling}if(!w){for(j=y.child;j;){if(j===l){w=!0,l=y,h=m;break}if(j===h){w=!0,h=y,l=m;break}j=j.sibling}if(!w)throw Error(s(189))}}if(l.alternate!==h)throw Error(s(190))}if(l.tag!==3)throw Error(s(188));return l.stateNode.current===l?r:i}function b(r){var i=r.tag;if(i===5||i===26||i===27||i===6)return r;for(r=r.child;r!==null;){if(i=b(r),i!==null)return i;r=r.sibling}return null}var x=Object.assign,T=Symbol.for("react.element"),N=Symbol.for("react.transitional.element"),B=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),P=Symbol.for("react.strict_mode"),Y=Symbol.for("react.profiler"),$=Symbol.for("react.consumer"),J=Symbol.for("react.context"),de=Symbol.for("react.forward_ref"),Ne=Symbol.for("react.suspense"),we=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),U=Symbol.for("react.memo_cache_sentinel"),V=Symbol.iterator;function q(r){return r===null||typeof r!="object"?null:(r=V&&r[V]||r["@@iterator"],typeof r=="function"?r:null)}var L=Symbol.for("react.client.reference");function He(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===L?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case M:return"Fragment";case Y:return"Profiler";case P:return"StrictMode";case Ne:return"Suspense";case we:return"SuspenseList";case D:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case B:return"Portal";case J:return r.displayName||"Context";case $:return(r._context.displayName||"Context")+".Consumer";case de:var i=r.render;return r=r.displayName,r||(r=i.displayName||i.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case A:return i=r.displayName||null,i!==null?i:He(r.type)||"Memo";case S:i=r._payload,r=r._init;try{return He(r(i))}catch{}}return null}var xt=Array.isArray,H=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ye=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ve={pending:!1,data:null,method:null,action:null},Ke=[],ne=-1;function O(r){return{current:r}}function K(r){0>ne||(r.current=Ke[ne],Ke[ne]=null,ne--)}function Te(r,i){ne++,Ke[ne]=r.current,r.current=i}var Re=O(null),Ge=O(null),Me=O(null),ut=O(null);function gt(r,i){switch(Te(Me,i),Te(Ge,r),Te(Re,null),i.nodeType){case 9:case 11:r=(r=i.documentElement)&&(r=r.namespaceURI)?D_(r):0;break;default:if(r=i.tagName,i=i.namespaceURI)i=D_(i),r=P_(i,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}K(Re),Te(Re,r)}function et(){K(Re),K(Ge),K(Me)}function qt(r){r.memoizedState!==null&&Te(ut,r);var i=Re.current,l=P_(i,r.type);i!==l&&(Te(Ge,r),Te(Re,l))}function Dn(r){Ge.current===r&&(K(Re),K(Ge)),ut.current===r&&(K(ut),fh._currentValue=Ve)}var Vt,kt;function pe(r){if(Vt===void 0)try{throw Error()}catch(l){var i=l.stack.trim().match(/\n( *(at )?)/);Vt=i&&i[1]||"",kt=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Vt+r+kt}var ln=!1;function sn(r,i){if(!r||ln)return"";ln=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(i){var Pe=function(){throw Error()};if(Object.defineProperty(Pe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Pe,[])}catch(ge){var ue=ge}Reflect.construct(r,[],Pe)}else{try{Pe.call()}catch(ge){ue=ge}r.call(Pe.prototype)}}else{try{throw Error()}catch(ge){ue=ge}(Pe=r())&&typeof Pe.catch=="function"&&Pe.catch(function(){})}}catch(ge){if(ge&&ue&&typeof ge.stack=="string")return[ge.stack,ue.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=h.DetermineComponentFrameRoot(),w=y[0],j=y[1];if(w&&j){var F=w.split(`
`),le=j.split(`
`);for(m=h=0;h<F.length&&!F[h].includes("DetermineComponentFrameRoot");)h++;for(;m<le.length&&!le[m].includes("DetermineComponentFrameRoot");)m++;if(h===F.length||m===le.length)for(h=F.length-1,m=le.length-1;1<=h&&0<=m&&F[h]!==le[m];)m--;for(;1<=h&&0<=m;h--,m--)if(F[h]!==le[m]){if(h!==1||m!==1)do if(h--,m--,0>m||F[h]!==le[m]){var je=`
`+F[h].replace(" at new "," at ");return r.displayName&&je.includes("<anonymous>")&&(je=je.replace("<anonymous>",r.displayName)),je}while(1<=h&&0<=m);break}}}finally{ln=!1,Error.prepareStackTrace=l}return(l=r?r.displayName||r.name:"")?pe(l):""}function dt(r,i){switch(r.tag){case 26:case 27:case 5:return pe(r.type);case 16:return pe("Lazy");case 13:return r.child!==i&&i!==null?pe("Suspense Fallback"):pe("Suspense");case 19:return pe("SuspenseList");case 0:case 15:return sn(r.type,!1);case 11:return sn(r.type.render,!1);case 1:return sn(r.type,!0);case 31:return pe("Activity");default:return""}}function St(r){try{var i="",l=null;do i+=dt(r,l),l=r,r=r.return;while(r);return i}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var ct=Object.prototype.hasOwnProperty,it=n.unstable_scheduleCallback,Jt=n.unstable_cancelCallback,Is=n.unstable_shouldYield,Ct=n.unstable_requestPaint,un=n.unstable_now,ds=n.unstable_getCurrentPriorityLevel,Kt=n.unstable_ImmediatePriority,Pn=n.unstable_UserBlockingPriority,hn=n.unstable_NormalPriority,Rn=n.unstable_LowPriority,he=n.unstable_IdlePriority,De=n.log,Be=n.unstable_setDisableYieldValue,tt=null,Fe=null;function Le(r){if(typeof De=="function"&&Be(r),Fe&&typeof Fe.setStrictMode=="function")try{Fe.setStrictMode(tt,r)}catch{}}var ze=Math.clz32?Math.clz32:It,Tt=Math.log,bt=Math.LN2;function It(r){return r>>>=0,r===0?32:31-(Tt(r)/bt|0)|0}var Qt=256,ee=262144,ve=4194304;function at(r){var i=r&42;if(i!==0)return i;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Dt(r,i,l){var h=r.pendingLanes;if(h===0)return 0;var m=0,y=r.suspendedLanes,w=r.pingedLanes;r=r.warmLanes;var j=h&134217727;return j!==0?(h=j&~y,h!==0?m=at(h):(w&=j,w!==0?m=at(w):l||(l=j&~r,l!==0&&(m=at(l))))):(j=h&~y,j!==0?m=at(j):w!==0?m=at(w):l||(l=h&~r,l!==0&&(m=at(l)))),m===0?0:i!==0&&i!==m&&(i&y)===0&&(y=m&-m,l=i&-i,y>=l||y===32&&(l&4194048)!==0)?i:m}function jt(r,i){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&i)===0}function rn(r,i){switch(r){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Yt(){var r=ve;return ve<<=1,(ve&62914560)===0&&(ve=4194304),r}function $t(r){for(var i=[],l=0;31>l;l++)i.push(r);return i}function Mn(r,i){r.pendingLanes|=i,i!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function rs(r,i,l,h,m,y){var w=r.pendingLanes;r.pendingLanes=l,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=l,r.entangledLanes&=l,r.errorRecoveryDisabledLanes&=l,r.shellSuspendCounter=0;var j=r.entanglements,F=r.expirationTimes,le=r.hiddenUpdates;for(l=w&~l;0<l;){var je=31-ze(l),Pe=1<<je;j[je]=0,F[je]=-1;var ue=le[je];if(ue!==null)for(le[je]=null,je=0;je<ue.length;je++){var ge=ue[je];ge!==null&&(ge.lane&=-536870913)}l&=~Pe}h!==0&&bn(r,h,0),y!==0&&m===0&&r.tag!==0&&(r.suspendedLanes|=y&~(w&~i))}function bn(r,i,l){r.pendingLanes|=i,r.suspendedLanes&=~i;var h=31-ze(i);r.entangledLanes|=i,r.entanglements[h]=r.entanglements[h]|1073741824|l&261930}function Cn(r,i){var l=r.entangledLanes|=i;for(r=r.entanglements;l;){var h=31-ze(l),m=1<<h;m&i|r[h]&i&&(r[h]|=i),l&=~m}}function Bn(r,i){var l=i&-i;return l=(l&42)!==0?1:z(l),(l&(r.suspendedLanes|i))!==0?0:l}function z(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function xe(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function ke(){var r=ye.p;return r!==0?r:(r=window.event,r===void 0?32:sw(r.type))}function Se(r,i){var l=ye.p;try{return ye.p=r,i()}finally{ye.p=l}}var be=Math.random().toString(36).slice(2),rt="__reactFiber$"+be,Rt="__reactProps$"+be,ot="__reactContainer$"+be,vt="__reactEvents$"+be,Nt="__reactListeners$"+be,mn="__reactHandles$"+be,er="__reactResources$"+be,Ts="__reactMarker$"+be;function Ds(r){delete r[rt],delete r[Rt],delete r[vt],delete r[Nt],delete r[mn]}function ts(r){var i=r[rt];if(i)return i;for(var l=r.parentNode;l;){if(i=l[ot]||l[rt]){if(l=i.alternate,i.child!==null||l!==null&&l.child!==null)for(r=F_(r);r!==null;){if(l=r[rt])return l;r=F_(r)}return i}r=l,l=r.parentNode}return null}function W(r){if(r=r[rt]||r[ot]){var i=r.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return r}return null}function fe(r){var i=r.tag;if(i===5||i===26||i===27||i===6)return r.stateNode;throw Error(s(33))}function k(r){var i=r[er];return i||(i=r[er]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function C(r){r[Ts]=!0}var Q=new Set,ae={};function Ye(r,i){$e(r,i),$e(r+"Capture",i)}function $e(r,i){for(ae[r]=i,r=0;r<i.length;r++)Q.add(i[r])}var qe=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Gt={},Mt={};function Yn(r){return ct.call(Mt,r)?!0:ct.call(Gt,r)?!1:qe.test(r)?Mt[r]=!0:(Gt[r]=!0,!1)}function Gs(r,i,l){if(Yn(i))if(l===null)r.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":r.removeAttribute(i);return;case"boolean":var h=i.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){r.removeAttribute(i);return}}r.setAttribute(i,""+l)}}function Bs(r,i,l){if(l===null)r.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(i);return}r.setAttribute(i,""+l)}}function qn(r,i,l,h){if(h===null)r.removeAttribute(l);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(l);return}r.setAttributeNS(i,l,""+h)}}function $n(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function X(r){var i=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Ee(r,i,l){var h=Object.getOwnPropertyDescriptor(r.constructor.prototype,i);if(!r.hasOwnProperty(i)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var m=h.get,y=h.set;return Object.defineProperty(r,i,{configurable:!0,get:function(){return m.call(this)},set:function(w){l=""+w,y.call(this,w)}}),Object.defineProperty(r,i,{enumerable:h.enumerable}),{getValue:function(){return l},setValue:function(w){l=""+w},stopTracking:function(){r._valueTracker=null,delete r[i]}}}}function se(r){if(!r._valueTracker){var i=X(r)?"checked":"value";r._valueTracker=Ee(r,i,""+r[i])}}function Ue(r){if(!r)return!1;var i=r._valueTracker;if(!i)return!0;var l=i.getValue(),h="";return r&&(h=X(r)?r.checked?"true":"false":r.value),r=h,r!==l?(i.setValue(r),!0):!1}function We(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var ht=/[\n"\\]/g;function _t(r){return r.replace(ht,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function Ot(r,i,l,h,m,y,w,j){r.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?r.type=w:r.removeAttribute("type"),i!=null?w==="number"?(i===0&&r.value===""||r.value!=i)&&(r.value=""+$n(i)):r.value!==""+$n(i)&&(r.value=""+$n(i)):w!=="submit"&&w!=="reset"||r.removeAttribute("value"),i!=null?xs(r,w,$n(i)):l!=null?xs(r,w,$n(l)):h!=null&&r.removeAttribute("value"),m==null&&y!=null&&(r.defaultChecked=!!y),m!=null&&(r.checked=m&&typeof m!="function"&&typeof m!="symbol"),j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?r.name=""+$n(j):r.removeAttribute("name")}function En(r,i,l,h,m,y,w,j){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(r.type=y),i!=null||l!=null){if(!(y!=="submit"&&y!=="reset"||i!=null)){se(r);return}l=l!=null?""+$n(l):"",i=i!=null?""+$n(i):l,j||i===r.value||(r.value=i),r.defaultValue=i}h=h??m,h=typeof h!="function"&&typeof h!="symbol"&&!!h,r.checked=j?r.checked:!!h,r.defaultChecked=!!h,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(r.name=w),se(r)}function xs(r,i,l){i==="number"&&We(r.ownerDocument)===r||r.defaultValue===""+l||(r.defaultValue=""+l)}function vn(r,i,l,h){if(r=r.options,i){i={};for(var m=0;m<l.length;m++)i["$"+l[m]]=!0;for(l=0;l<r.length;l++)m=i.hasOwnProperty("$"+r[l].value),r[l].selected!==m&&(r[l].selected=m),m&&h&&(r[l].defaultSelected=!0)}else{for(l=""+$n(l),i=null,m=0;m<r.length;m++){if(r[m].value===l){r[m].selected=!0,h&&(r[m].defaultSelected=!0);return}i!==null||r[m].disabled||(i=r[m])}i!==null&&(i.selected=!0)}}function lr(r,i,l){if(i!=null&&(i=""+$n(i),i!==r.value&&(r.value=i),l==null)){r.defaultValue!==i&&(r.defaultValue=i);return}r.defaultValue=l!=null?""+$n(l):""}function ci(r,i,l,h){if(i==null){if(h!=null){if(l!=null)throw Error(s(92));if(xt(h)){if(1<h.length)throw Error(s(93));h=h[0]}l=h}l==null&&(l=""),i=l}l=$n(i),r.defaultValue=l,h=r.textContent,h===l&&h!==""&&h!==null&&(r.value=h),se(r)}function Es(r,i){if(i){var l=r.firstChild;if(l&&l===r.lastChild&&l.nodeType===3){l.nodeValue=i;return}}r.textContent=i}var Ui=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function tr(r,i,l){var h=i.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?h?r.setProperty(i,""):i==="float"?r.cssFloat="":r[i]="":h?r.setProperty(i,l):typeof l!="number"||l===0||Ui.has(i)?i==="float"?r.cssFloat=l:r[i]=(""+l).trim():r[i]=l+"px"}function cn(r,i,l){if(i!=null&&typeof i!="object")throw Error(s(62));if(r=r.style,l!=null){for(var h in l)!l.hasOwnProperty(h)||i!=null&&i.hasOwnProperty(h)||(h.indexOf("--")===0?r.setProperty(h,""):h==="float"?r.cssFloat="":r[h]="");for(var m in i)h=i[m],i.hasOwnProperty(m)&&l[m]!==h&&tr(r,m,h)}else for(var y in i)i.hasOwnProperty(y)&&tr(r,y,i[y])}function _s(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yr=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),cr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Pr(r){return cr.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function os(){}var Ks=null;function Us(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Mr=null,Lr=null;function Wr(r){var i=W(r);if(i&&(r=i.stateNode)){var l=r[Rt]||null;e:switch(r=i.stateNode,i.type){case"input":if(Ot(r,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),i=l.name,l.type==="radio"&&i!=null){for(l=r;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+_t(""+i)+'"][type="radio"]'),i=0;i<l.length;i++){var h=l[i];if(h!==r&&h.form===r.form){var m=h[Rt]||null;if(!m)throw Error(s(90));Ot(h,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(i=0;i<l.length;i++)h=l[i],h.form===r.form&&Ue(h)}break e;case"textarea":lr(r,l.value,l.defaultValue);break e;case"select":i=l.value,i!=null&&vn(r,!!l.multiple,i,!1)}}}var Wa=!1;function Fi(r,i,l){if(Wa)return r(i,l);Wa=!0;try{var h=r(i);return h}finally{if(Wa=!1,(Mr!==null||Lr!==null)&&(_f(),Mr&&(i=Mr,r=Lr,Lr=Mr=null,Wr(i),r)))for(i=0;i<r.length;i++)Wr(r[i])}}function Gr(r,i){var l=r.stateNode;if(l===null)return null;var h=l[Rt]||null;if(h===null)return null;l=h[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(r=r.type,h=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!h;break e;default:r=!1}if(r)return null;if(l&&typeof l!="function")throw Error(s(231,i,typeof l));return l}var I=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),te=!1;if(I)try{var Ae={};Object.defineProperty(Ae,"passive",{get:function(){te=!0}}),window.addEventListener("test",Ae,Ae),window.removeEventListener("test",Ae,Ae)}catch{te=!1}var nt=null,Et=null,Lt=null;function st(){if(Lt)return Lt;var r,i=Et,l=i.length,h,m="value"in nt?nt.value:nt.textContent,y=m.length;for(r=0;r<l&&i[r]===m[r];r++);var w=l-r;for(h=1;h<=w&&i[l-h]===m[y-h];h++);return Lt=m.slice(r,1<h?1-h:void 0)}function Ht(r){var i=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&i===13&&(r=13)):r=i,r===10&&(r=13),32<=r||r===13?r:0}function zt(){return!0}function en(){return!1}function Bt(r){function i(l,h,m,y,w){this._reactName=l,this._targetInst=m,this.type=h,this.nativeEvent=y,this.target=w,this.currentTarget=null;for(var j in r)r.hasOwnProperty(j)&&(l=r[j],this[j]=l?l(y):y[j]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?zt:en,this.isPropagationStopped=en,this}return x(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=zt)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=zt)},persist:function(){},isPersistent:zt}),i}var an={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ks=Bt(an),Qs=x({},an,{view:0,detail:0}),zn=Bt(Qs),Nn,fs,ls,Ys=x({},Qs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ga,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==ls&&(ls&&r.type==="mousemove"?(Nn=r.screenX-ls.screenX,fs=r.screenY-ls.screenY):fs=Nn=0,ls=r),Nn)},movementY:function(r){return"movementY"in r?r.movementY:fs}}),br=Bt(Ys),ur=x({},Ys,{dataTransfer:0}),kr=Bt(ur),vr=x({},Qs,{relatedTarget:0}),Ss=Bt(vr),Sr=x({},an,{animationName:0,elapsedTime:0,pseudoElement:0}),Vr=Bt(Sr),ca=x({},an,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),tc=Bt(ca),nc=x({},an,{data:0}),jr=Bt(nc),Ti={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ei={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Md={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ld(r){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(r):(r=Md[r])?!!i[r]:!1}function Ga(){return Ld}var Nr=x({},Qs,{key:function(r){if(r.key){var i=Ti[r.key]||r.key;if(i!=="Unidentified")return i}return r.type==="keypress"?(r=Ht(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Ei[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ga,charCode:function(r){return r.type==="keypress"?Ht(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Ht(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Vd=Bt(Nr),Od=x({},Ys,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ua=Bt(Od),f=x({},Qs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ga}),v=Bt(f),E=x({},an,{propertyName:0,elapsedTime:0,pseudoElement:0}),R=Bt(E),ie=x({},Ys,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),me=Bt(ie),Xe=x({},an,{newState:0,oldState:0}),tn=Bt(Xe),Ps=[9,13,27,32],Un=I&&"CompositionEvent"in window,ms=null;I&&"documentMode"in document&&(ms=document.documentMode);var ui=I&&"TextEvent"in window&&!ms,zi=I&&(!Un||ms&&8<ms&&11>=ms),ki=" ",Si=!1;function el(r,i){switch(r){case"keyup":return Ps.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sc(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var rc=!1;function hN(r,i){switch(r){case"compositionend":return sc(i);case"keypress":return i.which!==32?null:(Si=!0,ki);case"textInput":return r=i.data,r===ki&&Si?null:r;default:return null}}function dN(r,i){if(rc)return r==="compositionend"||!Un&&el(r,i)?(r=st(),Lt=Et=nt=null,rc=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return zi&&i.locale!=="ko"?null:i.data;default:return null}}var fN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $0(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i==="input"?!!fN[r.type]:i==="textarea"}function H0(r,i,l,h){Mr?Lr?Lr.push(h):Lr=[h]:Mr=h,i=Nf(i,"onChange"),0<i.length&&(l=new ks("onChange","change",null,l,h),r.push({event:l,listeners:i}))}var Mu=null,Lu=null;function mN(r){j_(r,0)}function Bd(r){var i=fe(r);if(Ue(i))return r}function W0(r,i){if(r==="change")return i}var G0=!1;if(I){var Pp;if(I){var Mp="oninput"in document;if(!Mp){var K0=document.createElement("div");K0.setAttribute("oninput","return;"),Mp=typeof K0.oninput=="function"}Pp=Mp}else Pp=!1;G0=Pp&&(!document.documentMode||9<document.documentMode)}function Q0(){Mu&&(Mu.detachEvent("onpropertychange",Y0),Lu=Mu=null)}function Y0(r){if(r.propertyName==="value"&&Bd(Lu)){var i=[];H0(i,Lu,r,Us(r)),Fi(mN,i)}}function pN(r,i,l){r==="focusin"?(Q0(),Mu=i,Lu=l,Mu.attachEvent("onpropertychange",Y0)):r==="focusout"&&Q0()}function gN(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Bd(Lu)}function yN(r,i){if(r==="click")return Bd(i)}function bN(r,i){if(r==="input"||r==="change")return Bd(i)}function vN(r,i){return r===i&&(r!==0||1/r===1/i)||r!==r&&i!==i}var Kr=typeof Object.is=="function"?Object.is:vN;function Vu(r,i){if(Kr(r,i))return!0;if(typeof r!="object"||r===null||typeof i!="object"||i===null)return!1;var l=Object.keys(r),h=Object.keys(i);if(l.length!==h.length)return!1;for(h=0;h<l.length;h++){var m=l[h];if(!ct.call(i,m)||!Kr(r[m],i[m]))return!1}return!0}function X0(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function J0(r,i){var l=X0(r);r=0;for(var h;l;){if(l.nodeType===3){if(h=r+l.textContent.length,r<=i&&h>=i)return{node:l,offset:i-r};r=h}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=X0(l)}}function Z0(r,i){return r&&i?r===i?!0:r&&r.nodeType===3?!1:i&&i.nodeType===3?Z0(r,i.parentNode):"contains"in r?r.contains(i):r.compareDocumentPosition?!!(r.compareDocumentPosition(i)&16):!1:!1}function e1(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var i=We(r.document);i instanceof r.HTMLIFrameElement;){try{var l=typeof i.contentWindow.location.href=="string"}catch{l=!1}if(l)r=i.contentWindow;else break;i=We(r.document)}return i}function Lp(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i&&(i==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||i==="textarea"||r.contentEditable==="true")}var xN=I&&"documentMode"in document&&11>=document.documentMode,ic=null,Vp=null,Ou=null,Op=!1;function t1(r,i,l){var h=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Op||ic==null||ic!==We(h)||(h=ic,"selectionStart"in h&&Lp(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Ou&&Vu(Ou,h)||(Ou=h,h=Nf(Vp,"onSelect"),0<h.length&&(i=new ks("onSelect","select",null,i,l),r.push({event:i,listeners:h}),i.target=ic)))}function tl(r,i){var l={};return l[r.toLowerCase()]=i.toLowerCase(),l["Webkit"+r]="webkit"+i,l["Moz"+r]="moz"+i,l}var ac={animationend:tl("Animation","AnimationEnd"),animationiteration:tl("Animation","AnimationIteration"),animationstart:tl("Animation","AnimationStart"),transitionrun:tl("Transition","TransitionRun"),transitionstart:tl("Transition","TransitionStart"),transitioncancel:tl("Transition","TransitionCancel"),transitionend:tl("Transition","TransitionEnd")},Bp={},n1={};I&&(n1=document.createElement("div").style,"AnimationEvent"in window||(delete ac.animationend.animation,delete ac.animationiteration.animation,delete ac.animationstart.animation),"TransitionEvent"in window||delete ac.transitionend.transition);function nl(r){if(Bp[r])return Bp[r];if(!ac[r])return r;var i=ac[r],l;for(l in i)if(i.hasOwnProperty(l)&&l in n1)return Bp[r]=i[l];return r}var s1=nl("animationend"),r1=nl("animationiteration"),i1=nl("animationstart"),_N=nl("transitionrun"),wN=nl("transitionstart"),TN=nl("transitioncancel"),a1=nl("transitionend"),o1=new Map,Up="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Up.push("scrollEnd");function ji(r,i){o1.set(r,i),Ye(i,[r])}var Ud=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},hi=[],oc=0,Fp=0;function Fd(){for(var r=oc,i=Fp=oc=0;i<r;){var l=hi[i];hi[i++]=null;var h=hi[i];hi[i++]=null;var m=hi[i];hi[i++]=null;var y=hi[i];if(hi[i++]=null,h!==null&&m!==null){var w=h.pending;w===null?m.next=m:(m.next=w.next,w.next=m),h.pending=m}y!==0&&l1(l,m,y)}}function zd(r,i,l,h){hi[oc++]=r,hi[oc++]=i,hi[oc++]=l,hi[oc++]=h,Fp|=h,r.lanes|=h,r=r.alternate,r!==null&&(r.lanes|=h)}function zp(r,i,l,h){return zd(r,i,l,h),qd(r)}function sl(r,i){return zd(r,null,null,i),qd(r)}function l1(r,i,l){r.lanes|=l;var h=r.alternate;h!==null&&(h.lanes|=l);for(var m=!1,y=r.return;y!==null;)y.childLanes|=l,h=y.alternate,h!==null&&(h.childLanes|=l),y.tag===22&&(r=y.stateNode,r===null||r._visibility&1||(m=!0)),r=y,y=y.return;return r.tag===3?(y=r.stateNode,m&&i!==null&&(m=31-ze(l),r=y.hiddenUpdates,h=r[m],h===null?r[m]=[i]:h.push(i),i.lane=l|536870912),y):null}function qd(r){if(50<ah)throw ah=0,Xg=null,Error(s(185));for(var i=r.return;i!==null;)r=i,i=r.return;return r.tag===3?r.stateNode:null}var lc={};function EN(r,i,l,h){this.tag=r,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qr(r,i,l,h){return new EN(r,i,l,h)}function qp(r){return r=r.prototype,!(!r||!r.isReactComponent)}function ha(r,i){var l=r.alternate;return l===null?(l=Qr(r.tag,i,r.key,r.mode),l.elementType=r.elementType,l.type=r.type,l.stateNode=r.stateNode,l.alternate=r,r.alternate=l):(l.pendingProps=i,l.type=r.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=r.flags&65011712,l.childLanes=r.childLanes,l.lanes=r.lanes,l.child=r.child,l.memoizedProps=r.memoizedProps,l.memoizedState=r.memoizedState,l.updateQueue=r.updateQueue,i=r.dependencies,l.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},l.sibling=r.sibling,l.index=r.index,l.ref=r.ref,l.refCleanup=r.refCleanup,l}function c1(r,i){r.flags&=65011714;var l=r.alternate;return l===null?(r.childLanes=0,r.lanes=i,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=l.childLanes,r.lanes=l.lanes,r.child=l.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=l.memoizedProps,r.memoizedState=l.memoizedState,r.updateQueue=l.updateQueue,r.type=l.type,i=l.dependencies,r.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),r}function $d(r,i,l,h,m,y){var w=0;if(h=r,typeof r=="function")qp(r)&&(w=1);else if(typeof r=="string")w=AA(r,l,Re.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case D:return r=Qr(31,l,i,m),r.elementType=D,r.lanes=y,r;case M:return rl(l.children,m,y,i);case P:w=8,m|=24;break;case Y:return r=Qr(12,l,i,m|2),r.elementType=Y,r.lanes=y,r;case Ne:return r=Qr(13,l,i,m),r.elementType=Ne,r.lanes=y,r;case we:return r=Qr(19,l,i,m),r.elementType=we,r.lanes=y,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case J:w=10;break e;case $:w=9;break e;case de:w=11;break e;case A:w=14;break e;case S:w=16,h=null;break e}w=29,l=Error(s(130,r===null?"null":typeof r,"")),h=null}return i=Qr(w,l,i,m),i.elementType=r,i.type=h,i.lanes=y,i}function rl(r,i,l,h){return r=Qr(7,r,h,i),r.lanes=l,r}function $p(r,i,l){return r=Qr(6,r,null,i),r.lanes=l,r}function u1(r){var i=Qr(18,null,null,0);return i.stateNode=r,i}function Hp(r,i,l){return i=Qr(4,r.children!==null?r.children:[],r.key,i),i.lanes=l,i.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},i}var h1=new WeakMap;function di(r,i){if(typeof r=="object"&&r!==null){var l=h1.get(r);return l!==void 0?l:(i={value:r,source:i,stack:St(i)},h1.set(r,i),i)}return{value:r,source:i,stack:St(i)}}var cc=[],uc=0,Hd=null,Bu=0,fi=[],mi=0,Ka=null,qi=1,$i="";function da(r,i){cc[uc++]=Bu,cc[uc++]=Hd,Hd=r,Bu=i}function d1(r,i,l){fi[mi++]=qi,fi[mi++]=$i,fi[mi++]=Ka,Ka=r;var h=qi;r=$i;var m=32-ze(h)-1;h&=~(1<<m),l+=1;var y=32-ze(i)+m;if(30<y){var w=m-m%5;y=(h&(1<<w)-1).toString(32),h>>=w,m-=w,qi=1<<32-ze(i)+m|l<<m|h,$i=y+r}else qi=1<<y|l<<m|h,$i=r}function Wp(r){r.return!==null&&(da(r,1),d1(r,1,0))}function Gp(r){for(;r===Hd;)Hd=cc[--uc],cc[uc]=null,Bu=cc[--uc],cc[uc]=null;for(;r===Ka;)Ka=fi[--mi],fi[mi]=null,$i=fi[--mi],fi[mi]=null,qi=fi[--mi],fi[mi]=null}function f1(r,i){fi[mi++]=qi,fi[mi++]=$i,fi[mi++]=Ka,qi=i.id,$i=i.overflow,Ka=r}var hr=null,cs=null,kn=!1,Qa=null,pi=!1,Kp=Error(s(519));function Ya(r){var i=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Uu(di(i,r)),Kp}function m1(r){var i=r.stateNode,l=r.type,h=r.memoizedProps;switch(i[rt]=r,i[Rt]=h,l){case"dialog":gn("cancel",i),gn("close",i);break;case"iframe":case"object":case"embed":gn("load",i);break;case"video":case"audio":for(l=0;l<lh.length;l++)gn(lh[l],i);break;case"source":gn("error",i);break;case"img":case"image":case"link":gn("error",i),gn("load",i);break;case"details":gn("toggle",i);break;case"input":gn("invalid",i),En(i,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":gn("invalid",i);break;case"textarea":gn("invalid",i),ci(i,h.value,h.defaultValue,h.children)}l=h.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||i.textContent===""+l||h.suppressHydrationWarning===!0||C_(i.textContent,l)?(h.popover!=null&&(gn("beforetoggle",i),gn("toggle",i)),h.onScroll!=null&&gn("scroll",i),h.onScrollEnd!=null&&gn("scrollend",i),h.onClick!=null&&(i.onclick=os),i=!0):i=!1,i||Ya(r,!0)}function p1(r){for(hr=r.return;hr;)switch(hr.tag){case 5:case 31:case 13:pi=!1;return;case 27:case 3:pi=!0;return;default:hr=hr.return}}function hc(r){if(r!==hr)return!1;if(!kn)return p1(r),kn=!0,!1;var i=r.tag,l;if((l=i!==3&&i!==27)&&((l=i===5)&&(l=r.type,l=!(l!=="form"&&l!=="button")||dy(r.type,r.memoizedProps)),l=!l),l&&cs&&Ya(r),p1(r),i===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(317));cs=U_(r)}else if(i===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(317));cs=U_(r)}else i===27?(i=cs,uo(r.type)?(r=yy,yy=null,cs=r):cs=i):cs=hr?yi(r.stateNode.nextSibling):null;return!0}function il(){cs=hr=null,kn=!1}function Qp(){var r=Qa;return r!==null&&(Fr===null?Fr=r:Fr.push.apply(Fr,r),Qa=null),r}function Uu(r){Qa===null?Qa=[r]:Qa.push(r)}var Yp=O(null),al=null,fa=null;function Xa(r,i,l){Te(Yp,i._currentValue),i._currentValue=l}function ma(r){r._currentValue=Yp.current,K(Yp)}function Xp(r,i,l){for(;r!==null;){var h=r.alternate;if((r.childLanes&i)!==i?(r.childLanes|=i,h!==null&&(h.childLanes|=i)):h!==null&&(h.childLanes&i)!==i&&(h.childLanes|=i),r===l)break;r=r.return}}function Jp(r,i,l,h){var m=r.child;for(m!==null&&(m.return=r);m!==null;){var y=m.dependencies;if(y!==null){var w=m.child;y=y.firstContext;e:for(;y!==null;){var j=y;y=m;for(var F=0;F<i.length;F++)if(j.context===i[F]){y.lanes|=l,j=y.alternate,j!==null&&(j.lanes|=l),Xp(y.return,l,r),h||(w=null);break e}y=j.next}}else if(m.tag===18){if(w=m.return,w===null)throw Error(s(341));w.lanes|=l,y=w.alternate,y!==null&&(y.lanes|=l),Xp(w,l,r),w=null}else w=m.child;if(w!==null)w.return=m;else for(w=m;w!==null;){if(w===r){w=null;break}if(m=w.sibling,m!==null){m.return=w.return,w=m;break}w=w.return}m=w}}function dc(r,i,l,h){r=null;for(var m=i,y=!1;m!==null;){if(!y){if((m.flags&524288)!==0)y=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var w=m.alternate;if(w===null)throw Error(s(387));if(w=w.memoizedProps,w!==null){var j=m.type;Kr(m.pendingProps.value,w.value)||(r!==null?r.push(j):r=[j])}}else if(m===ut.current){if(w=m.alternate,w===null)throw Error(s(387));w.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(r!==null?r.push(fh):r=[fh])}m=m.return}r!==null&&Jp(i,r,l,h),i.flags|=262144}function Wd(r){for(r=r.firstContext;r!==null;){if(!Kr(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function ol(r){al=r,fa=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function dr(r){return g1(al,r)}function Gd(r,i){return al===null&&ol(r),g1(r,i)}function g1(r,i){var l=i._currentValue;if(i={context:i,memoizedValue:l,next:null},fa===null){if(r===null)throw Error(s(308));fa=i,r.dependencies={lanes:0,firstContext:i},r.flags|=524288}else fa=fa.next=i;return l}var kN=typeof AbortController<"u"?AbortController:function(){var r=[],i=this.signal={aborted:!1,addEventListener:function(l,h){r.push(h)}};this.abort=function(){i.aborted=!0,r.forEach(function(l){return l()})}},SN=n.unstable_scheduleCallback,jN=n.unstable_NormalPriority,Fs={$$typeof:J,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Zp(){return{controller:new kN,data:new Map,refCount:0}}function Fu(r){r.refCount--,r.refCount===0&&SN(jN,function(){r.controller.abort()})}var zu=null,eg=0,fc=0,mc=null;function NN(r,i){if(zu===null){var l=zu=[];eg=0,fc=sy(),mc={status:"pending",value:void 0,then:function(h){l.push(h)}}}return eg++,i.then(y1,y1),i}function y1(){if(--eg===0&&zu!==null){mc!==null&&(mc.status="fulfilled");var r=zu;zu=null,fc=0,mc=null;for(var i=0;i<r.length;i++)(0,r[i])()}}function AN(r,i){var l=[],h={status:"pending",value:null,reason:null,then:function(m){l.push(m)}};return r.then(function(){h.status="fulfilled",h.value=i;for(var m=0;m<l.length;m++)(0,l[m])(i)},function(m){for(h.status="rejected",h.reason=m,m=0;m<l.length;m++)(0,l[m])(void 0)}),h}var b1=H.S;H.S=function(r,i){t_=un(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&NN(r,i),b1!==null&&b1(r,i)};var ll=O(null);function tg(){var r=ll.current;return r!==null?r:ns.pooledCache}function Kd(r,i){i===null?Te(ll,ll.current):Te(ll,i.pool)}function v1(){var r=tg();return r===null?null:{parent:Fs._currentValue,pool:r}}var pc=Error(s(460)),ng=Error(s(474)),Qd=Error(s(542)),Yd={then:function(){}};function x1(r){return r=r.status,r==="fulfilled"||r==="rejected"}function _1(r,i,l){switch(l=r[l],l===void 0?r.push(i):l!==i&&(i.then(os,os),i=l),i.status){case"fulfilled":return i.value;case"rejected":throw r=i.reason,T1(r),r;default:if(typeof i.status=="string")i.then(os,os);else{if(r=ns,r!==null&&100<r.shellSuspendCounter)throw Error(s(482));r=i,r.status="pending",r.then(function(h){if(i.status==="pending"){var m=i;m.status="fulfilled",m.value=h}},function(h){if(i.status==="pending"){var m=i;m.status="rejected",m.reason=h}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw r=i.reason,T1(r),r}throw ul=i,pc}}function cl(r){try{var i=r._init;return i(r._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(ul=l,pc):l}}var ul=null;function w1(){if(ul===null)throw Error(s(459));var r=ul;return ul=null,r}function T1(r){if(r===pc||r===Qd)throw Error(s(483))}var gc=null,qu=0;function Xd(r){var i=qu;return qu+=1,gc===null&&(gc=[]),_1(gc,r,i)}function $u(r,i){i=i.props.ref,r.ref=i!==void 0?i:null}function Jd(r,i){throw i.$$typeof===T?Error(s(525)):(r=Object.prototype.toString.call(i),Error(s(31,r==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":r)))}function E1(r){function i(Z,G){if(r){var oe=Z.deletions;oe===null?(Z.deletions=[G],Z.flags|=16):oe.push(G)}}function l(Z,G){if(!r)return null;for(;G!==null;)i(Z,G),G=G.sibling;return null}function h(Z){for(var G=new Map;Z!==null;)Z.key!==null?G.set(Z.key,Z):G.set(Z.index,Z),Z=Z.sibling;return G}function m(Z,G){return Z=ha(Z,G),Z.index=0,Z.sibling=null,Z}function y(Z,G,oe){return Z.index=oe,r?(oe=Z.alternate,oe!==null?(oe=oe.index,oe<G?(Z.flags|=67108866,G):oe):(Z.flags|=67108866,G)):(Z.flags|=1048576,G)}function w(Z){return r&&Z.alternate===null&&(Z.flags|=67108866),Z}function j(Z,G,oe,Ce){return G===null||G.tag!==6?(G=$p(oe,Z.mode,Ce),G.return=Z,G):(G=m(G,oe),G.return=Z,G)}function F(Z,G,oe,Ce){var At=oe.type;return At===M?je(Z,G,oe.props.children,Ce,oe.key):G!==null&&(G.elementType===At||typeof At=="object"&&At!==null&&At.$$typeof===S&&cl(At)===G.type)?(G=m(G,oe.props),$u(G,oe),G.return=Z,G):(G=$d(oe.type,oe.key,oe.props,null,Z.mode,Ce),$u(G,oe),G.return=Z,G)}function le(Z,G,oe,Ce){return G===null||G.tag!==4||G.stateNode.containerInfo!==oe.containerInfo||G.stateNode.implementation!==oe.implementation?(G=Hp(oe,Z.mode,Ce),G.return=Z,G):(G=m(G,oe.children||[]),G.return=Z,G)}function je(Z,G,oe,Ce,At){return G===null||G.tag!==7?(G=rl(oe,Z.mode,Ce,At),G.return=Z,G):(G=m(G,oe),G.return=Z,G)}function Pe(Z,G,oe){if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return G=$p(""+G,Z.mode,oe),G.return=Z,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case N:return oe=$d(G.type,G.key,G.props,null,Z.mode,oe),$u(oe,G),oe.return=Z,oe;case B:return G=Hp(G,Z.mode,oe),G.return=Z,G;case S:return G=cl(G),Pe(Z,G,oe)}if(xt(G)||q(G))return G=rl(G,Z.mode,oe,null),G.return=Z,G;if(typeof G.then=="function")return Pe(Z,Xd(G),oe);if(G.$$typeof===J)return Pe(Z,Gd(Z,G),oe);Jd(Z,G)}return null}function ue(Z,G,oe,Ce){var At=G!==null?G.key:null;if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return At!==null?null:j(Z,G,""+oe,Ce);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case N:return oe.key===At?F(Z,G,oe,Ce):null;case B:return oe.key===At?le(Z,G,oe,Ce):null;case S:return oe=cl(oe),ue(Z,G,oe,Ce)}if(xt(oe)||q(oe))return At!==null?null:je(Z,G,oe,Ce,null);if(typeof oe.then=="function")return ue(Z,G,Xd(oe),Ce);if(oe.$$typeof===J)return ue(Z,G,Gd(Z,oe),Ce);Jd(Z,oe)}return null}function ge(Z,G,oe,Ce,At){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number"||typeof Ce=="bigint")return Z=Z.get(oe)||null,j(G,Z,""+Ce,At);if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case N:return Z=Z.get(Ce.key===null?oe:Ce.key)||null,F(G,Z,Ce,At);case B:return Z=Z.get(Ce.key===null?oe:Ce.key)||null,le(G,Z,Ce,At);case S:return Ce=cl(Ce),ge(Z,G,oe,Ce,At)}if(xt(Ce)||q(Ce))return Z=Z.get(oe)||null,je(G,Z,Ce,At,null);if(typeof Ce.then=="function")return ge(Z,G,oe,Xd(Ce),At);if(Ce.$$typeof===J)return ge(Z,G,oe,Gd(G,Ce),At);Jd(G,Ce)}return null}function ft(Z,G,oe,Ce){for(var At=null,Ln=null,yt=G,on=G=0,_n=null;yt!==null&&on<oe.length;on++){yt.index>on?(_n=yt,yt=null):_n=yt.sibling;var Vn=ue(Z,yt,oe[on],Ce);if(Vn===null){yt===null&&(yt=_n);break}r&&yt&&Vn.alternate===null&&i(Z,yt),G=y(Vn,G,on),Ln===null?At=Vn:Ln.sibling=Vn,Ln=Vn,yt=_n}if(on===oe.length)return l(Z,yt),kn&&da(Z,on),At;if(yt===null){for(;on<oe.length;on++)yt=Pe(Z,oe[on],Ce),yt!==null&&(G=y(yt,G,on),Ln===null?At=yt:Ln.sibling=yt,Ln=yt);return kn&&da(Z,on),At}for(yt=h(yt);on<oe.length;on++)_n=ge(yt,Z,on,oe[on],Ce),_n!==null&&(r&&_n.alternate!==null&&yt.delete(_n.key===null?on:_n.key),G=y(_n,G,on),Ln===null?At=_n:Ln.sibling=_n,Ln=_n);return r&&yt.forEach(function(go){return i(Z,go)}),kn&&da(Z,on),At}function Pt(Z,G,oe,Ce){if(oe==null)throw Error(s(151));for(var At=null,Ln=null,yt=G,on=G=0,_n=null,Vn=oe.next();yt!==null&&!Vn.done;on++,Vn=oe.next()){yt.index>on?(_n=yt,yt=null):_n=yt.sibling;var go=ue(Z,yt,Vn.value,Ce);if(go===null){yt===null&&(yt=_n);break}r&&yt&&go.alternate===null&&i(Z,yt),G=y(go,G,on),Ln===null?At=go:Ln.sibling=go,Ln=go,yt=_n}if(Vn.done)return l(Z,yt),kn&&da(Z,on),At;if(yt===null){for(;!Vn.done;on++,Vn=oe.next())Vn=Pe(Z,Vn.value,Ce),Vn!==null&&(G=y(Vn,G,on),Ln===null?At=Vn:Ln.sibling=Vn,Ln=Vn);return kn&&da(Z,on),At}for(yt=h(yt);!Vn.done;on++,Vn=oe.next())Vn=ge(yt,Z,on,Vn.value,Ce),Vn!==null&&(r&&Vn.alternate!==null&&yt.delete(Vn.key===null?on:Vn.key),G=y(Vn,G,on),Ln===null?At=Vn:Ln.sibling=Vn,Ln=Vn);return r&&yt.forEach(function(UA){return i(Z,UA)}),kn&&da(Z,on),At}function Zn(Z,G,oe,Ce){if(typeof oe=="object"&&oe!==null&&oe.type===M&&oe.key===null&&(oe=oe.props.children),typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case N:e:{for(var At=oe.key;G!==null;){if(G.key===At){if(At=oe.type,At===M){if(G.tag===7){l(Z,G.sibling),Ce=m(G,oe.props.children),Ce.return=Z,Z=Ce;break e}}else if(G.elementType===At||typeof At=="object"&&At!==null&&At.$$typeof===S&&cl(At)===G.type){l(Z,G.sibling),Ce=m(G,oe.props),$u(Ce,oe),Ce.return=Z,Z=Ce;break e}l(Z,G);break}else i(Z,G);G=G.sibling}oe.type===M?(Ce=rl(oe.props.children,Z.mode,Ce,oe.key),Ce.return=Z,Z=Ce):(Ce=$d(oe.type,oe.key,oe.props,null,Z.mode,Ce),$u(Ce,oe),Ce.return=Z,Z=Ce)}return w(Z);case B:e:{for(At=oe.key;G!==null;){if(G.key===At)if(G.tag===4&&G.stateNode.containerInfo===oe.containerInfo&&G.stateNode.implementation===oe.implementation){l(Z,G.sibling),Ce=m(G,oe.children||[]),Ce.return=Z,Z=Ce;break e}else{l(Z,G);break}else i(Z,G);G=G.sibling}Ce=Hp(oe,Z.mode,Ce),Ce.return=Z,Z=Ce}return w(Z);case S:return oe=cl(oe),Zn(Z,G,oe,Ce)}if(xt(oe))return ft(Z,G,oe,Ce);if(q(oe)){if(At=q(oe),typeof At!="function")throw Error(s(150));return oe=At.call(oe),Pt(Z,G,oe,Ce)}if(typeof oe.then=="function")return Zn(Z,G,Xd(oe),Ce);if(oe.$$typeof===J)return Zn(Z,G,Gd(Z,oe),Ce);Jd(Z,oe)}return typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint"?(oe=""+oe,G!==null&&G.tag===6?(l(Z,G.sibling),Ce=m(G,oe),Ce.return=Z,Z=Ce):(l(Z,G),Ce=$p(oe,Z.mode,Ce),Ce.return=Z,Z=Ce),w(Z)):l(Z,G)}return function(Z,G,oe,Ce){try{qu=0;var At=Zn(Z,G,oe,Ce);return gc=null,At}catch(yt){if(yt===pc||yt===Qd)throw yt;var Ln=Qr(29,yt,null,Z.mode);return Ln.lanes=Ce,Ln.return=Z,Ln}}}var hl=E1(!0),k1=E1(!1),Ja=!1;function sg(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function rg(r,i){r=r.updateQueue,i.updateQueue===r&&(i.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Za(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function eo(r,i,l){var h=r.updateQueue;if(h===null)return null;if(h=h.shared,(Fn&2)!==0){var m=h.pending;return m===null?i.next=i:(i.next=m.next,m.next=i),h.pending=i,i=qd(r),l1(r,null,l),i}return zd(r,h,i,l),qd(r)}function Hu(r,i,l){if(i=i.updateQueue,i!==null&&(i=i.shared,(l&4194048)!==0)){var h=i.lanes;h&=r.pendingLanes,l|=h,i.lanes=l,Cn(r,l)}}function ig(r,i){var l=r.updateQueue,h=r.alternate;if(h!==null&&(h=h.updateQueue,l===h)){var m=null,y=null;if(l=l.firstBaseUpdate,l!==null){do{var w={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};y===null?m=y=w:y=y.next=w,l=l.next}while(l!==null);y===null?m=y=i:y=y.next=i}else m=y=i;l={baseState:h.baseState,firstBaseUpdate:m,lastBaseUpdate:y,shared:h.shared,callbacks:h.callbacks},r.updateQueue=l;return}r=l.lastBaseUpdate,r===null?l.firstBaseUpdate=i:r.next=i,l.lastBaseUpdate=i}var ag=!1;function Wu(){if(ag){var r=mc;if(r!==null)throw r}}function Gu(r,i,l,h){ag=!1;var m=r.updateQueue;Ja=!1;var y=m.firstBaseUpdate,w=m.lastBaseUpdate,j=m.shared.pending;if(j!==null){m.shared.pending=null;var F=j,le=F.next;F.next=null,w===null?y=le:w.next=le,w=F;var je=r.alternate;je!==null&&(je=je.updateQueue,j=je.lastBaseUpdate,j!==w&&(j===null?je.firstBaseUpdate=le:j.next=le,je.lastBaseUpdate=F))}if(y!==null){var Pe=m.baseState;w=0,je=le=F=null,j=y;do{var ue=j.lane&-536870913,ge=ue!==j.lane;if(ge?(xn&ue)===ue:(h&ue)===ue){ue!==0&&ue===fc&&(ag=!0),je!==null&&(je=je.next={lane:0,tag:j.tag,payload:j.payload,callback:null,next:null});e:{var ft=r,Pt=j;ue=i;var Zn=l;switch(Pt.tag){case 1:if(ft=Pt.payload,typeof ft=="function"){Pe=ft.call(Zn,Pe,ue);break e}Pe=ft;break e;case 3:ft.flags=ft.flags&-65537|128;case 0:if(ft=Pt.payload,ue=typeof ft=="function"?ft.call(Zn,Pe,ue):ft,ue==null)break e;Pe=x({},Pe,ue);break e;case 2:Ja=!0}}ue=j.callback,ue!==null&&(r.flags|=64,ge&&(r.flags|=8192),ge=m.callbacks,ge===null?m.callbacks=[ue]:ge.push(ue))}else ge={lane:ue,tag:j.tag,payload:j.payload,callback:j.callback,next:null},je===null?(le=je=ge,F=Pe):je=je.next=ge,w|=ue;if(j=j.next,j===null){if(j=m.shared.pending,j===null)break;ge=j,j=ge.next,ge.next=null,m.lastBaseUpdate=ge,m.shared.pending=null}}while(!0);je===null&&(F=Pe),m.baseState=F,m.firstBaseUpdate=le,m.lastBaseUpdate=je,y===null&&(m.shared.lanes=0),io|=w,r.lanes=w,r.memoizedState=Pe}}function S1(r,i){if(typeof r!="function")throw Error(s(191,r));r.call(i)}function j1(r,i){var l=r.callbacks;if(l!==null)for(r.callbacks=null,r=0;r<l.length;r++)S1(l[r],i)}var yc=O(null),Zd=O(0);function N1(r,i){r=Ta,Te(Zd,r),Te(yc,i),Ta=r|i.baseLanes}function og(){Te(Zd,Ta),Te(yc,yc.current)}function lg(){Ta=Zd.current,K(yc),K(Zd)}var Yr=O(null),gi=null;function to(r){var i=r.alternate;Te(Ms,Ms.current&1),Te(Yr,r),gi===null&&(i===null||yc.current!==null||i.memoizedState!==null)&&(gi=r)}function cg(r){Te(Ms,Ms.current),Te(Yr,r),gi===null&&(gi=r)}function A1(r){r.tag===22?(Te(Ms,Ms.current),Te(Yr,r),gi===null&&(gi=r)):no()}function no(){Te(Ms,Ms.current),Te(Yr,Yr.current)}function Xr(r){K(Yr),gi===r&&(gi=null),K(Ms)}var Ms=O(0);function ef(r){for(var i=r;i!==null;){if(i.tag===13){var l=i.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||py(l)||gy(l)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var pa=0,nn=null,Xn=null,zs=null,tf=!1,bc=!1,dl=!1,nf=0,Ku=0,vc=null,RN=0;function js(){throw Error(s(321))}function ug(r,i){if(i===null)return!1;for(var l=0;l<i.length&&l<r.length;l++)if(!Kr(r[l],i[l]))return!1;return!0}function hg(r,i,l,h,m,y){return pa=y,nn=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,H.H=r===null||r.memoizedState===null?dx:Sg,dl=!1,y=l(h,m),dl=!1,bc&&(y=C1(i,l,h,m)),R1(r),y}function R1(r){H.H=Xu;var i=Xn!==null&&Xn.next!==null;if(pa=0,zs=Xn=nn=null,tf=!1,Ku=0,vc=null,i)throw Error(s(300));r===null||qs||(r=r.dependencies,r!==null&&Wd(r)&&(qs=!0))}function C1(r,i,l,h){nn=r;var m=0;do{if(bc&&(vc=null),Ku=0,bc=!1,25<=m)throw Error(s(301));if(m+=1,zs=Xn=null,r.updateQueue!=null){var y=r.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}H.H=fx,y=i(l,h)}while(bc);return y}function CN(){var r=H.H,i=r.useState()[0];return i=typeof i.then=="function"?Qu(i):i,r=r.useState()[0],(Xn!==null?Xn.memoizedState:null)!==r&&(nn.flags|=1024),i}function dg(){var r=nf!==0;return nf=0,r}function fg(r,i,l){i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~l}function mg(r){if(tf){for(r=r.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}tf=!1}pa=0,zs=Xn=nn=null,bc=!1,Ku=nf=0,vc=null}function Ar(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zs===null?nn.memoizedState=zs=r:zs=zs.next=r,zs}function Ls(){if(Xn===null){var r=nn.alternate;r=r!==null?r.memoizedState:null}else r=Xn.next;var i=zs===null?nn.memoizedState:zs.next;if(i!==null)zs=i,Xn=r;else{if(r===null)throw nn.alternate===null?Error(s(467)):Error(s(310));Xn=r,r={memoizedState:Xn.memoizedState,baseState:Xn.baseState,baseQueue:Xn.baseQueue,queue:Xn.queue,next:null},zs===null?nn.memoizedState=zs=r:zs=zs.next=r}return zs}function sf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Qu(r){var i=Ku;return Ku+=1,vc===null&&(vc=[]),r=_1(vc,r,i),i=nn,(zs===null?i.memoizedState:zs.next)===null&&(i=i.alternate,H.H=i===null||i.memoizedState===null?dx:Sg),r}function rf(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return Qu(r);if(r.$$typeof===J)return dr(r)}throw Error(s(438,String(r)))}function pg(r){var i=null,l=nn.updateQueue;if(l!==null&&(i=l.memoCache),i==null){var h=nn.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(i={data:h.data.map(function(m){return m.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),l===null&&(l=sf(),nn.updateQueue=l),l.memoCache=i,l=i.data[i.index],l===void 0)for(l=i.data[i.index]=Array(r),h=0;h<r;h++)l[h]=U;return i.index++,l}function ga(r,i){return typeof i=="function"?i(r):i}function af(r){var i=Ls();return gg(i,Xn,r)}function gg(r,i,l){var h=r.queue;if(h===null)throw Error(s(311));h.lastRenderedReducer=l;var m=r.baseQueue,y=h.pending;if(y!==null){if(m!==null){var w=m.next;m.next=y.next,y.next=w}i.baseQueue=m=y,h.pending=null}if(y=r.baseState,m===null)r.memoizedState=y;else{i=m.next;var j=w=null,F=null,le=i,je=!1;do{var Pe=le.lane&-536870913;if(Pe!==le.lane?(xn&Pe)===Pe:(pa&Pe)===Pe){var ue=le.revertLane;if(ue===0)F!==null&&(F=F.next={lane:0,revertLane:0,gesture:null,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null}),Pe===fc&&(je=!0);else if((pa&ue)===ue){le=le.next,ue===fc&&(je=!0);continue}else Pe={lane:0,revertLane:le.revertLane,gesture:null,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},F===null?(j=F=Pe,w=y):F=F.next=Pe,nn.lanes|=ue,io|=ue;Pe=le.action,dl&&l(y,Pe),y=le.hasEagerState?le.eagerState:l(y,Pe)}else ue={lane:Pe,revertLane:le.revertLane,gesture:le.gesture,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},F===null?(j=F=ue,w=y):F=F.next=ue,nn.lanes|=Pe,io|=Pe;le=le.next}while(le!==null&&le!==i);if(F===null?w=y:F.next=j,!Kr(y,r.memoizedState)&&(qs=!0,je&&(l=mc,l!==null)))throw l;r.memoizedState=y,r.baseState=w,r.baseQueue=F,h.lastRenderedState=y}return m===null&&(h.lanes=0),[r.memoizedState,h.dispatch]}function yg(r){var i=Ls(),l=i.queue;if(l===null)throw Error(s(311));l.lastRenderedReducer=r;var h=l.dispatch,m=l.pending,y=i.memoizedState;if(m!==null){l.pending=null;var w=m=m.next;do y=r(y,w.action),w=w.next;while(w!==m);Kr(y,i.memoizedState)||(qs=!0),i.memoizedState=y,i.baseQueue===null&&(i.baseState=y),l.lastRenderedState=y}return[y,h]}function I1(r,i,l){var h=nn,m=Ls(),y=kn;if(y){if(l===void 0)throw Error(s(407));l=l()}else l=i();var w=!Kr((Xn||m).memoizedState,l);if(w&&(m.memoizedState=l,qs=!0),m=m.queue,xg(M1.bind(null,h,m,r),[r]),m.getSnapshot!==i||w||zs!==null&&zs.memoizedState.tag&1){if(h.flags|=2048,xc(9,{destroy:void 0},P1.bind(null,h,m,l,i),null),ns===null)throw Error(s(349));y||(pa&127)!==0||D1(h,i,l)}return l}function D1(r,i,l){r.flags|=16384,r={getSnapshot:i,value:l},i=nn.updateQueue,i===null?(i=sf(),nn.updateQueue=i,i.stores=[r]):(l=i.stores,l===null?i.stores=[r]:l.push(r))}function P1(r,i,l,h){i.value=l,i.getSnapshot=h,L1(i)&&V1(r)}function M1(r,i,l){return l(function(){L1(i)&&V1(r)})}function L1(r){var i=r.getSnapshot;r=r.value;try{var l=i();return!Kr(r,l)}catch{return!0}}function V1(r){var i=sl(r,2);i!==null&&zr(i,r,2)}function bg(r){var i=Ar();if(typeof r=="function"){var l=r;if(r=l(),dl){Le(!0);try{l()}finally{Le(!1)}}}return i.memoizedState=i.baseState=r,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ga,lastRenderedState:r},i}function O1(r,i,l,h){return r.baseState=l,gg(r,Xn,typeof h=="function"?h:ga)}function IN(r,i,l,h,m){if(cf(r))throw Error(s(485));if(r=i.action,r!==null){var y={payload:m,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){y.listeners.push(w)}};H.T!==null?l(!0):y.isTransition=!1,h(y),l=i.pending,l===null?(y.next=i.pending=y,B1(i,y)):(y.next=l.next,i.pending=l.next=y)}}function B1(r,i){var l=i.action,h=i.payload,m=r.state;if(i.isTransition){var y=H.T,w={};H.T=w;try{var j=l(m,h),F=H.S;F!==null&&F(w,j),U1(r,i,j)}catch(le){vg(r,i,le)}finally{y!==null&&w.types!==null&&(y.types=w.types),H.T=y}}else try{y=l(m,h),U1(r,i,y)}catch(le){vg(r,i,le)}}function U1(r,i,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(h){F1(r,i,h)},function(h){return vg(r,i,h)}):F1(r,i,l)}function F1(r,i,l){i.status="fulfilled",i.value=l,z1(i),r.state=l,i=r.pending,i!==null&&(l=i.next,l===i?r.pending=null:(l=l.next,i.next=l,B1(r,l)))}function vg(r,i,l){var h=r.pending;if(r.pending=null,h!==null){h=h.next;do i.status="rejected",i.reason=l,z1(i),i=i.next;while(i!==h)}r.action=null}function z1(r){r=r.listeners;for(var i=0;i<r.length;i++)(0,r[i])()}function q1(r,i){return i}function $1(r,i){if(kn){var l=ns.formState;if(l!==null){e:{var h=nn;if(kn){if(cs){t:{for(var m=cs,y=pi;m.nodeType!==8;){if(!y){m=null;break t}if(m=yi(m.nextSibling),m===null){m=null;break t}}y=m.data,m=y==="F!"||y==="F"?m:null}if(m){cs=yi(m.nextSibling),h=m.data==="F!";break e}}Ya(h)}h=!1}h&&(i=l[0])}}return l=Ar(),l.memoizedState=l.baseState=i,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:q1,lastRenderedState:i},l.queue=h,l=cx.bind(null,nn,h),h.dispatch=l,h=bg(!1),y=kg.bind(null,nn,!1,h.queue),h=Ar(),m={state:i,dispatch:null,action:r,pending:null},h.queue=m,l=IN.bind(null,nn,m,y,l),m.dispatch=l,h.memoizedState=r,[i,l,!1]}function H1(r){var i=Ls();return W1(i,Xn,r)}function W1(r,i,l){if(i=gg(r,i,q1)[0],r=af(ga)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var h=Qu(i)}catch(w){throw w===pc?Qd:w}else h=i;i=Ls();var m=i.queue,y=m.dispatch;return l!==i.memoizedState&&(nn.flags|=2048,xc(9,{destroy:void 0},DN.bind(null,m,l),null)),[h,y,r]}function DN(r,i){r.action=i}function G1(r){var i=Ls(),l=Xn;if(l!==null)return W1(i,l,r);Ls(),i=i.memoizedState,l=Ls();var h=l.queue.dispatch;return l.memoizedState=r,[i,h,!1]}function xc(r,i,l,h){return r={tag:r,create:l,deps:h,inst:i,next:null},i=nn.updateQueue,i===null&&(i=sf(),nn.updateQueue=i),l=i.lastEffect,l===null?i.lastEffect=r.next=r:(h=l.next,l.next=r,r.next=h,i.lastEffect=r),r}function K1(){return Ls().memoizedState}function of(r,i,l,h){var m=Ar();nn.flags|=r,m.memoizedState=xc(1|i,{destroy:void 0},l,h===void 0?null:h)}function lf(r,i,l,h){var m=Ls();h=h===void 0?null:h;var y=m.memoizedState.inst;Xn!==null&&h!==null&&ug(h,Xn.memoizedState.deps)?m.memoizedState=xc(i,y,l,h):(nn.flags|=r,m.memoizedState=xc(1|i,y,l,h))}function Q1(r,i){of(8390656,8,r,i)}function xg(r,i){lf(2048,8,r,i)}function PN(r){nn.flags|=4;var i=nn.updateQueue;if(i===null)i=sf(),nn.updateQueue=i,i.events=[r];else{var l=i.events;l===null?i.events=[r]:l.push(r)}}function Y1(r){var i=Ls().memoizedState;return PN({ref:i,nextImpl:r}),function(){if((Fn&2)!==0)throw Error(s(440));return i.impl.apply(void 0,arguments)}}function X1(r,i){return lf(4,2,r,i)}function J1(r,i){return lf(4,4,r,i)}function Z1(r,i){if(typeof i=="function"){r=r();var l=i(r);return function(){typeof l=="function"?l():i(null)}}if(i!=null)return r=r(),i.current=r,function(){i.current=null}}function ex(r,i,l){l=l!=null?l.concat([r]):null,lf(4,4,Z1.bind(null,i,r),l)}function _g(){}function tx(r,i){var l=Ls();i=i===void 0?null:i;var h=l.memoizedState;return i!==null&&ug(i,h[1])?h[0]:(l.memoizedState=[r,i],r)}function nx(r,i){var l=Ls();i=i===void 0?null:i;var h=l.memoizedState;if(i!==null&&ug(i,h[1]))return h[0];if(h=r(),dl){Le(!0);try{r()}finally{Le(!1)}}return l.memoizedState=[h,i],h}function wg(r,i,l){return l===void 0||(pa&1073741824)!==0&&(xn&261930)===0?r.memoizedState=i:(r.memoizedState=l,r=s_(),nn.lanes|=r,io|=r,l)}function sx(r,i,l,h){return Kr(l,i)?l:yc.current!==null?(r=wg(r,l,h),Kr(r,i)||(qs=!0),r):(pa&42)===0||(pa&1073741824)!==0&&(xn&261930)===0?(qs=!0,r.memoizedState=l):(r=s_(),nn.lanes|=r,io|=r,i)}function rx(r,i,l,h,m){var y=ye.p;ye.p=y!==0&&8>y?y:8;var w=H.T,j={};H.T=j,kg(r,!1,i,l);try{var F=m(),le=H.S;if(le!==null&&le(j,F),F!==null&&typeof F=="object"&&typeof F.then=="function"){var je=AN(F,h);Yu(r,i,je,ei(r))}else Yu(r,i,h,ei(r))}catch(Pe){Yu(r,i,{then:function(){},status:"rejected",reason:Pe},ei())}finally{ye.p=y,w!==null&&j.types!==null&&(w.types=j.types),H.T=w}}function MN(){}function Tg(r,i,l,h){if(r.tag!==5)throw Error(s(476));var m=ix(r).queue;rx(r,m,i,Ve,l===null?MN:function(){return ax(r),l(h)})}function ix(r){var i=r.memoizedState;if(i!==null)return i;i={memoizedState:Ve,baseState:Ve,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ga,lastRenderedState:Ve},next:null};var l={};return i.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ga,lastRenderedState:l},next:null},r.memoizedState=i,r=r.alternate,r!==null&&(r.memoizedState=i),i}function ax(r){var i=ix(r);i.next===null&&(i=r.alternate.memoizedState),Yu(r,i.next.queue,{},ei())}function Eg(){return dr(fh)}function ox(){return Ls().memoizedState}function lx(){return Ls().memoizedState}function LN(r){for(var i=r.return;i!==null;){switch(i.tag){case 24:case 3:var l=ei();r=Za(l);var h=eo(i,r,l);h!==null&&(zr(h,i,l),Hu(h,i,l)),i={cache:Zp()},r.payload=i;return}i=i.return}}function VN(r,i,l){var h=ei();l={lane:h,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},cf(r)?ux(i,l):(l=zp(r,i,l,h),l!==null&&(zr(l,r,h),hx(l,i,h)))}function cx(r,i,l){var h=ei();Yu(r,i,l,h)}function Yu(r,i,l,h){var m={lane:h,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(cf(r))ux(i,m);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=i.lastRenderedReducer,y!==null))try{var w=i.lastRenderedState,j=y(w,l);if(m.hasEagerState=!0,m.eagerState=j,Kr(j,w))return zd(r,i,m,0),ns===null&&Fd(),!1}catch{}if(l=zp(r,i,m,h),l!==null)return zr(l,r,h),hx(l,i,h),!0}return!1}function kg(r,i,l,h){if(h={lane:2,revertLane:sy(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},cf(r)){if(i)throw Error(s(479))}else i=zp(r,l,h,2),i!==null&&zr(i,r,2)}function cf(r){var i=r.alternate;return r===nn||i!==null&&i===nn}function ux(r,i){bc=tf=!0;var l=r.pending;l===null?i.next=i:(i.next=l.next,l.next=i),r.pending=i}function hx(r,i,l){if((l&4194048)!==0){var h=i.lanes;h&=r.pendingLanes,l|=h,i.lanes=l,Cn(r,l)}}var Xu={readContext:dr,use:rf,useCallback:js,useContext:js,useEffect:js,useImperativeHandle:js,useLayoutEffect:js,useInsertionEffect:js,useMemo:js,useReducer:js,useRef:js,useState:js,useDebugValue:js,useDeferredValue:js,useTransition:js,useSyncExternalStore:js,useId:js,useHostTransitionStatus:js,useFormState:js,useActionState:js,useOptimistic:js,useMemoCache:js,useCacheRefresh:js};Xu.useEffectEvent=js;var dx={readContext:dr,use:rf,useCallback:function(r,i){return Ar().memoizedState=[r,i===void 0?null:i],r},useContext:dr,useEffect:Q1,useImperativeHandle:function(r,i,l){l=l!=null?l.concat([r]):null,of(4194308,4,Z1.bind(null,i,r),l)},useLayoutEffect:function(r,i){return of(4194308,4,r,i)},useInsertionEffect:function(r,i){of(4,2,r,i)},useMemo:function(r,i){var l=Ar();i=i===void 0?null:i;var h=r();if(dl){Le(!0);try{r()}finally{Le(!1)}}return l.memoizedState=[h,i],h},useReducer:function(r,i,l){var h=Ar();if(l!==void 0){var m=l(i);if(dl){Le(!0);try{l(i)}finally{Le(!1)}}}else m=i;return h.memoizedState=h.baseState=m,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:m},h.queue=r,r=r.dispatch=VN.bind(null,nn,r),[h.memoizedState,r]},useRef:function(r){var i=Ar();return r={current:r},i.memoizedState=r},useState:function(r){r=bg(r);var i=r.queue,l=cx.bind(null,nn,i);return i.dispatch=l,[r.memoizedState,l]},useDebugValue:_g,useDeferredValue:function(r,i){var l=Ar();return wg(l,r,i)},useTransition:function(){var r=bg(!1);return r=rx.bind(null,nn,r.queue,!0,!1),Ar().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,i,l){var h=nn,m=Ar();if(kn){if(l===void 0)throw Error(s(407));l=l()}else{if(l=i(),ns===null)throw Error(s(349));(xn&127)!==0||D1(h,i,l)}m.memoizedState=l;var y={value:l,getSnapshot:i};return m.queue=y,Q1(M1.bind(null,h,y,r),[r]),h.flags|=2048,xc(9,{destroy:void 0},P1.bind(null,h,y,l,i),null),l},useId:function(){var r=Ar(),i=ns.identifierPrefix;if(kn){var l=$i,h=qi;l=(h&~(1<<32-ze(h)-1)).toString(32)+l,i="_"+i+"R_"+l,l=nf++,0<l&&(i+="H"+l.toString(32)),i+="_"}else l=RN++,i="_"+i+"r_"+l.toString(32)+"_";return r.memoizedState=i},useHostTransitionStatus:Eg,useFormState:$1,useActionState:$1,useOptimistic:function(r){var i=Ar();i.memoizedState=i.baseState=r;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=l,i=kg.bind(null,nn,!0,l),l.dispatch=i,[r,i]},useMemoCache:pg,useCacheRefresh:function(){return Ar().memoizedState=LN.bind(null,nn)},useEffectEvent:function(r){var i=Ar(),l={impl:r};return i.memoizedState=l,function(){if((Fn&2)!==0)throw Error(s(440));return l.impl.apply(void 0,arguments)}}},Sg={readContext:dr,use:rf,useCallback:tx,useContext:dr,useEffect:xg,useImperativeHandle:ex,useInsertionEffect:X1,useLayoutEffect:J1,useMemo:nx,useReducer:af,useRef:K1,useState:function(){return af(ga)},useDebugValue:_g,useDeferredValue:function(r,i){var l=Ls();return sx(l,Xn.memoizedState,r,i)},useTransition:function(){var r=af(ga)[0],i=Ls().memoizedState;return[typeof r=="boolean"?r:Qu(r),i]},useSyncExternalStore:I1,useId:ox,useHostTransitionStatus:Eg,useFormState:H1,useActionState:H1,useOptimistic:function(r,i){var l=Ls();return O1(l,Xn,r,i)},useMemoCache:pg,useCacheRefresh:lx};Sg.useEffectEvent=Y1;var fx={readContext:dr,use:rf,useCallback:tx,useContext:dr,useEffect:xg,useImperativeHandle:ex,useInsertionEffect:X1,useLayoutEffect:J1,useMemo:nx,useReducer:yg,useRef:K1,useState:function(){return yg(ga)},useDebugValue:_g,useDeferredValue:function(r,i){var l=Ls();return Xn===null?wg(l,r,i):sx(l,Xn.memoizedState,r,i)},useTransition:function(){var r=yg(ga)[0],i=Ls().memoizedState;return[typeof r=="boolean"?r:Qu(r),i]},useSyncExternalStore:I1,useId:ox,useHostTransitionStatus:Eg,useFormState:G1,useActionState:G1,useOptimistic:function(r,i){var l=Ls();return Xn!==null?O1(l,Xn,r,i):(l.baseState=r,[r,l.queue.dispatch])},useMemoCache:pg,useCacheRefresh:lx};fx.useEffectEvent=Y1;function jg(r,i,l,h){i=r.memoizedState,l=l(h,i),l=l==null?i:x({},i,l),r.memoizedState=l,r.lanes===0&&(r.updateQueue.baseState=l)}var Ng={enqueueSetState:function(r,i,l){r=r._reactInternals;var h=ei(),m=Za(h);m.payload=i,l!=null&&(m.callback=l),i=eo(r,m,h),i!==null&&(zr(i,r,h),Hu(i,r,h))},enqueueReplaceState:function(r,i,l){r=r._reactInternals;var h=ei(),m=Za(h);m.tag=1,m.payload=i,l!=null&&(m.callback=l),i=eo(r,m,h),i!==null&&(zr(i,r,h),Hu(i,r,h))},enqueueForceUpdate:function(r,i){r=r._reactInternals;var l=ei(),h=Za(l);h.tag=2,i!=null&&(h.callback=i),i=eo(r,h,l),i!==null&&(zr(i,r,l),Hu(i,r,l))}};function mx(r,i,l,h,m,y,w){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(h,y,w):i.prototype&&i.prototype.isPureReactComponent?!Vu(l,h)||!Vu(m,y):!0}function px(r,i,l,h){r=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(l,h),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(l,h),i.state!==r&&Ng.enqueueReplaceState(i,i.state,null)}function fl(r,i){var l=i;if("ref"in i){l={};for(var h in i)h!=="ref"&&(l[h]=i[h])}if(r=r.defaultProps){l===i&&(l=x({},l));for(var m in r)l[m]===void 0&&(l[m]=r[m])}return l}function gx(r){Ud(r)}function yx(r){console.error(r)}function bx(r){Ud(r)}function uf(r,i){try{var l=r.onUncaughtError;l(i.value,{componentStack:i.stack})}catch(h){setTimeout(function(){throw h})}}function vx(r,i,l){try{var h=r.onCaughtError;h(l.value,{componentStack:l.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function Ag(r,i,l){return l=Za(l),l.tag=3,l.payload={element:null},l.callback=function(){uf(r,i)},l}function xx(r){return r=Za(r),r.tag=3,r}function _x(r,i,l,h){var m=l.type.getDerivedStateFromError;if(typeof m=="function"){var y=h.value;r.payload=function(){return m(y)},r.callback=function(){vx(i,l,h)}}var w=l.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(r.callback=function(){vx(i,l,h),typeof m!="function"&&(ao===null?ao=new Set([this]):ao.add(this));var j=h.stack;this.componentDidCatch(h.value,{componentStack:j!==null?j:""})})}function ON(r,i,l,h,m){if(l.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(i=l.alternate,i!==null&&dc(i,l,m,!0),l=Yr.current,l!==null){switch(l.tag){case 31:case 13:return gi===null?wf():l.alternate===null&&Ns===0&&(Ns=3),l.flags&=-257,l.flags|=65536,l.lanes=m,h===Yd?l.flags|=16384:(i=l.updateQueue,i===null?l.updateQueue=new Set([h]):i.add(h),ey(r,h,m)),!1;case 22:return l.flags|=65536,h===Yd?l.flags|=16384:(i=l.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([h])},l.updateQueue=i):(l=i.retryQueue,l===null?i.retryQueue=new Set([h]):l.add(h)),ey(r,h,m)),!1}throw Error(s(435,l.tag))}return ey(r,h,m),wf(),!1}if(kn)return i=Yr.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=m,h!==Kp&&(r=Error(s(422),{cause:h}),Uu(di(r,l)))):(h!==Kp&&(i=Error(s(423),{cause:h}),Uu(di(i,l))),r=r.current.alternate,r.flags|=65536,m&=-m,r.lanes|=m,h=di(h,l),m=Ag(r.stateNode,h,m),ig(r,m),Ns!==4&&(Ns=2)),!1;var y=Error(s(520),{cause:h});if(y=di(y,l),ih===null?ih=[y]:ih.push(y),Ns!==4&&(Ns=2),i===null)return!0;h=di(h,l),l=i;do{switch(l.tag){case 3:return l.flags|=65536,r=m&-m,l.lanes|=r,r=Ag(l.stateNode,h,r),ig(l,r),!1;case 1:if(i=l.type,y=l.stateNode,(l.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(ao===null||!ao.has(y))))return l.flags|=65536,m&=-m,l.lanes|=m,m=xx(m),_x(m,r,l,h),ig(l,m),!1}l=l.return}while(l!==null);return!1}var Rg=Error(s(461)),qs=!1;function fr(r,i,l,h){i.child=r===null?k1(i,null,l,h):hl(i,r.child,l,h)}function wx(r,i,l,h,m){l=l.render;var y=i.ref;if("ref"in h){var w={};for(var j in h)j!=="ref"&&(w[j]=h[j])}else w=h;return ol(i),h=hg(r,i,l,w,y,m),j=dg(),r!==null&&!qs?(fg(r,i,m),ya(r,i,m)):(kn&&j&&Wp(i),i.flags|=1,fr(r,i,h,m),i.child)}function Tx(r,i,l,h,m){if(r===null){var y=l.type;return typeof y=="function"&&!qp(y)&&y.defaultProps===void 0&&l.compare===null?(i.tag=15,i.type=y,Ex(r,i,y,h,m)):(r=$d(l.type,null,h,i,i.mode,m),r.ref=i.ref,r.return=i,i.child=r)}if(y=r.child,!Og(r,m)){var w=y.memoizedProps;if(l=l.compare,l=l!==null?l:Vu,l(w,h)&&r.ref===i.ref)return ya(r,i,m)}return i.flags|=1,r=ha(y,h),r.ref=i.ref,r.return=i,i.child=r}function Ex(r,i,l,h,m){if(r!==null){var y=r.memoizedProps;if(Vu(y,h)&&r.ref===i.ref)if(qs=!1,i.pendingProps=h=y,Og(r,m))(r.flags&131072)!==0&&(qs=!0);else return i.lanes=r.lanes,ya(r,i,m)}return Cg(r,i,l,h,m)}function kx(r,i,l,h){var m=h.children,y=r!==null?r.memoizedState:null;if(r===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((i.flags&128)!==0){if(y=y!==null?y.baseLanes|l:l,r!==null){for(h=i.child=r.child,m=0;h!==null;)m=m|h.lanes|h.childLanes,h=h.sibling;h=m&~y}else h=0,i.child=null;return Sx(r,i,y,l,h)}if((l&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},r!==null&&Kd(i,y!==null?y.cachePool:null),y!==null?N1(i,y):og(),A1(i);else return h=i.lanes=536870912,Sx(r,i,y!==null?y.baseLanes|l:l,l,h)}else y!==null?(Kd(i,y.cachePool),N1(i,y),no(),i.memoizedState=null):(r!==null&&Kd(i,null),og(),no());return fr(r,i,m,l),i.child}function Ju(r,i){return r!==null&&r.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function Sx(r,i,l,h,m){var y=tg();return y=y===null?null:{parent:Fs._currentValue,pool:y},i.memoizedState={baseLanes:l,cachePool:y},r!==null&&Kd(i,null),og(),A1(i),r!==null&&dc(r,i,h,!0),i.childLanes=m,null}function hf(r,i){return i=ff({mode:i.mode,children:i.children},r.mode),i.ref=r.ref,r.child=i,i.return=r,i}function jx(r,i,l){return hl(i,r.child,null,l),r=hf(i,i.pendingProps),r.flags|=2,Xr(i),i.memoizedState=null,r}function BN(r,i,l){var h=i.pendingProps,m=(i.flags&128)!==0;if(i.flags&=-129,r===null){if(kn){if(h.mode==="hidden")return r=hf(i,h),i.lanes=536870912,Ju(null,r);if(cg(i),(r=cs)?(r=B_(r,pi),r=r!==null&&r.data==="&"?r:null,r!==null&&(i.memoizedState={dehydrated:r,treeContext:Ka!==null?{id:qi,overflow:$i}:null,retryLane:536870912,hydrationErrors:null},l=u1(r),l.return=i,i.child=l,hr=i,cs=null)):r=null,r===null)throw Ya(i);return i.lanes=536870912,null}return hf(i,h)}var y=r.memoizedState;if(y!==null){var w=y.dehydrated;if(cg(i),m)if(i.flags&256)i.flags&=-257,i=jx(r,i,l);else if(i.memoizedState!==null)i.child=r.child,i.flags|=128,i=null;else throw Error(s(558));else if(qs||dc(r,i,l,!1),m=(l&r.childLanes)!==0,qs||m){if(h=ns,h!==null&&(w=Bn(h,l),w!==0&&w!==y.retryLane))throw y.retryLane=w,sl(r,w),zr(h,r,w),Rg;wf(),i=jx(r,i,l)}else r=y.treeContext,cs=yi(w.nextSibling),hr=i,kn=!0,Qa=null,pi=!1,r!==null&&f1(i,r),i=hf(i,h),i.flags|=4096;return i}return r=ha(r.child,{mode:h.mode,children:h.children}),r.ref=i.ref,i.child=r,r.return=i,r}function df(r,i){var l=i.ref;if(l===null)r!==null&&r.ref!==null&&(i.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(s(284));(r===null||r.ref!==l)&&(i.flags|=4194816)}}function Cg(r,i,l,h,m){return ol(i),l=hg(r,i,l,h,void 0,m),h=dg(),r!==null&&!qs?(fg(r,i,m),ya(r,i,m)):(kn&&h&&Wp(i),i.flags|=1,fr(r,i,l,m),i.child)}function Nx(r,i,l,h,m,y){return ol(i),i.updateQueue=null,l=C1(i,h,l,m),R1(r),h=dg(),r!==null&&!qs?(fg(r,i,y),ya(r,i,y)):(kn&&h&&Wp(i),i.flags|=1,fr(r,i,l,y),i.child)}function Ax(r,i,l,h,m){if(ol(i),i.stateNode===null){var y=lc,w=l.contextType;typeof w=="object"&&w!==null&&(y=dr(w)),y=new l(h,y),i.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Ng,i.stateNode=y,y._reactInternals=i,y=i.stateNode,y.props=h,y.state=i.memoizedState,y.refs={},sg(i),w=l.contextType,y.context=typeof w=="object"&&w!==null?dr(w):lc,y.state=i.memoizedState,w=l.getDerivedStateFromProps,typeof w=="function"&&(jg(i,l,w,h),y.state=i.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(w=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),w!==y.state&&Ng.enqueueReplaceState(y,y.state,null),Gu(i,h,y,m),Wu(),y.state=i.memoizedState),typeof y.componentDidMount=="function"&&(i.flags|=4194308),h=!0}else if(r===null){y=i.stateNode;var j=i.memoizedProps,F=fl(l,j);y.props=F;var le=y.context,je=l.contextType;w=lc,typeof je=="object"&&je!==null&&(w=dr(je));var Pe=l.getDerivedStateFromProps;je=typeof Pe=="function"||typeof y.getSnapshotBeforeUpdate=="function",j=i.pendingProps!==j,je||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(j||le!==w)&&px(i,y,h,w),Ja=!1;var ue=i.memoizedState;y.state=ue,Gu(i,h,y,m),Wu(),le=i.memoizedState,j||ue!==le||Ja?(typeof Pe=="function"&&(jg(i,l,Pe,h),le=i.memoizedState),(F=Ja||mx(i,l,F,h,ue,le,w))?(je||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(i.flags|=4194308)):(typeof y.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=h,i.memoizedState=le),y.props=h,y.state=le,y.context=w,h=F):(typeof y.componentDidMount=="function"&&(i.flags|=4194308),h=!1)}else{y=i.stateNode,rg(r,i),w=i.memoizedProps,je=fl(l,w),y.props=je,Pe=i.pendingProps,ue=y.context,le=l.contextType,F=lc,typeof le=="object"&&le!==null&&(F=dr(le)),j=l.getDerivedStateFromProps,(le=typeof j=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(w!==Pe||ue!==F)&&px(i,y,h,F),Ja=!1,ue=i.memoizedState,y.state=ue,Gu(i,h,y,m),Wu();var ge=i.memoizedState;w!==Pe||ue!==ge||Ja||r!==null&&r.dependencies!==null&&Wd(r.dependencies)?(typeof j=="function"&&(jg(i,l,j,h),ge=i.memoizedState),(je=Ja||mx(i,l,je,h,ue,ge,F)||r!==null&&r.dependencies!==null&&Wd(r.dependencies))?(le||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(h,ge,F),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(h,ge,F)),typeof y.componentDidUpdate=="function"&&(i.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof y.componentDidUpdate!="function"||w===r.memoizedProps&&ue===r.memoizedState||(i.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||w===r.memoizedProps&&ue===r.memoizedState||(i.flags|=1024),i.memoizedProps=h,i.memoizedState=ge),y.props=h,y.state=ge,y.context=F,h=je):(typeof y.componentDidUpdate!="function"||w===r.memoizedProps&&ue===r.memoizedState||(i.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||w===r.memoizedProps&&ue===r.memoizedState||(i.flags|=1024),h=!1)}return y=h,df(r,i),h=(i.flags&128)!==0,y||h?(y=i.stateNode,l=h&&typeof l.getDerivedStateFromError!="function"?null:y.render(),i.flags|=1,r!==null&&h?(i.child=hl(i,r.child,null,m),i.child=hl(i,null,l,m)):fr(r,i,l,m),i.memoizedState=y.state,r=i.child):r=ya(r,i,m),r}function Rx(r,i,l,h){return il(),i.flags|=256,fr(r,i,l,h),i.child}var Ig={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Dg(r){return{baseLanes:r,cachePool:v1()}}function Pg(r,i,l){return r=r!==null?r.childLanes&~l:0,i&&(r|=Zr),r}function Cx(r,i,l){var h=i.pendingProps,m=!1,y=(i.flags&128)!==0,w;if((w=y)||(w=r!==null&&r.memoizedState===null?!1:(Ms.current&2)!==0),w&&(m=!0,i.flags&=-129),w=(i.flags&32)!==0,i.flags&=-33,r===null){if(kn){if(m?to(i):no(),(r=cs)?(r=B_(r,pi),r=r!==null&&r.data!=="&"?r:null,r!==null&&(i.memoizedState={dehydrated:r,treeContext:Ka!==null?{id:qi,overflow:$i}:null,retryLane:536870912,hydrationErrors:null},l=u1(r),l.return=i,i.child=l,hr=i,cs=null)):r=null,r===null)throw Ya(i);return gy(r)?i.lanes=32:i.lanes=536870912,null}var j=h.children;return h=h.fallback,m?(no(),m=i.mode,j=ff({mode:"hidden",children:j},m),h=rl(h,m,l,null),j.return=i,h.return=i,j.sibling=h,i.child=j,h=i.child,h.memoizedState=Dg(l),h.childLanes=Pg(r,w,l),i.memoizedState=Ig,Ju(null,h)):(to(i),Mg(i,j))}var F=r.memoizedState;if(F!==null&&(j=F.dehydrated,j!==null)){if(y)i.flags&256?(to(i),i.flags&=-257,i=Lg(r,i,l)):i.memoizedState!==null?(no(),i.child=r.child,i.flags|=128,i=null):(no(),j=h.fallback,m=i.mode,h=ff({mode:"visible",children:h.children},m),j=rl(j,m,l,null),j.flags|=2,h.return=i,j.return=i,h.sibling=j,i.child=h,hl(i,r.child,null,l),h=i.child,h.memoizedState=Dg(l),h.childLanes=Pg(r,w,l),i.memoizedState=Ig,i=Ju(null,h));else if(to(i),gy(j)){if(w=j.nextSibling&&j.nextSibling.dataset,w)var le=w.dgst;w=le,h=Error(s(419)),h.stack="",h.digest=w,Uu({value:h,source:null,stack:null}),i=Lg(r,i,l)}else if(qs||dc(r,i,l,!1),w=(l&r.childLanes)!==0,qs||w){if(w=ns,w!==null&&(h=Bn(w,l),h!==0&&h!==F.retryLane))throw F.retryLane=h,sl(r,h),zr(w,r,h),Rg;py(j)||wf(),i=Lg(r,i,l)}else py(j)?(i.flags|=192,i.child=r.child,i=null):(r=F.treeContext,cs=yi(j.nextSibling),hr=i,kn=!0,Qa=null,pi=!1,r!==null&&f1(i,r),i=Mg(i,h.children),i.flags|=4096);return i}return m?(no(),j=h.fallback,m=i.mode,F=r.child,le=F.sibling,h=ha(F,{mode:"hidden",children:h.children}),h.subtreeFlags=F.subtreeFlags&65011712,le!==null?j=ha(le,j):(j=rl(j,m,l,null),j.flags|=2),j.return=i,h.return=i,h.sibling=j,i.child=h,Ju(null,h),h=i.child,j=r.child.memoizedState,j===null?j=Dg(l):(m=j.cachePool,m!==null?(F=Fs._currentValue,m=m.parent!==F?{parent:F,pool:F}:m):m=v1(),j={baseLanes:j.baseLanes|l,cachePool:m}),h.memoizedState=j,h.childLanes=Pg(r,w,l),i.memoizedState=Ig,Ju(r.child,h)):(to(i),l=r.child,r=l.sibling,l=ha(l,{mode:"visible",children:h.children}),l.return=i,l.sibling=null,r!==null&&(w=i.deletions,w===null?(i.deletions=[r],i.flags|=16):w.push(r)),i.child=l,i.memoizedState=null,l)}function Mg(r,i){return i=ff({mode:"visible",children:i},r.mode),i.return=r,r.child=i}function ff(r,i){return r=Qr(22,r,null,i),r.lanes=0,r}function Lg(r,i,l){return hl(i,r.child,null,l),r=Mg(i,i.pendingProps.children),r.flags|=2,i.memoizedState=null,r}function Ix(r,i,l){r.lanes|=i;var h=r.alternate;h!==null&&(h.lanes|=i),Xp(r.return,i,l)}function Vg(r,i,l,h,m,y){var w=r.memoizedState;w===null?r.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:h,tail:l,tailMode:m,treeForkCount:y}:(w.isBackwards=i,w.rendering=null,w.renderingStartTime=0,w.last=h,w.tail=l,w.tailMode=m,w.treeForkCount=y)}function Dx(r,i,l){var h=i.pendingProps,m=h.revealOrder,y=h.tail;h=h.children;var w=Ms.current,j=(w&2)!==0;if(j?(w=w&1|2,i.flags|=128):w&=1,Te(Ms,w),fr(r,i,h,l),h=kn?Bu:0,!j&&r!==null&&(r.flags&128)!==0)e:for(r=i.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Ix(r,l,i);else if(r.tag===19)Ix(r,l,i);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break e;for(;r.sibling===null;){if(r.return===null||r.return===i)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(m){case"forwards":for(l=i.child,m=null;l!==null;)r=l.alternate,r!==null&&ef(r)===null&&(m=l),l=l.sibling;l=m,l===null?(m=i.child,i.child=null):(m=l.sibling,l.sibling=null),Vg(i,!1,m,l,y,h);break;case"backwards":case"unstable_legacy-backwards":for(l=null,m=i.child,i.child=null;m!==null;){if(r=m.alternate,r!==null&&ef(r)===null){i.child=m;break}r=m.sibling,m.sibling=l,l=m,m=r}Vg(i,!0,l,null,y,h);break;case"together":Vg(i,!1,null,null,void 0,h);break;default:i.memoizedState=null}return i.child}function ya(r,i,l){if(r!==null&&(i.dependencies=r.dependencies),io|=i.lanes,(l&i.childLanes)===0)if(r!==null){if(dc(r,i,l,!1),(l&i.childLanes)===0)return null}else return null;if(r!==null&&i.child!==r.child)throw Error(s(153));if(i.child!==null){for(r=i.child,l=ha(r,r.pendingProps),i.child=l,l.return=i;r.sibling!==null;)r=r.sibling,l=l.sibling=ha(r,r.pendingProps),l.return=i;l.sibling=null}return i.child}function Og(r,i){return(r.lanes&i)!==0?!0:(r=r.dependencies,!!(r!==null&&Wd(r)))}function UN(r,i,l){switch(i.tag){case 3:gt(i,i.stateNode.containerInfo),Xa(i,Fs,r.memoizedState.cache),il();break;case 27:case 5:qt(i);break;case 4:gt(i,i.stateNode.containerInfo);break;case 10:Xa(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,cg(i),null;break;case 13:var h=i.memoizedState;if(h!==null)return h.dehydrated!==null?(to(i),i.flags|=128,null):(l&i.child.childLanes)!==0?Cx(r,i,l):(to(i),r=ya(r,i,l),r!==null?r.sibling:null);to(i);break;case 19:var m=(r.flags&128)!==0;if(h=(l&i.childLanes)!==0,h||(dc(r,i,l,!1),h=(l&i.childLanes)!==0),m){if(h)return Dx(r,i,l);i.flags|=128}if(m=i.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),Te(Ms,Ms.current),h)break;return null;case 22:return i.lanes=0,kx(r,i,l,i.pendingProps);case 24:Xa(i,Fs,r.memoizedState.cache)}return ya(r,i,l)}function Px(r,i,l){if(r!==null)if(r.memoizedProps!==i.pendingProps)qs=!0;else{if(!Og(r,l)&&(i.flags&128)===0)return qs=!1,UN(r,i,l);qs=(r.flags&131072)!==0}else qs=!1,kn&&(i.flags&1048576)!==0&&d1(i,Bu,i.index);switch(i.lanes=0,i.tag){case 16:e:{var h=i.pendingProps;if(r=cl(i.elementType),i.type=r,typeof r=="function")qp(r)?(h=fl(r,h),i.tag=1,i=Ax(null,i,r,h,l)):(i.tag=0,i=Cg(null,i,r,h,l));else{if(r!=null){var m=r.$$typeof;if(m===de){i.tag=11,i=wx(null,i,r,h,l);break e}else if(m===A){i.tag=14,i=Tx(null,i,r,h,l);break e}}throw i=He(r)||r,Error(s(306,i,""))}}return i;case 0:return Cg(r,i,i.type,i.pendingProps,l);case 1:return h=i.type,m=fl(h,i.pendingProps),Ax(r,i,h,m,l);case 3:e:{if(gt(i,i.stateNode.containerInfo),r===null)throw Error(s(387));h=i.pendingProps;var y=i.memoizedState;m=y.element,rg(r,i),Gu(i,h,null,l);var w=i.memoizedState;if(h=w.cache,Xa(i,Fs,h),h!==y.cache&&Jp(i,[Fs],l,!0),Wu(),h=w.element,y.isDehydrated)if(y={element:h,isDehydrated:!1,cache:w.cache},i.updateQueue.baseState=y,i.memoizedState=y,i.flags&256){i=Rx(r,i,h,l);break e}else if(h!==m){m=di(Error(s(424)),i),Uu(m),i=Rx(r,i,h,l);break e}else for(r=i.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,cs=yi(r.firstChild),hr=i,kn=!0,Qa=null,pi=!0,l=k1(i,null,h,l),i.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(il(),h===m){i=ya(r,i,l);break e}fr(r,i,h,l)}i=i.child}return i;case 26:return df(r,i),r===null?(l=H_(i.type,null,i.pendingProps,null))?i.memoizedState=l:kn||(l=i.type,r=i.pendingProps,h=Af(Me.current).createElement(l),h[rt]=i,h[Rt]=r,mr(h,l,r),C(h),i.stateNode=h):i.memoizedState=H_(i.type,r.memoizedProps,i.pendingProps,r.memoizedState),null;case 27:return qt(i),r===null&&kn&&(h=i.stateNode=z_(i.type,i.pendingProps,Me.current),hr=i,pi=!0,m=cs,uo(i.type)?(yy=m,cs=yi(h.firstChild)):cs=m),fr(r,i,i.pendingProps.children,l),df(r,i),r===null&&(i.flags|=4194304),i.child;case 5:return r===null&&kn&&((m=h=cs)&&(h=gA(h,i.type,i.pendingProps,pi),h!==null?(i.stateNode=h,hr=i,cs=yi(h.firstChild),pi=!1,m=!0):m=!1),m||Ya(i)),qt(i),m=i.type,y=i.pendingProps,w=r!==null?r.memoizedProps:null,h=y.children,dy(m,y)?h=null:w!==null&&dy(m,w)&&(i.flags|=32),i.memoizedState!==null&&(m=hg(r,i,CN,null,null,l),fh._currentValue=m),df(r,i),fr(r,i,h,l),i.child;case 6:return r===null&&kn&&((r=l=cs)&&(l=yA(l,i.pendingProps,pi),l!==null?(i.stateNode=l,hr=i,cs=null,r=!0):r=!1),r||Ya(i)),null;case 13:return Cx(r,i,l);case 4:return gt(i,i.stateNode.containerInfo),h=i.pendingProps,r===null?i.child=hl(i,null,h,l):fr(r,i,h,l),i.child;case 11:return wx(r,i,i.type,i.pendingProps,l);case 7:return fr(r,i,i.pendingProps,l),i.child;case 8:return fr(r,i,i.pendingProps.children,l),i.child;case 12:return fr(r,i,i.pendingProps.children,l),i.child;case 10:return h=i.pendingProps,Xa(i,i.type,h.value),fr(r,i,h.children,l),i.child;case 9:return m=i.type._context,h=i.pendingProps.children,ol(i),m=dr(m),h=h(m),i.flags|=1,fr(r,i,h,l),i.child;case 14:return Tx(r,i,i.type,i.pendingProps,l);case 15:return Ex(r,i,i.type,i.pendingProps,l);case 19:return Dx(r,i,l);case 31:return BN(r,i,l);case 22:return kx(r,i,l,i.pendingProps);case 24:return ol(i),h=dr(Fs),r===null?(m=tg(),m===null&&(m=ns,y=Zp(),m.pooledCache=y,y.refCount++,y!==null&&(m.pooledCacheLanes|=l),m=y),i.memoizedState={parent:h,cache:m},sg(i),Xa(i,Fs,m)):((r.lanes&l)!==0&&(rg(r,i),Gu(i,null,null,l),Wu()),m=r.memoizedState,y=i.memoizedState,m.parent!==h?(m={parent:h,cache:h},i.memoizedState=m,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=m),Xa(i,Fs,h)):(h=y.cache,Xa(i,Fs,h),h!==m.cache&&Jp(i,[Fs],l,!0))),fr(r,i,i.pendingProps.children,l),i.child;case 29:throw i.pendingProps}throw Error(s(156,i.tag))}function ba(r){r.flags|=4}function Bg(r,i,l,h,m){if((i=(r.mode&32)!==0)&&(i=!1),i){if(r.flags|=16777216,(m&335544128)===m)if(r.stateNode.complete)r.flags|=8192;else if(o_())r.flags|=8192;else throw ul=Yd,ng}else r.flags&=-16777217}function Mx(r,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!Y_(i))if(o_())r.flags|=8192;else throw ul=Yd,ng}function mf(r,i){i!==null&&(r.flags|=4),r.flags&16384&&(i=r.tag!==22?Yt():536870912,r.lanes|=i,Ec|=i)}function Zu(r,i){if(!kn)switch(r.tailMode){case"hidden":i=r.tail;for(var l=null;i!==null;)i.alternate!==null&&(l=i),i=i.sibling;l===null?r.tail=null:l.sibling=null;break;case"collapsed":l=r.tail;for(var h=null;l!==null;)l.alternate!==null&&(h=l),l=l.sibling;h===null?i||r.tail===null?r.tail=null:r.tail.sibling=null:h.sibling=null}}function us(r){var i=r.alternate!==null&&r.alternate.child===r.child,l=0,h=0;if(i)for(var m=r.child;m!==null;)l|=m.lanes|m.childLanes,h|=m.subtreeFlags&65011712,h|=m.flags&65011712,m.return=r,m=m.sibling;else for(m=r.child;m!==null;)l|=m.lanes|m.childLanes,h|=m.subtreeFlags,h|=m.flags,m.return=r,m=m.sibling;return r.subtreeFlags|=h,r.childLanes=l,i}function FN(r,i,l){var h=i.pendingProps;switch(Gp(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return us(i),null;case 1:return us(i),null;case 3:return l=i.stateNode,h=null,r!==null&&(h=r.memoizedState.cache),i.memoizedState.cache!==h&&(i.flags|=2048),ma(Fs),et(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(r===null||r.child===null)&&(hc(i)?ba(i):r===null||r.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Qp())),us(i),null;case 26:var m=i.type,y=i.memoizedState;return r===null?(ba(i),y!==null?(us(i),Mx(i,y)):(us(i),Bg(i,m,null,h,l))):y?y!==r.memoizedState?(ba(i),us(i),Mx(i,y)):(us(i),i.flags&=-16777217):(r=r.memoizedProps,r!==h&&ba(i),us(i),Bg(i,m,r,h,l)),null;case 27:if(Dn(i),l=Me.current,m=i.type,r!==null&&i.stateNode!=null)r.memoizedProps!==h&&ba(i);else{if(!h){if(i.stateNode===null)throw Error(s(166));return us(i),null}r=Re.current,hc(i)?m1(i):(r=z_(m,h,l),i.stateNode=r,ba(i))}return us(i),null;case 5:if(Dn(i),m=i.type,r!==null&&i.stateNode!=null)r.memoizedProps!==h&&ba(i);else{if(!h){if(i.stateNode===null)throw Error(s(166));return us(i),null}if(y=Re.current,hc(i))m1(i);else{var w=Af(Me.current);switch(y){case 1:y=w.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:y=w.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":y=w.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":y=w.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":y=w.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof h.is=="string"?w.createElement("select",{is:h.is}):w.createElement("select"),h.multiple?y.multiple=!0:h.size&&(y.size=h.size);break;default:y=typeof h.is=="string"?w.createElement(m,{is:h.is}):w.createElement(m)}}y[rt]=i,y[Rt]=h;e:for(w=i.child;w!==null;){if(w.tag===5||w.tag===6)y.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===i)break e;for(;w.sibling===null;){if(w.return===null||w.return===i)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}i.stateNode=y;e:switch(mr(y,m,h),m){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}h&&ba(i)}}return us(i),Bg(i,i.type,r===null?null:r.memoizedProps,i.pendingProps,l),null;case 6:if(r&&i.stateNode!=null)r.memoizedProps!==h&&ba(i);else{if(typeof h!="string"&&i.stateNode===null)throw Error(s(166));if(r=Me.current,hc(i)){if(r=i.stateNode,l=i.memoizedProps,h=null,m=hr,m!==null)switch(m.tag){case 27:case 5:h=m.memoizedProps}r[rt]=i,r=!!(r.nodeValue===l||h!==null&&h.suppressHydrationWarning===!0||C_(r.nodeValue,l)),r||Ya(i,!0)}else r=Af(r).createTextNode(h),r[rt]=i,i.stateNode=r}return us(i),null;case 31:if(l=i.memoizedState,r===null||r.memoizedState!==null){if(h=hc(i),l!==null){if(r===null){if(!h)throw Error(s(318));if(r=i.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(557));r[rt]=i}else il(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;us(i),r=!1}else l=Qp(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=l),r=!0;if(!r)return i.flags&256?(Xr(i),i):(Xr(i),null);if((i.flags&128)!==0)throw Error(s(558))}return us(i),null;case 13:if(h=i.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(m=hc(i),h!==null&&h.dehydrated!==null){if(r===null){if(!m)throw Error(s(318));if(m=i.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(s(317));m[rt]=i}else il(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;us(i),m=!1}else m=Qp(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=m),m=!0;if(!m)return i.flags&256?(Xr(i),i):(Xr(i),null)}return Xr(i),(i.flags&128)!==0?(i.lanes=l,i):(l=h!==null,r=r!==null&&r.memoizedState!==null,l&&(h=i.child,m=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(m=h.alternate.memoizedState.cachePool.pool),y=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(y=h.memoizedState.cachePool.pool),y!==m&&(h.flags|=2048)),l!==r&&l&&(i.child.flags|=8192),mf(i,i.updateQueue),us(i),null);case 4:return et(),r===null&&oy(i.stateNode.containerInfo),us(i),null;case 10:return ma(i.type),us(i),null;case 19:if(K(Ms),h=i.memoizedState,h===null)return us(i),null;if(m=(i.flags&128)!==0,y=h.rendering,y===null)if(m)Zu(h,!1);else{if(Ns!==0||r!==null&&(r.flags&128)!==0)for(r=i.child;r!==null;){if(y=ef(r),y!==null){for(i.flags|=128,Zu(h,!1),r=y.updateQueue,i.updateQueue=r,mf(i,r),i.subtreeFlags=0,r=l,l=i.child;l!==null;)c1(l,r),l=l.sibling;return Te(Ms,Ms.current&1|2),kn&&da(i,h.treeForkCount),i.child}r=r.sibling}h.tail!==null&&un()>vf&&(i.flags|=128,m=!0,Zu(h,!1),i.lanes=4194304)}else{if(!m)if(r=ef(y),r!==null){if(i.flags|=128,m=!0,r=r.updateQueue,i.updateQueue=r,mf(i,r),Zu(h,!0),h.tail===null&&h.tailMode==="hidden"&&!y.alternate&&!kn)return us(i),null}else 2*un()-h.renderingStartTime>vf&&l!==536870912&&(i.flags|=128,m=!0,Zu(h,!1),i.lanes=4194304);h.isBackwards?(y.sibling=i.child,i.child=y):(r=h.last,r!==null?r.sibling=y:i.child=y,h.last=y)}return h.tail!==null?(r=h.tail,h.rendering=r,h.tail=r.sibling,h.renderingStartTime=un(),r.sibling=null,l=Ms.current,Te(Ms,m?l&1|2:l&1),kn&&da(i,h.treeForkCount),r):(us(i),null);case 22:case 23:return Xr(i),lg(),h=i.memoizedState!==null,r!==null?r.memoizedState!==null!==h&&(i.flags|=8192):h&&(i.flags|=8192),h?(l&536870912)!==0&&(i.flags&128)===0&&(us(i),i.subtreeFlags&6&&(i.flags|=8192)):us(i),l=i.updateQueue,l!==null&&mf(i,l.retryQueue),l=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),h=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(h=i.memoizedState.cachePool.pool),h!==l&&(i.flags|=2048),r!==null&&K(ll),null;case 24:return l=null,r!==null&&(l=r.memoizedState.cache),i.memoizedState.cache!==l&&(i.flags|=2048),ma(Fs),us(i),null;case 25:return null;case 30:return null}throw Error(s(156,i.tag))}function zN(r,i){switch(Gp(i),i.tag){case 1:return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 3:return ma(Fs),et(),r=i.flags,(r&65536)!==0&&(r&128)===0?(i.flags=r&-65537|128,i):null;case 26:case 27:case 5:return Dn(i),null;case 31:if(i.memoizedState!==null){if(Xr(i),i.alternate===null)throw Error(s(340));il()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 13:if(Xr(i),r=i.memoizedState,r!==null&&r.dehydrated!==null){if(i.alternate===null)throw Error(s(340));il()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 19:return K(Ms),null;case 4:return et(),null;case 10:return ma(i.type),null;case 22:case 23:return Xr(i),lg(),r!==null&&K(ll),r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 24:return ma(Fs),null;case 25:return null;default:return null}}function Lx(r,i){switch(Gp(i),i.tag){case 3:ma(Fs),et();break;case 26:case 27:case 5:Dn(i);break;case 4:et();break;case 31:i.memoizedState!==null&&Xr(i);break;case 13:Xr(i);break;case 19:K(Ms);break;case 10:ma(i.type);break;case 22:case 23:Xr(i),lg(),r!==null&&K(ll);break;case 24:ma(Fs)}}function eh(r,i){try{var l=i.updateQueue,h=l!==null?l.lastEffect:null;if(h!==null){var m=h.next;l=m;do{if((l.tag&r)===r){h=void 0;var y=l.create,w=l.inst;h=y(),w.destroy=h}l=l.next}while(l!==m)}}catch(j){Wn(i,i.return,j)}}function so(r,i,l){try{var h=i.updateQueue,m=h!==null?h.lastEffect:null;if(m!==null){var y=m.next;h=y;do{if((h.tag&r)===r){var w=h.inst,j=w.destroy;if(j!==void 0){w.destroy=void 0,m=i;var F=l,le=j;try{le()}catch(je){Wn(m,F,je)}}}h=h.next}while(h!==y)}}catch(je){Wn(i,i.return,je)}}function Vx(r){var i=r.updateQueue;if(i!==null){var l=r.stateNode;try{j1(i,l)}catch(h){Wn(r,r.return,h)}}}function Ox(r,i,l){l.props=fl(r.type,r.memoizedProps),l.state=r.memoizedState;try{l.componentWillUnmount()}catch(h){Wn(r,i,h)}}function th(r,i){try{var l=r.ref;if(l!==null){switch(r.tag){case 26:case 27:case 5:var h=r.stateNode;break;case 30:h=r.stateNode;break;default:h=r.stateNode}typeof l=="function"?r.refCleanup=l(h):l.current=h}}catch(m){Wn(r,i,m)}}function Hi(r,i){var l=r.ref,h=r.refCleanup;if(l!==null)if(typeof h=="function")try{h()}catch(m){Wn(r,i,m)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(m){Wn(r,i,m)}else l.current=null}function Bx(r){var i=r.type,l=r.memoizedProps,h=r.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":l.autoFocus&&h.focus();break e;case"img":l.src?h.src=l.src:l.srcSet&&(h.srcset=l.srcSet)}}catch(m){Wn(r,r.return,m)}}function Ug(r,i,l){try{var h=r.stateNode;uA(h,r.type,l,i),h[Rt]=i}catch(m){Wn(r,r.return,m)}}function Ux(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&uo(r.type)||r.tag===4}function Fg(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Ux(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&uo(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function zg(r,i,l){var h=r.tag;if(h===5||h===6)r=r.stateNode,i?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(r,i):(i=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,i.appendChild(r),l=l._reactRootContainer,l!=null||i.onclick!==null||(i.onclick=os));else if(h!==4&&(h===27&&uo(r.type)&&(l=r.stateNode,i=null),r=r.child,r!==null))for(zg(r,i,l),r=r.sibling;r!==null;)zg(r,i,l),r=r.sibling}function pf(r,i,l){var h=r.tag;if(h===5||h===6)r=r.stateNode,i?l.insertBefore(r,i):l.appendChild(r);else if(h!==4&&(h===27&&uo(r.type)&&(l=r.stateNode),r=r.child,r!==null))for(pf(r,i,l),r=r.sibling;r!==null;)pf(r,i,l),r=r.sibling}function Fx(r){var i=r.stateNode,l=r.memoizedProps;try{for(var h=r.type,m=i.attributes;m.length;)i.removeAttributeNode(m[0]);mr(i,h,l),i[rt]=r,i[Rt]=l}catch(y){Wn(r,r.return,y)}}var va=!1,$s=!1,qg=!1,zx=typeof WeakSet=="function"?WeakSet:Set,nr=null;function qN(r,i){if(r=r.containerInfo,uy=Lf,r=e1(r),Lp(r)){if("selectionStart"in r)var l={start:r.selectionStart,end:r.selectionEnd};else e:{l=(l=r.ownerDocument)&&l.defaultView||window;var h=l.getSelection&&l.getSelection();if(h&&h.rangeCount!==0){l=h.anchorNode;var m=h.anchorOffset,y=h.focusNode;h=h.focusOffset;try{l.nodeType,y.nodeType}catch{l=null;break e}var w=0,j=-1,F=-1,le=0,je=0,Pe=r,ue=null;t:for(;;){for(var ge;Pe!==l||m!==0&&Pe.nodeType!==3||(j=w+m),Pe!==y||h!==0&&Pe.nodeType!==3||(F=w+h),Pe.nodeType===3&&(w+=Pe.nodeValue.length),(ge=Pe.firstChild)!==null;)ue=Pe,Pe=ge;for(;;){if(Pe===r)break t;if(ue===l&&++le===m&&(j=w),ue===y&&++je===h&&(F=w),(ge=Pe.nextSibling)!==null)break;Pe=ue,ue=Pe.parentNode}Pe=ge}l=j===-1||F===-1?null:{start:j,end:F}}else l=null}l=l||{start:0,end:0}}else l=null;for(hy={focusedElem:r,selectionRange:l},Lf=!1,nr=i;nr!==null;)if(i=nr,r=i.child,(i.subtreeFlags&1028)!==0&&r!==null)r.return=i,nr=r;else for(;nr!==null;){switch(i=nr,y=i.alternate,r=i.flags,i.tag){case 0:if((r&4)!==0&&(r=i.updateQueue,r=r!==null?r.events:null,r!==null))for(l=0;l<r.length;l++)m=r[l],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&y!==null){r=void 0,l=i,m=y.memoizedProps,y=y.memoizedState,h=l.stateNode;try{var ft=fl(l.type,m);r=h.getSnapshotBeforeUpdate(ft,y),h.__reactInternalSnapshotBeforeUpdate=r}catch(Pt){Wn(l,l.return,Pt)}}break;case 3:if((r&1024)!==0){if(r=i.stateNode.containerInfo,l=r.nodeType,l===9)my(r);else if(l===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":my(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(s(163))}if(r=i.sibling,r!==null){r.return=i.return,nr=r;break}nr=i.return}}function qx(r,i,l){var h=l.flags;switch(l.tag){case 0:case 11:case 15:_a(r,l),h&4&&eh(5,l);break;case 1:if(_a(r,l),h&4)if(r=l.stateNode,i===null)try{r.componentDidMount()}catch(w){Wn(l,l.return,w)}else{var m=fl(l.type,i.memoizedProps);i=i.memoizedState;try{r.componentDidUpdate(m,i,r.__reactInternalSnapshotBeforeUpdate)}catch(w){Wn(l,l.return,w)}}h&64&&Vx(l),h&512&&th(l,l.return);break;case 3:if(_a(r,l),h&64&&(r=l.updateQueue,r!==null)){if(i=null,l.child!==null)switch(l.child.tag){case 27:case 5:i=l.child.stateNode;break;case 1:i=l.child.stateNode}try{j1(r,i)}catch(w){Wn(l,l.return,w)}}break;case 27:i===null&&h&4&&Fx(l);case 26:case 5:_a(r,l),i===null&&h&4&&Bx(l),h&512&&th(l,l.return);break;case 12:_a(r,l);break;case 31:_a(r,l),h&4&&Wx(r,l);break;case 13:_a(r,l),h&4&&Gx(r,l),h&64&&(r=l.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(l=JN.bind(null,l),bA(r,l))));break;case 22:if(h=l.memoizedState!==null||va,!h){i=i!==null&&i.memoizedState!==null||$s,m=va;var y=$s;va=h,($s=i)&&!y?wa(r,l,(l.subtreeFlags&8772)!==0):_a(r,l),va=m,$s=y}break;case 30:break;default:_a(r,l)}}function $x(r){var i=r.alternate;i!==null&&(r.alternate=null,$x(i)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(i=r.stateNode,i!==null&&Ds(i)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var ps=null,Or=!1;function xa(r,i,l){for(l=l.child;l!==null;)Hx(r,i,l),l=l.sibling}function Hx(r,i,l){if(Fe&&typeof Fe.onCommitFiberUnmount=="function")try{Fe.onCommitFiberUnmount(tt,l)}catch{}switch(l.tag){case 26:$s||Hi(l,i),xa(r,i,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:$s||Hi(l,i);var h=ps,m=Or;uo(l.type)&&(ps=l.stateNode,Or=!1),xa(r,i,l),uh(l.stateNode),ps=h,Or=m;break;case 5:$s||Hi(l,i);case 6:if(h=ps,m=Or,ps=null,xa(r,i,l),ps=h,Or=m,ps!==null)if(Or)try{(ps.nodeType===9?ps.body:ps.nodeName==="HTML"?ps.ownerDocument.body:ps).removeChild(l.stateNode)}catch(y){Wn(l,i,y)}else try{ps.removeChild(l.stateNode)}catch(y){Wn(l,i,y)}break;case 18:ps!==null&&(Or?(r=ps,V_(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,l.stateNode),Ic(r)):V_(ps,l.stateNode));break;case 4:h=ps,m=Or,ps=l.stateNode.containerInfo,Or=!0,xa(r,i,l),ps=h,Or=m;break;case 0:case 11:case 14:case 15:so(2,l,i),$s||so(4,l,i),xa(r,i,l);break;case 1:$s||(Hi(l,i),h=l.stateNode,typeof h.componentWillUnmount=="function"&&Ox(l,i,h)),xa(r,i,l);break;case 21:xa(r,i,l);break;case 22:$s=(h=$s)||l.memoizedState!==null,xa(r,i,l),$s=h;break;default:xa(r,i,l)}}function Wx(r,i){if(i.memoizedState===null&&(r=i.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Ic(r)}catch(l){Wn(i,i.return,l)}}}function Gx(r,i){if(i.memoizedState===null&&(r=i.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Ic(r)}catch(l){Wn(i,i.return,l)}}function $N(r){switch(r.tag){case 31:case 13:case 19:var i=r.stateNode;return i===null&&(i=r.stateNode=new zx),i;case 22:return r=r.stateNode,i=r._retryCache,i===null&&(i=r._retryCache=new zx),i;default:throw Error(s(435,r.tag))}}function gf(r,i){var l=$N(r);i.forEach(function(h){if(!l.has(h)){l.add(h);var m=ZN.bind(null,r,h);h.then(m,m)}})}function Br(r,i){var l=i.deletions;if(l!==null)for(var h=0;h<l.length;h++){var m=l[h],y=r,w=i,j=w;e:for(;j!==null;){switch(j.tag){case 27:if(uo(j.type)){ps=j.stateNode,Or=!1;break e}break;case 5:ps=j.stateNode,Or=!1;break e;case 3:case 4:ps=j.stateNode.containerInfo,Or=!0;break e}j=j.return}if(ps===null)throw Error(s(160));Hx(y,w,m),ps=null,Or=!1,y=m.alternate,y!==null&&(y.return=null),m.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)Kx(i,r),i=i.sibling}var Ni=null;function Kx(r,i){var l=r.alternate,h=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Br(i,r),Ur(r),h&4&&(so(3,r,r.return),eh(3,r),so(5,r,r.return));break;case 1:Br(i,r),Ur(r),h&512&&($s||l===null||Hi(l,l.return)),h&64&&va&&(r=r.updateQueue,r!==null&&(h=r.callbacks,h!==null&&(l=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=l===null?h:l.concat(h))));break;case 26:var m=Ni;if(Br(i,r),Ur(r),h&512&&($s||l===null||Hi(l,l.return)),h&4){var y=l!==null?l.memoizedState:null;if(h=r.memoizedState,l===null)if(h===null)if(r.stateNode===null){e:{h=r.type,l=r.memoizedProps,m=m.ownerDocument||m;t:switch(h){case"title":y=m.getElementsByTagName("title")[0],(!y||y[Ts]||y[rt]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=m.createElement(h),m.head.insertBefore(y,m.querySelector("head > title"))),mr(y,h,l),y[rt]=r,C(y),h=y;break e;case"link":var w=K_("link","href",m).get(h+(l.href||""));if(w){for(var j=0;j<w.length;j++)if(y=w[j],y.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&y.getAttribute("rel")===(l.rel==null?null:l.rel)&&y.getAttribute("title")===(l.title==null?null:l.title)&&y.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){w.splice(j,1);break t}}y=m.createElement(h),mr(y,h,l),m.head.appendChild(y);break;case"meta":if(w=K_("meta","content",m).get(h+(l.content||""))){for(j=0;j<w.length;j++)if(y=w[j],y.getAttribute("content")===(l.content==null?null:""+l.content)&&y.getAttribute("name")===(l.name==null?null:l.name)&&y.getAttribute("property")===(l.property==null?null:l.property)&&y.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&y.getAttribute("charset")===(l.charSet==null?null:l.charSet)){w.splice(j,1);break t}}y=m.createElement(h),mr(y,h,l),m.head.appendChild(y);break;default:throw Error(s(468,h))}y[rt]=r,C(y),h=y}r.stateNode=h}else Q_(m,r.type,r.stateNode);else r.stateNode=G_(m,h,r.memoizedProps);else y!==h?(y===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):y.count--,h===null?Q_(m,r.type,r.stateNode):G_(m,h,r.memoizedProps)):h===null&&r.stateNode!==null&&Ug(r,r.memoizedProps,l.memoizedProps)}break;case 27:Br(i,r),Ur(r),h&512&&($s||l===null||Hi(l,l.return)),l!==null&&h&4&&Ug(r,r.memoizedProps,l.memoizedProps);break;case 5:if(Br(i,r),Ur(r),h&512&&($s||l===null||Hi(l,l.return)),r.flags&32){m=r.stateNode;try{Es(m,"")}catch(ft){Wn(r,r.return,ft)}}h&4&&r.stateNode!=null&&(m=r.memoizedProps,Ug(r,m,l!==null?l.memoizedProps:m)),h&1024&&(qg=!0);break;case 6:if(Br(i,r),Ur(r),h&4){if(r.stateNode===null)throw Error(s(162));h=r.memoizedProps,l=r.stateNode;try{l.nodeValue=h}catch(ft){Wn(r,r.return,ft)}}break;case 3:if(If=null,m=Ni,Ni=Rf(i.containerInfo),Br(i,r),Ni=m,Ur(r),h&4&&l!==null&&l.memoizedState.isDehydrated)try{Ic(i.containerInfo)}catch(ft){Wn(r,r.return,ft)}qg&&(qg=!1,Qx(r));break;case 4:h=Ni,Ni=Rf(r.stateNode.containerInfo),Br(i,r),Ur(r),Ni=h;break;case 12:Br(i,r),Ur(r);break;case 31:Br(i,r),Ur(r),h&4&&(h=r.updateQueue,h!==null&&(r.updateQueue=null,gf(r,h)));break;case 13:Br(i,r),Ur(r),r.child.flags&8192&&r.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(bf=un()),h&4&&(h=r.updateQueue,h!==null&&(r.updateQueue=null,gf(r,h)));break;case 22:m=r.memoizedState!==null;var F=l!==null&&l.memoizedState!==null,le=va,je=$s;if(va=le||m,$s=je||F,Br(i,r),$s=je,va=le,Ur(r),h&8192)e:for(i=r.stateNode,i._visibility=m?i._visibility&-2:i._visibility|1,m&&(l===null||F||va||$s||ml(r)),l=null,i=r;;){if(i.tag===5||i.tag===26){if(l===null){F=l=i;try{if(y=F.stateNode,m)w=y.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{j=F.stateNode;var Pe=F.memoizedProps.style,ue=Pe!=null&&Pe.hasOwnProperty("display")?Pe.display:null;j.style.display=ue==null||typeof ue=="boolean"?"":(""+ue).trim()}}catch(ft){Wn(F,F.return,ft)}}}else if(i.tag===6){if(l===null){F=i;try{F.stateNode.nodeValue=m?"":F.memoizedProps}catch(ft){Wn(F,F.return,ft)}}}else if(i.tag===18){if(l===null){F=i;try{var ge=F.stateNode;m?O_(ge,!0):O_(F.stateNode,!1)}catch(ft){Wn(F,F.return,ft)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===r)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break e;for(;i.sibling===null;){if(i.return===null||i.return===r)break e;l===i&&(l=null),i=i.return}l===i&&(l=null),i.sibling.return=i.return,i=i.sibling}h&4&&(h=r.updateQueue,h!==null&&(l=h.retryQueue,l!==null&&(h.retryQueue=null,gf(r,l))));break;case 19:Br(i,r),Ur(r),h&4&&(h=r.updateQueue,h!==null&&(r.updateQueue=null,gf(r,h)));break;case 30:break;case 21:break;default:Br(i,r),Ur(r)}}function Ur(r){var i=r.flags;if(i&2){try{for(var l,h=r.return;h!==null;){if(Ux(h)){l=h;break}h=h.return}if(l==null)throw Error(s(160));switch(l.tag){case 27:var m=l.stateNode,y=Fg(r);pf(r,y,m);break;case 5:var w=l.stateNode;l.flags&32&&(Es(w,""),l.flags&=-33);var j=Fg(r);pf(r,j,w);break;case 3:case 4:var F=l.stateNode.containerInfo,le=Fg(r);zg(r,le,F);break;default:throw Error(s(161))}}catch(je){Wn(r,r.return,je)}r.flags&=-3}i&4096&&(r.flags&=-4097)}function Qx(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var i=r;Qx(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),r=r.sibling}}function _a(r,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)qx(r,i.alternate,i),i=i.sibling}function ml(r){for(r=r.child;r!==null;){var i=r;switch(i.tag){case 0:case 11:case 14:case 15:so(4,i,i.return),ml(i);break;case 1:Hi(i,i.return);var l=i.stateNode;typeof l.componentWillUnmount=="function"&&Ox(i,i.return,l),ml(i);break;case 27:uh(i.stateNode);case 26:case 5:Hi(i,i.return),ml(i);break;case 22:i.memoizedState===null&&ml(i);break;case 30:ml(i);break;default:ml(i)}r=r.sibling}}function wa(r,i,l){for(l=l&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var h=i.alternate,m=r,y=i,w=y.flags;switch(y.tag){case 0:case 11:case 15:wa(m,y,l),eh(4,y);break;case 1:if(wa(m,y,l),h=y,m=h.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(le){Wn(h,h.return,le)}if(h=y,m=h.updateQueue,m!==null){var j=h.stateNode;try{var F=m.shared.hiddenCallbacks;if(F!==null)for(m.shared.hiddenCallbacks=null,m=0;m<F.length;m++)S1(F[m],j)}catch(le){Wn(h,h.return,le)}}l&&w&64&&Vx(y),th(y,y.return);break;case 27:Fx(y);case 26:case 5:wa(m,y,l),l&&h===null&&w&4&&Bx(y),th(y,y.return);break;case 12:wa(m,y,l);break;case 31:wa(m,y,l),l&&w&4&&Wx(m,y);break;case 13:wa(m,y,l),l&&w&4&&Gx(m,y);break;case 22:y.memoizedState===null&&wa(m,y,l),th(y,y.return);break;case 30:break;default:wa(m,y,l)}i=i.sibling}}function $g(r,i){var l=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),r=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(r=i.memoizedState.cachePool.pool),r!==l&&(r!=null&&r.refCount++,l!=null&&Fu(l))}function Hg(r,i){r=null,i.alternate!==null&&(r=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==r&&(i.refCount++,r!=null&&Fu(r))}function Ai(r,i,l,h){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Yx(r,i,l,h),i=i.sibling}function Yx(r,i,l,h){var m=i.flags;switch(i.tag){case 0:case 11:case 15:Ai(r,i,l,h),m&2048&&eh(9,i);break;case 1:Ai(r,i,l,h);break;case 3:Ai(r,i,l,h),m&2048&&(r=null,i.alternate!==null&&(r=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==r&&(i.refCount++,r!=null&&Fu(r)));break;case 12:if(m&2048){Ai(r,i,l,h),r=i.stateNode;try{var y=i.memoizedProps,w=y.id,j=y.onPostCommit;typeof j=="function"&&j(w,i.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(F){Wn(i,i.return,F)}}else Ai(r,i,l,h);break;case 31:Ai(r,i,l,h);break;case 13:Ai(r,i,l,h);break;case 23:break;case 22:y=i.stateNode,w=i.alternate,i.memoizedState!==null?y._visibility&2?Ai(r,i,l,h):nh(r,i):y._visibility&2?Ai(r,i,l,h):(y._visibility|=2,_c(r,i,l,h,(i.subtreeFlags&10256)!==0||!1)),m&2048&&$g(w,i);break;case 24:Ai(r,i,l,h),m&2048&&Hg(i.alternate,i);break;default:Ai(r,i,l,h)}}function _c(r,i,l,h,m){for(m=m&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var y=r,w=i,j=l,F=h,le=w.flags;switch(w.tag){case 0:case 11:case 15:_c(y,w,j,F,m),eh(8,w);break;case 23:break;case 22:var je=w.stateNode;w.memoizedState!==null?je._visibility&2?_c(y,w,j,F,m):nh(y,w):(je._visibility|=2,_c(y,w,j,F,m)),m&&le&2048&&$g(w.alternate,w);break;case 24:_c(y,w,j,F,m),m&&le&2048&&Hg(w.alternate,w);break;default:_c(y,w,j,F,m)}i=i.sibling}}function nh(r,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var l=r,h=i,m=h.flags;switch(h.tag){case 22:nh(l,h),m&2048&&$g(h.alternate,h);break;case 24:nh(l,h),m&2048&&Hg(h.alternate,h);break;default:nh(l,h)}i=i.sibling}}var sh=8192;function wc(r,i,l){if(r.subtreeFlags&sh)for(r=r.child;r!==null;)Xx(r,i,l),r=r.sibling}function Xx(r,i,l){switch(r.tag){case 26:wc(r,i,l),r.flags&sh&&r.memoizedState!==null&&RA(l,Ni,r.memoizedState,r.memoizedProps);break;case 5:wc(r,i,l);break;case 3:case 4:var h=Ni;Ni=Rf(r.stateNode.containerInfo),wc(r,i,l),Ni=h;break;case 22:r.memoizedState===null&&(h=r.alternate,h!==null&&h.memoizedState!==null?(h=sh,sh=16777216,wc(r,i,l),sh=h):wc(r,i,l));break;default:wc(r,i,l)}}function Jx(r){var i=r.alternate;if(i!==null&&(r=i.child,r!==null)){i.child=null;do i=r.sibling,r.sibling=null,r=i;while(r!==null)}}function rh(r){var i=r.deletions;if((r.flags&16)!==0){if(i!==null)for(var l=0;l<i.length;l++){var h=i[l];nr=h,e_(h,r)}Jx(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Zx(r),r=r.sibling}function Zx(r){switch(r.tag){case 0:case 11:case 15:rh(r),r.flags&2048&&so(9,r,r.return);break;case 3:rh(r);break;case 12:rh(r);break;case 22:var i=r.stateNode;r.memoizedState!==null&&i._visibility&2&&(r.return===null||r.return.tag!==13)?(i._visibility&=-3,yf(r)):rh(r);break;default:rh(r)}}function yf(r){var i=r.deletions;if((r.flags&16)!==0){if(i!==null)for(var l=0;l<i.length;l++){var h=i[l];nr=h,e_(h,r)}Jx(r)}for(r=r.child;r!==null;){switch(i=r,i.tag){case 0:case 11:case 15:so(8,i,i.return),yf(i);break;case 22:l=i.stateNode,l._visibility&2&&(l._visibility&=-3,yf(i));break;default:yf(i)}r=r.sibling}}function e_(r,i){for(;nr!==null;){var l=nr;switch(l.tag){case 0:case 11:case 15:so(8,l,i);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var h=l.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:Fu(l.memoizedState.cache)}if(h=l.child,h!==null)h.return=l,nr=h;else e:for(l=r;nr!==null;){h=nr;var m=h.sibling,y=h.return;if($x(h),h===l){nr=null;break e}if(m!==null){m.return=y,nr=m;break e}nr=y}}}var HN={getCacheForType:function(r){var i=dr(Fs),l=i.data.get(r);return l===void 0&&(l=r(),i.data.set(r,l)),l},cacheSignal:function(){return dr(Fs).controller.signal}},WN=typeof WeakMap=="function"?WeakMap:Map,Fn=0,ns=null,pn=null,xn=0,Hn=0,Jr=null,ro=!1,Tc=!1,Wg=!1,Ta=0,Ns=0,io=0,pl=0,Gg=0,Zr=0,Ec=0,ih=null,Fr=null,Kg=!1,bf=0,t_=0,vf=1/0,xf=null,ao=null,Xs=0,oo=null,kc=null,Ea=0,Qg=0,Yg=null,n_=null,ah=0,Xg=null;function ei(){return(Fn&2)!==0&&xn!==0?xn&-xn:H.T!==null?sy():ke()}function s_(){if(Zr===0)if((xn&536870912)===0||kn){var r=ee;ee<<=1,(ee&3932160)===0&&(ee=262144),Zr=r}else Zr=536870912;return r=Yr.current,r!==null&&(r.flags|=32),Zr}function zr(r,i,l){(r===ns&&(Hn===2||Hn===9)||r.cancelPendingCommit!==null)&&(Sc(r,0),lo(r,xn,Zr,!1)),Mn(r,l),((Fn&2)===0||r!==ns)&&(r===ns&&((Fn&2)===0&&(pl|=l),Ns===4&&lo(r,xn,Zr,!1)),Wi(r))}function r_(r,i,l){if((Fn&6)!==0)throw Error(s(327));var h=!l&&(i&127)===0&&(i&r.expiredLanes)===0||jt(r,i),m=h?QN(r,i):Zg(r,i,!0),y=h;do{if(m===0){Tc&&!h&&lo(r,i,0,!1);break}else{if(l=r.current.alternate,y&&!GN(l)){m=Zg(r,i,!1),y=!1;continue}if(m===2){if(y=i,r.errorRecoveryDisabledLanes&y)var w=0;else w=r.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){i=w;e:{var j=r;m=ih;var F=j.current.memoizedState.isDehydrated;if(F&&(Sc(j,w).flags|=256),w=Zg(j,w,!1),w!==2){if(Wg&&!F){j.errorRecoveryDisabledLanes|=y,pl|=y,m=4;break e}y=Fr,Fr=m,y!==null&&(Fr===null?Fr=y:Fr.push.apply(Fr,y))}m=w}if(y=!1,m!==2)continue}}if(m===1){Sc(r,0),lo(r,i,0,!0);break}e:{switch(h=r,y=m,y){case 0:case 1:throw Error(s(345));case 4:if((i&4194048)!==i)break;case 6:lo(h,i,Zr,!ro);break e;case 2:Fr=null;break;case 3:case 5:break;default:throw Error(s(329))}if((i&62914560)===i&&(m=bf+300-un(),10<m)){if(lo(h,i,Zr,!ro),Dt(h,0,!0)!==0)break e;Ea=i,h.timeoutHandle=M_(i_.bind(null,h,l,Fr,xf,Kg,i,Zr,pl,Ec,ro,y,"Throttled",-0,0),m);break e}i_(h,l,Fr,xf,Kg,i,Zr,pl,Ec,ro,y,null,-0,0)}}break}while(!0);Wi(r)}function i_(r,i,l,h,m,y,w,j,F,le,je,Pe,ue,ge){if(r.timeoutHandle=-1,Pe=i.subtreeFlags,Pe&8192||(Pe&16785408)===16785408){Pe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:os},Xx(i,y,Pe);var ft=(y&62914560)===y?bf-un():(y&4194048)===y?t_-un():0;if(ft=CA(Pe,ft),ft!==null){Ea=y,r.cancelPendingCommit=ft(f_.bind(null,r,i,y,l,h,m,w,j,F,je,Pe,null,ue,ge)),lo(r,y,w,!le);return}}f_(r,i,y,l,h,m,w,j,F)}function GN(r){for(var i=r;;){var l=i.tag;if((l===0||l===11||l===15)&&i.flags&16384&&(l=i.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var h=0;h<l.length;h++){var m=l[h],y=m.getSnapshot;m=m.value;try{if(!Kr(y(),m))return!1}catch{return!1}}if(l=i.child,i.subtreeFlags&16384&&l!==null)l.return=i,i=l;else{if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function lo(r,i,l,h){i&=~Gg,i&=~pl,r.suspendedLanes|=i,r.pingedLanes&=~i,h&&(r.warmLanes|=i),h=r.expirationTimes;for(var m=i;0<m;){var y=31-ze(m),w=1<<y;h[y]=-1,m&=~w}l!==0&&bn(r,l,i)}function _f(){return(Fn&6)===0?(oh(0),!1):!0}function Jg(){if(pn!==null){if(Hn===0)var r=pn.return;else r=pn,fa=al=null,mg(r),gc=null,qu=0,r=pn;for(;r!==null;)Lx(r.alternate,r),r=r.return;pn=null}}function Sc(r,i){var l=r.timeoutHandle;l!==-1&&(r.timeoutHandle=-1,fA(l)),l=r.cancelPendingCommit,l!==null&&(r.cancelPendingCommit=null,l()),Ea=0,Jg(),ns=r,pn=l=ha(r.current,null),xn=i,Hn=0,Jr=null,ro=!1,Tc=jt(r,i),Wg=!1,Ec=Zr=Gg=pl=io=Ns=0,Fr=ih=null,Kg=!1,(i&8)!==0&&(i|=i&32);var h=r.entangledLanes;if(h!==0)for(r=r.entanglements,h&=i;0<h;){var m=31-ze(h),y=1<<m;i|=r[m],h&=~y}return Ta=i,Fd(),l}function a_(r,i){nn=null,H.H=Xu,i===pc||i===Qd?(i=w1(),Hn=3):i===ng?(i=w1(),Hn=4):Hn=i===Rg?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,Jr=i,pn===null&&(Ns=1,uf(r,di(i,r.current)))}function o_(){var r=Yr.current;return r===null?!0:(xn&4194048)===xn?gi===null:(xn&62914560)===xn||(xn&536870912)!==0?r===gi:!1}function l_(){var r=H.H;return H.H=Xu,r===null?Xu:r}function c_(){var r=H.A;return H.A=HN,r}function wf(){Ns=4,ro||(xn&4194048)!==xn&&Yr.current!==null||(Tc=!0),(io&134217727)===0&&(pl&134217727)===0||ns===null||lo(ns,xn,Zr,!1)}function Zg(r,i,l){var h=Fn;Fn|=2;var m=l_(),y=c_();(ns!==r||xn!==i)&&(xf=null,Sc(r,i)),i=!1;var w=Ns;e:do try{if(Hn!==0&&pn!==null){var j=pn,F=Jr;switch(Hn){case 8:Jg(),w=6;break e;case 3:case 2:case 9:case 6:Yr.current===null&&(i=!0);var le=Hn;if(Hn=0,Jr=null,jc(r,j,F,le),l&&Tc){w=0;break e}break;default:le=Hn,Hn=0,Jr=null,jc(r,j,F,le)}}KN(),w=Ns;break}catch(je){a_(r,je)}while(!0);return i&&r.shellSuspendCounter++,fa=al=null,Fn=h,H.H=m,H.A=y,pn===null&&(ns=null,xn=0,Fd()),w}function KN(){for(;pn!==null;)u_(pn)}function QN(r,i){var l=Fn;Fn|=2;var h=l_(),m=c_();ns!==r||xn!==i?(xf=null,vf=un()+500,Sc(r,i)):Tc=jt(r,i);e:do try{if(Hn!==0&&pn!==null){i=pn;var y=Jr;t:switch(Hn){case 1:Hn=0,Jr=null,jc(r,i,y,1);break;case 2:case 9:if(x1(y)){Hn=0,Jr=null,h_(i);break}i=function(){Hn!==2&&Hn!==9||ns!==r||(Hn=7),Wi(r)},y.then(i,i);break e;case 3:Hn=7;break e;case 4:Hn=5;break e;case 7:x1(y)?(Hn=0,Jr=null,h_(i)):(Hn=0,Jr=null,jc(r,i,y,7));break;case 5:var w=null;switch(pn.tag){case 26:w=pn.memoizedState;case 5:case 27:var j=pn;if(w?Y_(w):j.stateNode.complete){Hn=0,Jr=null;var F=j.sibling;if(F!==null)pn=F;else{var le=j.return;le!==null?(pn=le,Tf(le)):pn=null}break t}}Hn=0,Jr=null,jc(r,i,y,5);break;case 6:Hn=0,Jr=null,jc(r,i,y,6);break;case 8:Jg(),Ns=6;break e;default:throw Error(s(462))}}YN();break}catch(je){a_(r,je)}while(!0);return fa=al=null,H.H=h,H.A=m,Fn=l,pn!==null?0:(ns=null,xn=0,Fd(),Ns)}function YN(){for(;pn!==null&&!Is();)u_(pn)}function u_(r){var i=Px(r.alternate,r,Ta);r.memoizedProps=r.pendingProps,i===null?Tf(r):pn=i}function h_(r){var i=r,l=i.alternate;switch(i.tag){case 15:case 0:i=Nx(l,i,i.pendingProps,i.type,void 0,xn);break;case 11:i=Nx(l,i,i.pendingProps,i.type.render,i.ref,xn);break;case 5:mg(i);default:Lx(l,i),i=pn=c1(i,Ta),i=Px(l,i,Ta)}r.memoizedProps=r.pendingProps,i===null?Tf(r):pn=i}function jc(r,i,l,h){fa=al=null,mg(i),gc=null,qu=0;var m=i.return;try{if(ON(r,m,i,l,xn)){Ns=1,uf(r,di(l,r.current)),pn=null;return}}catch(y){if(m!==null)throw pn=m,y;Ns=1,uf(r,di(l,r.current)),pn=null;return}i.flags&32768?(kn||h===1?r=!0:Tc||(xn&536870912)!==0?r=!1:(ro=r=!0,(h===2||h===9||h===3||h===6)&&(h=Yr.current,h!==null&&h.tag===13&&(h.flags|=16384))),d_(i,r)):Tf(i)}function Tf(r){var i=r;do{if((i.flags&32768)!==0){d_(i,ro);return}r=i.return;var l=FN(i.alternate,i,Ta);if(l!==null){pn=l;return}if(i=i.sibling,i!==null){pn=i;return}pn=i=r}while(i!==null);Ns===0&&(Ns=5)}function d_(r,i){do{var l=zN(r.alternate,r);if(l!==null){l.flags&=32767,pn=l;return}if(l=r.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!i&&(r=r.sibling,r!==null)){pn=r;return}pn=r=l}while(r!==null);Ns=6,pn=null}function f_(r,i,l,h,m,y,w,j,F){r.cancelPendingCommit=null;do Ef();while(Xs!==0);if((Fn&6)!==0)throw Error(s(327));if(i!==null){if(i===r.current)throw Error(s(177));if(y=i.lanes|i.childLanes,y|=Fp,rs(r,l,y,w,j,F),r===ns&&(pn=ns=null,xn=0),kc=i,oo=r,Ea=l,Qg=y,Yg=m,n_=h,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,eA(hn,function(){return b_(),null})):(r.callbackNode=null,r.callbackPriority=0),h=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||h){h=H.T,H.T=null,m=ye.p,ye.p=2,w=Fn,Fn|=4;try{qN(r,i,l)}finally{Fn=w,ye.p=m,H.T=h}}Xs=1,m_(),p_(),g_()}}function m_(){if(Xs===1){Xs=0;var r=oo,i=kc,l=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||l){l=H.T,H.T=null;var h=ye.p;ye.p=2;var m=Fn;Fn|=4;try{Kx(i,r);var y=hy,w=e1(r.containerInfo),j=y.focusedElem,F=y.selectionRange;if(w!==j&&j&&j.ownerDocument&&Z0(j.ownerDocument.documentElement,j)){if(F!==null&&Lp(j)){var le=F.start,je=F.end;if(je===void 0&&(je=le),"selectionStart"in j)j.selectionStart=le,j.selectionEnd=Math.min(je,j.value.length);else{var Pe=j.ownerDocument||document,ue=Pe&&Pe.defaultView||window;if(ue.getSelection){var ge=ue.getSelection(),ft=j.textContent.length,Pt=Math.min(F.start,ft),Zn=F.end===void 0?Pt:Math.min(F.end,ft);!ge.extend&&Pt>Zn&&(w=Zn,Zn=Pt,Pt=w);var Z=J0(j,Pt),G=J0(j,Zn);if(Z&&G&&(ge.rangeCount!==1||ge.anchorNode!==Z.node||ge.anchorOffset!==Z.offset||ge.focusNode!==G.node||ge.focusOffset!==G.offset)){var oe=Pe.createRange();oe.setStart(Z.node,Z.offset),ge.removeAllRanges(),Pt>Zn?(ge.addRange(oe),ge.extend(G.node,G.offset)):(oe.setEnd(G.node,G.offset),ge.addRange(oe))}}}}for(Pe=[],ge=j;ge=ge.parentNode;)ge.nodeType===1&&Pe.push({element:ge,left:ge.scrollLeft,top:ge.scrollTop});for(typeof j.focus=="function"&&j.focus(),j=0;j<Pe.length;j++){var Ce=Pe[j];Ce.element.scrollLeft=Ce.left,Ce.element.scrollTop=Ce.top}}Lf=!!uy,hy=uy=null}finally{Fn=m,ye.p=h,H.T=l}}r.current=i,Xs=2}}function p_(){if(Xs===2){Xs=0;var r=oo,i=kc,l=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||l){l=H.T,H.T=null;var h=ye.p;ye.p=2;var m=Fn;Fn|=4;try{qx(r,i.alternate,i)}finally{Fn=m,ye.p=h,H.T=l}}Xs=3}}function g_(){if(Xs===4||Xs===3){Xs=0,Ct();var r=oo,i=kc,l=Ea,h=n_;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?Xs=5:(Xs=0,kc=oo=null,y_(r,r.pendingLanes));var m=r.pendingLanes;if(m===0&&(ao=null),xe(l),i=i.stateNode,Fe&&typeof Fe.onCommitFiberRoot=="function")try{Fe.onCommitFiberRoot(tt,i,void 0,(i.current.flags&128)===128)}catch{}if(h!==null){i=H.T,m=ye.p,ye.p=2,H.T=null;try{for(var y=r.onRecoverableError,w=0;w<h.length;w++){var j=h[w];y(j.value,{componentStack:j.stack})}}finally{H.T=i,ye.p=m}}(Ea&3)!==0&&Ef(),Wi(r),m=r.pendingLanes,(l&261930)!==0&&(m&42)!==0?r===Xg?ah++:(ah=0,Xg=r):ah=0,oh(0)}}function y_(r,i){(r.pooledCacheLanes&=i)===0&&(i=r.pooledCache,i!=null&&(r.pooledCache=null,Fu(i)))}function Ef(){return m_(),p_(),g_(),b_()}function b_(){if(Xs!==5)return!1;var r=oo,i=Qg;Qg=0;var l=xe(Ea),h=H.T,m=ye.p;try{ye.p=32>l?32:l,H.T=null,l=Yg,Yg=null;var y=oo,w=Ea;if(Xs=0,kc=oo=null,Ea=0,(Fn&6)!==0)throw Error(s(331));var j=Fn;if(Fn|=4,Zx(y.current),Yx(y,y.current,w,l),Fn=j,oh(0,!1),Fe&&typeof Fe.onPostCommitFiberRoot=="function")try{Fe.onPostCommitFiberRoot(tt,y)}catch{}return!0}finally{ye.p=m,H.T=h,y_(r,i)}}function v_(r,i,l){i=di(l,i),i=Ag(r.stateNode,i,2),r=eo(r,i,2),r!==null&&(Mn(r,2),Wi(r))}function Wn(r,i,l){if(r.tag===3)v_(r,r,l);else for(;i!==null;){if(i.tag===3){v_(i,r,l);break}else if(i.tag===1){var h=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(ao===null||!ao.has(h))){r=di(l,r),l=xx(2),h=eo(i,l,2),h!==null&&(_x(l,h,i,r),Mn(h,2),Wi(h));break}}i=i.return}}function ey(r,i,l){var h=r.pingCache;if(h===null){h=r.pingCache=new WN;var m=new Set;h.set(i,m)}else m=h.get(i),m===void 0&&(m=new Set,h.set(i,m));m.has(l)||(Wg=!0,m.add(l),r=XN.bind(null,r,i,l),i.then(r,r))}function XN(r,i,l){var h=r.pingCache;h!==null&&h.delete(i),r.pingedLanes|=r.suspendedLanes&l,r.warmLanes&=~l,ns===r&&(xn&l)===l&&(Ns===4||Ns===3&&(xn&62914560)===xn&&300>un()-bf?(Fn&2)===0&&Sc(r,0):Gg|=l,Ec===xn&&(Ec=0)),Wi(r)}function x_(r,i){i===0&&(i=Yt()),r=sl(r,i),r!==null&&(Mn(r,i),Wi(r))}function JN(r){var i=r.memoizedState,l=0;i!==null&&(l=i.retryLane),x_(r,l)}function ZN(r,i){var l=0;switch(r.tag){case 31:case 13:var h=r.stateNode,m=r.memoizedState;m!==null&&(l=m.retryLane);break;case 19:h=r.stateNode;break;case 22:h=r.stateNode._retryCache;break;default:throw Error(s(314))}h!==null&&h.delete(i),x_(r,l)}function eA(r,i){return it(r,i)}var kf=null,Nc=null,ty=!1,Sf=!1,ny=!1,co=0;function Wi(r){r!==Nc&&r.next===null&&(Nc===null?kf=Nc=r:Nc=Nc.next=r),Sf=!0,ty||(ty=!0,nA())}function oh(r,i){if(!ny&&Sf){ny=!0;do for(var l=!1,h=kf;h!==null;){if(r!==0){var m=h.pendingLanes;if(m===0)var y=0;else{var w=h.suspendedLanes,j=h.pingedLanes;y=(1<<31-ze(42|r)+1)-1,y&=m&~(w&~j),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(l=!0,E_(h,y))}else y=xn,y=Dt(h,h===ns?y:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(y&3)===0||jt(h,y)||(l=!0,E_(h,y));h=h.next}while(l);ny=!1}}function tA(){__()}function __(){Sf=ty=!1;var r=0;co!==0&&dA()&&(r=co);for(var i=un(),l=null,h=kf;h!==null;){var m=h.next,y=w_(h,i);y===0?(h.next=null,l===null?kf=m:l.next=m,m===null&&(Nc=l)):(l=h,(r!==0||(y&3)!==0)&&(Sf=!0)),h=m}Xs!==0&&Xs!==5||oh(r),co!==0&&(co=0)}function w_(r,i){for(var l=r.suspendedLanes,h=r.pingedLanes,m=r.expirationTimes,y=r.pendingLanes&-62914561;0<y;){var w=31-ze(y),j=1<<w,F=m[w];F===-1?((j&l)===0||(j&h)!==0)&&(m[w]=rn(j,i)):F<=i&&(r.expiredLanes|=j),y&=~j}if(i=ns,l=xn,l=Dt(r,r===i?l:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),h=r.callbackNode,l===0||r===i&&(Hn===2||Hn===9)||r.cancelPendingCommit!==null)return h!==null&&h!==null&&Jt(h),r.callbackNode=null,r.callbackPriority=0;if((l&3)===0||jt(r,l)){if(i=l&-l,i===r.callbackPriority)return i;switch(h!==null&&Jt(h),xe(l)){case 2:case 8:l=Pn;break;case 32:l=hn;break;case 268435456:l=he;break;default:l=hn}return h=T_.bind(null,r),l=it(l,h),r.callbackPriority=i,r.callbackNode=l,i}return h!==null&&h!==null&&Jt(h),r.callbackPriority=2,r.callbackNode=null,2}function T_(r,i){if(Xs!==0&&Xs!==5)return r.callbackNode=null,r.callbackPriority=0,null;var l=r.callbackNode;if(Ef()&&r.callbackNode!==l)return null;var h=xn;return h=Dt(r,r===ns?h:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),h===0?null:(r_(r,h,i),w_(r,un()),r.callbackNode!=null&&r.callbackNode===l?T_.bind(null,r):null)}function E_(r,i){if(Ef())return null;r_(r,i,!0)}function nA(){mA(function(){(Fn&6)!==0?it(Kt,tA):__()})}function sy(){if(co===0){var r=fc;r===0&&(r=Qt,Qt<<=1,(Qt&261888)===0&&(Qt=256)),co=r}return co}function k_(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Pr(""+r)}function S_(r,i){var l=i.ownerDocument.createElement("input");return l.name=i.name,l.value=i.value,r.id&&l.setAttribute("form",r.id),i.parentNode.insertBefore(l,i),r=new FormData(r),l.parentNode.removeChild(l),r}function sA(r,i,l,h,m){if(i==="submit"&&l&&l.stateNode===m){var y=k_((m[Rt]||null).action),w=h.submitter;w&&(i=(i=w[Rt]||null)?k_(i.formAction):w.getAttribute("formAction"),i!==null&&(y=i,w=null));var j=new ks("action","action",null,h,m);r.push({event:j,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(co!==0){var F=w?S_(m,w):new FormData(m);Tg(l,{pending:!0,data:F,method:m.method,action:y},null,F)}}else typeof y=="function"&&(j.preventDefault(),F=w?S_(m,w):new FormData(m),Tg(l,{pending:!0,data:F,method:m.method,action:y},y,F))},currentTarget:m}]})}}for(var ry=0;ry<Up.length;ry++){var iy=Up[ry],rA=iy.toLowerCase(),iA=iy[0].toUpperCase()+iy.slice(1);ji(rA,"on"+iA)}ji(s1,"onAnimationEnd"),ji(r1,"onAnimationIteration"),ji(i1,"onAnimationStart"),ji("dblclick","onDoubleClick"),ji("focusin","onFocus"),ji("focusout","onBlur"),ji(_N,"onTransitionRun"),ji(wN,"onTransitionStart"),ji(TN,"onTransitionCancel"),ji(a1,"onTransitionEnd"),$e("onMouseEnter",["mouseout","mouseover"]),$e("onMouseLeave",["mouseout","mouseover"]),$e("onPointerEnter",["pointerout","pointerover"]),$e("onPointerLeave",["pointerout","pointerover"]),Ye("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ye("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ye("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ye("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ye("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ye("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),aA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(lh));function j_(r,i){i=(i&4)!==0;for(var l=0;l<r.length;l++){var h=r[l],m=h.event;h=h.listeners;e:{var y=void 0;if(i)for(var w=h.length-1;0<=w;w--){var j=h[w],F=j.instance,le=j.currentTarget;if(j=j.listener,F!==y&&m.isPropagationStopped())break e;y=j,m.currentTarget=le;try{y(m)}catch(je){Ud(je)}m.currentTarget=null,y=F}else for(w=0;w<h.length;w++){if(j=h[w],F=j.instance,le=j.currentTarget,j=j.listener,F!==y&&m.isPropagationStopped())break e;y=j,m.currentTarget=le;try{y(m)}catch(je){Ud(je)}m.currentTarget=null,y=F}}}}function gn(r,i){var l=i[vt];l===void 0&&(l=i[vt]=new Set);var h=r+"__bubble";l.has(h)||(N_(i,r,2,!1),l.add(h))}function ay(r,i,l){var h=0;i&&(h|=4),N_(l,r,h,i)}var jf="_reactListening"+Math.random().toString(36).slice(2);function oy(r){if(!r[jf]){r[jf]=!0,Q.forEach(function(l){l!=="selectionchange"&&(aA.has(l)||ay(l,!1,r),ay(l,!0,r))});var i=r.nodeType===9?r:r.ownerDocument;i===null||i[jf]||(i[jf]=!0,ay("selectionchange",!1,i))}}function N_(r,i,l,h){switch(sw(i)){case 2:var m=PA;break;case 8:m=MA;break;default:m=wy}l=m.bind(null,i,l,r),m=void 0,!te||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(m=!0),h?m!==void 0?r.addEventListener(i,l,{capture:!0,passive:m}):r.addEventListener(i,l,!0):m!==void 0?r.addEventListener(i,l,{passive:m}):r.addEventListener(i,l,!1)}function ly(r,i,l,h,m){var y=h;if((i&1)===0&&(i&2)===0&&h!==null)e:for(;;){if(h===null)return;var w=h.tag;if(w===3||w===4){var j=h.stateNode.containerInfo;if(j===m)break;if(w===4)for(w=h.return;w!==null;){var F=w.tag;if((F===3||F===4)&&w.stateNode.containerInfo===m)return;w=w.return}for(;j!==null;){if(w=ts(j),w===null)return;if(F=w.tag,F===5||F===6||F===26||F===27){h=y=w;continue e}j=j.parentNode}}h=h.return}Fi(function(){var le=y,je=Us(l),Pe=[];e:{var ue=o1.get(r);if(ue!==void 0){var ge=ks,ft=r;switch(r){case"keypress":if(Ht(l)===0)break e;case"keydown":case"keyup":ge=Vd;break;case"focusin":ft="focus",ge=Ss;break;case"focusout":ft="blur",ge=Ss;break;case"beforeblur":case"afterblur":ge=Ss;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ge=br;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ge=kr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ge=v;break;case s1:case r1:case i1:ge=Vr;break;case a1:ge=R;break;case"scroll":case"scrollend":ge=zn;break;case"wheel":ge=me;break;case"copy":case"cut":case"paste":ge=tc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ge=ua;break;case"toggle":case"beforetoggle":ge=tn}var Pt=(i&4)!==0,Zn=!Pt&&(r==="scroll"||r==="scrollend"),Z=Pt?ue!==null?ue+"Capture":null:ue;Pt=[];for(var G=le,oe;G!==null;){var Ce=G;if(oe=Ce.stateNode,Ce=Ce.tag,Ce!==5&&Ce!==26&&Ce!==27||oe===null||Z===null||(Ce=Gr(G,Z),Ce!=null&&Pt.push(ch(G,Ce,oe))),Zn)break;G=G.return}0<Pt.length&&(ue=new ge(ue,ft,null,l,je),Pe.push({event:ue,listeners:Pt}))}}if((i&7)===0){e:{if(ue=r==="mouseover"||r==="pointerover",ge=r==="mouseout"||r==="pointerout",ue&&l!==Ks&&(ft=l.relatedTarget||l.fromElement)&&(ts(ft)||ft[ot]))break e;if((ge||ue)&&(ue=je.window===je?je:(ue=je.ownerDocument)?ue.defaultView||ue.parentWindow:window,ge?(ft=l.relatedTarget||l.toElement,ge=le,ft=ft?ts(ft):null,ft!==null&&(Zn=c(ft),Pt=ft.tag,ft!==Zn||Pt!==5&&Pt!==27&&Pt!==6)&&(ft=null)):(ge=null,ft=le),ge!==ft)){if(Pt=br,Ce="onMouseLeave",Z="onMouseEnter",G="mouse",(r==="pointerout"||r==="pointerover")&&(Pt=ua,Ce="onPointerLeave",Z="onPointerEnter",G="pointer"),Zn=ge==null?ue:fe(ge),oe=ft==null?ue:fe(ft),ue=new Pt(Ce,G+"leave",ge,l,je),ue.target=Zn,ue.relatedTarget=oe,Ce=null,ts(je)===le&&(Pt=new Pt(Z,G+"enter",ft,l,je),Pt.target=oe,Pt.relatedTarget=Zn,Ce=Pt),Zn=Ce,ge&&ft)t:{for(Pt=oA,Z=ge,G=ft,oe=0,Ce=Z;Ce;Ce=Pt(Ce))oe++;Ce=0;for(var At=G;At;At=Pt(At))Ce++;for(;0<oe-Ce;)Z=Pt(Z),oe--;for(;0<Ce-oe;)G=Pt(G),Ce--;for(;oe--;){if(Z===G||G!==null&&Z===G.alternate){Pt=Z;break t}Z=Pt(Z),G=Pt(G)}Pt=null}else Pt=null;ge!==null&&A_(Pe,ue,ge,Pt,!1),ft!==null&&Zn!==null&&A_(Pe,Zn,ft,Pt,!0)}}e:{if(ue=le?fe(le):window,ge=ue.nodeName&&ue.nodeName.toLowerCase(),ge==="select"||ge==="input"&&ue.type==="file")var Ln=W0;else if($0(ue))if(G0)Ln=bN;else{Ln=gN;var yt=pN}else ge=ue.nodeName,!ge||ge.toLowerCase()!=="input"||ue.type!=="checkbox"&&ue.type!=="radio"?le&&_s(le.elementType)&&(Ln=W0):Ln=yN;if(Ln&&(Ln=Ln(r,le))){H0(Pe,Ln,l,je);break e}yt&&yt(r,ue,le),r==="focusout"&&le&&ue.type==="number"&&le.memoizedProps.value!=null&&xs(ue,"number",ue.value)}switch(yt=le?fe(le):window,r){case"focusin":($0(yt)||yt.contentEditable==="true")&&(ic=yt,Vp=le,Ou=null);break;case"focusout":Ou=Vp=ic=null;break;case"mousedown":Op=!0;break;case"contextmenu":case"mouseup":case"dragend":Op=!1,t1(Pe,l,je);break;case"selectionchange":if(xN)break;case"keydown":case"keyup":t1(Pe,l,je)}var on;if(Un)e:{switch(r){case"compositionstart":var _n="onCompositionStart";break e;case"compositionend":_n="onCompositionEnd";break e;case"compositionupdate":_n="onCompositionUpdate";break e}_n=void 0}else rc?el(r,l)&&(_n="onCompositionEnd"):r==="keydown"&&l.keyCode===229&&(_n="onCompositionStart");_n&&(zi&&l.locale!=="ko"&&(rc||_n!=="onCompositionStart"?_n==="onCompositionEnd"&&rc&&(on=st()):(nt=je,Et="value"in nt?nt.value:nt.textContent,rc=!0)),yt=Nf(le,_n),0<yt.length&&(_n=new jr(_n,r,null,l,je),Pe.push({event:_n,listeners:yt}),on?_n.data=on:(on=sc(l),on!==null&&(_n.data=on)))),(on=ui?hN(r,l):dN(r,l))&&(_n=Nf(le,"onBeforeInput"),0<_n.length&&(yt=new jr("onBeforeInput","beforeinput",null,l,je),Pe.push({event:yt,listeners:_n}),yt.data=on)),sA(Pe,r,le,l,je)}j_(Pe,i)})}function ch(r,i,l){return{instance:r,listener:i,currentTarget:l}}function Nf(r,i){for(var l=i+"Capture",h=[];r!==null;){var m=r,y=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||y===null||(m=Gr(r,l),m!=null&&h.unshift(ch(r,m,y)),m=Gr(r,i),m!=null&&h.push(ch(r,m,y))),r.tag===3)return h;r=r.return}return[]}function oA(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function A_(r,i,l,h,m){for(var y=i._reactName,w=[];l!==null&&l!==h;){var j=l,F=j.alternate,le=j.stateNode;if(j=j.tag,F!==null&&F===h)break;j!==5&&j!==26&&j!==27||le===null||(F=le,m?(le=Gr(l,y),le!=null&&w.unshift(ch(l,le,F))):m||(le=Gr(l,y),le!=null&&w.push(ch(l,le,F)))),l=l.return}w.length!==0&&r.push({event:i,listeners:w})}var lA=/\r\n?/g,cA=/\u0000|\uFFFD/g;function R_(r){return(typeof r=="string"?r:""+r).replace(lA,`
`).replace(cA,"")}function C_(r,i){return i=R_(i),R_(r)===i}function Jn(r,i,l,h,m,y){switch(l){case"children":typeof h=="string"?i==="body"||i==="textarea"&&h===""||Es(r,h):(typeof h=="number"||typeof h=="bigint")&&i!=="body"&&Es(r,""+h);break;case"className":Bs(r,"class",h);break;case"tabIndex":Bs(r,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":Bs(r,l,h);break;case"style":cn(r,h,y);break;case"data":if(i!=="object"){Bs(r,"data",h);break}case"src":case"href":if(h===""&&(i!=="a"||l!=="href")){r.removeAttribute(l);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){r.removeAttribute(l);break}h=Pr(""+h),r.setAttribute(l,h);break;case"action":case"formAction":if(typeof h=="function"){r.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(l==="formAction"?(i!=="input"&&Jn(r,i,"name",m.name,m,null),Jn(r,i,"formEncType",m.formEncType,m,null),Jn(r,i,"formMethod",m.formMethod,m,null),Jn(r,i,"formTarget",m.formTarget,m,null)):(Jn(r,i,"encType",m.encType,m,null),Jn(r,i,"method",m.method,m,null),Jn(r,i,"target",m.target,m,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){r.removeAttribute(l);break}h=Pr(""+h),r.setAttribute(l,h);break;case"onClick":h!=null&&(r.onclick=os);break;case"onScroll":h!=null&&gn("scroll",r);break;case"onScrollEnd":h!=null&&gn("scrollend",r);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(s(61));if(l=h.__html,l!=null){if(m.children!=null)throw Error(s(60));r.innerHTML=l}}break;case"multiple":r.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":r.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){r.removeAttribute("xlink:href");break}l=Pr(""+h),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?r.setAttribute(l,""+h):r.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?r.setAttribute(l,""):r.removeAttribute(l);break;case"capture":case"download":h===!0?r.setAttribute(l,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?r.setAttribute(l,h):r.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?r.setAttribute(l,h):r.removeAttribute(l);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?r.removeAttribute(l):r.setAttribute(l,h);break;case"popover":gn("beforetoggle",r),gn("toggle",r),Gs(r,"popover",h);break;case"xlinkActuate":qn(r,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":qn(r,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":qn(r,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":qn(r,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":qn(r,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":qn(r,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":qn(r,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":qn(r,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":qn(r,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":Gs(r,"is",h);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=yr.get(l)||l,Gs(r,l,h))}}function cy(r,i,l,h,m,y){switch(l){case"style":cn(r,h,y);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(s(61));if(l=h.__html,l!=null){if(m.children!=null)throw Error(s(60));r.innerHTML=l}}break;case"children":typeof h=="string"?Es(r,h):(typeof h=="number"||typeof h=="bigint")&&Es(r,""+h);break;case"onScroll":h!=null&&gn("scroll",r);break;case"onScrollEnd":h!=null&&gn("scrollend",r);break;case"onClick":h!=null&&(r.onclick=os);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ae.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(m=l.endsWith("Capture"),i=l.slice(2,m?l.length-7:void 0),y=r[Rt]||null,y=y!=null?y[l]:null,typeof y=="function"&&r.removeEventListener(i,y,m),typeof h=="function")){typeof y!="function"&&y!==null&&(l in r?r[l]=null:r.hasAttribute(l)&&r.removeAttribute(l)),r.addEventListener(i,h,m);break e}l in r?r[l]=h:h===!0?r.setAttribute(l,""):Gs(r,l,h)}}}function mr(r,i,l){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":gn("error",r),gn("load",r);var h=!1,m=!1,y;for(y in l)if(l.hasOwnProperty(y)){var w=l[y];if(w!=null)switch(y){case"src":h=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,i));default:Jn(r,i,y,w,l,null)}}m&&Jn(r,i,"srcSet",l.srcSet,l,null),h&&Jn(r,i,"src",l.src,l,null);return;case"input":gn("invalid",r);var j=y=w=m=null,F=null,le=null;for(h in l)if(l.hasOwnProperty(h)){var je=l[h];if(je!=null)switch(h){case"name":m=je;break;case"type":w=je;break;case"checked":F=je;break;case"defaultChecked":le=je;break;case"value":y=je;break;case"defaultValue":j=je;break;case"children":case"dangerouslySetInnerHTML":if(je!=null)throw Error(s(137,i));break;default:Jn(r,i,h,je,l,null)}}En(r,y,j,F,le,w,m,!1);return;case"select":gn("invalid",r),h=w=y=null;for(m in l)if(l.hasOwnProperty(m)&&(j=l[m],j!=null))switch(m){case"value":y=j;break;case"defaultValue":w=j;break;case"multiple":h=j;default:Jn(r,i,m,j,l,null)}i=y,l=w,r.multiple=!!h,i!=null?vn(r,!!h,i,!1):l!=null&&vn(r,!!h,l,!0);return;case"textarea":gn("invalid",r),y=m=h=null;for(w in l)if(l.hasOwnProperty(w)&&(j=l[w],j!=null))switch(w){case"value":h=j;break;case"defaultValue":m=j;break;case"children":y=j;break;case"dangerouslySetInnerHTML":if(j!=null)throw Error(s(91));break;default:Jn(r,i,w,j,l,null)}ci(r,h,m,y);return;case"option":for(F in l)l.hasOwnProperty(F)&&(h=l[F],h!=null)&&(F==="selected"?r.selected=h&&typeof h!="function"&&typeof h!="symbol":Jn(r,i,F,h,l,null));return;case"dialog":gn("beforetoggle",r),gn("toggle",r),gn("cancel",r),gn("close",r);break;case"iframe":case"object":gn("load",r);break;case"video":case"audio":for(h=0;h<lh.length;h++)gn(lh[h],r);break;case"image":gn("error",r),gn("load",r);break;case"details":gn("toggle",r);break;case"embed":case"source":case"link":gn("error",r),gn("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(le in l)if(l.hasOwnProperty(le)&&(h=l[le],h!=null))switch(le){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,i));default:Jn(r,i,le,h,l,null)}return;default:if(_s(i)){for(je in l)l.hasOwnProperty(je)&&(h=l[je],h!==void 0&&cy(r,i,je,h,l,void 0));return}}for(j in l)l.hasOwnProperty(j)&&(h=l[j],h!=null&&Jn(r,i,j,h,l,null))}function uA(r,i,l,h){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,y=null,w=null,j=null,F=null,le=null,je=null;for(ge in l){var Pe=l[ge];if(l.hasOwnProperty(ge)&&Pe!=null)switch(ge){case"checked":break;case"value":break;case"defaultValue":F=Pe;default:h.hasOwnProperty(ge)||Jn(r,i,ge,null,h,Pe)}}for(var ue in h){var ge=h[ue];if(Pe=l[ue],h.hasOwnProperty(ue)&&(ge!=null||Pe!=null))switch(ue){case"type":y=ge;break;case"name":m=ge;break;case"checked":le=ge;break;case"defaultChecked":je=ge;break;case"value":w=ge;break;case"defaultValue":j=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(s(137,i));break;default:ge!==Pe&&Jn(r,i,ue,ge,h,Pe)}}Ot(r,w,j,F,le,je,y,m);return;case"select":ge=w=j=ue=null;for(y in l)if(F=l[y],l.hasOwnProperty(y)&&F!=null)switch(y){case"value":break;case"multiple":ge=F;default:h.hasOwnProperty(y)||Jn(r,i,y,null,h,F)}for(m in h)if(y=h[m],F=l[m],h.hasOwnProperty(m)&&(y!=null||F!=null))switch(m){case"value":ue=y;break;case"defaultValue":j=y;break;case"multiple":w=y;default:y!==F&&Jn(r,i,m,y,h,F)}i=j,l=w,h=ge,ue!=null?vn(r,!!l,ue,!1):!!h!=!!l&&(i!=null?vn(r,!!l,i,!0):vn(r,!!l,l?[]:"",!1));return;case"textarea":ge=ue=null;for(j in l)if(m=l[j],l.hasOwnProperty(j)&&m!=null&&!h.hasOwnProperty(j))switch(j){case"value":break;case"children":break;default:Jn(r,i,j,null,h,m)}for(w in h)if(m=h[w],y=l[w],h.hasOwnProperty(w)&&(m!=null||y!=null))switch(w){case"value":ue=m;break;case"defaultValue":ge=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(s(91));break;default:m!==y&&Jn(r,i,w,m,h,y)}lr(r,ue,ge);return;case"option":for(var ft in l)ue=l[ft],l.hasOwnProperty(ft)&&ue!=null&&!h.hasOwnProperty(ft)&&(ft==="selected"?r.selected=!1:Jn(r,i,ft,null,h,ue));for(F in h)ue=h[F],ge=l[F],h.hasOwnProperty(F)&&ue!==ge&&(ue!=null||ge!=null)&&(F==="selected"?r.selected=ue&&typeof ue!="function"&&typeof ue!="symbol":Jn(r,i,F,ue,h,ge));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Pt in l)ue=l[Pt],l.hasOwnProperty(Pt)&&ue!=null&&!h.hasOwnProperty(Pt)&&Jn(r,i,Pt,null,h,ue);for(le in h)if(ue=h[le],ge=l[le],h.hasOwnProperty(le)&&ue!==ge&&(ue!=null||ge!=null))switch(le){case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(s(137,i));break;default:Jn(r,i,le,ue,h,ge)}return;default:if(_s(i)){for(var Zn in l)ue=l[Zn],l.hasOwnProperty(Zn)&&ue!==void 0&&!h.hasOwnProperty(Zn)&&cy(r,i,Zn,void 0,h,ue);for(je in h)ue=h[je],ge=l[je],!h.hasOwnProperty(je)||ue===ge||ue===void 0&&ge===void 0||cy(r,i,je,ue,h,ge);return}}for(var Z in l)ue=l[Z],l.hasOwnProperty(Z)&&ue!=null&&!h.hasOwnProperty(Z)&&Jn(r,i,Z,null,h,ue);for(Pe in h)ue=h[Pe],ge=l[Pe],!h.hasOwnProperty(Pe)||ue===ge||ue==null&&ge==null||Jn(r,i,Pe,ue,h,ge)}function I_(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function hA(){if(typeof performance.getEntriesByType=="function"){for(var r=0,i=0,l=performance.getEntriesByType("resource"),h=0;h<l.length;h++){var m=l[h],y=m.transferSize,w=m.initiatorType,j=m.duration;if(y&&j&&I_(w)){for(w=0,j=m.responseEnd,h+=1;h<l.length;h++){var F=l[h],le=F.startTime;if(le>j)break;var je=F.transferSize,Pe=F.initiatorType;je&&I_(Pe)&&(F=F.responseEnd,w+=je*(F<j?1:(j-le)/(F-le)))}if(--h,i+=8*(y+w)/(m.duration/1e3),r++,10<r)break}}if(0<r)return i/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var uy=null,hy=null;function Af(r){return r.nodeType===9?r:r.ownerDocument}function D_(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function P_(r,i){if(r===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&i==="foreignObject"?0:r}function dy(r,i){return r==="textarea"||r==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var fy=null;function dA(){var r=window.event;return r&&r.type==="popstate"?r===fy?!1:(fy=r,!0):(fy=null,!1)}var M_=typeof setTimeout=="function"?setTimeout:void 0,fA=typeof clearTimeout=="function"?clearTimeout:void 0,L_=typeof Promise=="function"?Promise:void 0,mA=typeof queueMicrotask=="function"?queueMicrotask:typeof L_<"u"?function(r){return L_.resolve(null).then(r).catch(pA)}:M_;function pA(r){setTimeout(function(){throw r})}function uo(r){return r==="head"}function V_(r,i){var l=i,h=0;do{var m=l.nextSibling;if(r.removeChild(l),m&&m.nodeType===8)if(l=m.data,l==="/$"||l==="/&"){if(h===0){r.removeChild(m),Ic(i);return}h--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")h++;else if(l==="html")uh(r.ownerDocument.documentElement);else if(l==="head"){l=r.ownerDocument.head,uh(l);for(var y=l.firstChild;y;){var w=y.nextSibling,j=y.nodeName;y[Ts]||j==="SCRIPT"||j==="STYLE"||j==="LINK"&&y.rel.toLowerCase()==="stylesheet"||l.removeChild(y),y=w}}else l==="body"&&uh(r.ownerDocument.body);l=m}while(l);Ic(i)}function O_(r,i){var l=r;r=0;do{var h=l.nextSibling;if(l.nodeType===1?i?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(i?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),h&&h.nodeType===8)if(l=h.data,l==="/$"){if(r===0)break;r--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||r++;l=h}while(l)}function my(r){var i=r.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var l=i;switch(i=i.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":my(l),Ds(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}r.removeChild(l)}}function gA(r,i,l,h){for(;r.nodeType===1;){var m=l;if(r.nodeName.toLowerCase()!==i.toLowerCase()){if(!h&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(h){if(!r[Ts])switch(i){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(y=r.getAttribute("rel"),y==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(y!==m.rel||r.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||r.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||r.getAttribute("title")!==(m.title==null?null:m.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(y=r.getAttribute("src"),(y!==(m.src==null?null:m.src)||r.getAttribute("type")!==(m.type==null?null:m.type)||r.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&y&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(i==="input"&&r.type==="hidden"){var y=m.name==null?null:""+m.name;if(m.type==="hidden"&&r.getAttribute("name")===y)return r}else return r;if(r=yi(r.nextSibling),r===null)break}return null}function yA(r,i,l){if(i==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!l||(r=yi(r.nextSibling),r===null))return null;return r}function B_(r,i){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!i||(r=yi(r.nextSibling),r===null))return null;return r}function py(r){return r.data==="$?"||r.data==="$~"}function gy(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function bA(r,i){var l=r.ownerDocument;if(r.data==="$~")r._reactRetry=i;else if(r.data!=="$?"||l.readyState!=="loading")i();else{var h=function(){i(),l.removeEventListener("DOMContentLoaded",h)};l.addEventListener("DOMContentLoaded",h),r._reactRetry=h}}function yi(r){for(;r!=null;r=r.nextSibling){var i=r.nodeType;if(i===1||i===3)break;if(i===8){if(i=r.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return r}var yy=null;function U_(r){r=r.nextSibling;for(var i=0;r;){if(r.nodeType===8){var l=r.data;if(l==="/$"||l==="/&"){if(i===0)return yi(r.nextSibling);i--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||i++}r=r.nextSibling}return null}function F_(r){r=r.previousSibling;for(var i=0;r;){if(r.nodeType===8){var l=r.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(i===0)return r;i--}else l!=="/$"&&l!=="/&"||i++}r=r.previousSibling}return null}function z_(r,i,l){switch(i=Af(l),r){case"html":if(r=i.documentElement,!r)throw Error(s(452));return r;case"head":if(r=i.head,!r)throw Error(s(453));return r;case"body":if(r=i.body,!r)throw Error(s(454));return r;default:throw Error(s(451))}}function uh(r){for(var i=r.attributes;i.length;)r.removeAttributeNode(i[0]);Ds(r)}var bi=new Map,q_=new Set;function Rf(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var ka=ye.d;ye.d={f:vA,r:xA,D:_A,C:wA,L:TA,m:EA,X:SA,S:kA,M:jA};function vA(){var r=ka.f(),i=_f();return r||i}function xA(r){var i=W(r);i!==null&&i.tag===5&&i.type==="form"?ax(i):ka.r(r)}var Ac=typeof document>"u"?null:document;function $_(r,i,l){var h=Ac;if(h&&typeof i=="string"&&i){var m=_t(i);m='link[rel="'+r+'"][href="'+m+'"]',typeof l=="string"&&(m+='[crossorigin="'+l+'"]'),q_.has(m)||(q_.add(m),r={rel:r,crossOrigin:l,href:i},h.querySelector(m)===null&&(i=h.createElement("link"),mr(i,"link",r),C(i),h.head.appendChild(i)))}}function _A(r){ka.D(r),$_("dns-prefetch",r,null)}function wA(r,i){ka.C(r,i),$_("preconnect",r,i)}function TA(r,i,l){ka.L(r,i,l);var h=Ac;if(h&&r&&i){var m='link[rel="preload"][as="'+_t(i)+'"]';i==="image"&&l&&l.imageSrcSet?(m+='[imagesrcset="'+_t(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(m+='[imagesizes="'+_t(l.imageSizes)+'"]')):m+='[href="'+_t(r)+'"]';var y=m;switch(i){case"style":y=Rc(r);break;case"script":y=Cc(r)}bi.has(y)||(r=x({rel:"preload",href:i==="image"&&l&&l.imageSrcSet?void 0:r,as:i},l),bi.set(y,r),h.querySelector(m)!==null||i==="style"&&h.querySelector(hh(y))||i==="script"&&h.querySelector(dh(y))||(i=h.createElement("link"),mr(i,"link",r),C(i),h.head.appendChild(i)))}}function EA(r,i){ka.m(r,i);var l=Ac;if(l&&r){var h=i&&typeof i.as=="string"?i.as:"script",m='link[rel="modulepreload"][as="'+_t(h)+'"][href="'+_t(r)+'"]',y=m;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=Cc(r)}if(!bi.has(y)&&(r=x({rel:"modulepreload",href:r},i),bi.set(y,r),l.querySelector(m)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(dh(y)))return}h=l.createElement("link"),mr(h,"link",r),C(h),l.head.appendChild(h)}}}function kA(r,i,l){ka.S(r,i,l);var h=Ac;if(h&&r){var m=k(h).hoistableStyles,y=Rc(r);i=i||"default";var w=m.get(y);if(!w){var j={loading:0,preload:null};if(w=h.querySelector(hh(y)))j.loading=5;else{r=x({rel:"stylesheet",href:r,"data-precedence":i},l),(l=bi.get(y))&&by(r,l);var F=w=h.createElement("link");C(F),mr(F,"link",r),F._p=new Promise(function(le,je){F.onload=le,F.onerror=je}),F.addEventListener("load",function(){j.loading|=1}),F.addEventListener("error",function(){j.loading|=2}),j.loading|=4,Cf(w,i,h)}w={type:"stylesheet",instance:w,count:1,state:j},m.set(y,w)}}}function SA(r,i){ka.X(r,i);var l=Ac;if(l&&r){var h=k(l).hoistableScripts,m=Cc(r),y=h.get(m);y||(y=l.querySelector(dh(m)),y||(r=x({src:r,async:!0},i),(i=bi.get(m))&&vy(r,i),y=l.createElement("script"),C(y),mr(y,"link",r),l.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},h.set(m,y))}}function jA(r,i){ka.M(r,i);var l=Ac;if(l&&r){var h=k(l).hoistableScripts,m=Cc(r),y=h.get(m);y||(y=l.querySelector(dh(m)),y||(r=x({src:r,async:!0,type:"module"},i),(i=bi.get(m))&&vy(r,i),y=l.createElement("script"),C(y),mr(y,"link",r),l.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},h.set(m,y))}}function H_(r,i,l,h){var m=(m=Me.current)?Rf(m):null;if(!m)throw Error(s(446));switch(r){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(i=Rc(l.href),l=k(m).hoistableStyles,h=l.get(i),h||(h={type:"style",instance:null,count:0,state:null},l.set(i,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){r=Rc(l.href);var y=k(m).hoistableStyles,w=y.get(r);if(w||(m=m.ownerDocument||m,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(r,w),(y=m.querySelector(hh(r)))&&!y._p&&(w.instance=y,w.state.loading=5),bi.has(r)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},bi.set(r,l),y||NA(m,r,l,w.state))),i&&h===null)throw Error(s(528,""));return w}if(i&&h!==null)throw Error(s(529,""));return null;case"script":return i=l.async,l=l.src,typeof l=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Cc(l),l=k(m).hoistableScripts,h=l.get(i),h||(h={type:"script",instance:null,count:0,state:null},l.set(i,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,r))}}function Rc(r){return'href="'+_t(r)+'"'}function hh(r){return'link[rel="stylesheet"]['+r+"]"}function W_(r){return x({},r,{"data-precedence":r.precedence,precedence:null})}function NA(r,i,l,h){r.querySelector('link[rel="preload"][as="style"]['+i+"]")?h.loading=1:(i=r.createElement("link"),h.preload=i,i.addEventListener("load",function(){return h.loading|=1}),i.addEventListener("error",function(){return h.loading|=2}),mr(i,"link",l),C(i),r.head.appendChild(i))}function Cc(r){return'[src="'+_t(r)+'"]'}function dh(r){return"script[async]"+r}function G_(r,i,l){if(i.count++,i.instance===null)switch(i.type){case"style":var h=r.querySelector('style[data-href~="'+_t(l.href)+'"]');if(h)return i.instance=h,C(h),h;var m=x({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return h=(r.ownerDocument||r).createElement("style"),C(h),mr(h,"style",m),Cf(h,l.precedence,r),i.instance=h;case"stylesheet":m=Rc(l.href);var y=r.querySelector(hh(m));if(y)return i.state.loading|=4,i.instance=y,C(y),y;h=W_(l),(m=bi.get(m))&&by(h,m),y=(r.ownerDocument||r).createElement("link"),C(y);var w=y;return w._p=new Promise(function(j,F){w.onload=j,w.onerror=F}),mr(y,"link",h),i.state.loading|=4,Cf(y,l.precedence,r),i.instance=y;case"script":return y=Cc(l.src),(m=r.querySelector(dh(y)))?(i.instance=m,C(m),m):(h=l,(m=bi.get(y))&&(h=x({},l),vy(h,m)),r=r.ownerDocument||r,m=r.createElement("script"),C(m),mr(m,"link",h),r.head.appendChild(m),i.instance=m);case"void":return null;default:throw Error(s(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(h=i.instance,i.state.loading|=4,Cf(h,l.precedence,r));return i.instance}function Cf(r,i,l){for(var h=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=h.length?h[h.length-1]:null,y=m,w=0;w<h.length;w++){var j=h[w];if(j.dataset.precedence===i)y=j;else if(y!==m)break}y?y.parentNode.insertBefore(r,y.nextSibling):(i=l.nodeType===9?l.head:l,i.insertBefore(r,i.firstChild))}function by(r,i){r.crossOrigin==null&&(r.crossOrigin=i.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=i.referrerPolicy),r.title==null&&(r.title=i.title)}function vy(r,i){r.crossOrigin==null&&(r.crossOrigin=i.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=i.referrerPolicy),r.integrity==null&&(r.integrity=i.integrity)}var If=null;function K_(r,i,l){if(If===null){var h=new Map,m=If=new Map;m.set(l,h)}else m=If,h=m.get(l),h||(h=new Map,m.set(l,h));if(h.has(r))return h;for(h.set(r,null),l=l.getElementsByTagName(r),m=0;m<l.length;m++){var y=l[m];if(!(y[Ts]||y[rt]||r==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var w=y.getAttribute(i)||"";w=r+w;var j=h.get(w);j?j.push(y):h.set(w,[y])}}return h}function Q_(r,i,l){r=r.ownerDocument||r,r.head.insertBefore(l,i==="title"?r.querySelector("head > title"):null)}function AA(r,i,l){if(l===1||i.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;return i.rel==="stylesheet"?(r=i.disabled,typeof i.precedence=="string"&&r==null):!0;case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function Y_(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function RA(r,i,l,h){if(l.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var m=Rc(h.href),y=i.querySelector(hh(m));if(y){i=y._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(r.count++,r=Df.bind(r),i.then(r,r)),l.state.loading|=4,l.instance=y,C(y);return}y=i.ownerDocument||i,h=W_(h),(m=bi.get(m))&&by(h,m),y=y.createElement("link"),C(y);var w=y;w._p=new Promise(function(j,F){w.onload=j,w.onerror=F}),mr(y,"link",h),l.instance=y}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(l,i),(i=l.state.preload)&&(l.state.loading&3)===0&&(r.count++,l=Df.bind(r),i.addEventListener("load",l),i.addEventListener("error",l))}}var xy=0;function CA(r,i){return r.stylesheets&&r.count===0&&Mf(r,r.stylesheets),0<r.count||0<r.imgCount?function(l){var h=setTimeout(function(){if(r.stylesheets&&Mf(r,r.stylesheets),r.unsuspend){var y=r.unsuspend;r.unsuspend=null,y()}},6e4+i);0<r.imgBytes&&xy===0&&(xy=62500*hA());var m=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&Mf(r,r.stylesheets),r.unsuspend)){var y=r.unsuspend;r.unsuspend=null,y()}},(r.imgBytes>xy?50:800)+i);return r.unsuspend=l,function(){r.unsuspend=null,clearTimeout(h),clearTimeout(m)}}:null}function Df(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Mf(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Pf=null;function Mf(r,i){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Pf=new Map,i.forEach(IA,r),Pf=null,Df.call(r))}function IA(r,i){if(!(i.state.loading&4)){var l=Pf.get(r);if(l)var h=l.get(null);else{l=new Map,Pf.set(r,l);for(var m=r.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<m.length;y++){var w=m[y];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(l.set(w.dataset.precedence,w),h=w)}h&&l.set(null,h)}m=i.instance,w=m.getAttribute("data-precedence"),y=l.get(w)||h,y===h&&l.set(null,m),l.set(w,m),this.count++,h=Df.bind(this),m.addEventListener("load",h),m.addEventListener("error",h),y?y.parentNode.insertBefore(m,y.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(m,r.firstChild)),i.state.loading|=4}}var fh={$$typeof:J,Provider:null,Consumer:null,_currentValue:Ve,_currentValue2:Ve,_threadCount:0};function DA(r,i,l,h,m,y,w,j,F){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=$t(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$t(0),this.hiddenUpdates=$t(null),this.identifierPrefix=h,this.onUncaughtError=m,this.onCaughtError=y,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=F,this.incompleteTransitions=new Map}function X_(r,i,l,h,m,y,w,j,F,le,je,Pe){return r=new DA(r,i,l,w,F,le,je,Pe,j),i=1,y===!0&&(i|=24),y=Qr(3,null,null,i),r.current=y,y.stateNode=r,i=Zp(),i.refCount++,r.pooledCache=i,i.refCount++,y.memoizedState={element:h,isDehydrated:l,cache:i},sg(y),r}function J_(r){return r?(r=lc,r):lc}function Z_(r,i,l,h,m,y){m=J_(m),h.context===null?h.context=m:h.pendingContext=m,h=Za(i),h.payload={element:l},y=y===void 0?null:y,y!==null&&(h.callback=y),l=eo(r,h,i),l!==null&&(zr(l,r,i),Hu(l,r,i))}function ew(r,i){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var l=r.retryLane;r.retryLane=l!==0&&l<i?l:i}}function _y(r,i){ew(r,i),(r=r.alternate)&&ew(r,i)}function tw(r){if(r.tag===13||r.tag===31){var i=sl(r,67108864);i!==null&&zr(i,r,67108864),_y(r,67108864)}}function nw(r){if(r.tag===13||r.tag===31){var i=ei();i=z(i);var l=sl(r,i);l!==null&&zr(l,r,i),_y(r,i)}}var Lf=!0;function PA(r,i,l,h){var m=H.T;H.T=null;var y=ye.p;try{ye.p=2,wy(r,i,l,h)}finally{ye.p=y,H.T=m}}function MA(r,i,l,h){var m=H.T;H.T=null;var y=ye.p;try{ye.p=8,wy(r,i,l,h)}finally{ye.p=y,H.T=m}}function wy(r,i,l,h){if(Lf){var m=Ty(h);if(m===null)ly(r,i,h,Vf,l),rw(r,h);else if(VA(m,r,i,l,h))h.stopPropagation();else if(rw(r,h),i&4&&-1<LA.indexOf(r)){for(;m!==null;){var y=W(m);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var w=at(y.pendingLanes);if(w!==0){var j=y;for(j.pendingLanes|=2,j.entangledLanes|=2;w;){var F=1<<31-ze(w);j.entanglements[1]|=F,w&=~F}Wi(y),(Fn&6)===0&&(vf=un()+500,oh(0))}}break;case 31:case 13:j=sl(y,2),j!==null&&zr(j,y,2),_f(),_y(y,2)}if(y=Ty(h),y===null&&ly(r,i,h,Vf,l),y===m)break;m=y}m!==null&&h.stopPropagation()}else ly(r,i,h,null,l)}}function Ty(r){return r=Us(r),Ey(r)}var Vf=null;function Ey(r){if(Vf=null,r=ts(r),r!==null){var i=c(r);if(i===null)r=null;else{var l=i.tag;if(l===13){if(r=u(i),r!==null)return r;r=null}else if(l===31){if(r=d(i),r!==null)return r;r=null}else if(l===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;r=null}else i!==r&&(r=null)}}return Vf=r,null}function sw(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ds()){case Kt:return 2;case Pn:return 8;case hn:case Rn:return 32;case he:return 268435456;default:return 32}default:return 32}}var ky=!1,ho=null,fo=null,mo=null,mh=new Map,ph=new Map,po=[],LA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function rw(r,i){switch(r){case"focusin":case"focusout":ho=null;break;case"dragenter":case"dragleave":fo=null;break;case"mouseover":case"mouseout":mo=null;break;case"pointerover":case"pointerout":mh.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":ph.delete(i.pointerId)}}function gh(r,i,l,h,m,y){return r===null||r.nativeEvent!==y?(r={blockedOn:i,domEventName:l,eventSystemFlags:h,nativeEvent:y,targetContainers:[m]},i!==null&&(i=W(i),i!==null&&tw(i)),r):(r.eventSystemFlags|=h,i=r.targetContainers,m!==null&&i.indexOf(m)===-1&&i.push(m),r)}function VA(r,i,l,h,m){switch(i){case"focusin":return ho=gh(ho,r,i,l,h,m),!0;case"dragenter":return fo=gh(fo,r,i,l,h,m),!0;case"mouseover":return mo=gh(mo,r,i,l,h,m),!0;case"pointerover":var y=m.pointerId;return mh.set(y,gh(mh.get(y)||null,r,i,l,h,m)),!0;case"gotpointercapture":return y=m.pointerId,ph.set(y,gh(ph.get(y)||null,r,i,l,h,m)),!0}return!1}function iw(r){var i=ts(r.target);if(i!==null){var l=c(i);if(l!==null){if(i=l.tag,i===13){if(i=u(l),i!==null){r.blockedOn=i,Se(r.priority,function(){nw(l)});return}}else if(i===31){if(i=d(l),i!==null){r.blockedOn=i,Se(r.priority,function(){nw(l)});return}}else if(i===3&&l.stateNode.current.memoizedState.isDehydrated){r.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Of(r){if(r.blockedOn!==null)return!1;for(var i=r.targetContainers;0<i.length;){var l=Ty(r.nativeEvent);if(l===null){l=r.nativeEvent;var h=new l.constructor(l.type,l);Ks=h,l.target.dispatchEvent(h),Ks=null}else return i=W(l),i!==null&&tw(i),r.blockedOn=l,!1;i.shift()}return!0}function aw(r,i,l){Of(r)&&l.delete(i)}function OA(){ky=!1,ho!==null&&Of(ho)&&(ho=null),fo!==null&&Of(fo)&&(fo=null),mo!==null&&Of(mo)&&(mo=null),mh.forEach(aw),ph.forEach(aw)}function Bf(r,i){r.blockedOn===i&&(r.blockedOn=null,ky||(ky=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,OA)))}var Uf=null;function ow(r){Uf!==r&&(Uf=r,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Uf===r&&(Uf=null);for(var i=0;i<r.length;i+=3){var l=r[i],h=r[i+1],m=r[i+2];if(typeof h!="function"){if(Ey(h||l)===null)continue;break}var y=W(l);y!==null&&(r.splice(i,3),i-=3,Tg(y,{pending:!0,data:m,method:l.method,action:h},h,m))}}))}function Ic(r){function i(F){return Bf(F,r)}ho!==null&&Bf(ho,r),fo!==null&&Bf(fo,r),mo!==null&&Bf(mo,r),mh.forEach(i),ph.forEach(i);for(var l=0;l<po.length;l++){var h=po[l];h.blockedOn===r&&(h.blockedOn=null)}for(;0<po.length&&(l=po[0],l.blockedOn===null);)iw(l),l.blockedOn===null&&po.shift();if(l=(r.ownerDocument||r).$$reactFormReplay,l!=null)for(h=0;h<l.length;h+=3){var m=l[h],y=l[h+1],w=m[Rt]||null;if(typeof y=="function")w||ow(l);else if(w){var j=null;if(y&&y.hasAttribute("formAction")){if(m=y,w=y[Rt]||null)j=w.formAction;else if(Ey(m)!==null)continue}else j=w.action;typeof j=="function"?l[h+1]=j:(l.splice(h,3),h-=3),ow(l)}}}function lw(){function r(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(w){return m=w})},focusReset:"manual",scroll:"manual"})}function i(){m!==null&&(m(),m=null),h||setTimeout(l,20)}function l(){if(!h&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,m=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(l,100),function(){h=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),m!==null&&(m(),m=null)}}}function Sy(r){this._internalRoot=r}Ff.prototype.render=Sy.prototype.render=function(r){var i=this._internalRoot;if(i===null)throw Error(s(409));var l=i.current,h=ei();Z_(l,h,r,i,null,null)},Ff.prototype.unmount=Sy.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var i=r.containerInfo;Z_(r.current,2,null,r,null,null),_f(),i[ot]=null}};function Ff(r){this._internalRoot=r}Ff.prototype.unstable_scheduleHydration=function(r){if(r){var i=ke();r={blockedOn:null,target:r,priority:i};for(var l=0;l<po.length&&i!==0&&i<po[l].priority;l++);po.splice(l,0,r),l===0&&iw(r)}};var cw=e.version;if(cw!=="19.2.4")throw Error(s(527,cw,"19.2.4"));ye.findDOMNode=function(r){var i=r._reactInternals;if(i===void 0)throw typeof r.render=="function"?Error(s(188)):(r=Object.keys(r).join(","),Error(s(268,r)));return r=g(i),r=r!==null?b(r):null,r=r===null?null:r.stateNode,r};var BA={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:H,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zf.isDisabled&&zf.supportsFiber)try{tt=zf.inject(BA),Fe=zf}catch{}}return bh.createRoot=function(r,i){if(!o(r))throw Error(s(299));var l=!1,h="",m=gx,y=yx,w=bx;return i!=null&&(i.unstable_strictMode===!0&&(l=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onUncaughtError!==void 0&&(m=i.onUncaughtError),i.onCaughtError!==void 0&&(y=i.onCaughtError),i.onRecoverableError!==void 0&&(w=i.onRecoverableError)),i=X_(r,1,!1,null,null,l,h,null,m,y,w,lw),r[ot]=i.current,oy(r),new Sy(i)},bh.hydrateRoot=function(r,i,l){if(!o(r))throw Error(s(299));var h=!1,m="",y=gx,w=yx,j=bx,F=null;return l!=null&&(l.unstable_strictMode===!0&&(h=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onUncaughtError!==void 0&&(y=l.onUncaughtError),l.onCaughtError!==void 0&&(w=l.onCaughtError),l.onRecoverableError!==void 0&&(j=l.onRecoverableError),l.formState!==void 0&&(F=l.formState)),i=X_(r,1,!0,i,l??null,h,m,F,y,w,j,lw),i.context=J_(null),l=i.current,h=ei(),h=z(h),m=Za(h),m.callback=null,eo(l,m,h),l=h,i.current.lanes=l,Mn(i,l),Wi(i),r[ot]=i.current,oy(r),new Ff(i)},bh.version="19.2.4",bh}var vw;function QA(){if(vw)return Ay.exports;vw=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Ay.exports=KA(),Ay.exports}var YA=QA();const XA="modulepreload",JA=function(n){return"/login/"+n},xw={},Dr=function(e,t,s){let o=Promise.resolve();if(t&&t.length>0){let p=function(g){return Promise.all(g.map(b=>Promise.resolve(b).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),d=u?.nonce||u?.getAttribute("nonce");o=p(t.map(g=>{if(g=JA(g),g in xw)return;xw[g]=!0;const b=g.endsWith(".css"),x=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${x}`))return;const T=document.createElement("link");if(T.rel=b?"stylesheet":XA,b||(T.as="script"),T.crossOrigin="",T.href=g,d&&T.setAttribute("nonce",d),document.head.appendChild(T),b)return new Promise((N,B)=>{T.addEventListener("load",N),T.addEventListener("error",()=>B(new Error(`Unable to preload CSS for ${g}`)))})}))}function c(u){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=u,window.dispatchEvent(d),!d.defaultPrevented)throw u}return o.then(u=>{for(const d of u||[])d.status==="rejected"&&c(d.reason);return e().catch(c)})};var _w="popstate";function ZA(n={}){function e(s,o){let{pathname:c,search:u,hash:d}=s.location;return gb("",{pathname:c,search:u,hash:d},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function t(s,o){return typeof o=="string"?o:Qh(o)}return tR(e,t,null,n)}function vs(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function _i(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function eR(){return Math.random().toString(36).substring(2,10)}function ww(n,e){return{usr:n.state,key:n.key,idx:e}}function gb(n,e,t=null,s){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?vu(e):e,state:t,key:e&&e.key||s||eR()}}function Qh({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function vu(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substring(s),n=n.substring(0,s)),n&&(e.pathname=n)}return e}function tR(n,e,t,s={}){let{window:o=document.defaultView,v5Compat:c=!1}=s,u=o.history,d="POP",p=null,g=b();g==null&&(g=0,u.replaceState({...u.state,idx:g},""));function b(){return(u.state||{idx:null}).idx}function x(){d="POP";let P=b(),Y=P==null?null:P-g;g=P,p&&p({action:d,location:M.location,delta:Y})}function T(P,Y){d="PUSH";let $=gb(M.location,P,Y);g=b()+1;let J=ww($,g),de=M.createHref($);try{u.pushState(J,"",de)}catch(Ne){if(Ne instanceof DOMException&&Ne.name==="DataCloneError")throw Ne;o.location.assign(de)}c&&p&&p({action:d,location:M.location,delta:1})}function N(P,Y){d="REPLACE";let $=gb(M.location,P,Y);g=b();let J=ww($,g),de=M.createHref($);u.replaceState(J,"",de),c&&p&&p({action:d,location:M.location,delta:0})}function B(P){return nR(P)}let M={get action(){return d},get location(){return n(o,u)},listen(P){if(p)throw new Error("A history only accepts one active listener");return o.addEventListener(_w,x),p=P,()=>{o.removeEventListener(_w,x),p=null}},createHref(P){return e(o,P)},createURL:B,encodeLocation(P){let Y=B(P);return{pathname:Y.pathname,search:Y.search,hash:Y.hash}},push:T,replace:N,go(P){return u.go(P)}};return M}function nR(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),vs(t,"No window.location.(origin|href) available to create URL");let s=typeof n=="string"?n:Qh(n);return s=s.replace(/ $/,"%20"),!e&&s.startsWith("//")&&(s=t+s),new URL(s,t)}function HT(n,e,t="/"){return sR(n,e,t,!1)}function sR(n,e,t,s){let o=typeof e=="string"?vu(e):e,c=Da(o.pathname||"/",t);if(c==null)return null;let u=WT(n);rR(u);let d=null;for(let p=0;d==null&&p<u.length;++p){let g=pR(c);d=fR(u[p],g,s)}return d}function WT(n,e=[],t=[],s="",o=!1){let c=(u,d,p=o,g)=>{let b={relativePath:g===void 0?u.path||"":g,caseSensitive:u.caseSensitive===!0,childrenIndex:d,route:u};if(b.relativePath.startsWith("/")){if(!b.relativePath.startsWith(s)&&p)return;vs(b.relativePath.startsWith(s),`Absolute route path "${b.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),b.relativePath=b.relativePath.slice(s.length)}let x=Ra([s,b.relativePath]),T=t.concat(b);u.children&&u.children.length>0&&(vs(u.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${x}".`),WT(u.children,e,T,x,p)),!(u.path==null&&!u.index)&&e.push({path:x,score:hR(x,u.index),routesMeta:T})};return n.forEach((u,d)=>{if(u.path===""||!u.path?.includes("?"))c(u,d);else for(let p of GT(u.path))c(u,d,!0,p)}),e}function GT(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,o=t.endsWith("?"),c=t.replace(/\?$/,"");if(s.length===0)return o?[c,""]:[c];let u=GT(s.join("/")),d=[];return d.push(...u.map(p=>p===""?c:[c,p].join("/"))),o&&d.push(...u),d.map(p=>n.startsWith("/")&&p===""?"/":p)}function rR(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:dR(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}var iR=/^:[\w-]+$/,aR=3,oR=2,lR=1,cR=10,uR=-2,Tw=n=>n==="*";function hR(n,e){let t=n.split("/"),s=t.length;return t.some(Tw)&&(s+=uR),e&&(s+=oR),t.filter(o=>!Tw(o)).reduce((o,c)=>o+(iR.test(c)?aR:c===""?lR:cR),s)}function dR(n,e){return n.length===e.length&&n.slice(0,-1).every((s,o)=>s===e[o])?n[n.length-1]-e[e.length-1]:0}function fR(n,e,t=!1){let{routesMeta:s}=n,o={},c="/",u=[];for(let d=0;d<s.length;++d){let p=s[d],g=d===s.length-1,b=c==="/"?e:e.slice(c.length)||"/",x=Em({path:p.relativePath,caseSensitive:p.caseSensitive,end:g},b),T=p.route;if(!x&&g&&t&&!s[s.length-1].route.index&&(x=Em({path:p.relativePath,caseSensitive:p.caseSensitive,end:!1},b)),!x)return null;Object.assign(o,x.params),u.push({params:o,pathname:Ra([c,x.pathname]),pathnameBase:vR(Ra([c,x.pathnameBase])),route:T}),x.pathnameBase!=="/"&&(c=Ra([c,x.pathnameBase]))}return u}function Em(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=mR(n.path,n.caseSensitive,n.end),o=e.match(t);if(!o)return null;let c=o[0],u=c.replace(/(.)\/+$/,"$1"),d=o.slice(1);return{params:s.reduce((g,{paramName:b,isOptional:x},T)=>{if(b==="*"){let B=d[T]||"";u=c.slice(0,c.length-B.length).replace(/(.)\/+$/,"$1")}const N=d[T];return x&&!N?g[b]=void 0:g[b]=(N||"").replace(/%2F/g,"/"),g},{}),pathname:c,pathnameBase:u,pattern:n}}function mR(n,e=!1,t=!0){_i(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let s=[],o="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,d,p)=>(s.push({paramName:d,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(s.push({paramName:"*"}),o+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?o+="\\/*$":n!==""&&n!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),s]}function pR(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return _i(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function Da(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}var gR=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function yR(n,e="/"){let{pathname:t,search:s="",hash:o=""}=typeof n=="string"?vu(n):n,c;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?c=Ew(t.substring(1),"/"):c=Ew(t,e)):c=e,{pathname:c,search:xR(s),hash:_R(o)}}function Ew(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(o=>{o===".."?t.length>1&&t.pop():o!=="."&&t.push(o)}),t.length>1?t.join("/"):"/"}function Dy(n,e,t,s){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function bR(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function rv(n){let e=bR(n);return e.map((t,s)=>s===e.length-1?t.pathname:t.pathnameBase)}function iv(n,e,t,s=!1){let o;typeof n=="string"?o=vu(n):(o={...n},vs(!o.pathname||!o.pathname.includes("?"),Dy("?","pathname","search",o)),vs(!o.pathname||!o.pathname.includes("#"),Dy("#","pathname","hash",o)),vs(!o.search||!o.search.includes("#"),Dy("#","search","hash",o)));let c=n===""||o.pathname==="",u=c?"/":o.pathname,d;if(u==null)d=t;else{let x=e.length-1;if(!s&&u.startsWith("..")){let T=u.split("/");for(;T[0]==="..";)T.shift(),x-=1;o.pathname=T.join("/")}d=x>=0?e[x]:"/"}let p=yR(o,d),g=u&&u!=="/"&&u.endsWith("/"),b=(c||u===".")&&t.endsWith("/");return!p.pathname.endsWith("/")&&(g||b)&&(p.pathname+="/"),p}var Ra=n=>n.join("/").replace(/\/\/+/g,"/"),vR=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),xR=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,_R=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,wR=class{constructor(n,e,t,s=!1){this.status=n,this.statusText=e||"",this.internal=s,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function TR(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function ER(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var KT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function QT(n,e){let t=n;if(typeof t!="string"||!gR.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let s=t,o=!1;if(KT)try{let c=new URL(window.location.href),u=t.startsWith("//")?new URL(c.protocol+t):new URL(t),d=Da(u.pathname,e);u.origin===c.origin&&d!=null?t=d+u.search+u.hash:o=!0}catch{_i(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:s,isExternal:o,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var YT=["POST","PUT","PATCH","DELETE"];new Set(YT);var kR=["GET",...YT];new Set(kR);var xu=_.createContext(null);xu.displayName="DataRouter";var Zm=_.createContext(null);Zm.displayName="DataRouterState";var SR=_.createContext(!1),XT=_.createContext({isTransitioning:!1});XT.displayName="ViewTransition";var jR=_.createContext(new Map);jR.displayName="Fetchers";var NR=_.createContext(null);NR.displayName="Await";var oi=_.createContext(null);oi.displayName="Navigation";var dd=_.createContext(null);dd.displayName="Location";var Vi=_.createContext({outlet:null,matches:[],isDataRoute:!1});Vi.displayName="Route";var av=_.createContext(null);av.displayName="RouteError";var JT="REACT_ROUTER_ERROR",AR="REDIRECT",RR="ROUTE_ERROR_RESPONSE";function CR(n){if(n.startsWith(`${JT}:${AR}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function IR(n){if(n.startsWith(`${JT}:${RR}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new wR(e.status,e.statusText,e.data)}catch{}}function DR(n,{relative:e}={}){vs(_u(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:s}=_.useContext(oi),{hash:o,pathname:c,search:u}=fd(n,{relative:e}),d=c;return t!=="/"&&(d=c==="/"?t:Ra([t,c])),s.createHref({pathname:d,search:u,hash:o})}function _u(){return _.useContext(dd)!=null}function Oi(){return vs(_u(),"useLocation() may be used only in the context of a <Router> component."),_.useContext(dd).location}var ZT="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function eE(n){_.useContext(oi).static||_.useLayoutEffect(n)}function gr(){let{isDataRoute:n}=_.useContext(Vi);return n?GR():PR()}function PR(){vs(_u(),"useNavigate() may be used only in the context of a <Router> component.");let n=_.useContext(xu),{basename:e,navigator:t}=_.useContext(oi),{matches:s}=_.useContext(Vi),{pathname:o}=Oi(),c=JSON.stringify(rv(s)),u=_.useRef(!1);return eE(()=>{u.current=!0}),_.useCallback((p,g={})=>{if(_i(u.current,ZT),!u.current)return;if(typeof p=="number"){t.go(p);return}let b=iv(p,JSON.parse(c),o,g.relative==="path");n==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:Ra([e,b.pathname])),(g.replace?t.replace:t.push)(b,g.state,g)},[e,t,c,o,n])}_.createContext(null);function MR(){let{matches:n}=_.useContext(Vi),e=n[n.length-1];return e?e.params:{}}function fd(n,{relative:e}={}){let{matches:t}=_.useContext(Vi),{pathname:s}=Oi(),o=JSON.stringify(rv(t));return _.useMemo(()=>iv(n,JSON.parse(o),s,e==="path"),[n,o,s,e])}function LR(n,e){return tE(n,e)}function tE(n,e,t,s,o){vs(_u(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:c}=_.useContext(oi),{matches:u}=_.useContext(Vi),d=u[u.length-1],p=d?d.params:{},g=d?d.pathname:"/",b=d?d.pathnameBase:"/",x=d&&d.route;{let $=x&&x.path||"";sE(g,!x||$.endsWith("*")||$.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${g}" (under <Route path="${$}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${$}"> to <Route path="${$==="/"?"*":`${$}/*`}">.`)}let T=Oi(),N;if(e){let $=typeof e=="string"?vu(e):e;vs(b==="/"||$.pathname?.startsWith(b),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${b}" but pathname "${$.pathname}" was given in the \`location\` prop.`),N=$}else N=T;let B=N.pathname||"/",M=B;if(b!=="/"){let $=b.replace(/^\//,"").split("/");M="/"+B.replace(/^\//,"").split("/").slice($.length).join("/")}let P=HT(n,{pathname:M});_i(x||P!=null,`No routes matched location "${N.pathname}${N.search}${N.hash}" `),_i(P==null||P[P.length-1].route.element!==void 0||P[P.length-1].route.Component!==void 0||P[P.length-1].route.lazy!==void 0,`Matched leaf route at location "${N.pathname}${N.search}${N.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let Y=FR(P&&P.map($=>Object.assign({},$,{params:Object.assign({},p,$.params),pathname:Ra([b,c.encodeLocation?c.encodeLocation($.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:$.pathname]),pathnameBase:$.pathnameBase==="/"?b:Ra([b,c.encodeLocation?c.encodeLocation($.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:$.pathnameBase])})),u,t,s,o);return e&&Y?_.createElement(dd.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...N},navigationType:"POP"}},Y):Y}function VR(){let n=WR(),e=TR(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:s},c={padding:"2px 4px",backgroundColor:s},u=null;return console.error("Error handled by React Router default ErrorBoundary:",n),u=_.createElement(_.Fragment,null,_.createElement("p",null," Hey developer "),_.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",_.createElement("code",{style:c},"ErrorBoundary")," or"," ",_.createElement("code",{style:c},"errorElement")," prop on your route.")),_.createElement(_.Fragment,null,_.createElement("h2",null,"Unexpected Application Error!"),_.createElement("h3",{style:{fontStyle:"italic"}},e),t?_.createElement("pre",{style:o},t):null,u)}var OR=_.createElement(VR,null),nE=class extends _.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=IR(n.digest);t&&(n=t)}let e=n!==void 0?_.createElement(Vi.Provider,{value:this.props.routeContext},_.createElement(av.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?_.createElement(BR,{error:n},e):e}};nE.contextType=SR;var Py=new WeakMap;function BR({children:n,error:e}){let{basename:t}=_.useContext(oi);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let s=CR(e.digest);if(s){let o=Py.get(e);if(o)throw o;let c=QT(s.location,t);if(KT&&!Py.get(e))if(c.isExternal||s.reloadDocument)window.location.href=c.absoluteURL||c.to;else{const u=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(c.to,{replace:s.replace}));throw Py.set(e,u),u}return _.createElement("meta",{httpEquiv:"refresh",content:`0;url=${c.absoluteURL||c.to}`})}}return n}function UR({routeContext:n,match:e,children:t}){let s=_.useContext(xu);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),_.createElement(Vi.Provider,{value:n},t)}function FR(n,e=[],t=null,s=null,o=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let c=n,u=t?.errors;if(u!=null){let b=c.findIndex(x=>x.route.id&&u?.[x.route.id]!==void 0);vs(b>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(u).join(",")}`),c=c.slice(0,Math.min(c.length,b+1))}let d=!1,p=-1;if(t)for(let b=0;b<c.length;b++){let x=c[b];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(p=b),x.route.id){let{loaderData:T,errors:N}=t,B=x.route.loader&&!T.hasOwnProperty(x.route.id)&&(!N||N[x.route.id]===void 0);if(x.route.lazy||B){d=!0,p>=0?c=c.slice(0,p+1):c=[c[0]];break}}}let g=t&&s?(b,x)=>{s(b,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:ER(t.matches),errorInfo:x})}:void 0;return c.reduceRight((b,x,T)=>{let N,B=!1,M=null,P=null;t&&(N=u&&x.route.id?u[x.route.id]:void 0,M=x.route.errorElement||OR,d&&(p<0&&T===0?(sE("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),B=!0,P=null):p===T&&(B=!0,P=x.route.hydrateFallbackElement||null)));let Y=e.concat(c.slice(0,T+1)),$=()=>{let J;return N?J=M:B?J=P:x.route.Component?J=_.createElement(x.route.Component,null):x.route.element?J=x.route.element:J=b,_.createElement(UR,{match:x,routeContext:{outlet:b,matches:Y,isDataRoute:t!=null},children:J})};return t&&(x.route.ErrorBoundary||x.route.errorElement||T===0)?_.createElement(nE,{location:t.location,revalidation:t.revalidation,component:M,error:N,children:$(),routeContext:{outlet:null,matches:Y,isDataRoute:!0},onError:g}):$()},null)}function ov(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function zR(n){let e=_.useContext(xu);return vs(e,ov(n)),e}function qR(n){let e=_.useContext(Zm);return vs(e,ov(n)),e}function $R(n){let e=_.useContext(Vi);return vs(e,ov(n)),e}function lv(n){let e=$R(n),t=e.matches[e.matches.length-1];return vs(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function HR(){return lv("useRouteId")}function WR(){let n=_.useContext(av),e=qR("useRouteError"),t=lv("useRouteError");return n!==void 0?n:e.errors?.[t]}function GR(){let{router:n}=zR("useNavigate"),e=lv("useNavigate"),t=_.useRef(!1);return eE(()=>{t.current=!0}),_.useCallback(async(o,c={})=>{_i(t.current,ZT),t.current&&(typeof o=="number"?await n.navigate(o):await n.navigate(o,{fromRouteId:e,...c}))},[n,e])}var kw={};function sE(n,e,t){!e&&!kw[n]&&(kw[n]=!0,_i(!1,t))}_.memo(KR);function KR({routes:n,future:e,state:t,onError:s}){return tE(n,void 0,t,s,e)}function QR({to:n,replace:e,state:t,relative:s}){vs(_u(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=_.useContext(oi);_i(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:c}=_.useContext(Vi),{pathname:u}=Oi(),d=gr(),p=iv(n,rv(c),u,s==="path"),g=JSON.stringify(p);return _.useEffect(()=>{d(JSON.parse(g),{replace:e,state:t,relative:s})},[d,g,s,e,t]),null}function is(n){vs(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function YR({basename:n="/",children:e=null,location:t,navigationType:s="POP",navigator:o,static:c=!1,unstable_useTransitions:u}){vs(!_u(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let d=n.replace(/^\/*/,"/"),p=_.useMemo(()=>({basename:d,navigator:o,static:c,unstable_useTransitions:u,future:{}}),[d,o,c,u]);typeof t=="string"&&(t=vu(t));let{pathname:g="/",search:b="",hash:x="",state:T=null,key:N="default"}=t,B=_.useMemo(()=>{let M=Da(g,d);return M==null?null:{location:{pathname:M,search:b,hash:x,state:T,key:N},navigationType:s}},[d,g,b,x,T,N,s]);return _i(B!=null,`<Router basename="${d}"> is not able to match the URL "${g}${b}${x}" because it does not start with the basename, so the <Router> won't render anything.`),B==null?null:_.createElement(oi.Provider,{value:p},_.createElement(dd.Provider,{children:e,value:B}))}function XR({children:n,location:e}){return LR(yb(n),e)}function yb(n,e=[]){let t=[];return _.Children.forEach(n,(s,o)=>{if(!_.isValidElement(s))return;let c=[...e,o];if(s.type===_.Fragment){t.push.apply(t,yb(s.props.children,c));return}vs(s.type===is,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),vs(!s.props.index||!s.props.children,"An index route cannot have child routes.");let u={id:s.props.id||c.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(u.children=yb(s.props.children,c)),t.push(u)}),t}var om="get",lm="application/x-www-form-urlencoded";function ep(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function JR(n){return ep(n)&&n.tagName.toLowerCase()==="button"}function ZR(n){return ep(n)&&n.tagName.toLowerCase()==="form"}function eC(n){return ep(n)&&n.tagName.toLowerCase()==="input"}function tC(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function nC(n,e){return n.button===0&&(!e||e==="_self")&&!tC(n)}function bb(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let s=n[t];return e.concat(Array.isArray(s)?s.map(o=>[t,o]):[[t,s]])},[]))}function sC(n,e){let t=bb(n);return e&&e.forEach((s,o)=>{t.has(o)||e.getAll(o).forEach(c=>{t.append(o,c)})}),t}var qf=null;function rC(){if(qf===null)try{new FormData(document.createElement("form"),0),qf=!1}catch{qf=!0}return qf}var iC=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function My(n){return n!=null&&!iC.has(n)?(_i(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${lm}"`),null):n}function aC(n,e){let t,s,o,c,u;if(ZR(n)){let d=n.getAttribute("action");s=d?Da(d,e):null,t=n.getAttribute("method")||om,o=My(n.getAttribute("enctype"))||lm,c=new FormData(n)}else if(JR(n)||eC(n)&&(n.type==="submit"||n.type==="image")){let d=n.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let p=n.getAttribute("formaction")||d.getAttribute("action");if(s=p?Da(p,e):null,t=n.getAttribute("formmethod")||d.getAttribute("method")||om,o=My(n.getAttribute("formenctype"))||My(d.getAttribute("enctype"))||lm,c=new FormData(d,n),!rC()){let{name:g,type:b,value:x}=n;if(b==="image"){let T=g?`${g}.`:"";c.append(`${T}x`,"0"),c.append(`${T}y`,"0")}else g&&c.append(g,x)}}else{if(ep(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=om,s=null,o=lm,u=n}return c&&o==="text/plain"&&(u=c,c=void 0),{action:s,method:t.toLowerCase(),encType:o,formData:c,body:u}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function cv(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function oC(n,e,t,s){let o=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?o.pathname.endsWith("/")?o.pathname=`${o.pathname}_.${s}`:o.pathname=`${o.pathname}.${s}`:o.pathname==="/"?o.pathname=`_root.${s}`:e&&Da(o.pathname,e)==="/"?o.pathname=`${e.replace(/\/$/,"")}/_root.${s}`:o.pathname=`${o.pathname.replace(/\/$/,"")}.${s}`,o}async function lC(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function cC(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function uC(n,e,t){let s=await Promise.all(n.map(async o=>{let c=e.routes[o.route.id];if(c){let u=await lC(c,t);return u.links?u.links():[]}return[]}));return mC(s.flat(1).filter(cC).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function Sw(n,e,t,s,o,c){let u=(p,g)=>t[g]?p.route.id!==t[g].route.id:!0,d=(p,g)=>t[g].pathname!==p.pathname||t[g].route.path?.endsWith("*")&&t[g].params["*"]!==p.params["*"];return c==="assets"?e.filter((p,g)=>u(p,g)||d(p,g)):c==="data"?e.filter((p,g)=>{let b=s.routes[p.route.id];if(!b||!b.hasLoader)return!1;if(u(p,g)||d(p,g))return!0;if(p.route.shouldRevalidate){let x=p.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:p.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function hC(n,e,{includeHydrateFallback:t}={}){return dC(n.map(s=>{let o=e.routes[s.route.id];if(!o)return[];let c=[o.module];return o.clientActionModule&&(c=c.concat(o.clientActionModule)),o.clientLoaderModule&&(c=c.concat(o.clientLoaderModule)),t&&o.hydrateFallbackModule&&(c=c.concat(o.hydrateFallbackModule)),o.imports&&(c=c.concat(o.imports)),c}).flat(1))}function dC(n){return[...new Set(n)]}function fC(n){let e={},t=Object.keys(n).sort();for(let s of t)e[s]=n[s];return e}function mC(n,e){let t=new Set;return new Set(e),n.reduce((s,o)=>{let c=JSON.stringify(fC(o));return t.has(c)||(t.add(c),s.push({key:c,link:o})),s},[])}function rE(){let n=_.useContext(xu);return cv(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function pC(){let n=_.useContext(Zm);return cv(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var uv=_.createContext(void 0);uv.displayName="FrameworkContext";function iE(){let n=_.useContext(uv);return cv(n,"You must render this element inside a <HydratedRouter> element"),n}function gC(n,e){let t=_.useContext(uv),[s,o]=_.useState(!1),[c,u]=_.useState(!1),{onFocus:d,onBlur:p,onMouseEnter:g,onMouseLeave:b,onTouchStart:x}=e,T=_.useRef(null);_.useEffect(()=>{if(n==="render"&&u(!0),n==="viewport"){let M=Y=>{Y.forEach($=>{u($.isIntersecting)})},P=new IntersectionObserver(M,{threshold:.5});return T.current&&P.observe(T.current),()=>{P.disconnect()}}},[n]),_.useEffect(()=>{if(s){let M=setTimeout(()=>{u(!0)},100);return()=>{clearTimeout(M)}}},[s]);let N=()=>{o(!0)},B=()=>{o(!1),u(!1)};return t?n!=="intent"?[c,T,{}]:[c,T,{onFocus:vh(d,N),onBlur:vh(p,B),onMouseEnter:vh(g,N),onMouseLeave:vh(b,B),onTouchStart:vh(x,N)}]:[!1,T,{}]}function vh(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function yC({page:n,...e}){let{router:t}=rE(),s=_.useMemo(()=>HT(t.routes,n,t.basename),[t.routes,n,t.basename]);return s?_.createElement(vC,{page:n,matches:s,...e}):null}function bC(n){let{manifest:e,routeModules:t}=iE(),[s,o]=_.useState([]);return _.useEffect(()=>{let c=!1;return uC(n,e,t).then(u=>{c||o(u)}),()=>{c=!0}},[n,e,t]),s}function vC({page:n,matches:e,...t}){let s=Oi(),{future:o,manifest:c,routeModules:u}=iE(),{basename:d}=rE(),{loaderData:p,matches:g}=pC(),b=_.useMemo(()=>Sw(n,e,g,c,s,"data"),[n,e,g,c,s]),x=_.useMemo(()=>Sw(n,e,g,c,s,"assets"),[n,e,g,c,s]),T=_.useMemo(()=>{if(n===s.pathname+s.search+s.hash)return[];let M=new Set,P=!1;if(e.forEach($=>{let J=c.routes[$.route.id];!J||!J.hasLoader||(!b.some(de=>de.route.id===$.route.id)&&$.route.id in p&&u[$.route.id]?.shouldRevalidate||J.hasClientLoader?P=!0:M.add($.route.id))}),M.size===0)return[];let Y=oC(n,d,o.unstable_trailingSlashAwareDataRequests,"data");return P&&M.size>0&&Y.searchParams.set("_routes",e.filter($=>M.has($.route.id)).map($=>$.route.id).join(",")),[Y.pathname+Y.search]},[d,o.unstable_trailingSlashAwareDataRequests,p,s,c,b,e,n,u]),N=_.useMemo(()=>hC(x,c),[x,c]),B=bC(x);return _.createElement(_.Fragment,null,T.map(M=>_.createElement("link",{key:M,rel:"prefetch",as:"fetch",href:M,...t})),N.map(M=>_.createElement("link",{key:M,rel:"modulepreload",href:M,...t})),B.map(({key:M,link:P})=>_.createElement("link",{key:M,nonce:t.nonce,...P,crossOrigin:P.crossOrigin??t.crossOrigin})))}function xC(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var _C=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{_C&&(window.__reactRouterVersion="7.13.0")}catch{}function wC({basename:n,children:e,unstable_useTransitions:t,window:s}){let o=_.useRef();o.current==null&&(o.current=ZA({window:s,v5Compat:!0}));let c=o.current,[u,d]=_.useState({action:c.action,location:c.location}),p=_.useCallback(g=>{t===!1?d(g):_.startTransition(()=>d(g))},[t]);return _.useLayoutEffect(()=>c.listen(p),[c,p]),_.createElement(YR,{basename:n,children:e,location:u.location,navigationType:u.action,navigator:c,unstable_useTransitions:t})}var aE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,oE=_.forwardRef(function({onClick:e,discover:t="render",prefetch:s="none",relative:o,reloadDocument:c,replace:u,state:d,target:p,to:g,preventScrollReset:b,viewTransition:x,unstable_defaultShouldRevalidate:T,...N},B){let{basename:M,unstable_useTransitions:P}=_.useContext(oi),Y=typeof g=="string"&&aE.test(g),$=QT(g,M);g=$.to;let J=DR(g,{relative:o}),[de,Ne,we]=gC(s,N),A=SC(g,{replace:u,state:d,target:p,preventScrollReset:b,relative:o,viewTransition:x,unstable_defaultShouldRevalidate:T,unstable_useTransitions:P});function S(U){e&&e(U),U.defaultPrevented||A(U)}let D=_.createElement("a",{...N,...we,href:$.absoluteURL||J,onClick:$.isExternal||c?e:S,ref:xC(B,Ne),target:p,"data-discover":!Y&&t==="render"?"true":void 0});return de&&!Y?_.createElement(_.Fragment,null,D,_.createElement(yC,{page:J})):D});oE.displayName="Link";var TC=_.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:s="",end:o=!1,style:c,to:u,viewTransition:d,children:p,...g},b){let x=fd(u,{relative:g.relative}),T=Oi(),N=_.useContext(Zm),{navigator:B,basename:M}=_.useContext(oi),P=N!=null&&IC(x)&&d===!0,Y=B.encodeLocation?B.encodeLocation(x).pathname:x.pathname,$=T.pathname,J=N&&N.navigation&&N.navigation.location?N.navigation.location.pathname:null;t||($=$.toLowerCase(),J=J?J.toLowerCase():null,Y=Y.toLowerCase()),J&&M&&(J=Da(J,M)||J);const de=Y!=="/"&&Y.endsWith("/")?Y.length-1:Y.length;let Ne=$===Y||!o&&$.startsWith(Y)&&$.charAt(de)==="/",we=J!=null&&(J===Y||!o&&J.startsWith(Y)&&J.charAt(Y.length)==="/"),A={isActive:Ne,isPending:we,isTransitioning:P},S=Ne?e:void 0,D;typeof s=="function"?D=s(A):D=[s,Ne?"active":null,we?"pending":null,P?"transitioning":null].filter(Boolean).join(" ");let U=typeof c=="function"?c(A):c;return _.createElement(oE,{...g,"aria-current":S,className:D,ref:b,style:U,to:u,viewTransition:d},typeof p=="function"?p(A):p)});TC.displayName="NavLink";var EC=_.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:s,replace:o,state:c,method:u=om,action:d,onSubmit:p,relative:g,preventScrollReset:b,viewTransition:x,unstable_defaultShouldRevalidate:T,...N},B)=>{let{unstable_useTransitions:M}=_.useContext(oi),P=RC(),Y=CC(d,{relative:g}),$=u.toLowerCase()==="get"?"get":"post",J=typeof d=="string"&&aE.test(d),de=Ne=>{if(p&&p(Ne),Ne.defaultPrevented)return;Ne.preventDefault();let we=Ne.nativeEvent.submitter,A=we?.getAttribute("formmethod")||u,S=()=>P(we||Ne.currentTarget,{fetcherKey:e,method:A,navigate:t,replace:o,state:c,relative:g,preventScrollReset:b,viewTransition:x,unstable_defaultShouldRevalidate:T});M&&t!==!1?_.startTransition(()=>S()):S()};return _.createElement("form",{ref:B,method:$,action:Y,onSubmit:s?p:de,...N,"data-discover":!J&&n==="render"?"true":void 0})});EC.displayName="Form";function kC(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function lE(n){let e=_.useContext(xu);return vs(e,kC(n)),e}function SC(n,{target:e,replace:t,state:s,preventScrollReset:o,relative:c,viewTransition:u,unstable_defaultShouldRevalidate:d,unstable_useTransitions:p}={}){let g=gr(),b=Oi(),x=fd(n,{relative:c});return _.useCallback(T=>{if(nC(T,e)){T.preventDefault();let N=t!==void 0?t:Qh(b)===Qh(x),B=()=>g(n,{replace:N,state:s,preventScrollReset:o,relative:c,viewTransition:u,unstable_defaultShouldRevalidate:d});p?_.startTransition(()=>B()):B()}},[b,g,x,t,s,e,n,o,c,u,d,p])}function jC(n){_i(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=_.useRef(bb(n)),t=_.useRef(!1),s=Oi(),o=_.useMemo(()=>sC(s.search,t.current?null:e.current),[s.search]),c=gr(),u=_.useCallback((d,p)=>{const g=bb(typeof d=="function"?d(new URLSearchParams(o)):d);t.current=!0,c("?"+g,p)},[c,o]);return[o,u]}var NC=0,AC=()=>`__${String(++NC)}__`;function RC(){let{router:n}=lE("useSubmit"),{basename:e}=_.useContext(oi),t=HR(),s=n.fetch,o=n.navigate;return _.useCallback(async(c,u={})=>{let{action:d,method:p,encType:g,formData:b,body:x}=aC(c,e);if(u.navigate===!1){let T=u.fetcherKey||AC();await s(T,t,u.action||d,{unstable_defaultShouldRevalidate:u.unstable_defaultShouldRevalidate,preventScrollReset:u.preventScrollReset,formData:b,body:x,formMethod:u.method||p,formEncType:u.encType||g,flushSync:u.flushSync})}else await o(u.action||d,{unstable_defaultShouldRevalidate:u.unstable_defaultShouldRevalidate,preventScrollReset:u.preventScrollReset,formData:b,body:x,formMethod:u.method||p,formEncType:u.encType||g,replace:u.replace,state:u.state,fromRouteId:t,flushSync:u.flushSync,viewTransition:u.viewTransition})},[s,o,e,t])}function CC(n,{relative:e}={}){let{basename:t}=_.useContext(oi),s=_.useContext(Vi);vs(s,"useFormAction must be used inside a RouteContext");let[o]=s.matches.slice(-1),c={...fd(n||".",{relative:e})},u=Oi();if(n==null){c.search=u.search;let d=new URLSearchParams(c.search),p=d.getAll("index");if(p.some(b=>b==="")){d.delete("index"),p.filter(x=>x).forEach(x=>d.append("index",x));let b=d.toString();c.search=b?`?${b}`:""}}return(!n||n===".")&&o.route.index&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(c.pathname=c.pathname==="/"?t:Ra([t,c.pathname])),Qh(c)}function IC(n,{relative:e}={}){let t=_.useContext(XT);vs(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=lE("useViewTransitionState"),o=fd(n,{relative:e});if(!t.isTransitioning)return!1;let c=Da(t.currentLocation.pathname,s)||t.currentLocation.pathname,u=Da(t.nextLocation.pathname,s)||t.nextLocation.pathname;return Em(o.pathname,u)!=null||Em(o.pathname,c)!=null}const DC=()=>{};var jw={};const cE=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let o=n.charCodeAt(s);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},PC=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const o=n[t++];if(o<128)e[s++]=String.fromCharCode(o);else if(o>191&&o<224){const c=n[t++];e[s++]=String.fromCharCode((o&31)<<6|c&63)}else if(o>239&&o<365){const c=n[t++],u=n[t++],d=n[t++],p=((o&7)<<18|(c&63)<<12|(u&63)<<6|d&63)-65536;e[s++]=String.fromCharCode(55296+(p>>10)),e[s++]=String.fromCharCode(56320+(p&1023))}else{const c=n[t++],u=n[t++];e[s++]=String.fromCharCode((o&15)<<12|(c&63)<<6|u&63)}}return e.join("")},uE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let o=0;o<n.length;o+=3){const c=n[o],u=o+1<n.length,d=u?n[o+1]:0,p=o+2<n.length,g=p?n[o+2]:0,b=c>>2,x=(c&3)<<4|d>>4;let T=(d&15)<<2|g>>6,N=g&63;p||(N=64,u||(T=64)),s.push(t[b],t[x],t[T],t[N])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(cE(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):PC(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let o=0;o<n.length;){const c=t[n.charAt(o++)],d=o<n.length?t[n.charAt(o)]:0;++o;const g=o<n.length?t[n.charAt(o)]:64;++o;const x=o<n.length?t[n.charAt(o)]:64;if(++o,c==null||d==null||g==null||x==null)throw new MC;const T=c<<2|d>>4;if(s.push(T),g!==64){const N=d<<4&240|g>>2;if(s.push(N),x!==64){const B=g<<6&192|x;s.push(B)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class MC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const LC=function(n){const e=cE(n);return uE.encodeByteArray(e,!0)},km=function(n){return LC(n).replace(/\./g,"")},hE=function(n){try{return uE.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function dE(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const VC=()=>dE().__FIREBASE_DEFAULTS__,OC=()=>{if(typeof process>"u"||typeof jw>"u")return;const n=jw.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},BC=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&hE(n[1]);return e&&JSON.parse(e)},tp=()=>{try{return DC()||VC()||OC()||BC()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},fE=n=>tp()?.emulatorHosts?.[n],mE=n=>{const e=fE(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},pE=()=>tp()?.config,gE=n=>tp()?.[`_${n}`];class UC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}function Ba(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function np(n){return(await fetch(n,{credentials:"include"})).ok}function yE(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",o=n.iat||0,c=n.sub||n.user_id;if(!c)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u={iss:`https://securetoken.google.com/${s}`,aud:s,iat:o,exp:o+3600,auth_time:o,sub:c,user_id:c,firebase:{sign_in_provider:"custom",identities:{}},...n};return[km(JSON.stringify(t)),km(JSON.stringify(u)),""].join(".")}const Lh={};function FC(){const n={prod:[],emulator:[]};for(const e of Object.keys(Lh))Lh[e]?n.emulator.push(e):n.prod.push(e);return n}function zC(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Nw=!1;function hv(n,e){if(typeof window>"u"||typeof document>"u"||!Ba(window.location.host)||Lh[n]===e||Lh[n]||Nw)return;Lh[n]=e;function t(T){return`__firebase__banner__${T}`}const s="__firebase__banner",c=FC().prod.length>0;function u(){const T=document.getElementById(s);T&&T.remove()}function d(T){T.style.display="flex",T.style.background="#7faaf0",T.style.position="fixed",T.style.bottom="5px",T.style.left="5px",T.style.padding=".5em",T.style.borderRadius="5px",T.style.alignItems="center"}function p(T,N){T.setAttribute("width","24"),T.setAttribute("id",N),T.setAttribute("height","24"),T.setAttribute("viewBox","0 0 24 24"),T.setAttribute("fill","none"),T.style.marginLeft="-6px"}function g(){const T=document.createElement("span");return T.style.cursor="pointer",T.style.marginLeft="16px",T.style.fontSize="24px",T.innerHTML=" &times;",T.onclick=()=>{Nw=!0,u()},T}function b(T,N){T.setAttribute("id",N),T.innerText="Learn more",T.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",T.setAttribute("target","__blank"),T.style.paddingLeft="5px",T.style.textDecoration="underline"}function x(){const T=zC(s),N=t("text"),B=document.getElementById(N)||document.createElement("span"),M=t("learnmore"),P=document.getElementById(M)||document.createElement("a"),Y=t("preprendIcon"),$=document.getElementById(Y)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(T.created){const J=T.element;d(J),b(P,M);const de=g();p($,Y),J.append($,B,P,de),document.body.appendChild(J)}c?(B.innerText="Preview backend disconnected.",$.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):($.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,B.innerText="Preview backend running in this workspace."),B.setAttribute("id",N)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",x):x()}function Js(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function qC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Js())}function bE(){const n=tp()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function $C(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function HC(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function WC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function GC(){const n=Js();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function vE(){return!bE()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function xE(){return!bE()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function _E(){try{return typeof indexedDB=="object"}catch{return!1}}function KC(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(s);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{e(o.error?.message||"")}}catch(t){e(t)}})}const QC="FirebaseError";class la extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=QC,Object.setPrototypeOf(this,la.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,md.prototype.create)}}class md{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},o=`${this.service}/${e}`,c=this.errors[e],u=c?YC(c,s):"Error",d=`${this.serviceName}: ${u} (${o}).`;return new la(o,d,s)}}function YC(n,e){return n.replace(XC,(t,s)=>{const o=e[s];return o!=null?String(o):`<${s}?>`})}const XC=/\{\$([^}]+)}/g;function JC(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Mi(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const o of t){if(!s.includes(o))return!1;const c=n[o],u=e[o];if(Aw(c)&&Aw(u)){if(!Mi(c,u))return!1}else if(c!==u)return!1}for(const o of s)if(!t.includes(o))return!1;return!0}function Aw(n){return n!==null&&typeof n=="object"}function pd(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function Rh(n){const e={};return n.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[o,c]=s.split("=");e[decodeURIComponent(o)]=decodeURIComponent(c)}}),e}function Ch(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function ZC(n,e){const t=new eI(n,e);return t.subscribe.bind(t)}class eI{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let o;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");tI(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:s},o.next===void 0&&(o.next=Ly),o.error===void 0&&(o.error=Ly),o.complete===void 0&&(o.complete=Ly);const c=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),c}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function tI(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Ly(){}function jn(n){return n&&n._delegate?n._delegate:n}class Bo{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const _l="[DEFAULT]";class nI{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new UC;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&s.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),s=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(o){if(s)return null;throw o}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(rI(e))try{this.getOrInitializeService({instanceIdentifier:_l})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const c=this.getOrInitializeService({instanceIdentifier:o});s.resolve(c)}catch{}}}}clearInstance(e=_l){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=_l){return this.instances.has(e)}getOptions(e=_l){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[c,u]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(c);s===d&&u.resolve(o)}return o}onInit(e,t){const s=this.normalizeInstanceIdentifier(t),o=this.onInitCallbacks.get(s)??new Set;o.add(e),this.onInitCallbacks.set(s,o);const c=this.instances.get(s);return c&&e(c,s),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const o of s)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:sI(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=_l){return this.component?this.component.multipleInstances?e:_l:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function sI(n){return n===_l?void 0:n}function rI(n){return n.instantiationMode==="EAGER"}class iI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new nI(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var wn;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(wn||(wn={}));const aI={debug:wn.DEBUG,verbose:wn.VERBOSE,info:wn.INFO,warn:wn.WARN,error:wn.ERROR,silent:wn.SILENT},oI=wn.INFO,lI={[wn.DEBUG]:"log",[wn.VERBOSE]:"log",[wn.INFO]:"info",[wn.WARN]:"warn",[wn.ERROR]:"error"},cI=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),o=lI[e];if(o)console[o](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class dv{constructor(e){this.name=e,this._logLevel=oI,this._logHandler=cI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in wn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?aI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,wn.DEBUG,...e),this._logHandler(this,wn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,wn.VERBOSE,...e),this._logHandler(this,wn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,wn.INFO,...e),this._logHandler(this,wn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,wn.WARN,...e),this._logHandler(this,wn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,wn.ERROR,...e),this._logHandler(this,wn.ERROR,...e)}}const uI=(n,e)=>e.some(t=>n instanceof t);let Rw,Cw;function hI(){return Rw||(Rw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function dI(){return Cw||(Cw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const wE=new WeakMap,vb=new WeakMap,TE=new WeakMap,Vy=new WeakMap,fv=new WeakMap;function fI(n){const e=new Promise((t,s)=>{const o=()=>{n.removeEventListener("success",c),n.removeEventListener("error",u)},c=()=>{t(Mo(n.result)),o()},u=()=>{s(n.error),o()};n.addEventListener("success",c),n.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&wE.set(t,n)}).catch(()=>{}),fv.set(e,n),e}function mI(n){if(vb.has(n))return;const e=new Promise((t,s)=>{const o=()=>{n.removeEventListener("complete",c),n.removeEventListener("error",u),n.removeEventListener("abort",u)},c=()=>{t(),o()},u=()=>{s(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",c),n.addEventListener("error",u),n.addEventListener("abort",u)});vb.set(n,e)}let xb={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return vb.get(n);if(e==="objectStoreNames")return n.objectStoreNames||TE.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Mo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function pI(n){xb=n(xb)}function gI(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(Oy(this),e,...t);return TE.set(s,e.sort?e.sort():[e]),Mo(s)}:dI().includes(n)?function(...e){return n.apply(Oy(this),e),Mo(wE.get(this))}:function(...e){return Mo(n.apply(Oy(this),e))}}function yI(n){return typeof n=="function"?gI(n):(n instanceof IDBTransaction&&mI(n),uI(n,hI())?new Proxy(n,xb):n)}function Mo(n){if(n instanceof IDBRequest)return fI(n);if(Vy.has(n))return Vy.get(n);const e=yI(n);return e!==n&&(Vy.set(n,e),fv.set(e,n)),e}const Oy=n=>fv.get(n);function bI(n,e,{blocked:t,upgrade:s,blocking:o,terminated:c}={}){const u=indexedDB.open(n,e),d=Mo(u);return s&&u.addEventListener("upgradeneeded",p=>{s(Mo(u.result),p.oldVersion,p.newVersion,Mo(u.transaction),p)}),t&&u.addEventListener("blocked",p=>t(p.oldVersion,p.newVersion,p)),d.then(p=>{c&&p.addEventListener("close",()=>c()),o&&p.addEventListener("versionchange",g=>o(g.oldVersion,g.newVersion,g))}).catch(()=>{}),d}const vI=["get","getKey","getAll","getAllKeys","count"],xI=["put","add","delete","clear"],By=new Map;function Iw(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(By.get(e))return By.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,o=xI.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(o||vI.includes(t)))return;const c=async function(u,...d){const p=this.transaction(u,o?"readwrite":"readonly");let g=p.store;return s&&(g=g.index(d.shift())),(await Promise.all([g[t](...d),o&&p.done]))[0]};return By.set(e,c),c}pI(n=>({...n,get:(e,t,s)=>Iw(e,t)||n.get(e,t,s),has:(e,t)=>!!Iw(e,t)||n.has(e,t)}));class _I{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(wI(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function wI(n){return n.getComponent()?.type==="VERSION"}const _b="@firebase/app",Dw="0.14.7";const Pa=new dv("@firebase/app"),TI="@firebase/app-compat",EI="@firebase/analytics-compat",kI="@firebase/analytics",SI="@firebase/app-check-compat",jI="@firebase/app-check",NI="@firebase/auth",AI="@firebase/auth-compat",RI="@firebase/database",CI="@firebase/data-connect",II="@firebase/database-compat",DI="@firebase/functions",PI="@firebase/functions-compat",MI="@firebase/installations",LI="@firebase/installations-compat",VI="@firebase/messaging",OI="@firebase/messaging-compat",BI="@firebase/performance",UI="@firebase/performance-compat",FI="@firebase/remote-config",zI="@firebase/remote-config-compat",qI="@firebase/storage",$I="@firebase/storage-compat",HI="@firebase/firestore",WI="@firebase/ai",GI="@firebase/firestore-compat",KI="firebase",QI="12.8.0";const Sm="[DEFAULT]",YI={[_b]:"fire-core",[TI]:"fire-core-compat",[kI]:"fire-analytics",[EI]:"fire-analytics-compat",[jI]:"fire-app-check",[SI]:"fire-app-check-compat",[NI]:"fire-auth",[AI]:"fire-auth-compat",[RI]:"fire-rtdb",[CI]:"fire-data-connect",[II]:"fire-rtdb-compat",[DI]:"fire-fn",[PI]:"fire-fn-compat",[MI]:"fire-iid",[LI]:"fire-iid-compat",[VI]:"fire-fcm",[OI]:"fire-fcm-compat",[BI]:"fire-perf",[UI]:"fire-perf-compat",[FI]:"fire-rc",[zI]:"fire-rc-compat",[qI]:"fire-gcs",[$I]:"fire-gcs-compat",[HI]:"fire-fst",[GI]:"fire-fst-compat",[WI]:"fire-vertex","fire-js":"fire-js",[KI]:"fire-js-all"};const jm=new Map,XI=new Map,wb=new Map;function Pw(n,e){try{n.container.addComponent(e)}catch(t){Pa.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Ml(n){const e=n.name;if(wb.has(e))return Pa.debug(`There were multiple attempts to register component ${e}.`),!1;wb.set(e,n);for(const t of jm.values())Pw(t,n);for(const t of XI.values())Pw(t,n);return!0}function wu(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function JI(n,e,t=Sm){wu(n,e).clearInstance(t)}function ni(n){return n==null?!1:n.settings!==void 0}const ZI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Lo=new md("app","Firebase",ZI);class e4{constructor(e,t,s){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Bo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Lo.create("app-deleted",{appName:this._name})}}const Ql=QI;function mv(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s={name:Sm,automaticDataCollectionEnabled:!0,...e},o=s.name;if(typeof o!="string"||!o)throw Lo.create("bad-app-name",{appName:String(o)});if(t||(t=pE()),!t)throw Lo.create("no-options");const c=jm.get(o);if(c){if(Mi(t,c.options)&&Mi(s,c.config))return c;throw Lo.create("duplicate-app",{appName:o})}const u=new iI(o);for(const p of wb.values())u.addComponent(p);const d=new e4(t,s,u);return jm.set(o,d),d}function pv(n=Sm){const e=jm.get(n);if(!e&&n===Sm&&pE())return mv();if(!e)throw Lo.create("no-app",{appName:n});return e}function Zi(n,e,t){let s=YI[n]??n;t&&(s+=`-${t}`);const o=s.match(/\s|\//),c=e.match(/\s|\//);if(o||c){const u=[`Unable to register library "${s}" with version "${e}":`];o&&u.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&c&&u.push("and"),c&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Pa.warn(u.join(" "));return}Ml(new Bo(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}const t4="firebase-heartbeat-database",n4=1,Yh="firebase-heartbeat-store";let Uy=null;function EE(){return Uy||(Uy=bI(t4,n4,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Yh)}catch(t){console.warn(t)}}}}).catch(n=>{throw Lo.create("idb-open",{originalErrorMessage:n.message})})),Uy}async function s4(n){try{const t=(await EE()).transaction(Yh),s=await t.objectStore(Yh).get(kE(n));return await t.done,s}catch(e){if(e instanceof la)Pa.warn(e.message);else{const t=Lo.create("idb-get",{originalErrorMessage:e?.message});Pa.warn(t.message)}}}async function Mw(n,e){try{const s=(await EE()).transaction(Yh,"readwrite");await s.objectStore(Yh).put(e,kE(n)),await s.done}catch(t){if(t instanceof la)Pa.warn(t.message);else{const s=Lo.create("idb-set",{originalErrorMessage:t?.message});Pa.warn(s.message)}}}function kE(n){return`${n.name}!${n.options.appId}`}const r4=1024,i4=30;class a4{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new l4(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Lw();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:t}),this._heartbeatsCache.heartbeats.length>i4){const o=c4(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Pa.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Lw(),{heartbeatsToSend:t,unsentEntries:s}=o4(this._heartbeatsCache.heartbeats),o=km(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(e){return Pa.warn(e),""}}}function Lw(){return new Date().toISOString().substring(0,10)}function o4(n,e=r4){const t=[];let s=n.slice();for(const o of n){const c=t.find(u=>u.agent===o.agent);if(c){if(c.dates.push(o.date),Vw(t)>e){c.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),Vw(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class l4{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return _E()?KC().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await s4(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Mw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Mw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Vw(n){return km(JSON.stringify({version:2,heartbeats:n})).length}function c4(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}function u4(n){Ml(new Bo("platform-logger",e=>new _I(e),"PRIVATE")),Ml(new Bo("heartbeat",e=>new a4(e),"PRIVATE")),Zi(_b,Dw,n),Zi(_b,Dw,"esm2020"),Zi("fire-js","")}u4("");function SE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const h4=SE,jE=new md("auth","Firebase",SE());const Nm=new dv("@firebase/auth");function d4(n,...e){Nm.logLevel<=wn.WARN&&Nm.warn(`Auth (${Ql}): ${n}`,...e)}function cm(n,...e){Nm.logLevel<=wn.ERROR&&Nm.error(`Auth (${Ql}): ${n}`,...e)}function Li(n,...e){throw gv(n,...e)}function ea(n,...e){return gv(n,...e)}function NE(n,e,t){const s={...h4(),[e]:t};return new md("auth","Firebase",s).create(e,{appName:n.name})}function Ca(n){return NE(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function gv(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return jE.create(n,...e)}function Ut(n,e,...t){if(!n)throw gv(e,...t)}function ja(n){const e="INTERNAL ASSERTION FAILED: "+n;throw cm(e),new Error(e)}function Ma(n,e){n||ja(e)}function Tb(){return typeof self<"u"&&self.location?.href||""}function f4(){return Ow()==="http:"||Ow()==="https:"}function Ow(){return typeof self<"u"&&self.location?.protocol||null}function m4(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(f4()||HC()||"connection"in navigator)?navigator.onLine:!0}function p4(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class gd{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ma(t>e,"Short delay should be less than long delay!"),this.isMobile=qC()||WC()}get(){return m4()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function yv(n,e){Ma(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class AE{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ja("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ja("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ja("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const g4={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const y4=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],b4=new gd(3e4,6e4);function Ua(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Fa(n,e,t,s,o={}){return RE(n,o,async()=>{let c={},u={};s&&(e==="GET"?u=s:c={body:JSON.stringify(s)});const d=pd({key:n.config.apiKey,...u}).slice(1),p=await n._getAdditionalHeaders();p["Content-Type"]="application/json",n.languageCode&&(p["X-Firebase-Locale"]=n.languageCode);const g={method:e,headers:p,...c};return $C()||(g.referrerPolicy="no-referrer"),n.emulatorConfig&&Ba(n.emulatorConfig.host)&&(g.credentials="include"),AE.fetch()(await CE(n,n.config.apiHost,t,d),g)})}async function RE(n,e,t){n._canInitEmulator=!1;const s={...g4,...e};try{const o=new x4(n),c=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const u=await c.json();if("needConfirmation"in u)throw $f(n,"account-exists-with-different-credential",u);if(c.ok&&!("errorMessage"in u))return u;{const d=c.ok?u.errorMessage:u.error.message,[p,g]=d.split(" : ");if(p==="FEDERATED_USER_ID_ALREADY_LINKED")throw $f(n,"credential-already-in-use",u);if(p==="EMAIL_EXISTS")throw $f(n,"email-already-in-use",u);if(p==="USER_DISABLED")throw $f(n,"user-disabled",u);const b=s[p]||p.toLowerCase().replace(/[_\s]+/g,"-");if(g)throw NE(n,b,g);Li(n,b)}}catch(o){if(o instanceof la)throw o;Li(n,"network-request-failed",{message:String(o)})}}async function yd(n,e,t,s,o={}){const c=await Fa(n,e,t,s,o);return"mfaPendingCredential"in c&&Li(n,"multi-factor-auth-required",{_serverResponse:c}),c}async function CE(n,e,t,s){const o=`${e}${t}?${s}`,c=n,u=c.config.emulator?yv(n.config,o):`${n.config.apiScheme}://${o}`;return y4.includes(t)&&(await c._persistenceManagerAvailable,c._getPersistenceType()==="COOKIE")?c._getPersistence()._getFinalTarget(u).toString():u}function v4(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class x4{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(ea(this.auth,"network-request-failed")),b4.get())})}}function $f(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const o=ea(n,e,s);return o.customData._tokenResponse=t,o}function Bw(n){return n!==void 0&&n.enterprise!==void 0}class _4{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return v4(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function w4(n,e){return Fa(n,"GET","/v2/recaptchaConfig",Ua(n,e))}async function T4(n,e){return Fa(n,"POST","/v1/accounts:delete",e)}async function Am(n,e){return Fa(n,"POST","/v1/accounts:lookup",e)}function Vh(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function E4(n,e=!1){const t=jn(n),s=await t.getIdToken(e),o=bv(s);Ut(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const c=typeof o.firebase=="object"?o.firebase:void 0,u=c?.sign_in_provider;return{claims:o,token:s,authTime:Vh(Fy(o.auth_time)),issuedAtTime:Vh(Fy(o.iat)),expirationTime:Vh(Fy(o.exp)),signInProvider:u||null,signInSecondFactor:c?.sign_in_second_factor||null}}function Fy(n){return Number(n)*1e3}function bv(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return cm("JWT malformed, contained fewer than 3 sections"),null;try{const o=hE(t);return o?JSON.parse(o):(cm("Failed to decode base64 JWT payload"),null)}catch(o){return cm("Caught error parsing JWT payload as JSON",o?.toString()),null}}function Uw(n){const e=bv(n);return Ut(e,"internal-error"),Ut(typeof e.exp<"u","internal-error"),Ut(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Xh(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof la&&k4(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function k4({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class S4{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const s=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Eb{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Vh(this.lastLoginAt),this.creationTime=Vh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Rm(n){const e=n.auth,t=await n.getIdToken(),s=await Xh(n,Am(e,{idToken:t}));Ut(s?.users.length,e,"internal-error");const o=s.users[0];n._notifyReloadListener(o);const c=o.providerUserInfo?.length?IE(o.providerUserInfo):[],u=N4(n.providerData,c),d=n.isAnonymous,p=!(n.email&&o.passwordHash)&&!u?.length,g=d?p:!1,b={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new Eb(o.createdAt,o.lastLoginAt),isAnonymous:g};Object.assign(n,b)}async function j4(n){const e=jn(n);await Rm(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function N4(n,e){return[...n.filter(s=>!e.some(o=>o.providerId===s.providerId)),...e]}function IE(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function A4(n,e){const t=await RE(n,{},async()=>{const s=pd({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:c}=n.config,u=await CE(n,o,"/v1/token",`key=${c}`),d=await n._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const p={method:"POST",headers:d,body:s};return n.emulatorConfig&&Ba(n.emulatorConfig.host)&&(p.credentials="include"),AE.fetch()(u,p)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function R4(n,e){return Fa(n,"POST","/v2/accounts:revokeToken",Ua(n,e))}class Gc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ut(e.idToken,"internal-error"),Ut(typeof e.idToken<"u","internal-error"),Ut(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Uw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ut(e.length!==0,"internal-error");const t=Uw(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ut(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:o,expiresIn:c}=await A4(e,t);this.updateTokensAndExpiration(s,o,Number(c))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:o,expirationTime:c}=t,u=new Gc;return s&&(Ut(typeof s=="string","internal-error",{appName:e}),u.refreshToken=s),o&&(Ut(typeof o=="string","internal-error",{appName:e}),u.accessToken=o),c&&(Ut(typeof c=="number","internal-error",{appName:e}),u.expirationTime=c),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Gc,this.toJSON())}_performRefresh(){return ja("not implemented")}}function yo(n,e){Ut(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Pi{constructor({uid:e,auth:t,stsTokenManager:s,...o}){this.providerId="firebase",this.proactiveRefresh=new S4(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Eb(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await Xh(this,this.stsTokenManager.getToken(this.auth,e));return Ut(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return E4(this,e)}reload(){return j4(this)}_assign(e){this!==e&&(Ut(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Pi({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Ut(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await Rm(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ni(this.auth.app))return Promise.reject(Ca(this.auth));const e=await this.getIdToken();return await Xh(this,T4(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const s=t.displayName??void 0,o=t.email??void 0,c=t.phoneNumber??void 0,u=t.photoURL??void 0,d=t.tenantId??void 0,p=t._redirectEventId??void 0,g=t.createdAt??void 0,b=t.lastLoginAt??void 0,{uid:x,emailVerified:T,isAnonymous:N,providerData:B,stsTokenManager:M}=t;Ut(x&&M,e,"internal-error");const P=Gc.fromJSON(this.name,M);Ut(typeof x=="string",e,"internal-error"),yo(s,e.name),yo(o,e.name),Ut(typeof T=="boolean",e,"internal-error"),Ut(typeof N=="boolean",e,"internal-error"),yo(c,e.name),yo(u,e.name),yo(d,e.name),yo(p,e.name),yo(g,e.name),yo(b,e.name);const Y=new Pi({uid:x,auth:e,email:o,emailVerified:T,displayName:s,isAnonymous:N,photoURL:u,phoneNumber:c,tenantId:d,stsTokenManager:P,createdAt:g,lastLoginAt:b});return B&&Array.isArray(B)&&(Y.providerData=B.map($=>({...$}))),p&&(Y._redirectEventId=p),Y}static async _fromIdTokenResponse(e,t,s=!1){const o=new Gc;o.updateFromServerResponse(t);const c=new Pi({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:s});return await Rm(c),c}static async _fromGetAccountInfoResponse(e,t,s){const o=t.users[0];Ut(o.localId!==void 0,"internal-error");const c=o.providerUserInfo!==void 0?IE(o.providerUserInfo):[],u=!(o.email&&o.passwordHash)&&!c?.length,d=new Gc;d.updateFromIdToken(s);const p=new Pi({uid:o.localId,auth:e,stsTokenManager:d,isAnonymous:u}),g={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new Eb(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!c?.length};return Object.assign(p,g),p}}const Fw=new Map;function Na(n){Ma(n instanceof Function,"Expected a class definition");let e=Fw.get(n);return e?(Ma(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Fw.set(n,e),e)}class DE{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}DE.type="NONE";const zw=DE;function um(n,e,t){return`firebase:${n}:${e}:${t}`}class Kc{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:o,name:c}=this.auth;this.fullUserKey=um(this.userKey,o.apiKey,c),this.fullPersistenceKey=um("persistence",o.apiKey,c),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Am(this.auth,{idToken:e}).catch(()=>{});return t?Pi._fromGetAccountInfoResponse(this.auth,t,e):null}return Pi._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new Kc(Na(zw),e,s);const o=(await Promise.all(t.map(async g=>{if(await g._isAvailable())return g}))).filter(g=>g);let c=o[0]||Na(zw);const u=um(s,e.config.apiKey,e.name);let d=null;for(const g of t)try{const b=await g._get(u);if(b){let x;if(typeof b=="string"){const T=await Am(e,{idToken:b}).catch(()=>{});if(!T)break;x=await Pi._fromGetAccountInfoResponse(e,T,b)}else x=Pi._fromJSON(e,b);g!==c&&(d=x),c=g;break}}catch{}const p=o.filter(g=>g._shouldAllowMigration);return!c._shouldAllowMigration||!p.length?new Kc(c,e,s):(c=p[0],d&&await c._set(u,d.toJSON()),await Promise.all(t.map(async g=>{if(g!==c)try{await g._remove(u)}catch{}})),new Kc(c,e,s))}}function qw(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(VE(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(PE(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(BE(e))return"Blackberry";if(UE(e))return"Webos";if(ME(e))return"Safari";if((e.includes("chrome/")||LE(e))&&!e.includes("edge/"))return"Chrome";if(OE(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if(s?.length===2)return s[1]}return"Other"}function PE(n=Js()){return/firefox\//i.test(n)}function ME(n=Js()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function LE(n=Js()){return/crios\//i.test(n)}function VE(n=Js()){return/iemobile/i.test(n)}function OE(n=Js()){return/android/i.test(n)}function BE(n=Js()){return/blackberry/i.test(n)}function UE(n=Js()){return/webos/i.test(n)}function vv(n=Js()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function C4(n=Js()){return vv(n)&&!!window.navigator?.standalone}function I4(){return GC()&&document.documentMode===10}function FE(n=Js()){return vv(n)||OE(n)||UE(n)||BE(n)||/windows phone/i.test(n)||VE(n)}function zE(n,e=[]){let t;switch(n){case"Browser":t=qw(Js());break;case"Worker":t=`${qw(Js())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ql}/${s}`}class D4{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=c=>new Promise((u,d)=>{try{const p=e(c);u(p)}catch(p){d(p)}});s.onAbort=t,this.queue.push(s);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s?.message})}}}async function P4(n,e={}){return Fa(n,"GET","/v2/passwordPolicy",Ua(n,e))}const M4=6;class L4{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??M4,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let o=0;o<e.length;o++)s=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,o,c){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=c))}}class V4{constructor(e,t,s,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new $w(this),this.idTokenSubscription=new $w(this),this.beforeStateQueue=new D4(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=jE,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(c=>this._resolvePersistenceManagerAvailable=c)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Na(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Kc.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Am(this,{idToken:e}),s=await Pi._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(ni(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(u,u))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let s=t,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=this.redirectUser?._redirectEventId,u=s?._redirectEventId,d=await this.tryRedirectSignIn(e);(!c||c===u)&&d?.user&&(s=d.user,o=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(s)}catch(c){s=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Ut(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Rm(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=p4()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ni(this.app))return Promise.reject(Ca(this));const t=e?jn(e):null;return t&&Ut(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ut(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ni(this.app)?Promise.reject(Ca(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ni(this.app)?Promise.reject(Ca(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Na(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await P4(this),t=new L4(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new md("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await R4(this,s)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Na(e)||this._popupRedirectResolver;Ut(t,this,"argument-error"),this.redirectPersistenceManager=await Kc.create(this,[Na(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,o){if(this._deleted)return()=>{};const c=typeof t=="function"?t:t.next.bind(t);let u=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ut(d,this,"internal-error"),d.then(()=>{u||c(this.currentUser)}),typeof t=="function"){const p=e.addObserver(t,s,o);return()=>{u=!0,p()}}else{const p=e.addObserver(t);return()=>{u=!0,p()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ut(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=zE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const s=await this._getAppCheckToken();return s&&(e["X-Firebase-AppCheck"]=s),e}async _getAppCheckToken(){if(ni(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&d4(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Go(n){return jn(n)}class $w{constructor(e){this.auth=e,this.observer=null,this.addObserver=ZC(t=>this.observer=t)}get next(){return Ut(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let sp={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function O4(n){sp=n}function qE(n){return sp.loadJS(n)}function B4(){return sp.recaptchaEnterpriseScript}function U4(){return sp.gapiScript}function F4(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class z4{constructor(){this.enterprise=new q4}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class q4{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const $4="recaptcha-enterprise",$E="NO_RECAPTCHA";class H4{constructor(e){this.type=$4,this.auth=Go(e)}async verify(e="verify",t=!1){async function s(c){if(!t){if(c.tenantId==null&&c._agentRecaptchaConfig!=null)return c._agentRecaptchaConfig.siteKey;if(c.tenantId!=null&&c._tenantRecaptchaConfigs[c.tenantId]!==void 0)return c._tenantRecaptchaConfigs[c.tenantId].siteKey}return new Promise(async(u,d)=>{w4(c,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(p=>{if(p.recaptchaKey===void 0)d(new Error("recaptcha Enterprise site key undefined"));else{const g=new _4(p);return c.tenantId==null?c._agentRecaptchaConfig=g:c._tenantRecaptchaConfigs[c.tenantId]=g,u(g.siteKey)}}).catch(p=>{d(p)})})}function o(c,u,d){const p=window.grecaptcha;Bw(p)?p.enterprise.ready(()=>{p.enterprise.execute(c,{action:e}).then(g=>{u(g)}).catch(()=>{u($E)})}):d(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new z4().execute("siteKey",{action:"verify"}):new Promise((c,u)=>{s(this.auth).then(d=>{if(!t&&Bw(window.grecaptcha))o(d,c,u);else{if(typeof window>"u"){u(new Error("RecaptchaVerifier is only supported in browser"));return}let p=B4();p.length!==0&&(p+=d),qE(p).then(()=>{o(d,c,u)}).catch(g=>{u(g)})}}).catch(d=>{u(d)})})}}async function Hw(n,e,t,s=!1,o=!1){const c=new H4(n);let u;if(o)u=$E;else try{u=await c.verify(t)}catch{u=await c.verify(t,!0)}const d={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in d){const p=d.phoneEnrollmentInfo.phoneNumber,g=d.phoneEnrollmentInfo.recaptchaToken;Object.assign(d,{phoneEnrollmentInfo:{phoneNumber:p,recaptchaToken:g,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in d){const p=d.phoneSignInInfo.recaptchaToken;Object.assign(d,{phoneSignInInfo:{recaptchaToken:p,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return d}return s?Object.assign(d,{captchaResp:u}):Object.assign(d,{captchaResponse:u}),Object.assign(d,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(d,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),d}async function Cm(n,e,t,s,o){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const c=await Hw(n,e,t,t==="getOobCode");return s(n,c)}else return s(n,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const u=await Hw(n,e,t,t==="getOobCode");return s(n,u)}else return Promise.reject(c)})}function W4(n,e){const t=wu(n,"auth");if(t.isInitialized()){const o=t.getImmediate(),c=t.getOptions();if(Mi(c,e??{}))return o;Li(o,"already-initialized")}return t.initialize({options:e})}function G4(n,e){const t=e?.persistence||[],s=(Array.isArray(t)?t:[t]).map(Na);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e?.popupRedirectResolver)}function K4(n,e,t){const s=Go(n);Ut(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const o=!1,c=HE(e),{host:u,port:d}=Q4(e),p=d===null?"":`:${d}`,g={url:`${c}//${u}${p}/`},b=Object.freeze({host:u,port:d,protocol:c.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!s._canInitEmulator){Ut(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),Ut(Mi(g,s.config.emulator)&&Mi(b,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=g,s.emulatorConfig=b,s.settings.appVerificationDisabledForTesting=!0,Ba(u)?(np(`${c}//${u}${p}`),hv("Auth",!0)):Y4()}function HE(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function Q4(n){const e=HE(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(s);if(o){const c=o[1];return{host:c,port:Ww(s.substr(c.length+1))}}else{const[c,u]=s.split(":");return{host:c,port:Ww(u)}}}function Ww(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function Y4(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class xv{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ja("not implemented")}_getIdTokenResponse(e){return ja("not implemented")}_linkToIdToken(e,t){return ja("not implemented")}_getReauthenticationResolver(e){return ja("not implemented")}}async function X4(n,e){return Fa(n,"POST","/v1/accounts:signUp",e)}async function J4(n,e){return yd(n,"POST","/v1/accounts:signInWithPassword",Ua(n,e))}async function WE(n,e){return Fa(n,"POST","/v1/accounts:sendOobCode",Ua(n,e))}async function Z4(n,e){return WE(n,e)}async function eD(n,e){return WE(n,e)}async function tD(n,e){return yd(n,"POST","/v1/accounts:signInWithEmailLink",Ua(n,e))}async function nD(n,e){return yd(n,"POST","/v1/accounts:signInWithEmailLink",Ua(n,e))}class Jh extends xv{constructor(e,t,s,o=null){super("password",s),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new Jh(e,t,"password")}static _fromEmailAndCode(e,t,s=null){return new Jh(e,t,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Cm(e,t,"signInWithPassword",J4);case"emailLink":return tD(e,{email:this._email,oobCode:this._password});default:Li(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const s={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Cm(e,s,"signUpPassword",X4);case"emailLink":return nD(e,{idToken:t,email:this._email,oobCode:this._password});default:Li(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Qc(n,e){return yd(n,"POST","/v1/accounts:signInWithIdp",Ua(n,e))}const sD="http://localhost";class Ll extends xv{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ll(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Li("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:o,...c}=t;if(!s||!o)return null;const u=new Ll(s,o);return u.idToken=c.idToken||void 0,u.accessToken=c.accessToken||void 0,u.secret=c.secret,u.nonce=c.nonce,u.pendingToken=c.pendingToken||null,u}_getIdTokenResponse(e){const t=this.buildRequest();return Qc(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,Qc(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Qc(e,t)}buildRequest(){const e={requestUri:sD,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=pd(t)}return e}}function rD(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function iD(n){const e=Rh(Ch(n)).link,t=e?Rh(Ch(e)).deep_link_id:null,s=Rh(Ch(n)).deep_link_id;return(s?Rh(Ch(s)).link:null)||s||t||e||n}class _v{constructor(e){const t=Rh(Ch(e)),s=t.apiKey??null,o=t.oobCode??null,c=rD(t.mode??null);Ut(s&&o&&c,"argument-error"),this.apiKey=s,this.operation=c,this.code=o,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=iD(e);try{return new _v(t)}catch{return null}}}class Tu{constructor(){this.providerId=Tu.PROVIDER_ID}static credential(e,t){return Jh._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const s=_v.parseLink(t);return Ut(s,"argument-error"),Jh._fromEmailAndCode(e,s.code,s.tenantId)}}Tu.PROVIDER_ID="password";Tu.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Tu.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class GE{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class bd extends GE{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class To extends bd{constructor(){super("facebook.com")}static credential(e){return Ll._fromParams({providerId:To.PROVIDER_ID,signInMethod:To.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return To.credentialFromTaggedObject(e)}static credentialFromError(e){return To.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return To.credential(e.oauthAccessToken)}catch{return null}}}To.FACEBOOK_SIGN_IN_METHOD="facebook.com";To.PROVIDER_ID="facebook.com";class Eo extends bd{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ll._fromParams({providerId:Eo.PROVIDER_ID,signInMethod:Eo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Eo.credentialFromTaggedObject(e)}static credentialFromError(e){return Eo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return Eo.credential(t,s)}catch{return null}}}Eo.GOOGLE_SIGN_IN_METHOD="google.com";Eo.PROVIDER_ID="google.com";class ko extends bd{constructor(){super("github.com")}static credential(e){return Ll._fromParams({providerId:ko.PROVIDER_ID,signInMethod:ko.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ko.credentialFromTaggedObject(e)}static credentialFromError(e){return ko.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ko.credential(e.oauthAccessToken)}catch{return null}}}ko.GITHUB_SIGN_IN_METHOD="github.com";ko.PROVIDER_ID="github.com";class So extends bd{constructor(){super("twitter.com")}static credential(e,t){return Ll._fromParams({providerId:So.PROVIDER_ID,signInMethod:So.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return So.credentialFromTaggedObject(e)}static credentialFromError(e){return So.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return So.credential(t,s)}catch{return null}}}So.TWITTER_SIGN_IN_METHOD="twitter.com";So.PROVIDER_ID="twitter.com";async function aD(n,e){return yd(n,"POST","/v1/accounts:signUp",Ua(n,e))}class Vl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,o=!1){const c=await Pi._fromIdTokenResponse(e,s,o),u=Gw(s);return new Vl({user:c,providerId:u,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const o=Gw(s);return new Vl({user:e,providerId:o,_tokenResponse:s,operationType:t})}}function Gw(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Im extends la{constructor(e,t,s,o){super(t.code,t.message),this.operationType=s,this.user=o,Object.setPrototypeOf(this,Im.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,o){return new Im(e,t,s,o)}}function KE(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(c=>{throw c.code==="auth/multi-factor-auth-required"?Im._fromErrorAndOperation(n,c,e,s):c})}async function oD(n,e,t=!1){const s=await Xh(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Vl._forOperation(n,"link",s)}async function lD(n,e,t=!1){const{auth:s}=n;if(ni(s.app))return Promise.reject(Ca(s));const o="reauthenticate";try{const c=await Xh(n,KE(s,o,e,n),t);Ut(c.idToken,s,"internal-error");const u=bv(c.idToken);Ut(u,s,"internal-error");const{sub:d}=u;return Ut(n.uid===d,s,"user-mismatch"),Vl._forOperation(n,o,c)}catch(c){throw c?.code==="auth/user-not-found"&&Li(s,"user-mismatch"),c}}async function QE(n,e,t=!1){if(ni(n.app))return Promise.reject(Ca(n));const s="signIn",o=await KE(n,s,e),c=await Vl._fromIdTokenResponse(n,s,o);return t||await n._updateCurrentUser(c.user),c}async function cD(n,e){return QE(Go(n),e)}async function YE(n){const e=Go(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function uD(n,e,t){const s=Go(n);await Cm(s,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",eD)}async function hD(n,e,t){if(ni(n.app))return Promise.reject(Ca(n));const s=Go(n),u=await Cm(s,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",aD).catch(p=>{throw p.code==="auth/password-does-not-meet-requirements"&&YE(n),p}),d=await Vl._fromIdTokenResponse(s,"signIn",u);return await s._updateCurrentUser(d.user),d}function dD(n,e,t){return ni(n.app)?Promise.reject(Ca(n)):cD(jn(n),Tu.credential(e,t)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&YE(n),s})}async function IO(n,e){const t=jn(n),o={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()},{email:c}=await Z4(t.auth,o);c!==n.email&&await n.reload()}function Kw(n,e){return jn(n).setPersistence(e)}function fD(n,e,t,s){return jn(n).onIdTokenChanged(e,t,s)}function mD(n,e,t){return jn(n).beforeAuthStateChanged(e,t)}function pD(n,e,t,s){return jn(n).onAuthStateChanged(e,t,s)}function gD(n){return jn(n).signOut()}const Dm="__sak";class XE{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Dm,"1"),this.storage.removeItem(Dm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const yD=1e3,bD=10;class JE extends XE{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=FE(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),o=this.localCache[t];s!==o&&e(t,o,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((u,d,p)=>{this.notifyListeners(u,p)});return}const s=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const u=this.storage.getItem(s);!t&&this.localCache[s]===u||this.notifyListeners(s,u)},c=this.storage.getItem(s);I4()&&c!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,bD):o()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const o of Array.from(s))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},yD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}JE.type="LOCAL";const kb=JE;class ZE extends XE{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}ZE.type="SESSION";const wv=ZE;function vD(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class rp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const s=new rp(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:o,data:c}=t.data,u=this.handlersMap[o];if(!u?.size)return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:o});const d=Array.from(u).map(async g=>g(t.origin,c)),p=await vD(d);t.ports[0].postMessage({status:"done",eventId:s,eventType:o,response:p})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}rp.receivers=[];function Tv(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}class xD{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let c,u;return new Promise((d,p)=>{const g=Tv("",20);o.port1.start();const b=setTimeout(()=>{p(new Error("unsupported_event"))},s);u={messageChannel:o,onMessage(x){const T=x;if(T.data.eventId===g)switch(T.data.status){case"ack":clearTimeout(b),c=setTimeout(()=>{p(new Error("timeout"))},3e3);break;case"done":clearTimeout(c),d(T.data.response);break;default:clearTimeout(b),clearTimeout(c),p(new Error("invalid_response"));break}}},this.handlers.add(u),o.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:g,data:t},[o.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}function ta(){return window}function _D(n){ta().location.href=n}function ek(){return typeof ta().WorkerGlobalScope<"u"&&typeof ta().importScripts=="function"}async function wD(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function TD(){return navigator?.serviceWorker?.controller||null}function ED(){return ek()?self:null}const tk="firebaseLocalStorageDb",kD=1,Pm="firebaseLocalStorage",nk="fbase_key";class vd{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function ip(n,e){return n.transaction([Pm],e?"readwrite":"readonly").objectStore(Pm)}function SD(){const n=indexedDB.deleteDatabase(tk);return new vd(n).toPromise()}function Sb(){const n=indexedDB.open(tk,kD);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(Pm,{keyPath:nk})}catch(o){t(o)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(Pm)?e(s):(s.close(),await SD(),e(await Sb()))})})}async function Qw(n,e,t){const s=ip(n,!0).put({[nk]:e,value:t});return new vd(s).toPromise()}async function jD(n,e){const t=ip(n,!1).get(e),s=await new vd(t).toPromise();return s===void 0?null:s.value}function Yw(n,e){const t=ip(n,!0).delete(e);return new vd(t).toPromise()}const ND=800,AD=3;class sk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Sb(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>AD)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ek()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=rp._getInstance(ED()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await wD(),!this.activeServiceWorker)return;this.sender=new xD(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||TD()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Sb();return await Qw(e,Dm,"1"),await Yw(e,Dm),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>Qw(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>jD(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Yw(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const c=ip(o,!1).getAll();return new vd(c).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:o,value:c}of e)s.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(c)&&(this.notifyListeners(o,c),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!s.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const o of Array.from(s))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),ND)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}sk.type="LOCAL";const RD=sk;new gd(3e4,6e4);function CD(n,e){return e?Na(e):(Ut(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class Ev extends xv{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Qc(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Qc(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Qc(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function ID(n){return QE(n.auth,new Ev(n),n.bypassAuthState)}function DD(n){const{auth:e,user:t}=n;return Ut(t,e,"internal-error"),lD(t,new Ev(n),n.bypassAuthState)}async function PD(n){const{auth:e,user:t}=n;return Ut(t,e,"internal-error"),oD(t,new Ev(n),n.bypassAuthState)}class rk{constructor(e,t,s,o,c=!1){this.auth=e,this.resolver=s,this.user=o,this.bypassAuthState=c,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:o,tenantId:c,error:u,type:d}=e;if(u){this.reject(u);return}const p={auth:this.auth,requestUri:t,sessionId:s,tenantId:c||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(p))}catch(g){this.reject(g)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ID;case"linkViaPopup":case"linkViaRedirect":return PD;case"reauthViaPopup":case"reauthViaRedirect":return DD;default:Li(this.auth,"internal-error")}}resolve(e){Ma(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ma(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const MD=new gd(2e3,1e4);class Wc extends rk{constructor(e,t,s,o,c){super(e,t,o,c),this.provider=s,this.authWindow=null,this.pollId=null,Wc.currentPopupAction&&Wc.currentPopupAction.cancel(),Wc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ut(e,this.auth,"internal-error"),e}async onExecution(){Ma(this.filter.length===1,"Popup operations only handle one event");const e=Tv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ea(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(ea(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Wc.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ea(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,MD.get())};e()}}Wc.currentPopupAction=null;const LD="pendingRedirect",hm=new Map;class VD extends rk{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=hm.get(this.auth._key());if(!e){try{const s=await OD(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}hm.set(this.auth._key(),e)}return this.bypassAuthState||hm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function OD(n,e){const t=FD(e),s=UD(n);if(!await s._isAvailable())return!1;const o=await s._get(t)==="true";return await s._remove(t),o}function BD(n,e){hm.set(n._key(),e)}function UD(n){return Na(n._redirectPersistence)}function FD(n){return um(LD,n.config.apiKey,n.name)}async function zD(n,e,t=!1){if(ni(n.app))return Promise.reject(Ca(n));const s=Go(n),o=CD(s,e),u=await new VD(s,o,t).execute();return u&&!t&&(delete u.user._redirectEventId,await s._persistUserIfCurrent(u.user),await s._setRedirectUser(null,e)),u}const qD=600*1e3;class $D{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!HD(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!ik(e)){const s=e.error.code?.split("auth/")[1]||"internal-error";t.onError(ea(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=qD&&this.cachedEventUids.clear(),this.cachedEventUids.has(Xw(e))}saveEventToCache(e){this.cachedEventUids.add(Xw(e)),this.lastProcessedEventTime=Date.now()}}function Xw(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function ik({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function HD(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ik(n);default:return!1}}async function WD(n,e={}){return Fa(n,"GET","/v1/projects",e)}const GD=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,KD=/^https?/;async function QD(n){if(n.config.emulator)return;const{authorizedDomains:e}=await WD(n);for(const t of e)try{if(YD(t))return}catch{}Li(n,"unauthorized-domain")}function YD(n){const e=Tb(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const u=new URL(n);return u.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&u.hostname===s}if(!KD.test(t))return!1;if(GD.test(n))return s===n;const o=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(s)}const XD=new gd(3e4,6e4);function Jw(){const n=ta().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function JD(n){return new Promise((e,t)=>{function s(){Jw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Jw(),t(ea(n,"network-request-failed"))},timeout:XD.get()})}if(ta().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(ta().gapi?.load)s();else{const o=F4("iframefcb");return ta()[o]=()=>{gapi.load?s():t(ea(n,"network-request-failed"))},qE(`${U4()}?onload=${o}`).catch(c=>t(c))}}).catch(e=>{throw dm=null,e})}let dm=null;function ZD(n){return dm=dm||JD(n),dm}const eP=new gd(5e3,15e3),tP="__/auth/iframe",nP="emulator/auth/iframe",sP={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},rP=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function iP(n){const e=n.config;Ut(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?yv(e,nP):`https://${n.config.authDomain}/${tP}`,s={apiKey:e.apiKey,appName:n.name,v:Ql},o=rP.get(n.config.apiHost);o&&(s.eid=o);const c=n._getFrameworks();return c.length&&(s.fw=c.join(",")),`${t}?${pd(s).slice(1)}`}async function aP(n){const e=await ZD(n),t=ta().gapi;return Ut(t,n,"internal-error"),e.open({where:document.body,url:iP(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:sP,dontclear:!0},s=>new Promise(async(o,c)=>{await s.restyle({setHideOnLeave:!1});const u=ea(n,"network-request-failed"),d=ta().setTimeout(()=>{c(u)},eP.get());function p(){ta().clearTimeout(d),o(s)}s.ping(p).then(p,()=>{c(u)})}))}const oP={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},lP=500,cP=600,uP="_blank",hP="http://localhost";class Zw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function dP(n,e,t,s=lP,o=cP){const c=Math.max((window.screen.availHeight-o)/2,0).toString(),u=Math.max((window.screen.availWidth-s)/2,0).toString();let d="";const p={...oP,width:s.toString(),height:o.toString(),top:c,left:u},g=Js().toLowerCase();t&&(d=LE(g)?uP:t),PE(g)&&(e=e||hP,p.scrollbars="yes");const b=Object.entries(p).reduce((T,[N,B])=>`${T}${N}=${B},`,"");if(C4(g)&&d!=="_self")return fP(e||"",d),new Zw(null);const x=window.open(e||"",d,b);Ut(x,n,"popup-blocked");try{x.focus()}catch{}return new Zw(x)}function fP(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}const mP="__/auth/handler",pP="emulator/auth/handler",gP=encodeURIComponent("fac");async function e2(n,e,t,s,o,c){Ut(n.config.authDomain,n,"auth-domain-config-required"),Ut(n.config.apiKey,n,"invalid-api-key");const u={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:Ql,eventId:o};if(e instanceof GE){e.setDefaultLanguage(n.languageCode),u.providerId=e.providerId||"",JC(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[b,x]of Object.entries({}))u[b]=x}if(e instanceof bd){const b=e.getScopes().filter(x=>x!=="");b.length>0&&(u.scopes=b.join(","))}n.tenantId&&(u.tid=n.tenantId);const d=u;for(const b of Object.keys(d))d[b]===void 0&&delete d[b];const p=await n._getAppCheckToken(),g=p?`#${gP}=${encodeURIComponent(p)}`:"";return`${yP(n)}?${pd(d).slice(1)}${g}`}function yP({config:n}){return n.emulator?yv(n,pP):`https://${n.authDomain}/${mP}`}const zy="webStorageSupport";class bP{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=wv,this._completeRedirectFn=zD,this._overrideRedirectResult=BD}async _openPopup(e,t,s,o){Ma(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const c=await e2(e,t,s,Tb(),o);return dP(e,c,Tv())}async _openRedirect(e,t,s,o){await this._originValidation(e);const c=await e2(e,t,s,Tb(),o);return _D(c),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:c}=this.eventManagers[t];return o?Promise.resolve(o):(Ma(c,"If manager is not set, promise should be"),c)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await aP(e),s=new $D(e);return t.register("authEvent",o=>(Ut(o?.authEvent,e,"invalid-auth-event"),{status:s.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(zy,{type:zy},o=>{const c=o?.[0]?.[zy];c!==void 0&&t(!!c),Li(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=QD(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return FE()||ME()||vv()}}const vP=bP;var t2="@firebase/auth",n2="1.12.0";class xP{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e(s?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ut(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function _P(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function wP(n){Ml(new Bo("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),c=e.getProvider("app-check-internal"),{apiKey:u,authDomain:d}=s.options;Ut(u&&!u.includes(":"),"invalid-api-key",{appName:s.name});const p={apiKey:u,authDomain:d,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:zE(n)},g=new V4(s,o,c,p);return G4(g,t),g},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),Ml(new Bo("auth-internal",e=>{const t=Go(e.getProvider("auth").getImmediate());return(s=>new xP(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Zi(t2,n2,_P(n)),Zi(t2,n2,"esm2020")}const TP=300,EP=gE("authIdTokenMaxAge")||TP;let s2=null;const kP=n=>async e=>{const t=e&&await e.getIdTokenResult(),s=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(s&&s>EP)return;const o=t?.token;s2!==o&&(s2=o,await fetch(n,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function ak(n=pv()){const e=wu(n,"auth");if(e.isInitialized())return e.getImmediate();const t=W4(n,{popupRedirectResolver:vP,persistence:[RD,kb,wv]}),s=gE("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const c=new URL(s,location.origin);if(location.origin===c.origin){const u=kP(c.toString());mD(t,u,()=>u(t.currentUser)),fD(t,d=>u(d))}}const o=fE("auth");return o&&K4(t,`http://${o}`),t}function SP(){return document.getElementsByTagName("head")?.[0]??document}O4({loadJS(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=o=>{const c=ea("internal-error");c.customData=o,t(c)},s.type="text/javascript",s.charset="UTF-8",SP().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});wP("Browser");var r2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Vo,ok;(function(){var n;function e(A,S){function D(){}D.prototype=S.prototype,A.F=S.prototype,A.prototype=new D,A.prototype.constructor=A,A.D=function(U,V,q){for(var L=Array(arguments.length-2),He=2;He<arguments.length;He++)L[He-2]=arguments[He];return S.prototype[V].apply(U,L)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(s,t),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(A,S,D){D||(D=0);const U=Array(16);if(typeof S=="string")for(var V=0;V<16;++V)U[V]=S.charCodeAt(D++)|S.charCodeAt(D++)<<8|S.charCodeAt(D++)<<16|S.charCodeAt(D++)<<24;else for(V=0;V<16;++V)U[V]=S[D++]|S[D++]<<8|S[D++]<<16|S[D++]<<24;S=A.g[0],D=A.g[1],V=A.g[2];let q=A.g[3],L;L=S+(q^D&(V^q))+U[0]+3614090360&4294967295,S=D+(L<<7&4294967295|L>>>25),L=q+(V^S&(D^V))+U[1]+3905402710&4294967295,q=S+(L<<12&4294967295|L>>>20),L=V+(D^q&(S^D))+U[2]+606105819&4294967295,V=q+(L<<17&4294967295|L>>>15),L=D+(S^V&(q^S))+U[3]+3250441966&4294967295,D=V+(L<<22&4294967295|L>>>10),L=S+(q^D&(V^q))+U[4]+4118548399&4294967295,S=D+(L<<7&4294967295|L>>>25),L=q+(V^S&(D^V))+U[5]+1200080426&4294967295,q=S+(L<<12&4294967295|L>>>20),L=V+(D^q&(S^D))+U[6]+2821735955&4294967295,V=q+(L<<17&4294967295|L>>>15),L=D+(S^V&(q^S))+U[7]+4249261313&4294967295,D=V+(L<<22&4294967295|L>>>10),L=S+(q^D&(V^q))+U[8]+1770035416&4294967295,S=D+(L<<7&4294967295|L>>>25),L=q+(V^S&(D^V))+U[9]+2336552879&4294967295,q=S+(L<<12&4294967295|L>>>20),L=V+(D^q&(S^D))+U[10]+4294925233&4294967295,V=q+(L<<17&4294967295|L>>>15),L=D+(S^V&(q^S))+U[11]+2304563134&4294967295,D=V+(L<<22&4294967295|L>>>10),L=S+(q^D&(V^q))+U[12]+1804603682&4294967295,S=D+(L<<7&4294967295|L>>>25),L=q+(V^S&(D^V))+U[13]+4254626195&4294967295,q=S+(L<<12&4294967295|L>>>20),L=V+(D^q&(S^D))+U[14]+2792965006&4294967295,V=q+(L<<17&4294967295|L>>>15),L=D+(S^V&(q^S))+U[15]+1236535329&4294967295,D=V+(L<<22&4294967295|L>>>10),L=S+(V^q&(D^V))+U[1]+4129170786&4294967295,S=D+(L<<5&4294967295|L>>>27),L=q+(D^V&(S^D))+U[6]+3225465664&4294967295,q=S+(L<<9&4294967295|L>>>23),L=V+(S^D&(q^S))+U[11]+643717713&4294967295,V=q+(L<<14&4294967295|L>>>18),L=D+(q^S&(V^q))+U[0]+3921069994&4294967295,D=V+(L<<20&4294967295|L>>>12),L=S+(V^q&(D^V))+U[5]+3593408605&4294967295,S=D+(L<<5&4294967295|L>>>27),L=q+(D^V&(S^D))+U[10]+38016083&4294967295,q=S+(L<<9&4294967295|L>>>23),L=V+(S^D&(q^S))+U[15]+3634488961&4294967295,V=q+(L<<14&4294967295|L>>>18),L=D+(q^S&(V^q))+U[4]+3889429448&4294967295,D=V+(L<<20&4294967295|L>>>12),L=S+(V^q&(D^V))+U[9]+568446438&4294967295,S=D+(L<<5&4294967295|L>>>27),L=q+(D^V&(S^D))+U[14]+3275163606&4294967295,q=S+(L<<9&4294967295|L>>>23),L=V+(S^D&(q^S))+U[3]+4107603335&4294967295,V=q+(L<<14&4294967295|L>>>18),L=D+(q^S&(V^q))+U[8]+1163531501&4294967295,D=V+(L<<20&4294967295|L>>>12),L=S+(V^q&(D^V))+U[13]+2850285829&4294967295,S=D+(L<<5&4294967295|L>>>27),L=q+(D^V&(S^D))+U[2]+4243563512&4294967295,q=S+(L<<9&4294967295|L>>>23),L=V+(S^D&(q^S))+U[7]+1735328473&4294967295,V=q+(L<<14&4294967295|L>>>18),L=D+(q^S&(V^q))+U[12]+2368359562&4294967295,D=V+(L<<20&4294967295|L>>>12),L=S+(D^V^q)+U[5]+4294588738&4294967295,S=D+(L<<4&4294967295|L>>>28),L=q+(S^D^V)+U[8]+2272392833&4294967295,q=S+(L<<11&4294967295|L>>>21),L=V+(q^S^D)+U[11]+1839030562&4294967295,V=q+(L<<16&4294967295|L>>>16),L=D+(V^q^S)+U[14]+4259657740&4294967295,D=V+(L<<23&4294967295|L>>>9),L=S+(D^V^q)+U[1]+2763975236&4294967295,S=D+(L<<4&4294967295|L>>>28),L=q+(S^D^V)+U[4]+1272893353&4294967295,q=S+(L<<11&4294967295|L>>>21),L=V+(q^S^D)+U[7]+4139469664&4294967295,V=q+(L<<16&4294967295|L>>>16),L=D+(V^q^S)+U[10]+3200236656&4294967295,D=V+(L<<23&4294967295|L>>>9),L=S+(D^V^q)+U[13]+681279174&4294967295,S=D+(L<<4&4294967295|L>>>28),L=q+(S^D^V)+U[0]+3936430074&4294967295,q=S+(L<<11&4294967295|L>>>21),L=V+(q^S^D)+U[3]+3572445317&4294967295,V=q+(L<<16&4294967295|L>>>16),L=D+(V^q^S)+U[6]+76029189&4294967295,D=V+(L<<23&4294967295|L>>>9),L=S+(D^V^q)+U[9]+3654602809&4294967295,S=D+(L<<4&4294967295|L>>>28),L=q+(S^D^V)+U[12]+3873151461&4294967295,q=S+(L<<11&4294967295|L>>>21),L=V+(q^S^D)+U[15]+530742520&4294967295,V=q+(L<<16&4294967295|L>>>16),L=D+(V^q^S)+U[2]+3299628645&4294967295,D=V+(L<<23&4294967295|L>>>9),L=S+(V^(D|~q))+U[0]+4096336452&4294967295,S=D+(L<<6&4294967295|L>>>26),L=q+(D^(S|~V))+U[7]+1126891415&4294967295,q=S+(L<<10&4294967295|L>>>22),L=V+(S^(q|~D))+U[14]+2878612391&4294967295,V=q+(L<<15&4294967295|L>>>17),L=D+(q^(V|~S))+U[5]+4237533241&4294967295,D=V+(L<<21&4294967295|L>>>11),L=S+(V^(D|~q))+U[12]+1700485571&4294967295,S=D+(L<<6&4294967295|L>>>26),L=q+(D^(S|~V))+U[3]+2399980690&4294967295,q=S+(L<<10&4294967295|L>>>22),L=V+(S^(q|~D))+U[10]+4293915773&4294967295,V=q+(L<<15&4294967295|L>>>17),L=D+(q^(V|~S))+U[1]+2240044497&4294967295,D=V+(L<<21&4294967295|L>>>11),L=S+(V^(D|~q))+U[8]+1873313359&4294967295,S=D+(L<<6&4294967295|L>>>26),L=q+(D^(S|~V))+U[15]+4264355552&4294967295,q=S+(L<<10&4294967295|L>>>22),L=V+(S^(q|~D))+U[6]+2734768916&4294967295,V=q+(L<<15&4294967295|L>>>17),L=D+(q^(V|~S))+U[13]+1309151649&4294967295,D=V+(L<<21&4294967295|L>>>11),L=S+(V^(D|~q))+U[4]+4149444226&4294967295,S=D+(L<<6&4294967295|L>>>26),L=q+(D^(S|~V))+U[11]+3174756917&4294967295,q=S+(L<<10&4294967295|L>>>22),L=V+(S^(q|~D))+U[2]+718787259&4294967295,V=q+(L<<15&4294967295|L>>>17),L=D+(q^(V|~S))+U[9]+3951481745&4294967295,A.g[0]=A.g[0]+S&4294967295,A.g[1]=A.g[1]+(V+(L<<21&4294967295|L>>>11))&4294967295,A.g[2]=A.g[2]+V&4294967295,A.g[3]=A.g[3]+q&4294967295}s.prototype.v=function(A,S){S===void 0&&(S=A.length);const D=S-this.blockSize,U=this.C;let V=this.h,q=0;for(;q<S;){if(V==0)for(;q<=D;)o(this,A,q),q+=this.blockSize;if(typeof A=="string"){for(;q<S;)if(U[V++]=A.charCodeAt(q++),V==this.blockSize){o(this,U),V=0;break}}else for(;q<S;)if(U[V++]=A[q++],V==this.blockSize){o(this,U),V=0;break}}this.h=V,this.o+=S},s.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var S=1;S<A.length-8;++S)A[S]=0;S=this.o*8;for(var D=A.length-8;D<A.length;++D)A[D]=S&255,S/=256;for(this.v(A),A=Array(16),S=0,D=0;D<4;++D)for(let U=0;U<32;U+=8)A[S++]=this.g[D]>>>U&255;return A};function c(A,S){var D=d;return Object.prototype.hasOwnProperty.call(D,A)?D[A]:D[A]=S(A)}function u(A,S){this.h=S;const D=[];let U=!0;for(let V=A.length-1;V>=0;V--){const q=A[V]|0;U&&q==S||(D[V]=q,U=!1)}this.g=D}var d={};function p(A){return-128<=A&&A<128?c(A,function(S){return new u([S|0],S<0?-1:0)}):new u([A|0],A<0?-1:0)}function g(A){if(isNaN(A)||!isFinite(A))return x;if(A<0)return P(g(-A));const S=[];let D=1;for(let U=0;A>=D;U++)S[U]=A/D|0,D*=4294967296;return new u(S,0)}function b(A,S){if(A.length==0)throw Error("number format error: empty string");if(S=S||10,S<2||36<S)throw Error("radix out of range: "+S);if(A.charAt(0)=="-")return P(b(A.substring(1),S));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const D=g(Math.pow(S,8));let U=x;for(let q=0;q<A.length;q+=8){var V=Math.min(8,A.length-q);const L=parseInt(A.substring(q,q+V),S);V<8?(V=g(Math.pow(S,V)),U=U.j(V).add(g(L))):(U=U.j(D),U=U.add(g(L)))}return U}var x=p(0),T=p(1),N=p(16777216);n=u.prototype,n.m=function(){if(M(this))return-P(this).m();let A=0,S=1;for(let D=0;D<this.g.length;D++){const U=this.i(D);A+=(U>=0?U:4294967296+U)*S,S*=4294967296}return A},n.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(B(this))return"0";if(M(this))return"-"+P(this).toString(A);const S=g(Math.pow(A,6));var D=this;let U="";for(;;){const V=de(D,S).g;D=Y(D,V.j(S));let q=((D.g.length>0?D.g[0]:D.h)>>>0).toString(A);if(D=V,B(D))return q+U;for(;q.length<6;)q="0"+q;U=q+U}},n.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function B(A){if(A.h!=0)return!1;for(let S=0;S<A.g.length;S++)if(A.g[S]!=0)return!1;return!0}function M(A){return A.h==-1}n.l=function(A){return A=Y(this,A),M(A)?-1:B(A)?0:1};function P(A){const S=A.g.length,D=[];for(let U=0;U<S;U++)D[U]=~A.g[U];return new u(D,~A.h).add(T)}n.abs=function(){return M(this)?P(this):this},n.add=function(A){const S=Math.max(this.g.length,A.g.length),D=[];let U=0;for(let V=0;V<=S;V++){let q=U+(this.i(V)&65535)+(A.i(V)&65535),L=(q>>>16)+(this.i(V)>>>16)+(A.i(V)>>>16);U=L>>>16,q&=65535,L&=65535,D[V]=L<<16|q}return new u(D,D[D.length-1]&-2147483648?-1:0)};function Y(A,S){return A.add(P(S))}n.j=function(A){if(B(this)||B(A))return x;if(M(this))return M(A)?P(this).j(P(A)):P(P(this).j(A));if(M(A))return P(this.j(P(A)));if(this.l(N)<0&&A.l(N)<0)return g(this.m()*A.m());const S=this.g.length+A.g.length,D=[];for(var U=0;U<2*S;U++)D[U]=0;for(U=0;U<this.g.length;U++)for(let V=0;V<A.g.length;V++){const q=this.i(U)>>>16,L=this.i(U)&65535,He=A.i(V)>>>16,xt=A.i(V)&65535;D[2*U+2*V]+=L*xt,$(D,2*U+2*V),D[2*U+2*V+1]+=q*xt,$(D,2*U+2*V+1),D[2*U+2*V+1]+=L*He,$(D,2*U+2*V+1),D[2*U+2*V+2]+=q*He,$(D,2*U+2*V+2)}for(A=0;A<S;A++)D[A]=D[2*A+1]<<16|D[2*A];for(A=S;A<2*S;A++)D[A]=0;return new u(D,0)};function $(A,S){for(;(A[S]&65535)!=A[S];)A[S+1]+=A[S]>>>16,A[S]&=65535,S++}function J(A,S){this.g=A,this.h=S}function de(A,S){if(B(S))throw Error("division by zero");if(B(A))return new J(x,x);if(M(A))return S=de(P(A),S),new J(P(S.g),P(S.h));if(M(S))return S=de(A,P(S)),new J(P(S.g),S.h);if(A.g.length>30){if(M(A)||M(S))throw Error("slowDivide_ only works with positive integers.");for(var D=T,U=S;U.l(A)<=0;)D=Ne(D),U=Ne(U);var V=we(D,1),q=we(U,1);for(U=we(U,2),D=we(D,2);!B(U);){var L=q.add(U);L.l(A)<=0&&(V=V.add(D),q=L),U=we(U,1),D=we(D,1)}return S=Y(A,V.j(S)),new J(V,S)}for(V=x;A.l(S)>=0;){for(D=Math.max(1,Math.floor(A.m()/S.m())),U=Math.ceil(Math.log(D)/Math.LN2),U=U<=48?1:Math.pow(2,U-48),q=g(D),L=q.j(S);M(L)||L.l(A)>0;)D-=U,q=g(D),L=q.j(S);B(q)&&(q=T),V=V.add(q),A=Y(A,L)}return new J(V,A)}n.B=function(A){return de(this,A).h},n.and=function(A){const S=Math.max(this.g.length,A.g.length),D=[];for(let U=0;U<S;U++)D[U]=this.i(U)&A.i(U);return new u(D,this.h&A.h)},n.or=function(A){const S=Math.max(this.g.length,A.g.length),D=[];for(let U=0;U<S;U++)D[U]=this.i(U)|A.i(U);return new u(D,this.h|A.h)},n.xor=function(A){const S=Math.max(this.g.length,A.g.length),D=[];for(let U=0;U<S;U++)D[U]=this.i(U)^A.i(U);return new u(D,this.h^A.h)};function Ne(A){const S=A.g.length+1,D=[];for(let U=0;U<S;U++)D[U]=A.i(U)<<1|A.i(U-1)>>>31;return new u(D,A.h)}function we(A,S){const D=S>>5;S%=32;const U=A.g.length-D,V=[];for(let q=0;q<U;q++)V[q]=S>0?A.i(q+D)>>>S|A.i(q+D+1)<<32-S:A.i(q+D);return new u(V,A.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,ok=s,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.B,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=g,u.fromString=b,Vo=u}).apply(typeof r2<"u"?r2:typeof self<"u"?self:typeof window<"u"?window:{});var Hf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var lk,Ih,ck,fm,jb,uk,hk,dk;(function(){var n,e=Object.defineProperty;function t(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof Hf=="object"&&Hf];for(var v=0;v<f.length;++v){var E=f[v];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var s=t(this);function o(f,v){if(v)e:{var E=s;f=f.split(".");for(var R=0;R<f.length-1;R++){var ie=f[R];if(!(ie in E))break e;E=E[ie]}f=f[f.length-1],R=E[f],v=v(R),v!=R&&v!=null&&e(E,f,{configurable:!0,writable:!0,value:v})}}o("Symbol.dispose",function(f){return f||Symbol("Symbol.dispose")}),o("Array.prototype.values",function(f){return f||function(){return this[Symbol.iterator]()}}),o("Object.entries",function(f){return f||function(v){var E=[],R;for(R in v)Object.prototype.hasOwnProperty.call(v,R)&&E.push([R,v[R]]);return E}});var c=c||{},u=this||self;function d(f){var v=typeof f;return v=="object"&&f!=null||v=="function"}function p(f,v,E){return f.call.apply(f.bind,arguments)}function g(f,v,E){return g=p,g.apply(null,arguments)}function b(f,v){var E=Array.prototype.slice.call(arguments,1);return function(){var R=E.slice();return R.push.apply(R,arguments),f.apply(this,R)}}function x(f,v){function E(){}E.prototype=v.prototype,f.Z=v.prototype,f.prototype=new E,f.prototype.constructor=f,f.Ob=function(R,ie,me){for(var Xe=Array(arguments.length-2),tn=2;tn<arguments.length;tn++)Xe[tn-2]=arguments[tn];return v.prototype[ie].apply(R,Xe)}}var T=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?f=>f&&AsyncContext.Snapshot.wrap(f):f=>f;function N(f){const v=f.length;if(v>0){const E=Array(v);for(let R=0;R<v;R++)E[R]=f[R];return E}return[]}function B(f,v){for(let R=1;R<arguments.length;R++){const ie=arguments[R];var E=typeof ie;if(E=E!="object"?E:ie?Array.isArray(ie)?"array":E:"null",E=="array"||E=="object"&&typeof ie.length=="number"){E=f.length||0;const me=ie.length||0;f.length=E+me;for(let Xe=0;Xe<me;Xe++)f[E+Xe]=ie[Xe]}else f.push(ie)}}class M{constructor(v,E){this.i=v,this.j=E,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function P(f){u.setTimeout(()=>{throw f},0)}function Y(){var f=A;let v=null;return f.g&&(v=f.g,f.g=f.g.next,f.g||(f.h=null),v.next=null),v}class ${constructor(){this.h=this.g=null}add(v,E){const R=J.get();R.set(v,E),this.h?this.h.next=R:this.g=R,this.h=R}}var J=new M(()=>new de,f=>f.reset());class de{constructor(){this.next=this.g=this.h=null}set(v,E){this.h=v,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let Ne,we=!1,A=new $,S=()=>{const f=Promise.resolve(void 0);Ne=()=>{f.then(D)}};function D(){for(var f;f=Y();){try{f.h.call(f.g)}catch(E){P(E)}var v=J;v.j(f),v.h<100&&(v.h++,f.next=v.g,v.g=f)}we=!1}function U(){this.u=this.u,this.C=this.C}U.prototype.u=!1,U.prototype.dispose=function(){this.u||(this.u=!0,this.N())},U.prototype[Symbol.dispose]=function(){this.dispose()},U.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function V(f,v){this.type=f,this.g=this.target=v,this.defaultPrevented=!1}V.prototype.h=function(){this.defaultPrevented=!0};var q=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var f=!1,v=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const E=()=>{};u.addEventListener("test",E,v),u.removeEventListener("test",E,v)}catch{}return f})();function L(f){return/^[\s\xa0]*$/.test(f)}function He(f,v){V.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f&&this.init(f,v)}x(He,V),He.prototype.init=function(f,v){const E=this.type=f.type,R=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;this.target=f.target||f.srcElement,this.g=v,v=f.relatedTarget,v||(E=="mouseover"?v=f.fromElement:E=="mouseout"&&(v=f.toElement)),this.relatedTarget=v,R?(this.clientX=R.clientX!==void 0?R.clientX:R.pageX,this.clientY=R.clientY!==void 0?R.clientY:R.pageY,this.screenX=R.screenX||0,this.screenY=R.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=f.pointerType,this.state=f.state,this.i=f,f.defaultPrevented&&He.Z.h.call(this)},He.prototype.h=function(){He.Z.h.call(this);const f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var xt="closure_listenable_"+(Math.random()*1e6|0),H=0;function ye(f,v,E,R,ie){this.listener=f,this.proxy=null,this.src=v,this.type=E,this.capture=!!R,this.ha=ie,this.key=++H,this.da=this.fa=!1}function Ve(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function Ke(f,v,E){for(const R in f)v.call(E,f[R],R,f)}function ne(f,v){for(const E in f)v.call(void 0,f[E],E,f)}function O(f){const v={};for(const E in f)v[E]=f[E];return v}const K="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Te(f,v){let E,R;for(let ie=1;ie<arguments.length;ie++){R=arguments[ie];for(E in R)f[E]=R[E];for(let me=0;me<K.length;me++)E=K[me],Object.prototype.hasOwnProperty.call(R,E)&&(f[E]=R[E])}}function Re(f){this.src=f,this.g={},this.h=0}Re.prototype.add=function(f,v,E,R,ie){const me=f.toString();f=this.g[me],f||(f=this.g[me]=[],this.h++);const Xe=Me(f,v,R,ie);return Xe>-1?(v=f[Xe],E||(v.fa=!1)):(v=new ye(v,this.src,me,!!R,ie),v.fa=E,f.push(v)),v};function Ge(f,v){const E=v.type;if(E in f.g){var R=f.g[E],ie=Array.prototype.indexOf.call(R,v,void 0),me;(me=ie>=0)&&Array.prototype.splice.call(R,ie,1),me&&(Ve(v),f.g[E].length==0&&(delete f.g[E],f.h--))}}function Me(f,v,E,R){for(let ie=0;ie<f.length;++ie){const me=f[ie];if(!me.da&&me.listener==v&&me.capture==!!E&&me.ha==R)return ie}return-1}var ut="closure_lm_"+(Math.random()*1e6|0),gt={};function et(f,v,E,R,ie){if(Array.isArray(v)){for(let me=0;me<v.length;me++)et(f,v[me],E,R,ie);return null}return E=St(E),f&&f[xt]?f.J(v,E,d(R)?!!R.capture:!1,ie):qt(f,v,E,!1,R,ie)}function qt(f,v,E,R,ie,me){if(!v)throw Error("Invalid event type");const Xe=d(ie)?!!ie.capture:!!ie;let tn=sn(f);if(tn||(f[ut]=tn=new Re(f)),E=tn.add(v,E,R,Xe,me),E.proxy)return E;if(R=Dn(),E.proxy=R,R.src=f,R.listener=E,f.addEventListener)q||(ie=Xe),ie===void 0&&(ie=!1),f.addEventListener(v.toString(),R,ie);else if(f.attachEvent)f.attachEvent(pe(v.toString()),R);else if(f.addListener&&f.removeListener)f.addListener(R);else throw Error("addEventListener and attachEvent are unavailable.");return E}function Dn(){function f(E){return v.call(f.src,f.listener,E)}const v=ln;return f}function Vt(f,v,E,R,ie){if(Array.isArray(v))for(var me=0;me<v.length;me++)Vt(f,v[me],E,R,ie);else R=d(R)?!!R.capture:!!R,E=St(E),f&&f[xt]?(f=f.i,me=String(v).toString(),me in f.g&&(v=f.g[me],E=Me(v,E,R,ie),E>-1&&(Ve(v[E]),Array.prototype.splice.call(v,E,1),v.length==0&&(delete f.g[me],f.h--)))):f&&(f=sn(f))&&(v=f.g[v.toString()],f=-1,v&&(f=Me(v,E,R,ie)),(E=f>-1?v[f]:null)&&kt(E))}function kt(f){if(typeof f!="number"&&f&&!f.da){var v=f.src;if(v&&v[xt])Ge(v.i,f);else{var E=f.type,R=f.proxy;v.removeEventListener?v.removeEventListener(E,R,f.capture):v.detachEvent?v.detachEvent(pe(E),R):v.addListener&&v.removeListener&&v.removeListener(R),(E=sn(v))?(Ge(E,f),E.h==0&&(E.src=null,v[ut]=null)):Ve(f)}}}function pe(f){return f in gt?gt[f]:gt[f]="on"+f}function ln(f,v){if(f.da)f=!0;else{v=new He(v,this);const E=f.listener,R=f.ha||f.src;f.fa&&kt(f),f=E.call(R,v)}return f}function sn(f){return f=f[ut],f instanceof Re?f:null}var dt="__closure_events_fn_"+(Math.random()*1e9>>>0);function St(f){return typeof f=="function"?f:(f[dt]||(f[dt]=function(v){return f.handleEvent(v)}),f[dt])}function ct(){U.call(this),this.i=new Re(this),this.M=this,this.G=null}x(ct,U),ct.prototype[xt]=!0,ct.prototype.removeEventListener=function(f,v,E,R){Vt(this,f,v,E,R)};function it(f,v){var E,R=f.G;if(R)for(E=[];R;R=R.G)E.push(R);if(f=f.M,R=v.type||v,typeof v=="string")v=new V(v,f);else if(v instanceof V)v.target=v.target||f;else{var ie=v;v=new V(R,f),Te(v,ie)}ie=!0;let me,Xe;if(E)for(Xe=E.length-1;Xe>=0;Xe--)me=v.g=E[Xe],ie=Jt(me,R,!0,v)&&ie;if(me=v.g=f,ie=Jt(me,R,!0,v)&&ie,ie=Jt(me,R,!1,v)&&ie,E)for(Xe=0;Xe<E.length;Xe++)me=v.g=E[Xe],ie=Jt(me,R,!1,v)&&ie}ct.prototype.N=function(){if(ct.Z.N.call(this),this.i){var f=this.i;for(const v in f.g){const E=f.g[v];for(let R=0;R<E.length;R++)Ve(E[R]);delete f.g[v],f.h--}}this.G=null},ct.prototype.J=function(f,v,E,R){return this.i.add(String(f),v,!1,E,R)},ct.prototype.K=function(f,v,E,R){return this.i.add(String(f),v,!0,E,R)};function Jt(f,v,E,R){if(v=f.i.g[String(v)],!v)return!0;v=v.concat();let ie=!0;for(let me=0;me<v.length;++me){const Xe=v[me];if(Xe&&!Xe.da&&Xe.capture==E){const tn=Xe.listener,Ps=Xe.ha||Xe.src;Xe.fa&&Ge(f.i,Xe),ie=tn.call(Ps,R)!==!1&&ie}}return ie&&!R.defaultPrevented}function Is(f,v){if(typeof f!="function")if(f&&typeof f.handleEvent=="function")f=g(f.handleEvent,f);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:u.setTimeout(f,v||0)}function Ct(f){f.g=Is(()=>{f.g=null,f.i&&(f.i=!1,Ct(f))},f.l);const v=f.h;f.h=null,f.m.apply(null,v)}class un extends U{constructor(v,E){super(),this.m=v,this.l=E,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:Ct(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ds(f){U.call(this),this.h=f,this.g={}}x(ds,U);var Kt=[];function Pn(f){Ke(f.g,function(v,E){this.g.hasOwnProperty(E)&&kt(v)},f),f.g={}}ds.prototype.N=function(){ds.Z.N.call(this),Pn(this)},ds.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var hn=u.JSON.stringify,Rn=u.JSON.parse,he=class{stringify(f){return u.JSON.stringify(f,void 0)}parse(f){return u.JSON.parse(f,void 0)}};function De(){}function Be(){}var tt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Fe(){V.call(this,"d")}x(Fe,V);function Le(){V.call(this,"c")}x(Le,V);var ze={},Tt=null;function bt(){return Tt=Tt||new ct}ze.Ia="serverreachability";function It(f){V.call(this,ze.Ia,f)}x(It,V);function Qt(f){const v=bt();it(v,new It(v))}ze.STAT_EVENT="statevent";function ee(f,v){V.call(this,ze.STAT_EVENT,f),this.stat=v}x(ee,V);function ve(f){const v=bt();it(v,new ee(v,f))}ze.Ja="timingevent";function at(f,v){V.call(this,ze.Ja,f),this.size=v}x(at,V);function Dt(f,v){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){f()},v)}function jt(){this.g=!0}jt.prototype.ua=function(){this.g=!1};function rn(f,v,E,R,ie,me){f.info(function(){if(f.g)if(me){var Xe="",tn=me.split("&");for(let Un=0;Un<tn.length;Un++){var Ps=tn[Un].split("=");if(Ps.length>1){const ms=Ps[0];Ps=Ps[1];const ui=ms.split("_");Xe=ui.length>=2&&ui[1]=="type"?Xe+(ms+"="+Ps+"&"):Xe+(ms+"=redacted&")}}}else Xe=null;else Xe=me;return"XMLHTTP REQ ("+R+") [attempt "+ie+"]: "+v+`
`+E+`
`+Xe})}function Yt(f,v,E,R,ie,me,Xe){f.info(function(){return"XMLHTTP RESP ("+R+") [ attempt "+ie+"]: "+v+`
`+E+`
`+me+" "+Xe})}function $t(f,v,E,R){f.info(function(){return"XMLHTTP TEXT ("+v+"): "+rs(f,E)+(R?" "+R:"")})}function Mn(f,v){f.info(function(){return"TIMEOUT: "+v})}jt.prototype.info=function(){};function rs(f,v){if(!f.g)return v;if(!v)return null;try{const me=JSON.parse(v);if(me){for(f=0;f<me.length;f++)if(Array.isArray(me[f])){var E=me[f];if(!(E.length<2)){var R=E[1];if(Array.isArray(R)&&!(R.length<1)){var ie=R[0];if(ie!="noop"&&ie!="stop"&&ie!="close")for(let Xe=1;Xe<R.length;Xe++)R[Xe]=""}}}}return hn(me)}catch{return v}}var bn={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Cn={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Bn;function z(){}x(z,De),z.prototype.g=function(){return new XMLHttpRequest},Bn=new z;function xe(f){return encodeURIComponent(String(f))}function ke(f){var v=1;f=f.split(":");const E=[];for(;v>0&&f.length;)E.push(f.shift()),v--;return f.length&&E.push(f.join(":")),E}function Se(f,v,E,R){this.j=f,this.i=v,this.l=E,this.S=R||1,this.V=new ds(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new be}function be(){this.i=null,this.g="",this.h=!1}var rt={},Rt={};function ot(f,v,E){f.M=1,f.A=Ue(qn(v)),f.u=E,f.R=!0,vt(f,null)}function vt(f,v){f.F=Date.now(),Ts(f),f.B=qn(f.A);var E=f.B,R=f.S;Array.isArray(R)||(R=[String(R)]),_s(E.i,"t",R),f.C=0,E=f.j.L,f.h=new be,f.g=Md(f.j,E?v:null,!f.u),f.P>0&&(f.O=new un(g(f.Y,f,f.g),f.P)),v=f.V,E=f.g,R=f.ba;var ie="readystatechange";Array.isArray(ie)||(ie&&(Kt[0]=ie.toString()),ie=Kt);for(let me=0;me<ie.length;me++){const Xe=et(E,ie[me],R||v.handleEvent,!1,v.h||v);if(!Xe)break;v.g[Xe.key]=Xe}v=f.J?O(f.J):{},f.u?(f.v||(f.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.B,f.v,f.u,v)):(f.v="GET",f.g.ea(f.B,f.v,null,v)),Qt(),rn(f.i,f.v,f.B,f.l,f.S,f.u)}Se.prototype.ba=function(f){f=f.target;const v=this.O;v&&en(f)==3?v.j():this.Y(f)},Se.prototype.Y=function(f){try{if(f==this.g)e:{const tn=en(this.g),Ps=this.g.ya(),Un=this.g.ca();if(!(tn<3)&&(tn!=3||this.g&&(this.h.h||this.g.la()||Bt(this.g)))){this.K||tn!=4||Ps==7||(Ps==8||Un<=0?Qt(3):Qt(2)),ts(this);var v=this.g.ca();this.X=v;var E=Nt(this);if(this.o=v==200,Yt(this.i,this.v,this.B,this.l,this.S,tn,v),this.o){if(this.U&&!this.L){t:{if(this.g){var R,ie=this.g;if((R=ie.g?ie.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!L(R)){var me=R;break t}}me=null}if(f=me)$t(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,k(this,f);else{this.o=!1,this.m=3,ve(12),fe(this),W(this);break e}}if(this.R){f=!0;let ms;for(;!this.K&&this.C<E.length;)if(ms=er(this,E),ms==Rt){tn==4&&(this.m=4,ve(14),f=!1),$t(this.i,this.l,null,"[Incomplete Response]");break}else if(ms==rt){this.m=4,ve(15),$t(this.i,this.l,E,"[Invalid Chunk]"),f=!1;break}else $t(this.i,this.l,ms,null),k(this,ms);if(mn(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),tn!=4||E.length!=0||this.h.h||(this.m=1,ve(16),f=!1),this.o=this.o&&f,!f)$t(this.i,this.l,E,"[Invalid Chunked Response]"),fe(this),W(this);else if(E.length>0&&!this.W){this.W=!0;var Xe=this.j;Xe.g==this&&Xe.aa&&!Xe.P&&(Xe.j.info("Great, no buffering proxy detected. Bytes received: "+E.length),Sr(Xe),Xe.P=!0,ve(11))}}else $t(this.i,this.l,E,null),k(this,E);tn==4&&fe(this),this.o&&!this.K&&(tn==4?tc(this.j,this):(this.o=!1,Ts(this)))}else an(this.g),v==400&&E.indexOf("Unknown SID")>0?(this.m=3,ve(12)):(this.m=0,ve(13)),fe(this),W(this)}}}catch{}};function Nt(f){if(!mn(f))return f.g.la();const v=Bt(f.g);if(v==="")return"";let E="";const R=v.length,ie=en(f.g)==4;if(!f.h.i){if(typeof TextDecoder>"u")return fe(f),W(f),"";f.h.i=new u.TextDecoder}for(let me=0;me<R;me++)f.h.h=!0,E+=f.h.i.decode(v[me],{stream:!(ie&&me==R-1)});return v.length=0,f.h.g+=E,f.C=0,f.h.g}function mn(f){return f.g?f.v=="GET"&&f.M!=2&&f.j.Aa:!1}function er(f,v){var E=f.C,R=v.indexOf(`
`,E);return R==-1?Rt:(E=Number(v.substring(E,R)),isNaN(E)?rt:(R+=1,R+E>v.length?Rt:(v=v.slice(R,R+E),f.C=R+E,v)))}Se.prototype.cancel=function(){this.K=!0,fe(this)};function Ts(f){f.T=Date.now()+f.H,Ds(f,f.H)}function Ds(f,v){if(f.D!=null)throw Error("WatchDog timer not null");f.D=Dt(g(f.aa,f),v)}function ts(f){f.D&&(u.clearTimeout(f.D),f.D=null)}Se.prototype.aa=function(){this.D=null;const f=Date.now();f-this.T>=0?(Mn(this.i,this.B),this.M!=2&&(Qt(),ve(17)),fe(this),this.m=2,W(this)):Ds(this,this.T-f)};function W(f){f.j.I==0||f.K||tc(f.j,f)}function fe(f){ts(f);var v=f.O;v&&typeof v.dispose=="function"&&v.dispose(),f.O=null,Pn(f.V),f.g&&(v=f.g,f.g=null,v.abort(),v.dispose())}function k(f,v){try{var E=f.j;if(E.I!=0&&(E.g==f||$e(E.h,f))){if(!f.L&&$e(E.h,f)&&E.I==3){try{var R=E.Ba.g.parse(v)}catch{R=null}if(Array.isArray(R)&&R.length==3){var ie=R;if(ie[0]==0){e:if(!E.v){if(E.g)if(E.g.F+3e3<f.F)ca(E),Nn(E);else break e;Ss(E),ve(18)}}else E.xa=ie[1],0<E.xa-E.K&&ie[2]<37500&&E.F&&E.A==0&&!E.C&&(E.C=Dt(g(E.Va,E),6e3));Ye(E.h)<=1&&E.ta&&(E.ta=void 0)}else jr(E,11)}else if((f.L||E.g==f)&&ca(E),!L(v))for(ie=E.Ba.g.parse(v),v=0;v<ie.length;v++){let Un=ie[v];const ms=Un[0];if(!(ms<=E.K))if(E.K=ms,Un=Un[1],E.I==2)if(Un[0]=="c"){E.M=Un[1],E.ba=Un[2];const ui=Un[3];ui!=null&&(E.ka=ui,E.j.info("VER="+E.ka));const zi=Un[4];zi!=null&&(E.za=zi,E.j.info("SVER="+E.za));const ki=Un[5];ki!=null&&typeof ki=="number"&&ki>0&&(R=1.5*ki,E.O=R,E.j.info("backChannelRequestTimeoutMs_="+R)),R=E;const Si=f.g;if(Si){const el=Si.g?Si.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(el){var me=R.h;me.g||el.indexOf("spdy")==-1&&el.indexOf("quic")==-1&&el.indexOf("h2")==-1||(me.j=me.l,me.g=new Set,me.h&&(qe(me,me.h),me.h=null))}if(R.G){const sc=Si.g?Si.g.getResponseHeader("X-HTTP-Session-Id"):null;sc&&(R.wa=sc,se(R.J,R.G,sc))}}E.I=3,E.l&&E.l.ra(),E.aa&&(E.T=Date.now()-f.F,E.j.info("Handshake RTT: "+E.T+"ms")),R=E;var Xe=f;if(R.na=Ei(R,R.L?R.ba:null,R.W),Xe.L){Gt(R.h,Xe);var tn=Xe,Ps=R.O;Ps&&(tn.H=Ps),tn.D&&(ts(tn),Ts(tn)),R.g=Xe}else vr(R);E.i.length>0&&ls(E)}else Un[0]!="stop"&&Un[0]!="close"||jr(E,7);else E.I==3&&(Un[0]=="stop"||Un[0]=="close"?Un[0]=="stop"?jr(E,7):zn(E):Un[0]!="noop"&&E.l&&E.l.qa(Un),E.A=0)}}Qt(4)}catch{}}var C=class{constructor(f,v){this.g=f,this.map=v}};function Q(f){this.l=f||10,u.PerformanceNavigationTiming?(f=u.performance.getEntriesByType("navigation"),f=f.length>0&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ae(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function Ye(f){return f.h?1:f.g?f.g.size:0}function $e(f,v){return f.h?f.h==v:f.g?f.g.has(v):!1}function qe(f,v){f.g?f.g.add(v):f.h=v}function Gt(f,v){f.h&&f.h==v?f.h=null:f.g&&f.g.has(v)&&f.g.delete(v)}Q.prototype.cancel=function(){if(this.i=Mt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function Mt(f){if(f.h!=null)return f.i.concat(f.h.G);if(f.g!=null&&f.g.size!==0){let v=f.i;for(const E of f.g.values())v=v.concat(E.G);return v}return N(f.i)}var Yn=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Gs(f,v){if(f){f=f.split("&");for(let E=0;E<f.length;E++){const R=f[E].indexOf("=");let ie,me=null;R>=0?(ie=f[E].substring(0,R),me=f[E].substring(R+1)):ie=f[E],v(ie,me?decodeURIComponent(me.replace(/\+/g," ")):"")}}}function Bs(f){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;f instanceof Bs?(this.l=f.l,$n(this,f.j),this.o=f.o,this.g=f.g,X(this,f.u),this.h=f.h,Ee(this,yr(f.i)),this.m=f.m):f&&(v=String(f).match(Yn))?(this.l=!1,$n(this,v[1]||"",!0),this.o=We(v[2]||""),this.g=We(v[3]||"",!0),X(this,v[4]),this.h=We(v[5]||"",!0),Ee(this,v[6]||"",!0),this.m=We(v[7]||"")):(this.l=!1,this.i=new ci(null,this.l))}Bs.prototype.toString=function(){const f=[];var v=this.j;v&&f.push(ht(v,Ot,!0),":");var E=this.g;return(E||v=="file")&&(f.push("//"),(v=this.o)&&f.push(ht(v,Ot,!0),"@"),f.push(xe(E).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.u,E!=null&&f.push(":",String(E))),(E=this.h)&&(this.g&&E.charAt(0)!="/"&&f.push("/"),f.push(ht(E,E.charAt(0)=="/"?xs:En,!0))),(E=this.i.toString())&&f.push("?",E),(E=this.m)&&f.push("#",ht(E,lr)),f.join("")},Bs.prototype.resolve=function(f){const v=qn(this);let E=!!f.j;E?$n(v,f.j):E=!!f.o,E?v.o=f.o:E=!!f.g,E?v.g=f.g:E=f.u!=null;var R=f.h;if(E)X(v,f.u);else if(E=!!f.h){if(R.charAt(0)!="/")if(this.g&&!this.h)R="/"+R;else{var ie=v.h.lastIndexOf("/");ie!=-1&&(R=v.h.slice(0,ie+1)+R)}if(ie=R,ie==".."||ie==".")R="";else if(ie.indexOf("./")!=-1||ie.indexOf("/.")!=-1){R=ie.lastIndexOf("/",0)==0,ie=ie.split("/");const me=[];for(let Xe=0;Xe<ie.length;){const tn=ie[Xe++];tn=="."?R&&Xe==ie.length&&me.push(""):tn==".."?((me.length>1||me.length==1&&me[0]!="")&&me.pop(),R&&Xe==ie.length&&me.push("")):(me.push(tn),R=!0)}R=me.join("/")}else R=ie}return E?v.h=R:E=f.i.toString()!=="",E?Ee(v,yr(f.i)):E=!!f.m,E&&(v.m=f.m),v};function qn(f){return new Bs(f)}function $n(f,v,E){f.j=E?We(v,!0):v,f.j&&(f.j=f.j.replace(/:$/,""))}function X(f,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);f.u=v}else f.u=null}function Ee(f,v,E){v instanceof ci?(f.i=v,Pr(f.i,f.l)):(E||(v=ht(v,vn)),f.i=new ci(v,f.l))}function se(f,v,E){f.i.set(v,E)}function Ue(f){return se(f,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),f}function We(f,v){return f?v?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function ht(f,v,E){return typeof f=="string"?(f=encodeURI(f).replace(v,_t),E&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function _t(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var Ot=/[#\/\?@]/g,En=/[#\?:]/g,xs=/[#\?]/g,vn=/[#\?@]/g,lr=/#/g;function ci(f,v){this.h=this.g=null,this.i=f||null,this.j=!!v}function Es(f){f.g||(f.g=new Map,f.h=0,f.i&&Gs(f.i,function(v,E){f.add(decodeURIComponent(v.replace(/\+/g," ")),E)}))}n=ci.prototype,n.add=function(f,v){Es(this),this.i=null,f=cr(this,f);let E=this.g.get(f);return E||this.g.set(f,E=[]),E.push(v),this.h+=1,this};function Ui(f,v){Es(f),v=cr(f,v),f.g.has(v)&&(f.i=null,f.h-=f.g.get(v).length,f.g.delete(v))}function tr(f,v){return Es(f),v=cr(f,v),f.g.has(v)}n.forEach=function(f,v){Es(this),this.g.forEach(function(E,R){E.forEach(function(ie){f.call(v,ie,R,this)},this)},this)};function cn(f,v){Es(f);let E=[];if(typeof v=="string")tr(f,v)&&(E=E.concat(f.g.get(cr(f,v))));else for(f=Array.from(f.g.values()),v=0;v<f.length;v++)E=E.concat(f[v]);return E}n.set=function(f,v){return Es(this),this.i=null,f=cr(this,f),tr(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[v]),this.h+=1,this},n.get=function(f,v){return f?(f=cn(this,f),f.length>0?String(f[0]):v):v};function _s(f,v,E){Ui(f,v),E.length>0&&(f.i=null,f.g.set(cr(f,v),N(E)),f.h+=E.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],v=Array.from(this.g.keys());for(let R=0;R<v.length;R++){var E=v[R];const ie=xe(E);E=cn(this,E);for(let me=0;me<E.length;me++){let Xe=ie;E[me]!==""&&(Xe+="="+xe(E[me])),f.push(Xe)}}return this.i=f.join("&")};function yr(f){const v=new ci;return v.i=f.i,f.g&&(v.g=new Map(f.g),v.h=f.h),v}function cr(f,v){return v=String(v),f.j&&(v=v.toLowerCase()),v}function Pr(f,v){v&&!f.j&&(Es(f),f.i=null,f.g.forEach(function(E,R){const ie=R.toLowerCase();R!=ie&&(Ui(this,R),_s(this,ie,E))},f)),f.j=v}function os(f,v){const E=new jt;if(u.Image){const R=new Image;R.onload=b(Us,E,"TestLoadImage: loaded",!0,v,R),R.onerror=b(Us,E,"TestLoadImage: error",!1,v,R),R.onabort=b(Us,E,"TestLoadImage: abort",!1,v,R),R.ontimeout=b(Us,E,"TestLoadImage: timeout",!1,v,R),u.setTimeout(function(){R.ontimeout&&R.ontimeout()},1e4),R.src=f}else v(!1)}function Ks(f,v){const E=new jt,R=new AbortController,ie=setTimeout(()=>{R.abort(),Us(E,"TestPingServer: timeout",!1,v)},1e4);fetch(f,{signal:R.signal}).then(me=>{clearTimeout(ie),me.ok?Us(E,"TestPingServer: ok",!0,v):Us(E,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(ie),Us(E,"TestPingServer: error",!1,v)})}function Us(f,v,E,R,ie){try{ie&&(ie.onload=null,ie.onerror=null,ie.onabort=null,ie.ontimeout=null),R(E)}catch{}}function Mr(){this.g=new he}function Lr(f){this.i=f.Sb||null,this.h=f.ab||!1}x(Lr,De),Lr.prototype.g=function(){return new Wr(this.i,this.h)};function Wr(f,v){ct.call(this),this.H=f,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}x(Wr,ct),n=Wr.prototype,n.open=function(f,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=f,this.D=v,this.readyState=1,Gr(this)},n.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};f&&(v.body=f),(this.H||u).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Fi(this)),this.readyState=0},n.Pa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,Gr(this)),this.g&&(this.readyState=3,Gr(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Wa(this)}else f.text().then(this.Oa.bind(this),this.ga.bind(this))};function Wa(f){f.j.read().then(f.Ma.bind(f)).catch(f.ga.bind(f))}n.Ma=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var v=f.value?f.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!f.done}))&&(this.response=this.responseText+=v)}f.done?Fi(this):Gr(this),this.readyState==3&&Wa(this)}},n.Oa=function(f){this.g&&(this.response=this.responseText=f,Fi(this))},n.Na=function(f){this.g&&(this.response=f,Fi(this))},n.ga=function(){this.g&&Fi(this)};function Fi(f){f.readyState=4,f.l=null,f.j=null,f.B=null,Gr(f)}n.setRequestHeader=function(f,v){this.A.append(f,v)},n.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],v=this.h.entries();for(var E=v.next();!E.done;)E=E.value,f.push(E[0]+": "+E[1]),E=v.next();return f.join(`\r
`)};function Gr(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(Wr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function I(f){let v="";return Ke(f,function(E,R){v+=R,v+=":",v+=E,v+=`\r
`}),v}function te(f,v,E){e:{for(R in E){var R=!1;break e}R=!0}R||(E=I(E),typeof f=="string"?E!=null&&xe(E):se(f,v,E))}function Ae(f){ct.call(this),this.headers=new Map,this.L=f||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}x(Ae,ct);var nt=/^https?$/i,Et=["POST","PUT"];n=Ae.prototype,n.Fa=function(f){this.H=f},n.ea=function(f,v,E,R){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);v=v?v.toUpperCase():"GET",this.D=f,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Bn.g(),this.g.onreadystatechange=T(g(this.Ca,this));try{this.B=!0,this.g.open(v,String(f),!0),this.B=!1}catch(me){Lt(this,me);return}if(f=E||"",E=new Map(this.headers),R)if(Object.getPrototypeOf(R)===Object.prototype)for(var ie in R)E.set(ie,R[ie]);else if(typeof R.keys=="function"&&typeof R.get=="function")for(const me of R.keys())E.set(me,R.get(me));else throw Error("Unknown input type for opt_headers: "+String(R));R=Array.from(E.keys()).find(me=>me.toLowerCase()=="content-type"),ie=u.FormData&&f instanceof u.FormData,!(Array.prototype.indexOf.call(Et,v,void 0)>=0)||R||ie||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[me,Xe]of E)this.g.setRequestHeader(me,Xe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(f),this.v=!1}catch(me){Lt(this,me)}};function Lt(f,v){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=v,f.o=5,st(f),zt(f)}function st(f){f.A||(f.A=!0,it(f,"complete"),it(f,"error"))}n.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=f||7,it(this,"complete"),it(this,"abort"),zt(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),zt(this,!0)),Ae.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Ht(this):this.Xa())},n.Xa=function(){Ht(this)};function Ht(f){if(f.h&&typeof c<"u"){if(f.v&&en(f)==4)setTimeout(f.Ca.bind(f),0);else if(it(f,"readystatechange"),en(f)==4){f.h=!1;try{const me=f.ca();e:switch(me){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var E;if(!(E=v)){var R;if(R=me===0){let Xe=String(f.D).match(Yn)[1]||null;!Xe&&u.self&&u.self.location&&(Xe=u.self.location.protocol.slice(0,-1)),R=!nt.test(Xe?Xe.toLowerCase():"")}E=R}if(E)it(f,"complete"),it(f,"success");else{f.o=6;try{var ie=en(f)>2?f.g.statusText:""}catch{ie=""}f.l=ie+" ["+f.ca()+"]",st(f)}}finally{zt(f)}}}}function zt(f,v){if(f.g){f.m&&(clearTimeout(f.m),f.m=null);const E=f.g;f.g=null,v||it(f,"ready");try{E.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function en(f){return f.g?f.g.readyState:0}n.ca=function(){try{return en(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(f){if(this.g){var v=this.g.responseText;return f&&v.indexOf(f)==0&&(v=v.substring(f.length)),Rn(v)}};function Bt(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.F){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function an(f){const v={};f=(f.g&&en(f)>=2&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let R=0;R<f.length;R++){if(L(f[R]))continue;var E=ke(f[R]);const ie=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();const me=v[ie]||[];v[ie]=me,me.push(E)}ne(v,function(R){return R.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ks(f,v,E){return E&&E.internalChannelParams&&E.internalChannelParams[f]||v}function Qs(f){this.za=0,this.i=[],this.j=new jt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ks("failFast",!1,f),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ks("baseRetryDelayMs",5e3,f),this.Za=ks("retryDelaySeedMs",1e4,f),this.Ta=ks("forwardChannelMaxRetries",2,f),this.va=ks("forwardChannelRequestTimeoutMs",2e4,f),this.ma=f&&f.xmlHttpFactory||void 0,this.Ua=f&&f.Rb||void 0,this.Aa=f&&f.useFetchStreams||!1,this.O=void 0,this.L=f&&f.supportsCrossDomainXhr||!1,this.M="",this.h=new Q(f&&f.concurrentRequestLimit),this.Ba=new Mr,this.S=f&&f.fastHandshake||!1,this.R=f&&f.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=f&&f.Pb||!1,f&&f.ua&&this.j.ua(),f&&f.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&f&&f.detectBufferingProxy||!1,this.ia=void 0,f&&f.longPollingTimeout&&f.longPollingTimeout>0&&(this.ia=f.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Qs.prototype,n.ka=8,n.I=1,n.connect=function(f,v,E,R){ve(0),this.W=f,this.H=v||{},E&&R!==void 0&&(this.H.OSID=E,this.H.OAID=R),this.F=this.X,this.J=Ei(this,null,this.W),ls(this)};function zn(f){if(fs(f),f.I==3){var v=f.V++,E=qn(f.J);if(se(E,"SID",f.M),se(E,"RID",v),se(E,"TYPE","terminate"),ur(f,E),v=new Se(f,f.j,v),v.M=2,v.A=Ue(qn(E)),E=!1,u.navigator&&u.navigator.sendBeacon)try{E=u.navigator.sendBeacon(v.A.toString(),"")}catch{}!E&&u.Image&&(new Image().src=v.A,E=!0),E||(v.g=Md(v.j,null),v.g.ea(v.A)),v.F=Date.now(),Ts(v)}Ti(f)}function Nn(f){f.g&&(Sr(f),f.g.cancel(),f.g=null)}function fs(f){Nn(f),f.v&&(u.clearTimeout(f.v),f.v=null),ca(f),f.h.cancel(),f.m&&(typeof f.m=="number"&&u.clearTimeout(f.m),f.m=null)}function ls(f){if(!ae(f.h)&&!f.m){f.m=!0;var v=f.Ea;Ne||S(),we||(Ne(),we=!0),A.add(v,f),f.D=0}}function Ys(f,v){return Ye(f.h)>=f.h.j-(f.m?1:0)?!1:f.m?(f.i=v.G.concat(f.i),!0):f.I==1||f.I==2||f.D>=(f.Sa?0:f.Ta)?!1:(f.m=Dt(g(f.Ea,f,v),nc(f,f.D)),f.D++,!0)}n.Ea=function(f){if(this.m)if(this.m=null,this.I==1){if(!f){this.V=Math.floor(Math.random()*1e5),f=this.V++;const ie=new Se(this,this.j,f);let me=this.o;if(this.U&&(me?(me=O(me),Te(me,this.U)):me=this.U),this.u!==null||this.R||(ie.J=me,me=null),this.S)e:{for(var v=0,E=0;E<this.i.length;E++){t:{var R=this.i[E];if("__data__"in R.map&&(R=R.map.__data__,typeof R=="string")){R=R.length;break t}R=void 0}if(R===void 0)break;if(v+=R,v>4096){v=E;break e}if(v===4096||E===this.i.length-1){v=E+1;break e}}v=1e3}else v=1e3;v=kr(this,ie,v),E=qn(this.J),se(E,"RID",f),se(E,"CVER",22),this.G&&se(E,"X-HTTP-Session-Id",this.G),ur(this,E),me&&(this.R?v="headers="+xe(I(me))+"&"+v:this.u&&te(E,this.u,me)),qe(this.h,ie),this.Ra&&se(E,"TYPE","init"),this.S?(se(E,"$req",v),se(E,"SID","null"),ie.U=!0,ot(ie,E,null)):ot(ie,E,v),this.I=2}}else this.I==3&&(f?br(this,f):this.i.length==0||ae(this.h)||br(this))};function br(f,v){var E;v?E=v.l:E=f.V++;const R=qn(f.J);se(R,"SID",f.M),se(R,"RID",E),se(R,"AID",f.K),ur(f,R),f.u&&f.o&&te(R,f.u,f.o),E=new Se(f,f.j,E,f.D+1),f.u===null&&(E.J=f.o),v&&(f.i=v.G.concat(f.i)),v=kr(f,E,1e3),E.H=Math.round(f.va*.5)+Math.round(f.va*.5*Math.random()),qe(f.h,E),ot(E,R,v)}function ur(f,v){f.H&&Ke(f.H,function(E,R){se(v,R,E)}),f.l&&Ke({},function(E,R){se(v,R,E)})}function kr(f,v,E){E=Math.min(f.i.length,E);const R=f.l?g(f.l.Ka,f.l,f):null;e:{var ie=f.i;let tn=-1;for(;;){const Ps=["count="+E];tn==-1?E>0?(tn=ie[0].g,Ps.push("ofs="+tn)):tn=0:Ps.push("ofs="+tn);let Un=!0;for(let ms=0;ms<E;ms++){var me=ie[ms].g;const ui=ie[ms].map;if(me-=tn,me<0)tn=Math.max(0,ie[ms].g-100),Un=!1;else try{me="req"+me+"_"||"";try{var Xe=ui instanceof Map?ui:Object.entries(ui);for(const[zi,ki]of Xe){let Si=ki;d(ki)&&(Si=hn(ki)),Ps.push(me+zi+"="+encodeURIComponent(Si))}}catch(zi){throw Ps.push(me+"type="+encodeURIComponent("_badmap")),zi}}catch{R&&R(ui)}}if(Un){Xe=Ps.join("&");break e}}Xe=void 0}return f=f.i.splice(0,E),v.G=f,Xe}function vr(f){if(!f.g&&!f.v){f.Y=1;var v=f.Da;Ne||S(),we||(Ne(),we=!0),A.add(v,f),f.A=0}}function Ss(f){return f.g||f.v||f.A>=3?!1:(f.Y++,f.v=Dt(g(f.Da,f),nc(f,f.A)),f.A++,!0)}n.Da=function(){if(this.v=null,Vr(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var f=4*this.T;this.j.info("BP detection timer enabled: "+f),this.B=Dt(g(this.Wa,this),f)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ve(10),Nn(this),Vr(this))};function Sr(f){f.B!=null&&(u.clearTimeout(f.B),f.B=null)}function Vr(f){f.g=new Se(f,f.j,"rpc",f.Y),f.u===null&&(f.g.J=f.o),f.g.P=0;var v=qn(f.na);se(v,"RID","rpc"),se(v,"SID",f.M),se(v,"AID",f.K),se(v,"CI",f.F?"0":"1"),!f.F&&f.ia&&se(v,"TO",f.ia),se(v,"TYPE","xmlhttp"),ur(f,v),f.u&&f.o&&te(v,f.u,f.o),f.O&&(f.g.H=f.O);var E=f.g;f=f.ba,E.M=1,E.A=Ue(qn(v)),E.u=null,E.R=!0,vt(E,f)}n.Va=function(){this.C!=null&&(this.C=null,Nn(this),Ss(this),ve(19))};function ca(f){f.C!=null&&(u.clearTimeout(f.C),f.C=null)}function tc(f,v){var E=null;if(f.g==v){ca(f),Sr(f),f.g=null;var R=2}else if($e(f.h,v))E=v.G,Gt(f.h,v),R=1;else return;if(f.I!=0){if(v.o)if(R==1){E=v.u?v.u.length:0,v=Date.now()-v.F;var ie=f.D;R=bt(),it(R,new at(R,E)),ls(f)}else vr(f);else if(ie=v.m,ie==3||ie==0&&v.X>0||!(R==1&&Ys(f,v)||R==2&&Ss(f)))switch(E&&E.length>0&&(v=f.h,v.i=v.i.concat(E)),ie){case 1:jr(f,5);break;case 4:jr(f,10);break;case 3:jr(f,6);break;default:jr(f,2)}}}function nc(f,v){let E=f.Qa+Math.floor(Math.random()*f.Za);return f.isActive()||(E*=2),E*v}function jr(f,v){if(f.j.info("Error code "+v),v==2){var E=g(f.bb,f),R=f.Ua;const ie=!R;R=new Bs(R||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||$n(R,"https"),Ue(R),ie?os(R.toString(),E):Ks(R.toString(),E)}else ve(2);f.I=0,f.l&&f.l.pa(v),Ti(f),fs(f)}n.bb=function(f){f?(this.j.info("Successfully pinged google.com"),ve(2)):(this.j.info("Failed to ping google.com"),ve(1))};function Ti(f){if(f.I=0,f.ja=[],f.l){const v=Mt(f.h);(v.length!=0||f.i.length!=0)&&(B(f.ja,v),B(f.ja,f.i),f.h.i.length=0,N(f.i),f.i.length=0),f.l.oa()}}function Ei(f,v,E){var R=E instanceof Bs?qn(E):new Bs(E);if(R.g!="")v&&(R.g=v+"."+R.g),X(R,R.u);else{var ie=u.location;R=ie.protocol,v=v?v+"."+ie.hostname:ie.hostname,ie=+ie.port;const me=new Bs(null);R&&$n(me,R),v&&(me.g=v),ie&&X(me,ie),E&&(me.h=E),R=me}return E=f.G,v=f.wa,E&&v&&se(R,E,v),se(R,"VER",f.ka),ur(f,R),R}function Md(f,v,E){if(v&&!f.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=f.Aa&&!f.ma?new Ae(new Lr({ab:E})):new Ae(f.ma),v.Fa(f.L),v}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ld(){}n=Ld.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Ga(){}Ga.prototype.g=function(f,v){return new Nr(f,v)};function Nr(f,v){ct.call(this),this.g=new Qs(v),this.l=f,this.h=v&&v.messageUrlParams||null,f=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(f?f["X-WebChannel-Content-Type"]=v.messageContentType:f={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(f?f["X-WebChannel-Client-Profile"]=v.sa:f={"X-WebChannel-Client-Profile":v.sa}),this.g.U=f,(f=v&&v.Qb)&&!L(f)&&(this.g.u=f),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!L(v)&&(this.g.G=v,f=this.h,f!==null&&v in f&&(f=this.h,v in f&&delete f[v])),this.j=new ua(this)}x(Nr,ct),Nr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Nr.prototype.close=function(){zn(this.g)},Nr.prototype.o=function(f){var v=this.g;if(typeof f=="string"){var E={};E.__data__=f,f=E}else this.v&&(E={},E.__data__=hn(f),f=E);v.i.push(new C(v.Ya++,f)),v.I==3&&ls(v)},Nr.prototype.N=function(){this.g.l=null,delete this.j,zn(this.g),delete this.g,Nr.Z.N.call(this)};function Vd(f){Fe.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var v=f.__sm__;if(v){e:{for(const E in v){f=E;break e}f=void 0}(this.i=f)&&(f=this.i,v=v!==null&&f in v?v[f]:void 0),this.data=v}else this.data=f}x(Vd,Fe);function Od(){Le.call(this),this.status=1}x(Od,Le);function ua(f){this.g=f}x(ua,Ld),ua.prototype.ra=function(){it(this.g,"a")},ua.prototype.qa=function(f){it(this.g,new Vd(f))},ua.prototype.pa=function(f){it(this.g,new Od)},ua.prototype.oa=function(){it(this.g,"b")},Ga.prototype.createWebChannel=Ga.prototype.g,Nr.prototype.send=Nr.prototype.o,Nr.prototype.open=Nr.prototype.m,Nr.prototype.close=Nr.prototype.close,dk=function(){return new Ga},hk=function(){return bt()},uk=ze,jb={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},bn.NO_ERROR=0,bn.TIMEOUT=8,bn.HTTP_ERROR=6,fm=bn,Cn.COMPLETE="complete",ck=Cn,Be.EventType=tt,tt.OPEN="a",tt.CLOSE="b",tt.ERROR="c",tt.MESSAGE="d",ct.prototype.listen=ct.prototype.J,Ih=Be,Ae.prototype.listenOnce=Ae.prototype.K,Ae.prototype.getLastError=Ae.prototype.Ha,Ae.prototype.getLastErrorCode=Ae.prototype.ya,Ae.prototype.getStatus=Ae.prototype.ca,Ae.prototype.getResponseJson=Ae.prototype.La,Ae.prototype.getResponseText=Ae.prototype.la,Ae.prototype.send=Ae.prototype.ea,Ae.prototype.setWithCredentials=Ae.prototype.Fa,lk=Ae}).apply(typeof Hf<"u"?Hf:typeof self<"u"?self:typeof window<"u"?window:{});class rr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}rr.UNAUTHENTICATED=new rr(null),rr.GOOGLE_CREDENTIALS=new rr("google-credentials-uid"),rr.FIRST_PARTY=new rr("first-party-uid"),rr.MOCK_USER=new rr("mock-user");let Eu="12.8.0";function jP(n){Eu=n}const Uo=new dv("@firebase/firestore");function zc(){return Uo.logLevel}function DO(n){Uo.setLogLevel(n)}function Oe(n,...e){if(Uo.logLevel<=wn.DEBUG){const t=e.map(kv);Uo.debug(`Firestore (${Eu}): ${n}`,...t)}}function Vs(n,...e){if(Uo.logLevel<=wn.ERROR){const t=e.map(kv);Uo.error(`Firestore (${Eu}): ${n}`,...t)}}function wi(n,...e){if(Uo.logLevel<=wn.WARN){const t=e.map(kv);Uo.warn(`Firestore (${Eu}): ${n}`,...t)}}function kv(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function lt(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,fk(n,s,t)}function fk(n,e,t){let s=`FIRESTORE (${Eu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw Vs(s),new Error(s)}function pt(n,e,t,s){let o="Unexpected state";typeof t=="string"?o=t:s=t,n||fk(e,o,s)}function PO(n,e){n||lt(57014,e)}function Ze(n,e){return n}const ce={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ie extends la{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ar{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class mk{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class NP{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(rr.UNAUTHENTICATED)))}shutdown(){}}class AP{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class RP{constructor(e){this.t=e,this.currentUser=rr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){pt(this.o===void 0,42304);let s=this.i;const o=p=>this.i!==s?(s=this.i,t(p)):Promise.resolve();let c=new ar;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new ar,e.enqueueRetryable((()=>o(this.currentUser)))};const u=()=>{const p=c;e.enqueueRetryable((async()=>{await p.promise,await o(this.currentUser)}))},d=p=>{Oe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=p,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit((p=>d(p))),setTimeout((()=>{if(!this.auth){const p=this.t.getImmediate({optional:!0});p?d(p):(Oe("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new ar)}}),0),u()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((s=>this.i!==e?(Oe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(pt(typeof s.accessToken=="string",31837,{l:s}),new mk(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return pt(e===null||typeof e=="string",2055,{h:e}),new rr(e)}}class CP{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=rr.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class IP{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new CP(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(rr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Nb{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class DP{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ni(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){pt(this.o===void 0,3512);const s=c=>{c.error!=null&&Oe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${c.error.message}`);const u=c.token!==this.m;return this.m=c.token,Oe("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(c.token):Promise.resolve()};this.o=c=>{e.enqueueRetryable((()=>s(c)))};const o=c=>{Oe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=c,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((c=>o(c))),setTimeout((()=>{if(!this.appCheck){const c=this.V.getImmediate({optional:!0});c?o(c):Oe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Nb(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(pt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Nb(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class MO{getToken(){return Promise.resolve(new Nb(""))}invalidateToken(){}start(e,t){}shutdown(){}}function PP(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}class Sv{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const o=PP(40);for(let c=0;c<o.length;++c)s.length<20&&o[c]<t&&(s+=e.charAt(o[c]%62))}return s}}function Ft(n,e){return n<e?-1:n>e?1:0}function Ab(n,e){const t=Math.min(n.length,e.length);for(let s=0;s<t;s++){const o=n.charAt(s),c=e.charAt(s);if(o!==c)return qy(o)===qy(c)?Ft(o,c):qy(o)?1:-1}return Ft(n.length,e.length)}const MP=55296,LP=57343;function qy(n){const e=n.charCodeAt(0);return e>=MP&&e<=LP}function Zc(n,e,t){return n.length===e.length&&n.every(((s,o)=>t(s,e[o])))}function pk(n){return n+"\0"}const Rb="__name__";class Ki{constructor(e,t,s){t===void 0?t=0:t>e.length&&lt(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&lt(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return Ki.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ki?e.forEach((s=>{t.push(s)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let o=0;o<s;o++){const c=Ki.compareSegments(e.get(o),t.get(o));if(c!==0)return c}return Ft(e.length,t.length)}static compareSegments(e,t){const s=Ki.isNumericId(e),o=Ki.isNumericId(t);return s&&!o?-1:!s&&o?1:s&&o?Ki.extractNumericId(e).compare(Ki.extractNumericId(t)):Ab(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Vo.fromString(e.substring(4,e.length-2))}}class fn extends Ki{construct(e,t,s){return new fn(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new Ie(ce.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter((o=>o.length>0)))}return new fn(t)}static emptyPath(){return new fn([])}}const VP=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ys extends Ki{construct(e,t,s){return new ys(e,t,s)}static isValidIdentifier(e){return VP.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ys.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Rb}static keyField(){return new ys([Rb])}static fromServerFormat(e){const t=[];let s="",o=0;const c=()=>{if(s.length===0)throw new Ie(ce.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let u=!1;for(;o<e.length;){const d=e[o];if(d==="\\"){if(o+1===e.length)throw new Ie(ce.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[o+1];if(p!=="\\"&&p!=="."&&p!=="`")throw new Ie(ce.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=p,o+=2}else d==="`"?(u=!u,o++):d!=="."||u?(s+=d,o++):(c(),o++)}if(c(),u)throw new Ie(ce.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ys(t)}static emptyPath(){return new ys([])}}class Je{constructor(e){this.path=e}static fromPath(e){return new Je(fn.fromString(e))}static fromName(e){return new Je(fn.fromString(e).popFirst(5))}static empty(){return new Je(fn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&fn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return fn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Je(new fn(e.slice()))}}function jv(n,e,t){if(!t)throw new Ie(ce.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function OP(n,e,t,s){if(e===!0&&s===!0)throw new Ie(ce.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function i2(n){if(!Je.isDocumentKey(n))throw new Ie(ce.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function a2(n){if(Je.isDocumentKey(n))throw new Ie(ce.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function gk(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function ap(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(s){return s.constructor?s.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":lt(12329,{type:typeof n})}function yn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ie(ce.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=ap(n);throw new Ie(ce.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function yk(n,e){if(e<=0)throw new Ie(ce.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function Ws(n,e){const t={typeString:n};return e&&(t.value=e),t}function Yl(n,e){if(!gk(n))throw new Ie(ce.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const o=e[s].typeString,c="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const u=n[s];if(o&&typeof u!==o){t=`JSON field '${s}' must be a ${o}.`;break}if(c!==void 0&&u!==c.value){t=`Expected '${s}' field to equal '${c.value}'`;break}}if(t)throw new Ie(ce.INVALID_ARGUMENT,t);return!0}const o2=-62135596800,l2=1e6;class mt{static now(){return mt.fromMillis(Date.now())}static fromDate(e){return mt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*l2);return new mt(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ie(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ie(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<o2)throw new Ie(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ie(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/l2}_compareTo(e){return this.seconds===e.seconds?Ft(this.nanoseconds,e.nanoseconds):Ft(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:mt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Yl(e,mt._jsonSchema))return new mt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-o2;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}mt._jsonSchemaVersion="firestore/timestamp/1.0",mt._jsonSchema={type:Ws("string",mt._jsonSchemaVersion),seconds:Ws("number"),nanoseconds:Ws("number")};class wt{static fromTimestamp(e){return new wt(e)}static min(){return new wt(new mt(0,0))}static max(){return new wt(new mt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const eu=-1;class tu{constructor(e,t,s,o){this.indexId=e,this.collectionGroup=t,this.fields=s,this.indexState=o}}function Cb(n){return n.fields.find((e=>e.kind===2))}function wl(n){return n.fields.filter((e=>e.kind!==2))}function BP(n,e){let t=Ft(n.collectionGroup,e.collectionGroup);if(t!==0)return t;for(let s=0;s<Math.min(n.fields.length,e.fields.length);++s)if(t=UP(n.fields[s],e.fields[s]),t!==0)return t;return Ft(n.fields.length,e.fields.length)}tu.UNKNOWN_ID=-1;class Rl{constructor(e,t){this.fieldPath=e,this.kind=t}}function UP(n,e){const t=ys.comparator(n.fieldPath,e.fieldPath);return t!==0?t:Ft(n.kind,e.kind)}class nu{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new nu(0,ai.min())}}function bk(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,o=wt.fromTimestamp(s===1e9?new mt(t+1,0):new mt(t,s));return new ai(o,Je.empty(),e)}function vk(n){return new ai(n.readTime,n.key,eu)}class ai{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new ai(wt.min(),Je.empty(),eu)}static max(){return new ai(wt.max(),Je.empty(),eu)}}function Nv(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Je.comparator(n.documentKey,e.documentKey),t!==0?t:Ft(n.largestBatchId,e.largestBatchId))}const xk="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class _k{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Ko(n){if(n.code!==ce.FAILED_PRECONDITION||n.message!==xk)throw n;Oe("LocalStore","Unexpectedly lost primary lease")}class re{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&lt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new re(((s,o)=>{this.nextCallback=c=>{this.wrapSuccess(e,c).next(s,o)},this.catchCallback=c=>{this.wrapFailure(t,c).next(s,o)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof re?t:re.resolve(t)}catch(t){return re.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):re.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):re.reject(t)}static resolve(e){return new re(((t,s)=>{t(e)}))}static reject(e){return new re(((t,s)=>{s(e)}))}static waitFor(e){return new re(((t,s)=>{let o=0,c=0,u=!1;e.forEach((d=>{++o,d.next((()=>{++c,u&&c===o&&t()}),(p=>s(p)))})),u=!0,c===o&&t()}))}static or(e){let t=re.resolve(!1);for(const s of e)t=t.next((o=>o?re.resolve(o):s()));return t}static forEach(e,t){const s=[];return e.forEach(((o,c)=>{s.push(t.call(this,o,c))})),this.waitFor(s)}static mapArray(e,t){return new re(((s,o)=>{const c=e.length,u=new Array(c);let d=0;for(let p=0;p<c;p++){const g=p;t(e[g]).next((b=>{u[g]=b,++d,d===c&&s(u)}),(b=>o(b)))}}))}static doWhile(e,t){return new re(((s,o)=>{const c=()=>{e()===!0?t().next((()=>{c()}),o):s()};c()}))}}const ti="SimpleDb";class op{static open(e,t,s,o){try{return new op(t,e.transaction(o,s))}catch(c){throw new Oh(t,c)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new ar,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Oh(e,t.error)):this.S.resolve()},this.transaction.onerror=s=>{const o=Av(s.target.error);this.S.reject(new Oh(e,o))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Oe(ti,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new zP(t)}}class na{static delete(e){return Oe(ti,"Removing database:",e),El(dE().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!_E())return!1;if(na.F())return!0;const e=Js(),t=na.M(e),s=0<t&&t<10,o=wk(e),c=0<o&&o<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||s||c)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),s=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(s)}constructor(e,t,s){this.name=e,this.version=t,this.N=s,this.B=null,na.M(Js())===12.2&&Vs("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Oe(ti,"Opening database:",this.name),this.db=await new Promise(((t,s)=>{const o=indexedDB.open(this.name,this.version);o.onsuccess=c=>{const u=c.target.result;t(u)},o.onblocked=()=>{s(new Oh(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},o.onerror=c=>{const u=c.target.error;u.name==="VersionError"?s(new Ie(ce.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):u.name==="InvalidStateError"?s(new Ie(ce.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+u)):s(new Oh(e,u))},o.onupgradeneeded=c=>{Oe(ti,'Database "'+this.name+'" requires upgrade from version:',c.oldVersion);const u=c.target.result;this.N.k(u,o.transaction,c.oldVersion,this.version).next((()=>{Oe(ti,"Database upgrade to version "+this.version+" complete")}))}}))),this.K&&(this.db.onversionchange=t=>this.K(t)),this.db}q(e){this.K=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,s,o){const c=t==="readonly";let u=0;for(;;){++u;try{this.db=await this.L(e);const d=op.open(this.db,e,c?"readonly":"readwrite",s),p=o(d).next((g=>(d.C(),g))).catch((g=>(d.abort(g),re.reject(g)))).toPromise();return p.catch((()=>{})),await d.D,p}catch(d){const p=d,g=p.name!=="FirebaseError"&&u<3;if(Oe(ti,"Transaction failed with error:",p.message,"Retrying:",g),this.close(),!g)return Promise.reject(p)}}}close(){this.db&&this.db.close(),this.db=void 0}}function wk(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class FP{constructor(e){this.U=e,this.$=!1,this.W=null}get isDone(){return this.$}get G(){return this.W}set cursor(e){this.U=e}done(){this.$=!0}j(e){this.W=e}delete(){return El(this.U.delete())}}class Oh extends Ie{constructor(e,t){super(ce.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Qo(n){return n.name==="IndexedDbTransactionError"}class zP{constructor(e){this.store=e}put(e,t){let s;return t!==void 0?(Oe(ti,"PUT",this.store.name,e,t),s=this.store.put(t,e)):(Oe(ti,"PUT",this.store.name,"<auto-key>",e),s=this.store.put(e)),El(s)}add(e){return Oe(ti,"ADD",this.store.name,e,e),El(this.store.add(e))}get(e){return El(this.store.get(e)).next((t=>(t===void 0&&(t=null),Oe(ti,"GET",this.store.name,e,t),t)))}delete(e){return Oe(ti,"DELETE",this.store.name,e),El(this.store.delete(e))}count(){return Oe(ti,"COUNT",this.store.name),El(this.store.count())}H(e,t){const s=this.options(e,t),o=s.index?this.store.index(s.index):this.store;if(typeof o.getAll=="function"){const c=o.getAll(s.range);return new re(((u,d)=>{c.onerror=p=>{d(p.target.error)},c.onsuccess=p=>{u(p.target.result)}}))}{const c=this.cursor(s),u=[];return this.J(c,((d,p)=>{u.push(p)})).next((()=>u))}}Z(e,t){const s=this.store.getAll(e,t===null?void 0:t);return new re(((o,c)=>{s.onerror=u=>{c(u.target.error)},s.onsuccess=u=>{o(u.target.result)}}))}X(e,t){Oe(ti,"DELETE ALL",this.store.name);const s=this.options(e,t);s.Y=!1;const o=this.cursor(s);return this.J(o,((c,u,d)=>d.delete()))}ee(e,t){let s;t?s=e:(s={},t=e);const o=this.cursor(s);return this.J(o,t)}te(e){const t=this.cursor({});return new re(((s,o)=>{t.onerror=c=>{const u=Av(c.target.error);o(u)},t.onsuccess=c=>{const u=c.target.result;u?e(u.primaryKey,u.value).next((d=>{d?u.continue():s()})):s()}}))}J(e,t){const s=[];return new re(((o,c)=>{e.onerror=u=>{c(u.target.error)},e.onsuccess=u=>{const d=u.target.result;if(!d)return void o();const p=new FP(d),g=t(d.primaryKey,d.value,p);if(g instanceof re){const b=g.catch((x=>(p.done(),re.reject(x))));s.push(b)}p.isDone?o():p.G===null?d.continue():d.continue(p.G)}})).next((()=>re.waitFor(s)))}options(e,t){let s;return e!==void 0&&(typeof e=="string"?s=e:t=e),{index:s,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const s=this.store.index(e.index);return e.Y?s.openKeyCursor(e.range,t):s.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function El(n){return new re(((e,t)=>{n.onsuccess=s=>{const o=s.target.result;e(o)},n.onerror=s=>{const o=Av(s.target.error);t(o)}}))}let c2=!1;function Av(n){const e=na.M(Js());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const s=new Ie("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return c2||(c2=!0,setTimeout((()=>{throw s}),0)),s}}return n}const Bh="IndexBackfiller";class qP{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Oe(Bh,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Oe(Bh,`Documents written: ${t}`)}catch(t){Qo(t)?Oe(Bh,"Ignoring IndexedDB error during index backfill: ",t):await Ko(t)}await this.re(6e4)}))}}class $P{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const s=new Set;let o=t,c=!0;return re.doWhile((()=>c===!0&&o>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((u=>{if(u!==null&&!s.has(u))return Oe(Bh,`Processing collection: ${u}`),this.oe(e,u,o).next((d=>{o-=d,s.add(u)}));c=!1})))).next((()=>t-o))}oe(e,t,s){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((o=>this.localStore.localDocuments.getNextDocuments(e,t,o,s).next((c=>{const u=c.changes;return this.localStore.indexManager.updateIndexEntries(e,u).next((()=>this._e(o,c))).next((d=>(Oe(Bh,`Updating offset: ${d}`),this.localStore.indexManager.updateCollectionGroup(e,t,d)))).next((()=>u.size))}))))}_e(e,t){let s=e;return t.changes.forEach(((o,c)=>{const u=vk(c);Nv(u,s)>0&&(s=u)})),new ai(s.readTime,s.documentKey,Math.max(t.batchId,e.largestBatchId))}}class qr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>t.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}qr.ce=-1;const Oo=-1;function xd(n){return n==null}function Zh(n){return n===0&&1/n==-1/0}function Tk(n){return typeof n=="number"&&Number.isInteger(n)&&!Zh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const Mm="";function Tr(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=u2(e)),e=HP(n.get(t),e);return u2(e)}function HP(n,e){let t=e;const s=n.length;for(let o=0;o<s;o++){const c=n.charAt(o);switch(c){case"\0":t+="";break;case Mm:t+="";break;default:t+=c}}return t}function u2(n){return n+Mm+""}function Yi(n){const e=n.length;if(pt(e>=2,64408,{path:n}),e===2)return pt(n.charAt(0)===Mm&&n.charAt(1)==="",56145,{path:n}),fn.emptyPath();const t=e-2,s=[];let o="";for(let c=0;c<e;){const u=n.indexOf(Mm,c);switch((u<0||u>t)&&lt(50515,{path:n}),n.charAt(u+1)){case"":const d=n.substring(c,u);let p;o.length===0?p=d:(o+=d,p=o,o=""),s.push(p);break;case"":o+=n.substring(c,u),o+="\0";break;case"":o+=n.substring(c,u+1);break;default:lt(61167,{path:n})}c=u+2}return new fn(s)}const Tl="remoteDocuments",_d="owner",Dc="owner",ed="mutationQueues",WP="userId",Di="mutations",h2="batchId",Nl="userMutationsIndex",d2=["userId","batchId"];function mm(n,e){return[n,Tr(e)]}function Ek(n,e,t){return[n,Tr(e),t]}const GP={},su="documentMutations",Lm="remoteDocumentsV14",KP=["prefixPath","collectionGroup","readTime","documentId"],pm="documentKeyIndex",QP=["prefixPath","collectionGroup","documentId"],kk="collectionGroupIndex",YP=["collectionGroup","readTime","prefixPath","documentId"],td="remoteDocumentGlobal",Ib="remoteDocumentGlobalKey",ru="targets",Sk="queryTargetsIndex",XP=["canonicalId","targetId"],iu="targetDocuments",JP=["targetId","path"],Rv="documentTargetsIndex",ZP=["path","targetId"],Vm="targetGlobalKey",Cl="targetGlobal",nd="collectionParents",eM=["collectionId","parent"],au="clientMetadata",tM="clientId",lp="bundles",nM="bundleId",cp="namedQueries",sM="name",Cv="indexConfiguration",rM="indexId",Db="collectionGroupIndex",iM="collectionGroup",Uh="indexState",aM=["indexId","uid"],jk="sequenceNumberIndex",oM=["uid","sequenceNumber"],Fh="indexEntries",lM=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Nk="documentKeyIndex",cM=["indexId","uid","orderedDocumentKey"],up="documentOverlays",uM=["userId","collectionPath","documentId"],Pb="collectionPathOverlayIndex",hM=["userId","collectionPath","largestBatchId"],Ak="collectionGroupOverlayIndex",dM=["userId","collectionGroup","largestBatchId"],Iv="globals",fM="name",Rk=[ed,Di,su,Tl,ru,_d,Cl,iu,au,td,nd,lp,cp],mM=[...Rk,up],Ck=[ed,Di,su,Lm,ru,_d,Cl,iu,au,td,nd,lp,cp,up],Ik=Ck,Dv=[...Ik,Cv,Uh,Fh],pM=Dv,Dk=[...Dv,Iv],gM=Dk;class Mb extends _k{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Zs(n,e){const t=Ze(n);return na.O(t.le,e)}function f2(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Yo(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Pk(n,e){const t=[];for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&t.push(e(n[s],s,n));return t}function Mk(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class as{constructor(e,t){this.comparator=e,this.root=t||pr.EMPTY}insert(e,t){return new as(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,pr.BLACK,null,null))}remove(e){return new as(this.comparator,this.root.remove(e,this.comparator).copy(null,null,pr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const o=this.comparator(e,s.key);if(o===0)return t+s.left.size;o<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,s)=>(e(t,s),!1)))}toString(){const e=[];return this.inorderTraversal(((t,s)=>(e.push(`${t}:${s}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Wf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Wf(this.root,e,this.comparator,!1)}getReverseIterator(){return new Wf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Wf(this.root,e,this.comparator,!0)}}class Wf{constructor(e,t,s,o){this.isReverse=o,this.nodeStack=[];let c=1;for(;!e.isEmpty();)if(c=t?s(e.key,t):1,t&&o&&(c*=-1),c<0)e=this.isReverse?e.left:e.right;else{if(c===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class pr{constructor(e,t,s,o,c){this.key=e,this.value=t,this.color=s??pr.RED,this.left=o??pr.EMPTY,this.right=c??pr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,o,c){return new pr(e??this.key,t??this.value,s??this.color,o??this.left,c??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let o=this;const c=s(e,o.key);return o=c<0?o.copy(null,null,null,o.left.insert(e,t,s),null):c===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,s)),o.fixUp()}removeMin(){if(this.left.isEmpty())return pr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return pr.EMPTY;s=o.right.min(),o=o.copy(s.key,s.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,pr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,pr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw lt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw lt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw lt(27949);return e+(this.isRed()?0:1)}}pr.EMPTY=null,pr.RED=!0,pr.BLACK=!1;pr.EMPTY=new class{constructor(){this.size=0}get key(){throw lt(57766)}get value(){throw lt(16141)}get color(){throw lt(16727)}get left(){throw lt(29726)}get right(){throw lt(36894)}copy(e,t,s,o,c){return this}insert(e,t,s){return new pr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Qn{constructor(e){this.comparator=e,this.data=new as(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,s)=>(e(t),!1)))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const o=s.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new m2(this.data.getIterator())}getIteratorFrom(e){return new m2(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((s=>{t=t.add(s)})),t}isEqual(e){if(!(e instanceof Qn)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=s.getNext().key;if(this.comparator(o,c)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Qn(this.comparator);return t.data=e,t}}class m2{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Pc(n){return n.hasNext()?n.getNext():void 0}class $r{constructor(e){this.fields=e,e.sort(ys.comparator)}static empty(){return new $r([])}unionWith(e){let t=new Qn(ys.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new $r(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Zc(this.fields,e.fields,((t,s)=>t.isEqual(s)))}}class Lk extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}function VO(){return typeof atob<"u"}class As{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(o){try{return atob(o)}catch(c){throw typeof DOMException<"u"&&c instanceof DOMException?new Lk("Invalid base64 string: "+c):c}})(e);return new As(t)}static fromUint8Array(e){const t=(function(o){let c="";for(let u=0;u<o.length;++u)c+=String.fromCharCode(o[u]);return c})(e);return new As(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const s=new Uint8Array(t.length);for(let o=0;o<t.length;o++)s[o]=t.charCodeAt(o);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ft(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}As.EMPTY_BYTE_STRING=new As("");const yM=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function La(n){if(pt(!!n,39018),typeof n=="string"){let e=0;const t=yM.exec(n);if(pt(!!t,46558,{timestamp:n}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:gs(n.seconds),nanos:gs(n.nanos)}}function gs(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Va(n){return typeof n=="string"?As.fromBase64String(n):As.fromUint8Array(n)}const Vk="server_timestamp",Ok="__type__",Bk="__previous_value__",Uk="__local_write_time__";function hp(n){return(n?.mapValue?.fields||{})[Ok]?.stringValue===Vk}function dp(n){const e=n.mapValue.fields[Bk];return hp(e)?dp(e):e}function sd(n){const e=La(n.mapValue.fields[Uk].timestampValue);return new mt(e.seconds,e.nanos)}class bM{constructor(e,t,s,o,c,u,d,p,g,b,x){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=o,this.ssl=c,this.forceLongPolling=u,this.autoDetectLongPolling=d,this.longPollingOptions=p,this.useFetchStreams=g,this.isUsingEmulator=b,this.apiKey=x}}const rd="(default)";class Ol{constructor(e,t){this.projectId=e,this.database=t||rd}static empty(){return new Ol("","")}get isDefaultDatabase(){return this.database===rd}isEqual(e){return e instanceof Ol&&e.projectId===this.projectId&&e.database===this.database}}function vM(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new Ie(ce.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ol(n.options.projectId,e)}const Pv="__type__",Fk="__max__",Ro={mapValue:{fields:{__type__:{stringValue:Fk}}}},Mv="__vector__",ou="value",gm={nullValue:"NULL_VALUE"};function Fo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?hp(n)?4:zk(n)?9007199254740991:fp(n)?10:11:lt(28295,{value:n})}function aa(n,e){if(n===e)return!0;const t=Fo(n);if(t!==Fo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return sd(n).isEqual(sd(e));case 3:return(function(o,c){if(typeof o.timestampValue=="string"&&typeof c.timestampValue=="string"&&o.timestampValue.length===c.timestampValue.length)return o.timestampValue===c.timestampValue;const u=La(o.timestampValue),d=La(c.timestampValue);return u.seconds===d.seconds&&u.nanos===d.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(o,c){return Va(o.bytesValue).isEqual(Va(c.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(o,c){return gs(o.geoPointValue.latitude)===gs(c.geoPointValue.latitude)&&gs(o.geoPointValue.longitude)===gs(c.geoPointValue.longitude)})(n,e);case 2:return(function(o,c){if("integerValue"in o&&"integerValue"in c)return gs(o.integerValue)===gs(c.integerValue);if("doubleValue"in o&&"doubleValue"in c){const u=gs(o.doubleValue),d=gs(c.doubleValue);return u===d?Zh(u)===Zh(d):isNaN(u)&&isNaN(d)}return!1})(n,e);case 9:return Zc(n.arrayValue.values||[],e.arrayValue.values||[],aa);case 10:case 11:return(function(o,c){const u=o.mapValue.fields||{},d=c.mapValue.fields||{};if(f2(u)!==f2(d))return!1;for(const p in u)if(u.hasOwnProperty(p)&&(d[p]===void 0||!aa(u[p],d[p])))return!1;return!0})(n,e);default:return lt(52216,{left:n})}}function id(n,e){return(n.values||[]).find((t=>aa(t,e)))!==void 0}function zo(n,e){if(n===e)return 0;const t=Fo(n),s=Fo(e);if(t!==s)return Ft(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ft(n.booleanValue,e.booleanValue);case 2:return(function(c,u){const d=gs(c.integerValue||c.doubleValue),p=gs(u.integerValue||u.doubleValue);return d<p?-1:d>p?1:d===p?0:isNaN(d)?isNaN(p)?0:-1:1})(n,e);case 3:return p2(n.timestampValue,e.timestampValue);case 4:return p2(sd(n),sd(e));case 5:return Ab(n.stringValue,e.stringValue);case 6:return(function(c,u){const d=Va(c),p=Va(u);return d.compareTo(p)})(n.bytesValue,e.bytesValue);case 7:return(function(c,u){const d=c.split("/"),p=u.split("/");for(let g=0;g<d.length&&g<p.length;g++){const b=Ft(d[g],p[g]);if(b!==0)return b}return Ft(d.length,p.length)})(n.referenceValue,e.referenceValue);case 8:return(function(c,u){const d=Ft(gs(c.latitude),gs(u.latitude));return d!==0?d:Ft(gs(c.longitude),gs(u.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return g2(n.arrayValue,e.arrayValue);case 10:return(function(c,u){const d=c.fields||{},p=u.fields||{},g=d[ou]?.arrayValue,b=p[ou]?.arrayValue,x=Ft(g?.values?.length||0,b?.values?.length||0);return x!==0?x:g2(g,b)})(n.mapValue,e.mapValue);case 11:return(function(c,u){if(c===Ro.mapValue&&u===Ro.mapValue)return 0;if(c===Ro.mapValue)return 1;if(u===Ro.mapValue)return-1;const d=c.fields||{},p=Object.keys(d),g=u.fields||{},b=Object.keys(g);p.sort(),b.sort();for(let x=0;x<p.length&&x<b.length;++x){const T=Ab(p[x],b[x]);if(T!==0)return T;const N=zo(d[p[x]],g[b[x]]);if(N!==0)return N}return Ft(p.length,b.length)})(n.mapValue,e.mapValue);default:throw lt(23264,{he:t})}}function p2(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Ft(n,e);const t=La(n),s=La(e),o=Ft(t.seconds,s.seconds);return o!==0?o:Ft(t.nanos,s.nanos)}function g2(n,e){const t=n.values||[],s=e.values||[];for(let o=0;o<t.length&&o<s.length;++o){const c=zo(t[o],s[o]);if(c)return c}return Ft(t.length,s.length)}function lu(n){return Lb(n)}function Lb(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const s=La(t);return`time(${s.seconds},${s.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Va(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Je.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let s="[",o=!0;for(const c of t.values||[])o?o=!1:s+=",",s+=Lb(c);return s+"]"})(n.arrayValue):"mapValue"in n?(function(t){const s=Object.keys(t.fields||{}).sort();let o="{",c=!0;for(const u of s)c?c=!1:o+=",",o+=`${u}:${Lb(t.fields[u])}`;return o+"}"})(n.mapValue):lt(61005,{value:n})}function ym(n){switch(Fo(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=dp(n);return e?16+ym(e):16;case 5:return 2*n.stringValue.length;case 6:return Va(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((o,c)=>o+ym(c)),0)})(n.arrayValue);case 10:case 11:return(function(s){let o=0;return Yo(s.fields,((c,u)=>{o+=c.length+ym(u)})),o})(n.mapValue);default:throw lt(13486,{value:n})}}function Bl(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Vb(n){return!!n&&"integerValue"in n}function ad(n){return!!n&&"arrayValue"in n}function y2(n){return!!n&&"nullValue"in n}function b2(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function bm(n){return!!n&&"mapValue"in n}function fp(n){return(n?.mapValue?.fields||{})[Pv]?.stringValue===Mv}function zh(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Yo(n.mapValue.fields,((t,s)=>e.mapValue.fields[t]=zh(s))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=zh(n.arrayValue.values[t]);return e}return{...n}}function zk(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Fk}const qk={mapValue:{fields:{[Pv]:{stringValue:Mv},[ou]:{arrayValue:{}}}}};function xM(n){return"nullValue"in n?gm:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Bl(Ol.empty(),Je.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?fp(n)?qk:{mapValue:{}}:lt(35942,{value:n})}function _M(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Bl(Ol.empty(),Je.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?qk:"mapValue"in n?fp(n)?{mapValue:{}}:Ro:lt(61959,{value:n})}function v2(n,e){const t=zo(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function x2(n,e){const t=zo(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class ir{constructor(e){this.value=e}static empty(){return new ir({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!bm(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=zh(t)}setAll(e){let t=ys.emptyPath(),s={},o=[];e.forEach(((u,d)=>{if(!t.isImmediateParentOf(d)){const p=this.getFieldsMap(t);this.applyChanges(p,s,o),s={},o=[],t=d.popLast()}u?s[d.lastSegment()]=zh(u):o.push(d.lastSegment())}));const c=this.getFieldsMap(t);this.applyChanges(c,s,o)}delete(e){const t=this.field(e.popLast());bm(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return aa(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let o=t.mapValue.fields[e.get(s)];bm(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,s){Yo(t,((o,c)=>e[o]=c));for(const o of s)delete e[o]}clone(){return new ir(zh(this.value))}}function $k(n){const e=[];return Yo(n.fields,((t,s)=>{const o=new ys([t]);if(bm(s)){const c=$k(s.mapValue).fields;if(c.length===0)e.push(o);else for(const u of c)e.push(o.child(u))}else e.push(o)})),new $r(e)}class hs{constructor(e,t,s,o,c,u,d){this.key=e,this.documentType=t,this.version=s,this.readTime=o,this.createTime=c,this.data=u,this.documentState=d}static newInvalidDocument(e){return new hs(e,0,wt.min(),wt.min(),wt.min(),ir.empty(),0)}static newFoundDocument(e,t,s,o){return new hs(e,1,t,wt.min(),s,o,0)}static newNoDocument(e,t){return new hs(e,2,t,wt.min(),wt.min(),ir.empty(),0)}static newUnknownDocument(e,t){return new hs(e,3,t,wt.min(),wt.min(),ir.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(wt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ir.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ir.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=wt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof hs&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new hs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class qo{constructor(e,t){this.position=e,this.inclusive=t}}function _2(n,e,t){let s=0;for(let o=0;o<n.position.length;o++){const c=e[o],u=n.position[o];if(c.field.isKeyField()?s=Je.comparator(Je.fromName(u.referenceValue),t.key):s=zo(u,t.data.field(c.field)),c.dir==="desc"&&(s*=-1),s!==0)break}return s}function w2(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!aa(n.position[t],e.position[t]))return!1;return!0}class od{constructor(e,t="asc"){this.field=e,this.dir=t}}function wM(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class Hk{}class Tn extends Hk{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new TM(e,t,s):t==="array-contains"?new SM(e,s):t==="in"?new Xk(e,s):t==="not-in"?new jM(e,s):t==="array-contains-any"?new NM(e,s):new Tn(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new EM(e,s):new kM(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(zo(t,this.value)):t!==null&&Fo(this.value)===Fo(t)&&this.matchesComparison(zo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return lt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Kn extends Hk{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Kn(e,t)}matches(e){return cu(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function cu(n){return n.op==="and"}function Ob(n){return n.op==="or"}function Lv(n){return Wk(n)&&cu(n)}function Wk(n){for(const e of n.filters)if(e instanceof Kn)return!1;return!0}function Bb(n){if(n instanceof Tn)return n.field.canonicalString()+n.op.toString()+lu(n.value);if(Lv(n))return n.filters.map((e=>Bb(e))).join(",");{const e=n.filters.map((t=>Bb(t))).join(",");return`${n.op}(${e})`}}function Gk(n,e){return n instanceof Tn?(function(s,o){return o instanceof Tn&&s.op===o.op&&s.field.isEqual(o.field)&&aa(s.value,o.value)})(n,e):n instanceof Kn?(function(s,o){return o instanceof Kn&&s.op===o.op&&s.filters.length===o.filters.length?s.filters.reduce(((c,u,d)=>c&&Gk(u,o.filters[d])),!0):!1})(n,e):void lt(19439)}function Kk(n,e){const t=n.filters.concat(e);return Kn.create(t,n.op)}function Qk(n){return n instanceof Tn?(function(t){return`${t.field.canonicalString()} ${t.op} ${lu(t.value)}`})(n):n instanceof Kn?(function(t){return t.op.toString()+" {"+t.getFilters().map(Qk).join(" ,")+"}"})(n):"Filter"}class TM extends Tn{constructor(e,t,s){super(e,t,s),this.key=Je.fromName(s.referenceValue)}matches(e){const t=Je.comparator(e.key,this.key);return this.matchesComparison(t)}}class EM extends Tn{constructor(e,t){super(e,"in",t),this.keys=Yk("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class kM extends Tn{constructor(e,t){super(e,"not-in",t),this.keys=Yk("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Yk(n,e){return(e.arrayValue?.values||[]).map((t=>Je.fromName(t.referenceValue)))}class SM extends Tn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ad(t)&&id(t.arrayValue,this.value)}}class Xk extends Tn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&id(this.value.arrayValue,t)}}class jM extends Tn{constructor(e,t){super(e,"not-in",t)}matches(e){if(id(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!id(this.value.arrayValue,t)}}class NM extends Tn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ad(t)||!t.arrayValue.values)&&t.arrayValue.values.some((s=>id(this.value.arrayValue,s)))}}class AM{constructor(e,t=null,s=[],o=[],c=null,u=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=o,this.limit=c,this.startAt=u,this.endAt=d,this.Te=null}}function Ub(n,e=null,t=[],s=[],o=null,c=null,u=null){return new AM(n,e,t,s,o,c,u)}function Ul(n){const e=Ze(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((s=>Bb(s))).join(","),t+="|ob:",t+=e.orderBy.map((s=>(function(c){return c.field.canonicalString()+c.dir})(s))).join(","),xd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((s=>lu(s))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((s=>lu(s))).join(",")),e.Te=t}return e.Te}function wd(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!wM(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Gk(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!w2(n.startAt,e.startAt)&&w2(n.endAt,e.endAt)}function Om(n){return Je.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Bm(n,e){return n.filters.filter((t=>t instanceof Tn&&t.field.isEqual(e)))}function T2(n,e,t){let s=gm,o=!0;for(const c of Bm(n,e)){let u=gm,d=!0;switch(c.op){case"<":case"<=":u=xM(c.value);break;case"==":case"in":case">=":u=c.value;break;case">":u=c.value,d=!1;break;case"!=":case"not-in":u=gm}v2({value:s,inclusive:o},{value:u,inclusive:d})<0&&(s=u,o=d)}if(t!==null){for(let c=0;c<n.orderBy.length;++c)if(n.orderBy[c].field.isEqual(e)){const u=t.position[c];v2({value:s,inclusive:o},{value:u,inclusive:t.inclusive})<0&&(s=u,o=t.inclusive);break}}return{value:s,inclusive:o}}function E2(n,e,t){let s=Ro,o=!0;for(const c of Bm(n,e)){let u=Ro,d=!0;switch(c.op){case">=":case">":u=_M(c.value),d=!1;break;case"==":case"in":case"<=":u=c.value;break;case"<":u=c.value,d=!1;break;case"!=":case"not-in":u=Ro}x2({value:s,inclusive:o},{value:u,inclusive:d})>0&&(s=u,o=d)}if(t!==null){for(let c=0;c<n.orderBy.length;++c)if(n.orderBy[c].field.isEqual(e)){const u=t.position[c];x2({value:s,inclusive:o},{value:u,inclusive:t.inclusive})>0&&(s=u,o=t.inclusive);break}}return{value:s,inclusive:o}}class za{constructor(e,t=null,s=[],o=[],c=null,u="F",d=null,p=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=o,this.limit=c,this.limitType=u,this.startAt=d,this.endAt=p,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function Jk(n,e,t,s,o,c,u,d){return new za(n,e,t,s,o,c,u,d)}function ku(n){return new za(n)}function k2(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function RM(n){return Je.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Vv(n){return n.collectionGroup!==null}function Yc(n){const e=Ze(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const c of e.explicitOrderBy)e.Ie.push(c),t.add(c.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let d=new Qn(ys.comparator);return u.filters.forEach((p=>{p.getFlattenedFilters().forEach((g=>{g.isInequality()&&(d=d.add(g.field))}))})),d})(e).forEach((c=>{t.has(c.canonicalString())||c.isKeyField()||e.Ie.push(new od(c,s))})),t.has(ys.keyField().canonicalString())||e.Ie.push(new od(ys.keyField(),s))}return e.Ie}function Er(n){const e=Ze(n);return e.Ee||(e.Ee=eS(e,Yc(n))),e.Ee}function Zk(n){const e=Ze(n);return e.Re||(e.Re=eS(e,n.explicitOrderBy)),e.Re}function eS(n,e){if(n.limitType==="F")return Ub(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((o=>{const c=o.dir==="desc"?"asc":"desc";return new od(o.field,c)}));const t=n.endAt?new qo(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new qo(n.startAt.position,n.startAt.inclusive):null;return Ub(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function Fb(n,e){const t=n.filters.concat([e]);return new za(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function CM(n,e){const t=n.explicitOrderBy.concat([e]);return new za(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function Um(n,e,t){return new za(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function IM(n,e){return new za(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,e,n.endAt)}function DM(n,e){return new za(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,n.startAt,e)}function Td(n,e){return wd(Er(n),Er(e))&&n.limitType===e.limitType}function tS(n){return`${Ul(Er(n))}|lt:${n.limitType}`}function qc(n){return`Query(target=${(function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map((o=>Qk(o))).join(", ")}]`),xd(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map((o=>(function(u){return`${u.field.canonicalString()} (${u.dir})`})(o))).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map((o=>lu(o))).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map((o=>lu(o))).join(",")),`Target(${s})`})(Er(n))}; limitType=${n.limitType})`}function Ed(n,e){return e.isFoundDocument()&&(function(s,o){const c=o.key.path;return s.collectionGroup!==null?o.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(c):Je.isDocumentKey(s.path)?s.path.isEqual(c):s.path.isImmediateParentOf(c)})(n,e)&&(function(s,o){for(const c of Yc(s))if(!c.field.isKeyField()&&o.data.field(c.field)===null)return!1;return!0})(n,e)&&(function(s,o){for(const c of s.filters)if(!c.matches(o))return!1;return!0})(n,e)&&(function(s,o){return!(s.startAt&&!(function(u,d,p){const g=_2(u,d,p);return u.inclusive?g<=0:g<0})(s.startAt,Yc(s),o)||s.endAt&&!(function(u,d,p){const g=_2(u,d,p);return u.inclusive?g>=0:g>0})(s.endAt,Yc(s),o))})(n,e)}function nS(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function sS(n){return(e,t)=>{let s=!1;for(const o of Yc(n)){const c=PM(o,e,t);if(c!==0)return c;s=s||o.field.isKeyField()}return 0}}function PM(n,e,t){const s=n.field.isKeyField()?Je.comparator(e.key,t.key):(function(c,u,d){const p=u.data.field(c),g=d.data.field(c);return p!==null&&g!==null?zo(p,g):lt(42886)})(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return lt(19790,{direction:n.dir})}}class qa{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[o,c]of s)if(this.equalsFn(o,e))return c}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),o=this.inner[s];if(o===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let c=0;c<o.length;c++)if(this.equalsFn(o[c][0],e))return void(o[c]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],e))return s.length===1?delete this.inner[t]:s.splice(o,1),this.innerSize--,!0;return!1}forEach(e){Yo(this.inner,((t,s)=>{for(const[o,c]of s)e(o,c)}))}isEmpty(){return Mk(this.inner)}size(){return this.innerSize}}const MM=new as(Je.comparator);function Hr(){return MM}const rS=new as(Je.comparator);function Dh(...n){let e=rS;for(const t of n)e=e.insert(t.key,t);return e}function iS(n){let e=rS;return n.forEach(((t,s)=>e=e.insert(t,s.overlayedDocument))),e}function Xi(){return qh()}function aS(){return qh()}function qh(){return new qa((n=>n.toString()),((n,e)=>n.isEqual(e)))}const LM=new as(Je.comparator),VM=new Qn(Je.comparator);function Zt(...n){let e=VM;for(const t of n)e=e.add(t);return e}const OM=new Qn(Ft);function Ov(){return OM}function Bv(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Zh(e)?"-0":e}}function oS(n){return{integerValue:""+n}}function lS(n,e){return Tk(e)?oS(e):Bv(n,e)}class mp{constructor(){this._=void 0}}function BM(n,e,t){return n instanceof uu?(function(o,c){const u={fields:{[Ok]:{stringValue:Vk},[Uk]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return c&&hp(c)&&(c=dp(c)),c&&(u.fields[Bk]=c),{mapValue:u}})(t,e):n instanceof Fl?uS(n,e):n instanceof zl?hS(n,e):(function(o,c){const u=cS(o,c),d=S2(u)+S2(o.Ae);return Vb(u)&&Vb(o.Ae)?oS(d):Bv(o.serializer,d)})(n,e)}function UM(n,e,t){return n instanceof Fl?uS(n,e):n instanceof zl?hS(n,e):t}function cS(n,e){return n instanceof hu?(function(s){return Vb(s)||(function(c){return!!c&&"doubleValue"in c})(s)})(e)?e:{integerValue:0}:null}class uu extends mp{}class Fl extends mp{constructor(e){super(),this.elements=e}}function uS(n,e){const t=dS(e);for(const s of n.elements)t.some((o=>aa(o,s)))||t.push(s);return{arrayValue:{values:t}}}class zl extends mp{constructor(e){super(),this.elements=e}}function hS(n,e){let t=dS(e);for(const s of n.elements)t=t.filter((o=>!aa(o,s)));return{arrayValue:{values:t}}}class hu extends mp{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function S2(n){return gs(n.integerValue||n.doubleValue)}function dS(n){return ad(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class kd{constructor(e,t){this.field=e,this.transform=t}}function FM(n,e){return n.field.isEqual(e.field)&&(function(s,o){return s instanceof Fl&&o instanceof Fl||s instanceof zl&&o instanceof zl?Zc(s.elements,o.elements,aa):s instanceof hu&&o instanceof hu?aa(s.Ae,o.Ae):s instanceof uu&&o instanceof uu})(n.transform,e.transform)}class zM{constructor(e,t){this.version=e,this.transformResults=t}}class bs{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new bs}static exists(e){return new bs(void 0,e)}static updateTime(e){return new bs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function vm(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class pp{}function fS(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new ju(n.key,bs.none()):new Su(n.key,n.data,bs.none());{const t=n.data,s=ir.empty();let o=new Qn(ys.comparator);for(let c of e.fields)if(!o.has(c)){let u=t.field(c);u===null&&c.length>1&&(c=c.popLast(),u=t.field(c)),u===null?s.delete(c):s.set(c,u),o=o.add(c)}return new $a(n.key,s,new $r(o.toArray()),bs.none())}}function qM(n,e,t){n instanceof Su?(function(o,c,u){const d=o.value.clone(),p=N2(o.fieldTransforms,c,u.transformResults);d.setAll(p),c.convertToFoundDocument(u.version,d).setHasCommittedMutations()})(n,e,t):n instanceof $a?(function(o,c,u){if(!vm(o.precondition,c))return void c.convertToUnknownDocument(u.version);const d=N2(o.fieldTransforms,c,u.transformResults),p=c.data;p.setAll(mS(o)),p.setAll(d),c.convertToFoundDocument(u.version,p).setHasCommittedMutations()})(n,e,t):(function(o,c,u){c.convertToNoDocument(u.version).setHasCommittedMutations()})(0,e,t)}function $h(n,e,t,s){return n instanceof Su?(function(c,u,d,p){if(!vm(c.precondition,u))return d;const g=c.value.clone(),b=A2(c.fieldTransforms,p,u);return g.setAll(b),u.convertToFoundDocument(u.version,g).setHasLocalMutations(),null})(n,e,t,s):n instanceof $a?(function(c,u,d,p){if(!vm(c.precondition,u))return d;const g=A2(c.fieldTransforms,p,u),b=u.data;return b.setAll(mS(c)),b.setAll(g),u.convertToFoundDocument(u.version,b).setHasLocalMutations(),d===null?null:d.unionWith(c.fieldMask.fields).unionWith(c.fieldTransforms.map((x=>x.field)))})(n,e,t,s):(function(c,u,d){return vm(c.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):d})(n,e,t)}function $M(n,e){let t=null;for(const s of n.fieldTransforms){const o=e.data.field(s.field),c=cS(s.transform,o||null);c!=null&&(t===null&&(t=ir.empty()),t.set(s.field,c))}return t||null}function j2(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(s,o){return s===void 0&&o===void 0||!(!s||!o)&&Zc(s,o,((c,u)=>FM(c,u)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Su extends pp{constructor(e,t,s,o=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class $a extends pp{constructor(e,t,s,o,c=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=o,this.fieldTransforms=c,this.type=1}getFieldMask(){return this.fieldMask}}function mS(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}})),e}function N2(n,e,t){const s=new Map;pt(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let o=0;o<t.length;o++){const c=n[o],u=c.transform,d=e.data.field(c.field);s.set(c.field,UM(u,d,t[o]))}return s}function A2(n,e,t){const s=new Map;for(const o of n){const c=o.transform,u=t.data.field(o.field);s.set(o.field,BM(c,u,e))}return s}class ju extends pp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Uv extends pp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Fv{constructor(e,t,s,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=o}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const c=this.mutations[o];c.key.isEqual(e.key)&&qM(c,e,s[o])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=$h(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=$h(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=aS();return this.mutations.forEach((o=>{const c=e.get(o.key),u=c.overlayedDocument;let d=this.applyToLocalView(u,c.mutatedFields);d=t.has(o.key)?null:d;const p=fS(u,d);p!==null&&s.set(o.key,p),u.isValidDocument()||u.convertToNoDocument(wt.min())})),s}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Zt())}isEqual(e){return this.batchId===e.batchId&&Zc(this.mutations,e.mutations,((t,s)=>j2(t,s)))&&Zc(this.baseMutations,e.baseMutations,((t,s)=>j2(t,s)))}}class zv{constructor(e,t,s,o){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=o}static from(e,t,s){pt(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let o=(function(){return LM})();const c=e.mutations;for(let u=0;u<c.length;u++)o=o.insert(c[u].key,s[u].version);return new zv(e,t,s,o)}}class qv{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class pS{constructor(e,t,s){this.alias=e,this.aggregateType=t,this.fieldPath=s}}class HM{constructor(e,t){this.count=e,this.unchangedNames=t}}var Hs,An;function gS(n){switch(n){case ce.OK:return lt(64938);case ce.CANCELLED:case ce.UNKNOWN:case ce.DEADLINE_EXCEEDED:case ce.RESOURCE_EXHAUSTED:case ce.INTERNAL:case ce.UNAVAILABLE:case ce.UNAUTHENTICATED:return!1;case ce.INVALID_ARGUMENT:case ce.NOT_FOUND:case ce.ALREADY_EXISTS:case ce.PERMISSION_DENIED:case ce.FAILED_PRECONDITION:case ce.ABORTED:case ce.OUT_OF_RANGE:case ce.UNIMPLEMENTED:case ce.DATA_LOSS:return!0;default:return lt(15467,{code:n})}}function yS(n){if(n===void 0)return Vs("GRPC error has no .code"),ce.UNKNOWN;switch(n){case Hs.OK:return ce.OK;case Hs.CANCELLED:return ce.CANCELLED;case Hs.UNKNOWN:return ce.UNKNOWN;case Hs.DEADLINE_EXCEEDED:return ce.DEADLINE_EXCEEDED;case Hs.RESOURCE_EXHAUSTED:return ce.RESOURCE_EXHAUSTED;case Hs.INTERNAL:return ce.INTERNAL;case Hs.UNAVAILABLE:return ce.UNAVAILABLE;case Hs.UNAUTHENTICATED:return ce.UNAUTHENTICATED;case Hs.INVALID_ARGUMENT:return ce.INVALID_ARGUMENT;case Hs.NOT_FOUND:return ce.NOT_FOUND;case Hs.ALREADY_EXISTS:return ce.ALREADY_EXISTS;case Hs.PERMISSION_DENIED:return ce.PERMISSION_DENIED;case Hs.FAILED_PRECONDITION:return ce.FAILED_PRECONDITION;case Hs.ABORTED:return ce.ABORTED;case Hs.OUT_OF_RANGE:return ce.OUT_OF_RANGE;case Hs.UNIMPLEMENTED:return ce.UNIMPLEMENTED;case Hs.DATA_LOSS:return ce.DATA_LOSS;default:return lt(39323,{code:n})}}(An=Hs||(Hs={}))[An.OK=0]="OK",An[An.CANCELLED=1]="CANCELLED",An[An.UNKNOWN=2]="UNKNOWN",An[An.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",An[An.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",An[An.NOT_FOUND=5]="NOT_FOUND",An[An.ALREADY_EXISTS=6]="ALREADY_EXISTS",An[An.PERMISSION_DENIED=7]="PERMISSION_DENIED",An[An.UNAUTHENTICATED=16]="UNAUTHENTICATED",An[An.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",An[An.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",An[An.ABORTED=10]="ABORTED",An[An.OUT_OF_RANGE=11]="OUT_OF_RANGE",An[An.UNIMPLEMENTED=12]="UNIMPLEMENTED",An[An.INTERNAL=13]="INTERNAL",An[An.UNAVAILABLE=14]="UNAVAILABLE",An[An.DATA_LOSS=15]="DATA_LOSS";let zb=null;function WM(n){if(zb)throw new Error("a TestingHooksSpi instance is already set");zb=n}function bS(){return new TextEncoder}const GM=new Vo([4294967295,4294967295],0);function R2(n){const e=bS().encode(n),t=new ok;return t.update(e),new Uint8Array(t.digest())}function C2(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),o=e.getUint32(8,!0),c=e.getUint32(12,!0);return[new Vo([t,s],0),new Vo([o,c],0)]}class $v{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new Ph(`Invalid padding: ${t}`);if(s<0)throw new Ph(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new Ph(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new Ph(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Vo.fromNumber(this.ge)}ye(e,t,s){let o=e.add(t.multiply(Vo.fromNumber(s)));return o.compare(GM)===1&&(o=new Vo([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=R2(e),[s,o]=C2(t);for(let c=0;c<this.hashCount;c++){const u=this.ye(s,o,c);if(!this.we(u))return!1}return!0}static create(e,t,s){const o=e%8==0?0:8-e%8,c=new Uint8Array(Math.ceil(e/8)),u=new $v(c,o,t);return s.forEach((d=>u.insert(d))),u}insert(e){if(this.ge===0)return;const t=R2(e),[s,o]=C2(t);for(let c=0;c<this.hashCount;c++){const u=this.ye(s,o,c);this.be(u)}}be(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class Ph extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Sd{constructor(e,t,s,o,c){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=o,this.resolvedLimboDocuments=c}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const o=new Map;return o.set(e,jd.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new Sd(wt.min(),o,new as(Ft),Hr(),Zt())}}class jd{constructor(e,t,s,o,c){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=o,this.removedDocuments=c}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new jd(s,t,Zt(),Zt(),Zt())}}class xm{constructor(e,t,s,o){this.Se=e,this.removedTargetIds=t,this.key=s,this.De=o}}class vS{constructor(e,t){this.targetId=e,this.Ce=t}}class xS{constructor(e,t,s=As.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=o}}class I2{constructor(){this.ve=0,this.Fe=D2(),this.Me=As.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Zt(),t=Zt(),s=Zt();return this.Fe.forEach(((o,c)=>{switch(c){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:s=s.add(o);break;default:lt(38017,{changeType:c})}})),new jd(this.Me,this.xe,e,t,s)}Ke(){this.Oe=!1,this.Fe=D2()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,pt(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class KM{constructor(e){this.Ge=e,this.ze=new Map,this.je=Hr(),this.He=Gf(),this.Je=Gf(),this.Ze=new as(Ft)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const s=this.nt(t);switch(e.state){case 0:this.rt(t)&&s.Le(e.resumeToken);break;case 1:s.We(),s.Ne||s.Ke(),s.Le(e.resumeToken);break;case 2:s.We(),s.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(s.Qe(),s.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),s.Le(e.resumeToken));break;default:lt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((s,o)=>{this.rt(o)&&t(o)}))}st(e){const t=e.targetId,s=e.Ce.count,o=this.ot(t);if(o){const c=o.target;if(Om(c))if(s===0){const u=new Je(c.path);this.et(t,u,hs.newNoDocument(u,wt.min()))}else pt(s===1,20013,{expectedCount:s});else{const u=this._t(t);if(u!==s){const d=this.ut(e),p=d?this.ct(d,e,u):1;if(p!==0){this.it(t);const g=p===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,g)}zb?.lt((function(b,x,T,N,B){const M={localCacheCount:b,existenceFilterCount:x.count,databaseId:T.database,projectId:T.projectId},P=x.unchangedNames;return P&&(M.bloomFilter={applied:B===0,hashCount:P?.hashCount??0,bitmapLength:P?.bits?.bitmap?.length??0,padding:P?.bits?.padding??0,mightContain:Y=>N?.mightContain(Y)??!1}),M})(u,e.Ce,this.Ge.ht(),d,p))}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:o=0},hashCount:c=0}=t;let u,d;try{u=Va(s).toUint8Array()}catch(p){if(p instanceof Lk)return wi("Decoding the base64 bloom filter in existence filter failed ("+p.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw p}try{d=new $v(u,o,c)}catch(p){return wi(p instanceof Ph?"BloomFilter error: ":"Applying bloom filter failed: ",p),null}return d.ge===0?null:d}ct(e,t,s){return t.Ce.count===s-this.Pt(e,t.targetId)?0:2}Pt(e,t){const s=this.Ge.getRemoteKeysForTarget(t);let o=0;return s.forEach((c=>{const u=this.Ge.ht(),d=`projects/${u.projectId}/databases/${u.database}/documents/${c.path.canonicalString()}`;e.mightContain(d)||(this.et(t,c,null),o++)})),o}Tt(e){const t=new Map;this.ze.forEach(((c,u)=>{const d=this.ot(u);if(d){if(c.current&&Om(d.target)){const p=new Je(d.target.path);this.It(p).has(u)||this.Et(u,p)||this.et(u,p,hs.newNoDocument(p,e))}c.Be&&(t.set(u,c.ke()),c.Ke())}}));let s=Zt();this.Je.forEach(((c,u)=>{let d=!0;u.forEachWhile((p=>{const g=this.ot(p);return!g||g.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)})),d&&(s=s.add(c))})),this.je.forEach(((c,u)=>u.setReadTime(e)));const o=new Sd(e,t,this.Ze,this.je,s);return this.je=Hr(),this.He=Gf(),this.Je=Gf(),this.Ze=new as(Ft),o}Ye(e,t){if(!this.rt(e))return;const s=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,s),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,s){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,t)?o.qe(t,1):o.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),s&&(this.je=this.je.insert(t,s))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new I2,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Qn(Ft),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Qn(Ft),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Oe("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new I2),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Gf(){return new as(Je.comparator)}function D2(){return new as(Je.comparator)}const QM={asc:"ASCENDING",desc:"DESCENDING"},YM={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},XM={and:"AND",or:"OR"};class JM{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function qb(n,e){return n.useProto3Json||xd(e)?e:{value:e}}function du(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function _S(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function ZM(n,e){return du(n,e.toTimestamp())}function Os(n){return pt(!!n,49232),wt.fromTimestamp((function(t){const s=La(t);return new mt(s.seconds,s.nanos)})(n))}function Hv(n,e){return $b(n,e).canonicalString()}function $b(n,e){const t=(function(o){return new fn(["projects",o.projectId,"databases",o.database])})(n).child("documents");return e===void 0?t:t.child(e)}function wS(n){const e=fn.fromString(n);return pt(CS(e),10190,{key:e.toString()}),e}function ld(n,e){return Hv(n.databaseId,e.path)}function sa(n,e){const t=wS(e);if(t.get(1)!==n.databaseId.projectId)throw new Ie(ce.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ie(ce.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Je(kS(t))}function TS(n,e){return Hv(n.databaseId,e)}function ES(n){const e=wS(n);return e.length===4?fn.emptyPath():kS(e)}function Hb(n){return new fn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function kS(n){return pt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function P2(n,e,t){return{name:ld(n,e),fields:t.value.mapValue.fields}}function gp(n,e,t){const s=sa(n,e.name),o=Os(e.updateTime),c=e.createTime?Os(e.createTime):wt.min(),u=new ir({mapValue:{fields:e.fields}}),d=hs.newFoundDocument(s,o,c,u);return t&&d.setHasCommittedMutations(),t?d.setHasCommittedMutations():d}function e3(n,e){return"found"in e?(function(s,o){pt(!!o.found,43571),o.found.name,o.found.updateTime;const c=sa(s,o.found.name),u=Os(o.found.updateTime),d=o.found.createTime?Os(o.found.createTime):wt.min(),p=new ir({mapValue:{fields:o.found.fields}});return hs.newFoundDocument(c,u,d,p)})(n,e):"missing"in e?(function(s,o){pt(!!o.missing,3894),pt(!!o.readTime,22933);const c=sa(s,o.missing),u=Os(o.readTime);return hs.newNoDocument(c,u)})(n,e):lt(7234,{result:e})}function t3(n,e){let t;if("targetChange"in e){e.targetChange;const s=(function(g){return g==="NO_CHANGE"?0:g==="ADD"?1:g==="REMOVE"?2:g==="CURRENT"?3:g==="RESET"?4:lt(39313,{state:g})})(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],c=(function(g,b){return g.useProto3Json?(pt(b===void 0||typeof b=="string",58123),As.fromBase64String(b||"")):(pt(b===void 0||b instanceof Buffer||b instanceof Uint8Array,16193),As.fromUint8Array(b||new Uint8Array))})(n,e.targetChange.resumeToken),u=e.targetChange.cause,d=u&&(function(g){const b=g.code===void 0?ce.UNKNOWN:yS(g.code);return new Ie(b,g.message||"")})(u);t=new xS(s,o,c,d||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const o=sa(n,s.document.name),c=Os(s.document.updateTime),u=s.document.createTime?Os(s.document.createTime):wt.min(),d=new ir({mapValue:{fields:s.document.fields}}),p=hs.newFoundDocument(o,c,u,d),g=s.targetIds||[],b=s.removedTargetIds||[];t=new xm(g,b,p.key,p)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const o=sa(n,s.document),c=s.readTime?Os(s.readTime):wt.min(),u=hs.newNoDocument(o,c),d=s.removedTargetIds||[];t=new xm([],d,u.key,u)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const o=sa(n,s.document),c=s.removedTargetIds||[];t=new xm([],c,o,null)}else{if(!("filter"in e))return lt(11601,{Vt:e});{e.filter;const s=e.filter;s.targetId;const{count:o=0,unchangedNames:c}=s,u=new HM(o,c),d=s.targetId;t=new vS(d,u)}}return t}function cd(n,e){let t;if(e instanceof Su)t={update:P2(n,e.key,e.value)};else if(e instanceof ju)t={delete:ld(n,e.key)};else if(e instanceof $a)t={update:P2(n,e.key,e.data),updateMask:o3(e.fieldMask)};else{if(!(e instanceof Uv))return lt(16599,{dt:e.type});t={verify:ld(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((s=>(function(c,u){const d=u.transform;if(d instanceof uu)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof Fl)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof zl)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof hu)return{fieldPath:u.field.canonicalString(),increment:d.Ae};throw lt(20930,{transform:u.transform})})(0,s)))),e.precondition.isNone||(t.currentDocument=(function(o,c){return c.updateTime!==void 0?{updateTime:ZM(o,c.updateTime)}:c.exists!==void 0?{exists:c.exists}:lt(27497)})(n,e.precondition)),t}function Wb(n,e){const t=e.currentDocument?(function(c){return c.updateTime!==void 0?bs.updateTime(Os(c.updateTime)):c.exists!==void 0?bs.exists(c.exists):bs.none()})(e.currentDocument):bs.none(),s=e.updateTransforms?e.updateTransforms.map((o=>(function(u,d){let p=null;if("setToServerValue"in d)pt(d.setToServerValue==="REQUEST_TIME",16630,{proto:d}),p=new uu;else if("appendMissingElements"in d){const b=d.appendMissingElements.values||[];p=new Fl(b)}else if("removeAllFromArray"in d){const b=d.removeAllFromArray.values||[];p=new zl(b)}else"increment"in d?p=new hu(u,d.increment):lt(16584,{proto:d});const g=ys.fromServerFormat(d.fieldPath);return new kd(g,p)})(n,o))):[];if(e.update){e.update.name;const o=sa(n,e.update.name),c=new ir({mapValue:{fields:e.update.fields}});if(e.updateMask){const u=(function(p){const g=p.fieldPaths||[];return new $r(g.map((b=>ys.fromServerFormat(b))))})(e.updateMask);return new $a(o,c,u,t,s)}return new Su(o,c,t,s)}if(e.delete){const o=sa(n,e.delete);return new ju(o,t)}if(e.verify){const o=sa(n,e.verify);return new Uv(o,t)}return lt(1463,{proto:e})}function n3(n,e){return n&&n.length>0?(pt(e!==void 0,14353),n.map((t=>(function(o,c){let u=o.updateTime?Os(o.updateTime):Os(c);return u.isEqual(wt.min())&&(u=Os(c)),new zM(u,o.transformResults||[])})(t,e)))):[]}function SS(n,e){return{documents:[TS(n,e.path)]}}function yp(n,e){const t={structuredQuery:{}},s=e.path;let o;e.collectionGroup!==null?(o=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=TS(n,o);const c=(function(g){if(g.length!==0)return RS(Kn.create(g,"and"))})(e.filters);c&&(t.structuredQuery.where=c);const u=(function(g){if(g.length!==0)return g.map((b=>(function(T){return{field:jo(T.field),direction:r3(T.dir)}})(b)))})(e.orderBy);u&&(t.structuredQuery.orderBy=u);const d=qb(n,e.limit);return d!==null&&(t.structuredQuery.limit=d),e.startAt&&(t.structuredQuery.startAt=(function(g){return{before:g.inclusive,values:g.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(g){return{before:!g.inclusive,values:g.position}})(e.endAt)),{ft:t,parent:o}}function jS(n,e,t,s){const{ft:o,parent:c}=yp(n,e),u={},d=[];let p=0;return t.forEach((g=>{const b=s?g.alias:"aggregate_"+p++;u[b]=g.alias,g.aggregateType==="count"?d.push({alias:b,count:{}}):g.aggregateType==="avg"?d.push({alias:b,avg:{field:jo(g.fieldPath)}}):g.aggregateType==="sum"&&d.push({alias:b,sum:{field:jo(g.fieldPath)}})})),{request:{structuredAggregationQuery:{aggregations:d,structuredQuery:o.structuredQuery},parent:o.parent},gt:u,parent:c}}function NS(n){let e=ES(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let o=null;if(s>0){pt(s===1,65062);const b=t.from[0];b.allDescendants?o=b.collectionId:e=e.child(b.collectionId)}let c=[];t.where&&(c=(function(x){const T=AS(x);return T instanceof Kn&&Lv(T)?T.getFilters():[T]})(t.where));let u=[];t.orderBy&&(u=(function(x){return x.map((T=>(function(B){return new od($c(B.field),(function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(B.direction))})(T)))})(t.orderBy));let d=null;t.limit&&(d=(function(x){let T;return T=typeof x=="object"?x.value:x,xd(T)?null:T})(t.limit));let p=null;t.startAt&&(p=(function(x){const T=!!x.before,N=x.values||[];return new qo(N,T)})(t.startAt));let g=null;return t.endAt&&(g=(function(x){const T=!x.before,N=x.values||[];return new qo(N,T)})(t.endAt)),Jk(e,o,u,c,d,"F",p,g)}function s3(n,e){const t=(function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return lt(28987,{purpose:o})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function AS(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=$c(t.unaryFilter.field);return Tn.create(s,"==",{doubleValue:NaN});case"IS_NULL":const o=$c(t.unaryFilter.field);return Tn.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const c=$c(t.unaryFilter.field);return Tn.create(c,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=$c(t.unaryFilter.field);return Tn.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return lt(61313);default:return lt(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Tn.create($c(t.fieldFilter.field),(function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return lt(58110);default:return lt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Kn.create(t.compositeFilter.filters.map((s=>AS(s))),(function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return lt(1026)}})(t.compositeFilter.op))})(n):lt(30097,{filter:n})}function r3(n){return QM[n]}function i3(n){return YM[n]}function a3(n){return XM[n]}function jo(n){return{fieldPath:n.canonicalString()}}function $c(n){return ys.fromServerFormat(n.fieldPath)}function RS(n){return n instanceof Tn?(function(t){if(t.op==="=="){if(b2(t.value))return{unaryFilter:{field:jo(t.field),op:"IS_NAN"}};if(y2(t.value))return{unaryFilter:{field:jo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(b2(t.value))return{unaryFilter:{field:jo(t.field),op:"IS_NOT_NAN"}};if(y2(t.value))return{unaryFilter:{field:jo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:jo(t.field),op:i3(t.op),value:t.value}}})(n):n instanceof Kn?(function(t){const s=t.getFilters().map((o=>RS(o)));return s.length===1?s[0]:{compositeFilter:{op:a3(t.op),filters:s}}})(n):lt(54877,{filter:n})}function o3(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function CS(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function IS(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}class Aa{constructor(e,t,s,o,c=wt.min(),u=wt.min(),d=As.EMPTY_BYTE_STRING,p=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=o,this.snapshotVersion=c,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=d,this.expectedCount=p}withSequenceNumber(e){return new Aa(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Aa(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Aa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Aa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class DS{constructor(e){this.yt=e}}function l3(n,e){let t;if(e.document)t=gp(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const s=Je.fromSegments(e.noDocument.path),o=$l(e.noDocument.readTime);t=hs.newNoDocument(s,o),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return lt(56709);{const s=Je.fromSegments(e.unknownDocument.path),o=$l(e.unknownDocument.version);t=hs.newUnknownDocument(s,o)}}return e.readTime&&t.setReadTime((function(o){const c=new mt(o[0],o[1]);return wt.fromTimestamp(c)})(e.readTime)),t}function M2(n,e){const t=e.key,s={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Fm(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())s.document=(function(c,u){return{name:ld(c,u.key),fields:u.data.value.mapValue.fields,updateTime:du(c,u.version.toTimestamp()),createTime:du(c,u.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())s.noDocument={path:t.path.toArray(),readTime:ql(e.version)};else{if(!e.isUnknownDocument())return lt(57904,{document:e});s.unknownDocument={path:t.path.toArray(),version:ql(e.version)}}return s}function Fm(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function ql(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function $l(n){const e=new mt(n.seconds,n.nanoseconds);return wt.fromTimestamp(e)}function kl(n,e){const t=(e.baseMutations||[]).map((c=>Wb(n.yt,c)));for(let c=0;c<e.mutations.length-1;++c){const u=e.mutations[c];if(c+1<e.mutations.length&&e.mutations[c+1].transform!==void 0){const d=e.mutations[c+1];u.updateTransforms=d.transform.fieldTransforms,e.mutations.splice(c+1,1),++c}}const s=e.mutations.map((c=>Wb(n.yt,c))),o=mt.fromMillis(e.localWriteTimeMs);return new Fv(e.batchId,o,t,s)}function Mh(n){const e=$l(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?$l(n.lastLimboFreeSnapshotVersion):wt.min();let s;return s=(function(c){return c.documents!==void 0})(n.query)?(function(c){const u=c.documents.length;return pt(u===1,1966,{count:u}),Er(ku(ES(c.documents[0])))})(n.query):(function(c){return Er(NS(c))})(n.query),new Aa(s,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,As.fromBase64String(n.resumeToken))}function PS(n,e){const t=ql(e.snapshotVersion),s=ql(e.lastLimboFreeSnapshotVersion);let o;o=Om(e.target)?SS(n.yt,e.target):yp(n.yt,e.target).ft;const c=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ul(e.target),readTime:t,resumeToken:c,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:s,query:o}}function bp(n){const e=NS({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Um(e,e.limit,"L"):e}function $y(n,e){return new qv(e.largestBatchId,Wb(n.yt,e.overlayMutation))}function L2(n,e){const t=e.path.lastSegment();return[n,Tr(e.path.popLast()),t]}function V2(n,e,t,s){return{indexId:n,uid:e,sequenceNumber:t,readTime:ql(s.readTime),documentKey:Tr(s.documentKey.path),largestBatchId:s.largestBatchId}}class c3{getBundleMetadata(e,t){return O2(e).get(t).next((s=>{if(s)return(function(c){return{id:c.bundleId,createTime:$l(c.createTime),version:c.version}})(s)}))}saveBundleMetadata(e,t){return O2(e).put((function(o){return{bundleId:o.id,createTime:ql(Os(o.createTime)),version:o.version}})(t))}getNamedQuery(e,t){return B2(e).get(t).next((s=>{if(s)return(function(c){return{name:c.name,query:bp(c.bundledQuery),readTime:$l(c.readTime)}})(s)}))}saveNamedQuery(e,t){return B2(e).put((function(o){return{name:o.name,readTime:ql(Os(o.readTime)),bundledQuery:o.bundledQuery}})(t))}}function O2(n){return Zs(n,lp)}function B2(n){return Zs(n,cp)}class vp{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const s=t.uid||"";return new vp(e,s)}getOverlay(e,t){return xh(e).get(L2(this.userId,t)).next((s=>s?$y(this.serializer,s):null))}getOverlays(e,t){const s=Xi();return re.forEach(t,(o=>this.getOverlay(e,o).next((c=>{c!==null&&s.set(o,c)})))).next((()=>s))}saveOverlays(e,t,s){const o=[];return s.forEach(((c,u)=>{const d=new qv(t,u);o.push(this.bt(e,d))})),re.waitFor(o)}removeOverlaysForBatchId(e,t,s){const o=new Set;t.forEach((u=>o.add(Tr(u.getCollectionPath()))));const c=[];return o.forEach((u=>{const d=IDBKeyRange.bound([this.userId,u,s],[this.userId,u,s+1],!1,!0);c.push(xh(e).X(Pb,d))})),re.waitFor(c)}getOverlaysForCollection(e,t,s){const o=Xi(),c=Tr(t),u=IDBKeyRange.bound([this.userId,c,s],[this.userId,c,Number.POSITIVE_INFINITY],!0);return xh(e).H(Pb,u).next((d=>{for(const p of d){const g=$y(this.serializer,p);o.set(g.getKey(),g)}return o}))}getOverlaysForCollectionGroup(e,t,s,o){const c=Xi();let u;const d=IDBKeyRange.bound([this.userId,t,s],[this.userId,t,Number.POSITIVE_INFINITY],!0);return xh(e).ee({index:Ak,range:d},((p,g,b)=>{const x=$y(this.serializer,g);c.size()<o||x.largestBatchId===u?(c.set(x.getKey(),x),u=x.largestBatchId):b.done()})).next((()=>c))}bt(e,t){return xh(e).put((function(o,c,u){const[d,p,g]=L2(c,u.mutation.key);return{userId:c,collectionPath:p,documentId:g,collectionGroup:u.mutation.key.getCollectionGroup(),largestBatchId:u.largestBatchId,overlayMutation:cd(o.yt,u.mutation)}})(this.serializer,this.userId,t))}}function xh(n){return Zs(n,up)}class u3{St(e){return Zs(e,Iv)}getSessionToken(e){return this.St(e).get("sessionToken").next((t=>{const s=t?.value;return s?As.fromUint8Array(s):As.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}}class Sl{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(gs(e.integerValue));else if("doubleValue"in e){const s=gs(e.doubleValue);isNaN(s)?this.Ft(t,13):(this.Ft(t,15),Zh(s)?t.Mt(0):t.Mt(s))}else if("timestampValue"in e){let s=e.timestampValue;this.Ft(t,20),typeof s=="string"&&(s=La(s)),t.xt(`${s.seconds||""}`),t.Mt(s.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Va(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const s=e.geoPointValue;this.Ft(t,45),t.Mt(s.latitude||0),t.Mt(s.longitude||0)}else"mapValue"in e?zk(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):fp(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):lt(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){const s=e.fields||{};this.Ft(t,55);for(const o of Object.keys(s))this.Ot(o,t),this.Ct(s[o],t)}kt(e,t){const s=e.fields||{};this.Ft(t,53);const o=ou,c=s[o].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(gs(c)),this.Ot(o,t),this.Ct(s[o],t)}qt(e,t){const s=e.values||[];this.Ft(t,50);for(const o of s)this.Ct(o,t)}Lt(e,t){this.Ft(t,37),Je.fromName(e).path.forEach((s=>{this.Ft(t,60),this.$t(s,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Sl.Wt=new Sl;const Mc=255;function h3(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function U2(n){const e=64-(function(s){let o=0;for(let c=0;c<8;++c){const u=h3(255&s[c]);if(o+=u,u!==8)break}return o})(n);return Math.ceil(e/8)}class d3{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Qt(e){const t=e[Symbol.iterator]();let s=t.next();for(;!s.done;)this.Gt(s.value),s=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let s=t.next();for(;!s.done;)this.Ht(s.value),s=t.next();this.Jt()}Zt(e){for(const t of e){const s=t.charCodeAt(0);if(s<128)this.Gt(s);else if(s<2048)this.Gt(960|s>>>6),this.Gt(128|63&s);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s);else{const o=t.codePointAt(0);this.Gt(240|o>>>18),this.Gt(128|63&o>>>12),this.Gt(128|63&o>>>6),this.Gt(128|63&o)}}this.zt()}Xt(e){for(const t of e){const s=t.charCodeAt(0);if(s<128)this.Ht(s);else if(s<2048)this.Ht(960|s>>>6),this.Ht(128|63&s);else if(t<"\uD800"||"\uDBFF"<t)this.Ht(480|s>>>12),this.Ht(128|63&s>>>6),this.Ht(128|63&s);else{const o=t.codePointAt(0);this.Ht(240|o>>>18),this.Ht(128|63&o>>>12),this.Ht(128|63&o>>>6),this.Ht(128|63&o)}}this.Jt()}Yt(e){const t=this.en(e),s=U2(t);this.tn(1+s),this.buffer[this.position++]=255&s;for(let o=t.length-s;o<t.length;++o)this.buffer[this.position++]=255&t[o]}nn(e){const t=this.en(e),s=U2(t);this.tn(1+s),this.buffer[this.position++]=~(255&s);for(let o=t.length-s;o<t.length;++o)this.buffer[this.position++]=~(255&t[o])}rn(){this.sn(Mc),this.sn(255)}_n(){this.an(Mc),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(c){const u=new DataView(new ArrayBuffer(8));return u.setFloat64(0,c,!1),new Uint8Array(u.buffer)})(e),s=!!(128&t[0]);t[0]^=s?255:128;for(let o=1;o<t.length;++o)t[o]^=s?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Mc?(this.sn(Mc),this.sn(0)):this.sn(t)}Ht(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Mc?(this.an(Mc),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Jt(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let s=2*this.buffer.length;s<t&&(s=t);const o=new Uint8Array(s);o.set(this.buffer),this.buffer=o}}class f3{constructor(e){this.cn=e}Bt(e){this.cn.Qt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.Yt(e)}vt(){this.cn.rn()}}class m3{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Xt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class _h{constructor(){this.cn=new d3,this.ascending=new f3(this.cn),this.descending=new m3(this.cn)}seed(e){this.cn.seed(e)}ln(e){return e===0?this.ascending:this.descending}un(){return this.cn.un()}reset(){this.cn.reset()}}class jl{constructor(e,t,s,o){this.hn=e,this.Pn=t,this.Tn=s,this.In=o}En(){const e=this.In.length,t=e===0||this.In[e-1]===255?e+1:e,s=new Uint8Array(t);return s.set(this.In,0),t!==e?s.set([0],this.In.length):++s[s.length-1],new jl(this.hn,this.Pn,this.Tn,s)}Rn(e,t,s){return{indexId:this.hn,uid:e,arrayValue:_m(this.Tn),directionalValue:_m(this.In),orderedDocumentKey:_m(t),documentKey:s.path.toArray()}}An(e,t,s){const o=this.Rn(e,t,s);return[o.indexId,o.uid,o.arrayValue,o.directionalValue,o.orderedDocumentKey,o.documentKey]}}function bo(n,e){let t=n.hn-e.hn;return t!==0?t:(t=F2(n.Tn,e.Tn),t!==0?t:(t=F2(n.In,e.In),t!==0?t:Je.comparator(n.Pn,e.Pn)))}function F2(n,e){for(let t=0;t<n.length&&t<e.length;++t){const s=n[t]-e[t];if(s!==0)return s}return n.length-e.length}function _m(n){return xE()?(function(t){let s="";for(let o=0;o<t.length;o++)s+=String.fromCharCode(t[o]);return s})(n):n}function z2(n){return typeof n!="string"?n:(function(t){const s=new Uint8Array(t.length);for(let o=0;o<t.length;o++)s[o]=t.charCodeAt(o);return s})(n)}class q2{constructor(e){this.Vn=new Qn(((t,s)=>ys.comparator(t.field,s.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.mn=[];for(const t of e.filters){const s=t;s.isInequality()?this.Vn=this.Vn.add(s):this.mn.push(s)}}get fn(){return this.Vn.size>1}gn(e){if(pt(e.collectionGroup===this.collectionId,49279),this.fn)return!1;const t=Cb(e);if(t!==void 0&&!this.pn(t))return!1;const s=wl(e);let o=new Set,c=0,u=0;for(;c<s.length&&this.pn(s[c]);++c)o=o.add(s[c].fieldPath.canonicalString());if(c===s.length)return!0;if(this.Vn.size>0){const d=this.Vn.getIterator().getNext();if(!o.has(d.field.canonicalString())){const p=s[c];if(!this.yn(d,p)||!this.wn(this.dn[u++],p))return!1}++c}for(;c<s.length;++c){const d=s[c];if(u>=this.dn.length||!this.wn(this.dn[u++],d))return!1}return!0}bn(){if(this.fn)return null;let e=new Qn(ys.comparator);const t=[];for(const s of this.mn)if(!s.field.isKeyField())if(s.op==="array-contains"||s.op==="array-contains-any")t.push(new Rl(s.field,2));else{if(e.has(s.field))continue;e=e.add(s.field),t.push(new Rl(s.field,0))}for(const s of this.dn)s.field.isKeyField()||e.has(s.field)||(e=e.add(s.field),t.push(new Rl(s.field,s.dir==="asc"?0:1)));return new tu(tu.UNKNOWN_ID,this.collectionId,t,nu.empty())}pn(e){for(const t of this.mn)if(this.yn(t,e))return!0;return!1}yn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const s=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===s}wn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function MS(n){if(pt(n instanceof Tn||n instanceof Kn,20012),n instanceof Tn){if(n instanceof Xk){const t=n.value.arrayValue?.values?.map((s=>Tn.create(n.field,"==",s)))||[];return Kn.create(t,"or")}return n}const e=n.filters.map((t=>MS(t)));return Kn.create(e,n.op)}function p3(n){if(n.getFilters().length===0)return[];const e=Qb(MS(n));return pt(LS(e),7391),Gb(e)||Kb(e)?[e]:e.getFilters()}function Gb(n){return n instanceof Tn}function Kb(n){return n instanceof Kn&&Lv(n)}function LS(n){return Gb(n)||Kb(n)||(function(t){if(t instanceof Kn&&Ob(t)){for(const s of t.getFilters())if(!Gb(s)&&!Kb(s))return!1;return!0}return!1})(n)}function Qb(n){if(pt(n instanceof Tn||n instanceof Kn,34018),n instanceof Tn)return n;if(n.filters.length===1)return Qb(n.filters[0]);const e=n.filters.map((s=>Qb(s)));let t=Kn.create(e,n.op);return t=zm(t),LS(t)?t:(pt(t instanceof Kn,64498),pt(cu(t),40251),pt(t.filters.length>1,57927),t.filters.reduce(((s,o)=>Wv(s,o))))}function Wv(n,e){let t;return pt(n instanceof Tn||n instanceof Kn,38388),pt(e instanceof Tn||e instanceof Kn,25473),t=n instanceof Tn?e instanceof Tn?(function(o,c){return Kn.create([o,c],"and")})(n,e):$2(n,e):e instanceof Tn?$2(e,n):(function(o,c){if(pt(o.filters.length>0&&c.filters.length>0,48005),cu(o)&&cu(c))return Kk(o,c.getFilters());const u=Ob(o)?o:c,d=Ob(o)?c:o,p=u.filters.map((g=>Wv(g,d)));return Kn.create(p,"or")})(n,e),zm(t)}function $2(n,e){if(cu(e))return Kk(e,n.getFilters());{const t=e.filters.map((s=>Wv(n,s)));return Kn.create(t,"or")}}function zm(n){if(pt(n instanceof Tn||n instanceof Kn,11850),n instanceof Tn)return n;const e=n.getFilters();if(e.length===1)return zm(e[0]);if(Wk(n))return n;const t=e.map((o=>zm(o))),s=[];return t.forEach((o=>{o instanceof Tn?s.push(o):o instanceof Kn&&(o.op===n.op?s.push(...o.filters):s.push(o))})),s.length===1?s[0]:Kn.create(s,n.op)}class g3{constructor(){this.Sn=new Gv}addToCollectionParentIndex(e,t){return this.Sn.add(t),re.resolve()}getCollectionParents(e,t){return re.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return re.resolve()}deleteFieldIndex(e,t){return re.resolve()}deleteAllFieldIndexes(e){return re.resolve()}createTargetIndexes(e,t){return re.resolve()}getDocumentsMatchingTarget(e,t){return re.resolve(null)}getIndexType(e,t){return re.resolve(0)}getFieldIndexes(e,t){return re.resolve([])}getNextCollectionGroupToUpdate(e){return re.resolve(null)}getMinOffset(e,t){return re.resolve(ai.min())}getMinOffsetFromCollectionGroup(e,t){return re.resolve(ai.min())}updateCollectionGroup(e,t,s){return re.resolve()}updateIndexEntries(e,t){return re.resolve()}}class Gv{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),o=this.index[t]||new Qn(fn.comparator),c=!o.has(s);return this.index[t]=o.add(s),c}has(e){const t=e.lastSegment(),s=e.popLast(),o=this.index[t];return o&&o.has(s)}getEntries(e){return(this.index[e]||new Qn(fn.comparator)).toArray()}}const H2="IndexedDbIndexManager",Kf=new Uint8Array(0);class y3{constructor(e,t){this.databaseId=t,this.Dn=new Gv,this.Cn=new qa((s=>Ul(s)),((s,o)=>wd(s,o))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Dn.has(t)){const s=t.lastSegment(),o=t.popLast();e.addOnCommittedListener((()=>{this.Dn.add(t)}));const c={collectionId:s,parent:Tr(o)};return W2(e).put(c)}return re.resolve()}getCollectionParents(e,t){const s=[],o=IDBKeyRange.bound([t,""],[pk(t),""],!1,!0);return W2(e).H(o).next((c=>{for(const u of c){if(u.collectionId!==t)break;s.push(Yi(u.parent))}return s}))}addFieldIndex(e,t){const s=wh(e),o=(function(d){return{indexId:d.indexId,collectionGroup:d.collectionGroup,fields:d.fields.map((p=>[p.fieldPath.canonicalString(),p.kind]))}})(t);delete o.indexId;const c=s.add(o);if(t.indexState){const u=Vc(e);return c.next((d=>{u.put(V2(d,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return c.next()}deleteFieldIndex(e,t){const s=wh(e),o=Vc(e),c=Lc(e);return s.delete(t.indexId).next((()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>c.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=wh(e),s=Lc(e),o=Vc(e);return t.X().next((()=>s.X())).next((()=>o.X()))}createTargetIndexes(e,t){return re.forEach(this.vn(t),(s=>this.getIndexType(e,s).next((o=>{if(o===0||o===1){const c=new q2(s).bn();if(c!=null)return this.addFieldIndex(e,c)}}))))}getDocumentsMatchingTarget(e,t){const s=Lc(e);let o=!0;const c=new Map;return re.forEach(this.vn(t),(u=>this.Fn(e,u).next((d=>{o&&(o=!!d),c.set(u,d)})))).next((()=>{if(o){let u=Zt();const d=[];return re.forEach(c,((p,g)=>{Oe(H2,`Using index ${(function(J){return`id=${J.indexId}|cg=${J.collectionGroup}|f=${J.fields.map((de=>`${de.fieldPath}:${de.kind}`)).join(",")}`})(p)} to execute ${Ul(t)}`);const b=(function(J,de){const Ne=Cb(de);if(Ne===void 0)return null;for(const we of Bm(J,Ne.fieldPath))switch(we.op){case"array-contains-any":return we.value.arrayValue.values||[];case"array-contains":return[we.value]}return null})(g,p),x=(function(J,de){const Ne=new Map;for(const we of wl(de))for(const A of Bm(J,we.fieldPath))switch(A.op){case"==":case"in":Ne.set(we.fieldPath.canonicalString(),A.value);break;case"not-in":case"!=":return Ne.set(we.fieldPath.canonicalString(),A.value),Array.from(Ne.values())}return null})(g,p),T=(function(J,de){const Ne=[];let we=!0;for(const A of wl(de)){const S=A.kind===0?T2(J,A.fieldPath,J.startAt):E2(J,A.fieldPath,J.startAt);Ne.push(S.value),we&&(we=S.inclusive)}return new qo(Ne,we)})(g,p),N=(function(J,de){const Ne=[];let we=!0;for(const A of wl(de)){const S=A.kind===0?E2(J,A.fieldPath,J.endAt):T2(J,A.fieldPath,J.endAt);Ne.push(S.value),we&&(we=S.inclusive)}return new qo(Ne,we)})(g,p),B=this.Mn(p,g,T),M=this.Mn(p,g,N),P=this.xn(p,g,x),Y=this.On(p.indexId,b,B,T.inclusive,M,N.inclusive,P);return re.forEach(Y,($=>s.Z($,t.limit).next((J=>{J.forEach((de=>{const Ne=Je.fromSegments(de.documentKey);u.has(Ne)||(u=u.add(Ne),d.push(Ne))}))}))))})).next((()=>d))}return re.resolve(null)}))}vn(e){let t=this.Cn.get(e);return t||(e.filters.length===0?t=[e]:t=p3(Kn.create(e.filters,"and")).map((s=>Ub(e.path,e.collectionGroup,e.orderBy,s.getFilters(),e.limit,e.startAt,e.endAt))),this.Cn.set(e,t),t)}On(e,t,s,o,c,u,d){const p=(t!=null?t.length:1)*Math.max(s.length,c.length),g=p/(t!=null?t.length:1),b=[];for(let x=0;x<p;++x){const T=t?this.Nn(t[x/g]):Kf,N=this.Bn(e,T,s[x%g],o),B=this.Ln(e,T,c[x%g],u),M=d.map((P=>this.Bn(e,T,P,!0)));b.push(...this.createRange(N,B,M))}return b}Bn(e,t,s,o){const c=new jl(e,Je.empty(),t,s);return o?c:c.En()}Ln(e,t,s,o){const c=new jl(e,Je.empty(),t,s);return o?c.En():c}Fn(e,t){const s=new q2(t),o=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,o).next((c=>{let u=null;for(const d of c)s.gn(d)&&(!u||d.fields.length>u.fields.length)&&(u=d);return u}))}getIndexType(e,t){let s=2;const o=this.vn(t);return re.forEach(o,(c=>this.Fn(e,c).next((u=>{u?s!==0&&u.fields.length<(function(p){let g=new Qn(ys.comparator),b=!1;for(const x of p.filters)for(const T of x.getFlattenedFilters())T.field.isKeyField()||(T.op==="array-contains"||T.op==="array-contains-any"?b=!0:g=g.add(T.field));for(const x of p.orderBy)x.field.isKeyField()||(g=g.add(x.field));return g.size+(b?1:0)})(c)&&(s=1):s=0})))).next((()=>(function(u){return u.limit!==null})(t)&&o.length>1&&s===2?1:s))}kn(e,t){const s=new _h;for(const o of wl(e)){const c=t.data.field(o.fieldPath);if(c==null)return null;const u=s.ln(o.kind);Sl.Wt.Dt(c,u)}return s.un()}Nn(e){const t=new _h;return Sl.Wt.Dt(e,t.ln(0)),t.un()}Kn(e,t){const s=new _h;return Sl.Wt.Dt(Bl(this.databaseId,t),s.ln((function(c){const u=wl(c);return u.length===0?0:u[u.length-1].kind})(e))),s.un()}xn(e,t,s){if(s===null)return[];let o=[];o.push(new _h);let c=0;for(const u of wl(e)){const d=s[c++];for(const p of o)if(this.qn(t,u.fieldPath)&&ad(d))o=this.Un(o,u,d);else{const g=p.ln(u.kind);Sl.Wt.Dt(d,g)}}return this.$n(o)}Mn(e,t,s){return this.xn(e,t,s.position)}$n(e){const t=[];for(let s=0;s<e.length;++s)t[s]=e[s].un();return t}Un(e,t,s){const o=[...e],c=[];for(const u of s.arrayValue.values||[])for(const d of o){const p=new _h;p.seed(d.un()),Sl.Wt.Dt(u,p.ln(t.kind)),c.push(p)}return c}qn(e,t){return!!e.filters.find((s=>s instanceof Tn&&s.field.isEqual(t)&&(s.op==="in"||s.op==="not-in")))}getFieldIndexes(e,t){const s=wh(e),o=Vc(e);return(t?s.H(Db,IDBKeyRange.bound(t,t)):s.H()).next((c=>{const u=[];return re.forEach(c,(d=>o.get([d.indexId,this.uid]).next((p=>{u.push((function(b,x){const T=x?new nu(x.sequenceNumber,new ai($l(x.readTime),new Je(Yi(x.documentKey)),x.largestBatchId)):nu.empty(),N=b.fields.map((([B,M])=>new Rl(ys.fromServerFormat(B),M)));return new tu(b.indexId,b.collectionGroup,N,T)})(d,p))})))).next((()=>u))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((s,o)=>{const c=s.indexState.sequenceNumber-o.indexState.sequenceNumber;return c!==0?c:Ft(s.collectionGroup,o.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,s){const o=wh(e),c=Vc(e);return this.Wn(e).next((u=>o.H(Db,IDBKeyRange.bound(t,t)).next((d=>re.forEach(d,(p=>c.put(V2(p.indexId,this.uid,u,s))))))))}updateIndexEntries(e,t){const s=new Map;return re.forEach(t,((o,c)=>{const u=s.get(o.collectionGroup);return(u?re.resolve(u):this.getFieldIndexes(e,o.collectionGroup)).next((d=>(s.set(o.collectionGroup,d),re.forEach(d,(p=>this.Qn(e,o,p).next((g=>{const b=this.Gn(c,p);return g.isEqual(b)?re.resolve():this.zn(e,c,p,g,b)})))))))}))}jn(e,t,s,o){return Lc(e).put(o.Rn(this.uid,this.Kn(s,t.key),t.key))}Hn(e,t,s,o){return Lc(e).delete(o.An(this.uid,this.Kn(s,t.key),t.key))}Qn(e,t,s){const o=Lc(e);let c=new Qn(bo);return o.ee({index:Nk,range:IDBKeyRange.only([s.indexId,this.uid,_m(this.Kn(s,t))])},((u,d)=>{c=c.add(new jl(s.indexId,t,z2(d.arrayValue),z2(d.directionalValue)))})).next((()=>c))}Gn(e,t){let s=new Qn(bo);const o=this.kn(t,e);if(o==null)return s;const c=Cb(t);if(c!=null){const u=e.data.field(c.fieldPath);if(ad(u))for(const d of u.arrayValue.values||[])s=s.add(new jl(t.indexId,e.key,this.Nn(d),o))}else s=s.add(new jl(t.indexId,e.key,Kf,o));return s}zn(e,t,s,o,c){Oe(H2,"Updating index entries for document '%s'",t.key);const u=[];return(function(p,g,b,x,T){const N=p.getIterator(),B=g.getIterator();let M=Pc(N),P=Pc(B);for(;M||P;){let Y=!1,$=!1;if(M&&P){const J=b(M,P);J<0?$=!0:J>0&&(Y=!0)}else M!=null?$=!0:Y=!0;Y?(x(P),P=Pc(B)):$?(T(M),M=Pc(N)):(M=Pc(N),P=Pc(B))}})(o,c,bo,(d=>{u.push(this.jn(e,t,s,d))}),(d=>{u.push(this.Hn(e,t,s,d))})),re.waitFor(u)}Wn(e){let t=1;return Vc(e).ee({index:jk,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((s,o,c)=>{c.done(),t=o.sequenceNumber+1})).next((()=>t))}createRange(e,t,s){s=s.sort(((u,d)=>bo(u,d))).filter(((u,d,p)=>!d||bo(u,p[d-1])!==0));const o=[];o.push(e);for(const u of s){const d=bo(u,e),p=bo(u,t);if(d===0)o[0]=e.En();else if(d>0&&p<0)o.push(u),o.push(u.En());else if(p>0)break}o.push(t);const c=[];for(let u=0;u<o.length;u+=2){if(this.Jn(o[u],o[u+1]))return[];const d=o[u].An(this.uid,Kf,Je.empty()),p=o[u+1].An(this.uid,Kf,Je.empty());c.push(IDBKeyRange.bound(d,p))}return c}Jn(e,t){return bo(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(G2)}getMinOffset(e,t){return re.mapArray(this.vn(t),(s=>this.Fn(e,s).next((o=>o||lt(44426))))).next(G2)}}function W2(n){return Zs(n,nd)}function Lc(n){return Zs(n,Fh)}function wh(n){return Zs(n,Cv)}function Vc(n){return Zs(n,Uh)}function G2(n){pt(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let s=1;s<n.length;s++){const o=n[s].indexState.offset;Nv(o,e)<0&&(e=o),t<o.largestBatchId&&(t=o.largestBatchId)}return new ai(e.readTime,e.documentKey,t)}const K2={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},VS=41943040;class wr{static withCacheSize(e){return new wr(e,wr.DEFAULT_COLLECTION_PERCENTILE,wr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}function OS(n,e,t){const s=n.store(Di),o=n.store(su),c=[],u=IDBKeyRange.only(t.batchId);let d=0;const p=s.ee({range:u},((b,x,T)=>(d++,T.delete())));c.push(p.next((()=>{pt(d===1,47070,{batchId:t.batchId})})));const g=[];for(const b of t.mutations){const x=Ek(e,b.key.path,t.batchId);c.push(o.delete(x)),g.push(b.key)}return re.waitFor(c).next((()=>g))}function qm(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw lt(14731);e=n.noDocument}return JSON.stringify(e).length}wr.DEFAULT_COLLECTION_PERCENTILE=10,wr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,wr.DEFAULT=new wr(VS,wr.DEFAULT_COLLECTION_PERCENTILE,wr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),wr.DISABLED=new wr(-1,0,0);class xp{constructor(e,t,s,o){this.userId=e,this.serializer=t,this.indexManager=s,this.referenceDelegate=o,this.Zn={}}static wt(e,t,s,o){pt(e.uid!=="",64387);const c=e.isAuthenticated()?e.uid:"";return new xp(c,t,s,o)}checkEmpty(e){let t=!0;const s=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return vo(e).ee({index:Nl,range:s},((o,c,u)=>{t=!1,u.done()})).next((()=>t))}addMutationBatch(e,t,s,o){const c=Hc(e),u=vo(e);return u.add({}).next((d=>{pt(typeof d=="number",49019);const p=new Fv(d,t,s,o),g=(function(N,B,M){const P=M.baseMutations.map(($=>cd(N.yt,$))),Y=M.mutations.map(($=>cd(N.yt,$)));return{userId:B,batchId:M.batchId,localWriteTimeMs:M.localWriteTime.toMillis(),baseMutations:P,mutations:Y}})(this.serializer,this.userId,p),b=[];let x=new Qn(((T,N)=>Ft(T.canonicalString(),N.canonicalString())));for(const T of o){const N=Ek(this.userId,T.key.path,d);x=x.add(T.key.path.popLast()),b.push(u.put(g)),b.push(c.put(N,GP))}return x.forEach((T=>{b.push(this.indexManager.addToCollectionParentIndex(e,T))})),e.addOnCommittedListener((()=>{this.Zn[d]=p.keys()})),re.waitFor(b).next((()=>p))}))}lookupMutationBatch(e,t){return vo(e).get(t).next((s=>s?(pt(s.userId===this.userId,48,"Unexpected user for mutation batch",{userId:s.userId,batchId:t}),kl(this.serializer,s)):null))}Xn(e,t){return this.Zn[t]?re.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next((s=>{if(s){const o=s.keys();return this.Zn[t]=o,o}return null}))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,o=IDBKeyRange.lowerBound([this.userId,s]);let c=null;return vo(e).ee({index:Nl,range:o},((u,d,p)=>{d.userId===this.userId&&(pt(d.batchId>=s,47524,{Yn:s}),c=kl(this.serializer,d)),p.done()})).next((()=>c))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let s=Oo;return vo(e).ee({index:Nl,range:t,reverse:!0},((o,c,u)=>{s=c.batchId,u.done()})).next((()=>s))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Oo],[this.userId,Number.POSITIVE_INFINITY]);return vo(e).H(Nl,t).next((s=>s.map((o=>kl(this.serializer,o)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const s=mm(this.userId,t.path),o=IDBKeyRange.lowerBound(s),c=[];return Hc(e).ee({range:o},((u,d,p)=>{const[g,b,x]=u,T=Yi(b);if(g===this.userId&&t.path.isEqual(T))return vo(e).get(x).next((N=>{if(!N)throw lt(61480,{er:u,batchId:x});pt(N.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:N.userId,batchId:x}),c.push(kl(this.serializer,N))}));p.done()})).next((()=>c))}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Qn(Ft);const o=[];return t.forEach((c=>{const u=mm(this.userId,c.path),d=IDBKeyRange.lowerBound(u),p=Hc(e).ee({range:d},((g,b,x)=>{const[T,N,B]=g,M=Yi(N);T===this.userId&&c.path.isEqual(M)?s=s.add(B):x.done()}));o.push(p)})),re.waitFor(o).next((()=>this.tr(e,s)))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,o=s.length+1,c=mm(this.userId,s),u=IDBKeyRange.lowerBound(c);let d=new Qn(Ft);return Hc(e).ee({range:u},((p,g,b)=>{const[x,T,N]=p,B=Yi(T);x===this.userId&&s.isPrefixOf(B)?B.length===o&&(d=d.add(N)):b.done()})).next((()=>this.tr(e,d)))}tr(e,t){const s=[],o=[];return t.forEach((c=>{o.push(vo(e).get(c).next((u=>{if(u===null)throw lt(35274,{batchId:c});pt(u.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:u.userId,batchId:c}),s.push(kl(this.serializer,u))})))})),re.waitFor(o).next((()=>s))}removeMutationBatch(e,t){return OS(e.le,this.userId,t).next((s=>(e.addOnCommittedListener((()=>{this.nr(t.batchId)})),re.forEach(s,(o=>this.referenceDelegate.markPotentiallyOrphaned(e,o))))))}nr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return re.resolve();const s=IDBKeyRange.lowerBound((function(u){return[u]})(this.userId)),o=[];return Hc(e).ee({range:s},((c,u,d)=>{if(c[0]===this.userId){const p=Yi(c[1]);o.push(p)}else d.done()})).next((()=>{pt(o.length===0,56720,{rr:o.map((c=>c.canonicalString()))})}))}))}containsKey(e,t){return BS(e,this.userId,t)}ir(e){return US(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Oo,lastStreamToken:""}))}}function BS(n,e,t){const s=mm(e,t.path),o=s[1],c=IDBKeyRange.lowerBound(s);let u=!1;return Hc(n).ee({range:c,Y:!0},((d,p,g)=>{const[b,x,T]=d;b===e&&x===o&&(u=!0),g.done()})).next((()=>u))}function vo(n){return Zs(n,Di)}function Hc(n){return Zs(n,su)}function US(n){return Zs(n,ed)}class Hl{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Hl(0)}static ar(){return new Hl(-1)}}class b3{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.ur(e).next((t=>{const s=new Hl(t.highestTargetId);return t.highestTargetId=s.next(),this.cr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.ur(e).next((t=>wt.fromTimestamp(new mt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.ur(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,s){return this.ur(e).next((o=>(o.highestListenSequenceNumber=t,s&&(o.lastRemoteSnapshotVersion=s.toTimestamp()),t>o.highestListenSequenceNumber&&(o.highestListenSequenceNumber=t),this.cr(e,o))))}addTargetData(e,t){return this.lr(e,t).next((()=>this.ur(e).next((s=>(s.targetCount+=1,this.hr(t,s),this.cr(e,s))))))}updateTargetData(e,t){return this.lr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Oc(e).delete(t.targetId))).next((()=>this.ur(e))).next((s=>(pt(s.targetCount>0,8065),s.targetCount-=1,this.cr(e,s))))}removeTargets(e,t,s){let o=0;const c=[];return Oc(e).ee(((u,d)=>{const p=Mh(d);p.sequenceNumber<=t&&s.get(p.targetId)===null&&(o++,c.push(this.removeTargetData(e,p)))})).next((()=>re.waitFor(c))).next((()=>o))}forEachTarget(e,t){return Oc(e).ee(((s,o)=>{const c=Mh(o);t(c)}))}ur(e){return Q2(e).get(Vm).next((t=>(pt(t!==null,2888),t)))}cr(e,t){return Q2(e).put(Vm,t)}lr(e,t){return Oc(e).put(PS(this.serializer,t))}hr(e,t){let s=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,s=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,s=!0),s}getTargetCount(e){return this.ur(e).next((t=>t.targetCount))}getTargetData(e,t){const s=Ul(t),o=IDBKeyRange.bound([s,Number.NEGATIVE_INFINITY],[s,Number.POSITIVE_INFINITY]);let c=null;return Oc(e).ee({range:o,index:Sk},((u,d,p)=>{const g=Mh(d);wd(t,g.target)&&(c=g,p.done())})).next((()=>c))}addMatchingKeys(e,t,s){const o=[],c=No(e);return t.forEach((u=>{const d=Tr(u.path);o.push(c.put({targetId:s,path:d})),o.push(this.referenceDelegate.addReference(e,s,u))})),re.waitFor(o)}removeMatchingKeys(e,t,s){const o=No(e);return re.forEach(t,(c=>{const u=Tr(c.path);return re.waitFor([o.delete([s,u]),this.referenceDelegate.removeReference(e,s,c)])}))}removeMatchingKeysForTargetId(e,t){const s=No(e),o=IDBKeyRange.bound([t],[t+1],!1,!0);return s.delete(o)}getMatchingKeysForTargetId(e,t){const s=IDBKeyRange.bound([t],[t+1],!1,!0),o=No(e);let c=Zt();return o.ee({range:s,Y:!0},((u,d,p)=>{const g=Yi(u[1]),b=new Je(g);c=c.add(b)})).next((()=>c))}containsKey(e,t){const s=Tr(t.path),o=IDBKeyRange.bound([s],[pk(s)],!1,!0);let c=0;return No(e).ee({index:Rv,Y:!0,range:o},(([u,d],p,g)=>{u!==0&&(c++,g.done())})).next((()=>c>0))}At(e,t){return Oc(e).get(t).next((s=>s?Mh(s):null))}}function Oc(n){return Zs(n,ru)}function Q2(n){return Zs(n,Cl)}function No(n){return Zs(n,iu)}const Y2="LruGarbageCollector",FS=1048576;function X2([n,e],[t,s]){const o=Ft(n,t);return o===0?Ft(e,s):o}class v3{constructor(e){this.Pr=e,this.buffer=new Qn(X2),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();X2(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class zS{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){Oe(Y2,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Qo(t)?Oe(Y2,"Ignoring IndexedDB error during garbage collection: ",t):await Ko(t)}await this.Ar(3e5)}))}}class x3{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((s=>Math.floor(t/100*s)))}nthSequenceNumber(e,t){if(t===0)return re.resolve(qr.ce);const s=new v3(t);return this.Vr.forEachTarget(e,(o=>s.Er(o.sequenceNumber))).next((()=>this.Vr.mr(e,(o=>s.Er(o))))).next((()=>s.maxValue))}removeTargets(e,t,s){return this.Vr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Oe("LruGarbageCollector","Garbage collection skipped; disabled"),re.resolve(K2)):this.getCacheSize(e).next((s=>s<this.params.cacheSizeCollectionThreshold?(Oe("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),K2):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let s,o,c,u,d,p,g;const b=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((x=>(x>this.params.maximumSequenceNumbersToCollect?(Oe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${x}`),o=this.params.maximumSequenceNumbersToCollect):o=x,u=Date.now(),this.nthSequenceNumber(e,o)))).next((x=>(s=x,d=Date.now(),this.removeTargets(e,s,t)))).next((x=>(c=x,p=Date.now(),this.removeOrphanedDocuments(e,s)))).next((x=>(g=Date.now(),zc()<=wn.DEBUG&&Oe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-b}ms
	Determined least recently used ${o} in `+(d-u)+`ms
	Removed ${c} targets in `+(p-d)+`ms
	Removed ${x} documents in `+(g-p)+`ms
Total Duration: ${g-b}ms`),re.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:c,documentsRemoved:x}))))}}function qS(n,e){return new x3(n,e)}class _3{constructor(e,t){this.db=e,this.garbageCollector=qS(this,t)}dr(e){const t=this.pr(e);return this.db.getTargetCache().getTargetCount(e).next((s=>t.next((o=>s+o))))}pr(e){let t=0;return this.mr(e,(s=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}mr(e,t){return this.yr(e,((s,o)=>t(o)))}addReference(e,t,s){return Qf(e,s)}removeReference(e,t,s){return Qf(e,s)}removeTargets(e,t,s){return this.db.getTargetCache().removeTargets(e,t,s)}markPotentiallyOrphaned(e,t){return Qf(e,t)}wr(e,t){return(function(o,c){let u=!1;return US(o).te((d=>BS(o,d,c).next((p=>(p&&(u=!0),re.resolve(!p)))))).next((()=>u))})(e,t)}removeOrphanedDocuments(e,t){const s=this.db.getRemoteDocumentCache().newChangeBuffer(),o=[];let c=0;return this.yr(e,((u,d)=>{if(d<=t){const p=this.wr(e,u).next((g=>{if(!g)return c++,s.getEntry(e,u).next((()=>(s.removeEntry(u,wt.min()),No(e).delete((function(x){return[0,Tr(x.path)]})(u)))))}));o.push(p)}})).next((()=>re.waitFor(o))).next((()=>s.apply(e))).next((()=>c))}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,s)}updateLimboDocument(e,t){return Qf(e,t)}yr(e,t){const s=No(e);let o,c=qr.ce;return s.ee({index:Rv},(([u,d],{path:p,sequenceNumber:g})=>{u===0?(c!==qr.ce&&t(new Je(Yi(o)),c),c=g,o=p):c=qr.ce})).next((()=>{c!==qr.ce&&t(new Je(Yi(o)),c)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Qf(n,e){return No(n).put((function(s,o){return{targetId:0,path:Tr(s.path),sequenceNumber:o}})(e,n.currentSequenceNumber))}class $S{constructor(){this.changes=new qa((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,hs.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?re.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class w3{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,s){return gl(e).put(s)}removeEntry(e,t,s){return gl(e).delete((function(c,u){const d=c.path.toArray();return[d.slice(0,d.length-2),d[d.length-2],Fm(u),d[d.length-1]]})(t,s))}updateMetadata(e,t){return this.getMetadata(e).next((s=>(s.byteSize+=t,this.br(e,s))))}getEntry(e,t){let s=hs.newInvalidDocument(t);return gl(e).ee({index:pm,range:IDBKeyRange.only(Th(t))},((o,c)=>{s=this.Sr(t,c)})).next((()=>s))}Dr(e,t){let s={size:0,document:hs.newInvalidDocument(t)};return gl(e).ee({index:pm,range:IDBKeyRange.only(Th(t))},((o,c)=>{s={document:this.Sr(t,c),size:qm(c)}})).next((()=>s))}getEntries(e,t){let s=Hr();return this.Cr(e,t,((o,c)=>{const u=this.Sr(o,c);s=s.insert(o,u)})).next((()=>s))}vr(e,t){let s=Hr(),o=new as(Je.comparator);return this.Cr(e,t,((c,u)=>{const d=this.Sr(c,u);s=s.insert(c,d),o=o.insert(c,qm(u))})).next((()=>({documents:s,Fr:o})))}Cr(e,t,s){if(t.isEmpty())return re.resolve();let o=new Qn(eT);t.forEach((p=>o=o.add(p)));const c=IDBKeyRange.bound(Th(o.first()),Th(o.last())),u=o.getIterator();let d=u.getNext();return gl(e).ee({index:pm,range:c},((p,g,b)=>{const x=Je.fromSegments([...g.prefixPath,g.collectionGroup,g.documentId]);for(;d&&eT(d,x)<0;)s(d,null),d=u.getNext();d&&d.isEqual(x)&&(s(d,g),d=u.hasNext()?u.getNext():null),d?b.j(Th(d)):b.done()})).next((()=>{for(;d;)s(d,null),d=u.hasNext()?u.getNext():null}))}getDocumentsMatchingQuery(e,t,s,o,c){const u=t.path,d=[u.popLast().toArray(),u.lastSegment(),Fm(s.readTime),s.documentKey.path.isEmpty()?"":s.documentKey.path.lastSegment()],p=[u.popLast().toArray(),u.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return gl(e).H(IDBKeyRange.bound(d,p,!0)).next((g=>{c?.incrementDocumentReadCount(g.length);let b=Hr();for(const x of g){const T=this.Sr(Je.fromSegments(x.prefixPath.concat(x.collectionGroup,x.documentId)),x);T.isFoundDocument()&&(Ed(t,T)||o.has(T.key))&&(b=b.insert(T.key,T))}return b}))}getAllFromCollectionGroup(e,t,s,o){let c=Hr();const u=Z2(t,s),d=Z2(t,ai.max());return gl(e).ee({index:kk,range:IDBKeyRange.bound(u,d,!0)},((p,g,b)=>{const x=this.Sr(Je.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);c=c.insert(x.key,x),c.size===o&&b.done()})).next((()=>c))}newChangeBuffer(e){return new T3(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return J2(e).get(Ib).next((t=>(pt(!!t,20021),t)))}br(e,t){return J2(e).put(Ib,t)}Sr(e,t){if(t){const s=l3(this.serializer,t);if(!(s.isNoDocument()&&s.version.isEqual(wt.min())))return s}return hs.newInvalidDocument(e)}}function HS(n){return new w3(n)}class T3 extends $S{constructor(e,t){super(),this.Mr=e,this.trackRemovals=t,this.Or=new qa((s=>s.toString()),((s,o)=>s.isEqual(o)))}applyChanges(e){const t=[];let s=0,o=new Qn(((c,u)=>Ft(c.canonicalString(),u.canonicalString())));return this.changes.forEach(((c,u)=>{const d=this.Or.get(c);if(t.push(this.Mr.removeEntry(e,c,d.readTime)),u.isValidDocument()){const p=M2(this.Mr.serializer,u);o=o.add(c.path.popLast());const g=qm(p);s+=g-d.size,t.push(this.Mr.addEntry(e,c,p))}else if(s-=d.size,this.trackRemovals){const p=M2(this.Mr.serializer,u.convertToNoDocument(wt.min()));t.push(this.Mr.addEntry(e,c,p))}})),o.forEach((c=>{t.push(this.Mr.indexManager.addToCollectionParentIndex(e,c))})),t.push(this.Mr.updateMetadata(e,s)),re.waitFor(t)}getFromCache(e,t){return this.Mr.Dr(e,t).next((s=>(this.Or.set(t,{size:s.size,readTime:s.document.readTime}),s.document)))}getAllFromCache(e,t){return this.Mr.vr(e,t).next((({documents:s,Fr:o})=>(o.forEach(((c,u)=>{this.Or.set(c,{size:u,readTime:s.get(c).readTime})})),s)))}}function J2(n){return Zs(n,td)}function gl(n){return Zs(n,Lm)}function Th(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Z2(n,e){const t=e.documentKey.path.toArray();return[n,Fm(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function eT(n,e){const t=n.path.toArray(),s=e.path.toArray();let o=0;for(let c=0;c<t.length-2&&c<s.length-2;++c)if(o=Ft(t[c],s[c]),o)return o;return o=Ft(t.length,s.length),o||(o=Ft(t[t.length-2],s[s.length-2]),o||Ft(t[t.length-1],s[s.length-1]))}class E3{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class WS{constructor(e,t,s,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=o}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next((o=>(s=o,this.remoteDocumentCache.getEntry(e,t)))).next((o=>(s!==null&&$h(s.mutation,o,$r.empty(),mt.now()),o)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.getLocalViewOfDocuments(e,s,Zt()).next((()=>s))))}getLocalViewOfDocuments(e,t,s=Zt()){const o=Xi();return this.populateOverlays(e,o,t).next((()=>this.computeViews(e,t,o,s).next((c=>{let u=Dh();return c.forEach(((d,p)=>{u=u.insert(d,p.overlayedDocument)})),u}))))}getOverlayedDocuments(e,t){const s=Xi();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,Zt())))}populateOverlays(e,t,s){const o=[];return s.forEach((c=>{t.has(c)||o.push(c)})),this.documentOverlayCache.getOverlays(e,o).next((c=>{c.forEach(((u,d)=>{t.set(u,d)}))}))}computeViews(e,t,s,o){let c=Hr();const u=qh(),d=(function(){return qh()})();return t.forEach(((p,g)=>{const b=s.get(g.key);o.has(g.key)&&(b===void 0||b.mutation instanceof $a)?c=c.insert(g.key,g):b!==void 0?(u.set(g.key,b.mutation.getFieldMask()),$h(b.mutation,g,b.mutation.getFieldMask(),mt.now())):u.set(g.key,$r.empty())})),this.recalculateAndSaveOverlays(e,c).next((p=>(p.forEach(((g,b)=>u.set(g,b))),t.forEach(((g,b)=>d.set(g,new E3(b,u.get(g)??null)))),d)))}recalculateAndSaveOverlays(e,t){const s=qh();let o=new as(((u,d)=>u-d)),c=Zt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((u=>{for(const d of u)d.keys().forEach((p=>{const g=t.get(p);if(g===null)return;let b=s.get(p)||$r.empty();b=d.applyToLocalView(g,b),s.set(p,b);const x=(o.get(d.batchId)||Zt()).add(p);o=o.insert(d.batchId,x)}))})).next((()=>{const u=[],d=o.getReverseIterator();for(;d.hasNext();){const p=d.getNext(),g=p.key,b=p.value,x=aS();b.forEach((T=>{if(!c.has(T)){const N=fS(t.get(T),s.get(T));N!==null&&x.set(T,N),c=c.add(T)}})),u.push(this.documentOverlayCache.saveOverlays(e,g,x))}return re.waitFor(u)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.recalculateAndSaveOverlays(e,s)))}getDocumentsMatchingQuery(e,t,s,o){return RM(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Vv(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,o):this.getDocumentsMatchingCollectionQuery(e,t,s,o)}getNextDocuments(e,t,s,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,o).next((c=>{const u=o-c.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,o-c.size):re.resolve(Xi());let d=eu,p=c;return u.next((g=>re.forEach(g,((b,x)=>(d<x.largestBatchId&&(d=x.largestBatchId),c.get(b)?re.resolve():this.remoteDocumentCache.getEntry(e,b).next((T=>{p=p.insert(b,T)}))))).next((()=>this.populateOverlays(e,g,c))).next((()=>this.computeViews(e,p,g,Zt()))).next((b=>({batchId:d,changes:iS(b)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Je(t)).next((s=>{let o=Dh();return s.isFoundDocument()&&(o=o.insert(s.key,s)),o}))}getDocumentsMatchingCollectionGroupQuery(e,t,s,o){const c=t.collectionGroup;let u=Dh();return this.indexManager.getCollectionParents(e,c).next((d=>re.forEach(d,(p=>{const g=(function(x,T){return new za(T,null,x.explicitOrderBy.slice(),x.filters.slice(),x.limit,x.limitType,x.startAt,x.endAt)})(t,p.child(c));return this.getDocumentsMatchingCollectionQuery(e,g,s,o).next((b=>{b.forEach(((x,T)=>{u=u.insert(x,T)}))}))})).next((()=>u))))}getDocumentsMatchingCollectionQuery(e,t,s,o){let c;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next((u=>(c=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,c,o)))).next((u=>{c.forEach(((p,g)=>{const b=g.getKey();u.get(b)===null&&(u=u.insert(b,hs.newInvalidDocument(b)))}));let d=Dh();return u.forEach(((p,g)=>{const b=c.get(p);b!==void 0&&$h(b.mutation,g,$r.empty(),mt.now()),Ed(t,g)&&(d=d.insert(p,g))})),d}))}}class k3{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return re.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(o){return{id:o.id,version:o.version,createTime:Os(o.createTime)}})(t)),re.resolve()}getNamedQuery(e,t){return re.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(o){return{name:o.name,query:bp(o.bundledQuery),readTime:Os(o.readTime)}})(t)),re.resolve()}}class S3{constructor(){this.overlays=new as(Je.comparator),this.Lr=new Map}getOverlay(e,t){return re.resolve(this.overlays.get(t))}getOverlays(e,t){const s=Xi();return re.forEach(t,(o=>this.getOverlay(e,o).next((c=>{c!==null&&s.set(o,c)})))).next((()=>s))}saveOverlays(e,t,s){return s.forEach(((o,c)=>{this.bt(e,t,c)})),re.resolve()}removeOverlaysForBatchId(e,t,s){const o=this.Lr.get(s);return o!==void 0&&(o.forEach((c=>this.overlays=this.overlays.remove(c))),this.Lr.delete(s)),re.resolve()}getOverlaysForCollection(e,t,s){const o=Xi(),c=t.length+1,u=new Je(t.child("")),d=this.overlays.getIteratorFrom(u);for(;d.hasNext();){const p=d.getNext().value,g=p.getKey();if(!t.isPrefixOf(g.path))break;g.path.length===c&&p.largestBatchId>s&&o.set(p.getKey(),p)}return re.resolve(o)}getOverlaysForCollectionGroup(e,t,s,o){let c=new as(((g,b)=>g-b));const u=this.overlays.getIterator();for(;u.hasNext();){const g=u.getNext().value;if(g.getKey().getCollectionGroup()===t&&g.largestBatchId>s){let b=c.get(g.largestBatchId);b===null&&(b=Xi(),c=c.insert(g.largestBatchId,b)),b.set(g.getKey(),g)}}const d=Xi(),p=c.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach(((g,b)=>d.set(g,b))),!(d.size()>=o)););return re.resolve(d)}bt(e,t,s){const o=this.overlays.get(s.key);if(o!==null){const u=this.Lr.get(o.largestBatchId).delete(s.key);this.Lr.set(o.largestBatchId,u)}this.overlays=this.overlays.insert(s.key,new qv(t,s));let c=this.Lr.get(t);c===void 0&&(c=Zt(),this.Lr.set(t,c)),this.Lr.set(t,c.add(s.key))}}class j3{constructor(){this.sessionToken=As.EMPTY_BYTE_STRING}getSessionToken(e){return re.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,re.resolve()}}class Kv{constructor(){this.kr=new Qn(sr.Kr),this.qr=new Qn(sr.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const s=new sr(e,t);this.kr=this.kr.add(s),this.qr=this.qr.add(s)}$r(e,t){e.forEach((s=>this.addReference(s,t)))}removeReference(e,t){this.Wr(new sr(e,t))}Qr(e,t){e.forEach((s=>this.removeReference(s,t)))}Gr(e){const t=new Je(new fn([])),s=new sr(t,e),o=new sr(t,e+1),c=[];return this.qr.forEachInRange([s,o],(u=>{this.Wr(u),c.push(u.key)})),c}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new Je(new fn([])),s=new sr(t,e),o=new sr(t,e+1);let c=Zt();return this.qr.forEachInRange([s,o],(u=>{c=c.add(u.key)})),c}containsKey(e){const t=new sr(e,0),s=this.kr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class sr{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Je.comparator(e.key,t.key)||Ft(e.Hr,t.Hr)}static Ur(e,t){return Ft(e.Hr,t.Hr)||Je.comparator(e.key,t.key)}}class N3{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Qn(sr.Kr)}checkEmpty(e){return re.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,o){const c=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new Fv(c,t,s,o);this.mutationQueue.push(u);for(const d of o)this.Jr=this.Jr.add(new sr(d.key,c)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return re.resolve(u)}lookupMutationBatch(e,t){return re.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,o=this.Xr(s),c=o<0?0:o;return re.resolve(this.mutationQueue.length>c?this.mutationQueue[c]:null)}getHighestUnacknowledgedBatchId(){return re.resolve(this.mutationQueue.length===0?Oo:this.Yn-1)}getAllMutationBatches(e){return re.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new sr(t,0),o=new sr(t,Number.POSITIVE_INFINITY),c=[];return this.Jr.forEachInRange([s,o],(u=>{const d=this.Zr(u.Hr);c.push(d)})),re.resolve(c)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Qn(Ft);return t.forEach((o=>{const c=new sr(o,0),u=new sr(o,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([c,u],(d=>{s=s.add(d.Hr)}))})),re.resolve(this.Yr(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,o=s.length+1;let c=s;Je.isDocumentKey(c)||(c=c.child(""));const u=new sr(new Je(c),0);let d=new Qn(Ft);return this.Jr.forEachWhile((p=>{const g=p.key.path;return!!s.isPrefixOf(g)&&(g.length===o&&(d=d.add(p.Hr)),!0)}),u),re.resolve(this.Yr(d))}Yr(e){const t=[];return e.forEach((s=>{const o=this.Zr(s);o!==null&&t.push(o)})),t}removeMutationBatch(e,t){pt(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Jr;return re.forEach(t.mutations,(o=>{const c=new sr(o.key,t.batchId);return s=s.delete(c),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)})).next((()=>{this.Jr=s}))}nr(e){}containsKey(e,t){const s=new sr(t,0),o=this.Jr.firstAfterOrEqual(s);return re.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,re.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class A3{constructor(e){this.ti=e,this.docs=(function(){return new as(Je.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,o=this.docs.get(s),c=o?o.size:0,u=this.ti(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:u}),this.size+=u-c,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return re.resolve(s?s.document.mutableCopy():hs.newInvalidDocument(t))}getEntries(e,t){let s=Hr();return t.forEach((o=>{const c=this.docs.get(o);s=s.insert(o,c?c.document.mutableCopy():hs.newInvalidDocument(o))})),re.resolve(s)}getDocumentsMatchingQuery(e,t,s,o){let c=Hr();const u=t.path,d=new Je(u.child("__id-9223372036854775808__")),p=this.docs.getIteratorFrom(d);for(;p.hasNext();){const{key:g,value:{document:b}}=p.getNext();if(!u.isPrefixOf(g.path))break;g.path.length>u.length+1||Nv(vk(b),s)<=0||(o.has(b.key)||Ed(t,b))&&(c=c.insert(b.key,b.mutableCopy()))}return re.resolve(c)}getAllFromCollectionGroup(e,t,s,o){lt(9500)}ni(e,t){return re.forEach(this.docs,(s=>t(s)))}newChangeBuffer(e){return new R3(this)}getSize(e){return re.resolve(this.size)}}class R3 extends $S{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((s,o)=>{o.isValidDocument()?t.push(this.Mr.addEntry(e,o)):this.Mr.removeEntry(s)})),re.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class C3{constructor(e){this.persistence=e,this.ri=new qa((t=>Ul(t)),wd),this.lastRemoteSnapshotVersion=wt.min(),this.highestTargetId=0,this.ii=0,this.si=new Kv,this.targetCount=0,this.oi=Hl._r()}forEachTarget(e,t){return this.ri.forEach(((s,o)=>t(o))),re.resolve()}getLastRemoteSnapshotVersion(e){return re.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return re.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),re.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.ii&&(this.ii=t),re.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Hl(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,re.resolve()}updateTargetData(e,t){return this.lr(t),re.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,re.resolve()}removeTargets(e,t,s){let o=0;const c=[];return this.ri.forEach(((u,d)=>{d.sequenceNumber<=t&&s.get(d.targetId)===null&&(this.ri.delete(u),c.push(this.removeMatchingKeysForTargetId(e,d.targetId)),o++)})),re.waitFor(c).next((()=>o))}getTargetCount(e){return re.resolve(this.targetCount)}getTargetData(e,t){const s=this.ri.get(t)||null;return re.resolve(s)}addMatchingKeys(e,t,s){return this.si.$r(t,s),re.resolve()}removeMatchingKeys(e,t,s){this.si.Qr(t,s);const o=this.persistence.referenceDelegate,c=[];return o&&t.forEach((u=>{c.push(o.markPotentiallyOrphaned(e,u))})),re.waitFor(c)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),re.resolve()}getMatchingKeysForTargetId(e,t){const s=this.si.jr(t);return re.resolve(s)}containsKey(e,t){return re.resolve(this.si.containsKey(t))}}class Qv{constructor(e,t){this._i={},this.overlays={},this.ai=new qr(0),this.ui=!1,this.ui=!0,this.ci=new j3,this.referenceDelegate=e(this),this.li=new C3(this),this.indexManager=new g3,this.remoteDocumentCache=(function(o){return new A3(o)})((s=>this.referenceDelegate.hi(s))),this.serializer=new DS(t),this.Pi=new k3(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new S3,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this._i[e.toKey()];return s||(s=new N3(t,this.referenceDelegate),this._i[e.toKey()]=s),s}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,s){Oe("MemoryPersistence","Starting transaction:",e);const o=new I3(this.ai.next());return this.referenceDelegate.Ti(),s(o).next((c=>this.referenceDelegate.Ii(o).next((()=>c)))).toPromise().then((c=>(o.raiseOnCommittedEvent(),c)))}Ei(e,t){return re.or(Object.values(this._i).map((s=>()=>s.containsKey(e,t))))}}class I3 extends _k{constructor(e){super(),this.currentSequenceNumber=e}}class _p{constructor(e){this.persistence=e,this.Ri=new Kv,this.Ai=null}static Vi(e){return new _p(e)}get di(){if(this.Ai)return this.Ai;throw lt(60996)}addReference(e,t,s){return this.Ri.addReference(s,t),this.di.delete(s.toString()),re.resolve()}removeReference(e,t,s){return this.Ri.removeReference(s,t),this.di.add(s.toString()),re.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),re.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((o=>this.di.add(o.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next((o=>{o.forEach((c=>this.di.add(c.toString())))})).next((()=>s.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return re.forEach(this.di,(s=>{const o=Je.fromPath(s);return this.mi(e,o).next((c=>{c||t.removeEntry(o,wt.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((s=>{s?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return re.or([()=>re.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class $m{constructor(e,t){this.persistence=e,this.fi=new qa((s=>Tr(s.path)),((s,o)=>s.isEqual(o))),this.garbageCollector=qS(this,t)}static Vi(e,t){return new $m(e,t)}Ti(){}Ii(e){return re.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((s=>t.next((o=>s+o))))}pr(e){let t=0;return this.mr(e,(s=>{t++})).next((()=>t))}mr(e,t){return re.forEach(this.fi,((s,o)=>this.wr(e,s,o).next((c=>c?re.resolve():t(o)))))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const o=this.persistence.getRemoteDocumentCache(),c=o.newChangeBuffer();return o.ni(e,(u=>this.wr(e,u,t).next((d=>{d||(s++,c.removeEntry(u,wt.min()))})))).next((()=>c.apply(e))).next((()=>s))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),re.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.fi.set(s,e.currentSequenceNumber),re.resolve()}removeReference(e,t,s){return this.fi.set(s,e.currentSequenceNumber),re.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),re.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=ym(e.data.value)),t}wr(e,t,s){return re.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.fi.get(t);return re.resolve(o!==void 0&&o>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class D3{constructor(e){this.serializer=e}k(e,t,s,o){const c=new op("createOrUpgrade",t);s<1&&o>=1&&((function(p){p.createObjectStore(_d)})(e),(function(p){p.createObjectStore(ed,{keyPath:WP}),p.createObjectStore(Di,{keyPath:h2,autoIncrement:!0}).createIndex(Nl,d2,{unique:!0}),p.createObjectStore(su)})(e),tT(e),(function(p){p.createObjectStore(Tl)})(e));let u=re.resolve();return s<3&&o>=3&&(s!==0&&((function(p){p.deleteObjectStore(iu),p.deleteObjectStore(ru),p.deleteObjectStore(Cl)})(e),tT(e)),u=u.next((()=>(function(p){const g=p.store(Cl),b={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:wt.min().toTimestamp(),targetCount:0};return g.put(Vm,b)})(c)))),s<4&&o>=4&&(s!==0&&(u=u.next((()=>(function(p,g){return g.store(Di).H().next((x=>{p.deleteObjectStore(Di),p.createObjectStore(Di,{keyPath:h2,autoIncrement:!0}).createIndex(Nl,d2,{unique:!0});const T=g.store(Di),N=x.map((B=>T.put(B)));return re.waitFor(N)}))})(e,c)))),u=u.next((()=>{(function(p){p.createObjectStore(au,{keyPath:tM})})(e)}))),s<5&&o>=5&&(u=u.next((()=>this.gi(c)))),s<6&&o>=6&&(u=u.next((()=>((function(p){p.createObjectStore(td)})(e),this.pi(c))))),s<7&&o>=7&&(u=u.next((()=>this.yi(c)))),s<8&&o>=8&&(u=u.next((()=>this.wi(e,c)))),s<9&&o>=9&&(u=u.next((()=>{(function(p){p.objectStoreNames.contains("remoteDocumentChanges")&&p.deleteObjectStore("remoteDocumentChanges")})(e)}))),s<10&&o>=10&&(u=u.next((()=>this.bi(c)))),s<11&&o>=11&&(u=u.next((()=>{(function(p){p.createObjectStore(lp,{keyPath:nM})})(e),(function(p){p.createObjectStore(cp,{keyPath:sM})})(e)}))),s<12&&o>=12&&(u=u.next((()=>{(function(p){const g=p.createObjectStore(up,{keyPath:uM});g.createIndex(Pb,hM,{unique:!1}),g.createIndex(Ak,dM,{unique:!1})})(e)}))),s<13&&o>=13&&(u=u.next((()=>(function(p){const g=p.createObjectStore(Lm,{keyPath:KP});g.createIndex(pm,QP),g.createIndex(kk,YP)})(e))).next((()=>this.Si(e,c))).next((()=>e.deleteObjectStore(Tl)))),s<14&&o>=14&&(u=u.next((()=>this.Di(e,c)))),s<15&&o>=15&&(u=u.next((()=>(function(p){p.createObjectStore(Cv,{keyPath:rM,autoIncrement:!0}).createIndex(Db,iM,{unique:!1}),p.createObjectStore(Uh,{keyPath:aM}).createIndex(jk,oM,{unique:!1}),p.createObjectStore(Fh,{keyPath:lM}).createIndex(Nk,cM,{unique:!1})})(e)))),s<16&&o>=16&&(u=u.next((()=>{t.objectStore(Uh).clear()})).next((()=>{t.objectStore(Fh).clear()}))),s<17&&o>=17&&(u=u.next((()=>{(function(p){p.createObjectStore(Iv,{keyPath:fM})})(e)}))),s<18&&o>=18&&xE()&&(u=u.next((()=>{t.objectStore(Uh).clear()})).next((()=>{t.objectStore(Fh).clear()}))),u}pi(e){let t=0;return e.store(Tl).ee(((s,o)=>{t+=qm(o)})).next((()=>{const s={byteSize:t};return e.store(td).put(Ib,s)}))}gi(e){const t=e.store(ed),s=e.store(Di);return t.H().next((o=>re.forEach(o,(c=>{const u=IDBKeyRange.bound([c.userId,Oo],[c.userId,c.lastAcknowledgedBatchId]);return s.H(Nl,u).next((d=>re.forEach(d,(p=>{pt(p.userId===c.userId,18650,"Cannot process batch from unexpected user",{batchId:p.batchId});const g=kl(this.serializer,p);return OS(e,c.userId,g).next((()=>{}))}))))}))))}yi(e){const t=e.store(iu),s=e.store(Tl);return e.store(Cl).get(Vm).next((o=>{const c=[];return s.ee(((u,d)=>{const p=new fn(u),g=(function(x){return[0,Tr(x)]})(p);c.push(t.get(g).next((b=>b?re.resolve():(x=>t.put({targetId:0,path:Tr(x),sequenceNumber:o.highestListenSequenceNumber}))(p))))})).next((()=>re.waitFor(c)))}))}wi(e,t){e.createObjectStore(nd,{keyPath:eM});const s=t.store(nd),o=new Gv,c=u=>{if(o.add(u)){const d=u.lastSegment(),p=u.popLast();return s.put({collectionId:d,parent:Tr(p)})}};return t.store(Tl).ee({Y:!0},((u,d)=>{const p=new fn(u);return c(p.popLast())})).next((()=>t.store(su).ee({Y:!0},(([u,d,p],g)=>{const b=Yi(d);return c(b.popLast())}))))}bi(e){const t=e.store(ru);return t.ee(((s,o)=>{const c=Mh(o),u=PS(this.serializer,c);return t.put(u)}))}Si(e,t){const s=t.store(Tl),o=[];return s.ee(((c,u)=>{const d=t.store(Lm),p=(function(x){return x.document?new Je(fn.fromString(x.document.name).popFirst(5)):x.noDocument?Je.fromSegments(x.noDocument.path):x.unknownDocument?Je.fromSegments(x.unknownDocument.path):lt(36783)})(u).path.toArray(),g={prefixPath:p.slice(0,p.length-2),collectionGroup:p[p.length-2],documentId:p[p.length-1],readTime:u.readTime||[0,0],unknownDocument:u.unknownDocument,noDocument:u.noDocument,document:u.document,hasCommittedMutations:!!u.hasCommittedMutations};o.push(d.put(g))})).next((()=>re.waitFor(o)))}Di(e,t){const s=t.store(Di),o=HS(this.serializer),c=new Qv(_p.Vi,this.serializer.yt);return s.H().next((u=>{const d=new Map;return u.forEach((p=>{let g=d.get(p.userId)??Zt();kl(this.serializer,p).keys().forEach((b=>g=g.add(b))),d.set(p.userId,g)})),re.forEach(d,((p,g)=>{const b=new rr(g),x=vp.wt(this.serializer,b),T=c.getIndexManager(b),N=xp.wt(b,this.serializer,T,c.referenceDelegate);return new WS(o,N,x,T).recalculateAndSaveOverlaysForDocumentKeys(new Mb(t,qr.ce),p).next()}))}))}}function tT(n){n.createObjectStore(iu,{keyPath:JP}).createIndex(Rv,ZP,{unique:!0}),n.createObjectStore(ru,{keyPath:"targetId"}).createIndex(Sk,XP,{unique:!0}),n.createObjectStore(Cl)}const xo="IndexedDbPersistence",Hy=18e5,Wy=5e3,Gy="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",GS="main";class Yv{constructor(e,t,s,o,c,u,d,p,g,b,x=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=s,this.Ci=c,this.window=u,this.document=d,this.Fi=g,this.Mi=b,this.xi=x,this.ai=null,this.ui=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oi=null,this.inForeground=!1,this.Ni=null,this.Bi=null,this.Li=Number.NEGATIVE_INFINITY,this.ki=T=>Promise.resolve(),!Yv.v())throw new Ie(ce.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new _3(this,o),this.Ki=t+GS,this.serializer=new DS(p),this.qi=new na(this.Ki,this.xi,new D3(this.serializer)),this.ci=new u3,this.li=new b3(this.referenceDelegate,this.serializer),this.remoteDocumentCache=HS(this.serializer),this.Pi=new c3,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,b===!1&&Vs(xo,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.$i().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ie(ce.FAILED_PRECONDITION,Gy);return this.Wi(),this.Qi(),this.Gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.li.getHighestSequenceNumber(e)))})).then((e=>{this.ai=new qr(e,this.Fi)})).then((()=>{this.ui=!0})).catch((e=>(this.qi&&this.qi.close(),Promise.reject(e))))}zi(e){return this.ki=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.qi.q((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ci.enqueueAndForget((async()=>{this.started&&await this.$i()})))}$i(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Yf(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.ji(e).next((t=>{t||(this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))))}))})).next((()=>this.Hi(e))).next((t=>this.isPrimary&&!t?this.Ji(e).next((()=>!1)):!!t&&this.Zi(e).next((()=>!0)))))).catch((e=>{if(Qo(e))return Oe(xo,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Oe(xo,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Ci.enqueueRetryable((()=>this.ki(e))),this.isPrimary=e}))}ji(e){return Eh(e).get(Dc).next((t=>re.resolve(this.Xi(t))))}Yi(e){return Yf(e).delete(this.clientId)}async es(){if(this.isPrimary&&!this.ts(this.Li,Hy)){this.Li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const s=Zs(t,au);return s.H().next((o=>{const c=this.ns(o,Hy),u=o.filter((d=>c.indexOf(d)===-1));return re.forEach(u,(d=>s.delete(d.clientId))).next((()=>u))}))})).catch((()=>[]));if(this.Ui)for(const t of e)this.Ui.removeItem(this.rs(t.clientId))}}Gi(){this.Bi=this.Ci.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.$i().then((()=>this.es())).then((()=>this.Gi()))))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.Mi?re.resolve(!0):Eh(e).get(Dc).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,Wy)&&!this.ss(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new Ie(ce.FAILED_PRECONDITION,Gy);return!1}}return!(!this.networkEnabled||!this.inForeground)||Yf(e).H().next((s=>this.ns(s,Wy).find((o=>{if(this.clientId!==o.clientId){const c=!this.networkEnabled&&o.networkEnabled,u=!this.inForeground&&o.inForeground,d=this.networkEnabled===o.networkEnabled;if(c||u&&d)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Oe(xo,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.ui=!1,this._s(),this.Bi&&(this.Bi.cancel(),this.Bi=null),this.us(),this.cs(),await this.qi.runTransaction("shutdown","readwrite",[_d,au],(e=>{const t=new Mb(e,qr.ce);return this.Ji(t).next((()=>this.Yi(t)))})),this.qi.close(),this.ls()}ns(e,t){return e.filter((s=>this.ts(s.updateTimeMs,t)&&!this.ss(s.clientId)))}hs(){return this.runTransaction("getActiveClients","readonly",(e=>Yf(e).H().next((t=>this.ns(t,Hy).map((s=>s.clientId))))))}get started(){return this.ui}getGlobalsCache(){return this.ci}getMutationQueue(e,t){return xp.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new y3(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return vp.wt(this.serializer,e)}getBundleCache(){return this.Pi}runTransaction(e,t,s){Oe(xo,"Starting transaction:",e);const o=t==="readonly"?"readonly":"readwrite",c=(function(p){return p===18?gM:p===17?Dk:p===16?pM:p===15?Dv:p===14?Ik:p===13?Ck:p===12?mM:p===11?Rk:void lt(60245)})(this.xi);let u;return this.qi.runTransaction(e,o,c,(d=>(u=new Mb(d,this.ai?this.ai.next():qr.ce),t==="readwrite-primary"?this.ji(u).next((p=>!!p||this.Hi(u))).next((p=>{if(!p)throw Vs(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))),new Ie(ce.FAILED_PRECONDITION,xk);return s(u)})).next((p=>this.Zi(u).next((()=>p)))):this.Ps(u).next((()=>s(u)))))).then((d=>(u.raiseOnCommittedEvent(),d)))}Ps(e){return Eh(e).get(Dc).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,Wy)&&!this.ss(t.ownerId)&&!this.Xi(t)&&!(this.Mi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Ie(ce.FAILED_PRECONDITION,Gy)}))}Zi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Eh(e).put(Dc,t)}static v(){return na.v()}Ji(e){const t=Eh(e);return t.get(Dc).next((s=>this.Xi(s)?(Oe(xo,"Releasing primary lease."),t.delete(Dc)):re.resolve()))}ts(e,t){const s=Date.now();return!(e<s-t)&&(!(e>s)||(Vs(`Detected an update time that is in the future: ${e} > ${s}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ni=()=>{this.Ci.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.$i())))},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground=this.document.visibilityState==="visible")}us(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)}Qi(){typeof this.window?.addEventListener=="function"&&(this.Oi=()=>{this._s();const e=/(?:Version|Mobile)\/1[456]/;vE()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Ci.enterRestrictedMode(!0),this.Ci.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Oi))}cs(){this.Oi&&(this.window.removeEventListener("pagehide",this.Oi),this.Oi=null)}ss(e){try{const t=this.Ui?.getItem(this.rs(e))!==null;return Oe(xo,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Vs(xo,"Failed to get zombied client id.",t),!1}}_s(){if(this.Ui)try{this.Ui.setItem(this.rs(this.clientId),String(Date.now()))}catch(e){Vs("Failed to set zombie client id.",e)}}ls(){if(this.Ui)try{this.Ui.removeItem(this.rs(this.clientId))}catch{}}rs(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Eh(n){return Zs(n,_d)}function Yf(n){return Zs(n,au)}function Xv(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Jv{constructor(e,t,s,o){this.targetId=e,this.fromCache=t,this.Ts=s,this.Is=o}static Es(e,t){let s=Zt(),o=Zt();for(const c of t.docChanges)switch(c.type){case 0:s=s.add(c.doc.key);break;case 1:o=o.add(c.doc.key)}return new Jv(e,t.fromCache,s,o)}}class P3{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class KS{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return vE()?8:wk(Js())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,s,o){const c={result:null};return this.gs(e,t).next((u=>{c.result=u})).next((()=>{if(!c.result)return this.ps(e,t,o,s).next((u=>{c.result=u}))})).next((()=>{if(c.result)return;const u=new P3;return this.ys(e,t,u).next((d=>{if(c.result=d,this.As)return this.ws(e,t,u,d.size)}))})).next((()=>c.result))}ws(e,t,s,o){return s.documentReadCount<this.Vs?(zc()<=wn.DEBUG&&Oe("QueryEngine","SDK will not create cache indexes for query:",qc(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),re.resolve()):(zc()<=wn.DEBUG&&Oe("QueryEngine","Query:",qc(t),"scans",s.documentReadCount,"local documents and returns",o,"documents as results."),s.documentReadCount>this.ds*o?(zc()<=wn.DEBUG&&Oe("QueryEngine","The SDK decides to create cache indexes for query:",qc(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Er(t))):re.resolve())}gs(e,t){if(k2(t))return re.resolve(null);let s=Er(t);return this.indexManager.getIndexType(e,s).next((o=>o===0?null:(t.limit!==null&&o===1&&(t=Um(t,null,"F"),s=Er(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next((c=>{const u=Zt(...c);return this.fs.getDocuments(e,u).next((d=>this.indexManager.getMinOffset(e,s).next((p=>{const g=this.bs(t,d);return this.Ss(t,g,u,p.readTime)?this.gs(e,Um(t,null,"F")):this.Ds(e,g,t,p)}))))})))))}ps(e,t,s,o){return k2(t)||o.isEqual(wt.min())?re.resolve(null):this.fs.getDocuments(e,s).next((c=>{const u=this.bs(t,c);return this.Ss(t,u,s,o)?re.resolve(null):(zc()<=wn.DEBUG&&Oe("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),qc(t)),this.Ds(e,u,t,bk(o,eu)).next((d=>d)))}))}bs(e,t){let s=new Qn(sS(e));return t.forEach(((o,c)=>{Ed(e,c)&&(s=s.add(c))})),s}Ss(e,t,s,o){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const c=e.limitType==="F"?t.last():t.first();return!!c&&(c.hasPendingWrites||c.version.compareTo(o)>0)}ys(e,t,s){return zc()<=wn.DEBUG&&Oe("QueryEngine","Using full collection scan to execute query:",qc(t)),this.fs.getDocumentsMatchingQuery(e,t,ai.min(),s)}Ds(e,t,s,o){return this.fs.getDocumentsMatchingQuery(e,s,o).next((c=>(t.forEach((u=>{c=c.insert(u.key,u)})),c)))}}const Zv="LocalStore",M3=3e8;class L3{constructor(e,t,s,o){this.persistence=e,this.Cs=t,this.serializer=o,this.vs=new as(Ft),this.Fs=new qa((c=>Ul(c)),wd),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(s)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new WS(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function QS(n,e,t,s){return new L3(n,e,t,s)}async function YS(n,e){const t=Ze(n);return await t.persistence.runTransaction("Handle user change","readonly",(s=>{let o;return t.mutationQueue.getAllMutationBatches(s).next((c=>(o=c,t.Os(e),t.mutationQueue.getAllMutationBatches(s)))).next((c=>{const u=[],d=[];let p=Zt();for(const g of o){u.push(g.batchId);for(const b of g.mutations)p=p.add(b.key)}for(const g of c){d.push(g.batchId);for(const b of g.mutations)p=p.add(b.key)}return t.localDocuments.getDocuments(s,p).next((g=>({Ns:g,removedBatchIds:u,addedBatchIds:d})))}))}))}function V3(n,e){const t=Ze(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(s=>{const o=e.batch.keys(),c=t.xs.newChangeBuffer({trackRemovals:!0});return(function(d,p,g,b){const x=g.batch,T=x.keys();let N=re.resolve();return T.forEach((B=>{N=N.next((()=>b.getEntry(p,B))).next((M=>{const P=g.docVersions.get(B);pt(P!==null,48541),M.version.compareTo(P)<0&&(x.applyToRemoteDocument(M,g),M.isValidDocument()&&(M.setReadTime(g.commitVersion),b.addEntry(M)))}))})),N.next((()=>d.mutationQueue.removeMutationBatch(p,x)))})(t,s,e,c).next((()=>c.apply(s))).next((()=>t.mutationQueue.performConsistencyCheck(s))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(s,o,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,(function(d){let p=Zt();for(let g=0;g<d.mutationResults.length;++g)d.mutationResults[g].transformResults.length>0&&(p=p.add(d.batch.mutations[g].key));return p})(e)))).next((()=>t.localDocuments.getDocuments(s,o)))}))}function XS(n){const e=Ze(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function O3(n,e){const t=Ze(n),s=e.snapshotVersion;let o=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(c=>{const u=t.xs.newChangeBuffer({trackRemovals:!0});o=t.vs;const d=[];e.targetChanges.forEach(((b,x)=>{const T=o.get(x);if(!T)return;d.push(t.li.removeMatchingKeys(c,b.removedDocuments,x).next((()=>t.li.addMatchingKeys(c,b.addedDocuments,x))));let N=T.withSequenceNumber(c.currentSequenceNumber);e.targetMismatches.get(x)!==null?N=N.withResumeToken(As.EMPTY_BYTE_STRING,wt.min()).withLastLimboFreeSnapshotVersion(wt.min()):b.resumeToken.approximateByteSize()>0&&(N=N.withResumeToken(b.resumeToken,s)),o=o.insert(x,N),(function(M,P,Y){return M.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-M.snapshotVersion.toMicroseconds()>=M3?!0:Y.addedDocuments.size+Y.modifiedDocuments.size+Y.removedDocuments.size>0})(T,N,b)&&d.push(t.li.updateTargetData(c,N))}));let p=Hr(),g=Zt();if(e.documentUpdates.forEach((b=>{e.resolvedLimboDocuments.has(b)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(c,b))})),d.push(JS(c,u,e.documentUpdates).next((b=>{p=b.Bs,g=b.Ls}))),!s.isEqual(wt.min())){const b=t.li.getLastRemoteSnapshotVersion(c).next((x=>t.li.setTargetsMetadata(c,c.currentSequenceNumber,s)));d.push(b)}return re.waitFor(d).next((()=>u.apply(c))).next((()=>t.localDocuments.getLocalViewOfDocuments(c,p,g))).next((()=>p))})).then((c=>(t.vs=o,c)))}function JS(n,e,t){let s=Zt(),o=Zt();return t.forEach((c=>s=s.add(c))),e.getEntries(n,s).next((c=>{let u=Hr();return t.forEach(((d,p)=>{const g=c.get(d);p.isFoundDocument()!==g.isFoundDocument()&&(o=o.add(d)),p.isNoDocument()&&p.version.isEqual(wt.min())?(e.removeEntry(d,p.readTime),u=u.insert(d,p)):!g.isValidDocument()||p.version.compareTo(g.version)>0||p.version.compareTo(g.version)===0&&g.hasPendingWrites?(e.addEntry(p),u=u.insert(d,p)):Oe(Zv,"Ignoring outdated watch update for ",d,". Current version:",g.version," Watch version:",p.version)})),{Bs:u,Ls:o}}))}function B3(n,e){const t=Ze(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(s=>(e===void 0&&(e=Oo),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e))))}function fu(n,e){const t=Ze(n);return t.persistence.runTransaction("Allocate target","readwrite",(s=>{let o;return t.li.getTargetData(s,e).next((c=>c?(o=c,re.resolve(o)):t.li.allocateTargetId(s).next((u=>(o=new Aa(e,u,"TargetPurposeListen",s.currentSequenceNumber),t.li.addTargetData(s,o).next((()=>o)))))))})).then((s=>{const o=t.vs.get(s.targetId);return(o===null||s.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.vs=t.vs.insert(s.targetId,s),t.Fs.set(e,s.targetId)),s}))}async function mu(n,e,t){const s=Ze(n),o=s.vs.get(e),c=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",c,(u=>s.persistence.referenceDelegate.removeTarget(u,o)))}catch(u){if(!Qo(u))throw u;Oe(Zv,`Failed to update sequence numbers for target ${e}: ${u}`)}s.vs=s.vs.remove(e),s.Fs.delete(o.target)}function Hm(n,e,t){const s=Ze(n);let o=wt.min(),c=Zt();return s.persistence.runTransaction("Execute query","readwrite",(u=>(function(p,g,b){const x=Ze(p),T=x.Fs.get(b);return T!==void 0?re.resolve(x.vs.get(T)):x.li.getTargetData(g,b)})(s,u,Er(e)).next((d=>{if(d)return o=d.lastLimboFreeSnapshotVersion,s.li.getMatchingKeysForTargetId(u,d.targetId).next((p=>{c=p}))})).next((()=>s.Cs.getDocumentsMatchingQuery(u,e,t?o:wt.min(),t?c:Zt()))).next((d=>(tj(s,nS(e),d),{documents:d,ks:c})))))}function ZS(n,e){const t=Ze(n),s=Ze(t.li),o=t.vs.get(e);return o?Promise.resolve(o.target):t.persistence.runTransaction("Get target data","readonly",(c=>s.At(c,e).next((u=>u?u.target:null))))}function ej(n,e){const t=Ze(n),s=t.Ms.get(e)||wt.min();return t.persistence.runTransaction("Get new document changes","readonly",(o=>t.xs.getAllFromCollectionGroup(o,e,bk(s,eu),Number.MAX_SAFE_INTEGER))).then((o=>(tj(t,e,o),o)))}function tj(n,e,t){let s=n.Ms.get(e)||wt.min();t.forEach(((o,c)=>{c.readTime.compareTo(s)>0&&(s=c.readTime)})),n.Ms.set(e,s)}async function U3(n,e,t,s){const o=Ze(n);let c=Zt(),u=Hr();for(const g of t){const b=e.Ks(g.metadata.name);g.document&&(c=c.add(b));const x=e.qs(g);x.setReadTime(e.Us(g.metadata.readTime)),u=u.insert(b,x)}const d=o.xs.newChangeBuffer({trackRemovals:!0}),p=await fu(o,(function(b){return Er(ku(fn.fromString(`__bundle__/docs/${b}`)))})(s));return o.persistence.runTransaction("Apply bundle documents","readwrite",(g=>JS(g,d,u).next((b=>(d.apply(g),b))).next((b=>o.li.removeMatchingKeysForTargetId(g,p.targetId).next((()=>o.li.addMatchingKeys(g,c,p.targetId))).next((()=>o.localDocuments.getLocalViewOfDocuments(g,b.Bs,b.Ls))).next((()=>b.Bs))))))}async function F3(n,e,t=Zt()){const s=await fu(n,Er(bp(e.bundledQuery))),o=Ze(n);return o.persistence.runTransaction("Save named query","readwrite",(c=>{const u=Os(e.readTime);if(s.snapshotVersion.compareTo(u)>=0)return o.Pi.saveNamedQuery(c,e);const d=s.withResumeToken(As.EMPTY_BYTE_STRING,u);return o.vs=o.vs.insert(d.targetId,d),o.li.updateTargetData(c,d).next((()=>o.li.removeMatchingKeysForTargetId(c,s.targetId))).next((()=>o.li.addMatchingKeys(c,t,s.targetId))).next((()=>o.Pi.saveNamedQuery(c,e)))}))}const nj="firestore_clients";function nT(n,e){return`${nj}_${n}_${e}`}const sj="firestore_mutations";function sT(n,e,t){let s=`${sj}_${n}_${t}`;return e.isAuthenticated()&&(s+=`_${e.uid}`),s}const rj="firestore_targets";function Ky(n,e){return`${rj}_${n}_${e}`}const Qi="SharedClientState";class Wm{constructor(e,t,s,o){this.user=e,this.batchId=t,this.state=s,this.error=o}static $s(e,t,s){const o=JSON.parse(s);let c,u=typeof o=="object"&&["pending","acknowledged","rejected"].indexOf(o.state)!==-1&&(o.error===void 0||typeof o.error=="object");return u&&o.error&&(u=typeof o.error.message=="string"&&typeof o.error.code=="string",u&&(c=new Ie(o.error.code,o.error.message))),u?new Wm(e,t,o.state,c):(Vs(Qi,`Failed to parse mutation state for ID '${t}': ${s}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Hh{constructor(e,t,s){this.targetId=e,this.state=t,this.error=s}static $s(e,t){const s=JSON.parse(t);let o,c=typeof s=="object"&&["not-current","current","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return c&&s.error&&(c=typeof s.error.message=="string"&&typeof s.error.code=="string",c&&(o=new Ie(s.error.code,s.error.message))),c?new Hh(e,s.state,o):(Vs(Qi,`Failed to parse target state for ID '${e}': ${t}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Gm{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static $s(e,t){const s=JSON.parse(t);let o=typeof s=="object"&&s.activeTargetIds instanceof Array,c=Ov();for(let u=0;o&&u<s.activeTargetIds.length;++u)o=Tk(s.activeTargetIds[u]),c=c.add(s.activeTargetIds[u]);return o?new Gm(e,c):(Vs(Qi,`Failed to parse client data for instance '${e}': ${t}`),null)}}class e0{constructor(e,t){this.clientId=e,this.onlineState=t}static $s(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new e0(t.clientId,t.onlineState):(Vs(Qi,`Failed to parse online state: ${e}`),null)}}class Yb{constructor(){this.activeTargetIds=Ov()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Qy{constructor(e,t,s,o,c){this.window=e,this.Ci=t,this.persistenceKey=s,this.zs=o,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.js=this.Hs.bind(this),this.Js=new as(Ft),this.started=!1,this.Zs=[];const u=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=c,this.Xs=nT(this.persistenceKey,this.zs),this.Ys=(function(p){return`firestore_sequence_number_${p}`})(this.persistenceKey),this.Js=this.Js.insert(this.zs,new Yb),this.eo=new RegExp(`^${nj}_${u}_([^_]*)$`),this.no=new RegExp(`^${sj}_${u}_(\\d+)(?:_(.*))?$`),this.ro=new RegExp(`^${rj}_${u}_(\\d+)$`),this.io=(function(p){return`firestore_online_state_${p}`})(this.persistenceKey),this.so=(function(p){return`firestore_bundle_loaded_v2_${p}`})(this.persistenceKey),this.window.addEventListener("storage",this.js)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.hs();for(const s of e){if(s===this.zs)continue;const o=this.getItem(nT(this.persistenceKey,s));if(o){const c=Gm.$s(s,o);c&&(this.Js=this.Js.insert(c.clientId,c))}}this.oo();const t=this.storage.getItem(this.io);if(t){const s=this._o(t);s&&this.ao(s)}for(const s of this.Zs)this.Hs(s);this.Zs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ys,JSON.stringify(e))}getAllActiveQueryTargets(){return this.uo(this.Js)}isActiveQueryTarget(e){let t=!1;return this.Js.forEach(((s,o)=>{o.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.co(e,"pending")}updateMutationState(e,t,s){this.co(e,t,s),this.lo(e)}addLocalQueryTarget(e,t=!0){let s="not-current";if(this.isActiveQueryTarget(e)){const o=this.storage.getItem(Ky(this.persistenceKey,e));if(o){const c=Hh.$s(e,o);c&&(s=c.state)}}return t&&this.ho.Qs(e),this.oo(),s}removeLocalQueryTarget(e){this.ho.Gs(e),this.oo()}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Ky(this.persistenceKey,e))}updateQueryState(e,t,s){this.Po(e,t,s)}handleUserChange(e,t,s){t.forEach((o=>{this.lo(o)})),this.currentUser=e,s.forEach((o=>{this.addPendingMutation(o)}))}setOnlineState(e){this.To(e)}notifyBundleLoaded(e){this.Io(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.js),this.removeItem(this.Xs),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Oe(Qi,"READ",e,t),t}setItem(e,t){Oe(Qi,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){Oe(Qi,"REMOVE",e),this.storage.removeItem(e)}Hs(e){const t=e;if(t.storageArea===this.storage){if(Oe(Qi,"EVENT",t.key,t.newValue),t.key===this.Xs)return void Vs("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ci.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.eo.test(t.key)){if(t.newValue==null){const s=this.Eo(t.key);return this.Ro(s,null)}{const s=this.Ao(t.key,t.newValue);if(s)return this.Ro(s.clientId,s)}}else if(this.no.test(t.key)){if(t.newValue!==null){const s=this.Vo(t.key,t.newValue);if(s)return this.mo(s)}}else if(this.ro.test(t.key)){if(t.newValue!==null){const s=this.fo(t.key,t.newValue);if(s)return this.po(s)}}else if(t.key===this.io){if(t.newValue!==null){const s=this._o(t.newValue);if(s)return this.ao(s)}}else if(t.key===this.Ys){const s=(function(c){let u=qr.ce;if(c!=null)try{const d=JSON.parse(c);pt(typeof d=="number",30636,{yo:c}),u=d}catch(d){Vs(Qi,"Failed to read sequence number from WebStorage",d)}return u})(t.newValue);s!==qr.ce&&this.sequenceNumberHandler(s)}else if(t.key===this.so){const s=this.wo(t.newValue);await Promise.all(s.map((o=>this.syncEngine.bo(o))))}}}else this.Zs.push(t)}))}}get ho(){return this.Js.get(this.zs)}oo(){this.setItem(this.Xs,this.ho.Ws())}co(e,t,s){const o=new Wm(this.currentUser,e,t,s),c=sT(this.persistenceKey,this.currentUser,e);this.setItem(c,o.Ws())}lo(e){const t=sT(this.persistenceKey,this.currentUser,e);this.removeItem(t)}To(e){const t={clientId:this.zs,onlineState:e};this.storage.setItem(this.io,JSON.stringify(t))}Po(e,t,s){const o=Ky(this.persistenceKey,e),c=new Hh(e,t,s);this.setItem(o,c.Ws())}Io(e){const t=JSON.stringify(Array.from(e));this.setItem(this.so,t)}Eo(e){const t=this.eo.exec(e);return t?t[1]:null}Ao(e,t){const s=this.Eo(e);return Gm.$s(s,t)}Vo(e,t){const s=this.no.exec(e),o=Number(s[1]),c=s[2]!==void 0?s[2]:null;return Wm.$s(new rr(c),o,t)}fo(e,t){const s=this.ro.exec(e),o=Number(s[1]);return Hh.$s(o,t)}_o(e){return e0.$s(e)}wo(e){return JSON.parse(e)}async mo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.So(e.batchId,e.state,e.error);Oe(Qi,`Ignoring mutation for non-active user ${e.user.uid}`)}po(e){return this.syncEngine.Do(e.targetId,e.state,e.error)}Ro(e,t){const s=t?this.Js.insert(e,t):this.Js.remove(e),o=this.uo(this.Js),c=this.uo(s),u=[],d=[];return c.forEach((p=>{o.has(p)||u.push(p)})),o.forEach((p=>{c.has(p)||d.push(p)})),this.syncEngine.Co(u,d).then((()=>{this.Js=s}))}ao(e){this.Js.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}uo(e){let t=Ov();return e.forEach(((s,o)=>{t=t.unionWith(o.activeTargetIds)})),t}}class ij{constructor(){this.vo=new Yb,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,s){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Yb,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class z3{Mo(e){}shutdown(){}}const rT="ConnectivityMonitor";class iT{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){Oe(rT,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){Oe(rT,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Xf=null;function Xb(){return Xf===null?Xf=(function(){return 268435456+Math.round(2147483648*Math.random())})():Xf++,"0x"+Xf.toString(16)}const Yy="RestConnection",q3={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class $3{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${s}/databases/${o}`,this.$o=this.databaseId.database===rd?`project_id=${s}`:`project_id=${s}&database_id=${o}`}Wo(e,t,s,o,c){const u=Xb(),d=this.Qo(e,t.toUriEncodedString());Oe(Yy,`Sending RPC '${e}' ${u}:`,d,s);const p={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(p,o,c);const{host:g}=new URL(d),b=Ba(g);return this.zo(e,d,p,s,b).then((x=>(Oe(Yy,`Received RPC '${e}' ${u}: `,x),x)),(x=>{throw wi(Yy,`RPC '${e}' ${u} failed with error: `,x,"url: ",d,"request:",s),x}))}jo(e,t,s,o,c,u){return this.Wo(e,t,s,o,c)}Go(e,t,s){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Eu})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((o,c)=>e[c]=o)),s&&s.headers.forEach(((o,c)=>e[c]=o))}Qo(e,t){const s=q3[e];let o=`${this.qo}/v1/${t}:${s}`;return this.databaseInfo.apiKey&&(o=`${o}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),o}terminate(){}}class H3{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const _r="WebChannelConnection",kh=(n,e,t)=>{n.listen(e,(s=>{try{t(s)}catch(o){setTimeout((()=>{throw o}),0)}}))};class Xc extends $3{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Xc.c_){const e=hk();kh(e,uk.STAT_EVENT,(t=>{t.stat===jb.PROXY?Oe(_r,"STAT_EVENT: detected buffering proxy"):t.stat===jb.NOPROXY&&Oe(_r,"STAT_EVENT: detected no buffering proxy")})),Xc.c_=!0}}zo(e,t,s,o,c){const u=Xb();return new Promise(((d,p)=>{const g=new lk;g.setWithCredentials(!0),g.listenOnce(ck.COMPLETE,(()=>{try{switch(g.getLastErrorCode()){case fm.NO_ERROR:const x=g.getResponseJson();Oe(_r,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(x)),d(x);break;case fm.TIMEOUT:Oe(_r,`RPC '${e}' ${u} timed out`),p(new Ie(ce.DEADLINE_EXCEEDED,"Request time out"));break;case fm.HTTP_ERROR:const T=g.getStatus();if(Oe(_r,`RPC '${e}' ${u} failed with status:`,T,"response text:",g.getResponseText()),T>0){let N=g.getResponseJson();Array.isArray(N)&&(N=N[0]);const B=N?.error;if(B&&B.status&&B.message){const M=(function(Y){const $=Y.toLowerCase().replace(/_/g,"-");return Object.values(ce).indexOf($)>=0?$:ce.UNKNOWN})(B.status);p(new Ie(M,B.message))}else p(new Ie(ce.UNKNOWN,"Server responded with status "+g.getStatus()))}else p(new Ie(ce.UNAVAILABLE,"Connection failed."));break;default:lt(9055,{l_:e,streamId:u,h_:g.getLastErrorCode(),P_:g.getLastError()})}}finally{Oe(_r,`RPC '${e}' ${u} completed.`)}}));const b=JSON.stringify(o);Oe(_r,`RPC '${e}' ${u} sending request:`,o),g.send(t,"POST",b,s,15)}))}T_(e,t,s){const o=Xb(),c=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=this.createWebChannelTransport(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(d.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Go(d.initMessageHeaders,t,s),d.encodeInitMessageHeaders=!0;const g=c.join("");Oe(_r,`Creating RPC '${e}' stream ${o}: ${g}`,d);const b=u.createWebChannel(g,d);this.I_(b);let x=!1,T=!1;const N=new H3({Ho:B=>{T?Oe(_r,`Not sending because RPC '${e}' stream ${o} is closed:`,B):(x||(Oe(_r,`Opening RPC '${e}' stream ${o} transport.`),b.open(),x=!0),Oe(_r,`RPC '${e}' stream ${o} sending:`,B),b.send(B))},Jo:()=>b.close()});return kh(b,Ih.EventType.OPEN,(()=>{T||(Oe(_r,`RPC '${e}' stream ${o} transport opened.`),N.i_())})),kh(b,Ih.EventType.CLOSE,(()=>{T||(T=!0,Oe(_r,`RPC '${e}' stream ${o} transport closed`),N.o_(),this.E_(b))})),kh(b,Ih.EventType.ERROR,(B=>{T||(T=!0,wi(_r,`RPC '${e}' stream ${o} transport errored. Name:`,B.name,"Message:",B.message),N.o_(new Ie(ce.UNAVAILABLE,"The operation could not be completed")))})),kh(b,Ih.EventType.MESSAGE,(B=>{if(!T){const M=B.data[0];pt(!!M,16349);const P=M,Y=P?.error||P[0]?.error;if(Y){Oe(_r,`RPC '${e}' stream ${o} received error:`,Y);const $=Y.status;let J=(function(we){const A=Hs[we];if(A!==void 0)return yS(A)})($),de=Y.message;J===void 0&&(J=ce.INTERNAL,de="Unknown error status: "+$+" with message "+Y.message),T=!0,N.o_(new Ie(J,de)),b.close()}else Oe(_r,`RPC '${e}' stream ${o} received:`,M),N.__(M)}})),Xc.u_(),setTimeout((()=>{N.s_()}),0),N}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,s){super.Go(e,t,s),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return dk()}}function W3(n){return new Xc(n)}function aj(){return typeof window<"u"?window:null}function wm(){return typeof document<"u"?document:null}function Xl(n){return new JM(n,!0)}Xc.c_=!1;class t0{constructor(e,t,s=1e3,o=1.5,c=6e4){this.Ci=e,this.timerId=t,this.R_=s,this.A_=o,this.V_=c,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),s=Math.max(0,Date.now()-this.f_),o=Math.max(0,t-s);o>0&&Oe("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,o,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const aT="PersistentStream";class oj{constructor(e,t,s,o,c,u,d,p){this.Ci=e,this.b_=s,this.S_=o,this.connection=c,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=d,this.listener=p,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new t0(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ce.RESOURCE_EXHAUSTED?(Vs(t.toString()),Vs("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ce.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([s,o])=>{this.D_===t&&this.G_(s,o)}),(s=>{e((()=>{const o=new Ie(ce.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(o)}))}))}G_(e,t){const s=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{s((()=>this.listener.Zo()))})),this.stream.Yo((()=>{s((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((o=>{s((()=>this.z_(o)))})),this.stream.onMessage((o=>{s((()=>++this.F_==1?this.H_(o):this.onNext(o)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Oe(aT,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(Oe(aT,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class G3 extends oj{constructor(e,t,s,o,c,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,o,u),this.serializer=c}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=t3(this.serializer,e),s=(function(c){if(!("targetChange"in c))return wt.min();const u=c.targetChange;return u.targetIds&&u.targetIds.length?wt.min():u.readTime?Os(u.readTime):wt.min()})(e);return this.listener.J_(t,s)}Z_(e){const t={};t.database=Hb(this.serializer),t.addTarget=(function(c,u){let d;const p=u.target;if(d=Om(p)?{documents:SS(c,p)}:{query:yp(c,p).ft},d.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){d.resumeToken=_S(c,u.resumeToken);const g=qb(c,u.expectedCount);g!==null&&(d.expectedCount=g)}else if(u.snapshotVersion.compareTo(wt.min())>0){d.readTime=du(c,u.snapshotVersion.toTimestamp());const g=qb(c,u.expectedCount);g!==null&&(d.expectedCount=g)}return d})(this.serializer,e);const s=s3(this.serializer,e);s&&(t.labels=s),this.K_(t)}X_(e){const t={};t.database=Hb(this.serializer),t.removeTarget=e,this.K_(t)}}class K3 extends oj{constructor(e,t,s,o,c,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,o,u),this.serializer=c}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return pt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,pt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){pt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=n3(e.writeResults,e.commitTime),s=Os(e.commitTime);return this.listener.na(s,t)}ra(){const e={};e.database=Hb(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((s=>cd(this.serializer,s)))};this.K_(t)}}class Q3{}class Y3 extends Q3{constructor(e,t,s,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new Ie(ce.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,s,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,u])=>this.connection.Wo(e,$b(t,s),o,c,u))).catch((c=>{throw c.name==="FirebaseError"?(c.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new Ie(ce.UNKNOWN,c.toString())}))}jo(e,t,s,o,c){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.jo(e,$b(t,s),o,u,d,c))).catch((u=>{throw u.name==="FirebaseError"?(u.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new Ie(ce.UNKNOWN,u.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function X3(n,e,t,s){return new Y3(n,e,t,s)}class J3{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Vs(t),this.aa=!1):Oe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Wl="RemoteStore";class Z3{constructor(e,t,s,o,c){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=c,this.Aa.Mo((u=>{s.enqueueAndForget((async()=>{Xo(this)&&(Oe(Wl,"Restarting streams for network reachability change."),await(async function(p){const g=Ze(p);g.Ea.add(4),await Nu(g),g.Va.set("Unknown"),g.Ea.delete(4),await Nd(g)})(this))}))})),this.Va=new J3(s,o)}}async function Nd(n){if(Xo(n))for(const e of n.Ra)await e(!0)}async function Nu(n){for(const e of n.Ra)await e(!1)}function wp(n,e){const t=Ze(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),r0(t)?s0(t):Ru(t).O_()&&n0(t,e))}function pu(n,e){const t=Ze(n),s=Ru(t);t.Ia.delete(e),s.O_()&&lj(t,e),t.Ia.size===0&&(s.O_()?s.L_():Xo(t)&&t.Va.set("Unknown"))}function n0(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(wt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ru(n).Z_(e)}function lj(n,e){n.da.$e(e),Ru(n).X_(e)}function s0(n){n.da=new KM({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Ru(n).start(),n.Va.ua()}function r0(n){return Xo(n)&&!Ru(n).x_()&&n.Ia.size>0}function Xo(n){return Ze(n).Ea.size===0}function cj(n){n.da=void 0}async function e6(n){n.Va.set("Online")}async function t6(n){n.Ia.forEach(((e,t)=>{n0(n,e)}))}async function n6(n,e){cj(n),r0(n)?(n.Va.ha(e),s0(n)):n.Va.set("Unknown")}async function s6(n,e,t){if(n.Va.set("Online"),e instanceof xS&&e.state===2&&e.cause)try{await(async function(o,c){const u=c.cause;for(const d of c.targetIds)o.Ia.has(d)&&(await o.remoteSyncer.rejectListen(d,u),o.Ia.delete(d),o.da.removeTarget(d))})(n,e)}catch(s){Oe(Wl,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await Km(n,s)}else if(e instanceof xm?n.da.Xe(e):e instanceof vS?n.da.st(e):n.da.tt(e),!t.isEqual(wt.min()))try{const s=await XS(n.localStore);t.compareTo(s)>=0&&await(function(c,u){const d=c.da.Tt(u);return d.targetChanges.forEach(((p,g)=>{if(p.resumeToken.approximateByteSize()>0){const b=c.Ia.get(g);b&&c.Ia.set(g,b.withResumeToken(p.resumeToken,u))}})),d.targetMismatches.forEach(((p,g)=>{const b=c.Ia.get(p);if(!b)return;c.Ia.set(p,b.withResumeToken(As.EMPTY_BYTE_STRING,b.snapshotVersion)),lj(c,p);const x=new Aa(b.target,p,g,b.sequenceNumber);n0(c,x)})),c.remoteSyncer.applyRemoteEvent(d)})(n,t)}catch(s){Oe(Wl,"Failed to raise snapshot:",s),await Km(n,s)}}async function Km(n,e,t){if(!Qo(e))throw e;n.Ea.add(1),await Nu(n),n.Va.set("Offline"),t||(t=()=>XS(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Oe(Wl,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Nd(n)}))}function uj(n,e){return e().catch((t=>Km(n,t,e)))}async function Au(n){const e=Ze(n),t=$o(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Oo;for(;r6(e);)try{const o=await B3(e.localStore,s);if(o===null){e.Ta.length===0&&t.L_();break}s=o.batchId,i6(e,o)}catch(o){await Km(e,o)}hj(e)&&dj(e)}function r6(n){return Xo(n)&&n.Ta.length<10}function i6(n,e){n.Ta.push(e);const t=$o(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function hj(n){return Xo(n)&&!$o(n).x_()&&n.Ta.length>0}function dj(n){$o(n).start()}async function a6(n){$o(n).ra()}async function o6(n){const e=$o(n);for(const t of n.Ta)e.ea(t.mutations)}async function l6(n,e,t){const s=n.Ta.shift(),o=zv.from(s,e,t);await uj(n,(()=>n.remoteSyncer.applySuccessfulWrite(o))),await Au(n)}async function c6(n,e){e&&$o(n).Y_&&await(async function(s,o){if((function(u){return gS(u)&&u!==ce.ABORTED})(o.code)){const c=s.Ta.shift();$o(s).B_(),await uj(s,(()=>s.remoteSyncer.rejectFailedWrite(c.batchId,o))),await Au(s)}})(n,e),hj(n)&&dj(n)}async function oT(n,e){const t=Ze(n);t.asyncQueue.verifyOperationInProgress(),Oe(Wl,"RemoteStore received new credentials");const s=Xo(t);t.Ea.add(3),await Nu(t),s&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Nd(t)}async function Jb(n,e){const t=Ze(n);e?(t.Ea.delete(2),await Nd(t)):e||(t.Ea.add(2),await Nu(t),t.Va.set("Unknown"))}function Ru(n){return n.ma||(n.ma=(function(t,s,o){const c=Ze(t);return c.sa(),new G3(s,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)})(n.datastore,n.asyncQueue,{Zo:e6.bind(null,n),Yo:t6.bind(null,n),t_:n6.bind(null,n),J_:s6.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),r0(n)?s0(n):n.Va.set("Unknown")):(await n.ma.stop(),cj(n))}))),n.ma}function $o(n){return n.fa||(n.fa=(function(t,s,o){const c=Ze(t);return c.sa(),new K3(s,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:a6.bind(null,n),t_:c6.bind(null,n),ta:o6.bind(null,n),na:l6.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await Au(n)):(await n.fa.stop(),n.Ta.length>0&&(Oe(Wl,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class i0{constructor(e,t,s,o,c){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=o,this.removalCallback=c,this.deferred=new ar,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((u=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,o,c){const u=Date.now()+s,d=new i0(e,t,u,o,c);return d.start(s),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ie(ce.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Cu(n,e){if(Vs("AsyncQueue",`${e}: ${n}`),Qo(n))return new Ie(ce.UNAVAILABLE,`${e}: ${n}`);throw n}class Il{static emptySet(e){return new Il(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||Je.comparator(t.key,s.key):(t,s)=>Je.comparator(t.key,s.key),this.keyedMap=Dh(),this.sortedSet=new as(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,s)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Il)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=s.getNext().key;if(!o.isEqual(c))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new Il;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}class lT{constructor(){this.ga=new as(Je.comparator)}track(e){const t=e.doc.key,s=this.ga.get(t);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(t,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(t):e.type===1&&s.type===2?this.ga=this.ga.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):lt(63341,{Vt:e,pa:s}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,s)=>{e.push(s)})),e}}class Gl{constructor(e,t,s,o,c,u,d,p,g){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=o,this.mutatedKeys=c,this.fromCache=u,this.syncStateChanged=d,this.excludesMetadataChanges=p,this.hasCachedResults=g}static fromInitialDocuments(e,t,s,o,c){const u=[];return t.forEach((d=>{u.push({type:0,doc:d})})),new Gl(e,t,Il.emptySet(t),u,s,o,!0,!1,c)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Td(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==s[o].type||!t[o].doc.isEqual(s[o].doc))return!1;return!0}}class u6{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class h6{constructor(){this.queries=cT(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,s){const o=Ze(t),c=o.queries;o.queries=cT(),c.forEach(((u,d)=>{for(const p of d.ba)p.onError(s)}))})(this,new Ie(ce.ABORTED,"Firestore shutting down"))}}function cT(){return new qa((n=>tS(n)),Td)}async function a0(n,e){const t=Ze(n);let s=3;const o=e.query;let c=t.queries.get(o);c?!c.Sa()&&e.Da()&&(s=2):(c=new u6,s=e.Da()?0:1);try{switch(s){case 0:c.wa=await t.onListen(o,!0);break;case 1:c.wa=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(u){const d=Cu(u,`Initialization of query '${qc(e.query)}' failed`);return void e.onError(d)}t.queries.set(o,c),c.ba.push(e),e.va(t.onlineState),c.wa&&e.Fa(c.wa)&&l0(t)}async function o0(n,e){const t=Ze(n),s=e.query;let o=3;const c=t.queries.get(s);if(c){const u=c.ba.indexOf(e);u>=0&&(c.ba.splice(u,1),c.ba.length===0?o=e.Da()?0:1:!c.Sa()&&e.Da()&&(o=2))}switch(o){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function d6(n,e){const t=Ze(n);let s=!1;for(const o of e){const c=o.query,u=t.queries.get(c);if(u){for(const d of u.ba)d.Fa(o)&&(s=!0);u.wa=o}}s&&l0(t)}function f6(n,e,t){const s=Ze(n),o=s.queries.get(e);if(o)for(const c of o.ba)c.onError(t);s.queries.delete(e)}function l0(n){n.Ca.forEach((e=>{e.next()}))}var Zb,uT;(uT=Zb||(Zb={})).Ma="default",uT.Cache="cache";class c0{constructor(e,t,s){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const o of e.docChanges)o.type!==3&&s.push(o);e=new Gl(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const s=t!=="Offline";return(!this.options.Ka||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Gl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Zb.Cache}}class fj{constructor(e,t){this.qa=e,this.byteLength=t}Ua(){return"metadata"in this.qa}}class hT{constructor(e){this.serializer=e}Ks(e){return sa(this.serializer,e)}qs(e){return e.metadata.exists?gp(this.serializer,e.document,!1):hs.newNoDocument(this.Ks(e.metadata.name),this.Us(e.metadata.readTime))}Us(e){return Os(e)}}class u0{constructor(e,t){this.$a=e,this.serializer=t,this.Wa=[],this.Qa=[],this.collectionGroups=new Set,this.progress=mj(e)}get queries(){return this.Wa}get documents(){return this.Qa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.qa.namedQuery)this.Wa.push(e.qa.namedQuery);else if(e.qa.documentMetadata){this.Qa.push({metadata:e.qa.documentMetadata}),e.qa.documentMetadata.exists||++t;const s=fn.fromString(e.qa.documentMetadata.name);this.collectionGroups.add(s.get(s.length-2))}else e.qa.document&&(this.Qa[this.Qa.length-1].document=e.qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){const t=new Map,s=new hT(this.serializer);for(const o of e)if(o.metadata.queries){const c=s.Ks(o.metadata.name);for(const u of o.metadata.queries){const d=(t.get(u)||Zt()).add(c);t.set(u,d)}}return t}async ja(e){const t=await U3(e,new hT(this.serializer),this.Qa,this.$a.id),s=this.za(this.documents);for(const o of this.Wa)await F3(e,o,s.get(o.name));return this.progress.taskState="Success",{progress:this.progress,Ha:this.collectionGroups,Ja:t}}}function mj(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class pj{constructor(e){this.key=e}}class gj{constructor(e){this.key=e}}class yj{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Zt(),this.mutatedKeys=Zt(),this.eu=sS(e),this.tu=new Il(this.eu)}get nu(){return this.Za}ru(e,t){const s=t?t.iu:new lT,o=t?t.tu:this.tu;let c=t?t.mutatedKeys:this.mutatedKeys,u=o,d=!1;const p=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,g=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal(((b,x)=>{const T=o.get(b),N=Ed(this.query,x)?x:null,B=!!T&&this.mutatedKeys.has(T.key),M=!!N&&(N.hasLocalMutations||this.mutatedKeys.has(N.key)&&N.hasCommittedMutations);let P=!1;T&&N?T.data.isEqual(N.data)?B!==M&&(s.track({type:3,doc:N}),P=!0):this.su(T,N)||(s.track({type:2,doc:N}),P=!0,(p&&this.eu(N,p)>0||g&&this.eu(N,g)<0)&&(d=!0)):!T&&N?(s.track({type:0,doc:N}),P=!0):T&&!N&&(s.track({type:1,doc:T}),P=!0,(p||g)&&(d=!0)),P&&(N?(u=u.add(N),c=M?c.add(b):c.delete(b)):(u=u.delete(b),c=c.delete(b)))})),this.query.limit!==null)for(;u.size>this.query.limit;){const b=this.query.limitType==="F"?u.last():u.first();u=u.delete(b.key),c=c.delete(b.key),s.track({type:1,doc:b})}return{tu:u,iu:s,Ss:d,mutatedKeys:c}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,o){const c=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const u=e.iu.ya();u.sort(((b,x)=>(function(N,B){const M=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return lt(20277,{Vt:P})}};return M(N)-M(B)})(b.type,x.type)||this.eu(b.doc,x.doc))),this.ou(s),o=o??!1;const d=t&&!o?this._u():[],p=this.Ya.size===0&&this.current&&!o?1:0,g=p!==this.Xa;return this.Xa=p,u.length!==0||g?{snapshot:new Gl(this.query,e.tu,c,u,e.mutatedKeys,p===0,g,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:d}:{au:d}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new lT,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=Zt(),this.tu.forEach((s=>{this.uu(s.key)&&(this.Ya=this.Ya.add(s.key))}));const t=[];return e.forEach((s=>{this.Ya.has(s)||t.push(new gj(s))})),this.Ya.forEach((s=>{e.has(s)||t.push(new pj(s))})),t}cu(e){this.Za=e.ks,this.Ya=Zt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Gl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Jo="SyncEngine";class m6{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class p6{constructor(e){this.key=e,this.hu=!1}}class g6{constructor(e,t,s,o,c,u){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=o,this.currentUser=c,this.maxConcurrentLimboResolutions=u,this.Pu={},this.Tu=new qa((d=>tS(d)),Td),this.Iu=new Map,this.Eu=new Set,this.Ru=new as(Je.comparator),this.Au=new Map,this.Vu=new Kv,this.du={},this.mu=new Map,this.fu=Hl.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function y6(n,e,t=!0){const s=Tp(n);let o;const c=s.Tu.get(e);return c?(s.sharedClientState.addLocalQueryTarget(c.targetId),o=c.view.lu()):o=await bj(s,e,t,!0),o}async function b6(n,e){const t=Tp(n);await bj(t,e,!0,!1)}async function bj(n,e,t,s){const o=await fu(n.localStore,Er(e)),c=o.targetId,u=n.sharedClientState.addLocalQueryTarget(c,t);let d;return s&&(d=await h0(n,e,c,u==="current",o.resumeToken)),n.isPrimaryClient&&t&&wp(n.remoteStore,o),d}async function h0(n,e,t,s,o){n.pu=(x,T,N)=>(async function(M,P,Y,$){let J=P.view.ru(Y);J.Ss&&(J=await Hm(M.localStore,P.query,!1).then((({documents:A})=>P.view.ru(A,J))));const de=$&&$.targetChanges.get(P.targetId),Ne=$&&$.targetMismatches.get(P.targetId)!=null,we=P.view.applyChanges(J,M.isPrimaryClient,de,Ne);return ev(M,P.targetId,we.au),we.snapshot})(n,x,T,N);const c=await Hm(n.localStore,e,!0),u=new yj(e,c.ks),d=u.ru(c.documents),p=jd.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",o),g=u.applyChanges(d,n.isPrimaryClient,p);ev(n,t,g.au);const b=new m6(e,t,u);return n.Tu.set(e,b),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),g.snapshot}async function v6(n,e,t){const s=Ze(n),o=s.Tu.get(e),c=s.Iu.get(o.targetId);if(c.length>1)return s.Iu.set(o.targetId,c.filter((u=>!Td(u,e)))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(o.targetId),s.sharedClientState.isActiveQueryTarget(o.targetId)||await mu(s.localStore,o.targetId,!1).then((()=>{s.sharedClientState.clearQueryState(o.targetId),t&&pu(s.remoteStore,o.targetId),gu(s,o.targetId)})).catch(Ko)):(gu(s,o.targetId),await mu(s.localStore,o.targetId,!0))}async function x6(n,e){const t=Ze(n),s=t.Tu.get(e),o=t.Iu.get(s.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),pu(t.remoteStore,s.targetId))}async function _6(n,e,t){const s=p0(n);try{const o=await(function(u,d){const p=Ze(u),g=mt.now(),b=d.reduce(((N,B)=>N.add(B.key)),Zt());let x,T;return p.persistence.runTransaction("Locally write mutations","readwrite",(N=>{let B=Hr(),M=Zt();return p.xs.getEntries(N,b).next((P=>{B=P,B.forEach(((Y,$)=>{$.isValidDocument()||(M=M.add(Y))}))})).next((()=>p.localDocuments.getOverlayedDocuments(N,B))).next((P=>{x=P;const Y=[];for(const $ of d){const J=$M($,x.get($.key).overlayedDocument);J!=null&&Y.push(new $a($.key,J,$k(J.value.mapValue),bs.exists(!0)))}return p.mutationQueue.addMutationBatch(N,g,Y,d)})).next((P=>{T=P;const Y=P.applyToLocalDocumentSet(x,M);return p.documentOverlayCache.saveOverlays(N,P.batchId,Y)}))})).then((()=>({batchId:T.batchId,changes:iS(x)})))})(s.localStore,e);s.sharedClientState.addPendingMutation(o.batchId),(function(u,d,p){let g=u.du[u.currentUser.toKey()];g||(g=new as(Ft)),g=g.insert(d,p),u.du[u.currentUser.toKey()]=g})(s,o.batchId,t),await Ha(s,o.changes),await Au(s.remoteStore)}catch(o){const c=Cu(o,"Failed to persist write");t.reject(c)}}async function vj(n,e){const t=Ze(n);try{const s=await O3(t.localStore,e);e.targetChanges.forEach(((o,c)=>{const u=t.Au.get(c);u&&(pt(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?u.hu=!0:o.modifiedDocuments.size>0?pt(u.hu,14607):o.removedDocuments.size>0&&(pt(u.hu,42227),u.hu=!1))})),await Ha(t,s,e)}catch(s){await Ko(s)}}function dT(n,e,t){const s=Ze(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const o=[];s.Tu.forEach(((c,u)=>{const d=u.view.va(e);d.snapshot&&o.push(d.snapshot)})),(function(u,d){const p=Ze(u);p.onlineState=d;let g=!1;p.queries.forEach(((b,x)=>{for(const T of x.ba)T.va(d)&&(g=!0)})),g&&l0(p)})(s.eventManager,e),o.length&&s.Pu.J_(o),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function w6(n,e,t){const s=Ze(n);s.sharedClientState.updateQueryState(e,"rejected",t);const o=s.Au.get(e),c=o&&o.key;if(c){let u=new as(Je.comparator);u=u.insert(c,hs.newNoDocument(c,wt.min()));const d=Zt().add(c),p=new Sd(wt.min(),new Map,new as(Ft),u,d);await vj(s,p),s.Ru=s.Ru.remove(c),s.Au.delete(e),m0(s)}else await mu(s.localStore,e,!1).then((()=>gu(s,e,t))).catch(Ko)}async function T6(n,e){const t=Ze(n),s=e.batch.batchId;try{const o=await V3(t.localStore,e);f0(t,s,null),d0(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await Ha(t,o)}catch(o){await Ko(o)}}async function E6(n,e,t){const s=Ze(n);try{const o=await(function(u,d){const p=Ze(u);return p.persistence.runTransaction("Reject batch","readwrite-primary",(g=>{let b;return p.mutationQueue.lookupMutationBatch(g,d).next((x=>(pt(x!==null,37113),b=x.keys(),p.mutationQueue.removeMutationBatch(g,x)))).next((()=>p.mutationQueue.performConsistencyCheck(g))).next((()=>p.documentOverlayCache.removeOverlaysForBatchId(g,b,d))).next((()=>p.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(g,b))).next((()=>p.localDocuments.getDocuments(g,b)))}))})(s.localStore,e);f0(s,e,t),d0(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await Ha(s,o)}catch(o){await Ko(o)}}async function k6(n,e){const t=Ze(n);Xo(t.remoteStore)||Oe(Jo,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const s=await(function(u){const d=Ze(u);return d.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(p=>d.mutationQueue.getHighestUnacknowledgedBatchId(p)))})(t.localStore);if(s===Oo)return void e.resolve();const o=t.mu.get(s)||[];o.push(e),t.mu.set(s,o)}catch(s){const o=Cu(s,"Initialization of waitForPendingWrites() operation failed");e.reject(o)}}function d0(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function f0(n,e,t){const s=Ze(n);let o=s.du[s.currentUser.toKey()];if(o){const c=o.get(e);c&&(t?c.reject(t):c.resolve(),o=o.remove(e)),s.du[s.currentUser.toKey()]=o}}function gu(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Iu.get(e))n.Tu.delete(s),t&&n.Pu.yu(s,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((s=>{n.Vu.containsKey(s)||xj(n,s)}))}function xj(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(pu(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),m0(n))}function ev(n,e,t){for(const s of t)s instanceof pj?(n.Vu.addReference(s.key,e),S6(n,s)):s instanceof gj?(Oe(Jo,"Document no longer in limbo: "+s.key),n.Vu.removeReference(s.key,e),n.Vu.containsKey(s.key)||xj(n,s.key)):lt(19791,{wu:s})}function S6(n,e){const t=e.key,s=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(s)||(Oe(Jo,"New document in limbo: "+t),n.Eu.add(s),m0(n))}function m0(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Je(fn.fromString(e)),s=n.fu.next();n.Au.set(s,new p6(t)),n.Ru=n.Ru.insert(t,s),wp(n.remoteStore,new Aa(Er(ku(t.path)),s,"TargetPurposeLimboResolution",qr.ce))}}async function Ha(n,e,t){const s=Ze(n),o=[],c=[],u=[];s.Tu.isEmpty()||(s.Tu.forEach(((d,p)=>{u.push(s.pu(p,e,t).then((g=>{if((g||t)&&s.isPrimaryClient){const b=g?!g.fromCache:t?.targetChanges.get(p.targetId)?.current;s.sharedClientState.updateQueryState(p.targetId,b?"current":"not-current")}if(g){o.push(g);const b=Jv.Es(p.targetId,g);c.push(b)}})))})),await Promise.all(u),s.Pu.J_(o),await(async function(p,g){const b=Ze(p);try{await b.persistence.runTransaction("notifyLocalViewChanges","readwrite",(x=>re.forEach(g,(T=>re.forEach(T.Ts,(N=>b.persistence.referenceDelegate.addReference(x,T.targetId,N))).next((()=>re.forEach(T.Is,(N=>b.persistence.referenceDelegate.removeReference(x,T.targetId,N)))))))))}catch(x){if(!Qo(x))throw x;Oe(Zv,"Failed to update sequence numbers: "+x)}for(const x of g){const T=x.targetId;if(!x.fromCache){const N=b.vs.get(T),B=N.snapshotVersion,M=N.withLastLimboFreeSnapshotVersion(B);b.vs=b.vs.insert(T,M)}}})(s.localStore,c))}async function j6(n,e){const t=Ze(n);if(!t.currentUser.isEqual(e)){Oe(Jo,"User change. New user:",e.toKey());const s=await YS(t.localStore,e);t.currentUser=e,(function(c,u){c.mu.forEach((d=>{d.forEach((p=>{p.reject(new Ie(ce.CANCELLED,u))}))})),c.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Ha(t,s.Ns)}}function N6(n,e){const t=Ze(n),s=t.Au.get(e);if(s&&s.hu)return Zt().add(s.key);{let o=Zt();const c=t.Iu.get(e);if(!c)return o;for(const u of c){const d=t.Tu.get(u);o=o.unionWith(d.view.nu)}return o}}async function A6(n,e){const t=Ze(n),s=await Hm(t.localStore,e.query,!0),o=e.view.cu(s);return t.isPrimaryClient&&ev(t,e.targetId,o.au),o}async function R6(n,e){const t=Ze(n);return ej(t.localStore,e).then((s=>Ha(t,s)))}async function C6(n,e,t,s){const o=Ze(n),c=await(function(d,p){const g=Ze(d),b=Ze(g.mutationQueue);return g.persistence.runTransaction("Lookup mutation documents","readonly",(x=>b.Xn(x,p).next((T=>T?g.localDocuments.getDocuments(x,T):re.resolve(null)))))})(o.localStore,e);c!==null?(t==="pending"?await Au(o.remoteStore):t==="acknowledged"||t==="rejected"?(f0(o,e,s||null),d0(o,e),(function(d,p){Ze(Ze(d).mutationQueue).nr(p)})(o.localStore,e)):lt(6720,"Unknown batchState",{bu:t}),await Ha(o,c)):Oe(Jo,"Cannot apply mutation batch with id: "+e)}async function I6(n,e){const t=Ze(n);if(Tp(t),p0(t),e===!0&&t.gu!==!0){const s=t.sharedClientState.getAllActiveQueryTargets(),o=await fT(t,s.toArray());t.gu=!0,await Jb(t.remoteStore,!0);for(const c of o)wp(t.remoteStore,c)}else if(e===!1&&t.gu!==!1){const s=[];let o=Promise.resolve();t.Iu.forEach(((c,u)=>{t.sharedClientState.isLocalQueryTarget(u)?s.push(u):o=o.then((()=>(gu(t,u),mu(t.localStore,u,!0)))),pu(t.remoteStore,u)})),await o,await fT(t,s),(function(u){const d=Ze(u);d.Au.forEach(((p,g)=>{pu(d.remoteStore,g)})),d.Vu.zr(),d.Au=new Map,d.Ru=new as(Je.comparator)})(t),t.gu=!1,await Jb(t.remoteStore,!1)}}async function fT(n,e,t){const s=Ze(n),o=[],c=[];for(const u of e){let d;const p=s.Iu.get(u);if(p&&p.length!==0){d=await fu(s.localStore,Er(p[0]));for(const g of p){const b=s.Tu.get(g),x=await A6(s,b);x.snapshot&&c.push(x.snapshot)}}else{const g=await ZS(s.localStore,u);d=await fu(s.localStore,g),await h0(s,_j(g),u,!1,d.resumeToken)}o.push(d)}return s.Pu.J_(c),o}function _j(n){return Jk(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function D6(n){return(function(t){return Ze(Ze(t).persistence).hs()})(Ze(n).localStore)}async function P6(n,e,t,s){const o=Ze(n);if(o.gu)return void Oe(Jo,"Ignoring unexpected query state notification.");const c=o.Iu.get(e);if(c&&c.length>0)switch(t){case"current":case"not-current":{const u=await ej(o.localStore,nS(c[0])),d=Sd.createSynthesizedRemoteEventForCurrentChange(e,t==="current",As.EMPTY_BYTE_STRING);await Ha(o,u,d);break}case"rejected":await mu(o.localStore,e,!0),gu(o,e,s);break;default:lt(64155,t)}}async function M6(n,e,t){const s=Tp(n);if(s.gu){for(const o of e){if(s.Iu.has(o)&&s.sharedClientState.isActiveQueryTarget(o)){Oe(Jo,"Adding an already active target "+o);continue}const c=await ZS(s.localStore,o),u=await fu(s.localStore,c);await h0(s,_j(c),u.targetId,!1,u.resumeToken),wp(s.remoteStore,u)}for(const o of t)s.Iu.has(o)&&await mu(s.localStore,o,!1).then((()=>{pu(s.remoteStore,o),gu(s,o)})).catch(Ko)}}function Tp(n){const e=Ze(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=vj.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=N6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=w6.bind(null,e),e.Pu.J_=d6.bind(null,e.eventManager),e.Pu.yu=f6.bind(null,e.eventManager),e}function p0(n){const e=Ze(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=T6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=E6.bind(null,e),e}function L6(n,e,t){const s=Ze(n);(async function(c,u,d){try{const p=await u.getMetadata();if(await(function(N,B){const M=Ze(N),P=Os(B.createTime);return M.persistence.runTransaction("hasNewerBundle","readonly",(Y=>M.Pi.getBundleMetadata(Y,B.id))).then((Y=>!!Y&&Y.createTime.compareTo(P)>=0))})(c.localStore,p))return await u.close(),d._completeWith((function(N){return{taskState:"Success",documentsLoaded:N.totalDocuments,bytesLoaded:N.totalBytes,totalDocuments:N.totalDocuments,totalBytes:N.totalBytes}})(p)),Promise.resolve(new Set);d._updateProgress(mj(p));const g=new u0(p,u.serializer);let b=await u.Su();for(;b;){const T=await g.Ga(b);T&&d._updateProgress(T),b=await u.Su()}const x=await g.ja(c.localStore);return await Ha(c,x.Ja,void 0),await(function(N,B){const M=Ze(N);return M.persistence.runTransaction("Save bundle","readwrite",(P=>M.Pi.saveBundleMetadata(P,B)))})(c.localStore,p),d._completeWith(x.progress),Promise.resolve(x.Ha)}catch(p){return wi(Jo,`Loading bundle failed with ${p}`),d._failWith(p),Promise.resolve(new Set)}})(s,e,t).then((o=>{s.sharedClientState.notifyBundleLoaded(o)}))}class yu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Xl(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return QS(this.persistence,new KS,e.initialUser,this.serializer)}Cu(e){return new Qv(_p.Vi,this.serializer)}Du(e){return new ij}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}yu.provider={build:()=>new yu};class g0 extends yu{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){pt(this.persistence.referenceDelegate instanceof $m,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new zS(s,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?wr.withCacheSize(this.cacheSizeBytes):wr.DEFAULT;return new Qv((s=>$m.Vi(s,t)),this.serializer)}}class y0 extends yu{constructor(e,t,s){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=s,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await p0(this.xu.syncEngine),await Au(this.xu.remoteStore),await this.persistence.zi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return QS(this.persistence,new KS,e.initialUser,this.serializer)}Fu(e,t){const s=this.persistence.referenceDelegate.garbageCollector;return new zS(s,e.asyncQueue,t)}Mu(e,t){const s=new $P(t,this.persistence);return new qP(e.asyncQueue,s)}Cu(e){const t=Xv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),s=this.cacheSizeBytes!==void 0?wr.withCacheSize(this.cacheSizeBytes):wr.DEFAULT;return new Yv(this.synchronizeTabs,t,e.clientId,s,e.asyncQueue,aj(),wm(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new ij}}class wj extends y0{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof Qy&&(this.sharedClientState.syncEngine={So:C6.bind(null,t),Do:P6.bind(null,t),Co:M6.bind(null,t),hs:D6.bind(null,t),bo:R6.bind(null,t)},await this.sharedClientState.start()),await this.persistence.zi((async s=>{await I6(this.xu.syncEngine,s),this.gcScheduler&&(s&&!this.gcScheduler.started?this.gcScheduler.start():s||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(s&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():s||this.indexBackfillerScheduler.stop())}))}Du(e){const t=aj();if(!Qy.v(t))throw new Ie(ce.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const s=Xv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Qy(t,e.asyncQueue,s,e.clientId,e.initialUser)}}class Ho{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>dT(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=j6.bind(null,this.syncEngine),await Jb(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new h6})()}createDatastore(e){const t=Xl(e.databaseInfo.databaseId),s=W3(e.databaseInfo);return X3(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return(function(s,o,c,u,d){return new Z3(s,o,c,u,d)})(this.localStore,this.datastore,e.asyncQueue,(t=>dT(this.syncEngine,t,0)),(function(){return iT.v()?new iT:new z3})())}createSyncEngine(e,t){return(function(o,c,u,d,p,g,b){const x=new g6(o,c,u,d,p,g);return b&&(x.gu=!0),x})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const s=Ze(t);Oe(Wl,"RemoteStore shutting down."),s.Ea.add(5),await Nu(s),s.Aa.shutdown(),s.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Ho.provider={build:()=>new Ho};function mT(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const s={value:n.slice(t,t+e),done:!1};return t+=e,s}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}class Ep{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Vs("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}class V6{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new ar,this.buffer=new Uint8Array,this.Lu=(function(){return new TextDecoder("utf-8")})(),this.ku().then((s=>{s&&s.Ua()?this.metadata.resolve(s.qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(s?.qa)}`))}),(s=>this.metadata.reject(s)))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async Su(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.Ku();if(e===null)return null;const t=this.Lu.decode(e),s=Number(t);isNaN(s)&&this.qu(`length string (${t}) is not valid number`);const o=await this.Uu(s);return new fj(JSON.parse(o),e.length+s)}$u(){return this.buffer.findIndex((e=>e===123))}async Ku(){for(;this.$u()<0&&!await this.Wu(););if(this.buffer.length===0)return null;const e=this.$u();e<0&&this.qu("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Uu(e){for(;this.buffer.length<e;)await this.Wu()&&this.qu("Reached the end of bundle when more is expected.");const t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Wu(){const e=await this.Bu.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class O6{constructor(e,t){this.bundleData=e,this.serializer=t,this.cursor=0,this.elements=[];let s=this.Su();if(!s||!s.Ua())throw new Error(`The first element of the bundle is not a metadata object, it is
         ${JSON.stringify(s?.qa)}`);this.metadata=s;do s=this.Su(),s!==null&&this.elements.push(s);while(s!==null)}getMetadata(){return this.metadata}Qu(){return this.elements}Su(){if(this.cursor===this.bundleData.length)return null;const e=this.Ku(),t=this.Uu(e);return new fj(JSON.parse(t),e)}Uu(e){if(this.cursor+e>this.bundleData.length)throw new Ie(ce.INTERNAL,"Reached the end of bundle when more is expected.");return this.bundleData.slice(this.cursor,this.cursor+=e)}Ku(){const e=this.cursor;let t=this.cursor;for(;t<this.bundleData.length;){if(this.bundleData[t]==="{"){if(t===e)throw new Error("First character is a bracket and not a number");return this.cursor=t,Number(this.bundleData.slice(e,t))}t++}throw new Error("Reached the end of bundle when more is expected.")}}let B6=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new Ie(ce.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(o,c){const u=Ze(o),d={documents:c.map((x=>ld(u.serializer,x)))},p=await u.jo("BatchGetDocuments",u.serializer.databaseId,fn.emptyPath(),d,c.length),g=new Map;p.forEach((x=>{const T=e3(u.serializer,x);g.set(T.key.toString(),T)}));const b=[];return c.forEach((x=>{const T=g.get(x.toString());pt(!!T,55234,{key:x}),b.push(T)})),b})(this.datastore,e);return t.forEach((s=>this.recordVersion(s))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(s){this.lastTransactionError=s}this.writtenDocs.add(e.toString())}delete(e){this.write(new ju(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,s)=>{const o=Je.fromPath(s);this.mutations.push(new Uv(o,this.precondition(o)))})),await(async function(s,o){const c=Ze(s),u={writes:o.map((d=>cd(c.serializer,d)))};await c.Wo("Commit",c.serializer.databaseId,fn.emptyPath(),u)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw lt(50498,{Gu:e.constructor.name});t=wt.min()}const s=this.readVersions.get(e.key.toString());if(s){if(!t.isEqual(s))throw new Ie(ce.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(wt.min())?bs.exists(!1):bs.updateTime(t):bs.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(wt.min()))throw new Ie(ce.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return bs.updateTime(t)}return bs.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};class U6{constructor(e,t,s,o,c){this.asyncQueue=e,this.datastore=t,this.options=s,this.updateFunction=o,this.deferred=c,this.zu=s.maxAttempts,this.M_=new t0(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Hu()}Hu(){this.M_.p_((async()=>{const e=new B6(this.datastore),t=this.Ju(e);t&&t.then((s=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(s)})).catch((o=>{this.Zu(o)}))))})).catch((s=>{this.Zu(s)}))}))}Ju(e){try{const t=this.updateFunction(e);return!xd(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Zu(e){this.zu>0&&this.Xu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Hu(),Promise.resolve())))):this.deferred.reject(e)}Xu(e){if(e?.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!gS(t)}return!1}}const Wo="FirestoreClient";class F6{constructor(e,t,s,o,c){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this._databaseInfo=o,this.user=rr.UNAUTHENTICATED,this.clientId=Sv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=c,this.authCredentials.start(s,(async u=>{Oe(Wo,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u})),this.appCheckCredentials.start(s,(u=>(Oe(Wo,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ar;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=Cu(t,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}async function Xy(n,e){n.asyncQueue.verifyOperationInProgress(),Oe(Wo,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener((async o=>{s.isEqual(o)||(await YS(e.localStore,o),s=o)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function pT(n,e){n.asyncQueue.verifyOperationInProgress();const t=await b0(n);Oe(Wo,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((s=>oT(e.remoteStore,s))),n.setAppCheckTokenChangeListener(((s,o)=>oT(e.remoteStore,o))),n._onlineComponents=e}async function b0(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Oe(Wo,"Using user provided OfflineComponentProvider");try{await Xy(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(o){return o.name==="FirebaseError"?o.code===ce.FAILED_PRECONDITION||o.code===ce.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11})(t))throw t;wi("Error using user provided cache. Falling back to memory cache: "+t),await Xy(n,new yu)}}else Oe(Wo,"Using default OfflineComponentProvider"),await Xy(n,new g0(void 0));return n._offlineComponents}async function kp(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Oe(Wo,"Using user provided OnlineComponentProvider"),await pT(n,n._uninitializedComponentsProvider._online)):(Oe(Wo,"Using default OnlineComponentProvider"),await pT(n,new Ho))),n._onlineComponents}function Tj(n){return b0(n).then((e=>e.persistence))}function Iu(n){return b0(n).then((e=>e.localStore))}function Ej(n){return kp(n).then((e=>e.remoteStore))}function v0(n){return kp(n).then((e=>e.syncEngine))}function kj(n){return kp(n).then((e=>e.datastore))}async function bu(n){const e=await kp(n),t=e.eventManager;return t.onListen=y6.bind(null,e.syncEngine),t.onUnlisten=v6.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=b6.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=x6.bind(null,e.syncEngine),t}function z6(n){return n.asyncQueue.enqueue((async()=>{const e=await Tj(n),t=await Ej(n);return e.setNetworkEnabled(!0),(function(o){const c=Ze(o);return c.Ea.delete(0),Nd(c)})(t)}))}function q6(n){return n.asyncQueue.enqueue((async()=>{const e=await Tj(n),t=await Ej(n);return e.setNetworkEnabled(!1),(async function(o){const c=Ze(o);c.Ea.add(0),await Nu(c),c.Va.set("Offline")})(t)}))}function $6(n,e,t,s){const o=new Ep(s),c=new c0(e,o,t);return n.asyncQueue.enqueueAndForget((async()=>a0(await bu(n),c))),()=>{o.Nu(),n.asyncQueue.enqueueAndForget((async()=>o0(await bu(n),c)))}}function H6(n,e){const t=new ar;return n.asyncQueue.enqueueAndForget((async()=>(async function(o,c,u){try{const d=await(function(g,b){const x=Ze(g);return x.persistence.runTransaction("read document","readonly",(T=>x.localDocuments.getDocument(T,b)))})(o,c);d.isFoundDocument()?u.resolve(d):d.isNoDocument()?u.resolve(null):u.reject(new Ie(ce.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(d){const p=Cu(d,`Failed to get document '${c} from cache`);u.reject(p)}})(await Iu(n),e,t))),t.promise}function Sj(n,e,t={}){const s=new ar;return n.asyncQueue.enqueueAndForget((async()=>(function(c,u,d,p,g){const b=new Ep({next:T=>{b.Nu(),u.enqueueAndForget((()=>o0(c,x)));const N=T.docs.has(d);!N&&T.fromCache?g.reject(new Ie(ce.UNAVAILABLE,"Failed to get document because the client is offline.")):N&&T.fromCache&&p&&p.source==="server"?g.reject(new Ie(ce.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(T)},error:T=>g.reject(T)}),x=new c0(ku(d.path),b,{includeMetadataChanges:!0,Ka:!0});return a0(c,x)})(await bu(n),n.asyncQueue,e,t,s))),s.promise}function W6(n,e){const t=new ar;return n.asyncQueue.enqueueAndForget((async()=>(async function(o,c,u){try{const d=await Hm(o,c,!0),p=new yj(c,d.ks),g=p.ru(d.documents),b=p.applyChanges(g,!1);u.resolve(b.snapshot)}catch(d){const p=Cu(d,`Failed to execute query '${c} against cache`);u.reject(p)}})(await Iu(n),e,t))),t.promise}function jj(n,e,t={}){const s=new ar;return n.asyncQueue.enqueueAndForget((async()=>(function(c,u,d,p,g){const b=new Ep({next:T=>{b.Nu(),u.enqueueAndForget((()=>o0(c,x))),T.fromCache&&p.source==="server"?g.reject(new Ie(ce.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(T)},error:T=>g.reject(T)}),x=new c0(d,b,{includeMetadataChanges:!0,Ka:!0});return a0(c,x)})(await bu(n),n.asyncQueue,e,t,s))),s.promise}function G6(n,e,t){const s=new ar;return n.asyncQueue.enqueueAndForget((async()=>{try{const o=await kj(n);s.resolve((async function(u,d,p){const g=Ze(u),{request:b,gt:x,parent:T}=jS(g.serializer,Zk(d),p);g.connection.Ko||delete b.parent;const N=(await g.jo("RunAggregationQuery",g.serializer.databaseId,T,b,1)).filter((M=>!!M.result));pt(N.length===1,64727);const B=N[0].result?.aggregateFields;return Object.keys(B).reduce(((M,P)=>(M[x[P]]=B[P],M)),{})})(o,e,t))}catch(o){s.reject(o)}})),s.promise}function K6(n,e){const t=new ar;return n.asyncQueue.enqueueAndForget((async()=>_6(await v0(n),e,t))),t.promise}function Q6(n,e){const t=new Ep(e);return n.asyncQueue.enqueueAndForget((async()=>(function(o,c){Ze(o).Ca.add(c),c.next()})(await bu(n),t))),()=>{t.Nu(),n.asyncQueue.enqueueAndForget((async()=>(function(o,c){Ze(o).Ca.delete(c)})(await bu(n),t)))}}function Y6(n,e,t){const s=new ar;return n.asyncQueue.enqueueAndForget((async()=>{const o=await kj(n);new U6(n.asyncQueue,o,t,e,s).ju()})),s.promise}function X6(n,e,t,s){const o=(function(u,d){let p;return p=typeof u=="string"?bS().encode(u):u,(function(b,x){return new V6(b,x)})((function(b,x){if(b instanceof Uint8Array)return mT(b,x);if(b instanceof ArrayBuffer)return mT(new Uint8Array(b),x);if(b instanceof ReadableStream)return b.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(p),d)})(t,Xl(e));n.asyncQueue.enqueueAndForget((async()=>{L6(await v0(n),o,s)}))}function J6(n,e){return n.asyncQueue.enqueue((async()=>(function(s,o){const c=Ze(s);return c.persistence.runTransaction("Get named query","readonly",(u=>c.Pi.getNamedQuery(u,o)))})(await Iu(n),e)))}function Nj(n,e){return(function(s,o){return new O6(s,o)})(n,e)}function Z6(n,e){return n.asyncQueue.enqueue((async()=>(async function(s,o){const c=Ze(s),u=c.indexManager,d=[];return c.persistence.runTransaction("Configure indexes","readwrite",(p=>u.getFieldIndexes(p).next((g=>(function(x,T,N,B,M){x=[...x],T=[...T],x.sort(N),T.sort(N);const P=x.length,Y=T.length;let $=0,J=0;for(;$<Y&&J<P;){const de=N(x[J],T[$]);de<0?M(x[J++]):de>0?B(T[$++]):($++,J++)}for(;$<Y;)B(T[$++]);for(;J<P;)M(x[J++])})(g,o,BP,(b=>{d.push(u.addFieldIndex(p,b))}),(b=>{d.push(u.deleteFieldIndex(p,b))})))).next((()=>re.waitFor(d)))))})(await Iu(n),e)))}function eL(n,e){return n.asyncQueue.enqueue((async()=>(function(s,o){Ze(s).Cs.As=o})(await Iu(n),e)))}function tL(n){return n.asyncQueue.enqueue((async()=>(function(t){const s=Ze(t),o=s.indexManager;return s.persistence.runTransaction("Delete All Indexes","readwrite",(c=>o.deleteAllFieldIndexes(c)))})(await Iu(n))))}function Aj(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const nL="ComponentProvider",gT=new Map;function sL(n,e,t,s,o){return new bM(n,e,t,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,Aj(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator,s)}const Rj="firestore.googleapis.com",yT=!0;class bT{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ie(ce.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Rj,this.ssl=yT}else this.host=e.host,this.ssl=e.ssl??yT;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=VS;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<FS)throw new Ie(ce.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}OP("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Aj(e.experimentalLongPollingOptions??{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Ie(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Ie(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Ie(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(s,o){return s.timeoutSeconds===o.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ad{constructor(e,t,s,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new bT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ie(ce.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ie(ce.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new bT(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new NP;switch(s.type){case"firstParty":return new IP(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new Ie(ce.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const s=gT.get(t);s&&(Oe(nL,"Removing Datastore"),gT.delete(t),s.terminate())})(this),Promise.resolve()}}function rL(n,e,t,s={}){n=yn(n,Ad);const o=Ba(e),c=n._getSettings(),u={...c,emulatorOptions:n._getEmulatorOptions()},d=`${e}:${t}`;o&&(np(`https://${d}`),hv("Firestore",!0)),c.host!==Rj&&c.host!==d&&wi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const p={...c,host:d,ssl:o,emulatorOptions:s};if(!Mi(p,u)&&(n._setSettings(p),s.mockUserToken)){let g,b;if(typeof s.mockUserToken=="string")g=s.mockUserToken,b=rr.MOCK_USER;else{g=yE(s.mockUserToken,n._app?.options.projectId);const x=s.mockUserToken.sub||s.mockUserToken.user_id;if(!x)throw new Ie(ce.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new rr(x)}n._authCredentials=new AP(new mk(g,b))}}class or{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new or(this.firestore,e,this._query)}}class es{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ra(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new es(this.firestore,e,this._key)}toJSON(){return{type:es._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(Yl(t,es._jsonSchema))return new es(e,s||null,new Je(fn.fromString(t.referencePath)))}}es._jsonSchemaVersion="firestore/documentReference/1.0",es._jsonSchema={type:Ws("string",es._jsonSchemaVersion),referencePath:Ws("string")};class ra extends or{constructor(e,t,s){super(e,t,ku(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new es(this.firestore,null,new Je(e))}withConverter(e){return new ra(this.firestore,e,this._path)}}function Wt(n,e,...t){if(n=jn(n),jv("collection","path",e),n instanceof Ad){const s=fn.fromString(e,...t);return a2(s),new ra(n,null,s)}{if(!(n instanceof es||n instanceof ra))throw new Ie(ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(fn.fromString(e,...t));return a2(s),new ra(n.firestore,null,s)}}function BO(n,e){if(n=yn(n,Ad),jv("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Ie(ce.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new or(n,null,(function(s){return new za(fn.emptyPath(),s)})(e))}function Qe(n,e,...t){if(n=jn(n),arguments.length===1&&(e=Sv.newId()),jv("doc","path",e),n instanceof Ad){const s=fn.fromString(e,...t);return i2(s),new es(n,null,new Je(s))}{if(!(n instanceof es||n instanceof ra))throw new Ie(ce.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(fn.fromString(e,...t));return i2(s),new es(n.firestore,n instanceof ra?n.converter:null,new Je(s))}}function UO(n,e){return n=jn(n),e=jn(e),(n instanceof es||n instanceof ra)&&(e instanceof es||e instanceof ra)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function Cj(n,e){return n=jn(n),e=jn(e),n instanceof or&&e instanceof or&&n.firestore===e.firestore&&Td(n._query,e._query)&&n.converter===e.converter}const vT="AsyncQueue";class xT{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new t0(this,"async_queue_retry"),this._c=()=>{const s=wm();s&&Oe(vT,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const t=wm();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=wm();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new ar;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Qo(e))throw e;Oe(vT,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((s=>{throw this.nc=s,this.rc=!1,Vs("INTERNAL UNHANDLED ERROR: ",_T(s)),s})).then((s=>(this.rc=!1,s))))));return this.ac=t,t}enqueueAfterDelay(e,t,s){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const o=i0.createAndSchedule(this,e,t,s,(c=>this.hc(c)));return this.tc.push(o),o}uc(){this.nc&&lt(47125,{Pc:_T(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,s)=>t.targetTimeMs-s.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function _T(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class iL{constructor(){this._progressObserver={},this._taskCompletionResolver=new ar,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,s){this._progressObserver={next:e,error:t,complete:s}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}const FO=-1;class ss extends Ad{constructor(e,t,s,o){super(e,t,s,o),this.type="firestore",this._queue=new xT,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new xT(e),this._firestoreClient=void 0,await e}}}function zO(n,e,t){t||(t=rd);const s=wu(n,"firestore");if(s.isInitialized(t)){const o=s.getImmediate({identifier:t}),c=s.getOptions(t);if(Mi(c,e))return o;throw new Ie(ce.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new Ie(ce.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<FS)throw new Ie(ce.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&Ba(e.host)&&np(e.host),s.initialize({options:e,instanceIdentifier:t})}function aL(n,e){const t=typeof n=="object"?n:pv(),s=typeof n=="string"?n:e||rd,o=wu(t,"firestore").getImmediate({identifier:s});if(!o._initialized){const c=mE("firestore");c&&rL(o,...c)}return o}function ws(n){if(n._terminated)throw new Ie(ce.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||Ij(n),n._firestoreClient}function Ij(n){const e=n._freezeSettings(),t=sL(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new F6(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(o){const c=o?._online.build();return{_offline:o?._offline.build(c),_online:c}})(n._componentsProvider))}function qO(n,e){wi("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return Dj(n,Ho.provider,{build:s=>new y0(s,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}async function $O(n){wi("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();Dj(n,Ho.provider,{build:t=>new wj(t,e.cacheSizeBytes)})}function Dj(n,e,t){if((n=yn(n,ss))._firestoreClient||n._terminated)throw new Ie(ce.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Ie(ce.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},Ij(n)}function HO(n){if(n._initialized&&!n._terminated)throw new Ie(ce.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new ar;return n._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(s){if(!na.v())return Promise.resolve();const o=s+GS;await na.delete(o)})(Xv(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function WO(n){return(function(t){const s=new ar;return t.asyncQueue.enqueueAndForget((async()=>k6(await v0(t),s))),s.promise})(ws(n=yn(n,ss)))}function GO(n){return z6(ws(n=yn(n,ss)))}function KO(n){return q6(ws(n=yn(n,ss)))}function QO(n){return JI(n.app,"firestore",n._databaseId.database),n._delete()}function wT(n,e){const t=ws(n=yn(n,ss)),s=new iL;return X6(t,n._databaseId,e,s),s}function oL(n,e){return J6(ws(n=yn(n,ss)),e).then((t=>t?new or(n,null,t.query):null))}class si{constructor(e){this._byteString=e}static fromBase64String(e){try{return new si(As.fromBase64String(e))}catch(t){throw new Ie(ce.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new si(As.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:si._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Yl(e,si._jsonSchema))return si.fromBase64String(e.bytes)}}si._jsonSchemaVersion="firestore/bytes/1.0",si._jsonSchema={type:Ws("string",si._jsonSchemaVersion),bytes:Ws("string")};class Du{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ie(ce.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ys(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function YO(){return new Du(Rb)}class Jl{constructor(e){this._methodName=e}}class ia{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ie(ce.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ie(ce.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ft(this._lat,e._lat)||Ft(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ia._jsonSchemaVersion}}static fromJSON(e){if(Yl(e,ia._jsonSchema))return new ia(e.latitude,e.longitude)}}ia._jsonSchemaVersion="firestore/geoPoint/1.0",ia._jsonSchema={type:Ws("string",ia._jsonSchemaVersion),latitude:Ws("number"),longitude:Ws("number")};class xi{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(s,o){if(s.length!==o.length)return!1;for(let c=0;c<s.length;++c)if(s[c]!==o[c])return!1;return!0})(this._values,e._values)}toJSON(){return{type:xi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Yl(e,xi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new xi(e.vectorValues);throw new Ie(ce.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}xi._jsonSchemaVersion="firestore/vectorValue/1.0",xi._jsonSchema={type:Ws("string",xi._jsonSchemaVersion),vectorValues:Ws("object")};const lL=/^__.*__$/;class cL{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new $a(e,this.data,this.fieldMask,t,this.fieldTransforms):new Su(e,this.data,t,this.fieldTransforms)}}class Pj{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new $a(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Mj(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw lt(40011,{dataSource:n})}}class Sp{constructor(e,t,s,o,c,u){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=o,c===void 0&&this.validatePath(),this.fieldTransforms=c||[],this.fieldMask=u||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Sp({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),s=this.contextWith({path:t,arrayElement:!1});return s.validatePathSegment(e),s}childContextForFieldPath(e){const t=this.path?.child(e),s=this.contextWith({path:t,arrayElement:!1});return s.validatePath(),s}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Qm(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(Mj(this.dataSource)&&lL.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class uL{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||Xl(e)}createContext(e,t,s,o=!1){return new Sp({dataSource:e,methodName:t,targetDoc:s,path:ys.emptyPath(),arrayElement:!1,hasConverter:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Zl(n){const e=n._freezeSettings(),t=Xl(n._databaseId);return new uL(n._databaseId,!!e.ignoreUndefinedProperties,t)}function jp(n,e,t,s,o,c={}){const u=n.createContext(c.merge||c.mergeFields?2:0,e,t,o);S0("Data must be an object, but it was:",u,s);const d=Oj(s,u);let p,g;if(c.merge)p=new $r(u.fieldMask),g=u.fieldTransforms;else if(c.mergeFields){const b=[];for(const x of c.mergeFields){const T=Oa(e,x,t);if(!u.contains(T))throw new Ie(ce.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);Uj(b,T)||b.push(T)}p=new $r(b),g=u.fieldTransforms.filter((x=>p.covers(x.field)))}else p=null,g=u.fieldTransforms;return new cL(new ir(d),p,g)}class Rd extends Jl{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Rd}}function Lj(n,e,t){return new Sp({dataSource:3,targetDoc:e.settings.targetDoc,methodName:n._methodName,arrayElement:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class x0 extends Jl{_toFieldTransform(e){return new kd(e.path,new uu)}isEqual(e){return e instanceof x0}}class _0 extends Jl{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=Lj(this,e,!0),s=this.Ac.map((c=>ec(c,t))),o=new Fl(s);return new kd(e.path,o)}isEqual(e){return e instanceof _0&&Mi(this.Ac,e.Ac)}}class w0 extends Jl{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=Lj(this,e,!0),s=this.Ac.map((c=>ec(c,t))),o=new zl(s);return new kd(e.path,o)}isEqual(e){return e instanceof w0&&Mi(this.Ac,e.Ac)}}class T0 extends Jl{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new hu(e.serializer,lS(e.serializer,this.Vc));return new kd(e.path,t)}isEqual(e){return e instanceof T0&&this.Vc===e.Vc}}function E0(n,e,t,s){const o=n.createContext(1,e,t);S0("Data must be an object, but it was:",o,s);const c=[],u=ir.empty();Yo(s,((p,g)=>{const b=j0(e,p,t);g=jn(g);const x=o.childContextForFieldPath(b);if(g instanceof Rd)c.push(b);else{const T=ec(g,x);T!=null&&(c.push(b),u.set(b,T))}}));const d=new $r(c);return new Pj(u,d,o.fieldTransforms)}function k0(n,e,t,s,o,c){const u=n.createContext(1,e,t),d=[Oa(e,s,t)],p=[o];if(c.length%2!=0)throw new Ie(ce.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<c.length;T+=2)d.push(Oa(e,c[T])),p.push(c[T+1]);const g=[],b=ir.empty();for(let T=d.length-1;T>=0;--T)if(!Uj(g,d[T])){const N=d[T];let B=p[T];B=jn(B);const M=u.childContextForFieldPath(N);if(B instanceof Rd)g.push(N);else{const P=ec(B,M);P!=null&&(g.push(N),b.set(N,P))}}const x=new $r(g);return new Pj(b,x,u.fieldTransforms)}function Vj(n,e,t,s=!1){return ec(t,n.createContext(s?4:3,e))}function ec(n,e){if(Bj(n=jn(n)))return S0("Unsupported field value:",e,n),Oj(n,e);if(n instanceof Jl)return(function(s,o){if(!Mj(o.dataSource))throw o.createError(`${s._methodName}() can only be used with update() and set()`);if(!o.path)throw o.createError(`${s._methodName}() is not currently supported inside arrays`);const c=s._toFieldTransform(o);c&&o.fieldTransforms.push(c)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(s,o){const c=[];let u=0;for(const d of s){let p=ec(d,o.childContextForArray(u));p==null&&(p={nullValue:"NULL_VALUE"}),c.push(p),u++}return{arrayValue:{values:c}}})(n,e)}return(function(s,o){if((s=jn(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return lS(o.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const c=mt.fromDate(s);return{timestampValue:du(o.serializer,c)}}if(s instanceof mt){const c=new mt(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:du(o.serializer,c)}}if(s instanceof ia)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof si)return{bytesValue:_S(o.serializer,s._byteString)};if(s instanceof es){const c=o.databaseId,u=s.firestore._databaseId;if(!u.isEqual(c))throw o.createError(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${c.projectId}/${c.database}`);return{referenceValue:Hv(s.firestore._databaseId||o.databaseId,s._key.path)}}if(s instanceof xi)return(function(u,d){const p=u instanceof xi?u.toArray():u;return{mapValue:{fields:{[Pv]:{stringValue:Mv},[ou]:{arrayValue:{values:p.map((b=>{if(typeof b!="number")throw d.createError("VectorValues must only contain numeric values.");return Bv(d.serializer,b)}))}}}}}})(s,o);if(IS(s))return s._toProto(o.serializer);throw o.createError(`Unsupported field value: ${ap(s)}`)})(n,e)}function Oj(n,e){const t={};return Mk(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Yo(n,((s,o)=>{const c=ec(o,e.childContextForField(s));c!=null&&(t[s]=c)})),{mapValue:{fields:t}}}function Bj(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof mt||n instanceof ia||n instanceof si||n instanceof es||n instanceof Jl||n instanceof xi||IS(n))}function S0(n,e,t){if(!Bj(t)||!gk(t)){const s=ap(t);throw s==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+s)}}function Oa(n,e,t){if((e=jn(e))instanceof Du)return e._internalPath;if(typeof e=="string")return j0(n,e);throw Qm("Field path arguments must be of type string or ",n,!1,void 0,t)}const hL=new RegExp("[~\\*/\\[\\]]");function j0(n,e,t){if(e.search(hL)>=0)throw Qm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Du(...e.split("."))._internalPath}catch{throw Qm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Qm(n,e,t,s,o){const c=s&&!s.isEmpty(),u=o!==void 0;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let p="";return(c||u)&&(p+=" (found",c&&(p+=` in field ${s}`),u&&(p+=` in document ${o}`),p+=")"),new Ie(ce.INVALID_ARGUMENT,d+n+p)}function Uj(n,e){return n.some((t=>t.isEqual(e)))}class Fj{convertValue(e,t="none"){switch(Fo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return gs(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Va(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw lt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return Yo(e,((o,c)=>{s[o]=this.convertValue(c,t)})),s}convertVectorValue(e){const t=e.fields?.[ou].arrayValue?.values?.map((s=>gs(s.doubleValue)));return new xi(t)}convertGeoPoint(e){return new ia(gs(e.latitude),gs(e.longitude))}convertArray(e,t){return(e.values||[]).map((s=>this.convertValue(s,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const s=dp(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(sd(e));default:return null}}convertTimestamp(e){const t=La(e);return new mt(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=fn.fromString(e);pt(CS(s),9688,{name:e});const o=new Ol(s.get(1),s.get(3)),c=new Je(s.popFirst(5));return o.isEqual(t)||Vs(`Document ${c} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),c}}class Zo extends Fj{constructor(e){super(),this.firestore=e}convertBytes(e){return new si(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new es(this.firestore,null,t)}}function XO(){return new Rd("deleteField")}function vi(){return new x0("serverTimestamp")}function JO(...n){return new _0("arrayUnion",n)}function ZO(...n){return new w0("arrayRemove",n)}function Al(n){return new T0("increment",n)}function eB(n){return new xi(n)}function tB(n){const e=ws(yn(n.firestore,ss)),t=e._onlineComponents?.datastore.serializer;return t===void 0?null:yp(t,Er(n._query)).ft}function nB(n,e){const t=Pk(e,((c,u)=>new pS(u,c.aggregateType,c._internalFieldPath))),s=ws(yn(n.firestore,ss)),o=s._onlineComponents?.datastore.serializer;return o===void 0?null:jS(o,Zk(n._query),t,!0).request}const TT="@firebase/firestore",ET="4.10.0";function Jc(n){return(function(t,s){if(typeof t!="object"||t===null)return!1;const o=t;for(const c of s)if(c in o&&typeof o[c]=="function")return!0;return!1})(n,["next","error","complete"])}class ud{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class dL{constructor(e,t,s){this._userDataWriter=t,this._data=s,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}_fieldsProto(){return new ir({mapValue:{fields:this._data}}).clone().value.mapValue.fields}}class hd{constructor(e,t,s,o,c){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=o,this._converter=c}get id(){return this._key.path.lastSegment()}get ref(){return new es(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new fL(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(Oa("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class fL extends hd{data(){return super.data()}}function zj(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ie(ce.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class N0{}class Cd extends N0{}function In(n,e,...t){let s=[];e instanceof N0&&s.push(e),s=s.concat(t),(function(c){const u=c.filter((p=>p instanceof Pu)).length,d=c.filter((p=>p instanceof Id)).length;if(u>1||u>0&&d>0)throw new Ie(ce.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(s);for(const o of s)n=o._apply(n);return n}class Id extends Cd{constructor(e,t,s){super(),this._field=e,this._op=t,this._value=s,this.type="where"}static _create(e,t,s){return new Id(e,t,s)}_apply(e){const t=this._parse(e);return $j(e._query,t),new or(e.firestore,e.converter,Fb(e._query,t))}_parse(e){const t=Zl(e.firestore);return(function(c,u,d,p,g,b,x){let T;if(g.isKeyField()){if(b==="array-contains"||b==="array-contains-any")throw new Ie(ce.INVALID_ARGUMENT,`Invalid Query. You can't perform '${b}' queries on documentId().`);if(b==="in"||b==="not-in"){ST(x,b);const B=[];for(const M of x)B.push(kT(p,c,M));T={arrayValue:{values:B}}}else T=kT(p,c,x)}else b!=="in"&&b!=="not-in"&&b!=="array-contains-any"||ST(x,b),T=Vj(d,u,x,b==="in"||b==="not-in");return Tn.create(g,b,T)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function dn(n,e,t){const s=e,o=Oa("where",n);return Id._create(o,s,t)}class Pu extends N0{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Pu(e,t)}_parse(e){const t=this._queryConstraints.map((s=>s._parse(e))).filter((s=>s.getFilters().length>0));return t.length===1?t[0]:Kn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(o,c){let u=o;const d=c.getFlattenedFilters();for(const p of d)$j(u,p),u=Fb(u,p)})(e._query,t),new or(e.firestore,e.converter,Fb(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function sB(...n){return n.forEach((e=>Hj("or",e))),Pu._create("or",n)}function rB(...n){return n.forEach((e=>Hj("and",e))),Pu._create("and",n)}class A0 extends Cd{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new A0(e,t)}_apply(e){const t=(function(o,c,u){if(o.startAt!==null)throw new Ie(ce.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(o.endAt!==null)throw new Ie(ce.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new od(c,u)})(e._query,this._field,this._direction);return new or(e.firestore,e.converter,CM(e._query,t))}}function Ym(n,e="asc"){const t=e,s=Oa("orderBy",n);return A0._create(s,t)}class Np extends Cd{constructor(e,t,s){super(),this.type=e,this._limit=t,this._limitType=s}static _create(e,t,s){return new Np(e,t,s)}_apply(e){return new or(e.firestore,e.converter,Um(e._query,this._limit,this._limitType))}}function Xm(n){return yk("limit",n),Np._create("limit",n,"F")}function iB(n){return yk("limitToLast",n),Np._create("limitToLast",n,"L")}class Ap extends Cd{constructor(e,t,s){super(),this.type=e,this._docOrFields=t,this._inclusive=s}static _create(e,t,s){return new Ap(e,t,s)}_apply(e){const t=qj(e,this.type,this._docOrFields,this._inclusive);return new or(e.firestore,e.converter,IM(e._query,t))}}function aB(...n){return Ap._create("startAt",n,!0)}function oB(...n){return Ap._create("startAfter",n,!1)}class Rp extends Cd{constructor(e,t,s){super(),this.type=e,this._docOrFields=t,this._inclusive=s}static _create(e,t,s){return new Rp(e,t,s)}_apply(e){const t=qj(e,this.type,this._docOrFields,this._inclusive);return new or(e.firestore,e.converter,DM(e._query,t))}}function lB(...n){return Rp._create("endBefore",n,!1)}function cB(...n){return Rp._create("endAt",n,!0)}function qj(n,e,t,s){if(t[0]=jn(t[0]),t[0]instanceof hd)return(function(c,u,d,p,g){if(!p)throw new Ie(ce.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${d}().`);const b=[];for(const x of Yc(c))if(x.field.isKeyField())b.push(Bl(u,p.key));else{const T=p.data.field(x.field);if(hp(T))throw new Ie(ce.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+x.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(T===null){const N=x.field.canonicalString();throw new Ie(ce.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${N}' (used as the orderBy) does not exist.`)}b.push(T)}return new qo(b,g)})(n._query,n.firestore._databaseId,e,t[0]._document,s);{const o=Zl(n.firestore);return(function(u,d,p,g,b,x){const T=u.explicitOrderBy;if(b.length>T.length)throw new Ie(ce.INVALID_ARGUMENT,`Too many arguments provided to ${g}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const N=[];for(let B=0;B<b.length;B++){const M=b[B];if(T[B].field.isKeyField()){if(typeof M!="string")throw new Ie(ce.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${g}(), but got a ${typeof M}`);if(!Vv(u)&&M.indexOf("/")!==-1)throw new Ie(ce.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${g}() must be a plain document ID, but '${M}' contains a slash.`);const P=u.path.child(fn.fromString(M));if(!Je.isDocumentKey(P))throw new Ie(ce.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${g}() must result in a valid document path, but '${P}' is not because it contains an odd number of segments.`);const Y=new Je(P);N.push(Bl(d,Y))}else{const P=Vj(p,g,M);N.push(P)}}return new qo(N,x)})(n._query,n.firestore._databaseId,o,e,t,s)}}function kT(n,e,t){if(typeof(t=jn(t))=="string"){if(t==="")throw new Ie(ce.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Vv(e)&&t.indexOf("/")!==-1)throw new Ie(ce.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const s=e.path.child(fn.fromString(t));if(!Je.isDocumentKey(s))throw new Ie(ce.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return Bl(n,new Je(s))}if(t instanceof es)return Bl(n,t._key);throw new Ie(ce.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ap(t)}.`)}function ST(n,e){if(!Array.isArray(n)||n.length===0)throw new Ie(ce.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function $j(n,e){const t=(function(o,c){for(const u of o)for(const d of u.getFlattenedFilters())if(c.indexOf(d.op)>=0)return d.op;return null})(n.filters,(function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Ie(ce.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ie(ce.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function Hj(n,e){if(!(e instanceof Id||e instanceof Pu))throw new Ie(ce.INVALID_ARGUMENT,`Function ${n}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}function Cp(n,e,t){let s;return s=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,s}class R0 extends Fj{constructor(e){super(),this.firestore=e}convertBytes(e){return new si(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new es(this.firestore,null,t)}}function uB(n){return new ud("sum",Oa("sum",n))}function hB(n){return new ud("avg",Oa("average",n))}function mL(){return new ud("count")}function dB(n,e){return n instanceof ud&&e instanceof ud&&n.aggregateType===e.aggregateType&&n._internalFieldPath?.canonicalString()===e._internalFieldPath?.canonicalString()}function fB(n,e){return Cj(n.query,e.query)&&Mi(n.data(),e.data())}function mB(n){return pL(n,{count:mL()})}function pL(n,e){const t=yn(n.firestore,ss),s=ws(t),o=Pk(e,((c,u)=>new pS(u,c.aggregateType,c._internalFieldPath)));return G6(s,n._query,o).then((c=>(function(d,p,g){const b=new Zo(d);return new dL(p,b,g)})(t,n,c)))}class gL{constructor(e){this.kind="memory",this._onlineComponentProvider=Ho.provider,this._offlineComponentProvider=e?.garbageCollector?e.garbageCollector._offlineComponentProvider:{build:()=>new g0(void 0)}}toJSON(){return{kind:this.kind}}}class yL{constructor(e){let t;this.kind="persistent",e?.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=wL(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class bL{constructor(){this.kind="memoryEager",this._offlineComponentProvider=yu.provider}toJSON(){return{kind:this.kind}}}class vL{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new g0(e)}}toJSON(){return{kind:this.kind}}}function pB(){return new bL}function gB(n){return new vL(n?.cacheSizeBytes)}function yB(n){return new gL(n)}function bB(n){return new yL(n)}class xL{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Ho.provider,this._offlineComponentProvider={build:t=>new y0(t,e?.cacheSizeBytes,this.forceOwnership)}}}class _L{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Ho.provider,this._offlineComponentProvider={build:t=>new wj(t,e?.cacheSizeBytes)}}}function wL(n){return new xL(n?.forceOwnership)}function vB(){return new _L}const Wj="NOT SUPPORTED";class Co{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ri extends hd{constructor(e,t,s,o,c,u){super(e,t,s,o,u),this._firestore=e,this._firestoreImpl=e,this.metadata=c}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Tm(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(Oa("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ie(ce.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=ri._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}function xB(n,e,t){if(Yl(e,ri._jsonSchema)){if(e.bundle===Wj)throw new Ie(ce.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");const s=Xl(n._databaseId),o=Nj(e.bundle,s),c=o.t(),u=new u0(o.getMetadata(),s);for(const b of c)u.o(b);const d=u.documents;if(d.length!==1)throw new Ie(ce.INVALID_ARGUMENT,`Expected bundle data to contain 1 document, but it contains ${d.length} documents.`);const p=gp(s,d[0].document),g=new Je(fn.fromString(e.bundleName));return new ri(n,new R0(n),g,p,new Co(!1,!1),t||null)}}ri._jsonSchemaVersion="firestore/documentSnapshot/1.0",ri._jsonSchema={type:Ws("string",ri._jsonSchemaVersion),bundleSource:Ws("string","DocumentSnapshot"),bundleName:Ws("string"),bundle:Ws("string")};class Tm extends ri{data(e={}){return super.data(e)}}class ii{constructor(e,t,s,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new Co(o.hasPendingWrites,o.fromCache),this.query=s}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((s=>{e.call(t,new Tm(this._firestore,this._userDataWriter,s.key,s,new Co(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ie(ce.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(o,c){if(o._snapshot.oldDocs.isEmpty()){let u=0;return o._snapshot.docChanges.map((d=>{const p=new Tm(o._firestore,o._userDataWriter,d.doc.key,d.doc,new Co(o._snapshot.mutatedKeys.has(d.doc.key),o._snapshot.fromCache),o.query.converter);return d.doc,{type:"added",doc:p,oldIndex:-1,newIndex:u++}}))}{let u=o._snapshot.oldDocs;return o._snapshot.docChanges.filter((d=>c||d.type!==3)).map((d=>{const p=new Tm(o._firestore,o._userDataWriter,d.doc.key,d.doc,new Co(o._snapshot.mutatedKeys.has(d.doc.key),o._snapshot.fromCache),o.query.converter);let g=-1,b=-1;return d.type!==0&&(g=u.indexOf(d.doc.key),u=u.delete(d.doc.key)),d.type!==1&&(u=u.add(d.doc),b=u.indexOf(d.doc.key)),{type:TL(d.type),doc:p,oldIndex:g,newIndex:b}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ie(ce.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ii._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Sv.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],o=[];return this.docs.forEach((c=>{c._document!==null&&(t.push(c._document),s.push(this._userDataWriter.convertObjectMap(c._document.data.value.mapValue.fields,"previous")),o.push(c.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function _B(n,e,t){if(Yl(e,ii._jsonSchema)){if(e.bundle===Wj)throw new Ie(ce.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");const s=Xl(n._databaseId),o=Nj(e.bundle,s),c=o.t(),u=new u0(o.getMetadata(),s);for(const T of c)u.o(T);if(u.queries.length!==1)throw new Ie(ce.INVALID_ARGUMENT,`Snapshot data expected 1 query but found ${u.queries.length} queries.`);const d=bp(u.queries[0].bundledQuery),p=u.documents;let g=new Il;p.map((T=>{const N=gp(s,T.document);g=g.add(N)}));const b=Gl.fromInitialDocuments(d,g,Zt(),!1,!1),x=new or(n,t||null,d);return new ii(n,new R0(n),x,b)}}function TL(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return lt(61501,{type:n})}}function wB(n,e){return n instanceof ri&&e instanceof ri?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof ii&&e instanceof ii&&n._firestore===e._firestore&&Cj(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}ii._jsonSchemaVersion="firestore/querySnapshot/1.0",ii._jsonSchema={type:Ws("string",ii._jsonSchemaVersion),bundleSource:Ws("string","QuerySnapshot"),bundleName:Ws("string"),bundle:Ws("string")};const EL={maxAttempts:5};class kL{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Zl(e)}set(e,t,s){this._verifyNotCommitted();const o=Io(e,this._firestore),c=Cp(o.converter,t,s),u=jp(this._dataReader,"WriteBatch.set",o._key,c,o.converter!==null,s);return this._mutations.push(u.toMutation(o._key,bs.none())),this}update(e,t,s,...o){this._verifyNotCommitted();const c=Io(e,this._firestore);let u;return u=typeof(t=jn(t))=="string"||t instanceof Du?k0(this._dataReader,"WriteBatch.update",c._key,t,s,o):E0(this._dataReader,"WriteBatch.update",c._key,t),this._mutations.push(u.toMutation(c._key,bs.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Io(e,this._firestore);return this._mutations=this._mutations.concat(new ju(t._key,bs.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ie(ce.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Io(n,e){if((n=jn(n)).firestore!==e)throw new Ie(ce.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class SL{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Zl(e)}get(e){const t=Io(e,this._firestore),s=new R0(this._firestore);return this._transaction.lookup([t._key]).then((o=>{if(!o||o.length!==1)return lt(24041);const c=o[0];if(c.isFoundDocument())return new hd(this._firestore,s,c.key,c,t.converter);if(c.isNoDocument())return new hd(this._firestore,s,t._key,null,t.converter);throw lt(18433,{doc:c})}))}set(e,t,s){const o=Io(e,this._firestore),c=Cp(o.converter,t,s),u=jp(this._dataReader,"Transaction.set",o._key,c,o.converter!==null,s);return this._transaction.set(o._key,u),this}update(e,t,s,...o){const c=Io(e,this._firestore);let u;return u=typeof(t=jn(t))=="string"||t instanceof Du?k0(this._dataReader,"Transaction.update",c._key,t,s,o):E0(this._dataReader,"Transaction.update",c._key,t),this._transaction.update(c._key,u),this}delete(e){const t=Io(e,this._firestore);return this._transaction.delete(t._key),this}}class jL extends SL{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Io(e,this._firestore),s=new Zo(this._firestore);return super.get(e).then((o=>new ri(this._firestore,s,t._key,o._document,new Co(!1,!1),t.converter)))}}function TB(n,e,t){n=yn(n,ss);const s={...EL,...t};(function(u){if(u.maxAttempts<1)throw new Ie(ce.INVALID_ARGUMENT,"Max attempts must be at least 1")})(s);const o=ws(n);return Y6(o,(c=>e(new jL(n,c))),s)}function On(n){n=yn(n,es);const e=yn(n.firestore,ss),t=ws(e);return Sj(t,n._key).then((s=>C0(e,n,s)))}function EB(n){n=yn(n,es);const e=yn(n.firestore,ss),t=ws(e),s=new Zo(e);return H6(t,n._key).then((o=>new ri(e,s,n._key,o,new Co(o!==null&&o.hasLocalMutations,!0),n.converter)))}function kB(n){n=yn(n,es);const e=yn(n.firestore,ss),t=ws(e);return Sj(t,n._key,{source:"server"}).then((s=>C0(e,n,s)))}function Sn(n){n=yn(n,or);const e=yn(n.firestore,ss),t=ws(e),s=new Zo(e);return zj(n._query),jj(t,n._query).then((o=>new ii(e,s,n,o)))}function SB(n){n=yn(n,or);const e=yn(n.firestore,ss),t=ws(e),s=new Zo(e);return W6(t,n._query).then((o=>new ii(e,s,n,o)))}function jB(n){n=yn(n,or);const e=yn(n.firestore,ss),t=ws(e),s=new Zo(e);return jj(t,n._query,{source:"server"}).then((o=>new ii(e,s,n,o)))}function Gn(n,e,t){n=yn(n,es);const s=yn(n.firestore,ss),o=Cp(n.converter,e,t),c=Zl(s);return Dd(s,[jp(c,"setDoc",n._key,o,n.converter!==null,t).toMutation(n._key,bs.none())])}function Sa(n,e,t,...s){n=yn(n,es);const o=yn(n.firestore,ss),c=Zl(o);let u;return u=typeof(e=jn(e))=="string"||e instanceof Du?k0(c,"updateDoc",n._key,e,t,s):E0(c,"updateDoc",n._key,e),Dd(o,[u.toMutation(n._key,bs.exists(!0))])}function Cr(n){return Dd(yn(n.firestore,ss),[new ju(n._key,bs.none())])}function Ia(n,e){const t=yn(n.firestore,ss),s=Qe(n),o=Cp(n.converter,e),c=Zl(n.firestore);return Dd(t,[jp(c,"addDoc",s._key,o,n.converter!==null,{}).toMutation(s._key,bs.exists(!1))]).then((()=>s))}function Jm(n,...e){n=jn(n);let t={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||Jc(e[s])||(t=e[s++]);const o={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Jc(e[s])){const g=e[s];e[s]=g.next?.bind(g),e[s+1]=g.error?.bind(g),e[s+2]=g.complete?.bind(g)}let c,u,d;if(n instanceof es)u=yn(n.firestore,ss),d=ku(n._key.path),c={next:g=>{e[s]&&e[s](C0(u,n,g))},error:e[s+1],complete:e[s+2]};else{const g=yn(n,or);u=yn(g.firestore,ss),d=g._query;const b=new Zo(u);c={next:x=>{e[s]&&e[s](new ii(u,b,g,x))},error:e[s+1],complete:e[s+2]},zj(n._query)}const p=ws(u);return $6(p,d,o,c)}function NB(n,e,...t){const s=jn(n),o=(function(p){const g={bundle:"",bundleName:"",bundleSource:""},b=["bundle","bundleName","bundleSource"];for(const x of b){if(!(x in p)){g.error=`snapshotJson missing required field: ${x}`;break}const T=p[x];if(typeof T!="string"){g.error=`snapshotJson field '${x}' must be a string.`;break}if(T.length===0){g.error=`snapshotJson field '${x}' cannot be an empty string.`;break}x==="bundle"?g.bundle=T:x==="bundleName"?g.bundleName=T:x==="bundleSource"&&(g.bundleSource=T)}return g})(e);if(o.error)throw new Ie(ce.INVALID_ARGUMENT,o.error);let c,u=0;if(typeof t[u]!="object"||Jc(t[u])||(c=t[u++]),o.bundleSource==="QuerySnapshot"){let d=null;if(typeof t[u]=="object"&&Jc(t[u])){const p=t[u++];d={next:p.next,error:p.error,complete:p.complete}}else d={next:t[u++],error:t[u++],complete:t[u++]};return(function(g,b,x,T,N){let B,M=!1;return wT(g,b.bundle).then((()=>oL(g,b.bundleName))).then((Y=>{Y&&!M&&(N&&Y.withConverter(N),B=Jm(Y,x||{},T))})).catch((Y=>(T.error&&T.error(Y),()=>{}))),()=>{M||(M=!0,B&&B())}})(s,o,c,d,t[u])}if(o.bundleSource==="DocumentSnapshot"){let d=null;if(typeof t[u]=="object"&&Jc(t[u])){const p=t[u++];d={next:p.next,error:p.error,complete:p.complete}}else d={next:t[u++],error:t[u++],complete:t[u++]};return(function(g,b,x,T,N){let B,M=!1;return wT(g,b.bundle).then((()=>{if(!M){const Y=new es(g,N||null,Je.fromPath(b.bundleName));B=Jm(Y,x||{},T)}})).catch((Y=>(T.error&&T.error(Y),()=>{}))),()=>{M||(M=!0,B&&B())}})(s,o,c,d,t[u])}throw new Ie(ce.INVALID_ARGUMENT,`unsupported bundle source: ${o.bundleSource}`)}function AB(n,e){n=yn(n,ss);const t=ws(n),s=Jc(e)?e:{next:e};return Q6(t,s)}function Dd(n,e){const t=ws(n);return K6(t,e)}function C0(n,e,t){const s=t.docs.get(e._key),o=new Zo(n);return new ri(n,o,e._key,s,new Co(t.hasPendingWrites,t.fromCache),e.converter)}function jT(n){return n=yn(n,ss),ws(n),new kL(n,(e=>Dd(n,e)))}function RB(n,e){n=yn(n,ss);const t=ws(n);if(!t._uninitializedComponentsProvider||t._uninitializedComponentsProvider._offline.kind==="memory")return wi("Cannot enable indexes when persistence is disabled"),Promise.resolve();const s=(function(c){const u=typeof c=="string"?(function(g){try{return JSON.parse(g)}catch(b){throw new Ie(ce.INVALID_ARGUMENT,"Failed to parse JSON: "+b?.message)}})(c):c,d=[];if(Array.isArray(u.indexes))for(const p of u.indexes){const g=NT(p,"collectionGroup"),b=[];if(Array.isArray(p.fields))for(const x of p.fields){const T=NT(x,"fieldPath"),N=j0("setIndexConfiguration",T);x.arrayConfig==="CONTAINS"?b.push(new Rl(N,2)):x.order==="ASCENDING"?b.push(new Rl(N,0)):x.order==="DESCENDING"&&b.push(new Rl(N,1))}d.push(new tu(tu.UNKNOWN_ID,g,b,nu.empty()))}return d})(e);return Z6(t,s)}function NT(n,e){if(typeof n[e]!="string")throw new Ie(ce.INVALID_ARGUMENT,"Missing string value for: "+e);return n[e]}class NL{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function CB(n){n=yn(n,ss);const e=AT.get(n);if(e)return e;if(ws(n)._uninitializedComponentsProvider?._offline.kind!=="persistent")return null;const s=new NL(n);return AT.set(n,s),s}function IB(n){Gj(n,!0)}function DB(n){Gj(n,!1)}function PB(n){const e=ws(n._firestore);tL(e).then((t=>Oe("deleting all persistent cache indexes succeeded"))).catch((t=>wi("deleting all persistent cache indexes failed",t)))}function Gj(n,e){const t=ws(n._firestore);eL(t,e).then((s=>Oe(`setting persistent cache index auto creation isEnabled=${e} succeeded`))).catch((s=>wi(`setting persistent cache index auto creation isEnabled=${e} failed`,s)))}const AT=new WeakMap;class MB{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return I0.instance.onExistenceFilterMismatch(e)}}class I0{constructor(){this.i=new Map}static get instance(){return Jf||(Jf=new I0,WM(Jf)),Jf}u(e){this.i.forEach((t=>t(e)))}onExistenceFilterMismatch(e){const t=Symbol(),s=this.i;return s.set(t,e),()=>s.delete(t)}}let Jf=null;(function(e,t=!0){jP(Ql),Ml(new Bo("firestore",((s,{instanceIdentifier:o,options:c})=>{const u=s.getProvider("app").getImmediate(),d=new ss(new RP(s.getProvider("auth-internal")),new DP(u,s.getProvider("app-check-internal")),vM(u,o),u);return c={useFetchStreams:t,...c},d._setSettings(c),d}),"PUBLIC").setMultipleInstances(!0)),Zi(TT,ET,e),Zi(TT,ET,"esm2020")})();var AL="firebase",RL="12.8.0";Zi(AL,RL,"app");const Kj="firebasestorage.googleapis.com",Qj="storageBucket",CL=120*1e3,IL=600*1e3;class Cs extends la{constructor(e,t,s=0){super(Jy(e),`Firebase Storage: ${t} (${Jy(e)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Cs.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Jy(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Rs;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Rs||(Rs={}));function Jy(n){return"storage/"+n}function D0(){const n="An unknown error occurred, please check the error payload for server response.";return new Cs(Rs.UNKNOWN,n)}function DL(n){return new Cs(Rs.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function PL(n){return new Cs(Rs.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function ML(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Cs(Rs.UNAUTHENTICATED,n)}function LL(){return new Cs(Rs.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function VL(n){return new Cs(Rs.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function OL(){return new Cs(Rs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function BL(){return new Cs(Rs.CANCELED,"User canceled the upload/download.")}function UL(n){return new Cs(Rs.INVALID_URL,"Invalid URL '"+n+"'.")}function FL(n){return new Cs(Rs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function zL(){return new Cs(Rs.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Qj+"' property when initializing the app?")}function qL(){return new Cs(Rs.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function $L(){return new Cs(Rs.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function HL(n){return new Cs(Rs.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function tv(n){return new Cs(Rs.INVALID_ARGUMENT,n)}function Yj(){return new Cs(Rs.APP_DELETED,"The Firebase app was deleted.")}function WL(n){return new Cs(Rs.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Wh(n,e){return new Cs(Rs.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Sh(n){throw new Cs(Rs.INTERNAL_ERROR,"Internal error: "+n)}class Ir{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let s;try{s=Ir.makeFromUrl(e,t)}catch{return new Ir(e,"")}if(s.path==="")return s;throw FL(e)}static makeFromUrl(e,t){let s=null;const o="([A-Za-z0-9.\\-_]+)";function c(de){de.path.charAt(de.path.length-1)==="/"&&(de.path_=de.path_.slice(0,-1))}const u="(/(.*))?$",d=new RegExp("^gs://"+o+u,"i"),p={bucket:1,path:3};function g(de){de.path_=decodeURIComponent(de.path)}const b="v[A-Za-z0-9_]+",x=t.replace(/[.]/g,"\\."),T="(/([^?#]*).*)?$",N=new RegExp(`^https?://${x}/${b}/b/${o}/o${T}`,"i"),B={bucket:1,path:3},M=t===Kj?"(?:storage.googleapis.com|storage.cloud.google.com)":t,P="([^?#]*)",Y=new RegExp(`^https?://${M}/${o}/${P}`,"i"),J=[{regex:d,indices:p,postModify:c},{regex:N,indices:B,postModify:g},{regex:Y,indices:{bucket:1,path:2},postModify:g}];for(let de=0;de<J.length;de++){const Ne=J[de],we=Ne.regex.exec(e);if(we){const A=we[Ne.indices.bucket];let S=we[Ne.indices.path];S||(S=""),s=new Ir(A,S),Ne.postModify(s);break}}if(s==null)throw UL(e);return s}}class GL{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function KL(n,e,t){let s=1,o=null,c=null,u=!1,d=0;function p(){return d===2}let g=!1;function b(...P){g||(g=!0,e.apply(null,P))}function x(P){o=setTimeout(()=>{o=null,n(N,p())},P)}function T(){c&&clearTimeout(c)}function N(P,...Y){if(g){T();return}if(P){T(),b.call(null,P,...Y);return}if(p()||u){T(),b.call(null,P,...Y);return}s<64&&(s*=2);let J;d===1?(d=2,J=0):J=(s+Math.random())*1e3,x(J)}let B=!1;function M(P){B||(B=!0,T(),!g&&(o!==null?(P||(d=2),clearTimeout(o),x(0)):P||(d=1)))}return x(0),c=setTimeout(()=>{u=!0,M(!0)},t),M}function QL(n){n(!1)}function YL(n){return n!==void 0}function XL(n){return typeof n=="object"&&!Array.isArray(n)}function P0(n){return typeof n=="string"||n instanceof String}function RT(n){return M0()&&n instanceof Blob}function M0(){return typeof Blob<"u"}function nv(n,e,t,s){if(s<e)throw tv(`Invalid value for '${n}'. Expected ${e} or greater.`);if(s>t)throw tv(`Invalid value for '${n}'. Expected ${t} or less.`)}function Ip(n,e,t){let s=e;return t==null&&(s=`https://${e}`),`${t}://${s}/v0${n}`}function Xj(n){const e=encodeURIComponent;let t="?";for(const s in n)if(n.hasOwnProperty(s)){const o=e(s)+"="+e(n[s]);t=t+o+"&"}return t=t.slice(0,-1),t}var Dl;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Dl||(Dl={}));function JL(n,e){const t=n>=500&&n<600,o=[408,429].indexOf(n)!==-1,c=e.indexOf(n)!==-1;return t||o||c}class ZL{constructor(e,t,s,o,c,u,d,p,g,b,x,T=!0,N=!1){this.url_=e,this.method_=t,this.headers_=s,this.body_=o,this.successCodes_=c,this.additionalRetryCodes_=u,this.callback_=d,this.errorCallback_=p,this.timeout_=g,this.progressCallback_=b,this.connectionFactory_=x,this.retry=T,this.isUsingEmulator=N,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((B,M)=>{this.resolve_=B,this.reject_=M,this.start_()})}start_(){const e=(s,o)=>{if(o){s(!1,new Zf(!1,null,!0));return}const c=this.connectionFactory_();this.pendingConnection_=c;const u=d=>{const p=d.loaded,g=d.lengthComputable?d.total:-1;this.progressCallback_!==null&&this.progressCallback_(p,g)};this.progressCallback_!==null&&c.addUploadProgressListener(u),c.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&c.removeUploadProgressListener(u),this.pendingConnection_=null;const d=c.getErrorCode()===Dl.NO_ERROR,p=c.getStatus();if(!d||JL(p,this.additionalRetryCodes_)&&this.retry){const b=c.getErrorCode()===Dl.ABORT;s(!1,new Zf(!1,null,b));return}const g=this.successCodes_.indexOf(p)!==-1;s(!0,new Zf(g,c))})},t=(s,o)=>{const c=this.resolve_,u=this.reject_,d=o.connection;if(o.wasSuccessCode)try{const p=this.callback_(d,d.getResponse());YL(p)?c(p):c()}catch(p){u(p)}else if(d!==null){const p=D0();p.serverResponse=d.getErrorText(),this.errorCallback_?u(this.errorCallback_(d,p)):u(p)}else if(o.canceled){const p=this.appDelete_?Yj():BL();u(p)}else{const p=OL();u(p)}};this.canceled_?t(!1,new Zf(!1,null,!0)):this.backoffId_=KL(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&QL(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Zf{constructor(e,t,s){this.wasSuccessCode=e,this.connection=t,this.canceled=!!s}}function eV(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function tV(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function nV(n,e){e&&(n["X-Firebase-GMPID"]=e)}function sV(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function rV(n,e,t,s,o,c,u=!0,d=!1){const p=Xj(n.urlParams),g=n.url+p,b=Object.assign({},n.headers);return nV(b,e),eV(b,t),tV(b,c),sV(b,s),new ZL(g,n.method,b,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,o,u,d)}function iV(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function aV(...n){const e=iV();if(e!==void 0){const t=new e;for(let s=0;s<n.length;s++)t.append(n[s]);return t.getBlob()}else{if(M0())return new Blob(n);throw new Cs(Rs.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function oV(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function lV(n){if(typeof atob>"u")throw HL("base-64");return atob(n)}const Ji={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Zy{constructor(e,t){this.data=e,this.contentType=t||null}}function cV(n,e){switch(n){case Ji.RAW:return new Zy(Jj(e));case Ji.BASE64:case Ji.BASE64URL:return new Zy(Zj(n,e));case Ji.DATA_URL:return new Zy(hV(e),dV(e))}throw D0()}function Jj(n){const e=[];for(let t=0;t<n.length;t++){let s=n.charCodeAt(t);if(s<=127)e.push(s);else if(s<=2047)e.push(192|s>>6,128|s&63);else if((s&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const c=s,u=n.charCodeAt(++t);s=65536|(c&1023)<<10|u&1023,e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|s&63)}else(s&64512)===56320?e.push(239,191,189):e.push(224|s>>12,128|s>>6&63,128|s&63)}return new Uint8Array(e)}function uV(n){let e;try{e=decodeURIComponent(n)}catch{throw Wh(Ji.DATA_URL,"Malformed data URL.")}return Jj(e)}function Zj(n,e){switch(n){case Ji.BASE64:{const o=e.indexOf("-")!==-1,c=e.indexOf("_")!==-1;if(o||c)throw Wh(n,"Invalid character '"+(o?"-":"_")+"' found: is it base64url encoded?");break}case Ji.BASE64URL:{const o=e.indexOf("+")!==-1,c=e.indexOf("/")!==-1;if(o||c)throw Wh(n,"Invalid character '"+(o?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=lV(e)}catch(o){throw o.message.includes("polyfill")?o:Wh(n,"Invalid character found")}const s=new Uint8Array(t.length);for(let o=0;o<t.length;o++)s[o]=t.charCodeAt(o);return s}class eN{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw Wh(Ji.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const s=t[1]||null;s!=null&&(this.base64=fV(s,";base64"),this.contentType=this.base64?s.substring(0,s.length-7):s),this.rest=e.substring(e.indexOf(",")+1)}}function hV(n){const e=new eN(n);return e.base64?Zj(Ji.BASE64,e.rest):uV(e.rest)}function dV(n){return new eN(n).contentType}function fV(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}class Ao{constructor(e,t){let s=0,o="";RT(e)?(this.data_=e,s=e.size,o=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),s=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),s=e.length),this.size_=s,this.type_=o}size(){return this.size_}type(){return this.type_}slice(e,t){if(RT(this.data_)){const s=this.data_,o=oV(s,e,t);return o===null?null:new Ao(o)}else{const s=new Uint8Array(this.data_.buffer,e,t-e);return new Ao(s,!0)}}static getBlob(...e){if(M0()){const t=e.map(s=>s instanceof Ao?s.data_:s);return new Ao(aV.apply(null,t))}else{const t=e.map(u=>P0(u)?cV(Ji.RAW,u).data:u.data_);let s=0;t.forEach(u=>{s+=u.byteLength});const o=new Uint8Array(s);let c=0;return t.forEach(u=>{for(let d=0;d<u.length;d++)o[c++]=u[d]}),new Ao(o,!0)}}uploadData(){return this.data_}}function L0(n){let e;try{e=JSON.parse(n)}catch{return null}return XL(e)?e:null}function mV(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function pV(n,e){const t=e.split("/").filter(s=>s.length>0).join("/");return n.length===0?t:n+"/"+t}function tN(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function gV(n,e){return e}class Rr{constructor(e,t,s,o){this.server=e,this.local=t||e,this.writable=!!s,this.xform=o||gV}}let em=null;function yV(n){return!P0(n)||n.length<2?n:tN(n)}function nN(){if(em)return em;const n=[];n.push(new Rr("bucket")),n.push(new Rr("generation")),n.push(new Rr("metageneration")),n.push(new Rr("name","fullPath",!0));function e(c,u){return yV(u)}const t=new Rr("name");t.xform=e,n.push(t);function s(c,u){return u!==void 0?Number(u):u}const o=new Rr("size");return o.xform=s,n.push(o),n.push(new Rr("timeCreated")),n.push(new Rr("updated")),n.push(new Rr("md5Hash",null,!0)),n.push(new Rr("cacheControl",null,!0)),n.push(new Rr("contentDisposition",null,!0)),n.push(new Rr("contentEncoding",null,!0)),n.push(new Rr("contentLanguage",null,!0)),n.push(new Rr("contentType",null,!0)),n.push(new Rr("metadata","customMetadata",!0)),em=n,em}function bV(n,e){function t(){const s=n.bucket,o=n.fullPath,c=new Ir(s,o);return e._makeStorageReference(c)}Object.defineProperty(n,"ref",{get:t})}function vV(n,e,t){const s={};s.type="file";const o=t.length;for(let c=0;c<o;c++){const u=t[c];s[u.local]=u.xform(s,e[u.server])}return bV(s,n),s}function sN(n,e,t){const s=L0(e);return s===null?null:vV(n,s,t)}function xV(n,e,t,s){const o=L0(e);if(o===null||!P0(o.downloadTokens))return null;const c=o.downloadTokens;if(c.length===0)return null;const u=encodeURIComponent;return c.split(",").map(g=>{const b=n.bucket,x=n.fullPath,T="/b/"+u(b)+"/o/"+u(x),N=Ip(T,t,s),B=Xj({alt:"media",token:g});return N+B})[0]}function _V(n,e){const t={},s=e.length;for(let o=0;o<s;o++){const c=e[o];c.writable&&(t[c.server]=n[c.local])}return JSON.stringify(t)}const CT="prefixes",IT="items";function wV(n,e,t){const s={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[CT])for(const o of t[CT]){const c=o.replace(/\/$/,""),u=n._makeStorageReference(new Ir(e,c));s.prefixes.push(u)}if(t[IT])for(const o of t[IT]){const c=n._makeStorageReference(new Ir(e,o.name));s.items.push(c)}return s}function TV(n,e,t){const s=L0(t);return s===null?null:wV(n,e,s)}class V0{constructor(e,t,s,o){this.url=e,this.method=t,this.handler=s,this.timeout=o,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function O0(n){if(!n)throw D0()}function EV(n,e){function t(s,o){const c=sN(n,o,e);return O0(c!==null),c}return t}function kV(n,e){function t(s,o){const c=TV(n,e,o);return O0(c!==null),c}return t}function SV(n,e){function t(s,o){const c=sN(n,o,e);return O0(c!==null),xV(c,o,n.host,n._protocol)}return t}function B0(n){function e(t,s){let o;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?o=LL():o=ML():t.getStatus()===402?o=PL(n.bucket):t.getStatus()===403?o=VL(n.path):o=s,o.status=t.getStatus(),o.serverResponse=s.serverResponse,o}return e}function jV(n){const e=B0(n);function t(s,o){let c=e(s,o);return s.getStatus()===404&&(c=DL(n.path)),c.serverResponse=o.serverResponse,c}return t}function NV(n,e,t,s,o){const c={};e.isRoot?c.prefix="":c.prefix=e.path+"/",t.length>0&&(c.delimiter=t),s&&(c.pageToken=s),o&&(c.maxResults=o);const u=e.bucketOnlyServerUrl(),d=Ip(u,n.host,n._protocol),p="GET",g=n.maxOperationRetryTime,b=new V0(d,p,kV(n,e.bucket),g);return b.urlParams=c,b.errorHandler=B0(e),b}function AV(n,e,t){const s=e.fullServerUrl(),o=Ip(s,n.host,n._protocol),c="GET",u=n.maxOperationRetryTime,d=new V0(o,c,SV(n,t),u);return d.errorHandler=jV(e),d}function RV(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function CV(n,e,t){const s=Object.assign({},t);return s.fullPath=n.path,s.size=e.size(),s.contentType||(s.contentType=RV(null,e)),s}function IV(n,e,t,s,o){const c=e.bucketOnlyServerUrl(),u={"X-Goog-Upload-Protocol":"multipart"};function d(){let J="";for(let de=0;de<2;de++)J=J+Math.random().toString().slice(2);return J}const p=d();u["Content-Type"]="multipart/related; boundary="+p;const g=CV(e,s,o),b=_V(g,t),x="--"+p+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+b+`\r
--`+p+`\r
Content-Type: `+g.contentType+`\r
\r
`,T=`\r
--`+p+"--",N=Ao.getBlob(x,s,T);if(N===null)throw qL();const B={name:g.fullPath},M=Ip(c,n.host,n._protocol),P="POST",Y=n.maxUploadRetryTime,$=new V0(M,P,EV(n,t),Y);return $.urlParams=B,$.headers=u,$.body=N.uploadData(),$.errorHandler=B0(e),$}class DV{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Dl.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Dl.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Dl.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,s,o,c){if(this.sent_)throw Sh("cannot .send() more than once");if(Ba(e)&&s&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),c!==void 0)for(const u in c)c.hasOwnProperty(u)&&this.xhr_.setRequestHeader(u,c[u].toString());return o!==void 0?this.xhr_.send(o):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Sh("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Sh("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Sh("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Sh("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class PV extends DV{initXhr(){this.xhr_.responseType="text"}}function U0(){return new PV}class Kl{constructor(e,t){this._service=e,t instanceof Ir?this._location=t:this._location=Ir.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Kl(e,t)}get root(){const e=new Ir(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return tN(this._location.path)}get storage(){return this._service}get parent(){const e=mV(this._location.path);if(e===null)return null;const t=new Ir(this._location.bucket,e);return new Kl(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw WL(e)}}function MV(n,e,t){n._throwIfRoot("uploadBytes");const s=IV(n.storage,n._location,nN(),new Ao(e,!0),t);return n.storage.makeRequestWithTokens(s,U0).then(o=>({metadata:o,ref:n}))}function LV(n){const e={prefixes:[],items:[]};return rN(n,e).then(()=>e)}async function rN(n,e,t){const o=await VV(n,{pageToken:t});e.prefixes.push(...o.prefixes),e.items.push(...o.items),o.nextPageToken!=null&&await rN(n,e,o.nextPageToken)}function VV(n,e){e!=null&&typeof e.maxResults=="number"&&nv("options.maxResults",1,1e3,e.maxResults);const t=e||{},s=NV(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(s,U0)}function OV(n){n._throwIfRoot("getDownloadURL");const e=AV(n.storage,n._location,nN());return n.storage.makeRequestWithTokens(e,U0).then(t=>{if(t===null)throw $L();return t})}function BV(n,e){const t=pV(n._location.path,e),s=new Ir(n._location.bucket,t);return new Kl(n.storage,s)}function UV(n){return/^[A-Za-z]+:\/\//.test(n)}function FV(n,e){return new Kl(n,e)}function iN(n,e){if(n instanceof F0){const t=n;if(t._bucket==null)throw zL();const s=new Kl(t,t._bucket);return e!=null?iN(s,e):s}else return e!==void 0?BV(n,e):n}function zV(n,e){if(e&&UV(e)){if(n instanceof F0)return FV(n,e);throw tv("To use ref(service, url), the first argument must be a Storage instance.")}else return iN(n,e)}function DT(n,e){const t=e?.[Qj];return t==null?null:Ir.makeFromBucketSpec(t,n)}function qV(n,e,t,s={}){n.host=`${e}:${t}`;const o=Ba(e);o&&(np(`https://${n.host}/b`),hv("Storage",!0)),n._isUsingEmulator=!0,n._protocol=o?"https":"http";const{mockUserToken:c}=s;c&&(n._overrideAuthToken=typeof c=="string"?c:yE(c,n.app.options.projectId))}class F0{constructor(e,t,s,o,c,u=!1){this.app=e,this._authProvider=t,this._appCheckProvider=s,this._url=o,this._firebaseVersion=c,this._isUsingEmulator=u,this._bucket=null,this._host=Kj,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=CL,this._maxUploadRetryTime=IL,this._requests=new Set,o!=null?this._bucket=Ir.makeFromBucketSpec(o,this._host):this._bucket=DT(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ir.makeFromBucketSpec(this._url,e):this._bucket=DT(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){nv("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){nv("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(ni(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Kl(this,e)}_makeRequest(e,t,s,o,c=!0){if(this._deleted)return new GL(Yj());{const u=rV(e,this._appId,s,o,t,this._firebaseVersion,c,this._isUsingEmulator);return this._requests.add(u),u.getPromise().then(()=>this._requests.delete(u),()=>this._requests.delete(u)),u}}async makeRequestWithTokens(e,t){const[s,o]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,s,o).getPromise()}}const PT="@firebase/storage",MT="0.14.0";const aN="storage";function eb(n,e,t){return n=jn(n),MV(n,e,t)}function LT(n){return n=jn(n),LV(n)}function Pl(n){return n=jn(n),OV(n)}function Do(n,e){return n=jn(n),zV(n,e)}function $V(n=pv(),e){n=jn(n);const s=wu(n,aN).getImmediate({identifier:e}),o=mE("storage");return o&&HV(s,...o),s}function HV(n,e,t,s={}){qV(n,e,t,s)}function WV(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),s=n.getProvider("auth-internal"),o=n.getProvider("app-check-internal");return new F0(t,s,o,e,Ql)}function GV(){Ml(new Bo(aN,WV,"PUBLIC").setMultipleInstances(!0)),Zi(PT,MT,""),Zi(PT,MT,"esm2020")}GV();const oN={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},z0=mv(oN),yl=ak(z0),_e=aL(z0),Po=$V(z0),KV=mv(oN,"secondary"),LB=ak(KV),QV="EYdciKDOi3UYBLk1u8hHams5tmO2",lN=_.createContext();function li(){return _.useContext(lN)}function YV({children:n}){const[e,t]=_.useState(null),[s,o]=_.useState(!1),[c,u]=_.useState(!1),[d,p]=_.useState(null),[g,b]=_.useState(!0);_.useEffect(()=>{let $=null;const J=pD(yl,de=>{if(t(de),$&&($(),$=null),de)if(de.uid===QV)o(!0),u(!1),p(null),b(!1);else{o(!1);const Ne=In(Wt(_e,"clients"),dn("uid","==",de.uid)),we=async()=>{const A=localStorage.getItem("mcf_clientId");if(A)try{const S=await On(Qe(_e,"clients",A));S.exists()&&(u(!0),p({id:S.id,...S.data()}))}catch(S){console.error("Direct client read failed:",S)}};$=Jm(Ne,async A=>{if(A.empty)await we();else{const S=A.docs[0];u(!0),p({id:S.id,...S.data()});try{localStorage.setItem("mcf_clientId",S.id)}catch{}}b(!1)},async A=>{console.error("Error listening to client data:",A),await we(),b(!1)})}else o(!1),u(!1),p(null),b(!1)});return()=>{J(),$&&$()}},[]);const Y={currentUser:e,isAdmin:s,isClient:c,clientData:d,updateClientData:$=>{p(J=>J?{...J,...$}:$)},resolveClient:async()=>{if(d)return d;const $=localStorage.getItem("mcf_clientId");if($)try{const J=await On(Qe(_e,"clients",$));if(J.exists()){const de={id:J.id,...J.data()};return u(!0),p(de),de}}catch(J){console.error("resolveClient direct read failed:",J)}if(e){const J=In(Wt(_e,"clients"),dn("uid","==",e.uid)),de=await Sn(J);if(!de.empty){const Ne={id:de.docs[0].id,...de.docs[0].data()};return u(!0),p(Ne),Ne}}return null},login:async($,J,de=!0)=>(await Kw(yl,de?kb:wv),await dD(yl,$,J)),signup:async($,J,de)=>{await Kw(yl,kb);const Ne=await hD(yl,J.trim().toLowerCase(),de),we=Ne.user,A=Qe(Wt(_e,"clients")),S={uid:we.uid,name:$.trim(),email:J.trim().toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"self_signup",createdAt:mt.now()};await Gn(A,S),u(!0),p({id:A.id,...S});try{localStorage.setItem("mcf_clientId",A.id)}catch{}return Ne},logout:()=>{try{localStorage.removeItem("mcf_clientId")}catch{}return gD(yl)},resetPassword:$=>uD(yl,$),loading:g};return a.jsx(lN.Provider,{value:Y,children:n})}const cN=_.createContext();function Bi(){return _.useContext(cN)}function XV({children:n}){const[e,t]=_.useState(()=>{const p=localStorage.getItem("theme");return p?p==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),[s,o]=_.useState(()=>localStorage.getItem("accent")||"red");_.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light")},[e]),_.useEffect(()=>{localStorage.setItem("accent",s)},[s]);const d={isDark:e,toggleTheme:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),t(!e),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)},accent:s,setAccent:p=>o(p)};return a.jsx(cN.Provider,{value:d,children:n})}const uN=_.createContext();function Dp(){return _.useContext(uN)}const JV=["nutrition","consistency","personalBests","achievements","buddies","programmes","leaderboard"],ZV=[5,10],e5=1;function t5({children:n}){const{clientData:e}=li(),t=_.useMemo(()=>{const s=e?.tier||"free",o=e?.subscriptionStatus||null,c=e&&e.signupSource!=="self_signup",u=s==="premium"||!!c;function d(p){return u?!0:!JV.includes(p)}return{tier:s,subscriptionStatus:o,isPremium:u,canAccess:d,FREE_RANDOMISER_DURATIONS:ZV,FREE_RANDOMISER_WEEKLY_LIMIT:e5}},[e?.tier,e?.subscriptionStatus,e?.signupSource]);return a.jsx(uN.Provider,{value:t,children:n})}function n5(n){if(n?.signupSource==="self_signup"&&!n?.onboardingComplete)return"/onboarding";const e=n?.clientType;return e==="core_buddy"?"/client/core-buddy":e==="circuit_vip"||e==="circuit_dropin"?"/client/circuit":"/client"}function s5({className:n=""}){const{isDark:e,toggleTheme:t}=Bi();return a.jsx("button",{className:n||"theme-toggle",onClick:t,"aria-label":e?"Switch to light mode":"Switch to dark mode",children:e?a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})})}function r5(){const[n,e]=_.useState(""),[t,s]=_.useState(""),[o,c]=_.useState(!0),[u,d]=_.useState(""),[p,g]=_.useState(!1),[b,x]=_.useState(!1),[T,N]=_.useState(!1),{login:B,resetPassword:M,currentUser:P,isAdmin:Y,isClient:$,clientData:J,loading:de}=li(),Ne=gr();if(_.useEffect(()=>{!de&&P&&(Y?Ne("/dashboard"):$?Ne(n5(J)):(g(!1),d("No account found. Please sign up or contact your trainer.")))},[de,P,Y,$,J,Ne]),de||P)return null;const we=async S=>{S.preventDefault(),d(""),g(!0);try{await B(n,t,o)}catch(D){d(D.message||"Failed to log in"),g(!1)}},A=async S=>{if(S.preventDefault(),d(""),!n.trim()){d("Please enter your email address");return}g(!0);try{await M(n.trim()),N(!0)}catch(D){D.code==="auth/user-not-found"?d("No account found with this email"):d(D.message||"Failed to send reset email")}g(!1)};return a.jsxs("div",{className:"login-container",children:[a.jsx(s5,{className:"login-theme-toggle"}),a.jsxs("div",{className:"login-card",children:[a.jsxs("div",{className:"login-header",children:[a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),a.jsx("p",{children:a.jsx("strong",{children:b?"Reset Password":"Sign in as 1-2-1 or a Core Buddy"})})]}),u&&a.jsx("div",{className:"error-message",children:u}),T?a.jsxs("div",{className:"reset-sent",children:[a.jsx("div",{className:"reset-sent-icon",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),a.jsx("p",{children:"Reset email sent!"}),a.jsx("span",{children:"Check your inbox for a password reset link"}),a.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{x(!1),N(!1),d("")},children:"Back to Log In"})]}):b?a.jsxs("form",{onSubmit:A,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:n,onChange:S=>e(S.target.value),placeholder:"Enter your email",required:!0})]}),a.jsx("button",{type:"submit",className:"login-btn",disabled:p,children:p?"Sending...":"Send Reset Link"}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{x(!1),d("")},children:"Back to Log In"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("form",{onSubmit:we,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:n,onChange:S=>e(S.target.value),required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"password",children:"Password"}),a.jsx("input",{type:"password",id:"password",value:t,onChange:S=>s(S.target.value),required:!0})]}),a.jsx("div",{className:"remember-me",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:o,onChange:S=>c(S.target.checked)}),a.jsx("span",{children:"Remember me"})]})}),a.jsx("button",{type:"submit",className:"login-btn",disabled:p,children:p?"Logging in...":"Log In"})]}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{x(!0),d("")},children:"Forgot password?"})]}),a.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})]})}function bl({feature:n,children:e}){const{canAccess:t}=Dp(),s=gr();return t(n)?e:a.jsxs("div",{className:"locked-feature-wrap",children:[a.jsx("div",{className:"locked-feature-bg","aria-hidden":"true",children:e}),a.jsx("div",{className:"locked-feature-overlay",children:a.jsxs("div",{className:"locked-feature-card",children:[a.jsx("div",{className:"locked-icon",children:a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),a.jsx("h2",{children:"Premium Feature"}),a.jsx("p",{children:"Upgrade to Core Buddy Premium to unlock this feature and get full access to everything."}),a.jsx("button",{className:"locked-upgrade-btn",onClick:()=>s("/upgrade"),children:"Upgrade Now"})]})})]})}function oa({active:n}){const e=gr(),{clientData:t}=li(),{isPremium:s}=Dp(),o=t?.clientType==="block"&&t?.coreBuddyAccess;return a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:`block-nav-tab${n==="home"?" active":""}`,onClick:()=>e("/client/core-buddy"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),a.jsx("span",{children:"Profile"})]}),a.jsxs("button",{className:`block-nav-tab${n==="workouts"?" active":""}`,onClick:()=>e("/client/core-buddy/workouts"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:a.jsx("path",{d:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"})}),a.jsx("span",{children:"Workouts"})]}),a.jsxs("button",{className:`block-nav-tab${n==="nutrition"?" active":""}`,onClick:()=>e(s?"/client/core-buddy/nutrition":"/upgrade"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"})}),a.jsx("span",{children:"Nutrition"})]}),a.jsxs("button",{className:`block-nav-tab${n==="buddies"?" active":""}`,onClick:()=>e(s?"/client/core-buddy/buddies":"/upgrade"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"Buddies"})]}),o&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>e("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),a.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),a.jsx("span",{children:"Block"})]})]})}function Pd(n,e,t,s,o){const c=[];for(let u=0;u<n;u++){const d=(u*(360/n)-90)*(Math.PI/180);c.push({x1:e+s*Math.cos(d),y1:t+s*Math.sin(d),x2:e+o*Math.cos(d),y2:t+o*Math.sin(d),thick:u%5===0})}return c}const q0=Pd(60,100,100,85,96),Gh=Pd(60,100,100,78,94),i5=Pd(60,100,100,82,94);Pd(60,50,50,38,46);const a5=Pd(60,40,40,30,37),o5="/login/assets/first_workout-B8SFkzJX.PNG",l5="/login/assets/workouts_10-Z5R3u0xH.PNG",c5="/login/assets/workouts_25-CzxSlcAj.PNG",u5="/login/assets/workouts_50-BpzWup3V.PNG",h5="/login/assets/workouts_100-D7_r6tn1.PNG",d5="/login/assets/streak_2-CsRr-XA9.PNG",f5="/login/assets/streak_4-BHO09tbw.PNG",m5="/login/assets/streak_8-DX2UWMko.PNG",p5="/login/assets/first_pb-aVf_CNWy.PNG",g5="/login/assets/pbs_5-Cippawgg.PNG",y5="/login/assets/pbs_10-CZgGh9Kv.PNG",b5="/login/assets/pbs_100-C67b1wfS.PNG",v5="/login/assets/nutrition_7-CHVV11fj.PNG",x5="/login/assets/leaderboard_join-BLoId4Hz.PNG",_5="/login/assets/habits_7-Dvki70KO.PNG",Kh=[{id:"first_workout",img:o5,name:"First Rep",desc:"Complete your first workout",category:"workouts",threshold:1},{id:"workouts_10",img:l5,name:"On Fire",desc:"Complete 10 workouts",category:"workouts",threshold:10},{id:"workouts_25",img:c5,name:"Dedicated",desc:"Complete 25 workouts",category:"workouts",threshold:25},{id:"workouts_50",img:u5,name:"Unstoppable",desc:"Complete 50 workouts",category:"workouts",threshold:50},{id:"workouts_100",img:h5,name:"Century",desc:"Complete 100 workouts",category:"workouts",threshold:100},{id:"streak_2",img:d5,name:"2 Week Streak",desc:"Work out for 2 weeks in a row",category:"streaks",threshold:2},{id:"streak_4",img:f5,name:"Month Strong",desc:"Work out for 4 weeks in a row",category:"streaks",threshold:4},{id:"streak_8",img:m5,name:"Iron Will",desc:"Work out for 8 weeks in a row",category:"streaks",threshold:8},{id:"first_pb",img:p5,name:"First PB",desc:"Set your first personal best",category:"pbs",threshold:1},{id:"pbs_5",img:g5,name:"PB Hunter",desc:"Set 5 personal bests",category:"pbs",threshold:5},{id:"pbs_10",img:y5,name:"PB Machine",desc:"Set 10 personal bests",category:"pbs",threshold:10},{id:"pbs_100",img:b5,name:"PB Legend",desc:"Set 100 personal bests",category:"pbs",threshold:100},{id:"nutrition_7",img:v5,name:"Macro Master",desc:"Hit your macro targets 7 days in a row",category:"nutrition",threshold:7},{id:"leaderboard_join",img:x5,name:"Competitor",desc:"Join the leaderboard",category:"leaderboard",threshold:1},{id:"habits_7",img:_5,name:"Habit Streak",desc:"Complete your daily habits 7 days in a row",category:"habits",threshold:7}];function w5({steps:n,onFinish:e,active:t}){const[s,o]=_.useState(0),[c,u]=_.useState(null),[d,p]=_.useState("below"),[g,b]=_.useState(!1),x=_.useRef(null),T=_.useRef(t);T.current=t,_.useEffect(()=>{t||o(0)},[t]),_.useEffect(()=>{if(!t)return;const Ne=we=>we.preventDefault();return document.addEventListener("touchmove",Ne,{passive:!1}),document.addEventListener("wheel",Ne,{passive:!1}),document.body.style.overflow="hidden",()=>{document.removeEventListener("touchmove",Ne),document.removeEventListener("wheel",Ne),document.body.style.overflow=""}},[t]);const N=_.useMemo(()=>t?n.filter(Ne=>document.querySelector(Ne.selector)):[],[t]),B=N[s],M=s===N.length-1,P=B?.selector,Y=_.useCallback(()=>{if(!P)return;const Ne=document.querySelector(P);if(!Ne){u(null);return}const we=Ne.getBoundingClientRect(),A=8;u({top:we.top-A,left:we.left-A,width:we.width+A*2,height:we.height+A*2});const S=window.innerHeight-we.bottom;p(S<260?"above":"below")},[P]);if(_.useEffect(()=>{if(!t||!P)return;b(!0);const Ne=document.querySelector(P);if(Ne){document.body.style.overflow="",Ne.scrollIntoView({behavior:"smooth",block:"center"});let we=null,A=0,S=0;const D=60,U=()=>{S++;const L=Ne.getBoundingClientRect(),He=Math.round(L.top);if(we!==null&&He===we?A++:A=0,we=He,A>=3||S>=D){T.current&&(document.body.style.overflow="hidden"),Y(),b(!1);return}V=requestAnimationFrame(U)};let V;const q=setTimeout(()=>{V=requestAnimationFrame(U)},120);return()=>{clearTimeout(q),V&&cancelAnimationFrame(V),T.current&&(document.body.style.overflow="hidden")}}},[t,s,P,Y]),_.useEffect(()=>{if(!t)return;const Ne=()=>{x.current&&cancelAnimationFrame(x.current),x.current=requestAnimationFrame(Y)};return window.addEventListener("scroll",Ne,!0),window.addEventListener("resize",Ne),()=>{window.removeEventListener("scroll",Ne,!0),window.removeEventListener("resize",Ne),x.current&&cancelAnimationFrame(x.current)}},[t,Y]),!t||!B||N.length===0)return null;const $=()=>{M?e():o(s+1)},J=()=>{s>0&&o(s-1)},de=()=>e();return a.jsxs("div",{className:"st-overlay",onClick:Ne=>{Ne.stopPropagation()},children:[a.jsx("div",{className:"st-backdrop",onClick:$}),c&&a.jsx("div",{className:`st-spotlight${g?" st-transitioning":""}`,style:{top:c.top,left:c.left,width:c.width,height:c.height}}),c&&a.jsxs("div",{className:`st-tooltip st-tooltip-${d}${g?" st-transitioning":""}`,style:{top:d==="below"?Math.min(Math.max(c.top+c.height+16,16),window.innerHeight-200):void 0,bottom:d==="above"?Math.min(Math.max(window.innerHeight-c.top+16,16),window.innerHeight-60):void 0,left:Math.max(16,Math.min(c.left,window.innerWidth-320))},children:[a.jsx("div",{className:"st-dots",children:N.map((Ne,we)=>a.jsx("span",{className:`st-dot${we===s?" active":""}${we<s?" done":""}`},we))}),a.jsx("h3",{className:"st-title",children:B.title}),a.jsx("p",{className:"st-body",children:B.body}),a.jsxs("div",{className:"st-actions",children:[s>0&&a.jsx("button",{className:"st-btn st-btn-back",onClick:J,children:"Back"}),a.jsx("button",{className:"st-btn st-btn-next",onClick:$,children:B.cta||(M?"Let's Go!":"Next")})]}),a.jsx("button",{className:"st-skip",onClick:de,children:"Skip tour"})]})]})}const tb=[10,25,50,100,200,500,1e3],_o=5;function jh(n){return n.toISOString().split("T")[0]}function T5(n){let e=0;for(const t of tb){if(n<t)return{prev:e,next:t};e=t}return{prev:tb[tb.length-1],next:n+100}}const E5={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},k5={fullbody_4wk:["Push Focus","Pull Focus","Legs & Core"],fullbody_8wk:["Strength","Power","Endurance"],fullbody_12wk:["Upper Push","Lower Body","Upper Pull"],core_4wk:["Abs","Stability","Power Core"],core_8wk:["Anti-Extension","Rotation","Power"],core_12wk:["Strength","Endurance","Power"],upper_4wk:["Push","Pull","Mixed"],lower_4wk:["Quad Dominant","Hamstring & Glute","Power & Stability"]},nb=[{text:"You have 24 hours a day...",bold:"make it count"},{text:"Discipline beats motivation...",bold:"every single time"},{text:"Rest when you're done,",bold:"not when you're tired"},{text:"Small daily gains...",bold:"create massive results"},{text:"Your body keeps score,",bold:"train it well"},{text:"Consistency over intensity...",bold:"always wins"},{text:"The only bad workout...",bold:"is the one you skipped"}];function sb(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function Nh(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function S5(n,e=800){return new Promise(t=>{const s=new Image;s.onload=()=>{const o=document.createElement("canvas");let c=s.width,u=s.height;c>u?c>e&&(u=Math.round(u*e/c),c=e):u>e&&(c=Math.round(c*e/u),u=e),o.width=c,o.height=u,o.getContext("2d").drawImage(s,0,0,c,u),o.toBlob(d=>t(d),"image/jpeg",.8)},s.src=URL.createObjectURL(n)})}function j5(){const{currentUser:n,isClient:e,clientData:t,logout:s,updateClientData:o,loading:c}=li(),{isDark:u,toggleTheme:d}=Bi(),{isPremium:p}=Dp(),g=gr(),[b,x]=_.useState({hours:0,minutes:0,seconds:0}),[T,N]=_.useState(0),[B,M]=_.useState(0),[P,Y]=_.useState(""),[$,J]=_.useState(0),[de,Ne]=_.useState(0),[we,A]=_.useState(!1),[S,D]=_.useState({protein:0,carbs:0,fats:0,calories:0}),[U,V]=_.useState(null),[q,L]=_.useState(0),[He,xt]=_.useState(null),[H,ye]=_.useState(!1),[Ve,Ke]=_.useState(!1),[ne,O]=_.useState(0),[K,Te]=_.useState(0),[Re,Ge]=_.useState([]),[Me,ut]=_.useState([]),[gt,et]=_.useState(null),[qt,Dn]=_.useState(!1),Vt=_.useRef(null),[kt,pe]=_.useState([]),[ln,sn]=_.useState(null),[dt,St]=_.useState(null),ct=_.useRef(null),[it,Jt]=_.useState(0),[Is,Ct]=_.useState(0),[un,ds]=_.useState(0),[Kt,Pn]=_.useState(0),[hn,Rn]=_.useState(null),he=_.useCallback((I,te="info")=>{Rn({message:I,type:te}),setTimeout(()=>Rn(null),4e3)},[]),[De,Be]=_.useState([]),[tt,Fe]=_.useState(!1),[Le,ze]=_.useState(""),[Tt,bt]=_.useState(null),[It,Qt]=_.useState(null),[ee,ve]=_.useState(!1),[at,Dt]=_.useState(new Set),[jt,rn]=_.useState(new Set),[Yt,$t]=_.useState({}),[Mn,rs]=_.useState({}),[bn,Cn]=_.useState({}),[Bn,z]=_.useState({}),[xe,ke]=_.useState({}),[Se,be]=_.useState({}),rt=_.useRef(null),Rt=_.useRef(null),ot=_.useRef({}),[vt,Nt]=_.useState([]),[mn,er]=_.useState(!1),Ts=_.useRef(null),[Ds,ts]=_.useState([]),[W,fe]=_.useState(""),[k,C]=_.useState(!1),[Q,ae]=_.useState(null),[Ye,$e]=_.useState([]),[qe,Gt]=_.useState(null),[Mt,Yn]=_.useState(!1),Gs=_.useRef(!1),Bs=(()=>{const I=[{selector:".cb-ring-container",title:"Your 24-Hour Countdown",body:"Every day resets. This ring tracks the time you have left  tap your photo to personalise your profile.",cta:"Next"},{selector:".cb-stats-row",title:"Progress at a Glance",body:"Programme completion, workouts this week, and daily habits  all in one row. These fill up as you go."},{selector:".cb-nudge-card",title:"Smart Suggestions",body:"We'll highlight what needs your attention  your next session, unfinished habits, or a meal to log."},{selector:".cb-card-workouts-hero",title:"Workouts",body:"Quick randomiser sessions or structured programmes  pick your focus, level and time.",cta:"Next"}];return p&&I.push({selector:".cb-card-nutrition",title:"Nutrition Tracking",body:"Set your macro targets, scan barcodes, and log meals to hit your daily goals."},{selector:".cb-card-consistency",title:"Daily Habits",body:"5 simple habits each day  train, hit protein, 10k steps, sleep, and hydrate. Build your streak."},{selector:".cb-card-buddies",title:"Buddies & Social",body:"Connect with other members, share your journey, and keep each other accountable."},{selector:".cb-journey-section",title:"Share Your Journey",body:"Post photos, updates, and milestones  your fitness journey in one place. Like and comment on each other's posts."},{selector:".cb-achievements-section",title:"Achievements",body:"Every rep counts towards badges  volume milestones, workout streaks, and more to unlock."}),I.push({selector:".block-bottom-nav",title:"You're All Set!",body:"Use the nav bar to jump between your profile, workouts, nutrition, and buddies. Time to get after it.",cta:"Let's Go!"}),I})();_.useEffect(()=>{!c&&!n&&g("/")},[c,n,g]),_.useEffect(()=>{!c&&t&&t.signupSource==="self_signup"&&!t.onboardingComplete&&g("/onboarding")},[c,t,g]),_.useEffect(()=>{let I=t?.tourComplete||Gs.current;if(!I&&t?.id)try{I=!!localStorage.getItem(`tourDone_${t.id}`)}catch{}if(we&&t&&!I){const te=setTimeout(()=>Yn(!0),600);return()=>clearTimeout(te)}},[we,t]),_.useEffect(()=>{if(t)try{const I=sessionStorage.getItem(`cbDash_${t.id}`);if(I){const te=JSON.parse(I);M(te.programmePct??0),Y(te.programmeName??""),J(te.totalWorkouts??0),Ne(te.habitWeekPct??0),D(te.nutritionTotals??{protein:0,carbs:0,fats:0,calories:0}),V(te.nutritionTargetData??null),L(te.todayHabitsCount??0),xt(te.nextSession??null),ye(te.hasProgramme??!1),Ke(te.programmeComplete??!1),O(te.weeklyWorkouts??0),Te(te.pbCount??0),Ge(te.topPBs??[]),ut(te.leaderboardTop3??[]),pe(te.unlockedBadges??[]),ct.current=te.unlockedBadges??[],Jt(te.streakWeeks??0),A(!0)}}catch{}},[t]),_.useEffect(()=>{t?.photoURL&&et(t.photoURL)},[t]),_.useEffect(()=>{if(!t)return;const I=In(Wt(_e,"notifications"),dn("toId","==",t.id)),te=Jm(I,Ae=>{const nt=Ae.docs.map(Et=>({id:Et.id,...Et.data()}));nt.sort((Et,Lt)=>{const st=Et.createdAt?.toMillis?.()||0;return(Lt.createdAt?.toMillis?.()||0)-st}),Nt(nt.slice(0,50))},Ae=>{console.error("Notification listener error:",Ae),Ae.code==="permission-denied"&&console.warn("Firestore rules may be missing for the notifications collection. Please update your Firestore rules in the Firebase Console.")});return()=>te()},[t]),_.useEffect(()=>{const I=te=>{Ts.current&&!Ts.current.contains(te.target)&&er(!1)};return document.addEventListener("mousedown",I),()=>document.removeEventListener("mousedown",I)},[]),_.useEffect(()=>{if(!t)return;const I=t.id;(async()=>{try{const[te,Ae,nt]=await Promise.all([Sn(In(Wt(_e,"buddies"),dn("user1","==",I))),Sn(In(Wt(_e,"buddies"),dn("user2","==",I))),Sn(Wt(_e,"clients"))]),Et=new Set;[...te.docs,...Ae.docs].forEach(st=>{const Ht=st.data();Et.add(Ht.user1===I?Ht.user2:Ht.user1)});const Lt={};nt.docs.forEach(st=>{Lt[st.id]=st.data()}),ts(Array.from(Et).filter(st=>Lt[st]).map(st=>({id:st,name:Lt[st].name,photoURL:Lt[st].photoURL||null})))}catch(te){console.error("Error loading buddies for mentions:",te)}})()},[t]);const qn=vt.filter(I=>!I.read).length,$n=async()=>{const I=vt.filter(Ae=>!Ae.read);if(!I.length)return;const te=jT(_e);I.forEach(Ae=>te.update(Qe(_e,"notifications",Ae.id),{read:!0})),await te.commit()},X=async()=>{if(!vt.length)return;const I=jT(_e);vt.forEach(te=>I.delete(Qe(_e,"notifications",te.id))),await I.commit()},Ee=async(I,te,Ae={})=>{if(!(!t||I===t.id))try{await Ia(Wt(_e,"notifications"),{toId:I,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:te,read:!1,createdAt:vi(),...Ae})}catch(nt){console.error("Notification create error:",nt),nt.code==="permission-denied"&&he("Notifications blocked  check Firestore rules","error")}},se=(I,te)=>{const Ae=te==="compose"?rt.current?.selectionStart:null,Et=(Ae!=null?I.slice(0,Ae):I).match(/@(\w*)$/);if(Et){C(!0),ae(te),fe(Et[1].toLowerCase());const Lt=Ds.filter(st=>st.name&&st.name.toLowerCase().includes(Et[1].toLowerCase())).slice(0,5);$e(Lt)}else C(!1),$e([])},Ue=(I,te)=>{if(te==="compose"){const Ae=rt.current,nt=Le,Et=Ae?.selectionStart??nt.length,Lt=nt.slice(0,Et),st=nt.slice(Et),Ht=Lt.replace(/@\w*$/,`@${I.name} `);ze(Ht+st),setTimeout(()=>{Ae?.focus(),Ae.selectionStart=Ae.selectionEnd=Ht.length},0)}else{const nt=(Mn[te]||"").replace(/@\w*$/,`@${I.name} `);rs(Et=>({...Et,[te]:nt}))}C(!1),$e([])},We=I=>I&&I.split(/(@\w[\w\s]*?\s)/g).map((Ae,nt)=>Ae.startsWith("@")&&Ds.some(Et=>Ae.trim()===`@${Et.name}`)?a.jsx("span",{className:"mention-highlight",children:Ae.trim()},nt):Ae),ht=async I=>{const te=I.target.files?.[0];if(!(!te||!t)){if(!te.type.startsWith("image/")){he("Please select an image file","error");return}if(te.size>5*1024*1024){he("Image must be under 5MB","error");return}Dn(!0);try{const Ae=await new Promise(Lt=>{const st=new Image;st.onload=()=>{const Ht=document.createElement("canvas"),zt=400;let en=st.width,Bt=st.height;en>Bt?(Bt=Bt/en*zt,en=zt):(en=en/Bt*zt,Bt=zt),Ht.width=en,Ht.height=Bt,Ht.getContext("2d").drawImage(st,0,0,en,Bt),Ht.toBlob(an=>Lt(an),"image/jpeg",.75)},st.src=URL.createObjectURL(te)}),nt=Do(Po,`profilePhotos/${t.id}`);await eb(nt,Ae);const Et=await Pl(nt);await Sa(Qe(_e,"clients",t.id),{photoURL:Et}),et(Et),o({photoURL:Et}),he("Profile photo updated!","success")}catch(Ae){console.error("Photo upload error:",Ae),he("Failed to upload photo","error")}Dn(!1),Vt.current&&(Vt.current.value="")}};_.useEffect(()=>{const I=()=>{const Ae=new Date,nt=new Date(Ae);nt.setHours(23,59,59,999);const Et=nt-Ae,Lt=Math.floor(Et/(1e3*60*60)),st=Math.floor(Et%(1e3*60*60)/(1e3*60)),Ht=Math.floor(Et%(1e3*60)/1e3);x({hours:Lt,minutes:st,seconds:Ht}),N(60-Ht)};I();const te=setInterval(I,1e3);return()=>clearInterval(te)},[]),_.useEffect(()=>{const I=setInterval(()=>{Pn(te=>(te+1)%nb.length)},8e3);return()=>clearInterval(I)},[]),_.useEffect(()=>{if(!n||!t)return;(async()=>{let te=null,Ae=0,nt=[],Et=!1,Lt=null;try{const st=jh(new Date),Ht=await On(Qe(_e,"clientProgrammes",t.id));if(Ht.exists()){const vr=Ht.data(),Ss=E5[vr.templateId];if(ye(!0),Ss){const Sr=vr.completedSessions||{},Vr=Object.keys(Sr).length,ca=Ss.duration*Ss.daysPerWeek;M(ca>0?Math.round(Vr/ca*100):0);const tc=vr.templateId.replace(/_/g," ").replace(/\b\w/g,Ti=>Ti.toUpperCase());Y(tc);const nc=k5[vr.templateId];let jr=!1;for(let Ti=1;Ti<=Ss.duration&&!jr;Ti++)for(let Ei=0;Ei<Ss.daysPerWeek&&!jr;Ei++)Sr[`w${Ti}d${Ei}`]||(xt({week:Ti,dayIdx:Ei,label:nc?.[Ei]||`Day ${Ei+1}`}),jr=!0);jr||(Ke(!0),Et=!0)}}const zt=Wt(_e,"workoutLogs"),en=In(zt,dn("clientId","==",t.id));te=await Sn(en),J(te.docs.length);const Bt=new Date,an=Bt.getDay(),ks=an===0?6:an-1,Qs=new Date(Bt);Qs.setDate(Bt.getDate()-ks),Qs.setHours(0,0,0,0);const zn=Qs.getTime(),Nn=te.docs.filter(vr=>{const Ss=vr.data().completedAt;return Ss?(Ss.toDate?Ss.toDate().getTime():new Date(Ss).getTime())>=zn:!1}).length;O(Nn);const fs=Wt(_e,"habitLogs"),ls=In(fs,dn("clientId","==",t.id),dn("date","==",st)),Ys=await Sn(ls);let br=0;if(!Ys.empty){const vr=Ys.docs[0].data().habits||{};br=Object.values(vr).filter(Boolean).length}Ne(Math.round(br/_o*100)),L(br);const ur=await On(Qe(_e,"nutritionTargets",t.id));ur.exists()&&(V(ur.data()),Lt=ur.data());const kr=await On(Qe(_e,"nutritionLogs",`${t.id}_${st}`));if(kr.exists()){const Ss=(kr.data().entries||[]).reduce((Sr,Vr)=>({protein:Sr.protein+(Vr.protein||0),carbs:Sr.carbs+(Vr.carbs||0),fats:Sr.fats+(Vr.fats||0),calories:Sr.calories+(Vr.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});D(Ss)}}catch(st){console.error("Error loading dashboard stats:",st)}try{let st=[];const Ht=await On(Qe(_e,"coreBuddyPBs",t.id));if(Ht.exists()){const zt=Ht.data().exercises||{};Te(Object.keys(zt).length),Ae=Object.keys(zt).length,st=Object.entries(zt).sort(([,en],[,Bt])=>(Bt.weight||0)-(en.weight||0)).slice(0,3).map(([en,Bt])=>({name:en,weight:Bt.weight,reps:Bt.reps}))}if(st.length===0){const zt={chestPress:"Chest Press",shoulderPress:"Shoulder Press",seatedRow:"Seated Row",latPulldown:"Lat Pulldown",squat:"Squat",deadlift:"Deadlift"},en=In(Wt(_e,"personalBests"),dn("clientId","==",t.id)),Bt=await Sn(en);if(!Bt.empty){const an={};Bt.docs.forEach(Qs=>{const zn=Qs.data().benchmarks||{};Object.entries(zn).forEach(([Nn,fs])=>{if(!fs.weight||!zt[Nn])return;const ls=(fs.weight||0)*(fs.reps||1);(!an[Nn]||ls>(an[Nn].weight||0)*(an[Nn].reps||1))&&(an[Nn]={name:zt[Nn],weight:fs.weight,reps:fs.reps})})});const ks=Object.values(an);Te(ks.length),Ae=ks.length,st=ks.sort((Qs,zn)=>(zn.weight||0)-(Qs.weight||0)).slice(0,3)}}nt=st,Ge(st)}catch(st){console.error("PB fetch error:",st)}try{const st=Wt(_e,"clients"),Ht=In(st,dn("leaderboardOptIn","==",!0)),en=(await Sn(Ht)).docs.map(Bt=>({id:Bt.id,name:Bt.data().name,photoURL:Bt.data().photoURL||null}));ut(en.slice(0,3))}catch(st){console.error("Leaderboard preview error:",st)}try{let st=0;if(te){const zn=te.docs.map(Nn=>Nn.data().date).filter(Boolean).sort().reverse();if(zn.length>0){const Nn=new Date;let fs=new Date(Nn);e:for(let ls=0;ls<52;ls++){const Ys=new Date(fs),br=Ys.getDay(),ur=br===0?6:br-1;Ys.setDate(Ys.getDate()-ur),Ys.setHours(0,0,0,0);const kr=new Date(Ys);kr.setDate(kr.getDate()+7);const vr=jh(Ys),Ss=jh(kr);if(zn.some(Vr=>Vr>=vr&&Vr<Ss))st++;else{if(ls>0)break e;break}fs.setDate(fs.getDate()-7)}}}Jt(st);let Ht=0;for(let zn=0;zn<30;zn++){const Nn=new Date;Nn.setDate(Nn.getDate()-zn);const fs=jh(Nn);try{const ls=await Sn(In(Wt(_e,"habitLogs"),dn("clientId","==",t.id),dn("date","==",fs)));if(ls.empty)break;{const Ys=ls.docs[0].data().habits||{};if(Object.values(Ys).filter(Boolean).length>=_o)Ht++;else break}}catch{break}}Ct(Ht);let zt=0;for(let zn=0;zn<30;zn++){const Nn=new Date;Nn.setDate(Nn.getDate()-zn);const fs=jh(Nn);try{const ls=await On(Qe(_e,"nutritionLogs",`${t.id}_${fs}`));if(ls.exists()&&(ls.data().entries||[]).length>0)if(Lt){const br=(ls.data().entries||[]).reduce((ur,kr)=>({protein:ur.protein+(kr.protein||0),carbs:ur.carbs+(kr.carbs||0),fats:ur.fats+(kr.fats||0)}),{protein:0,carbs:0,fats:0});if(br.protein>=(Lt.protein||0)&&br.carbs>=(Lt.carbs||0)&&br.fats>=(Lt.fats||0))zt++;else break}else zt++;else break}catch{break}}ds(zt);const en=te?te.docs.length:0,Bt=[],an=zn=>Bt.push(zn);en>=1&&an("first_workout"),en>=10&&an("workouts_10"),en>=25&&an("workouts_25"),en>=50&&an("workouts_50"),en>=100&&an("workouts_100"),st>=2&&an("streak_2"),st>=4&&an("streak_4"),st>=8&&an("streak_8"),Ae>=1&&an("first_pb"),Ae>=5&&an("pbs_5"),Ae>=10&&an("pbs_10"),Ae>=100&&an("pbs_100"),zt>=7&&an("nutrition_7"),t.leaderboardOptIn&&an("leaderboard_join"),Ht>=7&&an("habits_7"),pe(Bt);const ks=ct.current;if(ks!==null){const zn=Bt.filter(Nn=>!ks.includes(Nn));if(zn.length>0){const Nn=Kh.find(fs=>fs.id===zn[zn.length-1]);Nn&&setTimeout(()=>St(Nn),600)}}ct.current=Bt;const Qs={};Bt.forEach(zn=>{Qs[zn]={unlockedAt:new Date().toISOString()}}),Gn(Qe(_e,"achievements",t.id),{badges:Qs,progress:{streakWeeks:st,pbCount:Ae,nutritionStreak:zt,habitStreak:Ht},updatedAt:new Date().toISOString()},{merge:!0}).catch(()=>{})}catch(st){console.error("Achievement computation error:",st)}A(!0)})()},[n,t]),_.useEffect(()=>{if(!(!we||!t))try{sessionStorage.setItem(`cbDash_${t.id}`,JSON.stringify({programmePct:B,programmeName:P,totalWorkouts:$,habitWeekPct:de,nutritionTotals:S,nutritionTargetData:U,todayHabitsCount:q,nextSession:He,hasProgramme:H,programmeComplete:Ve,weeklyWorkouts:ne,pbCount:K,topPBs:Re,leaderboardTop3:Me,unlockedBadges:kt,streakWeeks:it}))}catch{}},[we,B,P,$,de,S,U,q,He,H,Ve,ne,K,Re,Me,kt,it,t]);const _t=_.useCallback(async()=>{if(Gs.current=!0,Yn(!1),o({tourComplete:!0}),t?.id){try{localStorage.setItem(`tourDone_${t.id}`,"1")}catch{}try{await Sa(Qe(_e,"clients",t.id),{tourComplete:!0})}catch(I){console.error("Failed to save tour completion:",I)}}},[t,o]),Ot=I=>{const te=I.currentTarget,Ae=te.querySelector(".ripple");Ae&&Ae.remove();const nt=te.getBoundingClientRect(),Et=Math.max(nt.width,nt.height),Lt=I.clientX-nt.left-Et/2,st=I.clientY-nt.top-Et/2,Ht=document.createElement("span");Ht.className="ripple",Ht.style.cssText=`width:${Et}px;height:${Et}px;left:${Lt}px;top:${st}px;`,te.appendChild(Ht),setTimeout(()=>Ht.remove(),600)},En=t?.name?.split(" ")[0]||"there",{prev:xs,next:vn}=T5($),lr=vn>xs?Math.round(($-xs)/(vn-xs)*100):100,ci=[{label:"Programme",value:`${B}%`,pct:B,color:"#14b8a6",size:"normal"},{label:"Workouts",value:`${$}`,pct:lr,color:"var(--color-primary)",size:"large"},{label:"Habits Today",value:`${de}%`,pct:de,color:"#38B6FF",size:"normal"}],Es=I=>!U||!U[I]?0:Math.min(Math.round(S[I]/U[I]*100),100),Ui=(()=>{const I=new Date().getHours();return we&&q>=_o&&S.calories>0?{main:"Smashed it today,",sub:"Rest up and go again tomorrow."}:I>=5&&I<12?{main:"Rise and grind,",sub:"let's get after it!"}:I>=12&&I<17?{main:"Oye",sub:"crack on and make it count!"}:I>=17&&I<21?{main:"Evening session?",sub:"Let's finish strong!"}:{main:"Burning the midnight oil,",sub:"Respect the hustle!"}})(),tr=we?H&&He&&!Ve?{label:"NEXT SESSION",message:`Week ${He.week}, Day ${He.dayIdx+1}  ${He.label}`,cta:"Continue",action:()=>g("/client/core-buddy/programmes"),pct:B,ringLabel:`${B}%`}:q<_o?{label:"DAILY HABITS",message:`${q}/${_o} completed`,cta:"Open Habits",action:()=>g("/client/core-buddy/consistency"),pct:de,ringLabel:`${q}/${_o}`}:S.calories===0?{label:"NUTRITION",message:"No meals logged today",cta:"Log Meal",action:()=>g("/client/core-buddy/nutrition"),pct:0,ringLabel:"0"}:H?Ve?{label:"COMPLETE",message:"Programme finished!",cta:"New Programme",action:()=>g("/client/core-buddy/workouts"),pct:100,ringLabel:"100%"}:{label:"TODAY",message:"You're crushing it!",cta:null,action:null,pct:100,ringLabel:""}:{label:"PROGRAMMES",message:"Start a programme to level up",cta:"Browse",action:()=>g("/client/core-buddy/workouts"),pct:0,ringLabel:""}:null,cn=_.useCallback(async()=>{if(t){Fe(!0);try{const I=await Sn(In(Wt(_e,"posts"),dn("authorId","==",t.id),Ym("createdAt","desc"),Xm(30)));Be(I.docs.map(Ae=>({id:Ae.id,...Ae.data()})));const te=await Sn(In(Wt(_e,"postLikes"),dn("userId","==",t.id)));Dt(new Set(te.docs.map(Ae=>Ae.data().postId)))}catch(I){console.error("Error loading journey:",I)}finally{Fe(!1)}}},[t]);_.useEffect(()=>{we&&t&&cn()},[we,t,cn]);const _s=I=>{const te=I.target.files?.[0];if(te){if(!te.type.startsWith("image/")){he("Please select an image file","error");return}if(te.size>10*1024*1024){he("Image must be under 10MB","error");return}bt(te),Qt(URL.createObjectURL(te))}},yr=()=>{bt(null),It&&URL.revokeObjectURL(It),Qt(null),Rt.current&&(Rt.current.value="")},cr=async()=>{if(!(!Le.trim()&&!Tt||ee||!t)){ve(!0);try{let I=null;if(Tt){const nt=await S5(Tt),Et=`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,Lt=Do(Po,`postImages/${t.id}/${Et}`);await eb(Lt,nt),I=await Pl(Lt)}await Ia(Wt(_e,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Le.trim(),type:I?"image":"text",imageURL:I||null,createdAt:vi(),likeCount:0,commentCount:0});const Ae=Le.trim().match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Ae){const nt=new Set;Ae.forEach(Et=>{const Lt=Et.slice(1).trim(),st=Ds.find(Ht=>Ht.name&&Ht.name.toLowerCase()===Lt.toLowerCase());st&&!nt.has(st.id)&&(nt.add(st.id),Ee(st.id,"mention",{}))})}ze(""),yr(),rt.current&&(rt.current.style.height="auto"),await cn(),he("Posted!","success")}catch(I){console.error("Error posting:",I),he(I?.message||"Failed to post","error")}finally{ve(!1)}}},Pr=async I=>{if(window.confirm("Delete this post?"))try{await Cr(Qe(_e,"posts",I)),Be(te=>te.filter(Ae=>Ae.id!==I)),he("Post deleted","info")}catch(te){console.error("Delete error:",te),he("Failed to delete","error")}},os=async I=>{if(!t)return;const te=t.id,Ae=`${I}_${te}`,nt=at.has(I),Et=new Set(at);nt?Et.delete(I):Et.add(I),Dt(Et),Be(Lt=>Lt.map(st=>st.id===I?{...st,likeCount:Math.max(0,(st.likeCount||0)+(nt?-1:1))}:st));try{if(nt)await Cr(Qe(_e,"postLikes",Ae)),await Sa(Qe(_e,"posts",I),{likeCount:Al(-1)});else{await Gn(Qe(_e,"postLikes",Ae),{postId:I,userId:te,createdAt:vi()}),await Sa(Qe(_e,"posts",I),{likeCount:Al(1)});const Lt=De.find(st=>st.id===I);Lt&&Ee(Lt.authorId,"like",{postId:I})}}catch(Lt){console.error("Like error:",Lt),cn()}},Ks=async I=>{try{const te=await Sn(In(Wt(_e,"postComments"),dn("postId","==",I),Ym("createdAt","asc"),Xm(50)));$t(Ae=>({...Ae,[I]:te.docs.map(nt=>({id:nt.id,...nt.data()}))}))}catch(te){console.error("Error loading comments:",te)}},Us=I=>{const te=new Set(jt);te.has(I)?te.delete(I):(te.add(I),Yt[I]||Ks(I)),rn(te)},Mr=async I=>{const te=(Mn[I]||"").trim(),Ae=xe[I];if(!(!te&&!Ae||!t)){Cn(nt=>({...nt,[I]:!0}));try{let nt=null;if(Ae){const zt=Do(Po,`comment-images/${Date.now()}_${Ae.name}`);await eb(zt,Ae),nt=await Pl(zt)}const Et={postId:I,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:te||"",createdAt:vi()};nt&&(Et.imageURL=nt);const Lt=Bn[I];Lt&&(Et.replyToId=Lt.id,Et.replyToName=Lt.authorName),await Ia(Wt(_e,"postComments"),Et),await Sa(Qe(_e,"posts",I),{commentCount:Al(1)});const st=De.find(zt=>zt.id===I);st&&Ee(st.authorId,"comment",{postId:I});const Ht=te.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Ht){const zt=new Set;Ht.forEach(en=>{const Bt=en.slice(1).trim(),an=Ds.find(ks=>ks.name&&ks.name.toLowerCase()===Bt.toLowerCase());an&&!zt.has(an.id)&&(zt.add(an.id),Ee(an.id,"mention",{postId:I}))})}rs(zt=>({...zt,[I]:""})),ke(zt=>({...zt,[I]:null})),be(zt=>({...zt,[I]:null})),z(zt=>({...zt,[I]:null})),ot.current[I]&&(ot.current[I].value=""),Be(zt=>zt.map(en=>en.id===I?{...en,commentCount:(en.commentCount||0)+1}:en)),await Ks(I)}catch(nt){console.error("Comment error:",nt),he("Failed to comment","error")}finally{Cn(nt=>({...nt,[I]:!1}))}}},Lr=async(I,te)=>{try{await Cr(Qe(_e,"postComments",te)),await Sa(Qe(_e,"posts",I),{commentCount:Al(-1)}),$t(Ae=>({...Ae,[I]:(Ae[I]||[]).filter(nt=>nt.id!==te)})),Be(Ae=>Ae.map(nt=>nt.id===I?{...nt,commentCount:Math.max((nt.commentCount||1)-1,0)}:nt))}catch(Ae){console.error("Delete comment error:",Ae),he("Failed to delete comment","error")}},Wr=(I,te)=>{const Ae=te.target.files?.[0];if(!Ae)return;if(Ae.size>5*1024*1024){he("Image must be under 5MB","error");return}ke(Et=>({...Et,[I]:Ae}));const nt=new FileReader;nt.onload=Et=>be(Lt=>({...Lt,[I]:Et.target.result})),nt.readAsDataURL(Ae)},Wa=I=>{ke(te=>({...te,[I]:null})),be(te=>({...te,[I]:null})),ot.current[I]&&(ot.current[I].value="")},Fi=I=>{ze(I.target.value),I.target.style.height="auto",I.target.style.height=Math.min(I.target.scrollHeight,120)+"px",se(I.target.value,"compose")},Gr=(I,te)=>{rs(Ae=>({...Ae,[I]:te})),se(te,I)};return a.jsxs("div",{className:"cb-dashboard","data-theme":u?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsxs("div",{className:"header-notif-wrap",ref:Ts,children:[a.jsxs("button",{className:"header-notif-btn",onClick:()=>{er(!mn),mn||$n()},"aria-label":"Notifications",children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),a.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),qn>0&&a.jsx("span",{className:"header-notif-badge",children:qn>9?"9+":qn})]}),mn&&a.jsxs("div",{className:"notif-panel",children:[a.jsxs("div",{className:"notif-panel-header",children:[a.jsx("span",{className:"notif-panel-title",children:"Notifications"}),vt.length>0&&a.jsx("button",{className:"notif-clear-btn",onClick:X,children:"Clear all"})]}),a.jsx("div",{className:"notif-panel-list",children:vt.length===0?a.jsx("div",{className:"notif-empty",children:"No notifications yet"}):vt.map(I=>a.jsxs("div",{className:`notif-item${I.read?"":" unread"}`,onClick:()=>{if(er(!1),I.type==="buddy_request"||I.type==="buddy_accept")g("/client/core-buddy/buddies");else if((I.type==="like"||I.type==="comment")&&I.postId){if(!jt.has(I.postId)){const te=new Set(jt);te.add(I.postId),rn(te),Yt[I.postId]||Ks(I.postId)}setTimeout(()=>{const te=document.getElementById(`post-${I.postId}`);te&&te.scrollIntoView({behavior:"smooth",block:"center"})},150)}else I.type==="like"||I.type==="comment"?document.querySelector(".cb-journey-section")?.scrollIntoView({behavior:"smooth"}):I.type==="mention"&&g(`/client/core-buddy/profile/${I.fromId}`)},children:[a.jsx("div",{className:"notif-item-avatar",children:I.fromPhotoURL?a.jsx("img",{src:I.fromPhotoURL,alt:""}):a.jsx("span",{children:(I.fromName||"?")[0]})}),a.jsxs("div",{className:"notif-item-body",children:[a.jsxs("p",{className:"notif-item-text",children:[a.jsx("strong",{children:I.fromName})," ",I.type==="buddy_request"&&"sent you a buddy request",I.type==="buddy_accept"&&"accepted your buddy request",I.type==="like"&&"liked your post",I.type==="comment"&&"commented on your post",I.type==="mention"&&"mentioned you"]}),a.jsx("span",{className:"notif-item-time",children:sb(I.createdAt)})]})]},I.id))})]})]}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),a.jsx("button",{onClick:s,"aria-label":"Log out",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),a.jsxs("main",{className:"cb-main",children:[a.jsxs("div",{className:"cb-ring-container",children:[a.jsxs("div",{className:"cb-ring",children:[a.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:q0.map((I,te)=>{const Ae=te<T;return a.jsx("line",{x1:I.x1,y1:I.y1,x2:I.x2,y2:I.y2,className:`ring-tick ${Ae?"elapsed":"remaining"}`,strokeWidth:I.thick?"3":"2"},te)})}),a.jsxs("div",{className:"cb-ring-center",children:[a.jsxs("div",{className:"cb-ring-logo",onClick:()=>Vt.current?.click(),role:"button",tabIndex:0,"aria-label":"Change profile photo",children:[a.jsx("img",{src:gt||"/Logo.webp",alt:gt?"Profile":"Mind Core Fitness"}),a.jsx("div",{className:`cb-photo-overlay${qt?" uploading":""}`,children:qt?a.jsx("div",{className:"cb-photo-spinner"}):a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),a.jsx("input",{ref:Vt,type:"file",accept:"image/*",onChange:ht,style:{display:"none"}})]}),!gt&&!qt&&a.jsx("div",{className:"cb-photo-badge",onClick:()=>Vt.current?.click(),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),a.jsxs("div",{className:"cb-ring-countdown",children:[a.jsx("span",{className:"cb-timer-digit",children:String(b.hours).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit",children:String(b.minutes).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(b.seconds).padStart(2,"0")})]}),a.jsx("span",{className:"cb-ring-label",children:"remaining today"}),a.jsxs("p",{className:"cb-ring-tagline",children:[nb[Kt].text," ",a.jsx("strong",{children:nb[Kt].bold})]},Kt)]}),a.jsx("div",{className:"cb-stats-row",children:ci.map(I=>{const te=(I.size==="large",38),Ae=2*Math.PI*te,nt=Ae-I.pct/100*Ae;return a.jsxs("div",{className:`cb-stat-item${I.size==="large"?" cb-stat-large":""}`,children:[a.jsxs("div",{className:"cb-stat-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-stat-track",cx:"50",cy:"50",r:te}),a.jsx("circle",{className:"cb-stat-fill",cx:"50",cy:"50",r:te,style:{stroke:I.color},strokeDasharray:Ae,strokeDashoffset:nt})]}),a.jsx("span",{className:"cb-stat-value",style:{color:I.color},children:I.value})]}),a.jsx("span",{className:"cb-stat-label",children:I.label})]},I.label)})}),a.jsxs("p",{className:"cb-coach-msg",children:[Ui.main," ",a.jsx("strong",{children:En}),"  ",Ui.sub]}),tr&&a.jsxs("button",{className:"cb-nudge-card",onClick:tr.action||void 0,style:tr.action?void 0:{cursor:"default"},children:[a.jsxs("div",{className:"cb-nudge-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-nudge-ring-track",cx:"50",cy:"50",r:"38"}),a.jsx("circle",{className:"cb-nudge-ring-fill",cx:"50",cy:"50",r:"38",strokeDasharray:2*Math.PI*38,strokeDashoffset:2*Math.PI*38-tr.pct/100*2*Math.PI*38})]}),a.jsx("span",{className:"cb-nudge-ring-val",children:tr.ringLabel})]}),a.jsxs("div",{className:"cb-nudge-info",children:[a.jsx("span",{className:"cb-nudge-label",children:tr.label}),a.jsx("span",{className:"cb-nudge-title",children:tr.message}),tr.cta&&a.jsxs("span",{className:"cb-nudge-cta",children:[tr.cta," "]})]})]}),a.jsxs("div",{className:"cb-features",children:[a.jsxs("button",{className:`cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn${p?"":" cb-card-locked"}`,onClick:I=>{Ot(I),g(p?"/client/core-buddy/nutrition":"/upgrade")},children:[a.jsxs("div",{className:"cb-card-top-row",children:[a.jsx("div",{className:"cb-card-content",children:a.jsxs("h3",{children:["Today's Nutrition ",!p&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]})}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsx("div",{className:"cb-card-preview-row",children:a.jsx("div",{className:"cb-mini-rings",children:[{label:"P",pct:Es("protein"),color:"#14b8a6"},{label:"C",pct:Es("carbs"),color:"var(--color-primary)"},{label:"F",pct:Es("fats"),color:"#eab308"},{label:"Cal",pct:Es("calories"),color:"#38B6FF"}].map(I=>{const Ae=2*Math.PI*38,nt=Ae-I.pct/100*Ae;return a.jsxs("div",{className:"cb-mini-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-mini-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"cb-mini-fill",cx:"50",cy:"50",r:38,style:{stroke:I.color},strokeDasharray:Ae,strokeDashoffset:nt})]}),a.jsx("span",{style:{color:I.color},children:I.label})]},I.label)})})}),a.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),a.jsxs("button",{className:"cb-feature-card cb-card-workouts-hero ripple-btn",onClick:I=>{Ot(I),g("/client/core-buddy/workouts")},children:[a.jsx("h3",{className:"cb-hero-title",children:"Workouts"}),a.jsxs("div",{className:"cb-hero-stats",children:[a.jsxs("span",{children:[ne," this week"]}),a.jsx("span",{className:"cb-hero-dot",children:""}),a.jsxs("span",{children:[$," total"]})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"cb-grid-row",children:[a.jsxs("button",{className:`cb-feature-card cb-grid-card cb-card-consistency ripple-btn${p?"":" cb-card-locked"}`,onClick:I=>{Ot(I),g(p?"/client/core-buddy/consistency":"/upgrade")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsxs("h3",{children:["Habits ",!p&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),a.jsx("div",{className:"cb-habit-dots",children:Array.from({length:_o},(I,te)=>a.jsx("span",{className:`cb-habit-dot${te<q?" done":""}`},te))}),a.jsxs("span",{className:"cb-habit-dots-label",children:[q,"/",_o," today"]})]}),a.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:`cb-feature-card cb-grid-card cb-card-progress ripple-btn${p?"":" cb-card-locked"}`,onClick:I=>{Ot(I),g(p?"/client/personal-bests?mode=corebuddy":"/upgrade")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsxs("h3",{children:["PBs ",!p&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),Re.length>0?a.jsx("div",{className:"cb-pb-preview",children:Re.slice(0,2).map(I=>a.jsxs("div",{className:"cb-pb-entry",children:[a.jsx("span",{className:"cb-pb-name",children:I.name}),a.jsxs("span",{className:"cb-pb-value",children:[I.weight,"kg"]})]},I.name))}):a.jsxs("div",{className:"cb-progress-preview",children:[a.jsx("svg",{className:"cb-progress-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),a.jsx("span",{children:"Start lifting!"})]})]}),a.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),a.jsxs("button",{className:`cb-feature-card cb-card-leaderboard ripple-btn${p?"":" cb-card-locked"}`,onClick:I=>{Ot(I),g(p?"/client/leaderboard":"/upgrade")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsxs("h3",{children:["Leaderboard ",!p&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),Me.length>0?a.jsx("div",{className:"cb-lb-preview",children:Me.map((I,te)=>{const Ae=["#FFD700","#A8B4C0","#CD7F32"][te],nt=I.name?I.name.split(" ").map(Lt=>Lt[0]).join("").slice(0,2).toUpperCase():"?",Et=I.id===t?.id;return a.jsxs("div",{className:`cb-lb-entry${Et?" cb-lb-me":""}`,children:[a.jsx("div",{className:"cb-lb-avatar",style:{borderColor:Ae},children:I.photoURL?a.jsx("img",{src:I.photoURL,alt:"",className:"cb-lb-avatar-img"}):a.jsx("span",{children:nt})}),a.jsxs("span",{className:"cb-lb-rank",style:{color:Ae},children:["#",te+1]})]},I.id)})}):a.jsx("p",{children:"Opt in to compete with your Core Buddies"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:`cb-feature-card cb-card-buddies ripple-btn${p?"":" cb-card-locked"}`,onClick:I=>{Ot(I),g(p?"/client/core-buddy/buddies":"/upgrade")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsxs("h3",{children:["Buddies ",!p&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),a.jsx("p",{children:"Connect with other members and track each other's progress"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:`cb-achievements-section${p?"":" cb-card-locked"}`,children:[a.jsxs("h3",{className:"cb-achievements-title",children:["Achievements ",!p&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),p?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"cb-badges-scroll",children:Kh.map(I=>{const te=kt.includes(I.id);return a.jsx("button",{className:`cb-badge${te?" unlocked":" locked"}`,onClick:()=>sn(I),children:a.jsx("img",{src:I.img,alt:I.name,className:"cb-badge-img"})},I.id)})}),a.jsxs("p",{className:"cb-badges-count",children:[kt.length,"/",Kh.length," unlocked"]})]}):a.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>g("/upgrade"),children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{children:"Upgrade to unlock achievements"})]})]}),a.jsxs("div",{className:"cb-journey-section",children:[a.jsxs("h3",{className:"cb-journey-title",children:["My Journey ",!p&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),p?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"journey-compose",children:[a.jsx("div",{className:"journey-compose-avatar",children:gt?a.jsx("img",{src:gt,alt:""}):a.jsx("span",{children:Nh(t?.name)})}),a.jsxs("div",{className:"journey-compose-body",style:{position:"relative"},children:[a.jsx("textarea",{ref:rt,placeholder:"Share your progress... (use @ to mention)",value:Le,onChange:Fi,rows:1,maxLength:500}),k&&Q==="compose"&&Ye.length>0&&a.jsx("div",{className:"mention-dropdown",children:Ye.map(I=>a.jsxs("button",{className:"mention-option",onClick:()=>Ue(I,"compose"),children:[a.jsx("div",{className:"mention-option-avatar",children:I.photoURL?a.jsx("img",{src:I.photoURL,alt:""}):a.jsx("span",{children:Nh(I.name)})}),a.jsx("span",{children:I.name})]},I.id))}),It&&a.jsxs("div",{className:"journey-image-preview",children:[a.jsx("img",{src:It,alt:"Preview"}),a.jsx("button",{className:"journey-image-remove",onClick:yr,"aria-label":"Remove image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-compose-actions",children:[a.jsx("button",{className:"journey-image-btn",onClick:()=>Rt.current?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:Rt,type:"file",accept:"image/*",onChange:_s,hidden:!0}),(Le.trim()||Tt)&&a.jsx("button",{className:"journey-post-btn",onClick:cr,disabled:ee,children:ee?a.jsx("div",{className:"journey-btn-spinner"}):"Post"})]})]})]}),tt?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"cb-spinner"})}):De.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"Start sharing your fitness journey!"})]}):a.jsx("div",{className:"journey-list",children:De.map(I=>a.jsxs("div",{id:`post-${I.id}`,className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:I.authorPhotoURL?a.jsx("img",{src:I.authorPhotoURL,alt:""}):a.jsx("span",{children:Nh(I.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:I.authorName}),a.jsx("span",{className:"journey-post-time",children:sb(I.createdAt)})]}),a.jsx("button",{className:"journey-delete-btn",onClick:()=>Pr(I.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),I.content&&a.jsx("p",{className:"journey-post-content",children:We(I.content)}),I.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:I.imageURL,alt:"Post",loading:"lazy"})}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${at.has(I.id)?" liked":""}`,onClick:()=>os(I.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:at.has(I.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:I.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${jt.has(I.id)?" active":""}`,onClick:()=>Us(I.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:I.commentCount||0})]})]}),jt.has(I.id)&&a.jsxs("div",{className:"journey-comments",children:[Yt[I.id]?.length>0?Yt[I.id].map(te=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",children:te.authorPhotoURL?a.jsx("img",{src:te.authorPhotoURL,alt:""}):a.jsx("span",{children:Nh(te.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:te.authorName}),te.replyToName&&a.jsxs("span",{className:"journey-comment-reply-tag",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"9 14 4 9 9 4"}),a.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),te.replyToName]}),te.content&&a.jsx("span",{className:"journey-comment-text",children:We(te.content)}),te.imageURL&&a.jsx("img",{className:"journey-comment-image",src:te.imageURL,alt:"Comment",loading:"lazy"})]}),a.jsxs("div",{className:"journey-comment-actions-row",children:[a.jsx("span",{className:"journey-comment-time",children:sb(te.createdAt)}),a.jsx("button",{className:"journey-comment-reply-btn",onClick:()=>z(Ae=>({...Ae,[I.id]:{id:te.id,authorName:te.authorName}})),children:"Reply"}),a.jsx("button",{className:"journey-comment-delete-btn",onClick:()=>Lr(I.id,te.id),"aria-label":"Delete comment",children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},te.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),Bn[I.id]&&a.jsxs("div",{className:"journey-comment-replying",children:[a.jsxs("span",{children:["Replying to ",a.jsx("strong",{children:Bn[I.id].authorName})]}),a.jsx("button",{onClick:()=>z(te=>({...te,[I.id]:null})),"aria-label":"Cancel reply",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),Se[I.id]&&a.jsxs("div",{className:"journey-comment-img-preview",children:[a.jsx("img",{src:Se[I.id],alt:"Preview"}),a.jsx("button",{onClick:()=>Wa(I.id),"aria-label":"Remove image",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("button",{className:"journey-comment-img-btn",onClick:()=>ot.current[I.id]?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:te=>{ot.current[I.id]=te},type:"file",accept:"image/*",onChange:te=>Wr(I.id,te),hidden:!0}),a.jsx("input",{type:"text",placeholder:"Comment",value:Mn[I.id]||"",onChange:te=>Gr(I.id,te.target.value),onKeyDown:te=>{te.key==="Enter"&&Mr(I.id)},maxLength:300}),k&&Q===I.id&&Ye.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:Ye.map(te=>a.jsxs("button",{className:"mention-option",onClick:()=>Ue(te,I.id),children:[a.jsx("div",{className:"mention-option-avatar",children:te.photoURL?a.jsx("img",{src:te.photoURL,alt:""}):a.jsx("span",{children:Nh(te.name)})}),a.jsx("span",{children:te.name})]},te.id))}),a.jsx("button",{onClick:()=>Mr(I.id),disabled:!(Mn[I.id]||"").trim()&&!xe[I.id]||bn[I.id],children:bn[I.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},I.id))})]}):a.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>g("/upgrade"),children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{children:"Upgrade to share your journey"})]})]})]})]}),ln&&a.jsx("div",{className:"cb-badge-overlay",onClick:()=>sn(null),children:a.jsxs("div",{className:"cb-badge-overlay-content",onClick:I=>I.stopPropagation(),children:[a.jsx("img",{src:ln.img,alt:ln.name,className:`cb-badge-overlay-img${kt.includes(ln.id)?"":" cb-badge-overlay-img-locked"}`}),kt.includes(ln.id)?a.jsx("span",{className:"cb-badge-status unlocked",children:"Unlocked"}):a.jsx("span",{className:"cb-badge-status locked",children:"Locked"}),a.jsx("button",{className:"cb-badge-overlay-close",onClick:()=>sn(null),children:"Tap to close"})]})}),a.jsx(oa,{active:"home"}),hn&&a.jsxs("div",{className:`toast-notification ${hn.type}`,children:[hn.type==="info"&&a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),hn.message]}),a.jsx(w5,{steps:Bs,active:Mt,onFinish:_t}),dt&&a.jsxs("div",{className:"cb-celebration-overlay",onClick:()=>St(null),children:[a.jsx("div",{className:"cb-confetti-container",children:Array.from({length:30},(I,te)=>a.jsx("span",{className:"cb-confetti-piece",style:{"--angle":`${Math.random()*360}deg`,"--distance":`${80+Math.random()*120}px`,"--delay":`${Math.random()*.3}s`,"--color":["#FFD700","#FF6B6B","#4ECDC4","#45B7D1","#F7DC6F","#BB8FCE","#FF8C42","#38B6FF"][te%8],"--size":`${6+Math.random()*6}px`,"--drift":`${(Math.random()-.5)*60}px`}},te))}),a.jsxs("div",{className:"cb-celebration-content",onClick:I=>I.stopPropagation(),children:[a.jsx("div",{className:"cb-celebration-glow"}),a.jsx("img",{src:dt.img,alt:dt.name,className:"cb-celebration-badge-img"}),a.jsx("h2",{className:"cb-celebration-title",children:"Badge Unlocked!"}),a.jsx("p",{className:"cb-celebration-name",children:dt.name}),a.jsx("button",{className:"cb-celebration-dismiss",onClick:()=>St(null),children:"Tap to continue"})]})]})]})}const rb=new Map;function wo(){return new Date().toISOString().split("T")[0]}const VT=[{key:"breakfast",label:"Breakfast"},{key:"lunch",label:"Lunch"},{key:"dinner",label:"Dinner"},{key:"snacks",label:"Snacks"}],N5={breakfast:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),a.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),a.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),a.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),a.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),lunch:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),dinner:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),snacks:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})};function A5(){const n=new Date().getHours();return n<11?"breakfast":n<14?"lunch":n<17?"snacks":"dinner"}function R5(){const{currentUser:n,isClient:e,clientData:t,loading:s}=li(),{isDark:o,toggleTheme:c,accent:u}=Bi(),d=gr(),[p,g]=_.useState("loading"),[b,x]=_.useState(null),[T,N]=_.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",dailyActivity:"sedentary",trainingFrequency:"moderate",goal:"maintain",deficitLevel:"moderate"}),[B,M]=_.useState(null),[P,Y]=_.useState(wo()),[$,J]=_.useState({entries:[],water:0}),[de,Ne]=_.useState({protein:0,carbs:0,fats:0,calories:0}),[we,A]=_.useState(!1),[S,D]=_.useState(!1),[U,V]=_.useState(()=>{const k=new Date;return{year:k.getFullYear(),month:k.getMonth()}}),[q,L]=_.useState(A5),[He,xt]=_.useState(null),[H,ye]=_.useState(null),[Ve,Ke]=_.useState(!1),[ne,O]=_.useState(null),[K,Te]=_.useState(""),[Re,Ge]=_.useState(!1),[Me,ut]=_.useState(""),[gt,et]=_.useState([]),[qt,Dn]=_.useState(!1),[Vt,kt]=_.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[pe,ln]=_.useState(null),[sn,dt]=_.useState("100"),[St,ct]=_.useState(0),[it,Jt]=_.useState("weight"),[Is,Ct]=_.useState(0),[un,ds]=_.useState(null);_.useRef(null);const Kt=_.useRef(!1),Pn=_.useRef(null),hn=_.useRef(null),Rn=_.useRef(null),he=_.useCallback((k,C="info")=>{ds({message:k,type:C}),setTimeout(()=>ds(null),3e3)},[]);_.useEffect(()=>{!s&&(!n||!e)&&d("/")},[n,e,s,d]),_.useEffect(()=>{if(!t?.id)return;(async()=>{try{const C=await On(Qe(_e,"nutritionTargets",t.id));C.exists()?(x(C.data()),g("dashboard")):g("setup")}catch(C){console.error("Error loading nutrition data:",C),g("setup")}})()},[t?.id]),_.useEffect(()=>{if(!t?.id)return;(async()=>{try{const C=await On(Qe(_e,"nutritionLogs",`${t.id}_${P}`));if(C.exists()){const Q=C.data();J({entries:Q.entries||[],water:Q.water||0})}else J({entries:[],water:0})}catch(C){console.error("Error loading log:",C),J({entries:[],water:0})}})()},[t?.id,P]),_.useEffect(()=>{const k=$.entries.reduce((C,Q)=>({protein:C.protein+(Q.protein||0),carbs:C.carbs+(Q.carbs||0),fats:C.fats+(Q.fats||0),calories:C.calories+(Q.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});Ne(k)},[$.entries]);const De=async k=>{try{await Gn(Qe(_e,"nutritionLogs",`${t.id}_${P}`),{clientId:t.id,date:P,entries:k.entries,water:k.water,updatedAt:mt.now()})}catch(C){console.error("Error saving nutrition log:",C)}},Be=P===wo(),tt=(k,C)=>new Date(k,C+1,0).getDate(),Fe=(k,C)=>new Date(k,C,1).getDay(),Le=["January","February","March","April","May","June","July","August","September","October","November","December"],ze=["Su","Mo","Tu","We","Th","Fr","Sa"],Tt=()=>{let k=parseFloat(T.weight);T.weightUnit==="lbs"&&(k*=.453592);let C;T.heightUnit==="cm"?C=parseFloat(T.height):C=(parseFloat(T.heightFeet)||0)*30.48+(parseFloat(T.heightInches)||0)*2.54;const Q=parseInt(T.age);let ae=T.gender==="male"?10*k+6.25*C-5*Q+5:10*k+6.25*C-5*Q-161;const $e=ae*{sedentary:1.2,light:1.3,moderate:1.4,active:1.5}[T.dailyActivity],qe={low:100,moderate:200,high:300,daily:400},Gt=Math.round($e+qe[T.trainingFrequency]);let Mt=Gt,Yn,Gs;switch(T.goal){case"lose":Mt=Gt*(1-{light:.15,moderate:.2,harsh:.25}[T.deficitLevel]),Yn=2.2,Gs=.3;break;case"build":Mt=Gt*1.1,Yn=2,Gs=.22;break;default:Yn=1.8,Gs=.25}Mt=Math.max(Mt,T.gender==="male"?1400:1100);const Bs=Math.round(k*Yn),qn=Math.round(Mt*Gs/9),$n=Math.max(0,Math.round((Mt-Bs*4-qn*9)/4));M({calories:Math.round(Mt),protein:Bs,carbs:$n,fats:qn,bmr:Math.round(ae),neat:Math.round($e),exerciseAdd:qe[T.trainingFrequency],tdee:Math.round(Gt)})},bt=async()=>{if(B)try{const k={clientId:t.id,calories:B.calories,protein:B.protein,carbs:B.carbs,fats:B.fats,waterGoal:8,goal:T.goal,updatedAt:mt.now()};await Gn(Qe(_e,"nutritionTargets",t.id),k),x(k),g("dashboard"),he("Macro targets saved!","success")}catch(k){console.error("Error saving targets:",k),he("Failed to save targets. Please try again.","error")}},It=()=>{const k=T.weight&&parseFloat(T.weight)>0,C=T.age&&parseInt(T.age)>0,Q=T.heightUnit==="cm"?T.height&&parseFloat(T.height)>0:T.heightFeet&&parseFloat(T.heightFeet)>0||T.heightInches&&parseFloat(T.heightInches)>0;return k&&C&&Q},Qt="nut_favourite_foods",ee=()=>{try{return JSON.parse(localStorage.getItem(Qt)||"[]")}catch{return[]}},ve=k=>ee().some(C=>C.name.toLowerCase()===(k||"").toLowerCase()),at=k=>{const C=ee(),Q=C.findIndex(ae=>ae.name.toLowerCase()===k.name.toLowerCase());Q>=0?C.splice(Q,1):C.unshift({name:k.name,protein:k.protein,carbs:k.carbs,fats:k.fats,calories:k.calories,serving:k.serving,per100g:k.per100g||null,servingUnit:k.servingUnit||"g",portion:k.portion||null}),localStorage.setItem(Qt,JSON.stringify(C)),Ct(ae=>ae+1)},Dt=k=>{const C=[...$.entries,{...k,meal:q,id:Date.now(),addedAt:new Date().toISOString()}],Q={...$,entries:C};J(Q),De(Q),ye(null),ln(null),dt("100"),ct(0),Jt("weight"),kt({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),he("Food added!","success")},jt=k=>{const C=$.entries.filter(ae=>ae.id!==k),Q={...$,entries:C};J(Q),De(Q)},rn=_.useRef(null),Yt=async()=>{Ke(!0);const k=document.querySelector("#barcode-reader");if(!k){Ke(!1),he("Scanner container not found.","error");return}if(!rn.current)try{const Q=await Dr(()=>import("./quagga.min-BbicSfvA.js").then(ae=>ae.q),[]);rn.current=Q.default}catch(Q){console.error("Failed to load barcode scanner:",Q),Ke(!1),he("Could not load scanner.","error");return}const C=rn.current;C.init({inputStream:{type:"LiveStream",target:k,constraints:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader","ean_8_reader","upc_reader","upc_e_reader","code_128_reader","code_39_reader"]},locate:!0},Q=>{if(Q){console.error("Quagga init error:",Q),Ke(!1),he("Could not access camera. Check permissions.","error");return}C.start(),Kt.current=!0}),C.onDetected(Q=>{const ae=Q.codeResult.decodedCodes?.filter($e=>$e.error!==void 0)?.map($e=>$e.error)||[];if((ae.length>0?ae.reduce(($e,qe)=>$e+qe,0)/ae.length:1)<.15){const $e=Q.codeResult.code;C.offDetected(),O($e)}})},$t=()=>{const k=rn.current;Kt.current&&k&&(k.stop(),k.offDetected(),Kt.current=!1),Ke(!1)},Mn=/\b(milk|semi.skimmed|skimmed|whole milk|oat milk|almond milk|soy milk|juice|smoothie|water|squash|cordial|cola|pepsi|fanta|lemonade|soda|beer|wine|cider|lager|spirit|whisky|vodka|rum|gin|brandy|cream|yoghurt drink|milkshake|coffee|tea|broth|stock|soup|sauce|ketchup|vinegar|oil|syrup|honey|custard|coconut water|kombucha|energy drink|protein shake)\b/i,rs=k=>/ml|cl|\dl(?!b)|litre|liter|fl\s?oz/i.test((k||"").replace(/\s/g,"")),bn=k=>{if(!k)return{value:100,unit:"g"};const C=k.toLowerCase().replace(/\s/g,""),Q=C.match(/([\d.]+)/),ae=Q?parseFloat(Q[1]):100;return rs(k)?/cl/.test(C)?{value:ae*10,unit:"ml"}:/(?:^|\d)l(?!i)/.test(C)&&!/ml/.test(C)?{value:ae*1e3,unit:"ml"}:{value:ae,unit:"ml"}:{value:ae,unit:"g"}},Cn=k=>{if(rs(k.serving_size)||rs(k.quantity))return"ml";const C=k.product_name||k.product_name_en||"";return Mn.test(C)?"ml":"g"},Bn=[{pattern:/\b(toast|bread|loaf|brioche|bagel|pitta|wrap|tortilla|crumpet|muffin|waffle|pancake)\b/i,label:"slice",weight:36},{pattern:/\begg\b/i,label:"egg",weight:60},{pattern:/\b(biscuit|cookie|digestive|hobnob|rich tea|oreo)\b/i,label:"biscuit",weight:13},{pattern:/\b(sausage|banger)\b/i,label:"sausage",weight:57},{pattern:/\b(rasher|bacon)\b/i,label:"rasher",weight:25},{pattern:/\b(rice cake)\b/i,label:"cake",weight:9},{pattern:/\b(cracker|ryvita)\b/i,label:"cracker",weight:10}],z=(k,C)=>{const Q=k||"",ae=Q.match(/\((\d+\.?\d*)\s*g\)/i),Ye=Q.match(/(?:^|per\s+)(\d*\s*[a-z][a-z\s]*?)(?:\s*\(|\s*-\s*|\s*$)/i);if(ae&&Ye){const Gt=parseFloat(ae[1]);let Mt=Ye[1].replace(/^\d+\s*/,"").trim();if(Mt&&Gt>0)return{label:Mt,weight:Gt}}const $e=Q.match(/(\d+\.?\d*)\s*g\s*[\/=]\s*(\d*\s*[a-z][a-z\s]*)/i);if($e){const Gt=parseFloat($e[1]);let Mt=$e[2].replace(/^\d+\s*/,"").trim();if(Mt&&Gt>0)return{label:Mt,weight:Gt}}const qe=C||"";for(const{pattern:Gt,label:Mt,weight:Yn}of Bn)if(Gt.test(qe))return{label:Mt,weight:Yn};return null},xe=k=>{const C=k.nutriments||{},Q=Cn(k),ae=bn(k.serving_size),Ye=Q==="ml"?ae.unit==="ml"?ae.value:100:ae.value,$e=k.product_name||k.product_name_en||"Unknown Product",qe=z(k.serving_size,$e);return{name:$e,brand:k.brands||"",image:k.image_small_url||k.image_url||null,servingSize:k.serving_size||"100g",servingValue:Ye,servingUnit:Q,portion:qe,protein:Math.round(C.proteins_100g||C.proteins||0),carbs:Math.round(C.carbohydrates_100g||C.carbohydrates||0),fats:Math.round(C.fat_100g||C.fat||0),calories:Math.round(C["energy-kcal_100g"]||C["energy-kcal"]||(C.energy_100g?C.energy_100g/4.184:0)),per100g:!0}},ke=async k=>{Ge(!0);try{const C=`https://world.openfoodfacts.org/api/v2/product/${k}?fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,Q=await fetch(C);if(!Q.ok)throw new Error(`HTTP ${Q.status}`);const ae=await Q.json();if(ae.status==="success"||ae.status===1||ae.product){const Ye=xe(ae.product);Ye.calories===0&&Ye.protein===0&&Ye.carbs===0?he("Product found but no nutrition data available.","error"):(ln(Ye),Ye.portion?(ct(1),dt(String(Ye.portion.weight)),Jt("portion")):(ct(0),dt(String(Ye.servingValue||100)),Jt("weight")),Te(""))}else he("Product not found. Try search or manual entry.","error")}catch(C){console.error("Barcode lookup error:",C),he("Failed to look up product. Check your connection.","error")}Ge(!1)},Se=(k,C,Q)=>{const ae=k.toLowerCase().trim(),Ye=C.toLowerCase().trim(),$e=Q.toLowerCase().trim();let qe=0;return(ae===$e||ae===$e+"s"||ae+"s"===$e)&&(qe+=100),(ae.endsWith(" "+$e)||ae.endsWith(" "+$e+"s"))&&(qe+=40),(ae.startsWith($e+" ")||ae.startsWith($e+"s "))&&(qe+=15),$e.split(/\s+/).some(Mt=>Ye===Mt||Ye.startsWith(Mt))&&(qe+=30),qe+=Math.max(0,30-ae.length),qe},be=async()=>{if(!Me.trim())return;Pn.current&&Pn.current.abort();const k=new AbortController;Pn.current=k;const C=Me.trim().toLowerCase(),Q=C.split(/\s+/).filter(Boolean);if(rb.has(C)){et(rb.get(C));return}Dn(!0);try{const Ye=`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(Me.trim())}&search_simple=1&action=process&json=1&page_size=10&lc=en&sort_by=unique_scans_n&fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,$e=await fetch(Ye,{signal:k.signal});if(!$e.ok)throw new Error(`HTTP ${$e.status}`);const Gt=((await $e.json()).products||[]).map(Mt=>xe(Mt)).filter(Mt=>Mt.name!=="Unknown Product"&&(Mt.calories>0||Mt.protein>0)).filter(Mt=>{const Yn=(Mt.name+" "+Mt.brand).toLowerCase();return Q.every(Gs=>Yn.includes(Gs))}).sort((Mt,Yn)=>Se(Yn.name,Yn.brand,C)-Se(Mt.name,Mt.brand,C)).slice(0,10);rb.set(C,Gt),et(Gt),Gt.length===0&&he("No results found. Try a different search.","info")}catch(ae){if(ae.name==="AbortError")return;console.error("Search error:",ae),he("Search failed. Check your connection.","error")}Dn(!1)};_.useEffect(()=>{if(hn.current&&clearTimeout(hn.current),!(!Me.trim()||H!=="search"||pe))return hn.current=setTimeout(()=>{be()},700),()=>clearTimeout(hn.current)},[Me]);const rt=()=>{const k={...$,water:$.water+1};J(k),De(k)},Rt=()=>{if($.water<=0)return;const k={...$,water:$.water-1};J(k),De(k)},ot={"ring-protein":"#14b8a6","ring-carbs":"var(--color-primary)","ring-fats":"#eab308","ring-cals":"rgba(150,150,150,0.55)"},vt=80,Nt=2*Math.PI*vt,mn=(k,C,Q,ae,Ye)=>{const $e=ae>0?Math.min(100,Math.round(Q/ae*100)):0,qe=Nt-$e/100*Nt,Gt=ot[Ye]||"#14b8a6";return a.jsxs("div",{className:"nut-ring-wrap",children:[a.jsxs("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"nut-arc-track",cx:"100",cy:"100",r:vt}),a.jsx("circle",{className:"nut-arc-fill",cx:"100",cy:"100",r:vt,style:{stroke:Gt},strokeDasharray:Nt,strokeDashoffset:qe})]}),a.jsxs("div",{className:"nut-ring-center",children:[a.jsx("span",{className:"nut-ring-value",style:{color:Gt},children:Math.round(Q)}),a.jsxs("span",{className:"nut-ring-target",children:["/ ",ae,k==="Calories"?"":"g"]}),a.jsx("span",{className:"nut-ring-label",style:{color:Gt},children:C})]}),a.jsxs("span",{className:"nut-ring-pct",style:{color:Gt},children:[$e,"%"]})]})};if(_.useEffect(()=>{if(!ne)return;const k=setTimeout(()=>{const C=ne;$t(),O(null),ke(C)},1500);return()=>clearTimeout(k)},[ne]),_.useEffect(()=>()=>{const k=rn.current;if(Kt.current&&k){try{k.stop(),k.offDetected()}catch{}Kt.current=!1}},[]),s||p==="loading")return a.jsxs("div",{className:"nut-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"nut-loading-inline",children:a.jsx("div",{className:"cb-loading-spinner"})})]});if(p==="setup")return a.jsxs("div",{className:"nut-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"nut-main",children:[a.jsxs("div",{className:"nut-setup-intro",children:[a.jsx("h2",{children:"Set Your Daily Targets"}),a.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),a.jsxs("div",{className:"nut-calc-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Gender"}),a.jsxs("div",{className:"nut-toggle-group",children:[a.jsx("button",{className:T.gender==="male"?"active":"",onClick:()=>{N(k=>({...k,gender:"male"})),M(null)},children:"Male"}),a.jsx("button",{className:T.gender==="female"?"active":"",onClick:()=>{N(k=>({...k,gender:"female"})),M(null)},children:"Female"})]})]}),a.jsxs("div",{className:"nut-form-row",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Age"}),a.jsx("input",{type:"number",value:T.age,onChange:k=>{N(C=>({...C,age:k.target.value})),M(null)},placeholder:"Years",min:"15",max:"100"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Weight"}),a.jsxs("div",{className:"nut-input-unit",children:[a.jsx("input",{type:"number",value:T.weight,onChange:k=>{N(C=>({...C,weight:k.target.value})),M(null)},placeholder:T.weightUnit,min:"30",max:"300"}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:T.weightUnit==="kg"?"active":"",onClick:()=>{N(k=>({...k,weightUnit:"kg"})),M(null)},children:"kg"}),a.jsx("button",{className:T.weightUnit==="lbs"?"active":"",onClick:()=>{N(k=>({...k,weightUnit:"lbs"})),M(null)},children:"lbs"})]})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Height"}),a.jsxs("div",{className:"nut-input-unit",children:[T.heightUnit==="cm"?a.jsx("input",{type:"number",value:T.height,onChange:k=>{N(C=>({...C,height:k.target.value})),M(null)},placeholder:"cm",min:"100",max:"250"}):a.jsxs("div",{className:"nut-height-imperial",children:[a.jsx("input",{type:"number",value:T.heightFeet,onChange:k=>{N(C=>({...C,heightFeet:k.target.value})),M(null)},placeholder:"ft",min:"4",max:"7"}),a.jsx("input",{type:"number",value:T.heightInches,onChange:k=>{N(C=>({...C,heightInches:k.target.value})),M(null)},placeholder:"in",min:"0",max:"11"})]}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:T.heightUnit==="cm"?"active":"",onClick:()=>{N(k=>({...k,heightUnit:"cm"})),M(null)},children:"cm"}),a.jsx("button",{className:T.heightUnit==="ft"?"active":"",onClick:()=>{N(k=>({...k,heightUnit:"ft"})),M(null)},children:"ft/in"})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Daily Activity (outside of training)"}),a.jsxs("select",{value:T.dailyActivity,onChange:k=>{N(C=>({...C,dailyActivity:k.target.value})),M(null)},children:[a.jsx("option",{value:"sedentary",children:"Sedentary  desk job, under 5k steps"}),a.jsx("option",{value:"light",children:"Lightly Active  office + walking, 5-8k steps"}),a.jsx("option",{value:"moderate",children:"Moderately Active  on feet often, 8-12k steps"}),a.jsx("option",{value:"active",children:"Very Active  physical job, 12k+ steps"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Training Sessions per Week"}),a.jsxs("select",{value:T.trainingFrequency,onChange:k=>{N(C=>({...C,trainingFrequency:k.target.value})),M(null)},children:[a.jsx("option",{value:"low",children:"1-2 sessions"}),a.jsx("option",{value:"moderate",children:"3-4 sessions"}),a.jsx("option",{value:"high",children:"5-6 sessions"}),a.jsx("option",{value:"daily",children:"7+ sessions"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fitness Goal"}),a.jsxs("div",{className:"nut-goal-options",children:[a.jsxs("button",{className:T.goal==="lose"?"active":"",onClick:()=>{N(k=>({...k,goal:"lose"})),M(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"-"}),a.jsx("span",{children:"Lose Weight"})]}),a.jsxs("button",{className:T.goal==="maintain"?"active":"",onClick:()=>{N(k=>({...k,goal:"maintain"})),M(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"="}),a.jsx("span",{children:"Maintain"})]}),a.jsxs("button",{className:T.goal==="build"?"active":"",onClick:()=>{N(k=>({...k,goal:"build"})),M(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"+"}),a.jsx("span",{children:"Build Muscle"})]})]})]}),T.goal==="lose"&&a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Deficit Level"}),a.jsxs("div",{className:"nut-deficit-options",children:[a.jsxs("button",{className:T.deficitLevel==="light"?"active":"",onClick:()=>{N(k=>({...k,deficitLevel:"light"})),M(null)},children:[a.jsx("strong",{children:"Mild"}),a.jsx("span",{children:"15% below TDEE"})]}),a.jsxs("button",{className:T.deficitLevel==="moderate"?"active":"",onClick:()=>{N(k=>({...k,deficitLevel:"moderate"})),M(null)},children:[a.jsx("strong",{children:"Moderate"}),a.jsx("span",{children:"20% below TDEE"})]}),a.jsxs("button",{className:T.deficitLevel==="harsh"?"active":"",onClick:()=>{N(k=>({...k,deficitLevel:"harsh"})),M(null)},children:[a.jsx("strong",{children:"Aggressive"}),a.jsx("span",{children:"25% below TDEE"})]})]})]}),a.jsx("button",{className:"nut-calc-btn",onClick:Tt,disabled:!It(),children:"Calculate Macros"})]}),B&&a.jsxs("div",{className:"nut-calc-results",children:[a.jsx("h3",{children:"Your Daily Targets"}),a.jsxs("div",{className:"nut-calc-rings",children:[mn("Protein","Protein",B.protein,B.protein,"ring-protein"),mn("Carbs","Carbs",B.carbs,B.carbs,"ring-carbs"),mn("Fats","Fats",B.fats,B.fats,"ring-fats"),mn("Calories","Calories",B.calories,B.calories,"ring-cals")]}),a.jsxs("div",{className:"nut-calc-info",children:[a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"BMR (body at rest)"}),a.jsxs("span",{children:[B.bmr," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Daily activity (NEAT)"}),a.jsxs("span",{children:[B.neat," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Training sessions"}),a.jsxs("span",{children:["+",B.exerciseAdd," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",style:{fontWeight:600},children:[a.jsx("span",{children:"TDEE (total burn)"}),a.jsxs("span",{children:[B.tdee," cal"]})]})]}),a.jsx("button",{className:"nut-save-targets-btn",onClick:bt,children:"Set as My Daily Targets"})]})]}),un&&a.jsx("div",{className:`toast-notification ${un.type}`,children:un.message})]});const er=k=>{const C=new Date(k+"T12:00:00"),Q=C.getDay(),ae=new Date(C);ae.setDate(C.getDate()-(Q+6)%7);const Ye=[];for(let $e=0;$e<7;$e++){const qe=new Date(ae);qe.setDate(ae.getDate()+$e),Ye.push(qe.toISOString().split("T")[0])}return Ye},Ts=["M","T","W","T","F","S","S"],Ds=(k,C="search")=>{L(k),C==="scan"?(ye("scan"),ln(null)):C==="manual"?(ye("manual"),kt({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})):C==="favourites"?ye("favourites"):(ye("search"),et([]),ut(""))},ts=er(P),W=new Date(P+"T12:00:00"),fe=`${Le[W.getMonth()]} ${W.getFullYear()}`;return a.jsxs("div",{className:"nut-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsxs("div",{className:"nut-dark-zone",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:()=>{g("setup"),M(null)},"aria-label":"Recalculate macros",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]})}),a.jsxs("div",{className:"nut-dark-content",children:[a.jsxs("div",{className:"nut-week-strip",children:[a.jsxs("div",{className:"nut-week-header",children:[a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const k=new Date(P+"T12:00:00");k.setDate(k.getDate()-7);const C=k.toISOString().split("T")[0];Y(C)},"aria-label":"Previous week",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsx("button",{className:"nut-week-month-label",onClick:()=>{A(!we),V({year:W.getFullYear(),month:W.getMonth()})},children:fe}),a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const k=new Date(P+"T12:00:00");k.setDate(k.getDate()+7);const C=k.toISOString().split("T")[0];C<=wo()&&Y(C)},"aria-label":"Next week",disabled:ts[6]>=wo(),children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-week-days",children:ts.map((k,C)=>{const Q=new Date(k+"T12:00:00").getDate(),ae=k===P,Ye=k>wo(),$e=k===wo();return a.jsxs("button",{className:`nut-week-day${ae?" selected":""}${$e?" today":""}${Ye?" future":""}`,disabled:Ye,onClick:()=>Y(k),children:[a.jsx("span",{className:"nut-week-day-letter",children:Ts[C]}),a.jsx("span",{className:"nut-week-day-num",children:Q})]},k)})})]}),we&&a.jsxs("div",{className:"nut-calendar nut-calendar-dark",children:[a.jsxs("div",{className:"nut-cal-header",children:[a.jsx("button",{onClick:()=>V(k=>{let C=k.month-1,Q=k.year;return C<0&&(C=11,Q--),{year:Q,month:C}}),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsxs("span",{children:[Le[U.month]," ",U.year]}),a.jsx("button",{onClick:()=>V(k=>{let C=k.month+1,Q=k.year;return C>11&&(C=0,Q++),{year:Q,month:C}}),disabled:U.year===new Date().getFullYear()&&U.month>=new Date().getMonth(),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-cal-days-header",children:ze.map(k=>a.jsx("span",{children:k},k))}),a.jsxs("div",{className:"nut-cal-grid",children:[[...Array(Fe(U.year,U.month))].map((k,C)=>a.jsx("span",{},`e${C}`)),[...Array(tt(U.year,U.month))].map((k,C)=>{const Q=C+1,ae=`${U.year}-${String(U.month+1).padStart(2,"0")}-${String(Q).padStart(2,"0")}`,Ye=ae>wo(),$e=ae===P,qe=ae===wo();return a.jsx("button",{className:`nut-cal-day${$e?" selected":""}${qe?" today":""}${Ye?" future":""}`,disabled:Ye,onClick:()=>{Y(ae),A(!1)},children:Q},Q)})]})]}),a.jsxs("div",{className:"nut-rings-row",children:[mn("Protein","Protein",de.protein,b.protein,"ring-protein"),mn("Carbs","Carbs",de.carbs,b.carbs,"ring-carbs"),mn("Fats","Fats",de.fats,b.fats,"ring-fats"),mn("Calories","kCal",de.calories,b.calories,"ring-cals")]})]})]}),a.jsx("div",{className:"nut-light-zone",children:a.jsxs("div",{className:"nut-light-content",children:[Be&&a.jsxs("button",{className:"nut-water-quick",onClick:()=>D(!0),children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"18",height:"18",children:a.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),a.jsxs("span",{className:"nut-water-quick-count",children:[$.water," / ",b?.waterGoal||8]}),a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",width:"14",height:"14",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})]}),a.jsx("div",{className:"nut-log-section",children:a.jsx("div",{className:"nut-meals-list",children:VT.map(k=>{const C=$.entries.filter(ae=>(ae.meal||"snacks")===k.key),Q=C.reduce((ae,Ye)=>({protein:ae.protein+(Ye.protein||0),carbs:ae.carbs+(Ye.carbs||0),fats:ae.fats+(Ye.fats||0),calories:ae.calories+(Ye.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});return a.jsxs("div",{className:"nut-meal-card",children:[a.jsxs("div",{className:"nut-meal-card-header",children:[a.jsx("span",{className:`nut-meal-card-icon nut-meal-icon-${k.key}`,children:N5[k.key]}),a.jsx("span",{className:"nut-meal-card-title",children:k.label}),C.length>0&&a.jsxs("span",{className:"nut-meal-card-cal",children:[Q.calories," cal"]}),Be&&a.jsx("button",{className:"nut-meal-add-btn",onClick:()=>xt(He===k.key?null:k.key),"aria-label":`Add to ${k.label}`,children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),C.length>0&&a.jsxs("div",{className:"nut-meal-bars",children:[a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-p",children:"P"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-protein",style:{width:`${Math.min(100,b.protein>0?Q.protein/b.protein*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[Q.protein,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-c",children:"C"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-carbs",style:{width:`${Math.min(100,b.carbs>0?Q.carbs/b.carbs*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[Q.carbs,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-f",children:"F"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-fats",style:{width:`${Math.min(100,b.fats>0?Q.fats/b.fats*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[Q.fats,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-cal",children:"K"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-cals",style:{width:`${Math.min(100,b.calories>0?Q.calories/b.calories*100:0)}%`}})}),a.jsx("span",{className:"nut-meal-bar-val",children:Q.calories})]})]}),C.length>0&&a.jsx("div",{className:"nut-log-list",children:C.map(ae=>a.jsxs("div",{className:"nut-log-item",children:[a.jsxs("div",{className:"nut-log-item-info",children:[a.jsx("span",{className:"nut-log-item-name",children:ae.name}),ae.serving&&a.jsx("span",{className:"nut-log-item-serving",children:ae.serving})]}),a.jsxs("div",{className:"nut-log-item-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[ae.protein,"p"]}),a.jsxs("span",{className:"nut-macro-c",children:[ae.carbs,"c"]}),a.jsxs("span",{className:"nut-macro-f",children:[ae.fats,"f"]}),a.jsx("span",{className:"nut-macro-cal",children:ae.calories})]}),Be&&a.jsx("button",{className:"nut-log-delete",onClick:()=>jt(ae.id),"aria-label":"Remove",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},ae.id))}),C.length===0&&a.jsx("div",{className:"nut-meal-empty",children:a.jsx("p",{children:Be?"Tap + to add food":"No entries"})})]},k.key)})})})]})}),He&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"nut-add-picker-backdrop",onClick:()=>xt(null)}),a.jsxs("div",{className:"nut-add-picker",children:[a.jsx("div",{className:"nut-add-picker-handle"}),a.jsxs("h3",{className:"nut-add-picker-title",children:["Add to ",VT.find(k=>k.key===He)?.label]}),a.jsxs("div",{className:"nut-add-picker-options",children:[a.jsxs("button",{onClick:()=>{const k=He;xt(null),Ds(k,"scan")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),a.jsx("span",{children:"Scan Barcode"})]}),a.jsxs("button",{onClick:()=>{const k=He;xt(null),Ds(k,"search")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Search Food"})]}),a.jsxs("button",{onClick:()=>{const k=He;xt(null),Ds(k,"manual")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),a.jsx("span",{children:"Manual Entry"})]}),a.jsxs("button",{onClick:()=>{const k=He;xt(null),Ds(k,"favourites")},children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),a.jsx("span",{children:"Favourites"})]})]})]})]}),S&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>D(!1),children:a.jsxs("div",{className:"nut-water-popup",onClick:k=>k.stopPropagation(),children:[a.jsxs("div",{className:"nut-water-popup-header",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"20",height:"20",style:{color:"#2196f3"},children:a.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),a.jsx("span",{children:"Water Intake"}),a.jsx("button",{className:"nut-modal-close",onClick:()=>D(!1),children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsxs("div",{className:"nut-water-popup-body",children:[a.jsx("div",{className:"nut-water-glasses",children:[...Array(b?.waterGoal||8)].map((k,C)=>a.jsx("div",{className:`nut-water-glass ${C<$.water?"filled":""}`,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:C<$.water?"currentColor":"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})})},C))}),a.jsxs("div",{className:"nut-water-popup-count",children:[$.water," / ",b?.waterGoal||8," glasses"]}),a.jsxs("div",{className:"nut-water-btns",children:[a.jsx("button",{onClick:Rt,disabled:$.water<=0,children:"-"}),a.jsx("button",{onClick:rt,children:"+"})]})]})]})}),H&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>{$t(),O(null),ye(null),ln(null)},children:a.jsxs("div",{className:"nut-modal",onClick:k=>k.stopPropagation(),children:[a.jsxs("div",{className:"nut-modal-header",children:[a.jsx("h3",{children:H==="scan"?"Scan Barcode":H==="search"?"Search Food":H==="favourites"?"Favourites":"Manual Entry"}),a.jsx("button",{className:"nut-modal-close",onClick:()=>{$t(),O(null),ye(null),ln(null)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),H==="scan"&&!pe&&a.jsxs("div",{className:"nut-scan-area",children:[a.jsxs("div",{className:"nut-scanner-wrapper",children:[a.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),Ve&&!ne&&a.jsx("div",{className:"nut-scan-line"}),ne&&a.jsxs("div",{className:"nut-scan-detected-overlay",children:[a.jsx("svg",{className:"nut-scan-detected-tick",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),a.jsx("p",{className:"nut-scan-detected-label",children:"Barcode found!"}),a.jsx("p",{className:"nut-scan-detected-code",children:ne})]})]}),!Ve&&a.jsxs("button",{className:"nut-scan-start-btn",onClick:Yt,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),Ve&&!ne&&a.jsx("p",{className:"nut-scan-hint",children:"Align barcode within the frame"}),a.jsx("div",{className:"nut-barcode-divider",children:a.jsx("span",{children:"or enter barcode manually"})}),a.jsxs("div",{className:"nut-barcode-manual",children:[a.jsx("input",{type:"text",inputMode:"numeric",value:K,onChange:k=>Te(k.target.value),onKeyDown:k=>k.key==="Enter"&&K.trim()&&ke(K.trim()),placeholder:"Enter barcode number"}),a.jsx("button",{onClick:()=>K.trim()&&ke(K.trim()),disabled:!K.trim()||Re,children:Re?"...":"Look Up"})]})]}),H==="scan"&&pe&&(()=>{const k=pe.servingUnit||"g",C=pe.portion,Q=it==="portion"&&C?St*C.weight:parseFloat(sn)||0,ae=Q/100,Ye=k==="ml"?[100,200,250,500]:[50,100,150,200],$e=it==="portion"&&C?`${St} ${C.label}${St!==1?"s":""} (${Math.round(Q)}${k})`:`${Math.round(Q)}${k}`;return a.jsxs("div",{className:"nut-product-result",children:[pe.image&&a.jsx("img",{src:pe.image,alt:pe.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:pe.name}),a.jsx("button",{className:`nut-fav-star confirm${ve(pe.name)?" active":""}`,onClick:()=>at({name:pe.name,protein:pe.protein,carbs:pe.carbs,fats:pe.fats,calories:pe.calories,serving:pe.servingSize,per100g:{protein:pe.protein,carbs:pe.carbs,fats:pe.fats,calories:pe.calories},servingUnit:pe.servingUnit||"g",portion:pe.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:ve(pe.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),pe.brand&&a.jsx("p",{className:"nut-product-brand",children:pe.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",k,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[pe.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[pe.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[pe.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[pe.calories," cal"]})]}),C&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:it==="portion"?"active":"",onClick:()=>{Jt("portion"),St<1&&ct(1)},children:"Portions"}),a.jsxs("button",{className:it==="weight"?"active":"",onClick:()=>{Jt("weight"),dt(String(Math.round(Q)||100))},children:["Custom (",k,")"]})]}),it==="portion"&&C?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ct(Math.max(1,St-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:St}),a.jsxs("span",{className:"nut-stepper-label",children:[C.label,St!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(Q),k]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ct(St+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",k,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:sn,onChange:qe=>dt(qe.target.value),onFocus:qe=>qe.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Ye.map(qe=>a.jsxs("button",{className:`nut-quick-btn${sn===String(qe)?" active":""}`,onClick:()=>dt(String(qe)),children:[qe,k]},qe))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(pe.protein*ae),"p / ",Math.round(pe.carbs*ae),"c / ",Math.round(pe.fats*ae),"f / ",Math.round(pe.calories*ae)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>{ln(null),ye("scan")},children:"Scan Again"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Dt({name:pe.name,protein:Math.round(pe.protein*ae),carbs:Math.round(pe.carbs*ae),fats:Math.round(pe.fats*ae),calories:Math.round(pe.calories*ae),serving:$e}),children:"Add"})]})]})})(),H==="search"&&!pe&&a.jsxs("div",{className:"nut-search-area",children:[a.jsxs("div",{className:"nut-search-bar",children:[a.jsx("input",{type:"text",ref:Rn,value:Me,onChange:k=>ut(k.target.value),onKeyDown:k=>{k.key==="Enter"&&(clearTimeout(hn.current),be())},onFocus:()=>setTimeout(()=>Rn.current?.scrollIntoView({behavior:"smooth",block:"center"}),350),placeholder:"Search food or product...",autoFocus:!0}),a.jsx("button",{onClick:be,disabled:qt,children:qt?"...":"Search"})]}),a.jsxs("div",{className:"nut-search-results",children:[gt.map((k,C)=>a.jsxs("button",{className:"nut-search-item",onClick:()=>{ln(k),k.portion?(ct(1),dt(String(k.portion.weight)),Jt("portion")):(ct(0),dt(String(k.servingValue||100)),Jt("weight"))},children:[k.image&&a.jsx("img",{src:k.image,alt:k.name||"Product",loading:"lazy"}),a.jsxs("div",{className:"nut-search-item-info",children:[a.jsx("span",{className:"nut-search-item-name",children:k.name}),k.brand&&a.jsx("span",{className:"nut-search-item-brand",children:k.brand}),a.jsxs("span",{className:"nut-search-item-macros",children:[k.calories," cal  ",k.protein,"p  ",k.carbs,"c  ",k.fats,"f per 100",k.servingUnit||"g"]})]})]},C)),gt.length===0&&Me&&!qt&&a.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]})]}),H==="search"&&pe&&(()=>{const k=pe.servingUnit||"g",C=pe.portion,Q=it==="portion"&&C?St*C.weight:parseFloat(sn)||0,ae=Q/100,Ye=k==="ml"?[100,200,250,500]:[50,100,150,200],$e=it==="portion"&&C?`${St} ${C.label}${St!==1?"s":""} (${Math.round(Q)}${k})`:`${Math.round(Q)}${k}`;return a.jsxs("div",{className:"nut-product-result",children:[pe.image&&a.jsx("img",{src:pe.image,alt:pe.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:pe.name}),a.jsx("button",{className:`nut-fav-star confirm${ve(pe.name)?" active":""}`,onClick:()=>at({name:pe.name,protein:pe.protein,carbs:pe.carbs,fats:pe.fats,calories:pe.calories,serving:pe.servingSize,per100g:{protein:pe.protein,carbs:pe.carbs,fats:pe.fats,calories:pe.calories},servingUnit:pe.servingUnit||"g",portion:pe.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:ve(pe.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),pe.brand&&a.jsx("p",{className:"nut-product-brand",children:pe.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",k,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[pe.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[pe.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[pe.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[pe.calories," cal"]})]}),C&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:it==="portion"?"active":"",onClick:()=>{Jt("portion"),St<1&&ct(1)},children:"Portions"}),a.jsxs("button",{className:it==="weight"?"active":"",onClick:()=>{Jt("weight"),dt(String(Math.round(Q)||100))},children:["Custom (",k,")"]})]}),it==="portion"&&C?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ct(Math.max(1,St-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:St}),a.jsxs("span",{className:"nut-stepper-label",children:[C.label,St!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(Q),k]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ct(St+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",k,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:sn,onChange:qe=>dt(qe.target.value),onFocus:qe=>qe.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Ye.map(qe=>a.jsxs("button",{className:`nut-quick-btn${sn===String(qe)?" active":""}`,onClick:()=>dt(String(qe)),children:[qe,k]},qe))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(pe.protein*ae),"p / ",Math.round(pe.carbs*ae),"c / ",Math.round(pe.fats*ae),"f / ",Math.round(pe.calories*ae)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>ln(null),children:"Back to Search"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Dt({name:pe.name,protein:Math.round(pe.protein*ae),carbs:Math.round(pe.carbs*ae),fats:Math.round(pe.fats*ae),calories:Math.round(pe.calories*ae),serving:$e}),children:"Add"})]})]})})(),H==="manual"&&a.jsxs("div",{className:"nut-manual-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Food Name"}),a.jsx("input",{type:"text",value:Vt.name,onChange:k=>kt(C=>({...C,name:k.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Serving Size (optional)"}),a.jsx("input",{type:"text",value:Vt.serving,onChange:k=>kt(C=>({...C,serving:k.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),a.jsxs("div",{className:"nut-manual-macros",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Protein (g)"}),a.jsx("input",{type:"number",value:Vt.protein,onChange:k=>kt(C=>({...C,protein:k.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Carbs (g)"}),a.jsx("input",{type:"number",value:Vt.carbs,onChange:k=>kt(C=>({...C,carbs:k.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fats (g)"}),a.jsx("input",{type:"number",value:Vt.fats,onChange:k=>kt(C=>({...C,fats:k.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Calories"}),a.jsx("input",{type:"number",value:Vt.calories,onChange:k=>kt(C=>({...C,calories:k.target.value})),min:"0"})]})]}),a.jsx("button",{className:"nut-btn-primary",disabled:!Vt.name.trim(),onClick:()=>Dt({name:Vt.name,protein:parseFloat(Vt.protein)||0,carbs:parseFloat(Vt.carbs)||0,fats:parseFloat(Vt.fats)||0,calories:parseFloat(Vt.calories)||0,serving:Vt.serving||""}),children:"Add Food"})]}),H==="favourites"&&!pe&&(()=>{const k=ee(),C=Q=>{if(Q.per100g){const ae=Q.per100g;ln({name:Q.name,brand:"",image:null,servingSize:Q.serving||"100g",servingValue:100,servingUnit:Q.servingUnit||"g",portion:Q.portion||null,protein:ae.protein,carbs:ae.carbs,fats:ae.fats,calories:ae.calories,per100g:!0}),Q.portion?(ct(1),dt(String(Q.portion.weight)),Jt("portion")):(ct(0),dt("100"),Jt("weight"))}else Dt({name:Q.name,protein:Q.protein,carbs:Q.carbs,fats:Q.fats,calories:Q.calories,serving:Q.serving||""})};return a.jsx("div",{className:"nut-recent-area",children:k.length===0?a.jsx("p",{className:"nut-search-empty",children:"No favourites yet. Tap the star on any food to save it here."}):a.jsx("div",{className:"nut-recent-list",children:k.map((Q,ae)=>a.jsxs("div",{className:"nut-recent-item-row",children:[a.jsx("button",{className:"nut-fav-star active",onClick:Ye=>{Ye.stopPropagation(),at(Q)},children:a.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("button",{className:"nut-recent-item",onClick:()=>C(Q),children:[a.jsxs("div",{className:"nut-recent-item-info",children:[a.jsx("span",{className:"nut-recent-item-name",children:Q.name}),a.jsx("span",{className:"nut-recent-item-serving",children:Q.serving||""})]}),a.jsxs("span",{className:"nut-recent-item-macros",children:[Q.calories," cal"]})]})]},ae))})})})(),H==="favourites"&&pe&&(()=>{const k=pe.servingUnit||"g",C=pe.portion,Q=it==="portion"&&C?St*C.weight:parseFloat(sn)||0,ae=Q/100,Ye=k==="ml"?[100,200,250,500]:[50,100,150,200],$e=it==="portion"&&C?`${St} ${C.label}${St!==1?"s":""} (${Math.round(Q)}${k})`:`${Math.round(Q)}${k}`;return a.jsxs("div",{className:"nut-product-result",children:[a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:pe.name}),a.jsx("button",{className:`nut-fav-star confirm${ve(pe.name)?" active":""}`,onClick:()=>at({name:pe.name,protein:pe.protein,carbs:pe.carbs,fats:pe.fats,calories:pe.calories,serving:pe.servingSize,per100g:{protein:pe.protein,carbs:pe.carbs,fats:pe.fats,calories:pe.calories},servingUnit:pe.servingUnit||"g",portion:pe.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:ve(pe.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",k,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[pe.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[pe.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[pe.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[pe.calories," cal"]})]}),C&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:it==="portion"?"active":"",onClick:()=>{Jt("portion"),St<1&&ct(1)},children:"Portions"}),a.jsxs("button",{className:it==="weight"?"active":"",onClick:()=>{Jt("weight"),dt(String(Math.round(Q)||100))},children:["Custom (",k,")"]})]}),it==="portion"&&C?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ct(Math.max(1,St-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:St}),a.jsxs("span",{className:"nut-stepper-label",children:[C.label,St!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(Q),k]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ct(St+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",k,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:sn,onChange:qe=>dt(qe.target.value),onFocus:qe=>qe.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Ye.map(qe=>a.jsxs("button",{className:`nut-quick-btn${sn===String(qe)?" active":""}`,onClick:()=>dt(String(qe)),children:[qe,k]},qe))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(pe.protein*ae),"p / ",Math.round(pe.carbs*ae),"c / ",Math.round(pe.fats*ae),"f / ",Math.round(pe.calories*ae)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>ln(null),children:"Back to Favourites"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Dt({name:pe.name,protein:Math.round(pe.protein*ae),carbs:Math.round(pe.carbs*ae),fats:Math.round(pe.fats*ae),calories:Math.round(pe.calories*ae),serving:$e}),children:"Add"})]})]})})()]})}),a.jsx(oa,{active:"nutrition"}),un&&a.jsx("div",{className:`toast-notification ${un.type}`,children:un.message})]})}const OT="/login/assets/randomiser-glq9YJkL.jpg",C5="/login/assets/programme-card-workout-CnNzTYkz.webp",I5="/login/assets/prog-fullbody-4wk-r6m9HJys.jpg",D5="/login/assets/mg-arms-BeOQU3wx.jpg",P5=60,ib=5,M5=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],L5={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Squeeze Press":"push","Incline Dumbbell Press":"push","Dumbbell Fly":"push","Dumbbell Pullover":"push","Tricep Kickback":"push","Dumbbell Shrug":"push","Dumbbell Y-Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Wide Dumbbell Bent Over Row":"pull","Reverse Fly":"pull","Concentration Curl":"pull","Wide Grip Bicep Curl":"pull","Wrist Curl":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core","Kettlebell Bird Dog Drag":"core"},V5={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},O5={fullbody:"linear-gradient(160deg, rgba(153,49,60,0.15) 0%, rgba(153,49,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",upper:"linear-gradient(160deg, rgba(100,60,140,0.2) 0%, rgba(100,60,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",lower:"linear-gradient(160deg, rgba(40,120,80,0.2) 0%, rgba(40,120,80,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)"},ab={arms:"linear-gradient(160deg, rgba(180,60,60,0.2) 0%, rgba(180,60,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",chest:"linear-gradient(160deg, rgba(50,100,160,0.2) 0%, rgba(50,100,160,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",back:"linear-gradient(160deg, rgba(80,130,60,0.2) 0%, rgba(80,130,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",shoulders:"linear-gradient(160deg, rgba(160,100,40,0.2) 0%, rgba(160,100,40,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",legs:"linear-gradient(160deg, rgba(100,50,140,0.2) 0%, rgba(100,50,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)"},ob=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,level:"All Levels",daysPerWeek:3,image:I5},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,level:"Intermediate",daysPerWeek:3},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,level:"Advanced",daysPerWeek:3},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,level:"Beginner",daysPerWeek:3},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,level:"Intermediate",daysPerWeek:3},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,level:"Advanced",daysPerWeek:3},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,level:"Intermediate",daysPerWeek:3},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,level:"Intermediate",daysPerWeek:3}],Ah=[{key:"arms",label:"Arms",icon:"M7 5h2v14H7V5zm8 0h2v14h-2V5zm-5 4h4v6h-4V9z",image:D5},{key:"chest",label:"Chest",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-2h2v2zm4 0h-2v-2h2v2zm3-6c0 1.1-.36 2.12-.97 2.95l-.87-.87C16.7 12.53 17 11.8 17 11c0-2.76-2.24-5-5-5S7 8.24 7 11c0 .8.3 1.53.84 2.08l-.87.87A4.977 4.977 0 0 1 6 11c0-3.31 2.69-6 6-6s6 2.69 6 6z"},{key:"back",label:"Back",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm4 18H8v-6l-4-4 1.41-1.41L8 11.17V8h8v3.17l2.59-2.58L20 10l-4 4v6z"},{key:"shoulders",label:"Shoulders",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"legs",label:"Legs",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}],BT={chest:[{id:"chest_strength",name:"Chest Strength",desc:"Heavy pressing for max strength",level:"Intermediate",overview:"A heavy pressing session designed to build raw chest strength. Focus on controlled negatives and powerful pressing movements.",tips:["Go heavy  pick a weight where the last 2 reps are a real challenge","Control the negative (lowering phase) for 2-3 seconds","Keep your shoulder blades squeezed together throughout all pressing movements","Rest 90-120 seconds between sets to allow full recovery"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Squeeze Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"chest_hypertrophy",name:"Chest Hypertrophy",desc:"Volume training for muscle growth",level:"Intermediate",overview:"A high-volume chest session focused on time under tension and muscle growth. Lighter weights, more reps, and slow controlled movements.",tips:["Use moderate weight  you should feel the burn by rep 10","Squeeze your chest at the top of every rep for 1 second","Keep rest periods short at 60-90 seconds to keep the pump going","On press ups, go to failure on the final set"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Press Up",type:"reps",sets:3,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"}]},{id:"chest_endurance",name:"Chest Endurance",desc:"Bodyweight pushing to failure",level:"All Levels",overview:"No weights needed. This bodyweight-only session builds chest endurance and muscular stamina through high-rep push up variations.",tips:["Focus on full range of motion  chest to floor on every rep","Keep your core tight and body in a straight line throughout","Scale down to knee press ups if you can't maintain form","Push through the burn  the last 5 reps are where the growth happens"],exercises:[{name:"Press Up",type:"reps",sets:4,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null},{name:"Decline Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Press Up Hold",type:"timed",sets:3,time:30,storagePath:null}]}],back:[{id:"back_strength",name:"Back Strength",desc:"Heavy rows for a thick back",level:"Intermediate",overview:"Build a thick, powerful back with heavy rowing movements. This session targets your lats, rhomboids, and traps for overall back development.",tips:["Go heavy on rows  use a weight that challenges you by rep 6-8","Drive your elbows back and squeeze your shoulder blades together at the top","Keep a slight bend in your knees and hinge at the hips for bent over movements","Rest 90-120 seconds between sets for full recovery"],exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"back_hypertrophy",name:"Back Hypertrophy",desc:"Width and thickness volume work",level:"Intermediate",overview:"A volume-focused back session combining rows and isolation moves to build width and thickness. Focus on the mind-muscle connection.",tips:["Use moderate weight  feel the stretch and squeeze on every rep","On renegade rows, keep your hips square to the floor and avoid rotating","For reverse flys, use lighter weight and focus on squeezing your rear delts","Keep rest to 60-90 seconds to maintain intensity"],exercises:[{name:"Renegade Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Reverse Fly",type:"weighted",sets:3,reps:15,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null}]},{id:"back_endurance",name:"Back Endurance",desc:"Bodyweight back conditioning",level:"All Levels",overview:"A bodyweight session to strengthen your posterior chain and improve posture. Great for back health, mobility, and muscular endurance.",tips:["On superman holds, lift your arms and legs simultaneously and hold tight","Focus on slow, controlled movements  quality over speed","Breathe steadily throughout timed holds  don't hold your breath","Engage your glutes and lower back together on every movement"],exercises:[{name:"Superman Hold",type:"timed",sets:4,time:30,storagePath:"exercises/bodyweight/upper/Superman Hold.mp4"},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:12,storagePath:null},{name:"Reverse Snow Angel",type:"reps",sets:3,reps:12,storagePath:null},{name:"Bird Dog",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Back Extension Hold",type:"timed",sets:3,time:30,storagePath:null}]}],shoulders:[{id:"shoulders_strength",name:"Shoulder Strength",desc:"Heavy pressing for boulder shoulders",level:"Intermediate",overview:"A heavy overhead pressing session to build strong, powerful shoulders. Compound movements first, followed by isolation work for all three delt heads.",tips:["Go heavy on presses  pick a weight where you struggle on the last 2 reps","Brace your core and avoid arching your back during overhead movements","Press straight up and control the weight down slowly","Rest 90-120 seconds between pressing sets, 60 seconds for isolation moves"],exercises:[{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"shoulders_hypertrophy",name:"Shoulder Hypertrophy",desc:"Volume and isolation for 3D delts",level:"Intermediate",overview:"A high-volume session targeting all three heads of the deltoid for that 3D capped shoulder look. Moderate weight, high reps, constant tension.",tips:["Use lighter weight than you think  shoulders respond best to high reps","On lateral raises, lead with your elbows and don't swing the weight","Pause at the top of each raise for a 1-second squeeze","Keep rest periods at 60 seconds to maximise the pump"],exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Y-Raise",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"shoulders_endurance",name:"Shoulder Endurance",desc:"Bodyweight and high-rep work",level:"All Levels",overview:"A shoulder endurance session combining bodyweight movements with high-rep dumbbell work. Builds stamina, stability, and shoulder resilience.",tips:["On pike push ups, walk your feet close to your hands to increase the angle","For high-rep lateral raises, use a very light weight and focus on form","Wall walks are advanced  scale to pike push ups if needed","Keep your core braced throughout to protect your lower back"],exercises:[{name:"Pike Push Ups",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/upper/pike push ups.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,reps:20,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Wall Walks",type:"reps",sets:3,reps:6,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null},{name:"Shoulder Tap Hold",type:"timed",sets:3,time:30,storagePath:null}]}],arms:[{id:"arms_bicep",name:"Bicep Focus",desc:"Curl variations for peak biceps",level:"All Levels",overview:"An arm session dedicated entirely to biceps. Multiple curl variations target different parts of the bicep for maximum peak and thickness.",tips:["Keep your elbows pinned to your sides  no swinging","Control the negative (lowering) for 2-3 seconds on every rep","Start with your heaviest weight and decrease as you fatigue","Squeeze hard at the top of each curl for a full contraction"],exercises:[{name:"Bicep Curl",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Concentration Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Isometric Bicep Hold",type:"timed",sets:3,time:20,storagePath:null}]},{id:"arms_tricep",name:"Tricep Focus",desc:"Extensions and dips for horseshoe triceps",level:"All Levels",overview:"All-out tricep training with extensions, dips, and pressing movements. The triceps make up two-thirds of your arm  this session builds serious size.",tips:["On overhead extensions, keep your elbows close to your head","For skullcrushers, lower the weight slowly to just above your forehead","On dips, lean slightly forward to reduce shoulder strain","Full lockout at the top of every extension for maximum tricep contraction"],exercises:[{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Tricep Dips",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null}]},{id:"arms_full",name:"Full Arms",desc:"Superset biceps and triceps",level:"All Levels",overview:"A balanced arm session alternating between biceps and triceps. Superset style keeps the intensity high and maximises the pump.",tips:["Superset each pair  do biceps then immediately hit triceps","Use moderate weight that lets you maintain strict form for all reps","Rest 60 seconds after each superset pair","Focus on the squeeze at the peak contraction of every rep"],exercises:[{name:"Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Wrist Curl",type:"weighted",sets:3,reps:15,storagePath:null}]}],legs:[{id:"legs_quad",name:"Quad Dominant",desc:"Squats and lunges for quad power",level:"All Levels",overview:"A quad-focused leg session built around squats and lunges. Heavy compound movements to build strong, powerful quads and overall leg strength.",tips:["On goblet squats, hold the dumbbell close to your chest and sit deep","Keep your knees tracking over your toes  don't let them cave inward","Drive through your heels on all squatting movements","Rest 90-120 seconds between heavy sets, 60 seconds on bodyweight moves"],exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/lower/bulgarian split squats.mp4"},{name:"Squat And Hold",type:"timed",sets:3,time:30,storagePath:"exercises/bodyweight/lower/squat and hold.mp4"}]},{id:"legs_ham_glute",name:"Hamstring & Glute",desc:"Posterior chain focus",level:"Intermediate",overview:"Target the back of your legs with deadlift and hip hinge variations. This session builds a strong posterior chain  hamstrings, glutes, and lower back.",tips:["On RDLs, push your hips back and feel the stretch in your hamstrings","Keep a slight bend in your knees throughout hip hinge movements","Squeeze your glutes hard at the top of every rep","For single leg work, start with your weaker side first"],exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/romanian deadlifts.mp4"},{name:"1 Legged RDL",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.mp4"},{name:"Hip Thrusts",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/hip thrusts.mp4"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.mp4"},{name:"Donkey Kicks",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.mp4"}]},{id:"legs_power",name:"Power & Plyo",desc:"Explosive leg training",level:"Intermediate",overview:"An explosive leg session combining plyometrics with weighted movements. Build power, speed, and athletic performance.",tips:["On jump squats, land softly with bent knees to absorb the impact","Explode up on every rep  power comes from speed, not just weight","Keep rest periods at 60-90 seconds to maintain intensity","Focus on landing mechanics  knees out, chest up, soft landing"],exercises:[{name:"Jump Squats",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/lower/jump squats.mp4"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Skater Jumps",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/skater jumps.mp4"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.mp4"}]}],core:[{id:"core_lower_abs",name:"Lower Abs Blast",desc:"40s work / 20s rest  3 rounds",level:"Intermediate",overview:"An interval-based core burner targeting the lower abdominals. 40 seconds of work followed by 20 seconds of rest  keep the intensity high and your lower back pressed into the floor throughout.",tips:["Press your lower back firmly into the floor on every rep","Exhale hard as you contract your abs  don't hold your breath","If your lower back lifts off the ground, reduce the range of motion","Focus on slow, controlled movements rather than speed"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Leg Raises",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Reverse Crunch To Leg Raise",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Flutter Kicks",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Dead Bug Single Leg Drop",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Hollow Hold Flutter Kicks",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"}]},{id:"core_obliques",name:"Obliques & Rotation",desc:"35s work / 25s rest  3 rounds",level:"Intermediate",overview:"Target the obliques and rotational core muscles with this interval session. 35 seconds of work with 25 seconds rest  every exercise involves twisting, rotating, or side-bracing movements.",tips:["Rotate from your ribcage, not just your arms","Keep your hips as still as possible during twisting exercises","Brace your core before each movement  think about squeezing a belt","On side planks, stack your hips and push the floor away"],interval:!0,rounds:3,work:35,rest:25,exercises:[{name:"Russian Twist",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank Rotation",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Cross Body Mountain Climbers",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Hip Dips Plank",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Bicycle Crunch",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank",storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{id:"core_weighted",name:"Weighted Core",desc:"40s work / 20s rest  3 rounds",level:"Advanced",overview:"Add resistance to your core training with dumbbells and kettlebells. 40 seconds of weighted work followed by 20 seconds rest  this session builds serious core strength and stability.",tips:["Start with a moderate weight  form is more important than load","Brace your entire core before picking up the weight each round","Keep movements controlled  no swinging or using momentum","If grip fails before core does, go slightly lighter next time"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Russian Twists Dumbbell",storagePath:"exercises/dumbbells/core/russian twists dumbbell.mp4"},{name:"Kettlebell Russian Twist",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Dumbbell Plank Pull Through",storagePath:null}]}]},UT=[{key:"bodyweight",label:"Bodyweight",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"},{key:"dumbbells",label:"Dumbbells",icon:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"},{key:"kettlebells",label:"Kettlebells",icon:"M12 2C9.24 2 7 4.24 7 7c0 1.1.36 2.12.97 2.95C6.76 11.08 6 12.96 6 15c0 3.87 2.69 7 6 7s6-3.13 6-7c0-2.04-.76-3.92-1.97-5.05.61-.83.97-1.85.97-2.95 0-2.76-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}],lb=[{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"},{key:"upper",label:"Upper",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"lower",label:"Lower",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"fullbody",label:"Full Body",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z"},{key:"mix",label:"Mix It Up",icon:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm-.83 9.41l-1.42 1.42L17.96 20.54l1.42-1.42-5.71-5.71z"}],Bc=[{key:"beginner",label:"Beginner",work:30,rest:30,desc:"30s work / 30s rest"},{key:"intermediate",label:"Intermediate",work:40,rest:20,desc:"40s work / 20s rest"},{key:"advanced",label:"Advanced",work:40,rest:15,desc:"40s work / 15s rest"}],cb=[5,10,15,20,30];function B5(n){return n.replace(/\b\w/g,e=>e.toUpperCase())}function U5(n){const e=[...n];for(let t=e.length-1;t>0;t--){const s=Math.floor(Math.random()*(t+1));[e[t],e[s]]=[e[s],e[t]]}return e}function F5(){const{currentUser:n,isClient:e,clientData:t,loading:s}=li(),{isDark:o,toggleTheme:c,accent:u}=Bi(),{isPremium:d,FREE_RANDOMISER_DURATIONS:p,FREE_RANDOMISER_WEEKLY_LIMIT:g}=Dp(),b=gr(),[x,T]=_.useState("menu"),[N,B]=_.useState(["bodyweight"]),[M,P]=_.useState("core"),[Y,$]=_.useState("intermediate"),[J,de]=_.useState(d?15:5),[Ne,we]=_.useState([]),[A,S]=_.useState(!1),D=_.useRef(!1),U=_.useRef([]),[V,q]=_.useState([]),[L,He]=_.useState(2),[xt,H]=_.useState(Bc[1]),[ye,Ve]=_.useState(1),[Ke,ne]=_.useState(0),[O,K]=_.useState("work"),[Te,Re]=_.useState(0),[Ge,Me]=_.useState(!1),[ut,gt]=_.useState(0),[et,qt]=_.useState(null),Dn=_.useRef(null);_.useRef(null),_.useRef(null);const[Vt,kt]=_.useState(null),pe=_.useCallback((X,Ee="info")=>{kt({message:X,type:Ee}),setTimeout(()=>kt(null),3e3)},[]),[ln,sn]=_.useState(null),[dt,St]=_.useState(null),[ct,it]=_.useState(0),[Jt,Is]=_.useState(0),[Ct,un]=_.useState([]),[ds,Kt]=_.useState(""),[Pn,hn]=_.useState(""),[Rn,he]=_.useState(!1),[De,Be]=_.useState(0),[tt,Fe]=_.useState(!1),[Le,ze]=_.useState({}),Tt=_.useRef(null),bt=_.useRef(null),[It,Qt]=_.useState([]),[ee,ve]=_.useState(null),[at,Dt]=_.useState(0),[jt,rn]=_.useState(0),[Yt,$t]=_.useState(0),[Mn,rs]=_.useState(0),[bn,Cn]=_.useState(0),[Bn,z]=_.useState(0),[xe,ke]=_.useState({beginner:0,intermediate:0,advanced:0}),Se=d?cb:cb.filter(X=>p.includes(X)),be=!d&&at>=g,[rt,Rt]=_.useState(null),[ot,vt]=_.useState(""),[Nt,mn]=_.useState(!1);_.useEffect(()=>{!s&&(!n||!e)&&b("/")},[n,e,s,b]),_.useEffect(()=>{if(!n||!t)return;(async()=>{try{const Ee=Wt(_e,"workoutLogs"),se=In(Ee,dn("clientId","==",t.id)),We=(await Sn(se)).docs.map(cn=>cn.data()),ht=We.filter(cn=>cn.type!=="programme");rs(ht.length);const _t=ht.reduce((cn,_s)=>cn+(_s.duration||0),0);Cn(_t);const Ot={beginner:0,intermediate:0,advanced:0};ht.forEach(cn=>{cn.level&&Ot[cn.level]!==void 0&&Ot[cn.level]++}),ke(Ot);const En=new Date,xs=En.getDay(),vn=xs===0?-6:1-xs,lr=new Date(En);lr.setDate(En.getDate()+vn),lr.setHours(0,0,0,0);const ci=lr.getTime(),Es=We.filter(cn=>{const _s=cn.completedAt;return _s?(_s.toDate?_s.toDate().getTime():new Date(_s).getTime())>=ci:!1});Dt(Es.filter(cn=>cn.type!=="programme").length);let Ui=0;if(t)try{const cn=await On(Qe(_e,"clientProgrammes",t.id));if(cn.exists()){const _s=cn.data(),yr=_s.templateId;Ui=Es.filter(os=>os.type==="programme"&&os.programmeId===yr).length,Rt(yr);const cr=ob.find(os=>os.id===yr);cr&&vt(cr.name);const Pr=V5[yr];if(Pr){const os=Object.keys(_s.completedSessions||{}).length,Ks=Pr.duration*Pr.daysPerWeek;$t(Ks>0?Math.round(os/Ks*100):0)}}else Rt(null),vt(""),$t(0)}catch{}rn(Ui);const tr=ht.map(cn=>cn.completedAt).filter(Boolean).map(cn=>cn.toDate?cn.toDate().getTime():new Date(cn).getTime()).sort((cn,_s)=>_s-cn);if(tr.length===0)z(0);else{const cn=new Set;tr.forEach(Ks=>{const Us=new Date(Ks),Mr=Us.getDay(),Lr=Mr===0?-6:1-Mr,Wr=new Date(Us);Wr.setDate(Us.getDate()+Lr),Wr.setHours(0,0,0,0),cn.add(Wr.getTime())});const _s=[...cn].sort((Ks,Us)=>Us-Ks);let yr=0;const cr=new Date(En),Pr=En.getDay()===0?-6:1-En.getDay();cr.setDate(En.getDate()+Pr),cr.setHours(0,0,0,0);let os=cr.getTime();_s.includes(os)||(os-=10080*60*1e3);for(let Ks=0;Ks<200&&_s.includes(os);Ks++)yr++,os-=10080*60*1e3;z(yr)}}catch(Ee){console.error("Error loading workout stats:",Ee)}finally{mn(!0)}})()},[n,t,x]);const er=()=>{const X=[];let Ee;M==="mix"?Ee=["core","upper","lower"]:M==="fullbody"?Ee=["upper","lower"]:Ee=[M];for(const se of N)for(const Ue of Ee)X.push(`exercises/${se}/${Ue}`);return X},Ts=async()=>{if(D.current){for(;D.current;)await new Promise(X=>setTimeout(X,200));return U.current}D.current=!0,S(!0);try{const X=er(),Ee=[];for(const ht of X)try{const _t=Do(Po,ht),Ot=await LT(_t);Ee.push(...Ot.items)}catch{console.warn(`Folder ${ht} not found, skipping.`)}if(Ee.length===0&&N.includes("bodyweight")&&M==="core")try{const ht=Do(Po,"core"),_t=await LT(ht);Ee.push(..._t.items)}catch{console.warn("Legacy core/ folder not found either.")}if(Ee.length===0){const ht=N.map(Ot=>UT.find(En=>En.key===Ot)?.label).join(" + "),_t=lb.find(Ot=>Ot.key===M)?.label;return pe(`No exercises found for ${ht} / ${_t}. Upload videos to Firebase Storage.`,"error"),D.current=!1,S(!1),[]}const se=new Set,Ue=Ee.filter(ht=>{const _t=ht.name.replace(/\.(mp4|gif)$/i,"");return se.has(_t)?!1:(se.add(_t),!0)}),We=await Promise.all(Ue.map(async ht=>{const _t=await Pl(ht),Ot=B5(ht.name.replace(/\.(mp4|gif)$/i,"")),En=/\.gif$/i.test(ht.name);return{name:Ot,videoUrl:_t,isGif:En}}));return U.current=We,we(We),D.current=!1,S(!1),We}catch(X){console.error("Error loading exercises:",X);const Ee=X.code==="storage/unauthorized"?"Storage access denied. Check Firebase Storage rules allow read access.":`Failed to load exercises: ${X.message||X.code||"Unknown error"}`;return pe(Ee,"error"),D.current=!1,S(!1),[]}},Ds=async()=>{if(be)return;T("spinning"),U.current=[];const X=await Ts();if(X.length===0){T("setup");return}const Ee=Bc.find(xs=>xs.key===Y);H(Ee);const se=Ee.work+Ee.rest,Ue=J*60,We=Math.floor(Ue/se);let ht,_t;We<=6?(ht=Math.max(3,Math.floor(We/2)),_t=Math.floor(We/ht)):We<=12?(ht=Math.min(6,Math.floor(We/2)),_t=Math.floor(We/ht)):(ht=Math.min(10,Math.floor(We/2)),_t=Math.floor(We/ht)),_t=Math.max(2,_t);const Ot=U5(X),En=Ot.slice(0,Math.min(ht,Ot.length));q(En),He(_t),setTimeout(()=>T("preview"),2e3)},ts=()=>{T("countdown"),gt(3)};_.useEffect(()=>{if(x!=="countdown")return;if(ut<=0){T("workout"),Ve(1),ne(0),K("work"),Re(xt.work),Me(!1),Gs();return}Yn();const X=setTimeout(()=>gt(Ee=>Ee-1),1e3);return()=>clearTimeout(X)},[ut,x]),_.useEffect(()=>{if(x!=="workout"||Ge)return;if(Te<=0){W();return}Te<=3&&Yn();const X=setTimeout(()=>Re(Ee=>Ee-1),1e3);return()=>clearTimeout(X)},[Te,x,Ge]);const W=()=>{if(O==="work")K("rest"),Re(xt.rest);else{const X=Ke+1;if(X>=V.length){const Ee=ye+1;if(Ee>L){T("complete"),fe();return}Ve(Ee),ne(0)}else ne(X);K("work"),Re(xt.work),Gs()}},fe=async()=>{if(n)try{await Ia(Wt(_e,"workoutLogs"),{clientId:t.id,level:Y,duration:J,equipment:N,focus:M,exerciseCount:V.length,rounds:L,exercises:V.map(X=>X.name),completedAt:mt.now()}),Dt(X=>X+1),rs(X=>X+1),Cn(X=>X+J),ke(X=>({...X,[Y]:(X[Y]||0)+1}))}catch(X){console.error("Error saving workout log:",X)}},k=async(X,Ee,se)=>{if(!(!t||!Ee))try{const Ue=t.id,We=await On(Qe(_e,"coreBuddyPBs",Ue)),_t=(We.exists()?We.data():null)?.exercises||{},Ot=_t[X];let En=!1;if(Ot?(Ee>(Ot.weight||0)||Ee===(Ot.weight||0)&&se>(Ot.reps||0))&&(En=!0):En=!0,En){const xs={..._t,[X]:{weight:Ee,reps:se,achievedAt:mt.now()}};await Gn(Qe(_e,"coreBuddyPBs",Ue),{clientId:t.id,exercises:xs,updatedAt:mt.now()}),pe(`New PB! ${Ee}kg  ${se} reps`,"success"),Yn(),await C(X,Ee)}}catch(Ue){console.error("Error checking PB:",Ue)}},C=async(X,Ee)=>{if(t)try{const se=await On(Qe(_e,"coreBuddyTargets",t.id));if(!se.exists())return;const We=(se.data().targets||{})[X];if(!We||Ee<We.targetWeight)return;const ht=await On(Qe(_e,"coreBuddyAchievements",t.id)),_t=ht.exists()?ht.data():{clientId:t.id,badges:[],totalVolume:0};if(_t.badges.some(vn=>vn.type==="pb_target"&&vn.exercise===X&&vn.targetWeight===We.targetWeight))return;const En={type:"pb_target",exercise:X,group:L5[X]||"push",targetWeight:We.targetWeight,achievedAt:mt.now()},xs=[..._t.badges,En];await Gn(Qe(_e,"coreBuddyAchievements",t.id),{..._t,badges:xs,updatedAt:mt.now()}),Qt(vn=>[...vn,En])}catch(se){console.error("Error checking target badge:",se)}},Q=async X=>{if(!(!t||X<=0))try{const Ee=await On(Qe(_e,"coreBuddyAchievements",t.id)),se=Ee.exists()?Ee.data():{clientId:t.id,badges:[],totalVolume:0},Ue=se.totalVolume||0,We=Ue+X,ht=[];M5.forEach(Ot=>{We>=Ot.threshold&&Ue<Ot.threshold&&(se.badges.some(xs=>xs.type==="volume_milestone"&&xs.milestone===Ot.threshold)||ht.push({type:"volume_milestone",milestone:Ot.threshold,label:Ot.label,achievedAt:mt.now()}))});const _t=[...se.badges,...ht];await Gn(Qe(_e,"coreBuddyAchievements",t.id),{clientId:t.id,badges:_t,totalVolume:Math.round(We),updatedAt:mt.now()}),ht.length>0&&Qt(Ot=>[...Ot,...ht])}catch(Ee){console.error("Error updating volume:",Ee)}},ae=async X=>{if(St(X),X.interval){const Ue=[];for(const We of X.exercises){let ht=null,_t=!1;if(We.storagePath)try{const Ot=Do(Po,We.storagePath);ht=await Pl(Ot),_t=/\.gif$/i.test(We.storagePath)}catch{}Ue.push({name:We.name,videoUrl:ht,isGif:_t})}q(Ue),He(X.rounds),H({work:X.work,rest:X.rest}),T("preview");return}const Ee={};for(const Ue of X.exercises)if(Ue.storagePath)try{const We=Do(Po,Ue.storagePath);Ee[Ue.name]={url:await Pl(We),isGif:/\.gif$/i.test(Ue.storagePath)}}catch{}ze(Ee);const se=X.exercises.map(Ue=>({name:Ue.name,type:Ue.type,targetSets:Ue.sets,targetReps:Ue.reps||0,targetTime:Ue.time||0,sets:[]}));un(se),it(0),Is(0),Kt(""),hn(""),Fe(!1),he(!1),Be(0),Qt([]),ve(null),T("muscle_workout")},Ye=()=>{const X=Tt.current;X&&(X.paused?(X.play(),Fe(!0)):(X.pause(),Fe(!1)))};_.useEffect(()=>{if(x!=="muscle_workout"||!Rn||De<=0){x==="muscle_workout"&&Rn&&De<=0&&(he(!1),Yn());return}return bt.current=setTimeout(()=>Be(X=>X-1),1e3),()=>clearTimeout(bt.current)},[x,Rn,De]);const $e=async()=>{const X=Ct[ct];let Ee={};if(X.type==="weighted"){const We=parseFloat(ds)||0,ht=parseInt(Pn)||0;if(ht===0){pe("Enter your reps","error");return}Ee={weight:We,reps:ht}}else if(X.type==="reps"){const We=parseInt(Pn)||0;if(We===0){pe("Enter your reps","error");return}Ee={reps:We}}else if(X.type==="timed"){const We=X.targetTime-De;Ee={time:Math.max(We,1)}}const se=[...Ct];se[ct]={...X,sets:[...X.sets,Ee]},un(se),X.type==="weighted"&&Ee.weight>0&&await k(X.name,Ee.weight,Ee.reps);const Ue=X.sets.length+1;if(Ue<X.targetSets)Is(Ue),hn(""),he(!1),Be(0);else if(ct+1<Ct.length){const We=ct+1;it(We),Is(0),Kt(""),hn(""),Fe(!1),he(!1),Be(0)}else await qe(se),T("muscle_complete")},qe=async X=>{if(!(!n||!t))try{const Ee=X.reduce((Ue,We)=>Ue+We.sets.reduce((ht,_t)=>ht+(_t.weight||0)*(_t.reps||0),0),0),se=X.reduce((Ue,We)=>Ue+We.sets.length,0);await Ia(Wt(_e,"workoutLogs"),{clientId:t.id,type:"muscle_group",muscleGroup:ln,sessionId:dt?.id,sessionName:dt?.name,exerciseCount:X.length,totalSets:se,duration:Math.round(se*1.5),volume:Math.round(Ee),exercises:X.map(Ue=>({name:Ue.name,type:Ue.type,sets:Ue.sets})),completedAt:mt.now()}),Ee>0&&await Q(Ee),It.length>0&&ve({badges:[...It]})}catch(Ee){console.error("Error saving muscle group workout log:",Ee)}},Gt=_.useRef(null),Mt=()=>(Gt.current||(Gt.current=new(window.AudioContext||window.webkitAudioContext)),Gt.current),Yn=()=>{try{const X=Mt(),Ee=X.createOscillator(),se=X.createGain();Ee.connect(se),se.connect(X.destination),Ee.frequency.value=880,se.gain.value=.3,Ee.start(X.currentTime),Ee.stop(X.currentTime+.15)}catch{}},Gs=()=>{try{const X=Mt(),Ee=X.createOscillator(),se=X.createGain();Ee.connect(se),se.connect(X.destination),Ee.frequency.value=1200,se.gain.value=.4,Ee.start(X.currentTime),Ee.stop(X.currentTime+.3)}catch{}};_.useEffect(()=>{if(x!=="workout"||O!=="work"||!V[Ke]?.isGif)return;const Ee=setInterval(()=>{const se=Dn.current;if(!se)return;const Ue=se.getAttribute("src");se.removeAttribute("src"),setTimeout(()=>{Dn.current&&Dn.current.setAttribute("src",Ue)},0)},4e3);return()=>clearInterval(Ee)},[x,O,Ke,ye,V]);const Bs=(X,Ee,se)=>{const Ue=Math.round(X/Ee*P5);return a.jsx("svg",{className:"wk-ring-svg",viewBox:"0 0 200 200",children:i5.map((We,ht)=>a.jsx("line",{x1:We.x1,y1:We.y1,x2:We.x2,y2:We.y2,className:ht<Ue?`wk-tick-filled ${se}`:"wk-tick-empty",strokeWidth:We.thick?"3":"2"},ht))})},qn=()=>{const X=V.length*L;return((ye-1)*V.length+Ke+(O==="rest"?.5:0))/X},$n=Vt&&a.jsx("div",{className:`toast-notification ${Vt.type}`,children:Vt.message});if(s)return a.jsxs("div",{className:"wk-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>b("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"wk-loading-inline",children:a.jsx("div",{className:"wk-loading-spinner"})})]});if(x==="menu")return a.jsxs("div",{className:"wk-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>b("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"wk-menu-heading",children:[a.jsx("h2",{children:"Choose Your Workout"}),a.jsx("p",{children:"No excuses. Just results."})]}),a.jsx("button",{className:"wk-hero-card",onClick:()=>T("setup"),children:a.jsx("img",{src:OT,alt:"Randomise Workout",className:"wk-hero-bg"})}),a.jsxs("div",{className:"wk-section-header",children:[a.jsxs("h2",{children:["Programmes ",!d&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),a.jsxs("span",{className:"wk-section-count",children:[ob.length," available"]})]}),d?a.jsx("div",{className:"wk-prog-scroll-wrap",children:a.jsx("div",{className:"wk-prog-scroll",children:ob.map((X,Ee)=>X.image?a.jsxs("button",{className:"wk-prog-img-card",onClick:()=>b("/client/core-buddy/programmes",{state:{templateId:X.id}}),style:{animationDelay:`${Ee*.06}s`},children:[a.jsx("img",{src:X.image,alt:X.name,className:"wk-prog-img"}),Ee===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},X.id):a.jsxs("button",{className:"wk-prog-hero-card",onClick:()=>b("/client/core-buddy/programmes",{state:{templateId:X.id}}),style:{animationDelay:`${Ee*.06}s`},children:[a.jsx("img",{src:C5,alt:"Programme",className:"wk-prog-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-prog-hero-overlay",style:{background:O5[X.focus]}}),a.jsxs("div",{className:"wk-prog-hero-content",children:[a.jsxs("div",{className:"wk-prog-hero-top",children:[a.jsxs("span",{className:"wk-prog-hero-badge",children:[X.duration," WEEKS"]}),a.jsx("span",{className:"wk-prog-hero-level",children:X.level})]}),a.jsxs("div",{className:"wk-prog-hero-bottom",children:[a.jsx("h3",{children:X.name.toUpperCase()}),a.jsxs("p",{children:[X.daysPerWeek,"x per week  ",X.focus==="fullbody"?"Full Body":X.focus.charAt(0).toUpperCase()+X.focus.slice(1)," Focus"]}),a.jsx("span",{className:"wk-prog-hero-go",children:"VIEW PROGRAMME "})]})]}),Ee===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},X.id))})}):a.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>b("/upgrade"),children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{children:"Upgrade to unlock programmes"})]}),a.jsxs("div",{className:"wk-section-header",children:[a.jsxs("h2",{children:["Muscle Groups ",!d&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),a.jsxs("span",{className:"wk-section-count",children:[Ah.length," groups"]})]}),d?a.jsx("div",{className:"wk-muscle-grid",children:Ah.map((X,Ee)=>a.jsx("button",{className:`wk-muscle-hero-card${X.image?" wk-muscle-thumb":""}`,onClick:()=>{sn(X.key),T("muscle_sessions")},style:{animationDelay:`${Ee*.05}s`},children:X.image?a.jsx("img",{src:X.image,alt:X.label,className:"wk-muscle-thumb-img"}):a.jsxs(a.Fragment,{children:[a.jsx("img",{src:OT,alt:"Muscle group",className:"wk-muscle-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-muscle-hero-overlay",style:{background:ab[X.key]}}),a.jsxs("div",{className:"wk-muscle-hero-content",children:[a.jsx("div",{className:"wk-muscle-hero-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:X.icon})})}),a.jsxs("div",{className:"wk-muscle-hero-text",children:[a.jsx("span",{className:"wk-muscle-hero-name",children:X.label}),a.jsxs("span",{className:"wk-muscle-hero-count",children:[BT[X.key]?.length||0," sessions"]})]})]})]})},X.key))}):a.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>b("/upgrade"),children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{children:"Upgrade to unlock muscle group workouts"})]})]}),a.jsx(oa,{active:"workouts"}),$n]});if(x==="setup"){const X=lb.find(se=>se.key===M)?.label||M,Ee=Bc.find(se=>se.key===Y)?.label||Y;return a.jsxs("div",{className:"wk-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>T("menu"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main wk-setup-main",children:[a.jsx("div",{className:"wk-stats-row",children:[{label:"Total",value:`${Mn}`,pct:Mn>0?Math.min(Math.round(Mn/100*100),100):0,color:"#14b8a6",size:"normal"},{label:"This Week",value:`${at}/${ib}`,pct:Math.round(Math.min(at,ib)/ib*100),color:"var(--color-primary)",size:"large"},{label:"Wk Streak",value:`${Bn}`,pct:Bn>0?Math.min(Math.round(Bn/12*100),100):0,color:"#38B6FF",size:"normal"}].map(se=>{const We=2*Math.PI*38,ht=We-se.pct/100*We;return a.jsxs("div",{className:`wk-stat-item${se.size==="large"?" wk-stat-large":""}`,children:[a.jsxs("div",{className:"wk-stat-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"wk-stat-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"wk-stat-fill",cx:"50",cy:"50",r:38,style:{stroke:se.color},strokeDasharray:We,strokeDashoffset:ht})]}),a.jsx("span",{className:"wk-stat-value",style:{color:se.color},children:se.value})]}),a.jsx("span",{className:"wk-stat-label",children:se.label})]},se.label)})}),a.jsxs("div",{className:"wk-setup-flow",children:[a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Focus Area"}),a.jsx("div",{className:"wk-focus-grid",children:lb.map(se=>a.jsxs("button",{className:`wk-equip-btn${M===se.key?" active":""}${se.key==="mix"?" wk-mix-btn":""}`,onClick:()=>P(se.key),children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:se.icon})}),a.jsx("span",{children:se.label})]},se.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Level"}),a.jsx("div",{className:"wk-level-cards",children:Bc.map(se=>a.jsxs("button",{className:`wk-level-card wk-level-${se.key}${Y===se.key?" active":""}`,onClick:()=>$(se.key),children:[a.jsx("span",{className:"wk-level-name",children:se.label}),a.jsx("span",{className:"wk-level-desc",children:se.desc})]},se.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Time"}),a.jsx("div",{className:"wk-time-options",children:cb.map(se=>{const Ue=!Se.includes(se);return a.jsxs("button",{className:`wk-time-btn${J===se?" active":""}${Ue?" locked":""}`,onClick:()=>!Ue&&de(se),disabled:Ue,children:[a.jsx("span",{className:"wk-time-num",children:se}),a.jsx("span",{className:"wk-time-unit",children:Ue?a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}):"min"})]},se)})})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Equipment"}),a.jsx("div",{className:"wk-equip-options",children:UT.map(se=>{const Ue=N.includes(se.key);return a.jsxs("button",{className:`wk-equip-btn${Ue?" active":""}`,onClick:()=>{B(We=>Ue&&We.length===1?We:Ue?We.filter(ht=>ht!==se.key):[...We,se.key])},children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:se.icon})}),a.jsx("span",{children:se.label})]},se.key)})})]}),a.jsx("div",{className:"wk-setup-summary",children:a.jsxs("span",{children:[X,"  ",Ee,"  ",J," min"]})})]})]}),a.jsxs("div",{className:"wk-go-sticky",children:[be&&a.jsx("p",{className:"wk-free-limit-msg",children:"You've used your free workout this week. Upgrade for unlimited access."}),a.jsx("button",{className:"wk-randomise-btn",onClick:Ds,disabled:A||be,children:A?"Loading exercises...":be?"Limit Reached":"Randomise Workout"})]}),$n]})}if(x==="spinning")return a.jsxs("div",{className:"wk-page wk-page-center","data-theme":o?"dark":"light","data-accent":u,children:[a.jsxs("div",{className:"wk-spin-container",children:[a.jsxs("div",{className:"wk-spin-ring",children:[a.jsx("svg",{className:"wk-spin-svg",viewBox:"0 0 200 200",children:Gh.map((X,Ee)=>a.jsx("line",{x1:X.x1,y1:X.y1,x2:X.x2,y2:X.y2,className:"wk-spin-tick",strokeWidth:X.thick?"3.5":"2",style:{animationDelay:`${Ee*.03}s`}},Ee))}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-spin-logo",width:"50",height:"50"})]}),a.jsx("p",{className:"wk-spin-text",children:"Generating workout..."})]}),$n]});if(x==="preview"){const X=dt?.interval?{work:dt.work,rest:dt.rest}:Bc.find(se=>se.key===Y),Ee=V.length*L*(X.work+X.rest);return a.jsxs("div",{className:"wk-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>T(dt?.interval?"muscle_sessions":"setup"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[dt?.interval&&a.jsx("h2",{className:"mg-preview-title",children:dt.name}),a.jsxs("div",{className:"wk-preview-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:V.length}),a.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:L}),a.jsx("span",{className:"wk-stat-label",children:"Rounds"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.ceil(Ee/60)}),a.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsxs("span",{className:"wk-stat-val",children:[X.work,"/",X.rest]}),a.jsx("span",{className:"wk-stat-label",children:"Work/Rest"})]})]}),a.jsx("div",{className:"wk-preview-list",children:V.map((se,Ue)=>a.jsxs("div",{className:"wk-preview-item",style:{animationDelay:`${Ue*.06}s`},onClick:()=>qt(se),children:[a.jsx("span",{className:"wk-preview-num",children:Ue+1}),a.jsx("div",{className:"wk-preview-thumb",children:se.isGif?a.jsx("img",{src:se.videoUrl,alt:se.name,loading:"lazy"}):a.jsx("video",{src:`${se.videoUrl}#t=0.1`,muted:!0,playsInline:!0,preload:"auto"})}),a.jsx("span",{className:"wk-preview-name",children:se.name}),a.jsx("svg",{className:"wk-preview-play",width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]},Ue))}),et&&a.jsx("div",{className:"wk-preview-modal-backdrop",onClick:()=>qt(null),children:a.jsxs("div",{className:"wk-preview-modal",onClick:se=>se.stopPropagation(),children:[a.jsx("button",{className:"wk-preview-modal-close",onClick:()=>qt(null),"aria-label":"Close preview",children:a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),a.jsx("div",{className:"wk-preview-modal-video",children:et.isGif?a.jsx("img",{src:et.videoUrl,alt:et.name}):a.jsx("video",{src:et.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}),a.jsx("h3",{className:"wk-preview-modal-title",children:et.name})]})}),a.jsxs("div",{className:"wk-preview-actions",children:[!dt?.interval&&a.jsxs("button",{className:"wk-btn-secondary",onClick:()=>Ds(),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"1 4 1 10 7 10"}),a.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),"Reshuffle"]}),a.jsx("button",{className:"wk-btn-primary",onClick:ts,children:"Start Workout"})]})]})]})}if(x==="countdown")return a.jsx("div",{className:"wk-page wk-page-center wk-page-dark","data-theme":o?"dark":"light","data-accent":u,children:a.jsxs("div",{className:"wk-countdown-big",children:[a.jsx("span",{className:"wk-countdown-num",children:ut}),a.jsx("span",{className:"wk-countdown-label",children:"GET READY"})]})});if(x==="workout"){const X=V[Ke],Ee=O==="work"?xt.work:xt.rest,se=O==="rest"?Ke+1<V.length?V[Ke+1]:ye<L?V[0]:null:null;return a.jsxs("div",{className:"wk-page wk-page-workout","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("div",{className:"wk-video-container",children:O==="work"?X.isGif?a.jsx("img",{ref:Dn,className:"wk-video",src:X.videoUrl,alt:X.name},X.videoUrl):a.jsx("video",{className:"wk-video",src:X.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0},X.videoUrl):a.jsxs("div",{className:"wk-rest-screen",children:[a.jsx("span",{className:"wk-rest-label",children:"REST"}),se&&a.jsxs("span",{className:"wk-next-label",children:["Next: ",se.name]})]})}),a.jsx("div",{className:"wk-back-row",children:a.jsxs("button",{className:"wk-back-btn",onClick:()=>{confirm("Leave workout?")&&T("menu")},children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]})}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"wk-exercise-info",children:[a.jsxs("span",{className:"wk-exercise-counter",children:[Ke+1," / ",V.length]}),a.jsx("h2",{className:"wk-exercise-name",children:X.name}),a.jsxs("span",{className:"wk-round-label",children:["Round ",ye," of ",L]})]}),a.jsx("div",{className:"wk-timer-section",children:a.jsxs("div",{className:"wk-timer-ring-wrap",children:[Bs(Te,Ee,O==="work"?"wk-tick-work":"wk-tick-rest"),a.jsxs("div",{className:"wk-timer-center",children:[a.jsx("span",{className:"wk-timer-time",children:Te}),a.jsx("span",{className:`wk-timer-phase ${O}`,children:O==="work"?"WORK":"REST"})]})]})}),a.jsxs("div",{className:"wk-controls",children:[a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-stop",onClick:()=>{confirm("End workout early?")&&T("menu")},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-pause",onClick:()=>Me(!Ge),children:Ge?a.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}):a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),a.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-skip",onClick:()=>{Re(0)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("polygon",{points:"5 4 15 12 5 20 5 4"}),a.jsx("rect",{x:"15",y:"4",width:"4",height:"16"})]})})]}),a.jsx("div",{className:"wk-progress-bar",children:a.jsx("div",{className:"wk-progress-fill",style:{width:`${qn()*100}%`}})})]})}if(x==="complete"){const X=Bc.find(se=>se.key===Y),Ee=V.length*L*(X.work+X.rest);return a.jsx("div",{className:"wk-page wk-page-center","data-theme":o?"dark":"light","data-accent":u,children:a.jsxs("div",{className:"wk-complete",children:[a.jsxs("div",{className:"wk-complete-ring",children:[a.jsx("svg",{className:"wk-complete-svg",viewBox:"0 0 200 200",children:Gh.map((se,Ue)=>a.jsx("line",{x1:se.x1,y1:se.y1,x2:se.x2,y2:se.y2,className:"wk-tick-complete",strokeWidth:se.thick?"3.5":"2",style:{animationDelay:`${Ue*.02}s`}},Ue))}),a.jsx("div",{className:"wk-complete-center",children:a.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})})})]}),a.jsx("h2",{className:"wk-complete-title",children:"Workout Complete!"}),a.jsxs("div",{className:"wk-complete-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.ceil(Ee/60)}),a.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:V.length*L}),a.jsx("span",{className:"wk-stat-label",children:"Intervals"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:L}),a.jsx("span",{className:"wk-stat-label",children:"Rounds"})]})]}),a.jsx("div",{className:"wk-complete-actions",children:a.jsx("button",{className:"wk-btn-primary",onClick:()=>{St(null),sn(null),T("menu")},children:"Done"})})]})})}if(x==="muscle_sessions"){const X=Ah.find(se=>se.key===ln),Ee=BT[ln]||[];return a.jsxs("div",{className:"wk-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>T("menu"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"mg-sessions-header",children:[a.jsx("div",{className:"mg-sessions-icon",style:{background:ab[ln]},children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:X?.icon})})}),a.jsxs("h2",{children:[X?.label," Workouts"]}),a.jsxs("p",{children:[Ee.length," sessions available"]})]}),a.jsx("div",{className:"mg-sessions-list",children:Ee.map((se,Ue)=>a.jsxs("button",{className:"mg-session-card",onClick:()=>{St(se),T("muscle_overview")},style:{animationDelay:`${Ue*.08}s`},children:[a.jsxs("div",{className:"mg-session-info",children:[a.jsx("h3",{children:se.name}),a.jsx("p",{children:se.desc}),a.jsx("div",{className:"mg-session-meta",children:se.interval?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-interval",children:"Interval"}),a.jsxs("span",{className:"mg-session-tag",children:[se.exercises.length," exercises"]}),a.jsxs("span",{className:"mg-session-tag",children:[se.rounds," rounds"]})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-strength",children:"Strength"}),a.jsxs("span",{className:"mg-session-tag",children:[se.exercises.length," exercises"]}),a.jsx("span",{className:"mg-session-tag",children:(()=>{const We=se.exercises.map(Ot=>Ot.sets||0),ht=Math.min(...We),_t=Math.max(...We);return ht===_t?`${ht} sets each`:`${ht}-${_t} sets each`})()})]})})]}),a.jsx("div",{className:"mg-session-arrow",children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},se.id))})]}),$n]})}if(x==="muscle_overview"){const X=dt;if(!X)return null;const Ee=Ah.find(se=>se.key===ln);return a.jsxs("div",{className:"wk-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>T("muscle_sessions"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main mg-overview-main",children:[a.jsx("div",{className:"mg-overview-hero",style:{background:ab[ln]},children:a.jsx("div",{className:"mg-overview-hero-content",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"mg-overview-hero-icon",children:a.jsx("path",{d:Ee?.icon})})})}),a.jsxs("div",{className:"mg-overview-header",children:[a.jsxs("div",{className:"mg-overview-title-row",children:[a.jsx("h2",{children:X.name}),X.level&&a.jsx("span",{className:"mg-overview-level",children:X.level})]}),a.jsx("p",{className:"mg-overview-desc",children:X.desc})]}),X.overview&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"About This Workout"]}),a.jsx("p",{children:X.overview})]}),X.tips&&X.tips.length>0&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Tips & Form"]}),a.jsx("ul",{className:"mg-overview-tips",children:X.tips.map((se,Ue)=>a.jsx("li",{children:se},Ue))})]}),a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"}),a.jsx("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),a.jsx("path",{d:"M9 14l2 2 4-4"})]}),"Exercises (",X.exercises.length,")"]}),a.jsx("div",{className:"mg-overview-exercises",children:X.exercises.map((se,Ue)=>a.jsxs("div",{className:"mg-overview-exercise",children:[a.jsx("span",{className:"mg-overview-ex-num",children:Ue+1}),a.jsxs("div",{className:"mg-overview-ex-info",children:[a.jsx("span",{className:"mg-overview-ex-name",children:se.name}),X.interval?a.jsxs("span",{className:"mg-overview-ex-detail",children:[X.work,"s work / ",X.rest,"s rest"]}):a.jsxs("span",{className:"mg-overview-ex-detail",children:[se.sets," sets  ",se.reps?`${se.reps} reps`:`${se.time}s`,se.type==="weighted"&&"  weighted"]})]})]},Ue))})]}),a.jsxs("button",{className:"mg-overview-start-btn",onClick:()=>ae(X),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Workout"]})]}),$n]})}if(x==="muscle_workout"){const X=dt;if(!X)return null;const Ee=X.exercises[ct],se=Ct[ct];if(!Ee||!se)return null;const Ue=se.sets.length,We=X.exercises.length,ht=X.exercises.reduce((vn,lr)=>vn+(lr.sets||0),0),Ot=Ct.reduce((vn,lr)=>vn+lr.sets.length,0)/ht*100,En=Le[Ee.name];Ee.type==="timed"&&De===0&&!Rn&&Ue===Jt&&setTimeout(()=>Be(Ee.time),0);const xs=Ue+1<Ee.sets?"Log Set":ct+1<We?"Log Set  Next Exercise":"Log Set  Complete";return a.jsxs("div",{className:"wk-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("div",{className:"mg-session-progress",children:a.jsx("div",{className:"mg-session-progress-fill",style:{width:`${Ot}%`}})}),a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>{confirm("End workout early?")&&T("muscle_overview")},"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsxs("span",{className:"mg-header-info",children:["Exercise ",ct+1,"/",We]}),a.jsx("div",{style:{width:22}})]})}),a.jsxs("main",{className:"wk-main",children:[En?a.jsxs("div",{className:"mg-video-container",onClick:Ye,children:[En.isGif?a.jsx("img",{className:"mg-video",src:En.url,alt:Ee.name}):a.jsx("video",{ref:Tt,className:"mg-video",src:En.url,loop:!0,muted:!0,playsInline:!0},Ee.name),!tt&&!En.isGif&&a.jsxs("div",{className:"mg-video-overlay",children:[a.jsx("svg",{className:"mg-play-icon",width:"48",height:"48",viewBox:"0 0 24 24",fill:"rgba(255,255,255,0.9)",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),a.jsx("span",{className:"mg-video-hint",children:"Tap for demo"})]})]}):a.jsxs("div",{className:"mg-video-placeholder",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.4",children:[a.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),a.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),a.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),a.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),a.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),a.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),a.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),a.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"})]}),a.jsx("span",{children:"Video coming soon"})]}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"mg-exercise-card",children:[a.jsx("h2",{className:"mg-ex-name",children:Ee.name}),a.jsx("span",{className:`mg-ex-type-badge ${Ee.type}`,children:Ee.type==="weighted"?"Weight + Reps":Ee.type==="reps"?"Reps Only":"Timed"}),a.jsxs("div",{className:"mg-ex-set-info",children:[a.jsxs("span",{className:"mg-ex-set-num",children:["Set ",Ue+1," of ",Ee.sets]}),Ee.type!=="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",Ee.reps," reps"]}),Ee.type==="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",Ee.time,"s"]})]}),Ee.type==="weighted"&&a.jsxs("div",{className:"mg-input-area",children:[a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",className:"mg-input",value:ds,onChange:vn=>Kt(vn.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Pn,onChange:vn=>hn(vn.target.value),placeholder:"0"})]})]}),Ee.type==="reps"&&a.jsx("div",{className:"mg-input-area",children:a.jsxs("div",{className:"mg-input-group mg-input-single",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Pn,onChange:vn=>hn(vn.target.value),placeholder:"0"})]})}),Ee.type==="timed"&&a.jsxs("div",{className:"mg-timer-area",children:[a.jsx("div",{className:"mg-timer-display",children:a.jsxs("span",{className:"mg-timer-value",children:[De,"s"]})}),Rn?a.jsx("button",{className:"mg-timer-btn mg-timer-stop",onClick:()=>he(!1),children:"Stop"}):a.jsx("button",{className:"mg-timer-btn",onClick:()=>{De===0&&Be(Ee.time),he(!0)},children:De<Ee.time&&De>0?"Resume":"Start Timer"})]}),a.jsx("button",{className:"mg-log-set-btn",onClick:$e,children:xs}),se.sets.length>0&&a.jsx("div",{className:"mg-completed-sets",children:se.sets.map((vn,lr)=>a.jsxs("div",{className:"mg-completed-set",children:[a.jsx("span",{className:"mg-completed-set-check",children:""}),a.jsxs("span",{children:["Set ",lr+1,": ",vn.weight!=null?`${vn.weight}kg  ${vn.reps}`:vn.reps!=null?`${vn.reps} reps`:`${vn.time}s`]})]},lr))})]})]}),$n]})}if(x==="muscle_complete"){const X=Ct.reduce((Ue,We)=>Ue+We.sets.length,0),Ee=Ct.reduce((Ue,We)=>Ue+We.sets.reduce((ht,_t)=>ht+(_t.weight||0)*(_t.reps||0),0),0),se=Ah.find(Ue=>Ue.key===ln)?.label||"";return a.jsxs("div",{className:"wk-page wk-page-center","data-theme":o?"dark":"light","data-accent":u,children:[a.jsxs("div",{className:"wk-complete",children:[a.jsxs("div",{className:"wk-complete-ring",children:[a.jsx("svg",{className:"wk-complete-svg",viewBox:"0 0 200 200",children:Gh.map((Ue,We)=>a.jsx("line",{x1:Ue.x1,y1:Ue.y1,x2:Ue.x2,y2:Ue.y2,className:"wk-tick-complete",strokeWidth:Ue.thick?"3.5":"2",style:{animationDelay:`${We*.02}s`}},We))}),a.jsx("div",{className:"wk-complete-center",children:a.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})})})]}),a.jsxs("h2",{className:"wk-complete-title",children:[se," Complete!"]}),a.jsx("p",{className:"mg-complete-session-name",children:dt?.name}),a.jsxs("div",{className:"wk-complete-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Ct.length}),a.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:X}),a.jsx("span",{className:"wk-stat-label",children:"Sets"})]}),Ee>0&&a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.round(Ee).toLocaleString()}),a.jsx("span",{className:"wk-stat-label",children:"Volume (kg)"})]})]}),a.jsx("div",{className:"wk-complete-actions",children:a.jsx("button",{className:"wk-btn-primary",onClick:()=>{St(null),sn(null),ve(null),T("menu")},children:"Done"})})]}),ee&&a.jsx("div",{className:"mg-badge-celebration",onClick:()=>ve(null),children:a.jsxs("div",{className:"mg-badge-celebration-card",children:[a.jsx("div",{className:"mg-badge-celebration-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",width:"48",height:"48",fill:"#ffc107",children:a.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})}),a.jsx("h3",{className:"mg-badge-celebration-title",children:ee.badges.length===1?"Badge Earned!":`${ee.badges.length} Badges Earned!`}),a.jsx("div",{className:"mg-badge-celebration-list",children:ee.badges.map((Ue,We)=>a.jsx("div",{className:"mg-badge-celebration-item",children:Ue.type==="pb_target"?`${Ue.exercise}  ${Ue.targetWeight}kg`:Ue.label},We))}),a.jsx("button",{className:"mg-badge-celebration-dismiss",children:"Tap to dismiss"})]})})]})}return null}const z5=60,q5={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},$5=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],FT=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,daysPerWeek:3,level:"All Levels",description:"Build total body strength with compound dumbbell movements and bodyweight finishers",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push Focus",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Goblet Squats",type:"weighted",sets:3,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull Focus",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:3,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:3,baseReps:10,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Reverse Lunge",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Legs & Core",exercises:[{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Box Step Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,daysPerWeek:3,level:"Intermediate",description:"Two-phase programme building strength and endurance across your full body",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Power",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"}]},{name:"Day 3",label:"Endurance",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,daysPerWeek:3,level:"Advanced",description:"Complete transformation programme: push, pull, and legs over three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Upper Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Lower Body",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 3",label:"Upper Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,daysPerWeek:3,level:"Beginner",description:"Build a solid core foundation with targeted ab and stability work",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Abs",exercises:[{name:"Crunch",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Stability",exercises:[{name:"Dead Bug",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Bird Dog",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:20,storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"}]},{name:"Day 3",label:"Power Core",exercises:[{name:"Single Leg V-Up",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Toe Reaches",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Russian Twists Dumbbell",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Fast Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,daysPerWeek:3,level:"Intermediate",description:"Develop deep core strength and rotational power over two phases",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Anti-Extension",exercises:[{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Dead Bug",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Plank Walkout",type:"reps",sets:3,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"}]},{name:"Day 2",label:"Rotation",exercises:[{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank Rotation",type:"reps",sets:2,baseReps:10,storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",sets:3,baseReps:10,storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,daysPerWeek:3,level:"Advanced",description:"Ultimate core transformation: stability, strength, and power across three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Forearm Plank",type:"timed",sets:4,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Plank Walkout",type:"reps",sets:4,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Leg Raises",type:"reps",sets:4,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Kettlebell Side Bends",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 2",label:"Endurance",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:4,baseReps:15,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Hollow Hold To V-Sit",type:"reps",sets:4,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Hip Dips Plank",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,daysPerWeek:3,level:"Intermediate",description:"Sculpt and strengthen your chest, back, shoulders, and arms",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Tricep Dips",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Reverse Plank",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/upper/reverse plank.GIF"}]},{name:"Day 3",label:"Mixed",exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Renegade Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Superman Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Superman Hold.mp4"}]}]},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,daysPerWeek:3,level:"Intermediate",description:"Build powerful legs and glutes with squats, deadlifts, and plyometrics",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Quad Dominant",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Squat And Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/lower/squat and hold.GIF"}]},{name:"Day 2",label:"Hamstring & Glute",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"1 Legged RDL",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Hip Thrusts",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Donkey Kicks",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 3",label:"Power & Stability",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Skater Jumps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]}];function tm(n,e,t){const s=n.baseReps?n.baseReps+(e-1)*(t.repProg||0):void 0,o=n.baseTime?n.baseTime+(e-1)*(t.timeProg||0):void 0;return{sets:n.sets,reps:s,time:o}}const H5={fullbody:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z",core:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",upper:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",lower:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"};function W5(){const{currentUser:n,isClient:e,clientData:t,loading:s}=li(),{isDark:o,toggleTheme:c,accent:u}=Bi(),d=gr(),p=Oi(),[g,b]=_.useState("loading"),[x,T]=_.useState(null),N=_.useRef(!1),[B,M]=_.useState(null),[P,Y]=_.useState(1),[$,J]=_.useState(0),[de,Ne]=_.useState(0),[we,A]=_.useState(0),[S,D]=_.useState([]),[U,V]=_.useState(""),[q,L]=_.useState(""),[He,xt]=_.useState(!1),[H,ye]=_.useState(0),Ve=_.useRef(null),[Ke,ne]=_.useState({}),[O,K]=_.useState(!1),Te=_.useRef(null),[Re,Ge]=_.useState(null),[Me,ut]=_.useState([]);_.useEffect(()=>{window.scrollTo(0,0)},[g]);const[gt,et]=_.useState(null),qt=_.useCallback((he,De="info")=>{et({message:he,type:De}),setTimeout(()=>et(null),4e3)},[]),Dn=_.useRef(null),Vt=()=>(Dn.current||(Dn.current=new(window.AudioContext||window.webkitAudioContext)),Dn.current),kt=()=>{try{const he=Vt(),De=he.createOscillator(),Be=he.createGain();De.connect(Be),Be.connect(he.destination),De.frequency.value=1200,Be.gain.value=.4,De.start(he.currentTime),De.stop(he.currentTime+.3)}catch{}};_.useEffect(()=>{!s&&(!n||!e)&&d("/")},[n,e,s,d]),_.useEffect(()=>{if(!t)return;(async()=>{try{const De=Qe(_e,"clientProgrammes",t.id),Be=await On(De);Be.exists()&&M(Be.data());const tt=p.state?.templateId;if(tt&&!N.current){const Fe=FT.find(Le=>Le.id===tt);if(Fe){N.current=!0,T(Fe),b("overview");return}}Be.exists()?b("dashboard"):d("/client/core-buddy/workouts",{replace:!0})}catch(De){console.error("Error loading programme:",De),d("/client/core-buddy/workouts",{replace:!0})}})()},[t]),_.useEffect(()=>{if(!He||H<=0){He&&H<=0&&(xt(!1),kt());return}return Ve.current=setTimeout(()=>ye(he=>he-1),1e3),()=>clearTimeout(Ve.current)},[He,H]);const pe=async he=>{if(t)try{await Gn(Qe(_e,"clientProgrammes",t.id),he),M(he)}catch(De){console.error("Error saving programme:",De),qt("Failed to save. Check Firestore rules for clientProgrammes.","error")}},ln=async he=>{const De={templateId:he.id,startDate:mt.now(),completedSessions:{}};await pe(De),b("dashboard")},sn=async()=>{if(t)try{await Cr(Qe(_e,"clientProgrammes",t.id)),M(null),b("browse")}catch(he){console.error("Error quitting programme:",he)}},dt=()=>B?FT.find(he=>he.id===B.templateId):null,St=()=>{if(!B?.startDate)return 1;const he=B.startDate.toDate?B.startDate.toDate():new Date(B.startDate),Be=new Date-he,tt=Math.floor(Be/(1e3*60*60*24));return Math.floor(tt/7)+1},ct=()=>{if(!B)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const he=B.completedSessions||{},De=Object.keys(he).length,Be=dt();if(!Be)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const tt=Be.duration*Be.daysPerWeek,Fe=St(),Le=Math.min(Fe,Be.duration);let ze=0;for(let bt=0;bt<Be.daysPerWeek;bt++)he[`w${Le}d${bt}`]&&ze++;if(De>=tt)return{currentWeek:Be.duration,completedThisWeek:Be.daysPerWeek,nextDay:-1,totalCompleted:De,totalSessions:tt,complete:!0};if(Fe>Be.duration)return{currentWeek:Be.duration,completedThisWeek:ze,nextDay:-1,totalCompleted:De,totalSessions:tt,complete:!0};let Tt=-1;for(let bt=0;bt<Be.daysPerWeek;bt++)if(!he[`w${Le}d${bt}`]){Tt=bt;break}return{currentWeek:Le,completedThisWeek:ze,nextDay:Tt,nextWeek:Le,totalCompleted:De,totalSessions:tt}},it=he=>{const De=St();return he<De},Jt=(he,De,Be)=>{if(!B||he<=1)return null;const tt=`w${he-1}d${De}`,Fe=B.completedSessions?.[tt];if(!Fe)return null;const Le=Fe.exercises?.find(ze=>ze.name===Be);return Le?.sets?.length?Le.sets[Le.sets.length-1]:null},Is=(he,De)=>{const Be=dt();if(!Be)return;Y(he),J(De),Ne(0),A(0),D([]),L(""),xt(!1),ye(0),K(!1),ne({});const tt=Be.days[De],Fe=tt.exercises.map(bt=>{const It=tm(bt,he,Be);return{name:bt.name,type:bt.type,pbKey:bt.pbKey,targetSets:It.sets,targetReps:It.reps,targetTime:It.time,sets:[]}});D(Fe);const Le=tt.exercises[0],ze=Jt(he,De,Le.name);ze?.weight&&Le.type==="weighted"?V(String(ze.weight)):V(""),(async()=>{const bt={};for(const It of tt.exercises)if(It.storagePath)try{const Qt=Do(Po,It.storagePath),ee=await Pl(Qt);bt[It.name]={url:ee,isGif:/\.gif$/i.test(It.storagePath)}}catch(Qt){console.warn(`Video not found for ${It.name}:`,Qt)}ne(bt)})(),b("session")},Ct=async()=>{dt();const he=S[de];if(!he)return;let De={};if(he.type==="weighted"){const Fe=parseFloat(U)||0,Le=parseInt(q)||0;if(Le===0){qt("Enter your reps","error");return}De={weight:Fe,reps:Le}}else if(he.type==="reps"){const Fe=parseInt(q)||0;if(Fe===0){qt("Enter your reps","error");return}De={reps:Fe}}else if(he.type==="timed"){const Fe=he.targetTime-H;De={time:Math.max(Fe,1)}}const Be=[...S];Be[de]={...he,sets:[...he.sets,De]},D(Be),he.type==="weighted"&&De.weight>0&&await Kt(he.name,De.weight,De.reps);const tt=he.sets.length+1;if(tt<he.targetSets)A(tt),V(De.weight?String(De.weight):""),L(""),xt(!1),ye(0);else if(de+1<S.length){const Fe=de+1;Ne(Fe),A(0),K(!1);const ze=dt()?.days[$]?.exercises[Fe],Tt=Jt(P,$,ze?.name);Tt?.weight&&ze?.type==="weighted"?V(String(Tt.weight)):V(""),L(""),xt(!1),ye(0)}else await un(Be)},un=async he=>{if(!B||!t)return;const De=`w${P}d${$}`,Be={...B.completedSessions,[De]:{completedAt:new Date().toISOString(),exercises:he.map(Le=>({name:Le.name,type:Le.type,sets:Le.sets}))}},tt={...B,completedSessions:Be};await pe(tt);const Fe=he.reduce((Le,ze)=>Le+ze.sets.reduce((Tt,bt)=>Tt+(bt.weight||0)*(bt.reps||0),0),0);Fe>0&&await ds(Fe);try{const Le=dt();await Ia(Wt(_e,"workoutLogs"),{clientId:t.id,type:"programme",programmeId:Le?.id,programmeName:Le?.name,week:P,day:$+1,exerciseCount:he.length,duration:Math.round(he.reduce((ze,Tt)=>ze+Tt.sets.length*1.5,0)),volume:Math.round(Fe),completedAt:mt.now()})}catch(Le){console.error("Error saving workout log:",Le)}Me.length>0&&(Ge({badges:[...Me]}),ut([])),b("sessionComplete")},ds=async he=>{if(t)try{const De=await On(Qe(_e,"coreBuddyAchievements",t.id)),Be=De.exists()?De.data():{clientId:t.id,badges:[],totalVolume:0},tt=Be.totalVolume||0,Fe=tt+he,Le=[];$5.forEach(Tt=>{Fe>=Tt.threshold&&tt<Tt.threshold&&(Be.badges.some(It=>It.type==="volume_milestone"&&It.milestone===Tt.threshold)||Le.push({type:"volume_milestone",milestone:Tt.threshold,label:Tt.label,achievedAt:mt.now()}))});const ze=[...Be.badges,...Le];await Gn(Qe(_e,"coreBuddyAchievements",t.id),{clientId:t.id,badges:ze,totalVolume:Math.round(Fe),updatedAt:mt.now()}),Le.length>0&&ut(Tt=>[...Tt,...Le])}catch(De){console.error("Error updating volume:",De)}},Kt=async(he,De,Be)=>{if(t)try{const tt=t.id,Fe=await On(Qe(_e,"coreBuddyPBs",tt)),ze=(Fe.exists()?Fe.data():null)?.exercises||{},Tt=ze[he];let bt=!1;if(Tt?(De>(Tt.weight||0)||De===(Tt.weight||0)&&Be>(Tt.reps||0))&&(bt=!0):bt=!0,bt){const It={...ze,[he]:{weight:De,reps:Be,achievedAt:mt.now()}};await Gn(Qe(_e,"coreBuddyPBs",tt),{clientId:t.id,exercises:It,updatedAt:mt.now()}),qt(`New PB! ${De}kg  ${Be} reps`,"success"),kt(),await Pn(he,De)}}catch(tt){console.error("Error checking PB:",tt)}},Pn=async(he,De)=>{if(t)try{const Be=await On(Qe(_e,"coreBuddyTargets",t.id));if(!Be.exists())return;const Fe=(Be.data().targets||{})[he];if(!Fe||De<Fe.targetWeight)return;const Le=await On(Qe(_e,"coreBuddyAchievements",t.id)),ze=Le.exists()?Le.data():{clientId:t.id,badges:[],totalVolume:0};if(ze.badges.some(Qt=>Qt.type==="pb_target"&&Qt.exercise===he&&Qt.targetWeight===Fe.targetWeight))return;const bt={type:"pb_target",exercise:he,group:q5[he]||"push",targetWeight:Fe.targetWeight,achievedAt:mt.now()},It=[...ze.badges,bt];await Gn(Qe(_e,"coreBuddyAchievements",t.id),{...ze,badges:It,updatedAt:mt.now()}),ut(Qt=>[...Qt,bt])}catch(Be){console.error("Error checking target badge:",Be)}},hn=gt&&a.jsxs("div",{className:`toast-notification ${gt.type}`,children:[gt.type==="success"&&a.jsx("span",{children:" "}),gt.message]}),Rn=(he,De)=>a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:De,"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})});if(s||g==="loading")return a.jsx("div",{className:"cb-loading",children:a.jsx("div",{className:"cb-loading-spinner"})});if(g==="browse")return d("/client/core-buddy/workouts",{replace:!0}),null;if(g==="overview"&&x){const he=x;return a.jsxs("div",{className:"pg-page","data-theme":o?"dark":"light","data-accent":u,children:[Rn(he.name,()=>d("/client/core-buddy/workouts")),a.jsxs("main",{className:"pg-main",children:[a.jsxs("div",{className:"pg-overview-hero",children:[a.jsx("svg",{className:"pg-overview-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:H5[he.focus]})}),a.jsx("h2",{className:"pg-overview-name",children:he.name}),a.jsx("p",{className:"pg-overview-desc",children:he.description}),a.jsxs("div",{className:"pg-overview-stats",children:[a.jsxs("div",{className:"pg-ov-stat",children:[a.jsx("span",{className:"pg-ov-stat-num",children:he.duration}),a.jsx("span",{className:"pg-ov-stat-label",children:"Weeks"})]}),a.jsxs("div",{className:"pg-ov-stat",children:[a.jsx("span",{className:"pg-ov-stat-num",children:he.daysPerWeek}),a.jsx("span",{className:"pg-ov-stat-label",children:"Days/Week"})]}),a.jsxs("div",{className:"pg-ov-stat",children:[a.jsx("span",{className:"pg-ov-stat-num",children:he.duration*he.daysPerWeek}),a.jsx("span",{className:"pg-ov-stat-label",children:"Sessions"})]})]})]}),a.jsx("div",{className:"pg-overview-days",children:he.days.map((De,Be)=>a.jsxs("div",{className:"pg-day-card",children:[a.jsxs("div",{className:"pg-day-header",children:[a.jsx("span",{className:"pg-day-name",children:De.name}),a.jsx("span",{className:"pg-day-label",children:De.label})]}),a.jsx("div",{className:"pg-day-exercises",children:De.exercises.map((tt,Fe)=>{const Le=tm(tt,1,he);return a.jsxs("div",{className:"pg-day-ex",children:[a.jsx("span",{className:"pg-day-ex-name",children:tt.name}),a.jsx("span",{className:"pg-day-ex-target",children:tt.type==="timed"?`${Le.sets}${Le.time}s`:`${Le.sets}${Le.reps}`}),a.jsx("span",{className:`pg-day-ex-badge pg-badge-${tt.type}`,children:tt.type==="weighted"?"WT":tt.type==="timed"?"TMR":"BW"})]},Fe)})})]},Be))}),a.jsxs("div",{className:"pg-overview-note",children:[a.jsx("strong",{children:"Progressive Overload:"})," +",he.repProg," reps/week",he.timeProg?`, +${he.timeProg}s/week for timed`:""]}),a.jsx("button",{className:"pg-start-btn",onClick:()=>ln(he),children:"Start Programme"})]}),hn]})}if(g==="dashboard"){const he=dt();if(!he)return b("browse"),null;const De=ct(),Be=B?.completedSessions||{},tt=De.totalSessions?Math.round(De.totalCompleted/De.totalSessions*100):0;return Math.round(De.totalCompleted/(De.totalSessions||1)*z5),a.jsxs("div",{className:"pg-page","data-theme":o?"dark":"light","data-accent":u,children:[Rn("Programme",()=>d("/client/core-buddy/workouts")),a.jsxs("main",{className:"pg-main",children:[a.jsxs("div",{className:"pg-dash-hero",children:[a.jsxs("div",{className:"pg-dash-ring-wrap",children:[a.jsxs("svg",{viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"pg-arc-track",cx:"100",cy:"100",r:"80"}),a.jsx("circle",{className:"pg-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-tt/100*2*Math.PI*80})]}),a.jsxs("div",{className:"pg-ring-center",children:[a.jsxs("span",{className:"pg-ring-pct",children:[tt,"%"]}),a.jsx("span",{className:"pg-ring-label",children:"complete"})]})]}),a.jsx("h2",{className:"pg-dash-name",children:he.name}),a.jsxs("div",{className:"pg-dash-progress-text",children:[a.jsxs("span",{className:"pg-dash-pct",children:[tt,"%"]}),a.jsxs("span",{className:"pg-dash-week",children:["Week ",De.currentWeek," of ",he.duration]})]})]}),a.jsx("div",{className:"pg-weeks",children:Array.from({length:he.duration},(Fe,Le)=>{const ze=Le+1,Tt=it(ze);return a.jsxs("div",{className:`pg-week-row${ze===De.currentWeek?" pg-week-current":""}`,children:[a.jsxs("span",{className:"pg-week-label",children:["W",ze]}),a.jsx("div",{className:"pg-week-days",children:he.days.map((bt,It)=>{const Qt=`w${ze}d${It}`,ee=!!Be[Qt],ve=!ee&&Tt,at=!ee&&!ve&&ze===De.currentWeek&&!De.complete;return a.jsx("button",{className:`pg-day-dot${ee?" done":""}${ve?" missed":""}${at?" next":""}`,disabled:!at,onClick:()=>{at&&Is(ze,It)},children:ee?a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}):ve?a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsx("span",{children:bt.name.replace("Day ","")})},It)})})]},Le)})}),!De.complete&&(()=>{const Fe=he.days.map((Le,ze)=>({day:Le,d:ze})).filter(({d:Le})=>!Be[`w${De.currentWeek}d${Le}`]);return Fe.length===0?null:a.jsxs("div",{className:"pg-next-session",children:[a.jsx("h3",{children:Fe.length===he.daysPerWeek?"Choose a Session":"Remaining Sessions"}),a.jsxs("p",{className:"pg-next-info",children:["Week ",De.currentWeek,"  ",Fe.length," session",Fe.length!==1?"s":""," left this week"]}),Fe.map(({day:Le,d:ze})=>a.jsxs("div",{className:"pg-available-session",children:[a.jsxs("div",{className:"pg-next-exercises",children:[a.jsxs("span",{className:"pg-avail-day-label",children:[Le.name,": ",Le.label]}),Le.exercises.map((Tt,bt)=>{const It=tm(Tt,De.currentWeek,he);return a.jsxs("div",{className:"pg-next-ex",children:[a.jsx("span",{className:"pg-next-ex-name",children:Tt.name}),a.jsx("span",{className:"pg-next-ex-target",children:Tt.type==="timed"?`${It.sets}${It.time}s`:`${It.sets}${It.reps}`})]},bt)})]}),a.jsxs("button",{className:"pg-start-btn",onClick:()=>Is(De.currentWeek,ze),children:["Start ",Le.name]})]},ze))]})})(),De.complete&&a.jsxs("div",{className:"pg-complete-msg",children:[a.jsx("h3",{children:"Programme Complete! "}),a.jsxs("p",{children:["You finished all ",De.totalSessions," sessions."]}),a.jsx("button",{className:"pg-start-btn",onClick:sn,children:"Choose New Programme"})]}),a.jsx("button",{className:"pg-quit-btn",onClick:()=>{confirm("Quit this programme? Progress will be lost.")&&sn()},children:"Quit Programme"})]}),a.jsx(oa,{active:"workouts"}),hn]})}if(g==="session"){const he=dt();if(!he)return null;const De=he.days[$],Be=De.exercises[de],tt=tm(Be,P,he),Fe=S[de],Le=Fe?.sets?.length||0,ze=De.exercises.length,Tt=(de+Le/tt.sets)/ze,bt=Ke[Be.name],It=Jt(P,$,Be.name);Be.type==="timed"&&H===0&&!He&&Le===we&&setTimeout(()=>ye(tt.time),0);const Qt=()=>{bt?.isGif?K(!O):Te.current&&(O?Te.current.pause():Te.current.play(),K(!O))};return a.jsxs("div",{className:"pg-page pg-page-session","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("div",{className:"pg-session-progress",children:a.jsx("div",{className:"pg-session-progress-fill",style:{width:`${Tt*100}%`}})}),a.jsxs("div",{className:"pg-session-header",children:[a.jsx("button",{className:"pg-session-back",onClick:()=>{confirm("Leave session? Progress will be lost.")&&b("dashboard")},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M19 12H5M12 5l-7 7 7 7"})})}),a.jsxs("div",{className:"pg-session-title",children:[a.jsxs("span",{className:"pg-session-counter",children:[de+1," / ",ze]}),a.jsxs("span",{className:"pg-session-week",children:["Week ",P,"  ",De.name]})]})]}),bt&&a.jsxs("div",{className:"pg-video-container",onClick:Qt,children:[bt.isGif?a.jsx("img",{className:"pg-video",src:bt.url,alt:Be.name}):a.jsx("video",{ref:Te,className:"pg-video",src:bt.url,loop:!0,muted:!0,playsInline:!0},Be.name),!O&&a.jsxs("div",{className:"pg-video-overlay",children:[a.jsx("svg",{className:"pg-play-icon",viewBox:"0 0 24 24",fill:"white",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),a.jsx("span",{className:"pg-video-hint",children:"Tap for demo"})]})]}),a.jsx("div",{className:"pg-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"pg-exercise-card",children:[a.jsx("h2",{className:"pg-ex-name",children:Be.name}),a.jsx("span",{className:`pg-ex-type-badge pg-badge-${Be.type}`,children:Be.type==="weighted"?"Weight + Reps":Be.type==="timed"?"Timed":"Reps Only"}),Be.type==="weighted"&&It&&a.jsxs("div",{className:"pg-last-week",children:[a.jsx("span",{className:"pg-last-week-label",children:"Last week:"}),a.jsxs("span",{className:"pg-last-week-value",children:[It.weight,"kg x ",It.reps," reps"]})]}),a.jsxs("div",{className:"pg-ex-set-info",children:[a.jsxs("span",{className:"pg-ex-set-num",children:["Set ",Le+1," of ",tt.sets]}),a.jsxs("span",{className:"pg-ex-target",children:["Target: ",Be.type==="timed"?`${tt.time}s hold`:`${tt.reps} reps`]})]}),Be.type==="weighted"&&a.jsxs("div",{className:"pg-input-area",children:[a.jsxs("div",{className:"pg-input-group",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",value:U,onChange:ee=>V(ee.target.value),placeholder:"0",className:"pg-input"})]}),a.jsxs("div",{className:"pg-input-group",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",value:q,onChange:ee=>L(ee.target.value),placeholder:String(tt.reps),className:"pg-input"})]})]}),Be.type==="reps"&&a.jsx("div",{className:"pg-input-area",children:a.jsxs("div",{className:"pg-input-group pg-input-single",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",value:q,onChange:ee=>L(ee.target.value),placeholder:String(tt.reps),className:"pg-input"})]})}),Be.type==="timed"&&a.jsxs("div",{className:"pg-timer-area",children:[a.jsx("div",{className:"pg-timer-display",children:a.jsxs("span",{className:"pg-timer-value",children:[H,"s"]})}),He?a.jsx("button",{className:"pg-timer-btn pg-timer-stop",onClick:()=>xt(!1),children:"Stop"}):a.jsx("button",{className:"pg-timer-btn",onClick:()=>{H===0&&ye(tt.time),xt(!0)},children:H<tt.time&&H>0?"Resume":"Start Timer"})]}),a.jsx("button",{className:"pg-log-set-btn",onClick:Ct,disabled:Be.type==="timed"&&He,children:Le+1<tt.sets?"Log Set":de+1<ze?"Log Set  Next Exercise":"Log Set  Complete"}),Fe?.sets?.length>0&&a.jsx("div",{className:"pg-completed-sets",children:Fe.sets.map((ee,ve)=>a.jsxs("div",{className:"pg-completed-set",children:[a.jsx("span",{className:"pg-completed-set-check",children:""}),a.jsxs("span",{children:["Set ",ve+1,": ",ee.weight!==void 0?`${ee.weight}kg  ${ee.reps}`:ee.time!==void 0?`${ee.time}s`:`${ee.reps} reps`]})]},ve))})]}),hn]})}if(g==="sessionComplete"){const De=dt()?.days[$],Be=S.reduce((Fe,Le)=>Fe+Le.sets.length,0),tt=S.reduce((Fe,Le)=>Fe+Le.sets.reduce((ze,Tt)=>ze+(Tt.weight||0)*(Tt.reps||0),0),0);return a.jsxs("div",{className:"pg-page pg-page-center","data-theme":o?"dark":"light","data-accent":u,children:[a.jsxs("div",{className:"pg-session-done",children:[a.jsxs("div",{className:"pg-done-ring",children:[a.jsx("svg",{className:"pg-done-ring-svg",viewBox:"0 0 200 200",children:Gh.map((Fe,Le)=>a.jsx("line",{x1:Fe.x1,y1:Fe.y1,x2:Fe.x2,y2:Fe.y2,className:"pg-tick-complete",strokeWidth:Fe.thick?"3.5":"2",style:{animationDelay:`${Le*.02}s`}},Le))}),a.jsx("div",{className:"pg-done-center",children:a.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})})})]}),a.jsx("h2",{className:"pg-done-title",children:"Session Complete!"}),a.jsxs("p",{className:"pg-done-subtitle",children:["Week ",P,"  ",De?.name,": ",De?.label]}),a.jsxs("div",{className:"pg-done-stats",children:[a.jsxs("div",{className:"pg-done-stat",children:[a.jsx("span",{className:"pg-done-stat-num",children:S.length}),a.jsx("span",{className:"pg-done-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"pg-done-stat",children:[a.jsx("span",{className:"pg-done-stat-num",children:Be}),a.jsx("span",{className:"pg-done-stat-label",children:"Sets"})]}),tt>0&&a.jsxs("div",{className:"pg-done-stat",children:[a.jsx("span",{className:"pg-done-stat-num",children:Math.round(tt).toLocaleString()}),a.jsx("span",{className:"pg-done-stat-label",children:"Volume (kg)"})]})]}),a.jsx("button",{className:"pg-start-btn",onClick:()=>b("dashboard"),children:"Back to Programme"})]}),Re&&a.jsx("div",{className:"pg-badge-celebration",onClick:()=>Ge(null),children:a.jsxs("div",{className:"pg-badge-celebration-card",onClick:Fe=>Fe.stopPropagation(),children:[a.jsx("div",{className:"pg-badge-celebration-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsx("h3",{className:"pg-badge-celebration-title",children:Re.badges.length===1?"Badge Earned!":`${Re.badges.length} Badges Earned!`}),a.jsx("div",{className:"pg-badge-celebration-list",children:Re.badges.map((Fe,Le)=>a.jsx("div",{className:"pg-badge-celebration-item",children:Fe.type==="pb_target"?`${Fe.exercise}  ${Fe.targetWeight}kg`:Fe.label},Le))}),a.jsx("button",{className:"pg-badge-celebration-dismiss",onClick:()=>Ge(null),children:"Tap to dismiss"})]})}),hn]})}return null}const G5={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},K5={push:{label:"Push",color:"#c75f6b",icon:"M4 12h3l3-9 4 18 3-9h3"},pull:{label:"Pull",color:"#5f8ac7",icon:"M12 2v10m0 0l-4-4m4 4l4-4M4 20h16"},lower:{label:"Lower",color:"#5fc77a",icon:"M12 2v8m-4 4l4 8 4-8m-8 0h8"},core:{label:"Core",color:"#c7a45f",icon:"M12 2a4 4 0 014 4v1h-2V6a2 2 0 10-4 0v1H8V6a4 4 0 014-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}},ub=[{threshold:1e3,label:"1 Tonne",icon:"1T"},{threshold:5e3,label:"5 Tonne",icon:"5T"},{threshold:1e4,label:"10 Tonne",icon:"10T"},{threshold:25e3,label:"25 Tonne",icon:"25T"},{threshold:5e4,label:"50 Tonne",icon:"50T"},{threshold:1e5,label:"100 Tonne",icon:"100T"},{threshold:25e4,label:"250 Tonne",icon:"250T"},{threshold:5e5,label:"500 Tonne",icon:"500T"},{threshold:1e6,label:"1 Million kg",icon:"1M"}];function Q5(n){return G5[n]||"push"}function Y5(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}function X5(n){return n>=1e6?"million kg":n>=1e3?"tonnes":"kg"}function J5(){const{currentUser:n,isClient:e,clientData:t,loading:s}=li(),{isDark:o,toggleTheme:c,accent:u}=Bi(),d=gr(),[p,g]=_.useState(!0),[b,x]=_.useState(null),[T,N]=_.useState({}),[B,M]=_.useState([]),[P,Y]=_.useState(null),[$,J]=_.useState(0),[de,Ne]=_.useState({});_.useRef(null),_.useEffect(()=>{!s&&(!n||!e)&&d("/")},[n,e,s,d]),_.useEffect(()=>{if(!t)return;(async()=>{try{const[ye,Ve,Ke,ne]=await Promise.all([On(Qe(_e,"coreBuddyAchievements",t.id)),On(Qe(_e,"coreBuddyPBs",t.id)),On(Qe(_e,"achievements",t.id)),Sn(In(Wt(_e,"workoutLogs"),dn("clientId","==",t.id)))]);ye.exists()&&x(ye.data()),Ve.exists()&&N(Ve.data().exercises||{}),Ke.exists()&&(M(Object.keys(Ke.data().badges||{})),Ne(Ke.data().progress||{})),J(ne.docs.length)}catch(ye){console.error("Error loading achievements:",ye)}g(!1)})()},[t]);const we=b?.badges||[],A=b?.totalVolume||0,S=we.filter(H=>H.type==="pb_target"),D=we.filter(H=>H.type==="volume_milestone"),U={push:[],pull:[],lower:[],core:[]};S.forEach(H=>{const ye=H.group||Q5(H.exercise);U[ye]&&U[ye].push(H)});const V=ub.find(H=>A<H.threshold),q=ub.filter(H=>A>=H.threshold).pop()?.threshold||0,L=V?(A-q)/(V.threshold-q):1;if(s||p)return a.jsxs("div",{className:"ach-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsx("div",{className:"header-content",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),a.jsx("div",{className:"ach-loading-inline",children:a.jsx("div",{className:"cb-loading-spinner"})})]});const He=we.length+B.length,xt=He>0||A>0||$>0;return a.jsxs("div",{className:"ach-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"ach-main",children:[a.jsx("button",{className:"nut-back-btn",onClick:()=>d("/client/personal-bests?mode=corebuddy"),children:" Back"}),a.jsxs("div",{className:"ach-stats-banner",children:[a.jsxs("div",{className:"ach-stat-item",children:[a.jsx("span",{className:"ach-stat-num",children:He}),a.jsx("span",{className:"ach-stat-label",children:He===1?"Badge":"Badges"})]}),a.jsx("div",{className:"ach-stat-divider"}),a.jsxs("div",{className:"ach-stat-item",children:[a.jsx("span",{className:"ach-stat-num",children:Y5(A)}),a.jsxs("span",{className:"ach-stat-label",children:[X5(A)," lifted"]})]}),a.jsx("div",{className:"ach-stat-divider"}),a.jsxs("div",{className:"ach-stat-item",children:[a.jsx("span",{className:"ach-stat-num",children:Object.keys(T).length}),a.jsx("span",{className:"ach-stat-label",children:"PBs"})]})]}),!xt&&a.jsxs("div",{className:"ach-empty",children:[a.jsx("div",{className:"ach-empty-icon",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M12 15l-3-3h6l-3 3z"}),a.jsx("path",{d:"M5 7h14l-1.5 9h-11L5 7z"}),a.jsx("path",{d:"M8.5 7V5a3.5 3.5 0 017 0v2"})]})}),a.jsx("h4",{children:"No achievements yet"}),a.jsx("p",{children:"Complete workouts to track volume and set PB targets to start earning badges."})]}),[{key:"workouts",title:"Workout Badges",iconPath:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"},{key:"streaks",title:"Streak Badges",iconPath:"M13.5.67s.74 2.65.74 4.8c0 2.06-1.35 3.73-3.41 3.73-2.07 0-3.63-1.67-3.63-3.73l.03-.36C5.21 7.51 4 10.62 4 14c0 4.42 3.58 8 8 8s8-3.58 8-8C20 8.61 17.41 3.8 13.5.67z"},{key:"pbs",title:"Personal Best Badges",iconPath:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"},{key:"nutrition",title:"Nutrition Badges",iconPath:"M18.06 23h1.66c.84 0 1.53-.65 1.63-1.47L23 5.05h-5V1h-2v4.05h-5l.3 2.34c1.71.47 3.31 1.32 4.27 2.26 1.44 1.42 2.43 2.89 2.43 5.29V23zM1 22v-1h15.03v1c0 .55-.45 1-1.01 1H2.01c-.56 0-1.01-.45-1.01-1zm15.03-7c0-4.87-4.66-5.84-8.03-5.97l.72 5.52L1 15.05v5.95h15.03V15z"},{key:"habits",title:"Habit Badges",iconPath:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"},{key:"leaderboard",title:"Leaderboard Badges",iconPath:"M7.5 21H2V9h5.5v12zm7.25-18h-5.5v18h5.5V3zM22 11h-5.5v10H22V11z"}].map(H=>{const ye=Kh.filter(ne=>ne.category===H.key);if(ye.length===0)return null;const Ve=(()=>{switch(H.key){case"workouts":return $;case"streaks":return de.streakWeeks||0;case"pbs":return Object.keys(T).length;case"nutrition":return de.nutritionStreak||0;case"leaderboard":return t?.leaderboardOptIn?1:0;case"habits":return de.habitStreak||0;default:return 0}})(),Ke=ye.filter(ne=>B.includes(ne.id)).length;return a.jsxs("div",{className:"ach-section",children:[a.jsxs("h3",{className:"ach-section-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:H.iconPath})}),H.title]}),a.jsx("div",{className:"ach-workout-carousel",children:ye.map(ne=>{const O=B.includes(ne.id);return a.jsxs("button",{className:`ach-workout-badge${O?" unlocked":" locked"}`,onClick:()=>Y(ne),children:[a.jsx("img",{src:ne.img,alt:ne.name,className:"ach-workout-badge-img"}),!O&&ne.threshold&&a.jsx("div",{className:"ach-workout-badge-progress",children:a.jsx("div",{className:"ach-workout-badge-progress-fill",style:{width:`${Math.min(Ve/ne.threshold*100,100)}%`}})})]},ne.id)})}),a.jsxs("p",{className:"ach-workout-badges-count",children:[Ke,"/",ye.length," unlocked"]})]},H.key)}),P&&a.jsx("div",{className:"ach-badge-overlay",onClick:()=>Y(null),children:a.jsxs("div",{className:"ach-badge-overlay-content",onClick:H=>H.stopPropagation(),children:[a.jsx("img",{src:P.img,alt:P.name,className:`ach-badge-overlay-img${B.includes(P.id)?"":" ach-badge-overlay-img-locked"}`}),a.jsx("p",{className:"ach-badge-overlay-desc",children:P.desc}),B.includes(P.id)?a.jsx("span",{className:"ach-badge-overlay-status unlocked",children:"Unlocked"}):a.jsx("span",{className:"ach-badge-overlay-status locked",children:"Locked"}),a.jsx("button",{className:"ach-badge-overlay-close",onClick:()=>Y(null),children:"Tap to close"})]})}),a.jsxs("div",{className:"ach-section",children:[a.jsxs("h3",{className:"ach-section-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})}),"Volume Milestones"]}),a.jsxs("div",{className:"ach-volume-hero",children:[a.jsxs("div",{className:"ach-volume-ring",children:[a.jsx("svg",{className:"ach-volume-ring-svg",viewBox:"0 0 200 200",children:Gh.map((H,ye)=>{const Ve=ye<Math.round(L*60);return a.jsx("line",{x1:H.x1,y1:H.y1,x2:H.x2,y2:H.y2,className:Ve?"ach-tick-filled":"ach-tick-empty",strokeWidth:H.thick?"3":"2"},ye)})}),a.jsxs("div",{className:"ach-volume-center",children:[a.jsx("span",{className:"ach-volume-number",children:Math.round(A).toLocaleString()}),a.jsx("span",{className:"ach-volume-unit",children:"kg lifted"})]})]}),V&&a.jsxs("div",{className:"ach-volume-next",children:["Next: ",a.jsx("strong",{children:V.label})," (",(V.threshold-A).toLocaleString(),"kg to go)"]})]}),a.jsx("div",{className:"ach-milestone-shelf",children:ub.map((H,ye)=>{const Ve=A>=H.threshold,Ke=D.find(ne=>ne.milestone===H.threshold);return a.jsxs("div",{className:`ach-milestone ${Ve?"unlocked":"locked"}`,children:[a.jsx("div",{className:"ach-milestone-hex",children:a.jsx("span",{className:"ach-milestone-icon",children:H.icon})}),a.jsx("span",{className:"ach-milestone-label",children:H.label}),Ke?.achievedAt&&a.jsx("span",{className:"ach-milestone-date",children:(Ke.achievedAt.toDate?Ke.achievedAt.toDate():new Date(Ke.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short"})})]},ye)})})]}),a.jsxs("div",{className:"ach-section",children:[a.jsxs("h3",{className:"ach-section-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"PB Target Badges"]}),S.length===0?a.jsx("div",{className:"ach-pb-empty",children:a.jsxs("p",{children:["Set targets on your personal bests to start earning badges. Go to ",a.jsx("strong",{children:"My Progress"}),' and tap "Set Target" on any PB.']})}):Object.entries(U).map(([H,ye])=>{if(ye.length===0)return null;const Ve=K5[H];return a.jsxs("div",{className:"ach-group",children:[a.jsxs("div",{className:"ach-group-header",style:{borderLeftColor:Ve.color},children:[a.jsx("span",{className:"ach-group-label",style:{color:Ve.color},children:Ve.label}),a.jsx("span",{className:"ach-group-count",children:ye.length})]}),a.jsx("div",{className:"ach-badge-grid",children:ye.map((Ke,ne)=>a.jsxs("div",{className:"ach-badge-card",style:{animationDelay:`${ne*.06}s`,"--group-color":Ve.color},children:[a.jsx("div",{className:"ach-badge-hex",style:{borderColor:Ve.color,boxShadow:`0 0 12px ${Ve.color}33`},children:a.jsx("svg",{className:"ach-badge-hex-icon",viewBox:"0 0 24 24",fill:"none",stroke:Ve.color,strokeWidth:"2",strokeLinecap:"round",children:a.jsx("path",{d:Ve.icon})})}),a.jsxs("div",{className:"ach-badge-info",children:[a.jsx("span",{className:"ach-badge-exercise",children:Ke.exercise}),a.jsxs("span",{className:"ach-badge-value",style:{color:Ve.color},children:[Ke.targetWeight,"kg"]}),Ke.achievedAt&&a.jsx("span",{className:"ach-badge-date",children:(Ke.achievedAt.toDate?Ke.achievedAt.toDate():new Date(Ke.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})})]})]},ne))})]},H)})]})]}),a.jsx(oa,{active:"home"})]})}const nm=[{key:"trained",label:"Trained",icon:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2.71 7 4.14 8.43 7.71 4.86 16.29 13.43 12.71 17 14.14 18.43 15.57 17 17 18.43 14.14 21.29l1.43 1.43 1.43-1.43 1.43 1.43 2.14-2.14 1.43 1.43L22 20.57z"},{key:"protein",label:"Hit Protein",icon:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"},{key:"steps",label:"10k Steps",icon:"M13.5 5.5c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zM9.8 8.9L7 23h2.1l1.8-8 2.1 2v6h2v-7.5l-2.1-2 .6-3C14.8 12 16.8 13 19 13v-2c-1.9 0-3.5-1-4.3-2.4l-1-1.6c-.4-.6-1-1-1.7-1-.3 0-.5.1-.8.1L6 8.3V13h2V9.6l1.8-.7"},{key:"sleep",label:"8hrs Sleep",icon:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"},{key:"water",label:"2L Water",icon:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"}];function Z5(n){const e=new Date(n),t=e.getDay(),s=t===0?-6:1-t;return e.setDate(e.getDate()+s),e.setHours(0,0,0,0),e}function hb(n){return n.toISOString().split("T")[0]}function eO(n){return Array.from({length:7},(e,t)=>{const s=new Date(n);return s.setDate(n.getDate()+t),s})}function tO(){const{currentUser:n,isClient:e,clientData:t,loading:s}=li(),{isDark:o,toggleTheme:c,accent:u}=Bi(),d=gr(),[p,g]=_.useState({}),[b,x]=_.useState(!0),[T,N]=_.useState(!1),[B,M]=_.useState(0),[P,Y]=_.useState(null),[$,J]=_.useState(null),[de,Ne]=_.useState(!1),we=_.useRef([]),A=_.useRef([]),S=_.useCallback((K,Te="info")=>{Y({message:K,type:Te}),setTimeout(()=>Y(null),3e3)},[]),D=new Date,U=hb(D),V=Z5(D),q=eO(V),L=["M","T","W","T","F","S","S"];_.useEffect(()=>{!s&&(!n||!e)&&d("/")},[n,e,s,d]),_.useEffect(()=>{if(!n||!t)return;(async()=>{try{const Te=Wt(_e,"habitLogs"),Re=In(Te,dn("clientId","==",t.id)),Ge=await Sn(Re),Me={};Ge.docs.forEach(et=>{const qt=et.data();Me[qt.date]={...qt,_id:et.id}}),g(Me);let ut=0;const gt=new Date(D);for(;;){const et=hb(gt),qt=Me[et];if(qt)if(Object.values(qt.habits||{}).filter(Boolean).length>=3)ut++,gt.setDate(gt.getDate()-1);else break;else if(et===U)gt.setDate(gt.getDate()-1);else break}M(ut)}catch(Te){console.error("Error loading habit logs:",Te)}finally{x(!1)}})()},[n,t]);const He=p[U]||{habits:{}},xt=async K=>{if(!n||T)return;const Te=He.habits?.[K]||!1;Te||(we.current=[...Array(10)].map((Re,Ge)=>{const Me=Ge/10*2*Math.PI,ut=18+Math.random()*20;return{tx:Math.cos(Me)*ut,ty:Math.sin(Me)*ut,size:3+Math.random()*4,duration:.4+Math.random()*.3}}),J(K),setTimeout(()=>J(null),700)),N(!0);try{const Re=He.habits||{},Ge={...Re,[K]:!Re[K]},Me=He._id||`${t.id}_${U}`;await Gn(Qe(_e,"habitLogs",Me),{clientId:t.id,date:U,habits:Ge}),g(gt=>({...gt,[U]:{clientId:t.id,date:U,habits:Ge,_id:Me}})),Object.values(Ge).filter(Boolean).length===nm.length&&!Te&&(A.current=[...Array(50)].map((gt,et)=>({x:5+Math.random()*90,delay:Math.random()*.6,color:["#4caf50","#ff9800","#2196f3","#e91e63","#ffeb3b","#9c27b0"][et%6],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.5+Math.random()*1.5,width:4+Math.random()*8,height:4+Math.random()*10})),setTimeout(()=>{Ne(!0),setTimeout(()=>Ne(!1),3500)},500))}catch(Re){console.error("Error saving habit:",Re),S("Failed to save. Try again.","error")}finally{N(!1)}},H=q.map(K=>{const Te=hb(K),Re=p[Te],Ge=Re?Object.values(Re.habits||{}).filter(Boolean).length:0;return{date:K,dateStr:Te,completed:Ge,total:nm.length}}),ye=H.reduce((K,Te)=>K+Te.completed,0),Ve=H.reduce((K,Te)=>K+Te.total,0),Ke=Ve>0?Math.round(ye/Ve*100):0,ne=Object.values(He.habits||{}).filter(Boolean).length,O=Math.round(ne/nm.length*100);return a.jsxs("div",{className:"cbc-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),s||b?a.jsx("div",{className:"cbc-loading-inline",children:a.jsx("div",{className:"cbc-loading-spinner"})}):a.jsxs("main",{className:"cbc-main",children:[a.jsxs("div",{className:"cbc-ring-section",children:[a.jsxs("div",{className:"cbc-progress-ring",children:[a.jsxs("svg",{viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"cbc-arc-track",cx:"100",cy:"100",r:"80"}),a.jsx("circle",{className:"cbc-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-O/100*2*Math.PI*80})]}),a.jsxs("div",{className:"cbc-ring-center",children:[a.jsxs("span",{className:"cbc-ring-pct",children:[O,"%"]}),a.jsx("span",{className:"cbc-ring-label",children:"today"})]})]}),a.jsxs("div",{className:"cbc-streak",children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2",children:a.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),a.jsx("span",{className:"cbc-streak-count",children:B}),a.jsx("span",{className:"cbc-streak-label",children:"day streak"})]})]}),a.jsxs("div",{className:"cbc-section",children:[a.jsx("h2",{className:"cbc-section-title",children:"Today's Habits"}),a.jsx("div",{className:"cbc-habits",children:nm.map(K=>{const Te=He.habits?.[K.key]||!1,Re=$===K.key;return a.jsxs("button",{className:`cbc-habit-btn cbc-habit-${K.key} ${Te?"cbc-habit-done":""} ${Re?"cbc-habit-just-checked":""}`,onClick:()=>xt(K.key),disabled:T,children:[a.jsx("div",{className:"cbc-habit-check",children:Te?a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("polyline",{points:"20 6 9 17 4 12",className:`cbc-check-path ${Re?"cbc-check-animate":""}`})}):a.jsx("div",{className:"cbc-habit-circle"})}),Re&&a.jsx("div",{className:"cbc-particles",children:we.current.map((Ge,Me)=>a.jsx("span",{className:"cbc-particle",style:{"--tx":`${Ge.tx}px`,"--ty":`${Ge.ty}px`,"--size":`${Ge.size}px`,animationDuration:`${Ge.duration}s`}},Me))}),a.jsx("div",{className:`cbc-habit-icon cbc-icon-${K.key}`,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:K.icon})})}),a.jsx("span",{className:"cbc-habit-label",children:K.label})]},K.key)})})]}),a.jsxs("div",{className:"cbc-section",children:[a.jsx("h2",{className:"cbc-section-title",children:"This Week"}),a.jsx("div",{className:"cbc-week-grid",children:H.map((K,Te)=>{const Re=K.dateStr===U,Ge=K.total>0?K.completed/K.total:0,Me=38,ut=2*Math.PI*Me,gt=ut-Ge*ut;return a.jsxs("div",{className:`cbc-day-ring ${Re?"cbc-day-today":""} ${K.completed>0?"cbc-day-active":""}`,children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cbc-day-track",cx:"50",cy:"50",r:Me}),a.jsx("circle",{className:"cbc-day-fill",cx:"50",cy:"50",r:Me,strokeDasharray:ut,strokeDashoffset:gt})]}),a.jsx("span",{className:"cbc-day-label",children:L[Te]}),a.jsxs("span",{className:"cbc-day-count",children:[K.completed,"/",K.total]})]},Te)})}),a.jsxs("div",{className:"cbc-week-summary",children:[a.jsx("div",{className:"cbc-week-summary-bar",children:a.jsx("div",{className:"cbc-week-summary-fill",style:{width:`${Ke}%`}})}),a.jsxs("span",{className:"cbc-week-summary-text",children:[ye," / ",Ve," habits this week (",Ke,"%)"]})]})]})]}),a.jsx(oa,{active:"home"}),de&&a.jsxs("div",{className:"cbc-celebration",onClick:()=>Ne(!1),children:[a.jsx("div",{className:"cbc-confetti-container",children:A.current.map((K,Te)=>a.jsx("span",{className:"cbc-confetti-piece",style:{"--x":`${K.x}%`,"--delay":`${K.delay}s`,"--color":K.color,"--drift":`${K.drift}px`,"--spin":`${K.spin}deg`,"--duration":`${K.duration}s`,width:`${K.width}px`,height:`${K.height}px`}},Te))}),a.jsxs("div",{className:"cbc-celebration-card",children:[a.jsxs("svg",{className:"cbc-celebration-icon",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),a.jsx("h2",{className:"cbc-celebration-title",children:"Crushed it!"}),a.jsx("p",{className:"cbc-celebration-sub",children:"All habits complete today"})]})]}),P&&a.jsx("div",{className:`toast-notification ${P.type}`,children:P.message})]})}function sm(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function zT(n,e){return[n,e].sort().join("_")}function nO(){const{currentUser:n,isClient:e,clientData:t,loading:s}=li(),{isDark:o,toggleTheme:c}=Bi(),u=gr(),[d,p]=_.useState("buddies"),[g,b]=_.useState([]),[x,T]=_.useState([]),[N,B]=_.useState([]),[M,P]=_.useState(""),[Y,$]=_.useState([]),[J,de]=_.useState([]),[Ne,we]=_.useState(!0),[A,S]=_.useState(null),[D,U]=_.useState(null),V=_.useCallback((ne,O="info")=>{U({message:ne,type:O}),setTimeout(()=>U(null),3500)},[]);_.useEffect(()=>{!s&&(!n||!e)&&u("/")},[n,e,s,u]);const q=_.useCallback(async()=>{if(t){we(!0);try{const ne=t.id,K=(await Sn(Wt(_e,"clients"))).docs.map(et=>({id:et.id,...et.data()}));de(K);const Te=Object.fromEntries(K.map(et=>[et.id,et])),Re=await Sn(In(Wt(_e,"buddies"),dn("user1","==",ne))),Ge=await Sn(In(Wt(_e,"buddies"),dn("user2","==",ne))),Me=new Set;[...Re.docs,...Ge.docs].forEach(et=>{const qt=et.data(),Dn=qt.user1===ne?qt.user2:qt.user1;Me.add(Dn)}),b(Array.from(Me).map(et=>Te[et]).filter(Boolean));const ut=await Sn(In(Wt(_e,"buddyRequests"),dn("toId","==",ne),dn("status","==","pending")));T(ut.docs.map(et=>({reqId:et.id,...et.data(),fromClient:Te[et.data().fromId]})).filter(et=>et.fromClient));const gt=await Sn(In(Wt(_e,"buddyRequests"),dn("fromId","==",ne),dn("status","==","pending")));B(gt.docs.map(et=>({reqId:et.id,...et.data(),toClient:Te[et.data().toId]})).filter(et=>et.toClient))}catch(ne){console.error("Error fetching buddy data:",ne),V("Failed to load buddies","error")}finally{we(!1)}}},[t,V]);_.useEffect(()=>{q()},[q]),_.useEffect(()=>{if(!M.trim()||!t){$([]);return}const ne=M.toLowerCase(),O=t.id,K=new Set(g.map(Me=>Me.id)),Te=new Set(N.map(Me=>Me.toId)),Re=new Set(x.map(Me=>Me.fromId)),Ge=J.filter(Me=>Me.id===O||!Me.name||!Me.coreBuddyAccess&&Me.clientType!=="core_buddy"?!1:Me.name.toLowerCase().includes(ne)).map(Me=>({...Me,isBuddy:K.has(Me.id),isPendingOut:Te.has(Me.id),isPendingIn:Re.has(Me.id)})).slice(0,20);$(Ge)},[M,J,g,N,x,t]);const L=async(ne,O)=>{if(!(!t||ne===t.id))try{await Ia(Wt(_e,"notifications"),{toId:ne,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:O,read:!1,createdAt:vi()})}catch(K){console.error("Notification error:",K),K.code==="permission-denied"&&V("Notifications blocked  check Firestore rules","error")}},He=async ne=>{S(ne);try{const O=`${t.id}_${ne}`;await Gn(Qe(_e,"buddyRequests",O),{fromId:t.id,toId:ne,status:"pending",createdAt:vi()}),await L(ne,"buddy_request"),V("Buddy request sent!","success"),await q()}catch(O){console.error("Error sending request:",O),V("Failed to send request","error")}finally{S(null)}},xt=async ne=>{S(ne.reqId);try{const O=zT(ne.fromId,t.id);await Gn(Qe(_e,"buddies",O),{user1:[ne.fromId,t.id].sort()[0],user2:[ne.fromId,t.id].sort()[1],connectedAt:vi()}),await Cr(Qe(_e,"buddyRequests",ne.reqId)),await L(ne.fromId,"buddy_accept"),V("Buddy added!","success"),await q()}catch(O){console.error("Error accepting request:",O),V("Failed to accept","error")}finally{S(null)}},H=async ne=>{S(ne.reqId);try{await Cr(Qe(_e,"buddyRequests",ne.reqId)),V("Request declined","info"),await q()}catch(O){console.error("Error declining:",O),V("Failed to decline","error")}finally{S(null)}},ye=async ne=>{S(ne.reqId);try{await Cr(Qe(_e,"buddyRequests",ne.reqId)),V("Request cancelled","info"),await q()}catch(O){console.error("Error cancelling:",O),V("Failed to cancel","error")}finally{S(null)}},Ve=async ne=>{S(ne);try{const O=zT(t.id,ne);await Cr(Qe(_e,"buddies",O)),V("Buddy removed","info"),await q()}catch(O){console.error("Error removing buddy:",O),V("Failed to remove buddy","error")}finally{S(null)}},Ke=x.length;return s?a.jsx("div",{className:"bdy-loading",children:a.jsx("div",{className:"bdy-spinner"})}):!n||!e||!t?null:a.jsxs("div",{className:"bdy-page","data-theme":o?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>u("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"bdy-main",children:[a.jsx("h1",{className:"bdy-title",children:"Buddies"}),a.jsxs("button",{className:"bdy-leaderboard-link",onClick:()=>u("/client/leaderboard"),children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),a.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),a.jsx("rect",{x:"6",y:"9",width:"12",height:"13",rx:"2"}),a.jsx("path",{d:"M12 9v13"}),a.jsx("path",{d:"M2 22h20"})]}),a.jsx("span",{children:"Leaderboard"}),a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"bdy-tabs",children:[a.jsxs("button",{className:`bdy-tab${d==="buddies"?" active":""}`,onClick:()=>p("buddies"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"My Buddies"})]}),a.jsxs("button",{className:`bdy-tab${d==="requests"?" active":""}`,onClick:()=>p("requests"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),a.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),a.jsx("span",{children:"Requests"}),Ke>0&&a.jsx("span",{className:"bdy-tab-badge",children:Ke})]}),a.jsxs("button",{className:`bdy-tab${d==="search"?" active":""}`,onClick:()=>p("search"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Find"})]})]}),Ne?a.jsx("div",{className:"bdy-content-loading",children:a.jsx("div",{className:"bdy-spinner"})}):a.jsxs(a.Fragment,{children:[d==="buddies"&&a.jsx("div",{className:"bdy-section",children:g.length===0?a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("h3",{children:"No buddies yet"}),a.jsx("p",{children:"Find members and send buddy requests to connect!"}),a.jsx("button",{className:"bdy-empty-btn",onClick:()=>p("search"),children:"Find Buddies"})]}):a.jsx("div",{className:"bdy-list",children:g.map(ne=>a.jsxs("div",{className:"bdy-card",onClick:()=>u(`/client/core-buddy/profile/${ne.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:ne.photoURL?a.jsx("img",{src:ne.photoURL,alt:ne.name}):a.jsx("span",{children:sm(ne.name)})}),a.jsx("div",{className:"bdy-card-info",children:a.jsx("span",{className:"bdy-card-name",children:ne.name})}),a.jsx("button",{className:"bdy-remove-btn",onClick:O=>{O.stopPropagation(),Ve(ne.id)},disabled:A===ne.id,"aria-label":"Remove buddy",children:A===ne.id?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},ne.id))})}),d==="requests"&&a.jsxs("div",{className:"bdy-section",children:[x.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Incoming"}),a.jsx("div",{className:"bdy-list",children:x.map(ne=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:ne.fromClient.photoURL?a.jsx("img",{src:ne.fromClient.photoURL,alt:ne.fromClient.name}):a.jsx("span",{children:sm(ne.fromClient.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:ne.fromClient.name}),a.jsx("span",{className:"bdy-card-sub",children:"wants to be your buddy"})]}),a.jsxs("div",{className:"bdy-action-pair",children:[a.jsx("button",{className:"bdy-accept-btn",onClick:()=>xt(ne),disabled:A===ne.reqId,children:A===ne.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}),a.jsx("button",{className:"bdy-decline-btn",onClick:()=>H(ne),disabled:A===ne.reqId,children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},ne.reqId))})]}),N.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Sent"}),a.jsx("div",{className:"bdy-list",children:N.map(ne=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:ne.toClient?.photoURL?a.jsx("img",{src:ne.toClient.photoURL,alt:ne.toClient.name}):a.jsx("span",{children:sm(ne.toClient?.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:ne.toClient?.name}),a.jsx("span",{className:"bdy-card-sub",children:"pending"})]}),a.jsx("button",{className:"bdy-cancel-btn",onClick:()=>ye(ne),disabled:A===ne.reqId,children:A===ne.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):"Cancel"})]},ne.reqId))})]}),x.length===0&&N.length===0&&a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),a.jsx("h3",{children:"No pending requests"}),a.jsx("p",{children:"All caught up!"})]})]}),d==="search"&&a.jsxs("div",{className:"bdy-section",children:[a.jsxs("div",{className:"bdy-search-bar",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("input",{type:"text",placeholder:"Search by name...",value:M,onChange:ne=>P(ne.target.value),autoFocus:!0}),M&&a.jsx("button",{className:"bdy-search-clear",onClick:()=>P(""),children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),M.trim()&&Y.length===0&&a.jsx("div",{className:"bdy-empty bdy-empty-sm",children:a.jsxs("p",{children:['No members found for "',M,'"']})}),Y.length>0&&a.jsx("div",{className:"bdy-list",children:Y.map(ne=>a.jsxs("div",{className:"bdy-card",onClick:()=>u(`/client/core-buddy/profile/${ne.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:ne.photoURL?a.jsx("img",{src:ne.photoURL,alt:ne.name}):a.jsx("span",{children:sm(ne.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:ne.name}),ne.isBuddy&&a.jsx("span",{className:"bdy-card-badge",children:"Buddy"})]}),ne.isBuddy?a.jsx("span",{className:"bdy-status-icon",children:a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-success)",strokeWidth:"2.5",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):ne.isPendingOut?a.jsx("span",{className:"bdy-pending-label",children:"Pending"}):ne.isPendingIn?a.jsx("button",{className:"bdy-accept-btn",onClick:O=>{O.stopPropagation();const K=x.find(Te=>Te.fromId===ne.id);K&&xt(K)},disabled:!!A,children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):a.jsx("button",{className:"bdy-add-btn",onClick:O=>{O.stopPropagation(),He(ne.id)},disabled:A===ne.id,children:A===ne.id?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]},ne.id))})]})]})]}),a.jsx(oa,{}),D&&a.jsxs("div",{className:`toast-notification ${D.type}`,children:[a.jsx("span",{className:"toast-icon",children:D.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):D.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:D.message})]})]})}function rm(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function db(n,e){return[n,e].sort().join("_")}const sO=5;function fb(n){return n.toISOString().split("T")[0]}function rO(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}const iO={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}};function qT(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function aO(){const{userId:n}=MR(),{currentUser:e,isClient:t,clientData:s,loading:o}=li(),{isDark:c,toggleTheme:u}=Bi(),d=gr(),[p,g]=_.useState(null),[b,x]=_.useState("none"),[T,N]=_.useState(null),[B,M]=_.useState(!0),[P,Y]=_.useState(!1),[$,J]=_.useState(null),[de,Ne]=_.useState([]),[we,A]=_.useState(!1),[S,D]=_.useState(new Set),[U,V]=_.useState(new Set),[q,L]=_.useState({}),[He,xt]=_.useState({}),[H,ye]=_.useState({}),[Ve,Ke]=_.useState(!0),[ne,O]=_.useState(0),[K,Te]=_.useState(0),[Re,Ge]=_.useState(0),[Me,ut]=_.useState(0),[gt,et]=_.useState([]),[qt,Dn]=_.useState([]),[Vt,kt]=_.useState(null),[pe,ln]=_.useState(null),[sn,dt]=_.useState(0),[St,ct]=_.useState([]),[it,Jt]=_.useState(!1),[Is,Ct]=_.useState(null),[un,ds]=_.useState([]),Kt=_.useCallback((ee,ve="info")=>{J({message:ee,type:ve}),setTimeout(()=>J(null),3500)},[]);_.useEffect(()=>{!o&&(!e||!t)&&d("/")},[e,t,o,d]),_.useEffect(()=>{s&&n&&s.id===n&&d("/client/core-buddy",{replace:!0})},[s,n,d]),_.useEffect(()=>{if(!s||!n||s.id===n)return;let ee=!1;return(async()=>{M(!0);try{const Dt=(await Sn(Wt(_e,"clients"))).docs.map($t=>({id:$t.id,...$t.data()})).find($t=>$t.id===n);if(!Dt){ee||M(!1);return}ee||g(Dt);const jt=s.id,rn=db(jt,n);if((await On(Qe(_e,"buddies",rn))).exists())ee||x("buddy");else{const $t=`${jt}_${n}`,Mn=await On(Qe(_e,"buddyRequests",$t));if(Mn.exists()&&Mn.data().status==="pending")ee||(x("pending_out"),N($t));else{const rs=`${n}_${jt}`,bn=await On(Qe(_e,"buddyRequests",rs));bn.exists()&&bn.data().status==="pending"?ee||(x("pending_in"),N(rs)):ee||x("none")}}}catch(ve){console.error("Error loading profile:",ve)}finally{ee||M(!1)}})(),()=>{ee=!0}},[s,n]),_.useEffect(()=>{if(!n||!p)return;let ee=!1;return(async()=>{Ke(!0);try{const[ve,at,Dt,jt]=await Promise.all([Sn(In(Wt(_e,"workoutLogs"),dn("clientId","==",n))),On(Qe(_e,"coreBuddyAchievements",n)),On(Qe(_e,"coreBuddyPBs",n)),On(Qe(_e,"clientProgrammes",n))]);if(ee)return;const rn=ve.docs.length;O(rn),at.exists()&&Te(at.data().totalVolume||0);let Yt=0;const $t=ve.docs.map(bn=>bn.data().date).filter(Boolean).sort().reverse();if($t.length>0){const bn=new Date;let Cn=new Date(bn);for(let Bn=0;Bn<52;Bn++){const z=new Date(Cn),xe=z.getDay(),ke=xe===0?6:xe-1;z.setDate(z.getDate()-ke),z.setHours(0,0,0,0);const Se=new Date(z);Se.setDate(Se.getDate()+7);const be=fb(z),rt=fb(Se);if($t.some(ot=>ot>=be&&ot<rt))Yt++;else{if(Bn>0)break;break}Cn.setDate(Cn.getDate()-7)}}if(ee||Ge(Yt),Dt.exists()){const bn=Dt.data().exercises||{},Cn=Object.entries(bn).sort(([,Bn],[,z])=>(z.weight||0)-(Bn.weight||0)).slice(0,3).map(([Bn,z])=>({name:Bn,weight:z.weight,reps:z.reps}));ee||et(Cn)}if(jt.exists()){const bn=jt.data(),Cn=iO[bn.templateId];if(Cn){const Bn=Object.keys(bn.completedSessions||{}).length,z=Cn.duration*Cn.daysPerWeek;ee||(ln(bn.templateId.replace(/_/g," ").replace(/\b\w/g,xe=>xe.toUpperCase())),dt(z>0?Math.round(Bn/z*100):0))}}const Mn=await On(Qe(_e,"achievements",n));if(!ee&&Mn.exists()){const bn=Mn.data().badges||{};Dn(Object.keys(bn))}let rs=0;for(let bn=0;bn<30;bn++){const Cn=new Date;Cn.setDate(Cn.getDate()-bn);const Bn=fb(Cn);try{const z=await Sn(In(Wt(_e,"habitLogs"),dn("clientId","==",n),dn("date","==",Bn)));if(z.empty)break;{const xe=z.docs[0].data().habits||{};if(Object.values(xe).filter(Boolean).length>=sO)rs++;else break}}catch{break}}ee||ut(rs)}catch(ve){console.error("Error loading buddy stats:",ve)}finally{ee||Ke(!1)}})(),()=>{ee=!0}},[n,p]),_.useEffect(()=>{if(!s)return;const ee=s.id;(async()=>{try{const[ve,at,Dt]=await Promise.all([Sn(In(Wt(_e,"buddies"),dn("user1","==",ee))),Sn(In(Wt(_e,"buddies"),dn("user2","==",ee))),Sn(Wt(_e,"clients"))]),jt=new Set;[...ve.docs,...at.docs].forEach(Yt=>{const $t=Yt.data();jt.add($t.user1===ee?$t.user2:$t.user1)});const rn={};Dt.docs.forEach(Yt=>{rn[Yt.id]=Yt.data()}),ct(Array.from(jt).filter(Yt=>rn[Yt]).map(Yt=>({id:Yt,name:rn[Yt].name,photoURL:rn[Yt].photoURL||null})))}catch(ve){console.error("Error loading buddies for mentions:",ve)}})()},[s]);const Pn=async(ee,ve,at={})=>{if(!(!s||ee===s.id))try{await Ia(Wt(_e,"notifications"),{toId:ee,fromId:s.id,fromName:s.name||"Someone",fromPhotoURL:s.photoURL||null,type:ve,read:!1,createdAt:vi(),...at})}catch(Dt){console.error("Notification error:",Dt),Dt.code==="permission-denied"&&Kt("Notifications blocked  check Firestore rules","error")}},hn=async()=>{Y(!0);try{const ee=`${s.id}_${n}`;await Gn(Qe(_e,"buddyRequests",ee),{fromId:s.id,toId:n,status:"pending",createdAt:vi()}),await Pn(n,"buddy_request"),x("pending_out"),N(ee),Kt("Buddy request sent!","success")}catch(ee){console.error(ee),Kt("Failed to send request","error")}finally{Y(!1)}},Rn=async()=>{if(T){Y(!0);try{const ee=db(s.id,n);await Gn(Qe(_e,"buddies",ee),{user1:[s.id,n].sort()[0],user2:[s.id,n].sort()[1],connectedAt:vi()}),await Cr(Qe(_e,"buddyRequests",T)),await Pn(n,"buddy_accept"),x("buddy"),Kt("Buddy added!","success")}catch(ee){console.error(ee),Kt("Failed to accept","error")}finally{Y(!1)}}},he=async()=>{if(T){Y(!0);try{await Cr(Qe(_e,"buddyRequests",T)),x("none"),Kt(b==="pending_out"?"Request cancelled":"Request declined","info")}catch(ee){console.error(ee),Kt("Failed","error")}finally{Y(!1)}}},De=async()=>{Y(!0);try{const ee=db(s.id,n);await Cr(Qe(_e,"buddies",ee)),x("none"),Kt("Buddy removed","info")}catch(ee){console.error(ee),Kt("Failed to remove","error")}finally{Y(!1)}},Be=_.useCallback(async()=>{if(n){A(!0);try{const ee=await Sn(In(Wt(_e,"posts"),dn("authorId","==",n),Ym("createdAt","desc"),Xm(30)));if(Ne(ee.docs.map(ve=>({id:ve.id,...ve.data()}))),s){const ve=await Sn(In(Wt(_e,"postLikes"),dn("userId","==",s.id)));D(new Set(ve.docs.map(at=>at.data().postId)))}}catch(ee){console.error("Error loading journey:",ee)}finally{A(!1)}}},[n,s]);_.useEffect(()=>{!B&&p&&Be()},[B,p,Be]);const tt=async ee=>{if(window.confirm("Delete this post?"))try{await Cr(Qe(_e,"posts",ee)),Ne(ve=>ve.filter(at=>at.id!==ee)),Kt("Post deleted","info")}catch(ve){console.error("Delete error:",ve),Kt("Failed to delete","error")}},Fe=async ee=>{if(!s)return;const ve=s.id,at=`${ee}_${ve}`,Dt=S.has(ee),jt=new Set(S);Dt?jt.delete(ee):jt.add(ee),D(jt),Ne(rn=>rn.map(Yt=>Yt.id===ee?{...Yt,likeCount:Math.max(0,(Yt.likeCount||0)+(Dt?-1:1))}:Yt));try{if(Dt)await Cr(Qe(_e,"postLikes",at)),await Sa(Qe(_e,"posts",ee),{likeCount:Al(-1)});else{await Gn(Qe(_e,"postLikes",at),{postId:ee,userId:ve,createdAt:vi()}),await Sa(Qe(_e,"posts",ee),{likeCount:Al(1)});const rn=de.find(Yt=>Yt.id===ee);rn&&Pn(rn.authorId,"like",{postId:ee})}}catch(rn){console.error("Like error:",rn),Be()}},Le=async ee=>{try{const ve=await Sn(In(Wt(_e,"postComments"),dn("postId","==",ee),Ym("createdAt","asc"),Xm(50)));L(at=>({...at,[ee]:ve.docs.map(Dt=>({id:Dt.id,...Dt.data()}))}))}catch(ve){console.error("Error loading comments:",ve)}},ze=ee=>{const ve=new Set(U);ve.has(ee)?ve.delete(ee):(ve.add(ee),q[ee]||Le(ee)),V(ve)},Tt=(ee,ve)=>{const at=ee.match(/@(\w*)$/);if(at){Jt(!0),Ct(ve);const Dt=St.filter(jt=>jt.name&&jt.name.toLowerCase().includes(at[1].toLowerCase())).slice(0,5);ds(Dt)}else Jt(!1),ds([])},bt=(ee,ve)=>{const Dt=(He[ve]||"").replace(/@\w*$/,`@${ee.name} `);xt(jt=>({...jt,[ve]:Dt})),Jt(!1),ds([])},It=(ee,ve)=>{xt(at=>({...at,[ee]:ve})),Tt(ve,ee)},Qt=async ee=>{const ve=(He[ee]||"").trim();if(!(!ve||!s)){ye(at=>({...at,[ee]:!0}));try{await Ia(Wt(_e,"postComments"),{postId:ee,authorId:s.id,authorName:s.name||"Unknown",authorPhotoURL:s.photoURL||null,content:ve,createdAt:vi()}),await Sa(Qe(_e,"posts",ee),{commentCount:Al(1)});const at=de.find(jt=>jt.id===ee);at&&Pn(at.authorId,"comment",{postId:ee});const Dt=ve.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Dt){const jt=new Set;Dt.forEach(rn=>{const Yt=rn.slice(1).trim(),$t=St.find(Mn=>Mn.name&&Mn.name.toLowerCase()===Yt.toLowerCase());$t&&!jt.has($t.id)&&(jt.add($t.id),Pn($t.id,"mention",{postId:ee}))})}xt(jt=>({...jt,[ee]:""})),Ne(jt=>jt.map(rn=>rn.id===ee?{...rn,commentCount:(rn.commentCount||0)+1}:rn)),await Le(ee)}catch(at){console.error("Comment error:",at),Kt("Failed to comment","error")}finally{ye(at=>({...at,[ee]:!1}))}}};return o||B||!s?a.jsx("div",{className:"prf-loading","data-theme":c?"dark":"light",children:a.jsx("div",{className:"prf-spinner"})}):!e||!t?null:p?a.jsxs("div",{className:"prf-page","data-theme":c?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:c?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"prf-main",children:[a.jsxs("div",{className:"prf-hero",children:[a.jsx("div",{className:"prf-avatar-lg",children:p.photoURL?a.jsx("img",{src:p.photoURL,alt:p.name}):a.jsx("span",{children:rm(p.name)})}),a.jsx("h1",{className:"prf-name",children:p.name}),a.jsxs("div",{className:"prf-buddy-action",children:[b==="none"&&a.jsx("button",{className:"prf-btn prf-btn-primary",onClick:hn,disabled:P,children:P?a.jsx("div",{className:"prf-btn-spinner"}):a.jsxs(a.Fragment,{children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Buddy"]})}),b==="pending_out"&&a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:he,disabled:P,children:P?a.jsx("div",{className:"prf-btn-spinner dark"}):"Cancel Request"}),b==="pending_in"&&a.jsxs("div",{className:"prf-btn-pair",children:[a.jsx("button",{className:"prf-btn prf-btn-success",onClick:Rn,disabled:P,children:P?a.jsx("div",{className:"prf-btn-spinner"}):"Accept"}),a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:he,disabled:P,children:"Decline"})]}),b==="buddy"&&a.jsx("button",{className:"prf-btn prf-btn-danger",onClick:De,disabled:P,children:P?a.jsx("div",{className:"prf-btn-spinner"}):"Remove Buddy"})]})]}),Ve?a.jsx("div",{className:"prf-stats-loading",children:a.jsx("div",{className:"prf-spinner"})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"prf-stats",children:[a.jsxs("div",{className:"prf-stat",children:[a.jsx("span",{className:"prf-stat-value",children:ne}),a.jsx("span",{className:"prf-stat-label",children:"Workouts"})]}),a.jsxs("div",{className:"prf-stat",children:[a.jsxs("span",{className:"prf-stat-value",children:[rO(K),a.jsx("span",{className:"prf-stat-unit",children:K>=1e3?"":"kg"})]}),a.jsxs("span",{className:"prf-stat-label",children:[K>=1e6?"Million kg":K>=1e3?"Tonnes":"Volume"," Lifted"]})]}),a.jsxs("div",{className:"prf-stat",children:[a.jsxs("span",{className:"prf-stat-value",children:[Re,a.jsx("span",{className:"prf-stat-unit",children:"wk"})]}),a.jsx("span",{className:"prf-stat-label",children:"Streak"})]})]}),(pe||Me>0)&&a.jsxs("div",{className:"prf-info-row",children:[pe&&a.jsxs("div",{className:"prf-info-card info-programme",children:[a.jsx("div",{className:"prf-info-icon",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),a.jsx("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"})]})}),a.jsxs("div",{className:"prf-info-text",children:[a.jsx("span",{className:"prf-info-label",children:pe}),a.jsx("div",{className:"prf-info-progress-bar",children:a.jsx("div",{className:"prf-info-progress-fill",style:{width:`${Math.min(sn,100)}%`}})}),a.jsxs("span",{className:"prf-info-sub",children:[sn,"% complete"]})]})]}),Me>0&&a.jsxs("div",{className:"prf-info-card info-habit",children:[a.jsx("div",{className:"prf-info-icon",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]})}),a.jsxs("div",{className:"prf-info-text",children:[a.jsxs("span",{className:"prf-info-value",children:[Me," day",Me!==1?"s":""]}),a.jsx("span",{className:"prf-info-sub",children:"Habit Streak"})]})]})]}),gt.length>0&&a.jsxs("div",{className:"prf-section",children:[a.jsx("h2",{className:"prf-section-title",children:"Top Lifts"}),a.jsx("div",{className:"prf-pb-list",children:gt.map((ee,ve)=>a.jsxs("div",{className:"prf-pb-item",children:[a.jsx("div",{className:"prf-pb-rank",children:ve===0?a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:a.jsx("path",{d:"M12 2l2.4 7.4H22l-6 4.4 2.3 7.2L12 16.6 5.7 21l2.3-7.2-6-4.4h7.6z"})}):`#${ve+1}`}),a.jsx("span",{className:"prf-pb-name",children:ee.name}),a.jsxs("span",{className:"prf-pb-weight",children:[ee.weight,a.jsx("span",{className:"prf-pb-unit",children:"kg"})," x",ee.reps]})]},ve))})]}),qt.length>0&&a.jsxs("div",{className:"prf-section",children:[a.jsxs("h2",{className:"prf-section-title",children:["Badges Earned (",qt.length,")"]}),a.jsx("div",{className:"prf-badge-row",children:qt.map(ee=>{const ve=Kh.find(at=>at.id===ee);return ve?a.jsx("button",{className:"prf-badge-chip",onClick:()=>kt(ve),children:a.jsx("img",{src:ve.img,alt:ve.name,className:"prf-badge-chip-img"})},ee):null})})]}),Vt&&a.jsx("div",{className:"prf-badge-overlay",onClick:()=>kt(null),children:a.jsxs("div",{className:"prf-badge-overlay-content",onClick:ee=>ee.stopPropagation(),children:[a.jsx("img",{src:Vt.img,alt:Vt.name,className:"prf-badge-overlay-img"}),a.jsx("p",{className:"prf-badge-overlay-desc",children:Vt.desc}),a.jsx("button",{className:"prf-badge-overlay-close",onClick:()=>kt(null),children:"Tap to close"})]})})]}),a.jsxs("div",{className:"prf-section",children:[a.jsx("h2",{className:"prf-section-title",children:`${p.name?.split(" ")[0]}'s Journey`}),we?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"prf-spinner"})}):de.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"No posts yet"})]}):a.jsx("div",{className:"journey-list",children:de.map(ee=>a.jsxs("div",{className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:ee.authorPhotoURL?a.jsx("img",{src:ee.authorPhotoURL,alt:""}):a.jsx("span",{children:rm(ee.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:ee.authorName}),a.jsx("span",{className:"journey-post-time",children:qT(ee.createdAt)})]}),ee.authorId===s.id&&a.jsx("button",{className:"journey-delete-btn",onClick:()=>tt(ee.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),ee.content&&a.jsx("p",{className:"journey-post-content",children:ee.content}),ee.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:ee.imageURL,alt:"Post",loading:"lazy"})}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${S.has(ee.id)?" liked":""}`,onClick:()=>Fe(ee.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:S.has(ee.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:ee.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${U.has(ee.id)?" active":""}`,onClick:()=>ze(ee.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:ee.commentCount||0})]})]}),U.has(ee.id)&&a.jsxs("div",{className:"journey-comments",children:[q[ee.id]?.length>0?q[ee.id].map(ve=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",onClick:()=>d(`/client/core-buddy/profile/${ve.authorId}`),children:ve.authorPhotoURL?a.jsx("img",{src:ve.authorPhotoURL,alt:""}):a.jsx("span",{children:rm(ve.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:ve.authorName}),a.jsx("span",{className:"journey-comment-text",children:ve.content})]}),a.jsx("span",{className:"journey-comment-time",children:qT(ve.createdAt)})]})]},ve.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("input",{type:"text",placeholder:"Comment... (@ to mention)",value:He[ee.id]||"",onChange:ve=>It(ee.id,ve.target.value),onKeyDown:ve=>{ve.key==="Enter"&&Qt(ee.id)},maxLength:300}),it&&Is===ee.id&&un.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:un.map(ve=>a.jsxs("button",{className:"mention-option",onClick:()=>bt(ve,ee.id),children:[a.jsx("div",{className:"mention-option-avatar",children:ve.photoURL?a.jsx("img",{src:ve.photoURL,alt:""}):a.jsx("span",{children:rm(ve.name)})}),a.jsx("span",{children:ve.name})]},ve.id))}),a.jsx("button",{onClick:()=>Qt(ee.id),disabled:!(He[ee.id]||"").trim()||H[ee.id],children:H[ee.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},ee.id))})]})]}),a.jsx(oa,{}),$&&a.jsxs("div",{className:`toast-notification ${$.type}`,children:[a.jsx("span",{className:"toast-icon",children:$.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):$.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:$.message})]})]}):a.jsxs("div",{className:"prf-page","data-theme":c?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions"})]})}),a.jsx("main",{className:"prf-main",children:a.jsx("p",{style:{textAlign:"center",color:"var(--text-tertiary)",padding:"40px 0"},children:"User not found"})}),a.jsx(oa,{})]})}const Ri=[{key:"pressUps",name:"Press-Ups",category:"Upper Body",unit:"reps"},{key:"squats",name:"Squats",category:"Lower Body",unit:"reps"},{key:"longJump",name:"Standing Long Jump",category:"Power",unit:"distance"},{key:"deadHang",name:"Dead Hang",category:"Upper Body",unit:"time"},{key:"plank",name:"Plank",category:"Core",unit:"time"},{key:"wallSit",name:"Wall Sit",category:"Lower Body",unit:"time"},{key:"chestPress",name:"Chest Press",category:"Upper Body",unit:"weight"}],vl=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function oO(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function Ci(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function lO(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function cO(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function im(n,e){if(!e)return"-";switch(n.unit){case"weight":return cO(e.weight,e.reps);case"time":return lO(e.time);case"reps":return e.reps?`${e.reps} reps`:"-";case"distance":return e.distance?`${e.distance} cm`:"-";default:return"-"}}function Uc(n,e){if(!e)return 0;switch(n.unit){case"weight":return(e.weight||0)*(e.reps||0);case"time":return e.time||0;case"reps":return e.reps||0;case"distance":return e.distance||0;default:return 0}}function mb(n,e){return!e||e===0?null:(n-e)/e*100}function uO({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return a.jsx("div",{className:"pb-trend-empty",children:a.jsx("p",{children:"Not enough data for trend line yet"})});const s=n.map(M=>{const P=M.benchmarks?.[e];if(!P)return 0;switch(t){case"weight":return(P.weight||0)*(P.reps||0);case"time":return P.time||0;case"reps":return P.reps||0;case"distance":return P.distance||0;default:return 0}}),o=Math.max(...s),c=Math.min(...s),u=o-c||1,d=300,p=100,g=20,b=d-g*2,x=p-g*2,T=s.map((M,P)=>{const Y=g+P/(s.length-1)*b,$=g+x-(M-c)/u*x;return{x:Y,y:$,value:M}}),N=T.map((M,P)=>`${P===0?"M":"L"} ${M.x} ${M.y}`).join(" "),B=N+` L ${T[T.length-1].x} ${g+x} L ${T[0].x} ${g+x} Z`;return a.jsxs("div",{className:"pb-trend-chart",children:[a.jsxs("svg",{viewBox:`0 0 ${d} ${p}`,preserveAspectRatio:"xMidYMid meet",children:[a.jsx("defs",{children:a.jsxs("linearGradient",{id:"trendGradientJr",x1:"0",y1:"0",x2:"0",y2:"1",children:[a.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),a.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),a.jsx("path",{d:B,fill:"url(#trendGradientJr)"}),a.jsx("path",{d:N,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),T.map((M,P)=>a.jsx("circle",{cx:M.x,cy:M.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},P))]}),a.jsx("div",{className:"pb-trend-labels",children:n.map((M,P)=>a.jsxs("span",{className:"pb-trend-label",children:[M.month.split("-")[1],"/",M.month.split("-")[0].slice(2)]},P))})]})}function hO(){const[n,e]=_.useState("bests"),[t,s]=_.useState([]),[o,c]=_.useState(!0),[u,d]=_.useState(!1),[p,g]=_.useState(0),[b,x]=_.useState(!1),[T,N]=_.useState(!1),[B,M]=_.useState(!1),[P,Y]=_.useState({}),[$,J]=_.useState({}),[de,Ne]=_.useState({}),[we,A]=_.useState({}),[S,D]=_.useState({}),[U,V]=_.useState(!1),[q,L]=_.useState({}),[He,xt]=_.useState([]),[H,ye]=_.useState(null),[Ve,Ke]=_.useState(null),[ne,O]=_.useState(!1),[K,Te]=_.useState(""),[Re,Ge]=_.useState(""),Me=_.useRef(null),ut=_.useRef(0),gt=_.useRef(0),et=_.useRef("right"),qt=_.useCallback(z=>{g(xe=>{const ke=Math.max(0,Math.min(Ri.length-1,z));return ke===xe?xe:(et.current=ke>xe?"right":"left",ke)})},[]),{currentUser:Dn,isClient:Vt,clientData:kt,loading:pe}=li(),{isDark:ln}=Bi(),sn=gr(),dt=_.useCallback((z,xe="info")=>{Ke({message:z,type:xe}),setTimeout(()=>Ke(null),4e3)},[]);_.useEffect(()=>{!pe&&(!Dn||!Vt)&&sn("/")},[Dn,Vt,pe,sn]),_.useEffect(()=>{kt&&St()},[kt]);const St=async()=>{try{const z=In(Wt(_e,"juniorPBs"),dn("clientId","==",kt.id)),ke=(await Sn(z)).docs.map(ot=>({id:ot.id,...ot.data()}));ke.sort((ot,vt)=>ot.month.localeCompare(vt.month)),s(ke);const Se=In(Wt(_e,"juniorPBTargets"),dn("clientId","==",kt.id)),be=await Sn(Se);if(!be.empty){const ot=be.docs[0].data();Ne(ot.targets||{}),A(ot.metricTargets||{}),D(ot.targets||{}),L(ot.metricTargets||{})}const rt=In(Wt(_e,"juniorAchievements"),dn("clientId","==",kt.id)),Rt=await Sn(rt);Rt.empty||xt(Rt.docs[0].data().badges||[])}catch(z){console.error("Error fetching junior personal bests:",z)}c(!1)},ct=oO(),it=t.find(z=>z.month===ct),Jt=t.filter(z=>z.month<ct),Is=Jt.length>0?Jt[Jt.length-1]:null;_.useEffect(()=>{it?(Y(it.benchmarks||{}),J(it.bodyMetrics||{})):(Y({}),J({}))},[it?.id]);const Ct=async(z,xe)=>{const ke=[];if(z==="strength"?Ri.forEach(Se=>{const be=de[Se.key];if(!be)return;const rt=xe[Se.key];if(!rt)return;let Rt;if(be.targetType==="time"){if(!be.targetValue)return;const ot=be.startValue||0,vt=rt.time||0,Nt=be.targetValue-ot;Rt=Nt===0?vt>=be.targetValue?1:0:Math.max(0,(vt-ot)/Nt)}else if(be.targetType==="reps"){if(!be.targetReps)return;const ot=be.startReps||0,vt=rt.reps||0,Nt=be.targetReps-ot;Rt=Nt===0?vt>=be.targetReps?1:0:Math.max(0,(vt-ot)/Nt)}else if(be.targetType==="distance"){if(!be.targetDistance)return;const ot=be.startDistance||0,vt=rt.distance||0,Nt=be.targetDistance-ot;Rt=Nt===0?vt>=be.targetDistance?1:0:Math.max(0,(vt-ot)/Nt)}else{if(!be.targetWeight&&!be.targetReps)return;const ot=(be.startWeight||0)*(be.startReps||0),vt=(be.targetWeight||0)*(be.targetReps||0),Nt=(rt.weight||0)*(rt.reps||0),mn=vt-ot;Rt=mn===0?Nt>=vt?1:0:Math.max(0,(Nt-ot)/mn)}if(Rt>=1){let ot,vt;be.targetType==="time"?(ot=He.some(Nt=>Nt.type==="strength"&&Nt.key===Se.key&&Nt.targetValue===be.targetValue),vt=`${Se.name} ${be.targetValue}s`):be.targetType==="reps"?(ot=He.some(Nt=>Nt.type==="strength"&&Nt.key===Se.key&&Nt.targetReps===be.targetReps),vt=`${Se.name} ${be.targetReps} reps`):be.targetType==="distance"?(ot=He.some(Nt=>Nt.type==="strength"&&Nt.key===Se.key&&Nt.targetDistance===be.targetDistance),vt=`${Se.name} ${be.targetDistance}cm`):(ot=He.some(Nt=>Nt.type==="strength"&&Nt.key===Se.key&&Nt.targetWeight===be.targetWeight&&Nt.targetReps===be.targetReps),vt=`${Se.name} ${be.targetWeight}kg  ${be.targetReps}`),ot||ke.push({type:"strength",key:Se.key,...be.targetType==="time"?{targetType:"time",targetValue:be.targetValue}:be.targetType==="reps"?{targetType:"reps",targetReps:be.targetReps}:be.targetType==="distance"?{targetType:"distance",targetDistance:be.targetDistance}:{targetWeight:be.targetWeight,targetReps:be.targetReps},achievedMonth:ct,label:vt})}}):vl.forEach(Se=>{const be=we[Se.key];if(!be||!be.targetValue)return;const rt=xe[Se.key];if(rt==null)return;const Rt=be.startValue||0,ot=be.targetValue,vt=ot-Rt;(vt===0?rt===ot?1:0:Math.max(0,(rt-Rt)/vt))>=1&&(He.some(er=>er.type==="metric"&&er.key===Se.key&&er.targetValue===ot)||ke.push({type:"metric",key:Se.key,targetValue:ot,achievedMonth:ct,label:`${Se.name} ${ot}${Se.suffix}`}))}),ke.length>0){const Se=[...He,...ke];await Gn(Qe(_e,"juniorAchievements",kt.id),{clientId:kt.id,badges:Se,updatedAt:mt.now()}),xt(Se),ye(ke),setTimeout(()=>ye(null),5e3)}},un=(z,xe)=>{if(z==="strength"){const ke=de[xe];if(!ke)return!1;switch(Ri.find(be=>be.key===xe)?.unit){case"time":return He.some(be=>be.type==="strength"&&be.key===xe&&be.targetValue===ke.targetValue);case"reps":return He.some(be=>be.type==="strength"&&be.key===xe&&be.targetReps===ke.targetReps);case"distance":return He.some(be=>be.type==="strength"&&be.key===xe&&be.targetDistance===ke.targetDistance);default:return!ke.targetWeight&&!ke.targetReps?!1:He.some(be=>be.type==="strength"&&be.key===xe&&be.targetWeight===ke.targetWeight&&be.targetReps===ke.targetReps)}}else{const ke=we[xe];return!ke||!ke.targetValue?!1:He.some(Se=>Se.type==="metric"&&Se.key===xe&&Se.targetValue===ke.targetValue)}},ds=async()=>{d(!0);try{const z=`${kt.id}_${ct}`,xe=it||{};await Gn(Qe(_e,"juniorPBs",z),{clientId:kt.id,month:ct,benchmarks:P,bodyMetrics:xe.bodyMetrics||$||{},createdAt:xe.createdAt||mt.now(),updatedAt:mt.now()}),await Ct("strength",P),dt("Benchmarks saved!","success"),x(!1),await St()}catch(z){console.error("Error saving benchmarks:",z),dt("Failed to save. Please try again.","error")}d(!1)},Kt=async()=>{d(!0);try{const z=`${kt.id}_${ct}`,xe=it||{};await Gn(Qe(_e,"juniorPBs",z),{clientId:kt.id,month:ct,benchmarks:xe.benchmarks||P||{},bodyMetrics:$,createdAt:xe.createdAt||mt.now(),updatedAt:mt.now()}),await Ct("metric",$),dt("Body metrics saved!","success"),N(!1),await St()}catch(z){console.error("Error saving metrics:",z),dt("Failed to save. Please try again.","error")}d(!1)},Pn=(z,xe,ke)=>{Y(Se=>({...Se,[z]:{...Se[z],[xe]:ke===""?"":parseFloat(ke)}}))},hn=(z,xe)=>{J(ke=>({...ke,[z]:xe===""?"":parseFloat(xe)}))},Rn=(z,xe,ke)=>{D(Se=>({...Se,[z]:{...Se[z],[xe]:ke===""?"":parseFloat(ke)}}))},he=async()=>{d(!0);try{const z=`targets_${kt.id}`,xe=it?.benchmarks||{},ke={};Ri.forEach(Se=>{const be=xe[Se.key];switch(Se.unit){case"time":S[Se.key]?.targetValue&&(ke[Se.key]={targetType:"time",targetValue:S[Se.key].targetValue,startValue:be?.time||0});break;case"reps":S[Se.key]?.targetReps&&(ke[Se.key]={targetType:"reps",targetReps:S[Se.key].targetReps,startReps:be?.reps||0});break;case"distance":S[Se.key]?.targetDistance&&(ke[Se.key]={targetType:"distance",targetDistance:S[Se.key].targetDistance,startDistance:be?.distance||0});break;default:(S[Se.key]?.targetWeight||S[Se.key]?.targetReps)&&(ke[Se.key]={targetWeight:S[Se.key].targetWeight||0,targetReps:S[Se.key].targetReps||0,startWeight:be?.weight||0,startReps:be?.reps||0})}}),await Gn(Qe(_e,"juniorPBTargets",z),{clientId:kt.id,targets:ke,metricTargets:we,updatedAt:mt.now()}),Ne(ke),D(ke),dt("Targets saved!","success"),M(!1)}catch(z){console.error("Error saving targets:",z),dt("Failed to save targets.","error")}d(!1)},De=(z,xe)=>{L(ke=>({...ke,[z]:{...ke[z],targetValue:xe===""?"":parseFloat(xe)}}))},Be=async()=>{d(!0);try{const z=`targets_${kt.id}`,xe={};vl.forEach(ke=>{if(q[ke.key]?.targetValue){const Se=it?.bodyMetrics?.[ke.key]||0;xe[ke.key]={targetValue:q[ke.key].targetValue,startValue:Se}}}),await Gn(Qe(_e,"juniorPBTargets",z),{clientId:kt.id,targets:de,metricTargets:xe,updatedAt:mt.now()}),A(xe),L(xe),dt("Metric targets saved!","success"),V(!1)}catch(z){console.error("Error saving metric targets:",z),dt("Failed to save targets.","error")}d(!1)},tt=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){d(!0);try{const z=Qe(_e,"juniorPBTargets",`targets_${kt.id}`);await Cr(z),Ne({}),A({}),D({}),L({}),dt("All goals have been reset","success")}catch(z){console.error("Error resetting targets:",z),dt("Failed to reset goals","error")}d(!1)}},Fe=(z,xe)=>{const ke=de[z];if(!ke||!xe)return null;if(ke.targetType==="time"){if(!ke.targetValue)return null;const ot=ke.startValue||0,vt=ke.targetValue,Nt=xe.time||0,mn=vt-ot;return mn<=0?Nt>=vt?1:0:Math.max(0,Math.min((Nt-ot)/mn,1))}if(ke.targetType==="reps"){if(!ke.targetReps)return null;const ot=ke.startReps||0,vt=ke.targetReps,Nt=xe.reps||0,mn=vt-ot;return mn<=0?Nt>=vt?1:0:Math.max(0,Math.min((Nt-ot)/mn,1))}if(ke.targetType==="distance"){if(!ke.targetDistance)return null;const ot=ke.startDistance||0,vt=ke.targetDistance,Nt=xe.distance||0,mn=vt-ot;return mn<=0?Nt>=vt?1:0:Math.max(0,Math.min((Nt-ot)/mn,1))}if(!ke.targetWeight&&!ke.targetReps)return null;const Se=(ke.startWeight||0)*(ke.startReps||0),be=(ke.targetWeight||0)*(ke.targetReps||0),rt=(xe.weight||0)*(xe.reps||0),Rt=be-Se;return Rt<=0?rt>=be?1:0:Math.max(0,Math.min((rt-Se)/Rt,1))},Le=z=>{const xe=we[z];if(!xe||!xe.targetValue)return null;const ke=it?.bodyMetrics?.[z];if(ke==null)return null;const Se=xe.startValue||0,be=xe.targetValue,rt=be-Se;return rt===0?ke===be?1:0:Math.max(0,Math.min((ke-Se)/rt,1))},ze=z=>{ut.current=z.touches[0].clientX,gt.current=0},Tt=z=>{gt.current=z.touches[0].clientX-ut.current},bt=()=>{gt.current<-50?qt(p+1):gt.current>50&&qt(p-1),gt.current=0},It=z=>{const xe=it?.bodyMetrics?.[z],ke=Is?.bodyMetrics?.[z];return xe==null||ke==null?null:parseFloat((xe-ke).toFixed(2))},Qt=t.find(z=>z.month===K),ee=t.find(z=>z.month===Re);if(pe||o)return a.jsxs("div",{className:"pb-page",children:[a.jsx("header",{className:"client-header",children:a.jsx("div",{className:"header-content",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),a.jsxs("main",{className:"pb-main",children:[a.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),a.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!Dn||!Vt||!kt)return null;const ve=Ri[p],at=it?.benchmarks?.[ve.key],Dt=Is?.benchmarks?.[ve.key],jt=Uc(ve,at),rn=Uc(ve,Dt),Yt=mb(jt,rn),$t=Fe(ve.key,at),Mn=$t!==null,rs=$t!==null&&$t>=1,bn=Mn?Math.round($t*60):jt>0?15:0,Cn=de[ve.key],Bn=z=>z?z.targetType==="time"?`${z.startValue||0}s  ${z.targetValue}s`:z.targetType==="reps"?`${z.startReps||0}  ${z.targetReps} reps`:z.targetType==="distance"?`${z.startDistance||0}  ${z.targetDistance}cm`:`${z.startWeight||0}kg${z.startReps||0}  ${z.targetWeight}kg${z.targetReps}`:null;return a.jsxs("div",{className:"pb-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>sn("/client"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsxs("main",{className:"pb-main page-transition-enter",children:[a.jsxs("div",{className:"pb-intro",children:[a.jsx("h2",{children:"Junior Strength Tests"}),a.jsx("p",{children:"Track your strength test results and body measurements each month."})]}),a.jsxs("div",{className:"pb-tabs",children:[a.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),a.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),a.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&a.jsxs("div",{className:"pb-strength-section",children:[!b&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-carousel",ref:Me,onTouchStart:ze,onTouchMove:Tt,onTouchEnd:bt,children:[a.jsx("div",{className:`pb-ring-container slide-from-${et.current}`,children:a.jsxs("div",{className:"pb-ring",children:[a.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:q0.map((z,xe)=>{const ke=xe<Math.round(bn);return a.jsx("line",{x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,className:`pb-ring-tick ${ke?rs?"hit":"filled":"empty"}`,strokeWidth:z.thick?"3":"2"},xe)})}),a.jsxs("div",{className:"pb-ring-center",children:[a.jsx("div",{className:"pb-ring-category",children:ve.category}),a.jsxs("div",{className:"pb-ring-exercise",children:[ve.name,un("strength",ve.key)&&a.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),a.jsx("div",{className:"pb-ring-value",children:at?im(ve,at):"-"}),Yt!==null&&a.jsxs("div",{className:`pb-ring-change ${Yt>=0?"positive":"negative"}`,children:[Yt>=0?"+":"",Yt.toFixed(1),"%"]}),Yt===null&&at&&a.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),Cn&&a.jsx("div",{className:`pb-ring-target ${rs?"hit":""}`,children:rs?"Target hit!":Bn(Cn)}),!Cn&&a.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},p),a.jsx("div",{className:"pb-carousel-dots",children:Ri.map((z,xe)=>a.jsx("button",{className:`pb-dot ${xe===p?"active":""}`,onClick:()=>qt(xe)},xe))}),a.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>qt(p-1),disabled:p===0,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),a.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>qt(p+1),disabled:p===Ri.length-1,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),a.jsxs("div",{className:"pb-trend-section",children:[a.jsx("h4",{children:"Trend"}),a.jsx(uO,{data:t,exerciseKey:ve.key,unit:ve.unit})]})]}),!b&&!B&&a.jsxs("div",{className:"pb-action-buttons",children:[a.jsx("button",{className:"pb-edit-btn",onClick:()=>x(!0),children:it?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),a.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>M(!0),children:Object.keys(de).length>0?"Edit Targets":"Set Targets"}),(Object.keys(de).length>0||Object.keys(we).length>0)&&a.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:tt,disabled:u,children:"Reset All Goals"})]}),b&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsxs("h3",{children:["Benchmarks - ",Ci(ct)]}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{x(!1),Y(it?.benchmarks||{})},children:""})]}),a.jsx("div",{className:"pb-edit-body",children:Ri.map(z=>a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:z.name}),z.unit==="weight"?a.jsxs("div",{className:"pb-edit-row",children:[a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",step:"0.5",value:P[z.key]?.weight??"",onChange:xe=>Pn(z.key,"weight",xe.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",value:P[z.key]?.reps??"",onChange:xe=>Pn(z.key,"reps",xe.target.value),placeholder:"0"})]})]}):z.unit==="reps"?a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Reps (max in 1 min)"}),a.jsx("input",{type:"number",value:P[z.key]?.reps??"",onChange:xe=>Pn(z.key,"reps",xe.target.value),placeholder:"0"})]})}):z.unit==="distance"?a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Distance (cm)"}),a.jsx("input",{type:"number",step:"0.5",value:P[z.key]?.distance??"",onChange:xe=>Pn(z.key,"distance",xe.target.value),placeholder:"0"})]})}):a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Time (seconds)"}),a.jsx("input",{type:"number",step:"0.01",value:P[z.key]?.time??"",onChange:xe=>Pn(z.key,"time",xe.target.value),placeholder:"0"})]})})]},z.key))}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{x(!1),Y(it?.benchmarks||{})},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:ds,disabled:u,children:u?"Saving...":"Save"})]})]}),B&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsx("h3",{children:"Set Your Targets"}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{M(!1),D(de)},children:""})]}),a.jsxs("div",{className:"pb-edit-body",children:[a.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),Ri.map(z=>{const xe=it?.benchmarks?.[z.key];let ke="-";if(xe)switch(z.unit){case"weight":(xe.weight||xe.reps)&&(ke=`${xe.weight||0}kg  ${xe.reps||0}`);break;case"time":xe.time&&(ke=`${xe.time}s`);break;case"reps":xe.reps&&(ke=`${xe.reps} reps`);break;case"distance":xe.distance&&(ke=`${xe.distance} cm`);break}return a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsxs("div",{className:"pb-edit-exercise-header",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:z.name}),a.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",ke]})]}),z.unit==="weight"?a.jsxs("div",{className:"pb-edit-row",children:[a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Target Weight (kg)"}),a.jsx("input",{type:"number",step:"0.5",value:S[z.key]?.targetWeight??"",onChange:Se=>Rn(z.key,"targetWeight",Se.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Target Reps"}),a.jsx("input",{type:"number",value:S[z.key]?.targetReps??"",onChange:Se=>Rn(z.key,"targetReps",Se.target.value),placeholder:"0"})]})]}):z.unit==="reps"?a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Target Reps (in 1 min)"}),a.jsx("input",{type:"number",value:S[z.key]?.targetReps??"",onChange:Se=>Rn(z.key,"targetReps",Se.target.value),placeholder:"0"})]})}):z.unit==="distance"?a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Target Distance (cm)"}),a.jsx("input",{type:"number",step:"0.5",value:S[z.key]?.targetDistance??"",onChange:Se=>Rn(z.key,"targetDistance",Se.target.value),placeholder:"0"})]})}):a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Target (seconds)"}),a.jsx("input",{type:"number",step:"1",value:S[z.key]?.targetValue??"",onChange:Se=>Rn(z.key,"targetValue",Se.target.value),placeholder:"0"})]})})]},z.key)})]}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{M(!1),D(de)},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:he,disabled:u,children:u?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&a.jsxs("div",{className:"pb-metrics-section",children:[!T&&!U&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-metrics-card",children:[a.jsx("h3",{children:"Body Measurements"}),a.jsx("p",{className:"pb-metrics-month",children:Ci(ct)}),a.jsx("div",{className:"pb-metrics-list",children:vl.map(z=>{const xe=it?.bodyMetrics?.[z.key],ke=It(z.key),Se=we[z.key],be=Le(z.key),rt=be!==null&&be>=1;return a.jsxs("div",{className:"pb-metric-row",children:[a.jsxs("div",{className:"pb-metric-top",children:[a.jsxs("div",{className:"pb-metric-left",children:[a.jsxs("span",{className:"pb-metric-name",children:[z.name,un("metric",z.key)&&a.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),Se&&a.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",Se.targetValue," ",z.suffix]})]}),a.jsxs("div",{className:"pb-metric-values",children:[a.jsx("span",{className:"pb-metric-current",children:xe!=null?`${xe} ${z.suffix}`:"-"}),ke!==null&&a.jsxs("span",{className:`pb-metric-change ${ke>0?"up":ke<0?"down":"same"}`,children:[ke>0?"+":"",ke," ",z.suffix]})]})]}),be!==null&&a.jsxs("div",{className:"pb-metric-progress",children:[a.jsx("div",{className:"pb-metric-bar",children:a.jsx("div",{className:`pb-metric-bar-fill ${rt?"hit":""}`,style:{width:`${Math.round(be*100)}%`}})}),a.jsx("span",{className:`pb-metric-percent ${rt?"hit":""}`,children:rt?"Hit!":`${Math.round(be*100)}%`})]})]},z.key)})})]}),a.jsxs("div",{className:"pb-action-buttons",children:[a.jsx("button",{className:"pb-edit-btn",onClick:()=>N(!0),children:it?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),a.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>V(!0),children:Object.keys(we).length>0?"Edit Targets":"Set Targets"}),(Object.keys(de).length>0||Object.keys(we).length>0)&&a.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:tt,disabled:u,children:"Reset All Goals"})]})]}),T&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsxs("h3",{children:["Measurements - ",Ci(ct)]}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{N(!1),J(it?.bodyMetrics||{})},children:""})]}),a.jsx("div",{className:"pb-edit-body",children:vl.map(z=>a.jsx("div",{className:"pb-edit-metric",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsxs("label",{children:[z.name," (",z.suffix,")"]}),a.jsx("input",{type:"number",step:"0.1",value:$[z.key]??"",onChange:xe=>hn(z.key,xe.target.value),placeholder:"0"})]})},z.key))}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{N(!1),J(it?.bodyMetrics||{})},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Kt,disabled:u,children:u?"Saving...":"Save"})]})]}),U&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsx("h3",{children:"Body Metric Targets"}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{V(!1),L(we)},children:""})]}),a.jsxs("div",{className:"pb-edit-body",children:[a.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),vl.map(z=>{const xe=it?.bodyMetrics?.[z.key];return a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsxs("div",{className:"pb-edit-exercise-header",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:z.name}),a.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",xe!=null?`${xe} ${z.suffix}`:"-"]})]}),a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsxs("label",{children:["Target (",z.suffix,")"]}),a.jsx("input",{type:"number",step:"0.1",value:q[z.key]?.targetValue??"",onChange:ke=>De(z.key,ke.target.value),placeholder:"0"})]})})]},z.key)})]}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{V(!1),L(we)},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Be,disabled:u,children:u?"Saving...":"Save Targets"})]})]})]}),n==="history"&&a.jsx("div",{className:"pb-history-section",children:t.length===0?a.jsxs("div",{className:"pb-empty",children:[a.jsx("h4",{children:"No records yet"}),a.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):a.jsxs(a.Fragment,{children:[He.length>0&&a.jsxs("div",{className:"pb-achievements-wall",children:[a.jsxs("h4",{className:"pb-achievements-wall-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),a.jsx("div",{className:"pb-achievements-list",children:[...He].reverse().map((z,xe)=>a.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${xe*.05}s`},children:[a.jsx("div",{className:"pb-achievement-star",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("div",{className:"pb-achievement-info",children:[a.jsx("span",{className:"pb-achievement-label",children:z.label}),a.jsx("span",{className:"pb-achievement-date",children:Ci(z.achievedMonth)})]})]},xe))})]}),a.jsx("div",{className:"pb-history-controls",children:a.jsx("button",{className:`pb-compare-toggle ${ne?"active":""}`,onClick:()=>{O(!ne),!ne&&t.length>=2&&(Te(t[0].month),Ge(t[t.length-1].month))},children:ne?"Back to Timeline":"Compare Months"})}),ne?a.jsxs("div",{className:"pb-compare",children:[a.jsxs("div",{className:"pb-compare-selectors",children:[a.jsxs("div",{className:"pb-compare-select",children:[a.jsx("label",{children:"From"}),a.jsx("select",{value:K,onChange:z=>Te(z.target.value),children:t.map(z=>a.jsx("option",{value:z.month,children:Ci(z.month)},z.month))})]}),a.jsx("div",{className:"pb-compare-vs",children:"vs"}),a.jsxs("div",{className:"pb-compare-select",children:[a.jsx("label",{children:"To"}),a.jsx("select",{value:Re,onChange:z=>Ge(z.target.value),children:t.map(z=>a.jsx("option",{value:z.month,children:Ci(z.month)},z.month))})]})]}),Qt&&ee&&a.jsxs("div",{className:"pb-compare-results",children:[a.jsxs("div",{className:"pb-compare-group",children:[a.jsx("h4",{children:"Strength Tests"}),a.jsxs("div",{className:"pb-compare-table",children:[a.jsxs("div",{className:"pb-compare-header-row",children:[a.jsx("span",{children:"Exercise"}),a.jsx("span",{children:Ci(K).split(" ")[0]}),a.jsx("span",{children:Ci(Re).split(" ")[0]}),a.jsx("span",{children:"Change"})]}),Ri.map(z=>{const xe=Qt.benchmarks?.[z.key],ke=ee.benchmarks?.[z.key],Se=Uc(z,xe),be=Uc(z,ke),rt=mb(be,Se);return a.jsxs("div",{className:"pb-compare-row",children:[a.jsx("span",{className:"pb-compare-name",children:z.name}),a.jsx("span",{className:"pb-compare-val",children:xe?im(z,xe):"-"}),a.jsx("span",{className:"pb-compare-val",children:ke?im(z,ke):"-"}),a.jsx("span",{className:`pb-compare-change ${rt!==null?rt>=0?"positive":"negative":""}`,children:rt!==null?`${rt>=0?"+":""}${rt.toFixed(1)}%`:"-"})]},z.key)})]})]}),a.jsxs("div",{className:"pb-compare-group",children:[a.jsx("h4",{children:"Body Measurements"}),a.jsxs("div",{className:"pb-compare-table",children:[a.jsxs("div",{className:"pb-compare-header-row",children:[a.jsx("span",{children:"Measurement"}),a.jsx("span",{children:Ci(K).split(" ")[0]}),a.jsx("span",{children:Ci(Re).split(" ")[0]}),a.jsx("span",{children:"Change"})]}),vl.map(z=>{const xe=Qt.bodyMetrics?.[z.key],ke=ee.bodyMetrics?.[z.key],Se=xe!=null&&ke!=null?parseFloat((ke-xe).toFixed(2)):null;return a.jsxs("div",{className:"pb-compare-row",children:[a.jsx("span",{className:"pb-compare-name",children:z.name}),a.jsx("span",{className:"pb-compare-val",children:xe!=null?`${xe}`:"-"}),a.jsx("span",{className:"pb-compare-val",children:ke!=null?`${ke}`:"-"}),a.jsx("span",{className:`pb-compare-change ${Se!==null?Se>0?"positive":Se<0?"negative":"neutral":""}`,children:Se!==null?`${Se>0?"+":""}${Se} ${z.suffix}`:"-"})]},z.key)})]})]})]})]}):a.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((z,xe)=>{const ke=t.filter(Se=>Se.month<z.month).pop();return a.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${xe*.05}s`},children:[a.jsx("div",{className:"pb-timeline-dot"}),a.jsxs("div",{className:"pb-timeline-card",children:[a.jsx("h4",{children:Ci(z.month)}),z.benchmarks&&Object.keys(z.benchmarks).length>0&&a.jsxs("div",{className:"pb-timeline-group",children:[a.jsx("h5",{children:"Strength Tests"}),Ri.map(Se=>{const be=z.benchmarks[Se.key];if(!be)return null;const rt=ke?.benchmarks?.[Se.key],Rt=Uc(Se,be),ot=Uc(Se,rt),vt=mb(Rt,ot);return a.jsxs("div",{className:"pb-timeline-row",children:[a.jsx("span",{className:"pb-timeline-label",children:Se.name}),a.jsxs("div",{className:"pb-timeline-values",children:[a.jsx("span",{className:"pb-timeline-value",children:im(Se,be)}),vt!==null&&a.jsxs("span",{className:`pb-timeline-change ${vt>=0?"positive":"negative"}`,children:[vt>=0?"+":"",vt.toFixed(1),"%"]})]})]},Se.key)})]}),z.bodyMetrics&&Object.keys(z.bodyMetrics).length>0&&a.jsxs("div",{className:"pb-timeline-group",children:[a.jsx("h5",{children:"Body Measurements"}),vl.map(Se=>{const be=z.bodyMetrics[Se.key];if(be==null)return null;const rt=ke?.bodyMetrics?.[Se.key],Rt=rt!=null?parseFloat((be-rt).toFixed(2)):null;return a.jsxs("div",{className:"pb-timeline-row",children:[a.jsx("span",{className:"pb-timeline-label",children:Se.name}),a.jsxs("div",{className:"pb-timeline-values",children:[a.jsxs("span",{className:"pb-timeline-value",children:[be," ",Se.suffix]}),Rt!==null&&a.jsxs("span",{className:`pb-timeline-change ${Rt>0?"positive":Rt<0?"negative":"neutral"}`,children:[Rt>0?"+":"",Rt," ",Se.suffix]})]})]},Se.key)})]})]})]},z.id)})})]})})]}),H&&a.jsx("div",{className:"pb-celebration-overlay",onClick:()=>ye(null),children:a.jsxs("div",{className:"pb-celebration-card",children:[a.jsx("div",{className:"pb-celebration-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsx("h3",{className:"pb-celebration-title",children:H.length===1?"Target Achieved!":`${H.length} Targets Achieved!`}),a.jsx("div",{className:"pb-celebration-badges",children:H.map((z,xe)=>a.jsx("div",{className:"pb-celebration-badge",children:z.label},xe))}),a.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Ve&&a.jsxs("div",{className:`toast-notification ${Ve.type}`,children:[a.jsx("span",{className:"toast-icon",children:Ve.type==="success"?a.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),a.jsx("span",{className:"toast-message",children:Ve.message}),a.jsx("button",{className:"toast-close",onClick:()=>Ke(null),children:""})]}),a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:"block-nav-tab",onClick:()=>sn("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),a.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),a.jsx("span",{children:"Home"})]}),a.jsxs("button",{className:"block-nav-tab",onClick:()=>sn("/client/forms"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),a.jsx("span",{children:"Forms"})]}),a.jsxs("button",{className:"block-nav-tab",onClick:()=>sn("/client/tools"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),a.jsx("span",{children:"Tools"})]}),a.jsxs("button",{className:"block-nav-tab active",children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 20V10"}),a.jsx("path",{d:"M18 20V4"}),a.jsx("path",{d:"M6 20v-4"})]}),a.jsx("span",{children:"PBs"})]}),kt?.circuitAccess&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>sn("/client/circuit"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 6v6l4 2"})]}),a.jsx("span",{children:"Circuit"})]})]})]})}const Gi=[{key:"chestPress",name:"Chest Press",category:"Upper Body - Push",unit:"weight"},{key:"shoulderPress",name:"Shoulder Press",category:"Upper Body - Push",unit:"weight"},{key:"seatedRow",name:"Seated Row",category:"Upper Body - Pull",unit:"weight"},{key:"latPulldown",name:"Lat Pulldown",category:"Upper Body - Pull",unit:"weight"},{key:"squat",name:"Squat",category:"Lower Body",unit:"weight"},{key:"deadlift",name:"Deadlift",category:"Lower Body",unit:"weight"},{key:"plank",name:"Plank",category:"Core",unit:"time"}],xl=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function dO(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function Ii(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function am(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function $T(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function Fc(n,e){return e?n.unit==="time"?e.time||0:(e.weight||0)*(e.reps||0):0}function pb(n,e){return!e||e===0?null:(n-e)/e*100}function fO({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return a.jsx("div",{className:"pb-trend-empty",children:a.jsx("p",{children:"Not enough data for trend line yet"})});const s=n.map(M=>{const P=M.benchmarks?.[e];return P?t==="time"?P.time||0:(P.weight||0)*(P.reps||0):0}),o=Math.max(...s),c=Math.min(...s),u=o-c||1,d=300,p=100,g=20,b=d-g*2,x=p-g*2,T=s.map((M,P)=>{const Y=g+P/(s.length-1)*b,$=g+x-(M-c)/u*x;return{x:Y,y:$,value:M}}),N=T.map((M,P)=>`${P===0?"M":"L"} ${M.x} ${M.y}`).join(" "),B=N+` L ${T[T.length-1].x} ${g+x} L ${T[0].x} ${g+x} Z`;return a.jsxs("div",{className:"pb-trend-chart",children:[a.jsxs("svg",{viewBox:`0 0 ${d} ${p}`,preserveAspectRatio:"xMidYMid meet",children:[a.jsx("defs",{children:a.jsxs("linearGradient",{id:"trendGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[a.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),a.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),a.jsx("path",{d:B,fill:"url(#trendGradient)"}),a.jsx("path",{d:N,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),T.map((M,P)=>a.jsx("circle",{cx:M.x,cy:M.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},P))]}),a.jsx("div",{className:"pb-trend-labels",children:n.map((M,P)=>a.jsxs("span",{className:"pb-trend-label",children:[M.month.split("-")[1],"/",M.month.split("-")[0].slice(2)]},P))})]})}function mO(){const[n,e]=_.useState("bests"),[t,s]=_.useState([]),[o,c]=_.useState(!0),[u,d]=_.useState(!1),[p,g]=_.useState(0),[b,x]=_.useState(!1),[T,N]=_.useState(!1),[B,M]=_.useState(!1),[P,Y]=_.useState({}),[$,J]=_.useState({}),[de,Ne]=_.useState({}),[we,A]=_.useState({}),[S,D]=_.useState({}),[U,V]=_.useState(!1),[q,L]=_.useState({}),[He,xt]=_.useState([]),[H,ye]=_.useState(null),[Ve,Ke]=_.useState(null),[ne,O]=_.useState(!1),[K,Te]=_.useState(""),[Re,Ge]=_.useState(""),[Me,ut]=_.useState({}),[gt,et]=_.useState({}),[qt,Dn]=_.useState(null),[Vt,kt]=_.useState(null),[pe,ln]=_.useState(""),sn=_.useRef(null),dt=_.useRef(0),St=_.useRef(0),ct=_.useRef("right"),it=_.useCallback(W=>{g(fe=>{const k=Math.max(0,Math.min(Gi.length-1,W));return k===fe?fe:(ct.current=k>fe?"right":"left",k)})},[]),{currentUser:Jt,isClient:Is,clientData:Ct,loading:un}=li(),{isDark:ds}=Bi(),Kt=gr(),[Pn]=jC(),hn=Pn.get("mode")==="corebuddy",Rn=!hn&&(!Ct?.clientType||Ct.clientType==="block"),he=_.useCallback((W,fe="info")=>{Ke({message:W,type:fe}),setTimeout(()=>Ke(null),4e3)},[]);_.useEffect(()=>{!un&&(!Jt||!Is)&&Kt("/")},[Jt,Is,un,Kt]),_.useEffect(()=>{Ct&&(Rn?De():(async()=>{try{const[fe,k,C]=await Promise.all([On(Qe(_e,"coreBuddyPBs",Ct.id)),On(Qe(_e,"coreBuddyTargets",Ct.id)),On(Qe(_e,"coreBuddyAchievements",Ct.id))]);fe.exists()&&ut(fe.data().exercises||{}),k.exists()&&et(k.data().targets||{}),C.exists()&&Dn(C.data())}catch(fe){console.error("Error loading Core Buddy PBs:",fe)}c(!1)})())},[Ct]);const De=async()=>{try{const W=In(Wt(_e,"personalBests"),dn("clientId","==",Ct.id)),k=(await Sn(W)).docs.map($e=>({id:$e.id,...$e.data()}));k.sort(($e,qe)=>$e.month.localeCompare(qe.month)),s(k);const C=In(Wt(_e,"personalBestTargets"),dn("clientId","==",Ct.id)),Q=await Sn(C);if(!Q.empty){const $e=Q.docs[0].data();Ne($e.targets||{}),A($e.metricTargets||{}),D($e.targets||{}),L($e.metricTargets||{})}const ae=In(Wt(_e,"achievements"),dn("clientId","==",Ct.id)),Ye=await Sn(ae);Ye.empty||xt(Ye.docs[0].data().badges||[])}catch(W){console.error("Error fetching personal bests:",W)}c(!1)},Be=async()=>{if(!Vt||!pe||!Ct)return;const W=parseFloat(pe),fe=Me[Vt];if(!fe||W<=fe.weight){he("Target must be higher than current PB","error");return}d(!0);try{const k={...gt,[Vt]:{targetWeight:W,setAt:mt.now(),currentPBWhenSet:fe.weight}};await Gn(Qe(_e,"coreBuddyTargets",Ct.id),{clientId:Ct.id,targets:k,updatedAt:mt.now()}),et(k),kt(null),ln(""),he("Target set!","success")}catch(k){console.error("Error saving target:",k),he("Failed to save target","error")}d(!1)},tt=W=>{if(!qt?.badges)return!1;const fe=gt[W];return fe?qt.badges.some(k=>k.type==="pb_target"&&k.exercise===W&&k.targetWeight===fe.targetWeight):!1},Fe=W=>{const fe=gt[W];if(!fe)return null;const k=Me[W];if(!k)return 0;const C=fe.currentPBWhenSet||0,Q=fe.targetWeight,ae=Q-C;return ae<=0?k.weight>=Q?1:0:Math.max(0,Math.min((k.weight-C)/ae,1))},Le=dO(),ze=t.find(W=>W.month===Le),Tt=t.filter(W=>W.month<Le),bt=Tt.length>0?Tt[Tt.length-1]:null;_.useEffect(()=>{ze?(Y(ze.benchmarks||{}),J(ze.bodyMetrics||{})):(Y({}),J({}))},[ze?.id]);const It=async(W,fe)=>{const k=[];if(W==="strength"?Gi.forEach(C=>{const Q=de[C.key];if(!Q)return;const ae=fe[C.key];if(!ae)return;let Ye;if(Q.targetType==="time"){if(!Q.targetValue)return;const $e=Q.startValue||0,qe=ae.time||0,Gt=Q.targetValue-$e;Ye=Gt===0?qe>=Q.targetValue?1:0:Math.max(0,(qe-$e)/Gt)}else{if(!Q.targetWeight&&!Q.targetReps)return;const $e=(Q.startWeight||0)*(Q.startReps||0),qe=(Q.targetWeight||0)*(Q.targetReps||0),Gt=(ae.weight||0)*(ae.reps||0),Mt=qe-$e;Ye=Mt===0?Gt>=qe?1:0:Math.max(0,(Gt-$e)/Mt)}if(Ye>=1&&!(Q.targetType==="time"?He.some(qe=>qe.type==="strength"&&qe.key===C.key&&qe.targetValue===Q.targetValue):He.some(qe=>qe.type==="strength"&&qe.key===C.key&&qe.targetWeight===Q.targetWeight&&qe.targetReps===Q.targetReps))){const qe=Q.targetType==="time"?`${C.name} ${Q.targetValue}s`:`${C.name} ${Q.targetWeight}kg  ${Q.targetReps}`;k.push({type:"strength",key:C.key,...Q.targetType==="time"?{targetType:"time",targetValue:Q.targetValue}:{targetWeight:Q.targetWeight,targetReps:Q.targetReps},achievedMonth:Le,label:qe})}}):xl.forEach(C=>{const Q=we[C.key];if(!Q||!Q.targetValue)return;const ae=fe[C.key];if(ae==null)return;const Ye=Q.startValue||0,$e=Q.targetValue,qe=$e-Ye;(qe===0?ae===$e?1:0:Math.max(0,(ae-Ye)/qe))>=1&&(He.some(Yn=>Yn.type==="metric"&&Yn.key===C.key&&Yn.targetValue===$e)||k.push({type:"metric",key:C.key,targetValue:$e,achievedMonth:Le,label:`${C.name} ${$e}${C.suffix}`}))}),k.length>0){const C=[...He,...k];await Gn(Qe(_e,"achievements",Ct.id),{clientId:Ct.id,badges:C,updatedAt:mt.now()}),xt(C),ye(k),setTimeout(()=>ye(null),5e3)}},Qt=(W,fe)=>{if(W==="strength"){const k=de[fe];return k?k.targetType==="time"?He.some(C=>C.type==="strength"&&C.key===fe&&C.targetValue===k.targetValue):!k.targetWeight&&!k.targetReps?!1:He.some(C=>C.type==="strength"&&C.key===fe&&C.targetWeight===k.targetWeight&&C.targetReps===k.targetReps):!1}else{const k=we[fe];return!k||!k.targetValue?!1:He.some(C=>C.type==="metric"&&C.key===fe&&C.targetValue===k.targetValue)}},ee=async()=>{d(!0);try{const W=`${Ct.id}_${Le}`,fe=ze||{};await Gn(Qe(_e,"personalBests",W),{clientId:Ct.id,month:Le,benchmarks:P,bodyMetrics:fe.bodyMetrics||$||{},createdAt:fe.createdAt||mt.now(),updatedAt:mt.now()}),await It("strength",P),he("Benchmarks saved!","success"),x(!1),await De()}catch(W){console.error("Error saving benchmarks:",W),he("Failed to save. Please try again.","error")}d(!1)},ve=async()=>{d(!0);try{const W=`${Ct.id}_${Le}`,fe=ze||{};await Gn(Qe(_e,"personalBests",W),{clientId:Ct.id,month:Le,benchmarks:fe.benchmarks||P||{},bodyMetrics:$,createdAt:fe.createdAt||mt.now(),updatedAt:mt.now()}),await It("metric",$),he("Body metrics saved!","success"),N(!1),await De()}catch(W){console.error("Error saving metrics:",W),he("Failed to save. Please try again.","error")}d(!1)},at=(W,fe,k)=>{Y(C=>({...C,[W]:{...C[W],[fe]:k===""?"":parseFloat(k)}}))},Dt=(W,fe)=>{J(k=>({...k,[W]:fe===""?"":parseFloat(fe)}))},jt=(W,fe,k)=>{D(C=>({...C,[W]:{...C[W],[fe]:k===""?"":parseFloat(k)}}))},rn=async()=>{d(!0);try{const W=`targets_${Ct.id}`,fe=ze?.benchmarks||{},k={};Gi.forEach(C=>{const Q=fe[C.key];C.unit==="time"?S[C.key]?.targetValue&&(k[C.key]={targetType:"time",targetValue:S[C.key].targetValue,startValue:Q?.time||0}):(S[C.key]?.targetWeight||S[C.key]?.targetReps)&&(k[C.key]={targetWeight:S[C.key].targetWeight||0,targetReps:S[C.key].targetReps||0,startWeight:Q?.weight||0,startReps:Q?.reps||0})}),await Gn(Qe(_e,"personalBestTargets",W),{clientId:Ct.id,targets:k,metricTargets:we,updatedAt:mt.now()}),Ne(k),D(k),he("Targets saved!","success"),M(!1)}catch(W){console.error("Error saving targets:",W),he("Failed to save targets.","error")}d(!1)},Yt=(W,fe)=>{L(k=>({...k,[W]:{...k[W],targetValue:fe===""?"":parseFloat(fe)}}))},$t=async()=>{d(!0);try{const W=`targets_${Ct.id}`,fe={};xl.forEach(k=>{if(q[k.key]?.targetValue){const C=ze?.bodyMetrics?.[k.key]||0;fe[k.key]={targetValue:q[k.key].targetValue,startValue:C}}}),await Gn(Qe(_e,"personalBestTargets",W),{clientId:Ct.id,targets:de,metricTargets:fe,updatedAt:mt.now()}),A(fe),L(fe),he("Metric targets saved!","success"),V(!1)}catch(W){console.error("Error saving metric targets:",W),he("Failed to save targets.","error")}d(!1)},Mn=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){d(!0);try{const W=Qe(_e,"personalBestTargets",`targets_${Ct.id}`);await Cr(W),Ne({}),A({}),D({}),L({}),he("All goals have been reset","success")}catch(W){console.error("Error resetting targets:",W),he("Failed to reset goals","error")}d(!1)}},rs=(W,fe)=>{const k=de[W];if(!k||!fe)return null;if(k.targetType==="time"){if(!k.targetValue)return null;const $e=k.startValue||0,qe=k.targetValue,Gt=fe.time||0,Mt=qe-$e;return Mt<=0?Gt>=qe?1:0:Math.max(0,Math.min((Gt-$e)/Mt,1))}if(!k.targetWeight&&!k.targetReps)return null;const C=(k.startWeight||0)*(k.startReps||0),Q=(k.targetWeight||0)*(k.targetReps||0),ae=(fe.weight||0)*(fe.reps||0),Ye=Q-C;return Ye<=0?ae>=Q?1:0:Math.max(0,Math.min((ae-C)/Ye,1))},bn=W=>{const fe=we[W];if(!fe||!fe.targetValue)return null;const k=ze?.bodyMetrics?.[W];if(k==null)return null;const C=fe.startValue||0,Q=fe.targetValue,ae=Q-C;return ae===0?k===Q?1:0:Math.max(0,Math.min((k-C)/ae,1))},Cn=W=>{dt.current=W.touches[0].clientX,St.current=0},Bn=W=>{St.current=W.touches[0].clientX-dt.current},z=()=>{St.current<-50?it(p+1):St.current>50&&it(p-1),St.current=0},xe=W=>{const fe=ze?.bodyMetrics?.[W],k=bt?.bodyMetrics?.[W];return fe==null||k==null?null:parseFloat((fe-k).toFixed(2))},ke=t.find(W=>W.month===K),Se=t.find(W=>W.month===Re);if(un||o)return a.jsxs("div",{className:"pb-page",children:[a.jsx("header",{className:"client-header",children:a.jsx("div",{className:"header-content",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),a.jsxs("main",{className:"pb-main",children:[a.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),a.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!Jt||!Is||!Ct)return null;if(Rn&&Ct?.isJunior)return a.jsx(hO,{});const be=Gi[p],rt=ze?.benchmarks?.[be.key],Rt=bt?.benchmarks?.[be.key],ot=Fc(be,rt),vt=Fc(be,Rt),Nt=pb(ot,vt),mn=rs(be.key,rt),er=mn!==null,Ts=mn!==null&&mn>=1,Ds=er?Math.round(mn*60):ot>0?15:0,ts=de[be.key];return a.jsxs("div",{className:"pb-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>Kt(hn?"/client/core-buddy":"/client"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsxs("main",{className:"pb-main page-transition-enter",children:[a.jsxs("div",{className:"pb-intro",children:[a.jsx("h2",{children:"Personal Bests"}),a.jsx("p",{children:Rn?"Track your strength benchmarks and body measurements each month.":"Your all-time best lifts from programme workouts."})]}),!Rn&&a.jsxs("div",{className:"pb-cb-section",children:[Object.keys(Me).length===0?a.jsxs("div",{className:"pb-empty",children:[a.jsx("div",{className:"pb-cb-empty-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),a.jsx("h4",{children:"No personal bests yet"}),a.jsx("p",{children:"Complete weight-based workouts to start tracking your personal bests."})]}):a.jsx("div",{className:"pb-cb-grid",children:Object.entries(Me).sort(([W],[fe])=>W.localeCompare(fe)).map(([W,fe],k)=>{const C=gt[W],Q=Fe(W),ae=Q!==null&&Q>=1,Ye=tt(W),$e=Q!==null?Math.round(Q*60):60;return a.jsxs("div",{className:"pb-cb-card",style:{animationDelay:`${k*.05}s`},children:[a.jsxs("div",{className:"pb-cb-card-ring",children:[a.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:a5.map((qe,Gt)=>{const Mt=Gt<$e;return a.jsx("line",{x1:qe.x1,y1:qe.y1,x2:qe.x2,y2:qe.y2,className:`pb-ring-tick ${Mt?ae?"hit":"filled":"empty"}`,strokeWidth:qe.thick?"2":"1.5"},Gt)})}),a.jsx("div",{className:"pb-cb-ring-icon",children:Ye?a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})})]}),a.jsxs("div",{className:"pb-cb-card-info",children:[a.jsx("h4",{className:"pb-cb-card-name",children:W}),a.jsxs("div",{className:"pb-cb-card-value",children:[fe.weight,"kg  ",fe.reps]}),fe.achievedAt&&a.jsx("div",{className:"pb-cb-card-date",children:(fe.achievedAt.toDate?fe.achievedAt.toDate():new Date(fe.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),C&&!ae&&a.jsxs("div",{className:"pb-cb-target-info",children:["Target: ",C.targetWeight,"kg (",Math.round((Q||0)*100),"%)"]}),C&&ae&&!Ye&&a.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),Ye&&a.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),a.jsx("div",{className:"pb-cb-card-action",children:C?ae&&Ye?a.jsx("button",{className:"pb-cb-target-btn",onClick:()=>{kt(W),ln("")},children:a.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 5v14M5 12h14"})})}):null:a.jsx("button",{className:"pb-cb-target-btn",onClick:()=>{kt(W),ln("")},children:a.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("circle",{cx:"12",cy:"12",r:"6"}),a.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]},W)})}),Object.keys(Me).length>0&&a.jsxs("button",{className:"pb-cb-achievements-link",onClick:()=>Kt("/client/core-buddy/achievements"),children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"View Achievements",a.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),Vt&&a.jsx("div",{className:"pb-cb-target-modal-overlay",onClick:()=>kt(null),children:a.jsxs("div",{className:"pb-cb-target-modal",onClick:W=>W.stopPropagation(),children:[a.jsx("h3",{children:"Set Target"}),a.jsx("p",{className:"pb-cb-target-exercise-name",children:Vt}),a.jsxs("div",{className:"pb-cb-target-current",children:["Current PB: ",a.jsxs("strong",{children:[Me[Vt]?.weight,"kg"]})]}),a.jsxs("div",{className:"pb-cb-target-input-wrap",children:[a.jsx("label",{children:"Your target (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",step:"0.5",value:pe,onChange:W=>ln(W.target.value),placeholder:String((Me[Vt]?.weight||0)+5),className:"pb-cb-target-input",autoFocus:!0})]}),a.jsxs("div",{className:"pb-cb-target-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>kt(null),children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Be,disabled:u,children:u?"Saving...":"Set Target"})]})]})})]}),Rn&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-tabs",children:[a.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),a.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),a.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&a.jsxs("div",{className:"pb-strength-section",children:[!b&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-carousel",ref:sn,onTouchStart:Cn,onTouchMove:Bn,onTouchEnd:z,children:[a.jsx("div",{className:`pb-ring-container slide-from-${ct.current}`,children:a.jsxs("div",{className:"pb-ring",children:[a.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:q0.map((W,fe)=>{const k=fe<Math.round(Ds);return a.jsx("line",{x1:W.x1,y1:W.y1,x2:W.x2,y2:W.y2,className:`pb-ring-tick ${k?Ts?"hit":"filled":"empty"}`,strokeWidth:W.thick?"3":"2"},fe)})}),a.jsxs("div",{className:"pb-ring-center",children:[a.jsx("div",{className:"pb-ring-category",children:be.category}),a.jsxs("div",{className:"pb-ring-exercise",children:[be.name,Qt("strength",be.key)&&a.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),a.jsx("div",{className:"pb-ring-value",children:rt?be.unit==="time"?am(rt.time):$T(rt.weight,rt.reps):"-"}),Nt!==null&&a.jsxs("div",{className:`pb-ring-change ${Nt>=0?"positive":"negative"}`,children:[Nt>=0?"+":"",Nt.toFixed(1),"%"]}),Nt===null&&rt&&a.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),ts&&a.jsx("div",{className:`pb-ring-target ${Ts?"hit":""}`,children:Ts?"Target hit!":ts.targetType==="time"?`${ts.startValue||0}s  ${ts.targetValue}s`:`${ts.startWeight||0}kg${ts.startReps||0}  ${ts.targetWeight}kg${ts.targetReps}`}),!ts&&a.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},p),a.jsx("div",{className:"pb-carousel-dots",children:Gi.map((W,fe)=>a.jsx("button",{className:`pb-dot ${fe===p?"active":""}`,onClick:()=>it(fe)},fe))}),a.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>it(p-1),disabled:p===0,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),a.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>it(p+1),disabled:p===Gi.length-1,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),a.jsxs("div",{className:"pb-trend-section",children:[a.jsx("h4",{children:"Trend"}),a.jsx(fO,{data:t,exerciseKey:be.key,unit:be.unit})]})]}),!b&&!B&&a.jsxs("div",{className:"pb-action-buttons",children:[a.jsx("button",{className:"pb-edit-btn",onClick:()=>x(!0),children:ze?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),a.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>M(!0),children:Object.keys(de).length>0?"Edit Targets":"Set Targets"}),(Object.keys(de).length>0||Object.keys(we).length>0)&&a.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Mn,disabled:u,children:"Reset All Goals"})]}),b&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsxs("h3",{children:["Benchmarks - ",Ii(Le)]}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{x(!1),Y(ze?.benchmarks||{})},children:""})]}),a.jsx("div",{className:"pb-edit-body",children:Gi.map(W=>a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:W.name}),W.unit==="weight"?a.jsxs("div",{className:"pb-edit-row",children:[a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",step:"0.5",value:P[W.key]?.weight??"",onChange:fe=>at(W.key,"weight",fe.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",value:P[W.key]?.reps??"",onChange:fe=>at(W.key,"reps",fe.target.value),placeholder:"0"})]})]}):a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Time (seconds)"}),a.jsx("input",{type:"number",step:"0.01",value:P[W.key]?.time??"",onChange:fe=>at(W.key,"time",fe.target.value),placeholder:"0"})]})})]},W.key))}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{x(!1),Y(ze?.benchmarks||{})},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:ee,disabled:u,children:u?"Saving...":"Save"})]})]}),B&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsx("h3",{children:"Set Your Targets"}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{M(!1),D(de)},children:""})]}),a.jsxs("div",{className:"pb-edit-body",children:[a.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),Gi.map(W=>{const fe=ze?.benchmarks?.[W.key];let k="-";return fe&&(W.unit==="time"&&fe.time?k=`${fe.time}s`:(fe.weight||fe.reps)&&(k=`${fe.weight||0}kg  ${fe.reps||0}`)),a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsxs("div",{className:"pb-edit-exercise-header",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:W.name}),a.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",k]})]}),W.unit==="weight"?a.jsxs("div",{className:"pb-edit-row",children:[a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Target Weight (kg)"}),a.jsx("input",{type:"number",step:"0.5",value:S[W.key]?.targetWeight??"",onChange:C=>jt(W.key,"targetWeight",C.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Target Reps"}),a.jsx("input",{type:"number",value:S[W.key]?.targetReps??"",onChange:C=>jt(W.key,"targetReps",C.target.value),placeholder:"0"})]})]}):a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Target (seconds)"}),a.jsx("input",{type:"number",step:"1",value:S[W.key]?.targetValue??"",onChange:C=>jt(W.key,"targetValue",C.target.value),placeholder:"0"})]})})]},W.key)})]}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{M(!1),D(de)},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:rn,disabled:u,children:u?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&a.jsxs("div",{className:"pb-metrics-section",children:[!T&&!U&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-metrics-card",children:[a.jsx("h3",{children:"Body Measurements"}),a.jsx("p",{className:"pb-metrics-month",children:Ii(Le)}),a.jsx("div",{className:"pb-metrics-list",children:xl.map(W=>{const fe=ze?.bodyMetrics?.[W.key],k=xe(W.key),C=we[W.key],Q=bn(W.key),ae=Q!==null&&Q>=1;return a.jsxs("div",{className:"pb-metric-row",children:[a.jsxs("div",{className:"pb-metric-top",children:[a.jsxs("div",{className:"pb-metric-left",children:[a.jsxs("span",{className:"pb-metric-name",children:[W.name,Qt("metric",W.key)&&a.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),C&&a.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",C.targetValue," ",W.suffix]})]}),a.jsxs("div",{className:"pb-metric-values",children:[a.jsx("span",{className:"pb-metric-current",children:fe!=null?`${fe} ${W.suffix}`:"-"}),k!==null&&a.jsxs("span",{className:`pb-metric-change ${k>0?"up":k<0?"down":"same"}`,children:[k>0?"+":"",k," ",W.suffix]})]})]}),Q!==null&&a.jsxs("div",{className:"pb-metric-progress",children:[a.jsx("div",{className:"pb-metric-bar",children:a.jsx("div",{className:`pb-metric-bar-fill ${ae?"hit":""}`,style:{width:`${Math.round(Q*100)}%`}})}),a.jsx("span",{className:`pb-metric-percent ${ae?"hit":""}`,children:ae?"Hit!":`${Math.round(Q*100)}%`})]})]},W.key)})})]}),a.jsxs("div",{className:"pb-action-buttons",children:[a.jsx("button",{className:"pb-edit-btn",onClick:()=>N(!0),children:ze?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),a.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>V(!0),children:Object.keys(we).length>0?"Edit Targets":"Set Targets"}),(Object.keys(de).length>0||Object.keys(we).length>0)&&a.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Mn,disabled:u,children:"Reset All Goals"})]})]}),T&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsxs("h3",{children:["Measurements - ",Ii(Le)]}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{N(!1),J(ze?.bodyMetrics||{})},children:""})]}),a.jsx("div",{className:"pb-edit-body",children:xl.map(W=>a.jsx("div",{className:"pb-edit-metric",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsxs("label",{children:[W.name," (",W.suffix,")"]}),a.jsx("input",{type:"number",step:"0.1",value:$[W.key]??"",onChange:fe=>Dt(W.key,fe.target.value),placeholder:"0"})]})},W.key))}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{N(!1),J(ze?.bodyMetrics||{})},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:ve,disabled:u,children:u?"Saving...":"Save"})]})]}),U&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsx("h3",{children:"Body Metric Targets"}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{V(!1),L(we)},children:""})]}),a.jsxs("div",{className:"pb-edit-body",children:[a.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),xl.map(W=>{const fe=ze?.bodyMetrics?.[W.key];return a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsxs("div",{className:"pb-edit-exercise-header",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:W.name}),a.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",fe!=null?`${fe} ${W.suffix}`:"-"]})]}),a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsxs("label",{children:["Target (",W.suffix,")"]}),a.jsx("input",{type:"number",step:"0.1",value:q[W.key]?.targetValue??"",onChange:k=>Yt(W.key,k.target.value),placeholder:"0"})]})})]},W.key)})]}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{V(!1),L(we)},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:$t,disabled:u,children:u?"Saving...":"Save Targets"})]})]})]}),n==="history"&&a.jsx("div",{className:"pb-history-section",children:t.length===0?a.jsxs("div",{className:"pb-empty",children:[a.jsx("h4",{children:"No records yet"}),a.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):a.jsxs(a.Fragment,{children:[He.length>0&&a.jsxs("div",{className:"pb-achievements-wall",children:[a.jsxs("h4",{className:"pb-achievements-wall-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),a.jsx("div",{className:"pb-achievements-list",children:[...He].reverse().map((W,fe)=>a.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${fe*.05}s`},children:[a.jsx("div",{className:"pb-achievement-star",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("div",{className:"pb-achievement-info",children:[a.jsx("span",{className:"pb-achievement-label",children:W.label}),a.jsx("span",{className:"pb-achievement-date",children:Ii(W.achievedMonth)})]})]},fe))})]}),a.jsx("div",{className:"pb-history-controls",children:a.jsx("button",{className:`pb-compare-toggle ${ne?"active":""}`,onClick:()=>{O(!ne),!ne&&t.length>=2&&(Te(t[0].month),Ge(t[t.length-1].month))},children:ne?"Back to Timeline":"Compare Months"})}),ne?a.jsxs("div",{className:"pb-compare",children:[a.jsxs("div",{className:"pb-compare-selectors",children:[a.jsxs("div",{className:"pb-compare-select",children:[a.jsx("label",{children:"From"}),a.jsx("select",{value:K,onChange:W=>Te(W.target.value),children:t.map(W=>a.jsx("option",{value:W.month,children:Ii(W.month)},W.month))})]}),a.jsx("div",{className:"pb-compare-vs",children:"vs"}),a.jsxs("div",{className:"pb-compare-select",children:[a.jsx("label",{children:"To"}),a.jsx("select",{value:Re,onChange:W=>Ge(W.target.value),children:t.map(W=>a.jsx("option",{value:W.month,children:Ii(W.month)},W.month))})]})]}),ke&&Se&&a.jsxs("div",{className:"pb-compare-results",children:[a.jsxs("div",{className:"pb-compare-group",children:[a.jsx("h4",{children:"Strength Benchmarks"}),a.jsxs("div",{className:"pb-compare-table",children:[a.jsxs("div",{className:"pb-compare-header-row",children:[a.jsx("span",{children:"Exercise"}),a.jsx("span",{children:Ii(K).split(" ")[0]}),a.jsx("span",{children:Ii(Re).split(" ")[0]}),a.jsx("span",{children:"Change"})]}),Gi.map(W=>{const fe=ke.benchmarks?.[W.key],k=Se.benchmarks?.[W.key],C=Fc(W,fe),Q=Fc(W,k),ae=pb(Q,C);return a.jsxs("div",{className:"pb-compare-row",children:[a.jsx("span",{className:"pb-compare-name",children:W.name}),a.jsx("span",{className:"pb-compare-val",children:fe?W.unit==="time"?am(fe.time):`${fe.weight}x${fe.reps}`:"-"}),a.jsx("span",{className:"pb-compare-val",children:k?W.unit==="time"?am(k.time):`${k.weight}x${k.reps}`:"-"}),a.jsx("span",{className:`pb-compare-change ${ae!==null?ae>=0?"positive":"negative":""}`,children:ae!==null?`${ae>=0?"+":""}${ae.toFixed(1)}%`:"-"})]},W.key)})]})]}),a.jsxs("div",{className:"pb-compare-group",children:[a.jsx("h4",{children:"Body Measurements"}),a.jsxs("div",{className:"pb-compare-table",children:[a.jsxs("div",{className:"pb-compare-header-row",children:[a.jsx("span",{children:"Measurement"}),a.jsx("span",{children:Ii(K).split(" ")[0]}),a.jsx("span",{children:Ii(Re).split(" ")[0]}),a.jsx("span",{children:"Change"})]}),xl.map(W=>{const fe=ke.bodyMetrics?.[W.key],k=Se.bodyMetrics?.[W.key],C=fe!=null&&k!=null?parseFloat((k-fe).toFixed(2)):null;return a.jsxs("div",{className:"pb-compare-row",children:[a.jsx("span",{className:"pb-compare-name",children:W.name}),a.jsx("span",{className:"pb-compare-val",children:fe!=null?`${fe}`:"-"}),a.jsx("span",{className:"pb-compare-val",children:k!=null?`${k}`:"-"}),a.jsx("span",{className:`pb-compare-change ${C!==null?C>0?"positive":C<0?"negative":"neutral":""}`,children:C!==null?`${C>0?"+":""}${C} ${W.suffix}`:"-"})]},W.key)})]})]})]})]}):a.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((W,fe)=>{const k=t.find(C=>C.month<W.month&&t.indexOf(C)===t.indexOf(W)-1)||t.filter(C=>C.month<W.month).pop();return a.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${fe*.05}s`},children:[a.jsx("div",{className:"pb-timeline-dot"}),a.jsxs("div",{className:"pb-timeline-card",children:[a.jsx("h4",{children:Ii(W.month)}),W.benchmarks&&Object.keys(W.benchmarks).length>0&&a.jsxs("div",{className:"pb-timeline-group",children:[a.jsx("h5",{children:"Strength Benchmarks"}),Gi.map(C=>{const Q=W.benchmarks[C.key];if(!Q)return null;const ae=k?.benchmarks?.[C.key],Ye=Fc(C,Q),$e=Fc(C,ae),qe=pb(Ye,$e);return a.jsxs("div",{className:"pb-timeline-row",children:[a.jsx("span",{className:"pb-timeline-label",children:C.name}),a.jsxs("div",{className:"pb-timeline-values",children:[a.jsx("span",{className:"pb-timeline-value",children:C.unit==="time"?am(Q.time):$T(Q.weight,Q.reps)}),qe!==null&&a.jsxs("span",{className:`pb-timeline-change ${qe>=0?"positive":"negative"}`,children:[qe>=0?"+":"",qe.toFixed(1),"%"]})]})]},C.key)})]}),W.bodyMetrics&&Object.keys(W.bodyMetrics).length>0&&a.jsxs("div",{className:"pb-timeline-group",children:[a.jsx("h5",{children:"Body Measurements"}),xl.map(C=>{const Q=W.bodyMetrics[C.key];if(Q==null)return null;const ae=k?.bodyMetrics?.[C.key],Ye=ae!=null?parseFloat((Q-ae).toFixed(2)):null;return a.jsxs("div",{className:"pb-timeline-row",children:[a.jsx("span",{className:"pb-timeline-label",children:C.name}),a.jsxs("div",{className:"pb-timeline-values",children:[a.jsxs("span",{className:"pb-timeline-value",children:[Q," ",C.suffix]}),Ye!==null&&a.jsxs("span",{className:`pb-timeline-change ${Ye>0?"positive":Ye<0?"negative":"neutral"}`,children:[Ye>0?"+":"",Ye," ",C.suffix]})]})]},C.key)})]})]})]},W.id)})})]})})]})]}),H&&a.jsx("div",{className:"pb-celebration-overlay",onClick:()=>ye(null),children:a.jsxs("div",{className:"pb-celebration-card",children:[a.jsx("div",{className:"pb-celebration-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsx("h3",{className:"pb-celebration-title",children:H.length===1?"Target Achieved!":`${H.length} Targets Achieved!`}),a.jsx("div",{className:"pb-celebration-badges",children:H.map((W,fe)=>a.jsx("div",{className:"pb-celebration-badge",children:W.label},fe))}),a.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Ve&&a.jsxs("div",{className:`toast-notification ${Ve.type}`,children:[a.jsx("span",{className:"toast-icon",children:Ve.type==="success"?a.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),a.jsx("span",{className:"toast-message",children:Ve.message}),a.jsx("button",{className:"toast-close",onClick:()=>Ke(null),children:""})]}),Rn&&a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:"block-nav-tab",onClick:()=>Kt("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),a.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),a.jsx("span",{children:"Home"})]}),a.jsxs("button",{className:"block-nav-tab",onClick:()=>Kt("/client/forms"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),a.jsx("span",{children:"Forms"})]}),a.jsxs("button",{className:"block-nav-tab",onClick:()=>Kt("/client/tools"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),a.jsx("span",{children:"Tools"})]}),a.jsxs("button",{className:"block-nav-tab active",children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 20V10"}),a.jsx("path",{d:"M18 20V4"}),a.jsx("path",{d:"M6 20v-4"})]}),a.jsx("span",{children:"PBs"})]}),Ct?.circuitAccess&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>Kt("/client/circuit"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 6v6l4 2"})]}),a.jsx("span",{children:"Circuit"})]})]}),hn&&a.jsx(oa,{active:"progress"})]})}const pO=_.lazy(()=>Dr(()=>import("./Dashboard-CCVPrbJC.js"),__vite__mapDeps([0,1]))),gO=_.lazy(()=>Dr(()=>import("./AddClient-BzTijwV3.js"),__vite__mapDeps([2,3]))),yO=_.lazy(()=>Dr(()=>import("./ClientDashboard-BEh53zxc.js"),[])),bO=_.lazy(()=>Dr(()=>import("./ClientForms-BSrDjP_G.js"),__vite__mapDeps([4,5]))),vO=_.lazy(()=>Dr(()=>import("./ClientTools-CYsUpTej.js"),__vite__mapDeps([6,7]))),xO=_.lazy(()=>Dr(()=>import("./MacroCalculator-jYn2G75o.js"),__vite__mapDeps([8,7]))),_O=_.lazy(()=>Dr(()=>import("./ProteinSnacks-BdKppL5t.js"),__vite__mapDeps([9,7]))),wO=_.lazy(()=>Dr(()=>import("./DailyMotivation-Ds-cdc9r.js"),__vite__mapDeps([10,7]))),TO=_.lazy(()=>Dr(()=>import("./CircuitDashboard-suAndDHq.js"),__vite__mapDeps([11,12]))),EO=_.lazy(()=>Dr(()=>import("./CircuitBooking-C0izvzR4.js"),__vite__mapDeps([13,14,12]))),kO=_.lazy(()=>Dr(()=>import("./Leaderboard-CVGQN7gh.js"),__vite__mapDeps([15,16]))),SO=_.lazy(()=>Dr(()=>import("./UpgradePage-CCwOAvfF.js"),__vite__mapDeps([17,18,19]))),jO=_.lazy(()=>Dr(()=>import("./SignUp-DvHAwXak.js"),[])),NO=_.lazy(()=>Dr(()=>import("./Onboarding-WSk1T9SY.js"),__vite__mapDeps([20,18,21])));function AO({children:n}){const{pathname:e}=Oi();return _.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),_.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),n}function RO(){const n=gr();return _.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const t=e.replace("/login","")||"/";n(t,{replace:!0})}},[n]),null}function CO(){return a.jsx(XV,{children:a.jsx(YV,{children:a.jsx(t5,{children:a.jsxs(wC,{basename:"/login",children:[a.jsx(RO,{}),a.jsx(AO,{children:a.jsx(_.Suspense,{fallback:null,children:a.jsxs(XR,{children:[a.jsx(is,{path:"/",element:a.jsx(r5,{})}),a.jsx(is,{path:"/dashboard",element:a.jsx(pO,{})}),a.jsx(is,{path:"/add-client",element:a.jsx(gO,{})}),a.jsx(is,{path:"/client",element:a.jsx(yO,{})}),a.jsx(is,{path:"/client/forms",element:a.jsx(bO,{})}),a.jsx(is,{path:"/client/tools",element:a.jsx(vO,{})}),a.jsx(is,{path:"/client/tools/macros",element:a.jsx(xO,{})}),a.jsx(is,{path:"/client/tools/snacks",element:a.jsx(_O,{})}),a.jsx(is,{path:"/client/tools/motivation",element:a.jsx(wO,{})}),a.jsx(is,{path:"/client/personal-bests",element:a.jsx(bl,{feature:"personalBests",children:a.jsx(mO,{})})}),a.jsx(is,{path:"/client/circuit",element:a.jsx(TO,{})}),a.jsx(is,{path:"/client/circuit/booking",element:a.jsx(EO,{})}),a.jsx(is,{path:"/client/core-buddy",element:a.jsx(j5,{})}),a.jsx(is,{path:"/client/core-buddy/nutrition",element:a.jsx(bl,{feature:"nutrition",children:a.jsx(R5,{})})}),a.jsx(is,{path:"/client/core-buddy/workouts",element:a.jsx(F5,{})}),a.jsx(is,{path:"/client/core-buddy/programmes",element:a.jsx(bl,{feature:"programmes",children:a.jsx(W5,{})})}),a.jsx(is,{path:"/client/core-buddy/achievements",element:a.jsx(bl,{feature:"achievements",children:a.jsx(J5,{})})}),a.jsx(is,{path:"/client/core-buddy/consistency",element:a.jsx(bl,{feature:"consistency",children:a.jsx(tO,{})})}),a.jsx(is,{path:"/client/core-buddy/buddies",element:a.jsx(bl,{feature:"buddies",children:a.jsx(nO,{})})}),a.jsx(is,{path:"/client/core-buddy/profile/:userId",element:a.jsx(aO,{})}),a.jsx(is,{path:"/client/leaderboard",element:a.jsx(bl,{feature:"leaderboard",children:a.jsx(kO,{})})}),a.jsx(is,{path:"/signup",element:a.jsx(jO,{})}),a.jsx(is,{path:"/onboarding",element:a.jsx(NO,{})}),a.jsx(is,{path:"/upgrade",element:a.jsx(SO,{})}),a.jsx(is,{path:"*",element:a.jsx(QR,{to:"/",replace:!0})})]})})})]})})})})}YA.createRoot(document.getElementById("root")).render(a.jsx(_.StrictMode,{children:a.jsx(CO,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/login/sw.js").catch(()=>{})});export{ii as $,Ym as A,Fj as B,oa as C,ud as D,dL as E,si as F,FO as G,ra as H,es as I,ri as J,Du as K,Jl as L,ss as M,Ie as N,ia as O,iL as P,NL as Q,or as R,Pu as S,mt as T,Cd as U,Tm as V,Rp as W,Id as X,Np as Y,A0 as Z,Dr as _,gr as a,AB as a$,Ap as a0,Co as a1,jL as a2,xi as a3,kL as a4,Sv as a5,As as a6,Ol as a7,Je as a8,MO as a9,qO as aA,$O as aB,GO as aC,IB as aD,cB as aE,lB as aF,ws as aG,Dd as aH,pL as aI,mB as aJ,EB as aK,kB as aL,SB as aM,jB as aN,aL as aO,CB as aP,Al as aQ,zO as aR,Xm as aS,iB as aT,wT as aU,pB as aV,yB as aW,gB as aX,oL as aY,Jm as aZ,NB as a_,NP as aa,ys as ab,MB as ac,yn as ad,PO as ae,nB as af,tB as ag,VO as ah,wi as ai,OP as aj,dB as ak,fB as al,rB as am,ZO as an,JO as ao,hB as ap,HO as aq,BO as ar,rL as as,mL as at,PB as au,XO as av,KO as aw,DB as ax,YO as ay,xB as az,_e as b,sB as b0,bB as b1,vB as b2,wL as b3,Cj as b4,_B as b5,UO as b6,TB as b7,RB as b8,DO as b9,wB as ba,oB as bb,aB as bc,uB as bd,QO as be,eB as bf,WO as bg,jT as bh,Sa as c,Qe as d,Bi as e,Wt as f,On as g,Sn as h,q0 as i,a as j,n5 as k,s5 as l,IO as m,hD as n,LB as o,gD as p,In as q,_ as r,Gn as s,Ia as t,li as u,Cr as v,dn as w,Dp as x,jC as y,vi as z};
