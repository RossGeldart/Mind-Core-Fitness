import{r as p,l as Ws,m as Ds,n as As,q as ss,c as ts,d as W,w as rs,g as as,j as e,p as Es,i as pe,e as K,T as O,b as Is,t as Us,P as _s,v as Rs,C as Ys,k as Fs}from"./index-BcKkYlUk.js";/* empty css                        */const oe=[{key:"pressUps",name:"Press-Ups",category:"Upper Body",unit:"reps"},{key:"squats",name:"Squats",category:"Lower Body",unit:"reps"},{key:"longJump",name:"Standing Long Jump",category:"Power",unit:"distance"},{key:"deadHang",name:"Dead Hang",category:"Upper Body",unit:"time"},{key:"plank",name:"Plank",category:"Core",unit:"time"},{key:"wallSit",name:"Wall Sit",category:"Lower Body",unit:"time"},{key:"chestPress",name:"Chest Press",category:"Upper Body",unit:"weight"}],De=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function Ks(){const h=new Date;return`${h.getFullYear()}-${String(h.getMonth()+1).padStart(2,"0")}`}function de(h){const[u,b]=h.split("-");return new Date(parseInt(u),parseInt(b)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function Xs(h){if(!h&&h!==0)return"-";const u=Math.floor(h/60),b=(h%60).toFixed(2);return u>0?`${u}m ${parseFloat(b).toFixed(0)}s`:`${parseFloat(b).toFixed(2)}s`}function Js(h,u){return!h&&h!==0?"-":!u&&u!==0?`${h}kg`:`${h}kg x ${u}`}function fs(h,u){if(!u)return"-";switch(h.unit){case"weight":return Js(u.weight,u.reps);case"time":return Xs(u.time);case"reps":return u.reps?`${u.reps} reps`:"-";case"distance":return u.distance?`${u.distance} cm`:"-";default:return"-"}}function Ze(h,u){if(!u)return 0;switch(h.unit){case"weight":return(u.weight||0)*(u.reps||0);case"time":return u.time||0;case"reps":return u.reps||0;case"distance":return u.distance||0;default:return 0}}function Ps(h,u){return!u||u===0?null:(h-u)/u*100}function Qs({data:h,exerciseKey:u,unit:b}){if(!h||h.length<2)return e.jsx("div",{className:"pb-trend-empty",children:e.jsx("p",{children:"Not enough data for trend line yet"})});const z=h.map(N=>{const x=N.benchmarks?.[u];if(!x)return 0;switch(b){case"weight":return(x.weight||0)*(x.reps||0);case"time":return x.time||0;case"reps":return x.reps||0;case"distance":return x.distance||0;default:return 0}}),Be=Math.max(...z),ue=Math.min(...z),S=Be-ue||1,M=300,$=100,I=20,ne=M-I*2,D=$-I*2,H=z.map((N,x)=>{const _=I+x/(z.length-1)*ne,Q=I+D-(N-ue)/S*D;return{x:_,y:Q,value:N}}),U=H.map((N,x)=>`${x===0?"M":"L"} ${N.x} ${N.y}`).join(" "),ye=U+` L ${H[H.length-1].x} ${I+D} L ${H[0].x} ${I+D} Z`;return e.jsxs("div",{className:"pb-trend-chart",children:[e.jsxs("svg",{viewBox:`0 0 ${M} ${$}`,preserveAspectRatio:"xMidYMid meet",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"trendGradientJr",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),e.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),e.jsx("path",{d:ye,fill:"url(#trendGradientJr)"}),e.jsx("path",{d:U,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),H.map((N,x)=>e.jsx("circle",{cx:N.x,cy:N.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},x))]}),e.jsx("div",{className:"pb-trend-labels",children:h.map((N,x)=>e.jsxs("span",{className:"pb-trend-label",children:[N.month.split("-")[1],"/",N.month.split("-")[0].slice(2)]},x))})]})}function Zs(){const[h,u]=p.useState("bests"),[b,z]=p.useState([]),[Be,ue]=p.useState(!0),[S,M]=p.useState(!1),[$,I]=p.useState(0),[ne,D]=p.useState(!1),[H,U]=p.useState(!1),[ye,N]=p.useState(!1),[x,_]=p.useState({}),[Q,ie]=p.useState({}),[F,Se]=p.useState({}),[q,Pe]=p.useState({}),[T,Z]=p.useState({}),[ns,je]=p.useState(!1),[$e,ee]=p.useState({}),[L,is]=p.useState([]),[ve,Ve]=p.useState(null),[ke,Le]=p.useState(null),[le,xs]=p.useState(!1),[me,ys]=p.useState(""),[fe,ls]=p.useState(""),Ee=p.useRef(null),cs=p.useRef(0),ae=p.useRef(0),js=p.useRef("right"),ge=p.useCallback(s=>{I(i=>{const l=Math.max(0,Math.min(oe.length-1,s));return l===i?i:(js.current=l>i?"right":"left",l)})},[]),{currentUser:Ie,isClient:ce,clientData:V,loading:Re}=Ws(),{isDark:os}=Ds(),be=As(),se=p.useCallback((s,i="info")=>{Le({message:s,type:i}),setTimeout(()=>Le(null),4e3)},[]);p.useEffect(()=>{!Re&&(!Ie||!ce)&&be("/")},[Ie,ce,Re,be]),p.useEffect(()=>{V&&ds()},[V]);const ds=async()=>{try{const s=ss(ts(W,"juniorPBs"),rs("clientId","==",V.id)),l=(await as(s)).docs.map(j=>({id:j.id,...j.data()}));l.sort((j,f)=>j.month.localeCompare(f.month)),z(l);const c=ss(ts(W,"juniorPBTargets"),rs("clientId","==",V.id)),o=await as(c);if(!o.empty){const j=o.docs[0].data();Se(j.targets||{}),Pe(j.metricTargets||{}),Z(j.targets||{}),ee(j.metricTargets||{})}const y=ss(ts(W,"juniorAchievements"),rs("clientId","==",V.id)),C=await as(y);C.empty||is(C.docs[0].data().badges||[])}catch(s){console.error("Error fetching junior personal bests:",s)}ue(!1)},X=Ks(),P=b.find(s=>s.month===X),He=b.filter(s=>s.month<X),Ce=He.length>0?He[He.length-1]:null;p.useEffect(()=>{P?(_(P.benchmarks||{}),ie(P.bodyMetrics||{})):(_({}),ie({}))},[P?.id]);const Ge=async(s,i)=>{const l=[];if(s==="strength"?oe.forEach(c=>{const o=F[c.key];if(!o)return;const y=i[c.key];if(!y)return;let C;if(o.targetType==="time"){if(!o.targetValue)return;const j=o.startValue||0,f=y.time||0,k=o.targetValue-j;C=k===0?f>=o.targetValue?1:0:Math.max(0,(f-j)/k)}else if(o.targetType==="reps"){if(!o.targetReps)return;const j=o.startReps||0,f=y.reps||0,k=o.targetReps-j;C=k===0?f>=o.targetReps?1:0:Math.max(0,(f-j)/k)}else if(o.targetType==="distance"){if(!o.targetDistance)return;const j=o.startDistance||0,f=y.distance||0,k=o.targetDistance-j;C=k===0?f>=o.targetDistance?1:0:Math.max(0,(f-j)/k)}else{if(!o.targetWeight&&!o.targetReps)return;const j=(o.startWeight||0)*(o.startReps||0),f=(o.targetWeight||0)*(o.targetReps||0),k=(y.weight||0)*(y.reps||0),E=f-j;C=E===0?k>=f?1:0:Math.max(0,(k-j)/E)}if(C>=1){let j,f;o.targetType==="time"?(j=L.some(k=>k.type==="strength"&&k.key===c.key&&k.targetValue===o.targetValue),f=`${c.name} ${o.targetValue}s`):o.targetType==="reps"?(j=L.some(k=>k.type==="strength"&&k.key===c.key&&k.targetReps===o.targetReps),f=`${c.name} ${o.targetReps} reps`):o.targetType==="distance"?(j=L.some(k=>k.type==="strength"&&k.key===c.key&&k.targetDistance===o.targetDistance),f=`${c.name} ${o.targetDistance}cm`):(j=L.some(k=>k.type==="strength"&&k.key===c.key&&k.targetWeight===o.targetWeight&&k.targetReps===o.targetReps),f=`${c.name} ${o.targetWeight}kg × ${o.targetReps}`),j||l.push({type:"strength",key:c.key,...o.targetType==="time"?{targetType:"time",targetValue:o.targetValue}:o.targetType==="reps"?{targetType:"reps",targetReps:o.targetReps}:o.targetType==="distance"?{targetType:"distance",targetDistance:o.targetDistance}:{targetWeight:o.targetWeight,targetReps:o.targetReps},achievedMonth:X,label:f})}}):De.forEach(c=>{const o=q[c.key];if(!o||!o.targetValue)return;const y=i[c.key];if(y==null)return;const C=o.startValue||0,j=o.targetValue,f=j-C;(f===0?y===j?1:0:Math.max(0,(y-C)/f))>=1&&(L.some(Te=>Te.type==="metric"&&Te.key===c.key&&Te.targetValue===j)||l.push({type:"metric",key:c.key,targetValue:j,achievedMonth:X,label:`${c.name} ${j}${c.suffix}`}))}),l.length>0){const c=[...L,...l];await pe(K(W,"juniorAchievements",V.id),{clientId:V.id,badges:c,updatedAt:O.now()}),is(c),Ve(l),setTimeout(()=>Ve(null),5e3)}},Oe=(s,i)=>{if(s==="strength"){const l=F[i];if(!l)return!1;switch(oe.find(o=>o.key===i)?.unit){case"time":return L.some(o=>o.type==="strength"&&o.key===i&&o.targetValue===l.targetValue);case"reps":return L.some(o=>o.type==="strength"&&o.key===i&&o.targetReps===l.targetReps);case"distance":return L.some(o=>o.type==="strength"&&o.key===i&&o.targetDistance===l.targetDistance);default:return!l.targetWeight&&!l.targetReps?!1:L.some(o=>o.type==="strength"&&o.key===i&&o.targetWeight===l.targetWeight&&o.targetReps===l.targetReps)}}else{const l=q[i];return!l||!l.targetValue?!1:L.some(c=>c.type==="metric"&&c.key===i&&c.targetValue===l.targetValue)}},B=async()=>{M(!0);try{const s=`${V.id}_${X}`,i=P||{};await pe(K(W,"juniorPBs",s),{clientId:V.id,month:X,benchmarks:x,bodyMetrics:i.bodyMetrics||Q||{},createdAt:i.createdAt||O.now(),updatedAt:O.now()}),await Ge("strength",x),se("Benchmarks saved!","success"),D(!1),await ds()}catch(s){console.error("Error saving benchmarks:",s),se("Failed to save. Please try again.","error")}M(!1)},hs=async()=>{M(!0);try{const s=`${V.id}_${X}`,i=P||{};await pe(K(W,"juniorPBs",s),{clientId:V.id,month:X,benchmarks:i.benchmarks||x||{},bodyMetrics:Q,createdAt:i.createdAt||O.now(),updatedAt:O.now()}),await Ge("metric",Q),se("Body metrics saved!","success"),U(!1),await ds()}catch(s){console.error("Error saving metrics:",s),se("Failed to save. Please try again.","error")}M(!1)},ze=(s,i,l)=>{_(c=>({...c,[s]:{...c[s],[i]:l===""?"":parseFloat(l)}}))},Ne=(s,i)=>{ie(l=>({...l,[s]:i===""?"":parseFloat(i)}))},Fe=(s,i,l)=>{Z(c=>({...c,[s]:{...c[s],[i]:l===""?"":parseFloat(l)}}))},ps=async()=>{M(!0);try{const s=`targets_${V.id}`,i=P?.benchmarks||{},l={};oe.forEach(c=>{const o=i[c.key];switch(c.unit){case"time":T[c.key]?.targetValue&&(l[c.key]={targetType:"time",targetValue:T[c.key].targetValue,startValue:o?.time||0});break;case"reps":T[c.key]?.targetReps&&(l[c.key]={targetType:"reps",targetReps:T[c.key].targetReps,startReps:o?.reps||0});break;case"distance":T[c.key]?.targetDistance&&(l[c.key]={targetType:"distance",targetDistance:T[c.key].targetDistance,startDistance:o?.distance||0});break;default:(T[c.key]?.targetWeight||T[c.key]?.targetReps)&&(l[c.key]={targetWeight:T[c.key].targetWeight||0,targetReps:T[c.key].targetReps||0,startWeight:o?.weight||0,startReps:o?.reps||0})}}),await pe(K(W,"juniorPBTargets",s),{clientId:V.id,targets:l,metricTargets:q,updatedAt:O.now()}),Se(l),Z(l),se("Targets saved!","success"),N(!1)}catch(s){console.error("Error saving targets:",s),se("Failed to save targets.","error")}M(!1)},Me=(s,i)=>{ee(l=>({...l,[s]:{...l[s],targetValue:i===""?"":parseFloat(i)}}))},Y=async()=>{M(!0);try{const s=`targets_${V.id}`,i={};De.forEach(l=>{if($e[l.key]?.targetValue){const c=P?.bodyMetrics?.[l.key]||0;i[l.key]={targetValue:$e[l.key].targetValue,startValue:c}}}),await pe(K(W,"juniorPBTargets",s),{clientId:V.id,targets:F,metricTargets:i,updatedAt:O.now()}),Pe(i),ee(i),se("Metric targets saved!","success"),je(!1)}catch(s){console.error("Error saving metric targets:",s),se("Failed to save targets.","error")}M(!1)},Ue=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){M(!0);try{const s=K(W,"juniorPBTargets",`targets_${V.id}`);await Is(s),Se({}),Pe({}),Z({}),ee({}),se("All goals have been reset","success")}catch(s){console.error("Error resetting targets:",s),se("Failed to reset goals","error")}M(!1)}},ws=(s,i)=>{const l=F[s];if(!l||!i)return null;if(l.targetType==="time"){if(!l.targetValue)return null;const j=l.startValue||0,f=l.targetValue,k=i.time||0,E=f-j;return E<=0?k>=f?1:0:Math.max(0,Math.min((k-j)/E,1))}if(l.targetType==="reps"){if(!l.targetReps)return null;const j=l.startReps||0,f=l.targetReps,k=i.reps||0,E=f-j;return E<=0?k>=f?1:0:Math.max(0,Math.min((k-j)/E,1))}if(l.targetType==="distance"){if(!l.targetDistance)return null;const j=l.startDistance||0,f=l.targetDistance,k=i.distance||0,E=f-j;return E<=0?k>=f?1:0:Math.max(0,Math.min((k-j)/E,1))}if(!l.targetWeight&&!l.targetReps)return null;const c=(l.startWeight||0)*(l.startReps||0),o=(l.targetWeight||0)*(l.targetReps||0),y=(i.weight||0)*(i.reps||0),C=o-c;return C<=0?y>=o?1:0:Math.max(0,Math.min((y-c)/C,1))},vs=s=>{const i=q[s];if(!i||!i.targetValue)return null;const l=P?.bodyMetrics?.[s];if(l==null)return null;const c=i.startValue||0,o=i.targetValue,y=o-c;return y===0?l===o?1:0:Math.max(0,Math.min((l-c)/y,1))},te=s=>{cs.current=s.touches[0].clientX,ae.current=0},R=s=>{ae.current=s.touches[0].clientX-cs.current},us=()=>{ae.current<-50?ge($+1):ae.current>50&&ge($-1),ae.current=0},ks=s=>{const i=P?.bodyMetrics?.[s],l=Ce?.bodyMetrics?.[s];return i==null||l==null?null:parseFloat((i-l).toFixed(2))},_e=b.find(s=>s.month===me),Ye=b.find(s=>s.month===fe);if(Re||Be)return e.jsxs("div",{className:"pb-page",children:[e.jsx("header",{className:"client-header",children:e.jsx("div",{className:"header-content",children:e.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),e.jsxs("main",{className:"pb-main",children:[e.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),e.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!Ie||!ce||!V)return null;const J=oe[$],qe=P?.benchmarks?.[J.key],Ke=Ce?.benchmarks?.[J.key],ms=Ze(J,qe),Xe=Ze(J,Ke),We=Ps(ms,Xe),Je=ws(J.key,qe),Cs=Je!==null,Qe=Je!==null&&Je>=1,Ms=Cs?Math.round(Je*60):ms>0?15:0,gs=F[J.key],Ts=s=>s?s.targetType==="time"?`${s.startValue||0}s → ${s.targetValue}s`:s.targetType==="reps"?`${s.startReps||0} → ${s.targetReps} reps`:s.targetType==="distance"?`${s.startDistance||0} → ${s.targetDistance}cm`:`${s.startWeight||0}kg×${s.startReps||0} → ${s.targetWeight}kg×${s.targetReps}`:null;return e.jsxs("div",{className:"pb-page",children:[e.jsx("header",{className:"client-header",children:e.jsxs("div",{className:"header-content",children:[e.jsx("button",{className:"header-back-btn",onClick:()=>be("/client"),"aria-label":"Go back",children:e.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M15 18l-6-6 6-6"})})}),e.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),e.jsxs("main",{className:"pb-main page-transition-enter",children:[e.jsxs("div",{className:"pb-intro",children:[e.jsx("h2",{children:"Junior Strength Tests"}),e.jsx("p",{children:"Track your strength test results and body measurements each month."})]}),e.jsxs("div",{className:"pb-tabs",children:[e.jsx("button",{className:`pb-tab ${h==="bests"?"active":""}`,onClick:()=>u("bests"),children:"Strength"}),e.jsx("button",{className:`pb-tab ${h==="metrics"?"active":""}`,onClick:()=>u("metrics"),children:"Body Metrics"}),e.jsx("button",{className:`pb-tab ${h==="history"?"active":""}`,onClick:()=>u("history"),children:"History"})]}),h==="bests"&&e.jsxs("div",{className:"pb-strength-section",children:[!ne&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"pb-carousel",ref:Ee,onTouchStart:te,onTouchMove:R,onTouchEnd:us,children:[e.jsx("div",{className:`pb-ring-container slide-from-${js.current}`,children:e.jsxs("div",{className:"pb-ring",children:[e.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:Es.map((s,i)=>{const l=i<Math.round(Ms);return e.jsx("line",{x1:s.x1,y1:s.y1,x2:s.x2,y2:s.y2,className:`pb-ring-tick ${l?Qe?"hit":"filled":"empty"}`,strokeWidth:s.thick?"3":"2"},i)})}),e.jsxs("div",{className:"pb-ring-center",children:[e.jsx("div",{className:"pb-ring-category",children:J.category}),e.jsxs("div",{className:"pb-ring-exercise",children:[J.name,Oe("strength",J.key)&&e.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),e.jsx("div",{className:"pb-ring-value",children:qe?fs(J,qe):"-"}),We!==null&&e.jsxs("div",{className:`pb-ring-change ${We>=0?"positive":"negative"}`,children:[We>=0?"+":"",We.toFixed(1),"%"]}),We===null&&qe&&e.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),gs&&e.jsx("div",{className:`pb-ring-target ${Qe?"hit":""}`,children:Qe?"Target hit!":Ts(gs)}),!gs&&e.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},$),e.jsx("div",{className:"pb-carousel-dots",children:oe.map((s,i)=>e.jsx("button",{className:`pb-dot ${i===$?"active":""}`,onClick:()=>ge(i)},i))}),e.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>ge($-1),disabled:$===0,children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),e.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>ge($+1),disabled:$===oe.length-1,children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),e.jsxs("div",{className:"pb-trend-section",children:[e.jsx("h4",{children:"Trend"}),e.jsx(Qs,{data:b,exerciseKey:J.key,unit:J.unit})]})]}),!ne&&!ye&&e.jsxs("div",{className:"pb-action-buttons",children:[e.jsx("button",{className:"pb-edit-btn",onClick:()=>D(!0),children:P?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),e.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>N(!0),children:Object.keys(F).length>0?"Edit Targets":"Set Targets"}),(Object.keys(F).length>0||Object.keys(q).length>0)&&e.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Ue,disabled:S,children:"Reset All Goals"})]}),ne&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsxs("h3",{children:["Benchmarks - ",de(X)]}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{D(!1),_(P?.benchmarks||{})},children:"×"})]}),e.jsx("div",{className:"pb-edit-body",children:oe.map(s=>e.jsxs("div",{className:"pb-edit-exercise",children:[e.jsx("div",{className:"pb-edit-exercise-name",children:s.name}),s.unit==="weight"?e.jsxs("div",{className:"pb-edit-row",children:[e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Weight (kg)"}),e.jsx("input",{type:"number",step:"0.5",value:x[s.key]?.weight??"",onChange:i=>ze(s.key,"weight",i.target.value),placeholder:"0"})]}),e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Reps"}),e.jsx("input",{type:"number",value:x[s.key]?.reps??"",onChange:i=>ze(s.key,"reps",i.target.value),placeholder:"0"})]})]}):s.unit==="reps"?e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsx("label",{children:"Reps (max in 1 min)"}),e.jsx("input",{type:"number",value:x[s.key]?.reps??"",onChange:i=>ze(s.key,"reps",i.target.value),placeholder:"0"})]})}):s.unit==="distance"?e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsx("label",{children:"Distance (cm)"}),e.jsx("input",{type:"number",step:"0.5",value:x[s.key]?.distance??"",onChange:i=>ze(s.key,"distance",i.target.value),placeholder:"0"})]})}):e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsx("label",{children:"Time (seconds)"}),e.jsx("input",{type:"number",step:"0.01",value:x[s.key]?.time??"",onChange:i=>ze(s.key,"time",i.target.value),placeholder:"0"})]})})]},s.key))}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{D(!1),_(P?.benchmarks||{})},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:B,disabled:S,children:S?"Saving...":"Save"})]})]}),ye&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsx("h3",{children:"Set Your Targets"}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{N(!1),Z(F)},children:"×"})]}),e.jsxs("div",{className:"pb-edit-body",children:[e.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),oe.map(s=>{const i=P?.benchmarks?.[s.key];let l="-";if(i)switch(s.unit){case"weight":(i.weight||i.reps)&&(l=`${i.weight||0}kg × ${i.reps||0}`);break;case"time":i.time&&(l=`${i.time}s`);break;case"reps":i.reps&&(l=`${i.reps} reps`);break;case"distance":i.distance&&(l=`${i.distance} cm`);break}return e.jsxs("div",{className:"pb-edit-exercise",children:[e.jsxs("div",{className:"pb-edit-exercise-header",children:[e.jsx("div",{className:"pb-edit-exercise-name",children:s.name}),e.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",l]})]}),s.unit==="weight"?e.jsxs("div",{className:"pb-edit-row",children:[e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Target Weight (kg)"}),e.jsx("input",{type:"number",step:"0.5",value:T[s.key]?.targetWeight??"",onChange:c=>Fe(s.key,"targetWeight",c.target.value),placeholder:"0"})]}),e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Target Reps"}),e.jsx("input",{type:"number",value:T[s.key]?.targetReps??"",onChange:c=>Fe(s.key,"targetReps",c.target.value),placeholder:"0"})]})]}):s.unit==="reps"?e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsx("label",{children:"Target Reps (in 1 min)"}),e.jsx("input",{type:"number",value:T[s.key]?.targetReps??"",onChange:c=>Fe(s.key,"targetReps",c.target.value),placeholder:"0"})]})}):s.unit==="distance"?e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsx("label",{children:"Target Distance (cm)"}),e.jsx("input",{type:"number",step:"0.5",value:T[s.key]?.targetDistance??"",onChange:c=>Fe(s.key,"targetDistance",c.target.value),placeholder:"0"})]})}):e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsx("label",{children:"Target (seconds)"}),e.jsx("input",{type:"number",step:"1",value:T[s.key]?.targetValue??"",onChange:c=>Fe(s.key,"targetValue",c.target.value),placeholder:"0"})]})})]},s.key)})]}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{N(!1),Z(F)},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:ps,disabled:S,children:S?"Saving...":"Save Targets"})]})]})]}),h==="metrics"&&e.jsxs("div",{className:"pb-metrics-section",children:[!H&&!ns&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"pb-metrics-card",children:[e.jsx("h3",{children:"Body Measurements"}),e.jsx("p",{className:"pb-metrics-month",children:de(X)}),e.jsx("div",{className:"pb-metrics-list",children:De.map(s=>{const i=P?.bodyMetrics?.[s.key],l=ks(s.key),c=q[s.key],o=vs(s.key),y=o!==null&&o>=1;return e.jsxs("div",{className:"pb-metric-row",children:[e.jsxs("div",{className:"pb-metric-top",children:[e.jsxs("div",{className:"pb-metric-left",children:[e.jsxs("span",{className:"pb-metric-name",children:[s.name,Oe("metric",s.key)&&e.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),c&&e.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",c.targetValue," ",s.suffix]})]}),e.jsxs("div",{className:"pb-metric-values",children:[e.jsx("span",{className:"pb-metric-current",children:i!=null?`${i} ${s.suffix}`:"-"}),l!==null&&e.jsxs("span",{className:`pb-metric-change ${l>0?"up":l<0?"down":"same"}`,children:[l>0?"+":"",l," ",s.suffix]})]})]}),o!==null&&e.jsxs("div",{className:"pb-metric-progress",children:[e.jsx("div",{className:"pb-metric-bar",children:e.jsx("div",{className:`pb-metric-bar-fill ${y?"hit":""}`,style:{width:`${Math.round(o*100)}%`}})}),e.jsx("span",{className:`pb-metric-percent ${y?"hit":""}`,children:y?"Hit!":`${Math.round(o*100)}%`})]})]},s.key)})})]}),e.jsxs("div",{className:"pb-action-buttons",children:[e.jsx("button",{className:"pb-edit-btn",onClick:()=>U(!0),children:P?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),e.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>je(!0),children:Object.keys(q).length>0?"Edit Targets":"Set Targets"}),(Object.keys(F).length>0||Object.keys(q).length>0)&&e.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Ue,disabled:S,children:"Reset All Goals"})]})]}),H&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsxs("h3",{children:["Measurements - ",de(X)]}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{U(!1),ie(P?.bodyMetrics||{})},children:"×"})]}),e.jsx("div",{className:"pb-edit-body",children:De.map(s=>e.jsx("div",{className:"pb-edit-metric",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsxs("label",{children:[s.name," (",s.suffix,")"]}),e.jsx("input",{type:"number",step:"0.1",value:Q[s.key]??"",onChange:i=>Ne(s.key,i.target.value),placeholder:"0"})]})},s.key))}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{U(!1),ie(P?.bodyMetrics||{})},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:hs,disabled:S,children:S?"Saving...":"Save"})]})]}),ns&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsx("h3",{children:"Body Metric Targets"}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{je(!1),ee(q)},children:"×"})]}),e.jsxs("div",{className:"pb-edit-body",children:[e.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),De.map(s=>{const i=P?.bodyMetrics?.[s.key];return e.jsxs("div",{className:"pb-edit-exercise",children:[e.jsxs("div",{className:"pb-edit-exercise-header",children:[e.jsx("div",{className:"pb-edit-exercise-name",children:s.name}),e.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",i!=null?`${i} ${s.suffix}`:"-"]})]}),e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsxs("label",{children:["Target (",s.suffix,")"]}),e.jsx("input",{type:"number",step:"0.1",value:$e[s.key]?.targetValue??"",onChange:l=>Me(s.key,l.target.value),placeholder:"0"})]})})]},s.key)})]}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{je(!1),ee(q)},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:Y,disabled:S,children:S?"Saving...":"Save Targets"})]})]})]}),h==="history"&&e.jsx("div",{className:"pb-history-section",children:b.length===0?e.jsxs("div",{className:"pb-empty",children:[e.jsx("h4",{children:"No records yet"}),e.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):e.jsxs(e.Fragment,{children:[L.length>0&&e.jsxs("div",{className:"pb-achievements-wall",children:[e.jsxs("h4",{className:"pb-achievements-wall-title",children:[e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),e.jsx("div",{className:"pb-achievements-list",children:[...L].reverse().map((s,i)=>e.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${i*.05}s`},children:[e.jsx("div",{className:"pb-achievement-star",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),e.jsxs("div",{className:"pb-achievement-info",children:[e.jsx("span",{className:"pb-achievement-label",children:s.label}),e.jsx("span",{className:"pb-achievement-date",children:de(s.achievedMonth)})]})]},i))})]}),e.jsx("div",{className:"pb-history-controls",children:e.jsx("button",{className:`pb-compare-toggle ${le?"active":""}`,onClick:()=>{xs(!le),!le&&b.length>=2&&(ys(b[0].month),ls(b[b.length-1].month))},children:le?"Back to Timeline":"Compare Months"})}),le?e.jsxs("div",{className:"pb-compare",children:[e.jsxs("div",{className:"pb-compare-selectors",children:[e.jsxs("div",{className:"pb-compare-select",children:[e.jsx("label",{children:"From"}),e.jsx("select",{value:me,onChange:s=>ys(s.target.value),children:b.map(s=>e.jsx("option",{value:s.month,children:de(s.month)},s.month))})]}),e.jsx("div",{className:"pb-compare-vs",children:"vs"}),e.jsxs("div",{className:"pb-compare-select",children:[e.jsx("label",{children:"To"}),e.jsx("select",{value:fe,onChange:s=>ls(s.target.value),children:b.map(s=>e.jsx("option",{value:s.month,children:de(s.month)},s.month))})]})]}),_e&&Ye&&e.jsxs("div",{className:"pb-compare-results",children:[e.jsxs("div",{className:"pb-compare-group",children:[e.jsx("h4",{children:"Strength Tests"}),e.jsxs("div",{className:"pb-compare-table",children:[e.jsxs("div",{className:"pb-compare-header-row",children:[e.jsx("span",{children:"Exercise"}),e.jsx("span",{children:de(me).split(" ")[0]}),e.jsx("span",{children:de(fe).split(" ")[0]}),e.jsx("span",{children:"Change"})]}),oe.map(s=>{const i=_e.benchmarks?.[s.key],l=Ye.benchmarks?.[s.key],c=Ze(s,i),o=Ze(s,l),y=Ps(o,c);return e.jsxs("div",{className:"pb-compare-row",children:[e.jsx("span",{className:"pb-compare-name",children:s.name}),e.jsx("span",{className:"pb-compare-val",children:i?fs(s,i):"-"}),e.jsx("span",{className:"pb-compare-val",children:l?fs(s,l):"-"}),e.jsx("span",{className:`pb-compare-change ${y!==null?y>=0?"positive":"negative":""}`,children:y!==null?`${y>=0?"+":""}${y.toFixed(1)}%`:"-"})]},s.key)})]})]}),e.jsxs("div",{className:"pb-compare-group",children:[e.jsx("h4",{children:"Body Measurements"}),e.jsxs("div",{className:"pb-compare-table",children:[e.jsxs("div",{className:"pb-compare-header-row",children:[e.jsx("span",{children:"Measurement"}),e.jsx("span",{children:de(me).split(" ")[0]}),e.jsx("span",{children:de(fe).split(" ")[0]}),e.jsx("span",{children:"Change"})]}),De.map(s=>{const i=_e.bodyMetrics?.[s.key],l=Ye.bodyMetrics?.[s.key],c=i!=null&&l!=null?parseFloat((l-i).toFixed(2)):null;return e.jsxs("div",{className:"pb-compare-row",children:[e.jsx("span",{className:"pb-compare-name",children:s.name}),e.jsx("span",{className:"pb-compare-val",children:i!=null?`${i}`:"-"}),e.jsx("span",{className:"pb-compare-val",children:l!=null?`${l}`:"-"}),e.jsx("span",{className:`pb-compare-change ${c!==null?c>0?"positive":c<0?"negative":"neutral":""}`,children:c!==null?`${c>0?"+":""}${c} ${s.suffix}`:"-"})]},s.key)})]})]})]})]}):e.jsx("div",{className:"pb-timeline",children:[...b].reverse().map((s,i)=>{const l=b.filter(c=>c.month<s.month).pop();return e.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${i*.05}s`},children:[e.jsx("div",{className:"pb-timeline-dot"}),e.jsxs("div",{className:"pb-timeline-card",children:[e.jsx("h4",{children:de(s.month)}),s.benchmarks&&Object.keys(s.benchmarks).length>0&&e.jsxs("div",{className:"pb-timeline-group",children:[e.jsx("h5",{children:"Strength Tests"}),oe.map(c=>{const o=s.benchmarks[c.key];if(!o)return null;const y=l?.benchmarks?.[c.key],C=Ze(c,o),j=Ze(c,y),f=Ps(C,j);return e.jsxs("div",{className:"pb-timeline-row",children:[e.jsx("span",{className:"pb-timeline-label",children:c.name}),e.jsxs("div",{className:"pb-timeline-values",children:[e.jsx("span",{className:"pb-timeline-value",children:fs(c,o)}),f!==null&&e.jsxs("span",{className:`pb-timeline-change ${f>=0?"positive":"negative"}`,children:[f>=0?"+":"",f.toFixed(1),"%"]})]})]},c.key)})]}),s.bodyMetrics&&Object.keys(s.bodyMetrics).length>0&&e.jsxs("div",{className:"pb-timeline-group",children:[e.jsx("h5",{children:"Body Measurements"}),De.map(c=>{const o=s.bodyMetrics[c.key];if(o==null)return null;const y=l?.bodyMetrics?.[c.key],C=y!=null?parseFloat((o-y).toFixed(2)):null;return e.jsxs("div",{className:"pb-timeline-row",children:[e.jsx("span",{className:"pb-timeline-label",children:c.name}),e.jsxs("div",{className:"pb-timeline-values",children:[e.jsxs("span",{className:"pb-timeline-value",children:[o," ",c.suffix]}),C!==null&&e.jsxs("span",{className:`pb-timeline-change ${C>0?"positive":C<0?"negative":"neutral"}`,children:[C>0?"+":"",C," ",c.suffix]})]})]},c.key)})]})]})]},s.id)})})]})})]}),ve&&e.jsx("div",{className:"pb-celebration-overlay",onClick:()=>Ve(null),children:e.jsxs("div",{className:"pb-celebration-card",children:[e.jsx("div",{className:"pb-celebration-icon",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),e.jsx("h3",{className:"pb-celebration-title",children:ve.length===1?"Target Achieved!":`${ve.length} Targets Achieved!`}),e.jsx("div",{className:"pb-celebration-badges",children:ve.map((s,i)=>e.jsx("div",{className:"pb-celebration-badge",children:s.label},i))}),e.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),ke&&e.jsxs("div",{className:`toast-notification ${ke.type}`,children:[e.jsx("span",{className:"toast-icon",children:ke.type==="success"?e.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),e.jsx("span",{className:"toast-message",children:ke.message}),e.jsx("button",{className:"toast-close",onClick:()=>Le(null),children:"×"})]}),e.jsxs("nav",{className:"block-bottom-nav",children:[e.jsxs("button",{className:"block-nav-tab",onClick:()=>be("/client"),children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),e.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),e.jsx("span",{children:"Home"})]}),e.jsxs("button",{className:"block-nav-tab",onClick:()=>be("/client/forms"),children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),e.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),e.jsx("span",{children:"Forms"})]}),e.jsxs("button",{className:"block-nav-tab",onClick:()=>be("/client/tools"),children:[e.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),e.jsx("span",{children:"Tools"})]}),e.jsxs("button",{className:"block-nav-tab active",children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12 20V10"}),e.jsx("path",{d:"M18 20V4"}),e.jsx("path",{d:"M6 20v-4"})]}),e.jsx("span",{children:"PBs"})]}),V?.circuitAccess&&e.jsxs("button",{className:"block-nav-tab",onClick:()=>be("/client/circuit"),children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M12 6v6l4 2"})]}),e.jsx("span",{children:"Circuit"})]})]})]})}const Hs=[{name:"Dumbbell Floor Press",type:"weighted",equipment:"dumbbells",group:"push",pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",equipment:"dumbbells",group:"push",pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Tricep Dips",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Reverse Plank",type:"timed",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/reverse plank.GIF"},{name:"Dumbbell Squeeze Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Pullover",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Fly",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Tricep Kickback",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Shrug",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Y-Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Wide Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Diamond Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Decline Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Wall Walks",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Press Up Hold",type:"timed",equipment:"bodyweight",group:"push",storagePath:null},{name:"Shoulder Tap Hold",type:"timed",equipment:"bodyweight",group:"push",storagePath:null},{name:"Dumbbell Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Renegade Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Reverse Fly",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Concentration Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Wrist Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Reverse Snow Angel",type:"reps",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Isometric Bicep Hold",type:"timed",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Dumbbell Goblet Squats",type:"weighted",equipment:"dumbbells",group:"lower",pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",equipment:"dumbbells",group:"lower",pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"1 Legged RDL",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",equipment:"kettlebell",group:"lower",storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Reverse Lunge",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Box Step Ups",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Bulgarian Split Squats",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Jump Squats",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hip Thrusts",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Donkey Kicks",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Skater Jumps",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Squat And Hold",type:"timed",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/squat and hold.GIF"},{name:"Forearm Plank",type:"timed",equipment:"bodyweight",group:"core",pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Side Plank",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Hollow Body Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Superman Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Superman Hold.mp4"},{name:"Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Fast Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Russian Twist",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Crunch",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Bicycle Crunch",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Leg Raises",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Dead Bug",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Bird Dog",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Flutter Kicks",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"High Plank Shoulder Taps",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hip Dips Plank",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Single Leg V-Up",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Toe Reaches",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Side Plank Rotation",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Plank Walkout",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Russian Twists Dumbbell",type:"weighted",equipment:"dumbbells",group:"core",storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Kettlebell Russian Twist",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Back Extension Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:null},{name:"Dumbbell Plank Pull Through",type:"weighted",equipment:"dumbbells",group:"core",storagePath:null}];Hs.filter(h=>h.storagePath!==null);const et=[{key:"push",label:"Push",subtitle:"Chest / Shoulders / Triceps",color:"#A12F3A",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4"},{key:"pull",label:"Pull",subtitle:"Back / Biceps",color:"#2196f3",icon:"M4 12h16M12 4v16M7 7l10 10M17 7L7 17"},{key:"lower",label:"Lower",subtitle:"Legs / Glutes",color:"#ff9800",icon:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"},{key:"core",label:"Core",subtitle:"Abs / Stability",color:"#7c3aed",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"}],Gs={};Hs.forEach(h=>{Gs[h.name]=h.group});function st(h){return Gs[h]||null}const xe=[{key:"chestPress",name:"Chest Press",category:"Upper Body - Push",unit:"weight"},{key:"shoulderPress",name:"Shoulder Press",category:"Upper Body - Push",unit:"weight"},{key:"seatedRow",name:"Seated Row",category:"Upper Body - Pull",unit:"weight"},{key:"latPulldown",name:"Lat Pulldown",category:"Upper Body - Pull",unit:"weight"},{key:"squat",name:"Squat",category:"Lower Body",unit:"weight"},{key:"deadlift",name:"Deadlift",category:"Lower Body",unit:"weight"},{key:"plank",name:"Plank",category:"Core",unit:"time"}],Ae=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function tt(){const h=new Date;return`${h.getFullYear()}-${String(h.getMonth()+1).padStart(2,"0")}`}function he(h){const[u,b]=h.split("-");return new Date(parseInt(u),parseInt(b)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function Ns(h){if(!h&&h!==0)return"-";const u=Math.floor(h/60),b=(h%60).toFixed(2);return u>0?`${u}m ${parseFloat(b).toFixed(0)}s`:`${parseFloat(b).toFixed(2)}s`}function qs(h,u){return!h&&h!==0?"-":!u&&u!==0?`${h}kg`:`${h}kg x ${u}`}function es(h,u){return u?h.unit==="time"?u.time||0:(u.weight||0)*(u.reps||0):0}function $s(h,u){return!u||u===0?null:(h-u)/u*100}function rt({data:h,exerciseKey:u,unit:b}){if(!h||h.length<2)return e.jsx("div",{className:"pb-trend-empty",children:e.jsx("p",{children:"Not enough data for trend line yet"})});const z=h.map(N=>{const x=N.benchmarks?.[u];return x?b==="time"?x.time||0:(x.weight||0)*(x.reps||0):0}),Be=Math.max(...z),ue=Math.min(...z),S=Be-ue||1,M=300,$=100,I=20,ne=M-I*2,D=$-I*2,H=z.map((N,x)=>{const _=I+x/(z.length-1)*ne,Q=I+D-(N-ue)/S*D;return{x:_,y:Q,value:N}}),U=H.map((N,x)=>`${x===0?"M":"L"} ${N.x} ${N.y}`).join(" "),ye=U+` L ${H[H.length-1].x} ${I+D} L ${H[0].x} ${I+D} Z`;return e.jsxs("div",{className:"pb-trend-chart",children:[e.jsxs("svg",{viewBox:`0 0 ${M} ${$}`,preserveAspectRatio:"xMidYMid meet",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"trendGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),e.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),e.jsx("path",{d:ye,fill:"url(#trendGradient)"}),e.jsx("path",{d:U,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),H.map((N,x)=>e.jsx("circle",{cx:N.x,cy:N.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},x))]}),e.jsx("div",{className:"pb-trend-labels",children:h.map((N,x)=>e.jsxs("span",{className:"pb-trend-label",children:[N.month.split("-")[1],"/",N.month.split("-")[0].slice(2)]},x))})]})}function it(){const[h,u]=p.useState("bests"),[b,z]=p.useState([]),[Be,ue]=p.useState(!0),[S,M]=p.useState(!1),[$,I]=p.useState(0),[ne,D]=p.useState(!1),[H,U]=p.useState(!1),[ye,N]=p.useState(!1),[x,_]=p.useState({}),[Q,ie]=p.useState({}),[F,Se]=p.useState({}),[q,Pe]=p.useState({}),[T,Z]=p.useState({}),[ns,je]=p.useState(!1),[$e,ee]=p.useState({}),[L,is]=p.useState([]),[ve,Ve]=p.useState(null),[ke,Le]=p.useState(null),[le,xs]=p.useState("cm"),[me,ys]=p.useState(!1),[fe,ls]=p.useState(""),[Ee,cs]=p.useState(""),[ae,js]=p.useState({}),[ge,Ie]=p.useState({}),[ce,V]=p.useState(null),[Re,os]=p.useState(""),[be,se]=p.useState({}),ds=p.useRef(null),X=p.useRef(0),P=p.useRef(0),He=p.useRef("right"),Ce=p.useCallback(t=>{I(n=>{const r=Math.max(0,Math.min(xe.length-1,t));return r===n?n:(He.current=r>n?"right":"left",r)})},[]),{currentUser:Ge,isClient:Oe,clientData:B,loading:hs}=Ws(),{isDark:ze}=Ds(),Ne=As(),[Fe]=Us(),ps=Fe.get("mode")==="corebuddy",Me=!ps&&(!B?.clientType||B.clientType==="block"),Y=p.useCallback((t,n="info")=>{Le({message:t,type:n}),setTimeout(()=>Le(null),4e3)},[]);p.useEffect(()=>{!hs&&(!Ge||!Oe)&&Ne("/")},[Ge,Oe,hs,Ne]),p.useEffect(()=>{B&&(Me?Ue():(async()=>{try{const[n,r]=await Promise.all([Fs(K(W,"coreBuddyPBs",B.id)),Fs(K(W,"coreBuddyTargets",B.id))]);n.exists()&&js(n.data().exercises||{}),r.exists()&&Ie(r.data().targets||{})}catch(n){console.error("Error loading Core Buddy PBs:",n)}ue(!1)})())},[B]);const Ue=async()=>{try{const t=ss(ts(W,"personalBests"),rs("clientId","==",B.id)),r=(await as(t)).docs.map(g=>({id:g.id,...g.data()}));r.sort((g,w)=>g.month.localeCompare(w.month)),z(r);const a=ss(ts(W,"personalBestTargets"),rs("clientId","==",B.id)),d=await as(a);if(!d.empty){const g=d.docs[0].data();Se(g.targets||{}),Pe(g.metricTargets||{}),Z(g.targets||{}),ee(g.metricTargets||{})}const v=ss(ts(W,"achievements"),rs("clientId","==",B.id)),m=await as(v);m.empty||is(m.docs[0].data().badges||[])}catch(t){console.error("Error fetching personal bests:",t)}ue(!1)},ws=async()=>{if(!ce||!Re||!B)return;const t=parseFloat(Re),n=ae[ce];if(!n||t<=n.weight){Y("Target must be higher than current PB","error");return}M(!0);try{const r={...ge,[ce]:{targetWeight:t,setAt:O.now(),currentPBWhenSet:n.weight}};await pe(K(W,"coreBuddyTargets",B.id),{clientId:B.id,targets:r,updatedAt:O.now()}),Ie(r),V(null),os(""),Y("Target set!","success")}catch(r){console.error("Error saving target:",r),Y("Failed to save target","error")}M(!1)},vs=t=>{const n=ge[t];if(!n)return null;const r=ae[t];if(!r)return 0;const a=n.currentPBWhenSet||0,d=n.targetWeight,v=d-a;return v<=0?r.weight>=d?1:0:Math.max(0,Math.min((r.weight-a)/v,1))},te=tt(),R=b.find(t=>t.month===te),us=b.filter(t=>t.month<te),ks=us.length>0?us[us.length-1]:null;p.useEffect(()=>{R?(_(R.benchmarks||{}),ie(R.bodyMetrics||{})):(_({}),ie({}))},[R?.id]);const _e=async(t,n)=>{const r=[];if(t==="strength"?xe.forEach(a=>{const d=F[a.key];if(!d)return;const v=n[a.key];if(!v)return;let m;if(d.targetType==="time"){if(!d.targetValue)return;const g=d.startValue||0,w=v.time||0,G=d.targetValue-g;m=G===0?w>=d.targetValue?1:0:Math.max(0,(w-g)/G)}else{if(!d.targetWeight&&!d.targetReps)return;const g=(d.startWeight||0)*(d.startReps||0),w=(d.targetWeight||0)*(d.targetReps||0),G=(v.weight||0)*(v.reps||0),A=w-g;m=A===0?G>=w?1:0:Math.max(0,(G-g)/A)}if(m>=1&&!(d.targetType==="time"?L.some(w=>w.type==="strength"&&w.key===a.key&&w.targetValue===d.targetValue):L.some(w=>w.type==="strength"&&w.key===a.key&&w.targetWeight===d.targetWeight&&w.targetReps===d.targetReps))){const w=d.targetType==="time"?`${a.name} ${d.targetValue}s`:`${a.name} ${d.targetWeight}kg × ${d.targetReps}`;r.push({type:"strength",key:a.key,...d.targetType==="time"?{targetType:"time",targetValue:d.targetValue}:{targetWeight:d.targetWeight,targetReps:d.targetReps},achievedMonth:te,label:w})}}):Ae.forEach(a=>{const d=q[a.key];if(!d||!d.targetValue)return;const v=n[a.key];if(v==null)return;const m=d.startValue||0,g=d.targetValue,w=g-m;(w===0?v===g?1:0:Math.max(0,(v-m)/w))>=1&&(L.some(re=>re.type==="metric"&&re.key===a.key&&re.targetValue===g)||r.push({type:"metric",key:a.key,targetValue:g,achievedMonth:te,label:`${a.name} ${g}${a.suffix}`}))}),r.length>0){const a=[...L,...r];await pe(K(W,"achievements",B.id),{clientId:B.id,badges:a,updatedAt:O.now()}),is(a),Ve(r),setTimeout(()=>Ve(null),5e3)}},Ye=(t,n)=>{if(t==="strength"){const r=F[n];return r?r.targetType==="time"?L.some(a=>a.type==="strength"&&a.key===n&&a.targetValue===r.targetValue):!r.targetWeight&&!r.targetReps?!1:L.some(a=>a.type==="strength"&&a.key===n&&a.targetWeight===r.targetWeight&&a.targetReps===r.targetReps):!1}else{const r=q[n];return!r||!r.targetValue?!1:L.some(a=>a.type==="metric"&&a.key===n&&a.targetValue===r.targetValue)}},J=async()=>{M(!0);try{const t=`${B.id}_${te}`,n=R||{};await pe(K(W,"personalBests",t),{clientId:B.id,month:te,benchmarks:x,bodyMetrics:n.bodyMetrics||Q||{},createdAt:n.createdAt||O.now(),updatedAt:O.now()}),await _e("strength",x),Y("Benchmarks saved!","success"),D(!1),await Ue()}catch(t){console.error("Error saving benchmarks:",t),Y("Failed to save. Please try again.","error")}M(!1)},qe=async()=>{M(!0);try{const t=`${B.id}_${te}`,n=R||{};await pe(K(W,"personalBests",t),{clientId:B.id,month:te,benchmarks:n.benchmarks||x||{},bodyMetrics:Q,createdAt:n.createdAt||O.now(),updatedAt:O.now()}),await _e("metric",Q),Y("Body metrics saved!","success"),U(!1),await Ue()}catch(t){console.error("Error saving metrics:",t),Y("Failed to save. Please try again.","error")}M(!1)},Ke=(t,n,r)=>{_(a=>({...a,[t]:{...a[t],[n]:r===""?"":parseFloat(r)}}))},ms=(t,n)=>{ie(r=>({...r,[t]:n===""?"":parseFloat(n)}))},Xe=(t,n,r)=>{Z(a=>({...a,[t]:{...a[t],[n]:r===""?"":parseFloat(r)}}))},We=async()=>{M(!0);try{const t=`targets_${B.id}`,n=R?.benchmarks||{},r={};xe.forEach(a=>{const d=n[a.key];a.unit==="time"?T[a.key]?.targetValue&&(r[a.key]={targetType:"time",targetValue:T[a.key].targetValue,startValue:d?.time||0}):(T[a.key]?.targetWeight||T[a.key]?.targetReps)&&(r[a.key]={targetWeight:T[a.key].targetWeight||0,targetReps:T[a.key].targetReps||0,startWeight:d?.weight||0,startReps:d?.reps||0})}),await pe(K(W,"personalBestTargets",t),{clientId:B.id,targets:r,metricTargets:q,updatedAt:O.now()}),Se(r),Z(r),Y("Targets saved!","success"),N(!1)}catch(t){console.error("Error saving targets:",t),Y("Failed to save targets.","error")}M(!1)},Je=(t,n)=>{ee(r=>({...r,[t]:{...r[t],targetValue:n===""?"":parseFloat(n)}}))},Cs=async()=>{M(!0);try{const t=`targets_${B.id}`,n={};Ae.forEach(r=>{if($e[r.key]?.targetValue){const a=R?.bodyMetrics?.[r.key]||0;n[r.key]={targetValue:$e[r.key].targetValue,startValue:a}}}),await pe(K(W,"personalBestTargets",t),{clientId:B.id,targets:F,metricTargets:n,updatedAt:O.now()}),Pe(n),ee(n),Y("Metric targets saved!","success"),je(!1)}catch(t){console.error("Error saving metric targets:",t),Y("Failed to save targets.","error")}M(!1)},Qe=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){M(!0);try{const t=K(W,"personalBestTargets",`targets_${B.id}`);await Is(t),Se({}),Pe({}),Z({}),ee({}),Y("All goals have been reset","success")}catch(t){console.error("Error resetting targets:",t),Y("Failed to reset goals","error")}M(!1)}},Ms=(t,n)=>{const r=F[t];if(!r||!n)return null;if(r.targetType==="time"){if(!r.targetValue)return null;const g=r.startValue||0,w=r.targetValue,G=n.time||0,A=w-g;return A<=0?G>=w?1:0:Math.max(0,Math.min((G-g)/A,1))}if(!r.targetWeight&&!r.targetReps)return null;const a=(r.startWeight||0)*(r.startReps||0),d=(r.targetWeight||0)*(r.targetReps||0),v=(n.weight||0)*(n.reps||0),m=d-a;return m<=0?v>=d?1:0:Math.max(0,Math.min((v-a)/m,1))},gs=t=>{const n=q[t];if(!n||!n.targetValue)return null;const r=R?.bodyMetrics?.[t];if(r==null)return null;const a=n.startValue||0,d=n.targetValue,v=d-a;return v===0?r===d?1:0:Math.max(0,Math.min((r-a)/v,1))},Ts=t=>{X.current=t.touches[0].clientX,P.current=0},s=t=>{P.current=t.touches[0].clientX-X.current},i=()=>{P.current<-50?Ce($+1):P.current>50&&Ce($-1),P.current=0},l=t=>{const n=R?.bodyMetrics?.[t],r=ks?.bodyMetrics?.[t];return n==null||r==null?null:parseFloat((n-r).toFixed(2))},c=b.find(t=>t.month===fe),o=b.find(t=>t.month===Ee);if(hs||Be)return e.jsxs("div",{className:"pb-page",children:[e.jsx("header",{className:"client-header",children:e.jsx("div",{className:"header-content",children:e.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),e.jsxs("main",{className:"pb-main",children:[e.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),e.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!Ge||!Oe||!B)return null;if(Me&&B?.isJunior)return e.jsx(Zs,{});const y=xe[$],C=R?.benchmarks?.[y.key],j=ks?.benchmarks?.[y.key],f=es(y,C),k=es(y,j),E=$s(f,k),Te=Ms(y.key,C),Os=Te!==null,Bs=Te!==null&&Te>=1,zs=Os?Math.round(Te*60):f>0?15:0,we=F[y.key];return e.jsx(_s,{children:e.jsxs("div",{className:"pb-page",children:[e.jsx("header",{className:"client-header",children:e.jsxs("div",{className:"header-content",children:[e.jsx("button",{className:"header-back-btn",onClick:()=>Ne(ps?"/client/core-buddy":"/client"),"aria-label":"Go back",children:e.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M15 18l-6-6 6-6"})})}),e.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),e.jsxs("main",{className:"pb-main page-transition-enter",children:[e.jsxs("div",{className:"pb-intro anim-fade-up",children:[e.jsx("h2",{children:"Personal Bests"}),e.jsx("p",{children:Me?"Track your strength benchmarks and body measurements each month.":"Your all-time best lifts from programme workouts."})]}),!Me&&e.jsxs("div",{className:"pb-cb-section anim-fade-up-d2",children:[Object.keys(ae).length===0?e.jsxs("div",{className:"pb-empty",children:[e.jsx("div",{className:"pb-cb-empty-icon",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),e.jsx("h4",{children:"No personal bests yet"}),e.jsx("p",{children:"Complete weight-based workouts to start tracking your personal bests."})]}):e.jsx("div",{className:"pb-cb-grouped",children:(()=>{const t={},n=[];return Object.entries(ae).forEach(([r,a])=>{const d=st(r);d?(t[d]||(t[d]=[]),t[d].push([r,a])):n.push([r,a])}),Object.values(t).forEach(r=>r.sort(([a],[d])=>a.localeCompare(d))),n.sort(([r],[a])=>r.localeCompare(a)),e.jsxs(e.Fragment,{children:[et.map(r=>{const a=t[r.key];if(!a||a.length===0)return null;const d=!!be[r.key],v=a.reduce((m,[,g])=>!m||g.weight>m.weight?g:m,null);return e.jsxs("div",{className:`pb-cb-group ${d?"open":""}`,style:{"--group-color":r.color},children:[e.jsxs("button",{className:"pb-cb-group-header",onClick:()=>se(m=>({...m,[r.key]:!m[r.key]})),children:[e.jsx("div",{className:"pb-cb-group-accent"}),e.jsx("div",{className:"pb-cb-group-icon",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:e.jsx("path",{d:r.icon})})}),e.jsxs("div",{className:"pb-cb-group-text",children:[e.jsx("h3",{className:"pb-cb-group-label",children:r.label}),e.jsx("span",{className:"pb-cb-group-subtitle",children:r.subtitle})]}),e.jsxs("div",{className:"pb-cb-group-meta",children:[e.jsxs("span",{className:"pb-cb-group-count",children:[a.length," PB",a.length!==1?"s":""]}),v&&e.jsxs("span",{className:"pb-cb-group-best",children:["Best: ",v.weight,"kg"]})]}),e.jsx("svg",{className:`pb-cb-group-chevron ${d?"open":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M6 9l6 6 6-6"})})]}),e.jsx("div",{className:"pb-cb-group-body",style:{display:d?"block":"none"},children:e.jsx("div",{className:"pb-cb-grid",children:a.map(([m,g],w)=>{const G=ge[m],A=vs(m),re=A!==null&&A>=1,Ss=A!==null?Math.round(A*60):60;return e.jsxs("div",{className:"pb-cb-card",style:{"--group-color":r.color,animationDelay:`${w*.05}s`},children:[e.jsxs("div",{className:"pb-cb-card-top",children:[e.jsxs("div",{className:"pb-cb-card-ring",children:[e.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:Rs.map((bs,Vs)=>{const Ls=Vs<Ss;return e.jsx("line",{x1:bs.x1,y1:bs.y1,x2:bs.x2,y2:bs.y2,className:`pb-ring-tick ${Ls?re?"hit":"filled":"empty"}`,style:Ls&&!re?{stroke:r.color}:void 0,strokeWidth:bs.thick?"2":"1.5"},Vs)})}),e.jsx("div",{className:"pb-cb-ring-icon",style:{color:r.color},children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:e.jsx("path",{d:r.icon})})})]}),e.jsxs("div",{className:"pb-cb-card-info",children:[e.jsx("h4",{className:"pb-cb-card-name",children:m}),e.jsxs("div",{className:"pb-cb-card-value",style:{color:r.color},children:[g.weight,"kg × ",g.reps]}),g.achievedAt&&e.jsx("div",{className:"pb-cb-card-date",children:(g.achievedAt.toDate?g.achievedAt.toDate():new Date(g.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),G&&re&&e.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"})]}),e.jsx("div",{className:"pb-cb-card-action",children:e.jsx("button",{className:"pb-cb-target-btn",style:{borderColor:r.color,background:`color-mix(in srgb, ${r.color} 10%, transparent)`,color:r.color},onClick:()=>{V(m),os("")},children:G?re?e.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 5v14M5 12h14"})}):e.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}):e.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("circle",{cx:"12",cy:"12",r:"6"}),e.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]}),G&&!re&&e.jsxs("div",{className:"pb-cb-card-progress",children:[e.jsxs("div",{className:"pb-cb-progress-labels",children:[e.jsxs("span",{className:"pb-cb-progress-current",children:[g.weight,"kg"]}),e.jsxs("span",{className:"pb-cb-progress-target",style:{color:r.color},children:["Target: ",G.targetWeight,"kg"]})]}),e.jsx("div",{className:"pb-cb-progress-bar",children:e.jsx("div",{className:"pb-cb-progress-bar-fill",style:{width:`${Math.round((A||0)*100)}%`,background:r.color}})}),e.jsxs("div",{className:"pb-cb-progress-pct",style:{color:r.color},children:[Math.round((A||0)*100),"%"]})]}),G&&re&&e.jsx("div",{className:"pb-cb-card-progress",children:e.jsx("div",{className:"pb-cb-progress-bar",children:e.jsx("div",{className:"pb-cb-progress-bar-fill hit",style:{width:"100%"}})})})]},m)})})})]},r.key)}),n.length>0&&(()=>{const r=!!be.other;return e.jsxs("div",{className:`pb-cb-group ${r?"open":""}`,style:{"--group-color":"var(--text-tertiary)"},children:[e.jsxs("button",{className:"pb-cb-group-header",onClick:()=>se(a=>({...a,other:!a.other})),children:[e.jsx("div",{className:"pb-cb-group-accent"}),e.jsx("div",{className:"pb-cb-group-icon",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:e.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),e.jsx("div",{className:"pb-cb-group-text",children:e.jsx("h3",{className:"pb-cb-group-label",children:"Other"})}),e.jsx("div",{className:"pb-cb-group-meta",children:e.jsxs("span",{className:"pb-cb-group-count",children:[n.length," PB",n.length!==1?"s":""]})}),e.jsx("svg",{className:`pb-cb-group-chevron ${r?"open":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M6 9l6 6 6-6"})})]}),e.jsx("div",{className:"pb-cb-group-body",style:{display:r?"block":"none"},children:e.jsx("div",{className:"pb-cb-grid",children:n.map(([a,d],v)=>{const m=ge[a],g=vs(a),w=g!==null&&g>=1,G=g!==null?Math.round(g*60):60;return e.jsxs("div",{className:"pb-cb-card",style:{animationDelay:`${v*.05}s`},children:[e.jsxs("div",{className:"pb-cb-card-top",children:[e.jsxs("div",{className:"pb-cb-card-ring",children:[e.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:Rs.map((A,re)=>{const Ss=re<G;return e.jsx("line",{x1:A.x1,y1:A.y1,x2:A.x2,y2:A.y2,className:`pb-ring-tick ${Ss?w?"hit":"filled":"empty"}`,strokeWidth:A.thick?"2":"1.5"},re)})}),e.jsx("div",{className:"pb-cb-ring-icon",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})})]}),e.jsxs("div",{className:"pb-cb-card-info",children:[e.jsx("h4",{className:"pb-cb-card-name",children:a}),e.jsxs("div",{className:"pb-cb-card-value",children:[d.weight,"kg × ",d.reps]}),d.achievedAt&&e.jsx("div",{className:"pb-cb-card-date",children:(d.achievedAt.toDate?d.achievedAt.toDate():new Date(d.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),m&&w&&e.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"})]}),e.jsx("div",{className:"pb-cb-card-action",children:e.jsx("button",{className:"pb-cb-target-btn",onClick:()=>{V(a),os("")},children:m?w?e.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 5v14M5 12h14"})}):e.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}):e.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("circle",{cx:"12",cy:"12",r:"6"}),e.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]}),m&&!w&&e.jsxs("div",{className:"pb-cb-card-progress",children:[e.jsxs("div",{className:"pb-cb-progress-labels",children:[e.jsxs("span",{className:"pb-cb-progress-current",children:[d.weight,"kg"]}),e.jsxs("span",{className:"pb-cb-progress-target",children:["Target: ",m.targetWeight,"kg"]})]}),e.jsx("div",{className:"pb-cb-progress-bar",children:e.jsx("div",{className:"pb-cb-progress-bar-fill",style:{width:`${Math.round((g||0)*100)}%`}})}),e.jsxs("div",{className:"pb-cb-progress-pct",children:[Math.round((g||0)*100),"%"]})]}),m&&w&&e.jsx("div",{className:"pb-cb-card-progress",children:e.jsx("div",{className:"pb-cb-progress-bar",children:e.jsx("div",{className:"pb-cb-progress-bar-fill hit",style:{width:"100%"}})})})]},a)})})})]})})()]})})()}),ce&&e.jsx("div",{className:"pb-cb-target-modal-overlay",onClick:()=>V(null),children:e.jsxs("div",{className:"pb-cb-target-modal",onClick:t=>t.stopPropagation(),children:[e.jsx("h3",{children:"Set Target"}),e.jsx("p",{className:"pb-cb-target-exercise-name",children:ce}),e.jsxs("div",{className:"pb-cb-target-current",children:["Current PB: ",e.jsxs("strong",{children:[ae[ce]?.weight,"kg"]})]}),e.jsxs("div",{className:"pb-cb-target-input-wrap",children:[e.jsx("label",{children:"Your target (kg)"}),e.jsx("input",{type:"number",inputMode:"decimal",step:"0.5",value:Re,onChange:t=>os(t.target.value),placeholder:String((ae[ce]?.weight||0)+5),className:"pb-cb-target-input",autoFocus:!0})]}),e.jsxs("div",{className:"pb-cb-target-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>V(null),children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:ws,disabled:S,children:S?"Saving...":"Set Target"})]})]})})]}),Me&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"pb-tabs",children:[e.jsx("button",{className:`pb-tab ${h==="bests"?"active":""}`,onClick:()=>u("bests"),children:"Strength"}),e.jsx("button",{className:`pb-tab ${h==="metrics"?"active":""}`,onClick:()=>u("metrics"),children:"Body Metrics"}),e.jsx("button",{className:`pb-tab ${h==="history"?"active":""}`,onClick:()=>u("history"),children:"History"})]}),h==="bests"&&e.jsxs("div",{className:"pb-strength-section",children:[!ne&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"pb-carousel",ref:ds,onTouchStart:Ts,onTouchMove:s,onTouchEnd:i,children:[e.jsx("div",{className:`pb-ring-container slide-from-${He.current}`,children:e.jsxs("div",{className:"pb-ring",children:[e.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:Es.map((t,n)=>{const r=n<Math.round(zs);return e.jsx("line",{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,className:`pb-ring-tick ${r?Bs?"hit":"filled":"empty"}`,strokeWidth:t.thick?"3":"2"},n)})}),e.jsxs("div",{className:"pb-ring-center",children:[e.jsx("div",{className:"pb-ring-category",children:y.category}),e.jsxs("div",{className:"pb-ring-exercise",children:[y.name,Ye("strength",y.key)&&e.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),e.jsx("div",{className:"pb-ring-value",children:C?y.unit==="time"?Ns(C.time):qs(C.weight,C.reps):"-"}),E!==null&&e.jsxs("div",{className:`pb-ring-change ${E>=0?"positive":"negative"}`,children:[E>=0?"+":"",E.toFixed(1),"%"]}),E===null&&C&&e.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),we&&e.jsx("div",{className:`pb-ring-target ${Bs?"hit":""}`,children:Bs?"Target hit!":we.targetType==="time"?`${we.startValue||0}s → ${we.targetValue}s`:`${we.startWeight||0}kg×${we.startReps||0} → ${we.targetWeight}kg×${we.targetReps}`}),!we&&e.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},$),e.jsx("div",{className:"pb-carousel-dots",children:xe.map((t,n)=>e.jsx("button",{className:`pb-dot ${n===$?"active":""}`,onClick:()=>Ce(n)},n))}),e.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>Ce($-1),disabled:$===0,children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),e.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>Ce($+1),disabled:$===xe.length-1,children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),e.jsxs("div",{className:"pb-trend-section",children:[e.jsx("h4",{children:"Trend"}),e.jsx(rt,{data:b,exerciseKey:y.key,unit:y.unit})]})]}),!ne&&!ye&&e.jsxs("div",{className:"pb-action-buttons",children:[e.jsx("button",{className:"pb-edit-btn",onClick:()=>D(!0),children:R?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),e.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>N(!0),children:Object.keys(F).length>0?"Edit Targets":"Set Targets"}),(Object.keys(F).length>0||Object.keys(q).length>0)&&e.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Qe,disabled:S,children:"Reset All Goals"})]}),ne&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsxs("h3",{children:["Benchmarks - ",he(te)]}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{D(!1),_(R?.benchmarks||{})},children:"×"})]}),e.jsx("div",{className:"pb-edit-body",children:xe.map(t=>e.jsxs("div",{className:"pb-edit-exercise",children:[e.jsx("div",{className:"pb-edit-exercise-name",children:t.name}),t.unit==="weight"?e.jsxs("div",{className:"pb-edit-row",children:[e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Weight (kg)"}),e.jsx("input",{type:"number",step:"0.5",value:x[t.key]?.weight??"",onChange:n=>Ke(t.key,"weight",n.target.value),placeholder:"0"})]}),e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Reps"}),e.jsx("input",{type:"number",value:x[t.key]?.reps??"",onChange:n=>Ke(t.key,"reps",n.target.value),placeholder:"0"})]})]}):e.jsxs("div",{className:"pb-edit-row",children:[e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Minutes"}),e.jsx("input",{type:"number",min:"0",step:"1",value:(()=>{const n=x[t.key]?.time;return n!==void 0&&n!==""?Math.floor(Number(n)/60):""})(),onChange:n=>{const r=n.target.value===""?0:Math.max(0,parseInt(n.target.value,10)||0),a=(()=>{const d=x[t.key]?.time;return d!==void 0&&d!==""?Number(d)%60:0})();Ke(t.key,"time",r*60+a)},placeholder:"0"})]}),e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Seconds"}),e.jsx("input",{type:"number",min:"0",max:"59",step:"1",value:(()=>{const n=x[t.key]?.time;return n!==void 0&&n!==""?Number(n)%60:""})(),onChange:n=>{const r=n.target.value===""?0:Math.min(59,Math.max(0,parseInt(n.target.value,10)||0)),a=(()=>{const d=x[t.key]?.time;return d!==void 0&&d!==""?Math.floor(Number(d)/60):0})();Ke(t.key,"time",a*60+r)},placeholder:"0"})]})]})]},t.key))}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{D(!1),_(R?.benchmarks||{})},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:J,disabled:S,children:S?"Saving...":"Save"})]})]}),ye&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsx("h3",{children:"Set Your Targets"}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{N(!1),Z(F)},children:"×"})]}),e.jsxs("div",{className:"pb-edit-body",children:[e.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),xe.map(t=>{const n=R?.benchmarks?.[t.key];let r="-";return n&&(t.unit==="time"&&n.time?r=`${n.time}s`:(n.weight||n.reps)&&(r=`${n.weight||0}kg × ${n.reps||0}`)),e.jsxs("div",{className:"pb-edit-exercise",children:[e.jsxs("div",{className:"pb-edit-exercise-header",children:[e.jsx("div",{className:"pb-edit-exercise-name",children:t.name}),e.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",r]})]}),t.unit==="weight"?e.jsxs("div",{className:"pb-edit-row",children:[e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Target Weight (kg)"}),e.jsx("input",{type:"number",step:"0.5",value:T[t.key]?.targetWeight??"",onChange:a=>Xe(t.key,"targetWeight",a.target.value),placeholder:"0"})]}),e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Target Reps"}),e.jsx("input",{type:"number",value:T[t.key]?.targetReps??"",onChange:a=>Xe(t.key,"targetReps",a.target.value),placeholder:"0"})]})]}):e.jsxs("div",{className:"pb-edit-row",children:[e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Target Minutes"}),e.jsx("input",{type:"number",min:"0",step:"1",value:(()=>{const a=T[t.key]?.targetValue;return a!==void 0&&a!==""?Math.floor(Number(a)/60):""})(),onChange:a=>{const d=a.target.value===""?0:Math.max(0,parseInt(a.target.value,10)||0),v=(()=>{const m=T[t.key]?.targetValue;return m!==void 0&&m!==""?Number(m)%60:0})();Xe(t.key,"targetValue",d*60+v)},placeholder:"0"})]}),e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Target Seconds"}),e.jsx("input",{type:"number",min:"0",max:"59",step:"1",value:(()=>{const a=T[t.key]?.targetValue;return a!==void 0&&a!==""?Number(a)%60:""})(),onChange:a=>{const d=a.target.value===""?0:Math.min(59,Math.max(0,parseInt(a.target.value,10)||0)),v=(()=>{const m=T[t.key]?.targetValue;return m!==void 0&&m!==""?Math.floor(Number(m)/60):0})();Xe(t.key,"targetValue",v*60+d)},placeholder:"0"})]})]})]},t.key)})]}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{N(!1),Z(F)},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:We,disabled:S,children:S?"Saving...":"Save Targets"})]})]})]}),h==="metrics"&&e.jsxs("div",{className:"pb-metrics-section",children:[!H&&!ns&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"pb-metrics-card",children:[e.jsx("h3",{children:"Body Measurements"}),e.jsx("p",{className:"pb-metrics-month",children:he(te)}),e.jsx("div",{className:"pb-metrics-list",children:Ae.map(t=>{const n=R?.bodyMetrics?.[t.key],r=l(t.key),a=q[t.key],d=gs(t.key),v=d!==null&&d>=1;return e.jsxs("div",{className:"pb-metric-row",children:[e.jsxs("div",{className:"pb-metric-top",children:[e.jsxs("div",{className:"pb-metric-left",children:[e.jsxs("span",{className:"pb-metric-name",children:[t.name,Ye("metric",t.key)&&e.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),a&&e.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",a.targetValue," ",t.suffix]})]}),e.jsxs("div",{className:"pb-metric-values",children:[e.jsx("span",{className:"pb-metric-current",children:n!=null?`${n} ${t.suffix}`:"-"}),r!==null&&e.jsxs("span",{className:`pb-metric-change ${r>0?"up":r<0?"down":"same"}`,children:[r>0?"+":"",r," ",t.suffix]})]})]}),d!==null&&e.jsxs("div",{className:"pb-metric-progress",children:[e.jsx("div",{className:"pb-metric-bar",children:e.jsx("div",{className:`pb-metric-bar-fill ${v?"hit":""}`,style:{width:`${Math.round(d*100)}%`}})}),e.jsx("span",{className:`pb-metric-percent ${v?"hit":""}`,children:v?"Hit!":`${Math.round(d*100)}%`})]})]},t.key)})})]}),e.jsxs("div",{className:"pb-action-buttons",children:[e.jsx("button",{className:"pb-edit-btn",onClick:()=>U(!0),children:R?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),e.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>je(!0),children:Object.keys(q).length>0?"Edit Targets":"Set Targets"}),(Object.keys(F).length>0||Object.keys(q).length>0)&&e.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Qe,disabled:S,children:"Reset All Goals"})]})]}),H&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsxs("h3",{children:["Measurements - ",he(te)]}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{U(!1),ie(R?.bodyMetrics||{})},children:"×"})]}),e.jsxs("div",{className:"pb-edit-body",children:[e.jsxs("div",{className:"pb-unit-toggle",children:[e.jsx("span",{className:"pb-unit-toggle-label",children:"Measurement unit:"}),e.jsxs("div",{className:"pb-unit-toggle-btns",children:[e.jsx("button",{className:`pb-unit-btn${le==="cm"?" active":""}`,onClick:()=>xs("cm"),type:"button",children:"cm"}),e.jsx("button",{className:`pb-unit-btn${le==="in"?" active":""}`,onClick:()=>xs("in"),type:"button",children:"in"})]})]}),Ae.map(t=>{const n=t.suffix==="cm",r=n?le:t.suffix,a=Q[t.key],d=!n||le==="cm"?a??"":a===void 0||a===""?"":parseFloat((Number(a)/2.54).toFixed(1));return e.jsx("div",{className:"pb-edit-metric",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsxs("label",{children:[t.name," (",r,")"]}),e.jsx("input",{type:"number",step:"0.1",min:"0",value:d,onChange:v=>{const m=v.target.value;if(!n||le==="cm")ms(t.key,m);else{const g=m===""?"":(parseFloat(m)*2.54).toFixed(1);ms(t.key,g)}},placeholder:"0"})]})},t.key)})]}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{U(!1),ie(R?.bodyMetrics||{})},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:qe,disabled:S,children:S?"Saving...":"Save"})]})]}),ns&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsx("h3",{children:"Body Metric Targets"}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{je(!1),ee(q)},children:"×"})]}),e.jsxs("div",{className:"pb-edit-body",children:[e.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),Ae.map(t=>{const n=R?.bodyMetrics?.[t.key];return e.jsxs("div",{className:"pb-edit-exercise",children:[e.jsxs("div",{className:"pb-edit-exercise-header",children:[e.jsx("div",{className:"pb-edit-exercise-name",children:t.name}),e.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",n!=null?`${n} ${t.suffix}`:"-"]})]}),e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsxs("label",{children:["Target (",t.suffix,")"]}),e.jsx("input",{type:"number",step:"0.1",value:$e[t.key]?.targetValue??"",onChange:r=>Je(t.key,r.target.value),placeholder:"0"})]})})]},t.key)})]}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{je(!1),ee(q)},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:Cs,disabled:S,children:S?"Saving...":"Save Targets"})]})]})]}),h==="history"&&e.jsx("div",{className:"pb-history-section",children:b.length===0?e.jsxs("div",{className:"pb-empty",children:[e.jsx("h4",{children:"No records yet"}),e.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):e.jsxs(e.Fragment,{children:[L.length>0&&e.jsxs("div",{className:"pb-achievements-wall",children:[e.jsxs("h4",{className:"pb-achievements-wall-title",children:[e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),e.jsx("div",{className:"pb-achievements-list",children:[...L].reverse().map((t,n)=>e.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${n*.05}s`},children:[e.jsx("div",{className:"pb-achievement-star",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),e.jsxs("div",{className:"pb-achievement-info",children:[e.jsx("span",{className:"pb-achievement-label",children:t.label}),e.jsx("span",{className:"pb-achievement-date",children:he(t.achievedMonth)})]})]},n))})]}),e.jsx("div",{className:"pb-history-controls",children:e.jsx("button",{className:`pb-compare-toggle ${me?"active":""}`,onClick:()=>{ys(!me),!me&&b.length>=2&&(ls(b[0].month),cs(b[b.length-1].month))},children:me?"Back to Timeline":"Compare Months"})}),me?e.jsxs("div",{className:"pb-compare",children:[e.jsxs("div",{className:"pb-compare-selectors",children:[e.jsxs("div",{className:"pb-compare-select",children:[e.jsx("label",{children:"From"}),e.jsx("select",{value:fe,onChange:t=>ls(t.target.value),children:b.map(t=>e.jsx("option",{value:t.month,children:he(t.month)},t.month))})]}),e.jsx("div",{className:"pb-compare-vs",children:"vs"}),e.jsxs("div",{className:"pb-compare-select",children:[e.jsx("label",{children:"To"}),e.jsx("select",{value:Ee,onChange:t=>cs(t.target.value),children:b.map(t=>e.jsx("option",{value:t.month,children:he(t.month)},t.month))})]})]}),c&&o&&e.jsxs("div",{className:"pb-compare-results",children:[e.jsxs("div",{className:"pb-compare-group",children:[e.jsx("h4",{children:"Strength Benchmarks"}),e.jsxs("div",{className:"pb-compare-table",children:[e.jsxs("div",{className:"pb-compare-header-row",children:[e.jsx("span",{children:"Exercise"}),e.jsx("span",{children:he(fe).split(" ")[0]}),e.jsx("span",{children:he(Ee).split(" ")[0]}),e.jsx("span",{children:"Change"})]}),xe.map(t=>{const n=c.benchmarks?.[t.key],r=o.benchmarks?.[t.key],a=es(t,n),d=es(t,r),v=$s(d,a);return e.jsxs("div",{className:"pb-compare-row",children:[e.jsx("span",{className:"pb-compare-name",children:t.name}),e.jsx("span",{className:"pb-compare-val",children:n?t.unit==="time"?Ns(n.time):`${n.weight}x${n.reps}`:"-"}),e.jsx("span",{className:"pb-compare-val",children:r?t.unit==="time"?Ns(r.time):`${r.weight}x${r.reps}`:"-"}),e.jsx("span",{className:`pb-compare-change ${v!==null?v>=0?"positive":"negative":""}`,children:v!==null?`${v>=0?"+":""}${v.toFixed(1)}%`:"-"})]},t.key)})]})]}),e.jsxs("div",{className:"pb-compare-group",children:[e.jsx("h4",{children:"Body Measurements"}),e.jsxs("div",{className:"pb-compare-table",children:[e.jsxs("div",{className:"pb-compare-header-row",children:[e.jsx("span",{children:"Measurement"}),e.jsx("span",{children:he(fe).split(" ")[0]}),e.jsx("span",{children:he(Ee).split(" ")[0]}),e.jsx("span",{children:"Change"})]}),Ae.map(t=>{const n=c.bodyMetrics?.[t.key],r=o.bodyMetrics?.[t.key],a=n!=null&&r!=null?parseFloat((r-n).toFixed(2)):null;return e.jsxs("div",{className:"pb-compare-row",children:[e.jsx("span",{className:"pb-compare-name",children:t.name}),e.jsx("span",{className:"pb-compare-val",children:n!=null?`${n}`:"-"}),e.jsx("span",{className:"pb-compare-val",children:r!=null?`${r}`:"-"}),e.jsx("span",{className:`pb-compare-change ${a!==null?a>0?"positive":a<0?"negative":"neutral":""}`,children:a!==null?`${a>0?"+":""}${a} ${t.suffix}`:"-"})]},t.key)})]})]})]})]}):e.jsx("div",{className:"pb-timeline",children:[...b].reverse().map((t,n)=>{const r=b.find(a=>a.month<t.month&&b.indexOf(a)===b.indexOf(t)-1)||b.filter(a=>a.month<t.month).pop();return e.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${n*.05}s`},children:[e.jsx("div",{className:"pb-timeline-dot"}),e.jsxs("div",{className:"pb-timeline-card",children:[e.jsx("h4",{children:he(t.month)}),t.benchmarks&&Object.keys(t.benchmarks).length>0&&e.jsxs("div",{className:"pb-timeline-group",children:[e.jsx("h5",{children:"Strength Benchmarks"}),xe.map(a=>{const d=t.benchmarks[a.key];if(!d)return null;const v=r?.benchmarks?.[a.key],m=es(a,d),g=es(a,v),w=$s(m,g);return e.jsxs("div",{className:"pb-timeline-row",children:[e.jsx("span",{className:"pb-timeline-label",children:a.name}),e.jsxs("div",{className:"pb-timeline-values",children:[e.jsx("span",{className:"pb-timeline-value",children:a.unit==="time"?Ns(d.time):qs(d.weight,d.reps)}),w!==null&&e.jsxs("span",{className:`pb-timeline-change ${w>=0?"positive":"negative"}`,children:[w>=0?"+":"",w.toFixed(1),"%"]})]})]},a.key)})]}),t.bodyMetrics&&Object.keys(t.bodyMetrics).length>0&&e.jsxs("div",{className:"pb-timeline-group",children:[e.jsx("h5",{children:"Body Measurements"}),Ae.map(a=>{const d=t.bodyMetrics[a.key];if(d==null)return null;const v=r?.bodyMetrics?.[a.key],m=v!=null?parseFloat((d-v).toFixed(2)):null;return e.jsxs("div",{className:"pb-timeline-row",children:[e.jsx("span",{className:"pb-timeline-label",children:a.name}),e.jsxs("div",{className:"pb-timeline-values",children:[e.jsxs("span",{className:"pb-timeline-value",children:[d," ",a.suffix]}),m!==null&&e.jsxs("span",{className:`pb-timeline-change ${m>0?"positive":m<0?"negative":"neutral"}`,children:[m>0?"+":"",m," ",a.suffix]})]})]},a.key)})]})]})]},t.id)})})]})})]})]}),ve&&e.jsx("div",{className:"pb-celebration-overlay",onClick:()=>Ve(null),children:e.jsxs("div",{className:"pb-celebration-card",children:[e.jsx("div",{className:"pb-celebration-icon",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),e.jsx("h3",{className:"pb-celebration-title",children:ve.length===1?"Target Achieved!":`${ve.length} Targets Achieved!`}),e.jsx("div",{className:"pb-celebration-badges",children:ve.map((t,n)=>e.jsx("div",{className:"pb-celebration-badge",children:t.label},n))}),e.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),ke&&e.jsxs("div",{className:`toast-notification ${ke.type}`,children:[e.jsx("span",{className:"toast-icon",children:ke.type==="success"?e.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),e.jsx("span",{className:"toast-message",children:ke.message}),e.jsx("button",{className:"toast-close",onClick:()=>Le(null),children:"×"})]}),Me&&e.jsxs("nav",{className:"block-bottom-nav",children:[e.jsxs("button",{className:"block-nav-tab",onClick:()=>Ne("/client"),children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),e.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),e.jsx("span",{children:"Home"})]}),e.jsxs("button",{className:"block-nav-tab",onClick:()=>Ne("/client/forms"),children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),e.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),e.jsx("span",{children:"Forms"})]}),e.jsxs("button",{className:"block-nav-tab",onClick:()=>Ne("/client/tools"),children:[e.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),e.jsx("span",{children:"Tools"})]}),e.jsxs("button",{className:"block-nav-tab active",children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12 20V10"}),e.jsx("path",{d:"M18 20V4"}),e.jsx("path",{d:"M6 20v-4"})]}),e.jsx("span",{children:"PBs"})]}),B?.circuitAccess&&e.jsxs("button",{className:"block-nav-tab",onClick:()=>Ne("/client/circuit"),children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M12 6v6l4 2"})]}),e.jsx("span",{children:"Circuit"})]})]}),ps&&e.jsx(Ys,{active:"progress"})]})})}export{it as default};
