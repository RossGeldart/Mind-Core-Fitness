const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-CbImwsH8.js","assets/Dashboard-BI21Q1GR.css","assets/AddClient-CbwMPJa5.js","assets/AddClient-DH1OFzHo.css","assets/ClientForms-DFkrQD13.js","assets/ClientForms-GDNtnrAx.css","assets/ClientTools-CfSVtVgV.js","assets/ClientTools-DQRPoST3.css","assets/MacroCalculator-ljrYOUrb.js","assets/ProteinSnacks-BwQ6mMo0.js","assets/DailyMotivation-Cmq6mzpe.js","assets/CircuitDashboard-DRRRp50M.js","assets/CircuitDashboard-MPNVarsJ.css","assets/CircuitBooking-BjH2GaQI.js","assets/CircuitBooking-ruk9Q4Wj.css","assets/Leaderboard-CPaNl5PK.js","assets/Leaderboard-Dq-r5svP.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const h of u.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function n(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(l){if(l.ep)return;l.ep=!0;const u=n(l);fetch(l.href,u)}})();var dp={exports:{}},Vc={};var d1;function rj(){if(d1)return Vc;d1=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(i,l,u){var h=null;if(u!==void 0&&(h=""+u),l.key!==void 0&&(h=""+l.key),"key"in l){u={};for(var p in l)p!=="key"&&(u[p]=l[p])}else u=l;return l=u.ref,{$$typeof:s,type:i,key:h,ref:l!==void 0?l:null,props:u}}return Vc.Fragment=e,Vc.jsx=n,Vc.jsxs=n,Vc}var f1;function aj(){return f1||(f1=1,dp.exports=rj()),dp.exports}var a=aj(),fp={exports:{}},Yt={};var m1;function ij(){if(m1)return Yt;m1=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),h=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),E=Symbol.iterator;function O(L){return L===null||typeof L!="object"?null:(L=E&&L[E]||L["@@iterator"],typeof L=="function"?L:null)}var G={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},U=Object.assign,V={};function ne(L,H,ye){this.props=L,this.context=H,this.refs=V,this.updater=ye||G}ne.prototype.isReactComponent={},ne.prototype.setState=function(L,H){if(typeof L!="object"&&typeof L!="function"&&L!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,L,H,"setState")},ne.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,"forceUpdate")};function J(){}J.prototype=ne.prototype;function fe(L,H,ye){this.props=L,this.context=H,this.refs=V,this.updater=ye||G}var Te=fe.prototype=new J;Te.constructor=fe,U(Te,ne.prototype),Te.isPureReactComponent=!0;var $e=Array.isArray;function Ve(){}var I={H:null,A:null,T:null,S:null},j=Object.prototype.hasOwnProperty;function R(L,H,ye){var Se=ye.ref;return{$$typeof:s,type:L,key:H,ref:Se!==void 0?Se:null,props:ye}}function P(L,H){return R(L.type,H,L.props)}function D(L){return typeof L=="object"&&L!==null&&L.$$typeof===s}function z(L){var H={"=":"=0",":":"=2"};return"$"+L.replace(/[=:]/g,function(ye){return H[ye]})}var M=/\/+/g;function We(L,H){return typeof L=="object"&&L!==null&&L.key!=null?z(""+L.key):H.toString(36)}function wt(L){switch(L.status){case"fulfilled":return L.value;case"rejected":throw L.reason;default:switch(typeof L.status=="string"?L.then(Ve,Ve):(L.status="pending",L.then(function(H){L.status==="pending"&&(L.status="fulfilled",L.value=H)},function(H){L.status==="pending"&&(L.status="rejected",L.reason=H)})),L.status){case"fulfilled":return L.value;case"rejected":throw L.reason}}throw L}function Q(L,H,ye,Se,qe){var Ae=typeof L;(Ae==="undefined"||Ae==="boolean")&&(L=null);var nt=!1;if(L===null)nt=!0;else switch(Ae){case"bigint":case"string":case"number":nt=!0;break;case"object":switch(L.$$typeof){case s:case e:nt=!0;break;case w:return nt=L._init,Q(nt(L._payload),H,ye,Se,qe)}}if(nt)return qe=qe(L),nt=Se===""?"."+We(L,0):Se,$e(qe)?(ye="",nt!=null&&(ye=nt.replace(M,"$&/")+"/"),Q(qe,H,ye,"",function(qt){return qt})):qe!=null&&(D(qe)&&(qe=P(qe,ye+(qe.key==null||L&&L.key===qe.key?"":(""+qe.key).replace(M,"$&/")+"/")+nt)),H.push(qe)),1;nt=0;var pt=Se===""?".":Se+":";if($e(L))for(var Je=0;Je<L.length;Je++)Se=L[Je],Ae=pt+We(Se,Je),nt+=Q(Se,H,ye,Ae,qe);else if(Je=O(L),typeof Je=="function")for(L=Je.call(L),Je=0;!(Se=L.next()).done;)Se=Se.value,Ae=pt+We(Se,Je++),nt+=Q(Se,H,ye,Ae,qe);else if(Ae==="object"){if(typeof L.then=="function")return Q(wt(L),H,ye,Se,qe);throw H=String(L),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(L).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.")}return nt}function je(L,H,ye){if(L==null)return L;var Se=[],qe=0;return Q(L,Se,"","",function(Ae){return H.call(ye,Ae,qe++)}),Se}function ze(L){if(L._status===-1){var H=L._result;H=H(),H.then(function(ye){(L._status===0||L._status===-1)&&(L._status=1,L._result=ye)},function(ye){(L._status===0||L._status===-1)&&(L._status=2,L._result=ye)}),L._status===-1&&(L._status=0,L._result=H)}if(L._status===1)return L._result.default;throw L._result}var lt=typeof reportError=="function"?reportError:function(L){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var H=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof L=="object"&&L!==null&&typeof L.message=="string"?String(L.message):String(L),error:L});if(!window.dispatchEvent(H))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",L);return}console.error(L)},ie={map:je,forEach:function(L,H,ye){je(L,function(){H.apply(this,arguments)},ye)},count:function(L){var H=0;return je(L,function(){H++}),H},toArray:function(L){return je(L,function(H){return H})||[]},only:function(L){if(!D(L))throw Error("React.Children.only expected to receive a single React element child.");return L}};return Yt.Activity=k,Yt.Children=ie,Yt.Component=ne,Yt.Fragment=n,Yt.Profiler=l,Yt.PureComponent=fe,Yt.StrictMode=i,Yt.Suspense=g,Yt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=I,Yt.__COMPILER_RUNTIME={__proto__:null,c:function(L){return I.H.useMemoCache(L)}},Yt.cache=function(L){return function(){return L.apply(null,arguments)}},Yt.cacheSignal=function(){return null},Yt.cloneElement=function(L,H,ye){if(L==null)throw Error("The argument must be a React element, but you passed "+L+".");var Se=U({},L.props),qe=L.key;if(H!=null)for(Ae in H.key!==void 0&&(qe=""+H.key),H)!j.call(H,Ae)||Ae==="key"||Ae==="__self"||Ae==="__source"||Ae==="ref"&&H.ref===void 0||(Se[Ae]=H[Ae]);var Ae=arguments.length-2;if(Ae===1)Se.children=ye;else if(1<Ae){for(var nt=Array(Ae),pt=0;pt<Ae;pt++)nt[pt]=arguments[pt+2];Se.children=nt}return R(L.type,qe,Se)},Yt.createContext=function(L){return L={$$typeof:h,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null},L.Provider=L,L.Consumer={$$typeof:u,_context:L},L},Yt.createElement=function(L,H,ye){var Se,qe={},Ae=null;if(H!=null)for(Se in H.key!==void 0&&(Ae=""+H.key),H)j.call(H,Se)&&Se!=="key"&&Se!=="__self"&&Se!=="__source"&&(qe[Se]=H[Se]);var nt=arguments.length-2;if(nt===1)qe.children=ye;else if(1<nt){for(var pt=Array(nt),Je=0;Je<nt;Je++)pt[Je]=arguments[Je+2];qe.children=pt}if(L&&L.defaultProps)for(Se in nt=L.defaultProps,nt)qe[Se]===void 0&&(qe[Se]=nt[Se]);return R(L,Ae,qe)},Yt.createRef=function(){return{current:null}},Yt.forwardRef=function(L){return{$$typeof:p,render:L}},Yt.isValidElement=D,Yt.lazy=function(L){return{$$typeof:w,_payload:{_status:-1,_result:L},_init:ze}},Yt.memo=function(L,H){return{$$typeof:y,type:L,compare:H===void 0?null:H}},Yt.startTransition=function(L){var H=I.T,ye={};I.T=ye;try{var Se=L(),qe=I.S;qe!==null&&qe(ye,Se),typeof Se=="object"&&Se!==null&&typeof Se.then=="function"&&Se.then(Ve,lt)}catch(Ae){lt(Ae)}finally{H!==null&&ye.types!==null&&(H.types=ye.types),I.T=H}},Yt.unstable_useCacheRefresh=function(){return I.H.useCacheRefresh()},Yt.use=function(L){return I.H.use(L)},Yt.useActionState=function(L,H,ye){return I.H.useActionState(L,H,ye)},Yt.useCallback=function(L,H){return I.H.useCallback(L,H)},Yt.useContext=function(L){return I.H.useContext(L)},Yt.useDebugValue=function(){},Yt.useDeferredValue=function(L,H){return I.H.useDeferredValue(L,H)},Yt.useEffect=function(L,H){return I.H.useEffect(L,H)},Yt.useEffectEvent=function(L){return I.H.useEffectEvent(L)},Yt.useId=function(){return I.H.useId()},Yt.useImperativeHandle=function(L,H,ye){return I.H.useImperativeHandle(L,H,ye)},Yt.useInsertionEffect=function(L,H){return I.H.useInsertionEffect(L,H)},Yt.useLayoutEffect=function(L,H){return I.H.useLayoutEffect(L,H)},Yt.useMemo=function(L,H){return I.H.useMemo(L,H)},Yt.useOptimistic=function(L,H){return I.H.useOptimistic(L,H)},Yt.useReducer=function(L,H,ye){return I.H.useReducer(L,H,ye)},Yt.useRef=function(L){return I.H.useRef(L)},Yt.useState=function(L){return I.H.useState(L)},Yt.useSyncExternalStore=function(L,H,ye){return I.H.useSyncExternalStore(L,H,ye)},Yt.useTransition=function(){return I.H.useTransition()},Yt.version="19.2.4",Yt}var p1;function Eg(){return p1||(p1=1,fp.exports=ij()),fp.exports}var x=Eg(),mp={exports:{}},Bc={},pp={exports:{}},gp={};var g1;function oj(){return g1||(g1=1,(function(s){function e(Q,je){var ze=Q.length;Q.push(je);e:for(;0<ze;){var lt=ze-1>>>1,ie=Q[lt];if(0<l(ie,je))Q[lt]=je,Q[ze]=ie,ze=lt;else break e}}function n(Q){return Q.length===0?null:Q[0]}function i(Q){if(Q.length===0)return null;var je=Q[0],ze=Q.pop();if(ze!==je){Q[0]=ze;e:for(var lt=0,ie=Q.length,L=ie>>>1;lt<L;){var H=2*(lt+1)-1,ye=Q[H],Se=H+1,qe=Q[Se];if(0>l(ye,ze))Se<ie&&0>l(qe,ye)?(Q[lt]=qe,Q[Se]=ze,lt=Se):(Q[lt]=ye,Q[H]=ze,lt=H);else if(Se<ie&&0>l(qe,ze))Q[lt]=qe,Q[Se]=ze,lt=Se;else break e}}return je}function l(Q,je){var ze=Q.sortIndex-je.sortIndex;return ze!==0?ze:Q.id-je.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;s.unstable_now=function(){return u.now()}}else{var h=Date,p=h.now();s.unstable_now=function(){return h.now()-p}}var g=[],y=[],w=1,k=null,E=3,O=!1,G=!1,U=!1,V=!1,ne=typeof setTimeout=="function"?setTimeout:null,J=typeof clearTimeout=="function"?clearTimeout:null,fe=typeof setImmediate<"u"?setImmediate:null;function Te(Q){for(var je=n(y);je!==null;){if(je.callback===null)i(y);else if(je.startTime<=Q)i(y),je.sortIndex=je.expirationTime,e(g,je);else break;je=n(y)}}function $e(Q){if(U=!1,Te(Q),!G)if(n(g)!==null)G=!0,Ve||(Ve=!0,z());else{var je=n(y);je!==null&&wt($e,je.startTime-Q)}}var Ve=!1,I=-1,j=5,R=-1;function P(){return V?!0:!(s.unstable_now()-R<j)}function D(){if(V=!1,Ve){var Q=s.unstable_now();R=Q;var je=!0;try{e:{G=!1,U&&(U=!1,J(I),I=-1),O=!0;var ze=E;try{t:{for(Te(Q),k=n(g);k!==null&&!(k.expirationTime>Q&&P());){var lt=k.callback;if(typeof lt=="function"){k.callback=null,E=k.priorityLevel;var ie=lt(k.expirationTime<=Q);if(Q=s.unstable_now(),typeof ie=="function"){k.callback=ie,Te(Q),je=!0;break t}k===n(g)&&i(g),Te(Q)}else i(g);k=n(g)}if(k!==null)je=!0;else{var L=n(y);L!==null&&wt($e,L.startTime-Q),je=!1}}break e}finally{k=null,E=ze,O=!1}je=void 0}}finally{je?z():Ve=!1}}}var z;if(typeof fe=="function")z=function(){fe(D)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,We=M.port2;M.port1.onmessage=D,z=function(){We.postMessage(null)}}else z=function(){ne(D,0)};function wt(Q,je){I=ne(function(){Q(s.unstable_now())},je)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(Q){Q.callback=null},s.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<Q?Math.floor(1e3/Q):5},s.unstable_getCurrentPriorityLevel=function(){return E},s.unstable_next=function(Q){switch(E){case 1:case 2:case 3:var je=3;break;default:je=E}var ze=E;E=je;try{return Q()}finally{E=ze}},s.unstable_requestPaint=function(){V=!0},s.unstable_runWithPriority=function(Q,je){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var ze=E;E=Q;try{return je()}finally{E=ze}},s.unstable_scheduleCallback=function(Q,je,ze){var lt=s.unstable_now();switch(typeof ze=="object"&&ze!==null?(ze=ze.delay,ze=typeof ze=="number"&&0<ze?lt+ze:lt):ze=lt,Q){case 1:var ie=-1;break;case 2:ie=250;break;case 5:ie=1073741823;break;case 4:ie=1e4;break;default:ie=5e3}return ie=ze+ie,Q={id:w++,callback:je,priorityLevel:Q,startTime:ze,expirationTime:ie,sortIndex:-1},ze>lt?(Q.sortIndex=ze,e(y,Q),n(g)===null&&Q===n(y)&&(U?(J(I),I=-1):U=!0,wt($e,ze-lt))):(Q.sortIndex=ie,e(g,Q),G||O||(G=!0,Ve||(Ve=!0,z()))),Q},s.unstable_shouldYield=P,s.unstable_wrapCallback=function(Q){var je=E;return function(){var ze=E;E=je;try{return Q.apply(this,arguments)}finally{E=ze}}}})(gp)),gp}var y1;function lj(){return y1||(y1=1,pp.exports=oj()),pp.exports}var yp={exports:{}},Ks={};var v1;function cj(){if(v1)return Ks;v1=1;var s=Eg();function e(g){var y="https://react.dev/errors/"+g;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var w=2;w<arguments.length;w++)y+="&args[]="+encodeURIComponent(arguments[w])}return"Minified React error #"+g+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(g,y,w){var k=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:k==null?null:""+k,children:g,containerInfo:y,implementation:w}}var h=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(g,y){if(g==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return Ks.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Ks.createPortal=function(g,y){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return u(g,y,null,w)},Ks.flushSync=function(g){var y=h.T,w=i.p;try{if(h.T=null,i.p=2,g)return g()}finally{h.T=y,i.p=w,i.d.f()}},Ks.preconnect=function(g,y){typeof g=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,i.d.C(g,y))},Ks.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},Ks.preinit=function(g,y){if(typeof g=="string"&&y&&typeof y.as=="string"){var w=y.as,k=p(w,y.crossOrigin),E=typeof y.integrity=="string"?y.integrity:void 0,O=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;w==="style"?i.d.S(g,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:k,integrity:E,fetchPriority:O}):w==="script"&&i.d.X(g,{crossOrigin:k,integrity:E,fetchPriority:O,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},Ks.preinitModule=function(g,y){if(typeof g=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var w=p(y.as,y.crossOrigin);i.d.M(g,{crossOrigin:w,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&i.d.M(g)},Ks.preload=function(g,y){if(typeof g=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var w=y.as,k=p(w,y.crossOrigin);i.d.L(g,w,{crossOrigin:k,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},Ks.preloadModule=function(g,y){if(typeof g=="string")if(y){var w=p(y.as,y.crossOrigin);i.d.m(g,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:w,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else i.d.m(g)},Ks.requestFormReset=function(g){i.d.r(g)},Ks.unstable_batchedUpdates=function(g,y){return g(y)},Ks.useFormState=function(g,y,w){return h.H.useFormState(g,y,w)},Ks.useFormStatus=function(){return h.H.useHostTransitionStatus()},Ks.version="19.2.4",Ks}var b1;function uj(){if(b1)return yp.exports;b1=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),yp.exports=cj(),yp.exports}var x1;function hj(){if(x1)return Bc;x1=1;var s=lj(),e=Eg(),n=uj();function i(t){var r="https://react.dev/errors/"+t;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+t+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function u(t){var r=t,o=t;if(t.alternate)for(;r.return;)r=r.return;else{t=r;do r=t,(r.flags&4098)!==0&&(o=r.return),t=r.return;while(t)}return r.tag===3?o:null}function h(t){if(t.tag===13){var r=t.memoizedState;if(r===null&&(t=t.alternate,t!==null&&(r=t.memoizedState)),r!==null)return r.dehydrated}return null}function p(t){if(t.tag===31){var r=t.memoizedState;if(r===null&&(t=t.alternate,t!==null&&(r=t.memoizedState)),r!==null)return r.dehydrated}return null}function g(t){if(u(t)!==t)throw Error(i(188))}function y(t){var r=t.alternate;if(!r){if(r=u(t),r===null)throw Error(i(188));return r!==t?null:t}for(var o=t,c=r;;){var f=o.return;if(f===null)break;var m=f.alternate;if(m===null){if(c=f.return,c!==null){o=c;continue}break}if(f.child===m.child){for(m=f.child;m;){if(m===o)return g(f),t;if(m===c)return g(f),r;m=m.sibling}throw Error(i(188))}if(o.return!==c.return)o=f,c=m;else{for(var b=!1,S=f.child;S;){if(S===o){b=!0,o=f,c=m;break}if(S===c){b=!0,c=f,o=m;break}S=S.sibling}if(!b){for(S=m.child;S;){if(S===o){b=!0,o=m,c=f;break}if(S===c){b=!0,c=m,o=f;break}S=S.sibling}if(!b)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?t:r}function w(t){var r=t.tag;if(r===5||r===26||r===27||r===6)return t;for(t=t.child;t!==null;){if(r=w(t),r!==null)return r;t=t.sibling}return null}var k=Object.assign,E=Symbol.for("react.element"),O=Symbol.for("react.transitional.element"),G=Symbol.for("react.portal"),U=Symbol.for("react.fragment"),V=Symbol.for("react.strict_mode"),ne=Symbol.for("react.profiler"),J=Symbol.for("react.consumer"),fe=Symbol.for("react.context"),Te=Symbol.for("react.forward_ref"),$e=Symbol.for("react.suspense"),Ve=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),j=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),P=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function z(t){return t===null||typeof t!="object"?null:(t=D&&t[D]||t["@@iterator"],typeof t=="function"?t:null)}var M=Symbol.for("react.client.reference");function We(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===M?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case U:return"Fragment";case ne:return"Profiler";case V:return"StrictMode";case $e:return"Suspense";case Ve:return"SuspenseList";case R:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case G:return"Portal";case fe:return t.displayName||"Context";case J:return(t._context.displayName||"Context")+".Consumer";case Te:var r=t.render;return t=t.displayName,t||(t=r.displayName||r.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case I:return r=t.displayName||null,r!==null?r:We(t.type)||"Memo";case j:r=t._payload,t=t._init;try{return We(t(r))}catch{}}return null}var wt=Array.isArray,Q=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,je=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ze={pending:!1,data:null,method:null,action:null},lt=[],ie=-1;function L(t){return{current:t}}function H(t){0>ie||(t.current=lt[ie],lt[ie]=null,ie--)}function ye(t,r){ie++,lt[ie]=t.current,t.current=r}var Se=L(null),qe=L(null),Ae=L(null),nt=L(null);function pt(t,r){switch(ye(Ae,r),ye(qe,t),ye(Se,null),r.nodeType){case 9:case 11:t=(t=r.documentElement)&&(t=t.namespaceURI)?P0(t):0;break;default:if(t=r.tagName,r=r.namespaceURI)r=P0(r),t=L0(r,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}H(Se),ye(Se,t)}function Je(){H(Se),H(qe),H(Ae)}function qt(t){t.memoizedState!==null&&ye(nt,t);var r=Se.current,o=L0(r,t.type);r!==o&&(ye(qe,t),ye(Se,o))}function cn(t){qe.current===t&&(H(Se),H(qe)),nt.current===t&&(H(nt),Dc._currentValue=ze)}var Nt,Ct;function oe(t){if(Nt===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);Nt=r&&r[1]||"",Ct=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Nt+t+Ct}var En=!1;function Ht(t,r){if(!t||En)return"";En=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var Re=function(){throw Error()};if(Object.defineProperty(Re.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Re,[])}catch(de){var le=de}Reflect.construct(t,[],Re)}else{try{Re.call()}catch(de){le=de}t.call(Re.prototype)}}else{try{throw Error()}catch(de){le=de}(Re=t())&&typeof Re.catch=="function"&&Re.catch(function(){})}}catch(de){if(de&&le&&typeof de.stack=="string")return[de.stack,le.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=c.DetermineComponentFrameRoot(),b=m[0],S=m[1];if(b&&S){var B=b.split(`
`),re=S.split(`
`);for(f=c=0;c<B.length&&!B[c].includes("DetermineComponentFrameRoot");)c++;for(;f<re.length&&!re[f].includes("DetermineComponentFrameRoot");)f++;if(c===B.length||f===re.length)for(c=B.length-1,f=re.length-1;1<=c&&0<=f&&B[c]!==re[f];)f--;for(;1<=c&&0<=f;c--,f--)if(B[c]!==re[f]){if(c!==1||f!==1)do if(c--,f--,0>f||B[c]!==re[f]){var xe=`
`+B[c].replace(" at new "," at ");return t.displayName&&xe.includes("<anonymous>")&&(xe=xe.replace("<anonymous>",t.displayName)),xe}while(1<=c&&0<=f);break}}}finally{En=!1,Error.prepareStackTrace=o}return(o=t?t.displayName||t.name:"")?oe(o):""}function St(t,r){switch(t.tag){case 26:case 27:case 5:return oe(t.type);case 16:return oe("Lazy");case 13:return t.child!==r&&r!==null?oe("Suspense Fallback"):oe("Suspense");case 19:return oe("SuspenseList");case 0:case 15:return Ht(t.type,!1);case 11:return Ht(t.type.render,!1);case 1:return Ht(t.type,!0);case 31:return oe("Activity");default:return""}}function Bt(t){try{var r="",o=null;do r+=St(t,o),o=t,t=t.return;while(t);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var ht=Object.prototype.hasOwnProperty,et=s.unstable_scheduleCallback,tn=s.unstable_cancelCallback,ss=s.unstable_shouldYield,Pt=s.unstable_requestPaint,Et=s.unstable_now,Ln=s.unstable_getCurrentPriorityLevel,zt=s.unstable_ImmediatePriority,Sn=s.unstable_UserBlockingPriority,Kt=s.unstable_NormalPriority,Nn=s.unstable_LowPriority,me=s.unstable_IdlePriority,Ee=s.log,Fe=s.unstable_setDisableYieldValue,Ye=null,Be=null;function Me(t){if(typeof Ee=="function"&&Fe(t),Be&&typeof Be.setStrictMode=="function")try{Be.setStrictMode(Ye,t)}catch{}}var Le=Math.clz32?Math.clz32:Y,xt=Math.log,mt=Math.LN2;function Y(t){return t>>>=0,t===0?32:31-(xt(t)/mt|0)|0}var Ne=256,Qe=262144,Xe=4194304;function dt(t){var r=t&42;if(r!==0)return r;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function Ft(t,r,o){var c=t.pendingLanes;if(c===0)return 0;var f=0,m=t.suspendedLanes,b=t.pingedLanes;t=t.warmLanes;var S=c&134217727;return S!==0?(c=S&~m,c!==0?f=dt(c):(b&=S,b!==0?f=dt(b):o||(o=S&~t,o!==0&&(f=dt(o))))):(S=c&~m,S!==0?f=dt(S):b!==0?f=dt(b):o||(o=c&~t,o!==0&&(f=dt(o)))),f===0?0:r!==0&&r!==f&&(r&m)===0&&(m=f&-f,o=r&-r,m>=o||m===32&&(o&4194048)!==0)?r:f}function Rt(t,r){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&r)===0}function nn(t,r){switch(t){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Vn(){var t=Xe;return Xe<<=1,(Xe&62914560)===0&&(Xe=4194304),t}function An(t){for(var r=[],o=0;31>o;o++)r.push(t);return r}function rn(t,r){t.pendingLanes|=r,r!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function yn(t,r,o,c,f,m){var b=t.pendingLanes;t.pendingLanes=o,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=o,t.entangledLanes&=o,t.errorRecoveryDisabledLanes&=o,t.shellSuspendCounter=0;var S=t.entanglements,B=t.expirationTimes,re=t.hiddenUpdates;for(o=b&~o;0<o;){var xe=31-Le(o),Re=1<<xe;S[xe]=0,B[xe]=-1;var le=re[xe];if(le!==null)for(re[xe]=null,xe=0;xe<le.length;xe++){var de=le[xe];de!==null&&(de.lane&=-536870913)}o&=~Re}c!==0&&In(t,c,0),m!==0&&f===0&&t.tag!==0&&(t.suspendedLanes|=m&~(b&~r))}function In(t,r,o){t.pendingLanes|=r,t.suspendedLanes&=~r;var c=31-Le(r);t.entangledLanes|=r,t.entanglements[c]=t.entanglements[c]|1073741824|o&261930}function un(t,r){var o=t.entangledLanes|=r;for(t=t.entanglements;o;){var c=31-Le(o),f=1<<c;f&r|t[c]&r&&(t[c]|=r),o&=~f}}function rs(t,r){var o=r&-r;return o=(o&42)!==0?1:q(o),(o&(t.suspendedLanes|r))!==0?0:o}function q(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function pe(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function we(){var t=je.p;return t!==0?t:(t=window.event,t===void 0?32:a1(t.type))}function ve(t,r){var o=je.p;try{return je.p=t,r()}finally{je.p=o}}var ge=Math.random().toString(36).slice(2),st="__reactFiber$"+ge,At="__reactProps$"+ge,ct="__reactContainer$"+ge,_t="__reactEvents$"+ge,vt="__reactListeners$"+ge,vn="__reactHandles$"+ge,er="__reactResources$"+ge,_s="__reactMarker$"+ge;function Ds(t){delete t[st],delete t[At],delete t[_t],delete t[vt],delete t[vn]}function Bn(t){var r=t[st];if(r)return r;for(var o=t.parentNode;o;){if(r=o[ct]||o[st]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(t=q0(t);t!==null;){if(o=t[st])return o;t=q0(t)}return r}t=o,o=t.parentNode}return null}function F(t){if(t=t[st]||t[ct]){var r=t.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return t}return null}function ce(t){var r=t.tag;if(r===5||r===26||r===27||r===6)return t.stateNode;throw Error(i(33))}function T(t){var r=t[er];return r||(r=t[er]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function C(t){t[_s]=!0}var K=new Set,te={};function He(t,r){Ue(t,r),Ue(t+"Capture",r)}function Ue(t,r){for(te[t]=r,t=0;t<r.length;t++)K.add(r[t])}var Oe=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ut={},kt={};function $(t){return ht.call(kt,t)?!0:ht.call(Ut,t)?!1:Oe.test(t)?kt[t]=!0:(Ut[t]=!0,!1)}function he(t,r,o){if($(r))if(o===null)t.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":t.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){t.removeAttribute(r);return}}t.setAttribute(r,""+o)}}function ae(t,r,o){if(o===null)t.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(r);return}t.setAttribute(r,""+o)}}function Ce(t,r,o,c){if(c===null)t.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(o);return}t.setAttributeNS(r,o,""+c)}}function Pe(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function rt(t){var r=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function It(t,r,o){var c=Object.getOwnPropertyDescriptor(t.constructor.prototype,r);if(!t.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var f=c.get,m=c.set;return Object.defineProperty(t,r,{configurable:!0,get:function(){return f.call(this)},set:function(b){o=""+b,m.call(this,b)}}),Object.defineProperty(t,r,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(b){o=""+b},stopTracking:function(){t._valueTracker=null,delete t[r]}}}}function ot(t){if(!t._valueTracker){var r=rt(t)?"checked":"value";t._valueTracker=It(t,r,""+t[r])}}function an(t){if(!t)return!1;var r=t._valueTracker;if(!r)return!0;var o=r.getValue(),c="";return t&&(c=rt(t)?t.checked?"true":"false":t.value),t=c,t!==o?(r.setValue(t),!0):!1}function Un(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var bn=/[\n"\\]/g;function xn(t){return t.replace(bn,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function xr(t,r,o,c,f,m,b,S){t.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?t.type=b:t.removeAttribute("type"),r!=null?b==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+Pe(r)):t.value!==""+Pe(r)&&(t.value=""+Pe(r)):b!=="submit"&&b!=="reset"||t.removeAttribute("value"),r!=null?Jr(t,b,Pe(r)):o!=null?Jr(t,b,Pe(o)):c!=null&&t.removeAttribute("value"),f==null&&m!=null&&(t.defaultChecked=!!m),f!=null&&(t.checked=f&&typeof f!="function"&&typeof f!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?t.name=""+Pe(S):t.removeAttribute("name")}function La(t,r,o,c,f,m,b,S){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(t.type=m),r!=null||o!=null){if(!(m!=="submit"&&m!=="reset"||r!=null)){ot(t);return}o=o!=null?""+Pe(o):"",r=r!=null?""+Pe(r):o,S||r===t.value||(t.value=r),t.defaultValue=r}c=c??f,c=typeof c!="function"&&typeof c!="symbol"&&!!c,t.checked=S?t.checked:!!c,t.defaultChecked=!!c,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(t.name=b),ot(t)}function Jr(t,r,o){r==="number"&&Un(t.ownerDocument)===t||t.defaultValue===""+o||(t.defaultValue=""+o)}function wr(t,r,o,c){if(t=t.options,r){r={};for(var f=0;f<o.length;f++)r["$"+o[f]]=!0;for(o=0;o<t.length;o++)f=r.hasOwnProperty("$"+t[o].value),t[o].selected!==f&&(t[o].selected=f),f&&c&&(t[o].defaultSelected=!0)}else{for(o=""+Pe(o),r=null,f=0;f<t.length;f++){if(t[f].value===o){t[f].selected=!0,c&&(t[f].defaultSelected=!0);return}r!==null||t[f].disabled||(r=t[f])}r!==null&&(r.selected=!0)}}function wn(t,r,o){if(r!=null&&(r=""+Pe(r),r!==t.value&&(t.value=r),o==null)){t.defaultValue!==r&&(t.defaultValue=r);return}t.defaultValue=o!=null?""+Pe(o):""}function Jn(t,r,o,c){if(r==null){if(c!=null){if(o!=null)throw Error(i(92));if(wt(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),r=o}o=Pe(r),t.defaultValue=o,c=t.textContent,c===o&&c!==""&&c!==null&&(t.value=c),ot(t)}function Kn(t,r){if(r){var o=t.firstChild;if(o&&o===t.lastChild&&o.nodeType===3){o.nodeValue=r;return}}t.textContent=r}var _r=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function cr(t,r,o){var c=r.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?t.setProperty(r,""):r==="float"?t.cssFloat="":t[r]="":c?t.setProperty(r,o):typeof o!="number"||o===0||_r.has(r)?r==="float"?t.cssFloat=o:t[r]=(""+o).trim():t[r]=o+"px"}function As(t,r,o){if(r!=null&&typeof r!="object")throw Error(i(62));if(t=t.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?t.setProperty(c,""):c==="float"?t.cssFloat="":t[c]="");for(var f in r)c=r[f],r.hasOwnProperty(f)&&o[f]!==c&&cr(t,f,c)}else for(var m in r)r.hasOwnProperty(m)&&cr(t,m,r[m])}function Ps(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Lr=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),kr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function pa(t){return kr.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function A(){}var Z=null;function De(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Ze=null,ft=null;function at(t){var r=F(t);if(r&&(t=r.stateNode)){var o=t[At]||null;e:switch(t=r.stateNode,r.type){case"input":if(xr(t,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),r=o.name,o.type==="radio"&&r!=null){for(o=t;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+xn(""+r)+'"][type="radio"]'),r=0;r<o.length;r++){var c=o[r];if(c!==t&&c.form===t.form){var f=c[At]||null;if(!f)throw Error(i(90));xr(c,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(r=0;r<o.length;r++)c=o[r],c.form===t.form&&an(c)}break e;case"textarea":wn(t,o.value,o.defaultValue);break e;case"select":r=o.value,r!=null&&wr(t,!!o.multiple,r,!1)}}}var gt=!1;function Lt(t,r,o){if(gt)return t(r,o);gt=!0;try{var c=t(r);return c}finally{if(gt=!1,(Ze!==null||ft!==null)&&(Nh(),Ze&&(r=Ze,t=ft,ft=Ze=null,at(r),t)))for(r=0;r<t.length;r++)at(t[r])}}function Dt(t,r){var o=t.stateNode;if(o===null)return null;var c=o[At]||null;if(c===null)return null;o=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(t=t.type,c=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!c;break e;default:t=!1}if(t)return null;if(o&&typeof o!="function")throw Error(i(231,r,typeof o));return o}var $t=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Jt=!1;if($t)try{var Wt={};Object.defineProperty(Wt,"passive",{get:function(){Jt=!0}}),window.addEventListener("test",Wt,Wt),window.removeEventListener("test",Wt,Wt)}catch{Jt=!1}var kn=null,Zn=null,as=null;function cs(){if(as)return as;var t,r=Zn,o=r.length,c,f="value"in kn?kn.value:kn.textContent,m=f.length;for(t=0;t<o&&r[t]===f[t];t++);var b=o-t;for(c=1;c<=b&&r[o-c]===f[m-c];c++);return as=f.slice(t,1<c?1-c:void 0)}function ks(t){var r=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&r===13&&(t=13)):t=r,t===10&&(t=13),32<=t||t===13?t:0}function ur(){return!0}function $s(){return!1}function es(t){function r(o,c,f,m,b){this._reactName=o,this._targetInst=f,this.type=c,this.nativeEvent=m,this.target=b,this.currentTarget=null;for(var S in t)t.hasOwnProperty(S)&&(o=t[S],this[S]=o?o(m):m[S]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?ur:$s,this.isPropagationStopped=$s,this}return k(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=ur)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=ur)},persist:function(){},isPersistent:ur}),r}var hr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},tr=es(hr),ys=k({},hr,{view:0,detail:0}),Ws=es(ys),Gs,Tr,jr,fi=k({},ys,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:mi,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==jr&&(jr&&t.type==="mousemove"?(Gs=t.screenX-jr.screenX,Tr=t.screenY-jr.screenY):Tr=Gs=0,jr=t),Gs)},movementY:function(t){return"movementY"in t?t.movementY:Tr}}),uo=es(fi),Or=k({},fi,{dataTransfer:0}),Zr=es(Or),ea=k({},ys,{relatedTarget:0}),ho=es(ea),tc=k({},hr,{animationName:0,elapsedTime:0,pseudoElement:0}),Vu=es(tc),Yo=k({},hr,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Bu=es(Yo),Uu=k({},hr,{data:0}),ga=es(Uu),zu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Fu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Hu(t){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(t):(t=qu[t])?!!r[t]:!1}function mi(){return Hu}var nr=k({},ys,{key:function(t){if(t.key){var r=zu[t.key]||t.key;if(r!=="Unidentified")return r}return t.type==="keypress"?(t=ks(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Fu[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:mi,charCode:function(t){return t.type==="keypress"?ks(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ks(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),$u=es(nr),Wu=k({},fi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Oa=es(Wu),d=k({},ys,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:mi}),v=es(d),_=k({},hr,{propertyName:0,elapsedTime:0,pseudoElement:0}),N=es(_),ee=k({},fi,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),ue=es(ee),Ge=k({},hr,{newState:0,oldState:0}),Zt=es(Ge),vs=[9,13,27,32],Mn=$t&&"CompositionEvent"in window,is=null;$t&&"documentMode"in document&&(is=document.documentMode);var Vr=$t&&"TextEvent"in window&&!is,ya=$t&&(!Mn||is&&8<is&&11>=is),ta=" ",na=!1;function fo(t,r){switch(t){case"keyup":return vs.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Qo(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Xo=!1;function Nk(t,r){switch(t){case"compositionend":return Qo(r);case"keypress":return r.which!==32?null:(na=!0,ta);case"textInput":return t=r.data,t===ta&&na?null:t;default:return null}}function Ck(t,r){if(Xo)return t==="compositionend"||!Mn&&fo(t,r)?(t=cs(),as=Zn=kn=null,Xo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return ya&&r.locale!=="ko"?null:r.data;default:return null}}var Rk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wy(t){var r=t&&t.nodeName&&t.nodeName.toLowerCase();return r==="input"?!!Rk[t.type]:r==="textarea"}function Gy(t,r,o,c){Ze?ft?ft.push(c):ft=[c]:Ze=c,r=Ph(r,"onChange"),0<r.length&&(o=new tr("onChange","change",null,o,c),t.push({event:o,listeners:r}))}var nc=null,sc=null;function Ak(t){C0(t,0)}function Gu(t){var r=ce(t);if(an(r))return t}function Ky(t,r){if(t==="change")return r}var Yy=!1;if($t){var bf;if($t){var xf="oninput"in document;if(!xf){var Qy=document.createElement("div");Qy.setAttribute("oninput","return;"),xf=typeof Qy.oninput=="function"}bf=xf}else bf=!1;Yy=bf&&(!document.documentMode||9<document.documentMode)}function Xy(){nc&&(nc.detachEvent("onpropertychange",Jy),sc=nc=null)}function Jy(t){if(t.propertyName==="value"&&Gu(sc)){var r=[];Gy(r,sc,t,De(t)),Lt(Ak,r)}}function Ik(t,r,o){t==="focusin"?(Xy(),nc=r,sc=o,nc.attachEvent("onpropertychange",Jy)):t==="focusout"&&Xy()}function Mk(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Gu(sc)}function Dk(t,r){if(t==="click")return Gu(r)}function Pk(t,r){if(t==="input"||t==="change")return Gu(r)}function Lk(t,r){return t===r&&(t!==0||1/t===1/r)||t!==t&&r!==r}var Er=typeof Object.is=="function"?Object.is:Lk;function rc(t,r){if(Er(t,r))return!0;if(typeof t!="object"||t===null||typeof r!="object"||r===null)return!1;var o=Object.keys(t),c=Object.keys(r);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var f=o[c];if(!ht.call(r,f)||!Er(t[f],r[f]))return!1}return!0}function Zy(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ev(t,r){var o=Zy(t);t=0;for(var c;o;){if(o.nodeType===3){if(c=t+o.textContent.length,t<=r&&c>=r)return{node:o,offset:r-t};t=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Zy(o)}}function tv(t,r){return t&&r?t===r?!0:t&&t.nodeType===3?!1:r&&r.nodeType===3?tv(t,r.parentNode):"contains"in t?t.contains(r):t.compareDocumentPosition?!!(t.compareDocumentPosition(r)&16):!1:!1}function nv(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var r=Un(t.document);r instanceof t.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)t=r.contentWindow;else break;r=Un(t.document)}return r}function wf(t){var r=t&&t.nodeName&&t.nodeName.toLowerCase();return r&&(r==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||r==="textarea"||t.contentEditable==="true")}var Ok=$t&&"documentMode"in document&&11>=document.documentMode,Jo=null,_f=null,ac=null,kf=!1;function sv(t,r,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;kf||Jo==null||Jo!==Un(c)||(c=Jo,"selectionStart"in c&&wf(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),ac&&rc(ac,c)||(ac=c,c=Ph(_f,"onSelect"),0<c.length&&(r=new tr("onSelect","select",null,r,o),t.push({event:r,listeners:c}),r.target=Jo)))}function mo(t,r){var o={};return o[t.toLowerCase()]=r.toLowerCase(),o["Webkit"+t]="webkit"+r,o["Moz"+t]="moz"+r,o}var Zo={animationend:mo("Animation","AnimationEnd"),animationiteration:mo("Animation","AnimationIteration"),animationstart:mo("Animation","AnimationStart"),transitionrun:mo("Transition","TransitionRun"),transitionstart:mo("Transition","TransitionStart"),transitioncancel:mo("Transition","TransitionCancel"),transitionend:mo("Transition","TransitionEnd")},Tf={},rv={};$t&&(rv=document.createElement("div").style,"AnimationEvent"in window||(delete Zo.animationend.animation,delete Zo.animationiteration.animation,delete Zo.animationstart.animation),"TransitionEvent"in window||delete Zo.transitionend.transition);function po(t){if(Tf[t])return Tf[t];if(!Zo[t])return t;var r=Zo[t],o;for(o in r)if(r.hasOwnProperty(o)&&o in rv)return Tf[t]=r[o];return t}var av=po("animationend"),iv=po("animationiteration"),ov=po("animationstart"),Vk=po("transitionrun"),Bk=po("transitionstart"),Uk=po("transitioncancel"),lv=po("transitionend"),cv=new Map,jf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");jf.push("scrollEnd");function sa(t,r){cv.set(t,r),He(r,[t])}var Ku=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},Br=[],el=0,Ef=0;function Yu(){for(var t=el,r=Ef=el=0;r<t;){var o=Br[r];Br[r++]=null;var c=Br[r];Br[r++]=null;var f=Br[r];Br[r++]=null;var m=Br[r];if(Br[r++]=null,c!==null&&f!==null){var b=c.pending;b===null?f.next=f:(f.next=b.next,b.next=f),c.pending=f}m!==0&&uv(o,f,m)}}function Qu(t,r,o,c){Br[el++]=t,Br[el++]=r,Br[el++]=o,Br[el++]=c,Ef|=c,t.lanes|=c,t=t.alternate,t!==null&&(t.lanes|=c)}function Sf(t,r,o,c){return Qu(t,r,o,c),Xu(t)}function go(t,r){return Qu(t,null,null,r),Xu(t)}function uv(t,r,o){t.lanes|=o;var c=t.alternate;c!==null&&(c.lanes|=o);for(var f=!1,m=t.return;m!==null;)m.childLanes|=o,c=m.alternate,c!==null&&(c.childLanes|=o),m.tag===22&&(t=m.stateNode,t===null||t._visibility&1||(f=!0)),t=m,m=m.return;return t.tag===3?(m=t.stateNode,f&&r!==null&&(f=31-Le(o),t=m.hiddenUpdates,c=t[f],c===null?t[f]=[r]:c.push(r),r.lane=o|536870912),m):null}function Xu(t){if(50<Sc)throw Sc=0,Lm=null,Error(i(185));for(var r=t.return;r!==null;)t=r,r=t.return;return t.tag===3?t.stateNode:null}var tl={};function zk(t,r,o,c){this.tag=t,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Sr(t,r,o,c){return new zk(t,r,o,c)}function Nf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Va(t,r){var o=t.alternate;return o===null?(o=Sr(t.tag,r,t.key,t.mode),o.elementType=t.elementType,o.type=t.type,o.stateNode=t.stateNode,o.alternate=t,t.alternate=o):(o.pendingProps=r,o.type=t.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=t.flags&65011712,o.childLanes=t.childLanes,o.lanes=t.lanes,o.child=t.child,o.memoizedProps=t.memoizedProps,o.memoizedState=t.memoizedState,o.updateQueue=t.updateQueue,r=t.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=t.sibling,o.index=t.index,o.ref=t.ref,o.refCleanup=t.refCleanup,o}function hv(t,r){t.flags&=65011714;var o=t.alternate;return o===null?(t.childLanes=0,t.lanes=r,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=o.childLanes,t.lanes=o.lanes,t.child=o.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=o.memoizedProps,t.memoizedState=o.memoizedState,t.updateQueue=o.updateQueue,t.type=o.type,r=o.dependencies,t.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),t}function Ju(t,r,o,c,f,m){var b=0;if(c=t,typeof t=="function")Nf(t)&&(b=1);else if(typeof t=="string")b=WT(t,o,Se.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case R:return t=Sr(31,o,r,f),t.elementType=R,t.lanes=m,t;case U:return yo(o.children,f,m,r);case V:b=8,f|=24;break;case ne:return t=Sr(12,o,r,f|2),t.elementType=ne,t.lanes=m,t;case $e:return t=Sr(13,o,r,f),t.elementType=$e,t.lanes=m,t;case Ve:return t=Sr(19,o,r,f),t.elementType=Ve,t.lanes=m,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case fe:b=10;break e;case J:b=9;break e;case Te:b=11;break e;case I:b=14;break e;case j:b=16,c=null;break e}b=29,o=Error(i(130,t===null?"null":typeof t,"")),c=null}return r=Sr(b,o,r,f),r.elementType=t,r.type=c,r.lanes=m,r}function yo(t,r,o,c){return t=Sr(7,t,c,r),t.lanes=o,t}function Cf(t,r,o){return t=Sr(6,t,null,r),t.lanes=o,t}function dv(t){var r=Sr(18,null,null,0);return r.stateNode=t,r}function Rf(t,r,o){return r=Sr(4,t.children!==null?t.children:[],t.key,r),r.lanes=o,r.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},r}var fv=new WeakMap;function Ur(t,r){if(typeof t=="object"&&t!==null){var o=fv.get(t);return o!==void 0?o:(r={value:t,source:r,stack:Bt(r)},fv.set(t,r),r)}return{value:t,source:r,stack:Bt(r)}}var nl=[],sl=0,Zu=null,ic=0,zr=[],Fr=0,pi=null,va=1,ba="";function Ba(t,r){nl[sl++]=ic,nl[sl++]=Zu,Zu=t,ic=r}function mv(t,r,o){zr[Fr++]=va,zr[Fr++]=ba,zr[Fr++]=pi,pi=t;var c=va;t=ba;var f=32-Le(c)-1;c&=~(1<<f),o+=1;var m=32-Le(r)+f;if(30<m){var b=f-f%5;m=(c&(1<<b)-1).toString(32),c>>=b,f-=b,va=1<<32-Le(r)+f|o<<f|c,ba=m+t}else va=1<<m|o<<f|c,ba=t}function Af(t){t.return!==null&&(Ba(t,1),mv(t,1,0))}function If(t){for(;t===Zu;)Zu=nl[--sl],nl[sl]=null,ic=nl[--sl],nl[sl]=null;for(;t===pi;)pi=zr[--Fr],zr[Fr]=null,ba=zr[--Fr],zr[Fr]=null,va=zr[--Fr],zr[Fr]=null}function pv(t,r){zr[Fr++]=va,zr[Fr++]=ba,zr[Fr++]=pi,va=r.id,ba=r.overflow,pi=t}var Vs=null,ts=null,_n=!1,gi=null,qr=!1,Mf=Error(i(519));function yi(t){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw oc(Ur(r,t)),Mf}function gv(t){var r=t.stateNode,o=t.type,c=t.memoizedProps;switch(r[st]=t,r[At]=c,o){case"dialog":ln("cancel",r),ln("close",r);break;case"iframe":case"object":case"embed":ln("load",r);break;case"video":case"audio":for(o=0;o<Cc.length;o++)ln(Cc[o],r);break;case"source":ln("error",r);break;case"img":case"image":case"link":ln("error",r),ln("load",r);break;case"details":ln("toggle",r);break;case"input":ln("invalid",r),La(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":ln("invalid",r);break;case"textarea":ln("invalid",r),Jn(r,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||r.textContent===""+o||c.suppressHydrationWarning===!0||M0(r.textContent,o)?(c.popover!=null&&(ln("beforetoggle",r),ln("toggle",r)),c.onScroll!=null&&ln("scroll",r),c.onScrollEnd!=null&&ln("scrollend",r),c.onClick!=null&&(r.onclick=A),r=!0):r=!1,r||yi(t,!0)}function yv(t){for(Vs=t.return;Vs;)switch(Vs.tag){case 5:case 31:case 13:qr=!1;return;case 27:case 3:qr=!0;return;default:Vs=Vs.return}}function rl(t){if(t!==Vs)return!1;if(!_n)return yv(t),_n=!0,!1;var r=t.tag,o;if((o=r!==3&&r!==27)&&((o=r===5)&&(o=t.type,o=!(o!=="form"&&o!=="button")||Xm(t.type,t.memoizedProps)),o=!o),o&&ts&&yi(t),yv(t),r===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(i(317));ts=F0(t)}else if(r===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(i(317));ts=F0(t)}else r===27?(r=ts,Ai(t.type)?(t=np,np=null,ts=t):ts=r):ts=Vs?$r(t.stateNode.nextSibling):null;return!0}function vo(){ts=Vs=null,_n=!1}function Df(){var t=gi;return t!==null&&(pr===null?pr=t:pr.push.apply(pr,t),gi=null),t}function oc(t){gi===null?gi=[t]:gi.push(t)}var Pf=L(null),bo=null,Ua=null;function vi(t,r,o){ye(Pf,r._currentValue),r._currentValue=o}function za(t){t._currentValue=Pf.current,H(Pf)}function Lf(t,r,o){for(;t!==null;){var c=t.alternate;if((t.childLanes&r)!==r?(t.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),t===o)break;t=t.return}}function Of(t,r,o,c){var f=t.child;for(f!==null&&(f.return=t);f!==null;){var m=f.dependencies;if(m!==null){var b=f.child;m=m.firstContext;e:for(;m!==null;){var S=m;m=f;for(var B=0;B<r.length;B++)if(S.context===r[B]){m.lanes|=o,S=m.alternate,S!==null&&(S.lanes|=o),Lf(m.return,o,t),c||(b=null);break e}m=S.next}}else if(f.tag===18){if(b=f.return,b===null)throw Error(i(341));b.lanes|=o,m=b.alternate,m!==null&&(m.lanes|=o),Lf(b,o,t),b=null}else b=f.child;if(b!==null)b.return=f;else for(b=f;b!==null;){if(b===t){b=null;break}if(f=b.sibling,f!==null){f.return=b.return,b=f;break}b=b.return}f=b}}function al(t,r,o,c){t=null;for(var f=r,m=!1;f!==null;){if(!m){if((f.flags&524288)!==0)m=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var b=f.alternate;if(b===null)throw Error(i(387));if(b=b.memoizedProps,b!==null){var S=f.type;Er(f.pendingProps.value,b.value)||(t!==null?t.push(S):t=[S])}}else if(f===nt.current){if(b=f.alternate,b===null)throw Error(i(387));b.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(t!==null?t.push(Dc):t=[Dc])}f=f.return}t!==null&&Of(r,t,o,c),r.flags|=262144}function eh(t){for(t=t.firstContext;t!==null;){if(!Er(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function xo(t){bo=t,Ua=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function Bs(t){return vv(bo,t)}function th(t,r){return bo===null&&xo(t),vv(t,r)}function vv(t,r){var o=r._currentValue;if(r={context:r,memoizedValue:o,next:null},Ua===null){if(t===null)throw Error(i(308));Ua=r,t.dependencies={lanes:0,firstContext:r},t.flags|=524288}else Ua=Ua.next=r;return o}var Fk=typeof AbortController<"u"?AbortController:function(){var t=[],r=this.signal={aborted:!1,addEventListener:function(o,c){t.push(c)}};this.abort=function(){r.aborted=!0,t.forEach(function(o){return o()})}},qk=s.unstable_scheduleCallback,Hk=s.unstable_NormalPriority,Ts={$$typeof:fe,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Vf(){return{controller:new Fk,data:new Map,refCount:0}}function lc(t){t.refCount--,t.refCount===0&&qk(Hk,function(){t.controller.abort()})}var cc=null,Bf=0,il=0,ol=null;function $k(t,r){if(cc===null){var o=cc=[];Bf=0,il=Fm(),ol={status:"pending",value:void 0,then:function(c){o.push(c)}}}return Bf++,r.then(bv,bv),r}function bv(){if(--Bf===0&&cc!==null){ol!==null&&(ol.status="fulfilled");var t=cc;cc=null,il=0,ol=null;for(var r=0;r<t.length;r++)(0,t[r])()}}function Wk(t,r){var o=[],c={status:"pending",value:null,reason:null,then:function(f){o.push(f)}};return t.then(function(){c.status="fulfilled",c.value=r;for(var f=0;f<o.length;f++)(0,o[f])(r)},function(f){for(c.status="rejected",c.reason=f,f=0;f<o.length;f++)(0,o[f])(void 0)}),c}var xv=Q.S;Q.S=function(t,r){s0=Et(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&$k(t,r),xv!==null&&xv(t,r)};var wo=L(null);function Uf(){var t=wo.current;return t!==null?t:Yn.pooledCache}function nh(t,r){r===null?ye(wo,wo.current):ye(wo,r.pool)}function wv(){var t=Uf();return t===null?null:{parent:Ts._currentValue,pool:t}}var ll=Error(i(460)),zf=Error(i(474)),sh=Error(i(542)),rh={then:function(){}};function _v(t){return t=t.status,t==="fulfilled"||t==="rejected"}function kv(t,r,o){switch(o=t[o],o===void 0?t.push(r):o!==r&&(r.then(A,A),r=o),r.status){case"fulfilled":return r.value;case"rejected":throw t=r.reason,jv(t),t;default:if(typeof r.status=="string")r.then(A,A);else{if(t=Yn,t!==null&&100<t.shellSuspendCounter)throw Error(i(482));t=r,t.status="pending",t.then(function(c){if(r.status==="pending"){var f=r;f.status="fulfilled",f.value=c}},function(c){if(r.status==="pending"){var f=r;f.status="rejected",f.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw t=r.reason,jv(t),t}throw ko=r,ll}}function _o(t){try{var r=t._init;return r(t._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(ko=o,ll):o}}var ko=null;function Tv(){if(ko===null)throw Error(i(459));var t=ko;return ko=null,t}function jv(t){if(t===ll||t===sh)throw Error(i(483))}var cl=null,uc=0;function ah(t){var r=uc;return uc+=1,cl===null&&(cl=[]),kv(cl,t,r)}function hc(t,r){r=r.props.ref,t.ref=r!==void 0?r:null}function ih(t,r){throw r.$$typeof===E?Error(i(525)):(t=Object.prototype.toString.call(r),Error(i(31,t==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":t)))}function Ev(t){function r(X,W){if(t){var se=X.deletions;se===null?(X.deletions=[W],X.flags|=16):se.push(W)}}function o(X,W){if(!t)return null;for(;W!==null;)r(X,W),W=W.sibling;return null}function c(X){for(var W=new Map;X!==null;)X.key!==null?W.set(X.key,X):W.set(X.index,X),X=X.sibling;return W}function f(X,W){return X=Va(X,W),X.index=0,X.sibling=null,X}function m(X,W,se){return X.index=se,t?(se=X.alternate,se!==null?(se=se.index,se<W?(X.flags|=67108866,W):se):(X.flags|=67108866,W)):(X.flags|=1048576,W)}function b(X){return t&&X.alternate===null&&(X.flags|=67108866),X}function S(X,W,se,ke){return W===null||W.tag!==6?(W=Cf(se,X.mode,ke),W.return=X,W):(W=f(W,se),W.return=X,W)}function B(X,W,se,ke){var Tt=se.type;return Tt===U?xe(X,W,se.props.children,ke,se.key):W!==null&&(W.elementType===Tt||typeof Tt=="object"&&Tt!==null&&Tt.$$typeof===j&&_o(Tt)===W.type)?(W=f(W,se.props),hc(W,se),W.return=X,W):(W=Ju(se.type,se.key,se.props,null,X.mode,ke),hc(W,se),W.return=X,W)}function re(X,W,se,ke){return W===null||W.tag!==4||W.stateNode.containerInfo!==se.containerInfo||W.stateNode.implementation!==se.implementation?(W=Rf(se,X.mode,ke),W.return=X,W):(W=f(W,se.children||[]),W.return=X,W)}function xe(X,W,se,ke,Tt){return W===null||W.tag!==7?(W=yo(se,X.mode,ke,Tt),W.return=X,W):(W=f(W,se),W.return=X,W)}function Re(X,W,se){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return W=Cf(""+W,X.mode,se),W.return=X,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case O:return se=Ju(W.type,W.key,W.props,null,X.mode,se),hc(se,W),se.return=X,se;case G:return W=Rf(W,X.mode,se),W.return=X,W;case j:return W=_o(W),Re(X,W,se)}if(wt(W)||z(W))return W=yo(W,X.mode,se,null),W.return=X,W;if(typeof W.then=="function")return Re(X,ah(W),se);if(W.$$typeof===fe)return Re(X,th(X,W),se);ih(X,W)}return null}function le(X,W,se,ke){var Tt=W!==null?W.key:null;if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return Tt!==null?null:S(X,W,""+se,ke);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case O:return se.key===Tt?B(X,W,se,ke):null;case G:return se.key===Tt?re(X,W,se,ke):null;case j:return se=_o(se),le(X,W,se,ke)}if(wt(se)||z(se))return Tt!==null?null:xe(X,W,se,ke,null);if(typeof se.then=="function")return le(X,W,ah(se),ke);if(se.$$typeof===fe)return le(X,W,th(X,se),ke);ih(X,se)}return null}function de(X,W,se,ke,Tt){if(typeof ke=="string"&&ke!==""||typeof ke=="number"||typeof ke=="bigint")return X=X.get(se)||null,S(W,X,""+ke,Tt);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case O:return X=X.get(ke.key===null?se:ke.key)||null,B(W,X,ke,Tt);case G:return X=X.get(ke.key===null?se:ke.key)||null,re(W,X,ke,Tt);case j:return ke=_o(ke),de(X,W,se,ke,Tt)}if(wt(ke)||z(ke))return X=X.get(se)||null,xe(W,X,ke,Tt,null);if(typeof ke.then=="function")return de(X,W,se,ah(ke),Tt);if(ke.$$typeof===fe)return de(X,W,se,th(W,ke),Tt);ih(W,ke)}return null}function ut(X,W,se,ke){for(var Tt=null,Cn=null,yt=W,sn=W=0,dn=null;yt!==null&&sn<se.length;sn++){yt.index>sn?(dn=yt,yt=null):dn=yt.sibling;var Rn=le(X,yt,se[sn],ke);if(Rn===null){yt===null&&(yt=dn);break}t&&yt&&Rn.alternate===null&&r(X,yt),W=m(Rn,W,sn),Cn===null?Tt=Rn:Cn.sibling=Rn,Cn=Rn,yt=dn}if(sn===se.length)return o(X,yt),_n&&Ba(X,sn),Tt;if(yt===null){for(;sn<se.length;sn++)yt=Re(X,se[sn],ke),yt!==null&&(W=m(yt,W,sn),Cn===null?Tt=yt:Cn.sibling=yt,Cn=yt);return _n&&Ba(X,sn),Tt}for(yt=c(yt);sn<se.length;sn++)dn=de(yt,X,sn,se[sn],ke),dn!==null&&(t&&dn.alternate!==null&&yt.delete(dn.key===null?sn:dn.key),W=m(dn,W,sn),Cn===null?Tt=dn:Cn.sibling=dn,Cn=dn);return t&&yt.forEach(function(Li){return r(X,Li)}),_n&&Ba(X,sn),Tt}function Mt(X,W,se,ke){if(se==null)throw Error(i(151));for(var Tt=null,Cn=null,yt=W,sn=W=0,dn=null,Rn=se.next();yt!==null&&!Rn.done;sn++,Rn=se.next()){yt.index>sn?(dn=yt,yt=null):dn=yt.sibling;var Li=le(X,yt,Rn.value,ke);if(Li===null){yt===null&&(yt=dn);break}t&&yt&&Li.alternate===null&&r(X,yt),W=m(Li,W,sn),Cn===null?Tt=Li:Cn.sibling=Li,Cn=Li,yt=dn}if(Rn.done)return o(X,yt),_n&&Ba(X,sn),Tt;if(yt===null){for(;!Rn.done;sn++,Rn=se.next())Rn=Re(X,Rn.value,ke),Rn!==null&&(W=m(Rn,W,sn),Cn===null?Tt=Rn:Cn.sibling=Rn,Cn=Rn);return _n&&Ba(X,sn),Tt}for(yt=c(yt);!Rn.done;sn++,Rn=se.next())Rn=de(yt,X,sn,Rn.value,ke),Rn!==null&&(t&&Rn.alternate!==null&&yt.delete(Rn.key===null?sn:Rn.key),W=m(Rn,W,sn),Cn===null?Tt=Rn:Cn.sibling=Rn,Cn=Rn);return t&&yt.forEach(function(sj){return r(X,sj)}),_n&&Ba(X,sn),Tt}function Wn(X,W,se,ke){if(typeof se=="object"&&se!==null&&se.type===U&&se.key===null&&(se=se.props.children),typeof se=="object"&&se!==null){switch(se.$$typeof){case O:e:{for(var Tt=se.key;W!==null;){if(W.key===Tt){if(Tt=se.type,Tt===U){if(W.tag===7){o(X,W.sibling),ke=f(W,se.props.children),ke.return=X,X=ke;break e}}else if(W.elementType===Tt||typeof Tt=="object"&&Tt!==null&&Tt.$$typeof===j&&_o(Tt)===W.type){o(X,W.sibling),ke=f(W,se.props),hc(ke,se),ke.return=X,X=ke;break e}o(X,W);break}else r(X,W);W=W.sibling}se.type===U?(ke=yo(se.props.children,X.mode,ke,se.key),ke.return=X,X=ke):(ke=Ju(se.type,se.key,se.props,null,X.mode,ke),hc(ke,se),ke.return=X,X=ke)}return b(X);case G:e:{for(Tt=se.key;W!==null;){if(W.key===Tt)if(W.tag===4&&W.stateNode.containerInfo===se.containerInfo&&W.stateNode.implementation===se.implementation){o(X,W.sibling),ke=f(W,se.children||[]),ke.return=X,X=ke;break e}else{o(X,W);break}else r(X,W);W=W.sibling}ke=Rf(se,X.mode,ke),ke.return=X,X=ke}return b(X);case j:return se=_o(se),Wn(X,W,se,ke)}if(wt(se))return ut(X,W,se,ke);if(z(se)){if(Tt=z(se),typeof Tt!="function")throw Error(i(150));return se=Tt.call(se),Mt(X,W,se,ke)}if(typeof se.then=="function")return Wn(X,W,ah(se),ke);if(se.$$typeof===fe)return Wn(X,W,th(X,se),ke);ih(X,se)}return typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint"?(se=""+se,W!==null&&W.tag===6?(o(X,W.sibling),ke=f(W,se),ke.return=X,X=ke):(o(X,W),ke=Cf(se,X.mode,ke),ke.return=X,X=ke),b(X)):o(X,W)}return function(X,W,se,ke){try{uc=0;var Tt=Wn(X,W,se,ke);return cl=null,Tt}catch(yt){if(yt===ll||yt===sh)throw yt;var Cn=Sr(29,yt,null,X.mode);return Cn.lanes=ke,Cn.return=X,Cn}}}var To=Ev(!0),Sv=Ev(!1),bi=!1;function Ff(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function qf(t,r){t=t.updateQueue,r.updateQueue===t&&(r.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function xi(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function wi(t,r,o){var c=t.updateQueue;if(c===null)return null;if(c=c.shared,(Dn&2)!==0){var f=c.pending;return f===null?r.next=r:(r.next=f.next,f.next=r),c.pending=r,r=Xu(t),uv(t,null,o),r}return Qu(t,c,r,o),Xu(t)}function dc(t,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194048)!==0)){var c=r.lanes;c&=t.pendingLanes,o|=c,r.lanes=o,un(t,o)}}function Hf(t,r){var o=t.updateQueue,c=t.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var f=null,m=null;if(o=o.firstBaseUpdate,o!==null){do{var b={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};m===null?f=m=b:m=m.next=b,o=o.next}while(o!==null);m===null?f=m=r:m=m.next=r}else f=m=r;o={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:m,shared:c.shared,callbacks:c.callbacks},t.updateQueue=o;return}t=o.lastBaseUpdate,t===null?o.firstBaseUpdate=r:t.next=r,o.lastBaseUpdate=r}var $f=!1;function fc(){if($f){var t=ol;if(t!==null)throw t}}function mc(t,r,o,c){$f=!1;var f=t.updateQueue;bi=!1;var m=f.firstBaseUpdate,b=f.lastBaseUpdate,S=f.shared.pending;if(S!==null){f.shared.pending=null;var B=S,re=B.next;B.next=null,b===null?m=re:b.next=re,b=B;var xe=t.alternate;xe!==null&&(xe=xe.updateQueue,S=xe.lastBaseUpdate,S!==b&&(S===null?xe.firstBaseUpdate=re:S.next=re,xe.lastBaseUpdate=B))}if(m!==null){var Re=f.baseState;b=0,xe=re=B=null,S=m;do{var le=S.lane&-536870913,de=le!==S.lane;if(de?(hn&le)===le:(c&le)===le){le!==0&&le===il&&($f=!0),xe!==null&&(xe=xe.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var ut=t,Mt=S;le=r;var Wn=o;switch(Mt.tag){case 1:if(ut=Mt.payload,typeof ut=="function"){Re=ut.call(Wn,Re,le);break e}Re=ut;break e;case 3:ut.flags=ut.flags&-65537|128;case 0:if(ut=Mt.payload,le=typeof ut=="function"?ut.call(Wn,Re,le):ut,le==null)break e;Re=k({},Re,le);break e;case 2:bi=!0}}le=S.callback,le!==null&&(t.flags|=64,de&&(t.flags|=8192),de=f.callbacks,de===null?f.callbacks=[le]:de.push(le))}else de={lane:le,tag:S.tag,payload:S.payload,callback:S.callback,next:null},xe===null?(re=xe=de,B=Re):xe=xe.next=de,b|=le;if(S=S.next,S===null){if(S=f.shared.pending,S===null)break;de=S,S=de.next,de.next=null,f.lastBaseUpdate=de,f.shared.pending=null}}while(!0);xe===null&&(B=Re),f.baseState=B,f.firstBaseUpdate=re,f.lastBaseUpdate=xe,m===null&&(f.shared.lanes=0),Ei|=b,t.lanes=b,t.memoizedState=Re}}function Nv(t,r){if(typeof t!="function")throw Error(i(191,t));t.call(r)}function Cv(t,r){var o=t.callbacks;if(o!==null)for(t.callbacks=null,t=0;t<o.length;t++)Nv(o[t],r)}var ul=L(null),oh=L(0);function Rv(t,r){t=Qa,ye(oh,t),ye(ul,r),Qa=t|r.baseLanes}function Wf(){ye(oh,Qa),ye(ul,ul.current)}function Gf(){Qa=oh.current,H(ul),H(oh)}var Nr=L(null),Hr=null;function _i(t){var r=t.alternate;ye(bs,bs.current&1),ye(Nr,t),Hr===null&&(r===null||ul.current!==null||r.memoizedState!==null)&&(Hr=t)}function Kf(t){ye(bs,bs.current),ye(Nr,t),Hr===null&&(Hr=t)}function Av(t){t.tag===22?(ye(bs,bs.current),ye(Nr,t),Hr===null&&(Hr=t)):ki()}function ki(){ye(bs,bs.current),ye(Nr,Nr.current)}function Cr(t){H(Nr),Hr===t&&(Hr=null),H(bs)}var bs=L(0);function lh(t){for(var r=t;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||ep(o)||tp(o)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Fa=0,en=null,Hn=null,js=null,ch=!1,hl=!1,jo=!1,uh=0,pc=0,dl=null,Gk=0;function ds(){throw Error(i(321))}function Yf(t,r){if(r===null)return!1;for(var o=0;o<r.length&&o<t.length;o++)if(!Er(t[o],r[o]))return!1;return!0}function Qf(t,r,o,c,f,m){return Fa=m,en=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,Q.H=t===null||t.memoizedState===null?mb:hm,jo=!1,m=o(c,f),jo=!1,hl&&(m=Mv(r,o,c,f)),Iv(t),m}function Iv(t){Q.H=vc;var r=Hn!==null&&Hn.next!==null;if(Fa=0,js=Hn=en=null,ch=!1,pc=0,dl=null,r)throw Error(i(300));t===null||Es||(t=t.dependencies,t!==null&&eh(t)&&(Es=!0))}function Mv(t,r,o,c){en=t;var f=0;do{if(hl&&(dl=null),pc=0,hl=!1,25<=f)throw Error(i(301));if(f+=1,js=Hn=null,t.updateQueue!=null){var m=t.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}Q.H=pb,m=r(o,c)}while(hl);return m}function Kk(){var t=Q.H,r=t.useState()[0];return r=typeof r.then=="function"?gc(r):r,t=t.useState()[0],(Hn!==null?Hn.memoizedState:null)!==t&&(en.flags|=1024),r}function Xf(){var t=uh!==0;return uh=0,t}function Jf(t,r,o){r.updateQueue=t.updateQueue,r.flags&=-2053,t.lanes&=~o}function Zf(t){if(ch){for(t=t.memoizedState;t!==null;){var r=t.queue;r!==null&&(r.pending=null),t=t.next}ch=!1}Fa=0,js=Hn=en=null,hl=!1,pc=uh=0,dl=null}function sr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return js===null?en.memoizedState=js=t:js=js.next=t,js}function xs(){if(Hn===null){var t=en.alternate;t=t!==null?t.memoizedState:null}else t=Hn.next;var r=js===null?en.memoizedState:js.next;if(r!==null)js=r,Hn=t;else{if(t===null)throw en.alternate===null?Error(i(467)):Error(i(310));Hn=t,t={memoizedState:Hn.memoizedState,baseState:Hn.baseState,baseQueue:Hn.baseQueue,queue:Hn.queue,next:null},js===null?en.memoizedState=js=t:js=js.next=t}return js}function hh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function gc(t){var r=pc;return pc+=1,dl===null&&(dl=[]),t=kv(dl,t,r),r=en,(js===null?r.memoizedState:js.next)===null&&(r=r.alternate,Q.H=r===null||r.memoizedState===null?mb:hm),t}function dh(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return gc(t);if(t.$$typeof===fe)return Bs(t)}throw Error(i(438,String(t)))}function em(t){var r=null,o=en.updateQueue;if(o!==null&&(r=o.memoCache),r==null){var c=en.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(f){return f.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),o===null&&(o=hh(),en.updateQueue=o),o.memoCache=r,o=r.data[r.index],o===void 0)for(o=r.data[r.index]=Array(t),c=0;c<t;c++)o[c]=P;return r.index++,o}function qa(t,r){return typeof r=="function"?r(t):r}function fh(t){var r=xs();return tm(r,Hn,t)}function tm(t,r,o){var c=t.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var f=t.baseQueue,m=c.pending;if(m!==null){if(f!==null){var b=f.next;f.next=m.next,m.next=b}r.baseQueue=f=m,c.pending=null}if(m=t.baseState,f===null)t.memoizedState=m;else{r=f.next;var S=b=null,B=null,re=r,xe=!1;do{var Re=re.lane&-536870913;if(Re!==re.lane?(hn&Re)===Re:(Fa&Re)===Re){var le=re.revertLane;if(le===0)B!==null&&(B=B.next={lane:0,revertLane:0,gesture:null,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null}),Re===il&&(xe=!0);else if((Fa&le)===le){re=re.next,le===il&&(xe=!0);continue}else Re={lane:0,revertLane:re.revertLane,gesture:null,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null},B===null?(S=B=Re,b=m):B=B.next=Re,en.lanes|=le,Ei|=le;Re=re.action,jo&&o(m,Re),m=re.hasEagerState?re.eagerState:o(m,Re)}else le={lane:Re,revertLane:re.revertLane,gesture:re.gesture,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null},B===null?(S=B=le,b=m):B=B.next=le,en.lanes|=Re,Ei|=Re;re=re.next}while(re!==null&&re!==r);if(B===null?b=m:B.next=S,!Er(m,t.memoizedState)&&(Es=!0,xe&&(o=ol,o!==null)))throw o;t.memoizedState=m,t.baseState=b,t.baseQueue=B,c.lastRenderedState=m}return f===null&&(c.lanes=0),[t.memoizedState,c.dispatch]}function nm(t){var r=xs(),o=r.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=t;var c=o.dispatch,f=o.pending,m=r.memoizedState;if(f!==null){o.pending=null;var b=f=f.next;do m=t(m,b.action),b=b.next;while(b!==f);Er(m,r.memoizedState)||(Es=!0),r.memoizedState=m,r.baseQueue===null&&(r.baseState=m),o.lastRenderedState=m}return[m,c]}function Dv(t,r,o){var c=en,f=xs(),m=_n;if(m){if(o===void 0)throw Error(i(407));o=o()}else o=r();var b=!Er((Hn||f).memoizedState,o);if(b&&(f.memoizedState=o,Es=!0),f=f.queue,am(Ov.bind(null,c,f,t),[t]),f.getSnapshot!==r||b||js!==null&&js.memoizedState.tag&1){if(c.flags|=2048,fl(9,{destroy:void 0},Lv.bind(null,c,f,o,r),null),Yn===null)throw Error(i(349));m||(Fa&127)!==0||Pv(c,r,o)}return o}function Pv(t,r,o){t.flags|=16384,t={getSnapshot:r,value:o},r=en.updateQueue,r===null?(r=hh(),en.updateQueue=r,r.stores=[t]):(o=r.stores,o===null?r.stores=[t]:o.push(t))}function Lv(t,r,o,c){r.value=o,r.getSnapshot=c,Vv(r)&&Bv(t)}function Ov(t,r,o){return o(function(){Vv(r)&&Bv(t)})}function Vv(t){var r=t.getSnapshot;t=t.value;try{var o=r();return!Er(t,o)}catch{return!0}}function Bv(t){var r=go(t,2);r!==null&&gr(r,t,2)}function sm(t){var r=sr();if(typeof t=="function"){var o=t;if(t=o(),jo){Me(!0);try{o()}finally{Me(!1)}}}return r.memoizedState=r.baseState=t,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qa,lastRenderedState:t},r}function Uv(t,r,o,c){return t.baseState=o,tm(t,Hn,typeof c=="function"?c:qa)}function Yk(t,r,o,c,f){if(gh(t))throw Error(i(485));if(t=r.action,t!==null){var m={payload:f,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){m.listeners.push(b)}};Q.T!==null?o(!0):m.isTransition=!1,c(m),o=r.pending,o===null?(m.next=r.pending=m,zv(r,m)):(m.next=o.next,r.pending=o.next=m)}}function zv(t,r){var o=r.action,c=r.payload,f=t.state;if(r.isTransition){var m=Q.T,b={};Q.T=b;try{var S=o(f,c),B=Q.S;B!==null&&B(b,S),Fv(t,r,S)}catch(re){rm(t,r,re)}finally{m!==null&&b.types!==null&&(m.types=b.types),Q.T=m}}else try{m=o(f,c),Fv(t,r,m)}catch(re){rm(t,r,re)}}function Fv(t,r,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){qv(t,r,c)},function(c){return rm(t,r,c)}):qv(t,r,o)}function qv(t,r,o){r.status="fulfilled",r.value=o,Hv(r),t.state=o,r=t.pending,r!==null&&(o=r.next,o===r?t.pending=null:(o=o.next,r.next=o,zv(t,o)))}function rm(t,r,o){var c=t.pending;if(t.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=o,Hv(r),r=r.next;while(r!==c)}t.action=null}function Hv(t){t=t.listeners;for(var r=0;r<t.length;r++)(0,t[r])()}function $v(t,r){return r}function Wv(t,r){if(_n){var o=Yn.formState;if(o!==null){e:{var c=en;if(_n){if(ts){t:{for(var f=ts,m=qr;f.nodeType!==8;){if(!m){f=null;break t}if(f=$r(f.nextSibling),f===null){f=null;break t}}m=f.data,f=m==="F!"||m==="F"?f:null}if(f){ts=$r(f.nextSibling),c=f.data==="F!";break e}}yi(c)}c=!1}c&&(r=o[0])}}return o=sr(),o.memoizedState=o.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:$v,lastRenderedState:r},o.queue=c,o=hb.bind(null,en,c),c.dispatch=o,c=sm(!1),m=um.bind(null,en,!1,c.queue),c=sr(),f={state:r,dispatch:null,action:t,pending:null},c.queue=f,o=Yk.bind(null,en,f,m,o),f.dispatch=o,c.memoizedState=t,[r,o,!1]}function Gv(t){var r=xs();return Kv(r,Hn,t)}function Kv(t,r,o){if(r=tm(t,r,$v)[0],t=fh(qa)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=gc(r)}catch(b){throw b===ll?sh:b}else c=r;r=xs();var f=r.queue,m=f.dispatch;return o!==r.memoizedState&&(en.flags|=2048,fl(9,{destroy:void 0},Qk.bind(null,f,o),null)),[c,m,t]}function Qk(t,r){t.action=r}function Yv(t){var r=xs(),o=Hn;if(o!==null)return Kv(r,o,t);xs(),r=r.memoizedState,o=xs();var c=o.queue.dispatch;return o.memoizedState=t,[r,c,!1]}function fl(t,r,o,c){return t={tag:t,create:o,deps:c,inst:r,next:null},r=en.updateQueue,r===null&&(r=hh(),en.updateQueue=r),o=r.lastEffect,o===null?r.lastEffect=t.next=t:(c=o.next,o.next=t,t.next=c,r.lastEffect=t),t}function Qv(){return xs().memoizedState}function mh(t,r,o,c){var f=sr();en.flags|=t,f.memoizedState=fl(1|r,{destroy:void 0},o,c===void 0?null:c)}function ph(t,r,o,c){var f=xs();c=c===void 0?null:c;var m=f.memoizedState.inst;Hn!==null&&c!==null&&Yf(c,Hn.memoizedState.deps)?f.memoizedState=fl(r,m,o,c):(en.flags|=t,f.memoizedState=fl(1|r,m,o,c))}function Xv(t,r){mh(8390656,8,t,r)}function am(t,r){ph(2048,8,t,r)}function Xk(t){en.flags|=4;var r=en.updateQueue;if(r===null)r=hh(),en.updateQueue=r,r.events=[t];else{var o=r.events;o===null?r.events=[t]:o.push(t)}}function Jv(t){var r=xs().memoizedState;return Xk({ref:r,nextImpl:t}),function(){if((Dn&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function Zv(t,r){return ph(4,2,t,r)}function eb(t,r){return ph(4,4,t,r)}function tb(t,r){if(typeof r=="function"){t=t();var o=r(t);return function(){typeof o=="function"?o():r(null)}}if(r!=null)return t=t(),r.current=t,function(){r.current=null}}function nb(t,r,o){o=o!=null?o.concat([t]):null,ph(4,4,tb.bind(null,r,t),o)}function im(){}function sb(t,r){var o=xs();r=r===void 0?null:r;var c=o.memoizedState;return r!==null&&Yf(r,c[1])?c[0]:(o.memoizedState=[t,r],t)}function rb(t,r){var o=xs();r=r===void 0?null:r;var c=o.memoizedState;if(r!==null&&Yf(r,c[1]))return c[0];if(c=t(),jo){Me(!0);try{t()}finally{Me(!1)}}return o.memoizedState=[c,r],c}function om(t,r,o){return o===void 0||(Fa&1073741824)!==0&&(hn&261930)===0?t.memoizedState=r:(t.memoizedState=o,t=a0(),en.lanes|=t,Ei|=t,o)}function ab(t,r,o,c){return Er(o,r)?o:ul.current!==null?(t=om(t,o,c),Er(t,r)||(Es=!0),t):(Fa&42)===0||(Fa&1073741824)!==0&&(hn&261930)===0?(Es=!0,t.memoizedState=o):(t=a0(),en.lanes|=t,Ei|=t,r)}function ib(t,r,o,c,f){var m=je.p;je.p=m!==0&&8>m?m:8;var b=Q.T,S={};Q.T=S,um(t,!1,r,o);try{var B=f(),re=Q.S;if(re!==null&&re(S,B),B!==null&&typeof B=="object"&&typeof B.then=="function"){var xe=Wk(B,c);yc(t,r,xe,Ir(t))}else yc(t,r,c,Ir(t))}catch(Re){yc(t,r,{then:function(){},status:"rejected",reason:Re},Ir())}finally{je.p=m,b!==null&&S.types!==null&&(b.types=S.types),Q.T=b}}function Jk(){}function lm(t,r,o,c){if(t.tag!==5)throw Error(i(476));var f=ob(t).queue;ib(t,f,r,ze,o===null?Jk:function(){return lb(t),o(c)})}function ob(t){var r=t.memoizedState;if(r!==null)return r;r={memoizedState:ze,baseState:ze,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qa,lastRenderedState:ze},next:null};var o={};return r.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qa,lastRenderedState:o},next:null},t.memoizedState=r,t=t.alternate,t!==null&&(t.memoizedState=r),r}function lb(t){var r=ob(t);r.next===null&&(r=t.alternate.memoizedState),yc(t,r.next.queue,{},Ir())}function cm(){return Bs(Dc)}function cb(){return xs().memoizedState}function ub(){return xs().memoizedState}function Zk(t){for(var r=t.return;r!==null;){switch(r.tag){case 24:case 3:var o=Ir();t=xi(o);var c=wi(r,t,o);c!==null&&(gr(c,r,o),dc(c,r,o)),r={cache:Vf()},t.payload=r;return}r=r.return}}function eT(t,r,o){var c=Ir();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},gh(t)?db(r,o):(o=Sf(t,r,o,c),o!==null&&(gr(o,t,c),fb(o,r,c)))}function hb(t,r,o){var c=Ir();yc(t,r,o,c)}function yc(t,r,o,c){var f={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(gh(t))db(r,f);else{var m=t.alternate;if(t.lanes===0&&(m===null||m.lanes===0)&&(m=r.lastRenderedReducer,m!==null))try{var b=r.lastRenderedState,S=m(b,o);if(f.hasEagerState=!0,f.eagerState=S,Er(S,b))return Qu(t,r,f,0),Yn===null&&Yu(),!1}catch{}if(o=Sf(t,r,f,c),o!==null)return gr(o,t,c),fb(o,r,c),!0}return!1}function um(t,r,o,c){if(c={lane:2,revertLane:Fm(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},gh(t)){if(r)throw Error(i(479))}else r=Sf(t,o,c,2),r!==null&&gr(r,t,2)}function gh(t){var r=t.alternate;return t===en||r!==null&&r===en}function db(t,r){hl=ch=!0;var o=t.pending;o===null?r.next=r:(r.next=o.next,o.next=r),t.pending=r}function fb(t,r,o){if((o&4194048)!==0){var c=r.lanes;c&=t.pendingLanes,o|=c,r.lanes=o,un(t,o)}}var vc={readContext:Bs,use:dh,useCallback:ds,useContext:ds,useEffect:ds,useImperativeHandle:ds,useLayoutEffect:ds,useInsertionEffect:ds,useMemo:ds,useReducer:ds,useRef:ds,useState:ds,useDebugValue:ds,useDeferredValue:ds,useTransition:ds,useSyncExternalStore:ds,useId:ds,useHostTransitionStatus:ds,useFormState:ds,useActionState:ds,useOptimistic:ds,useMemoCache:ds,useCacheRefresh:ds};vc.useEffectEvent=ds;var mb={readContext:Bs,use:dh,useCallback:function(t,r){return sr().memoizedState=[t,r===void 0?null:r],t},useContext:Bs,useEffect:Xv,useImperativeHandle:function(t,r,o){o=o!=null?o.concat([t]):null,mh(4194308,4,tb.bind(null,r,t),o)},useLayoutEffect:function(t,r){return mh(4194308,4,t,r)},useInsertionEffect:function(t,r){mh(4,2,t,r)},useMemo:function(t,r){var o=sr();r=r===void 0?null:r;var c=t();if(jo){Me(!0);try{t()}finally{Me(!1)}}return o.memoizedState=[c,r],c},useReducer:function(t,r,o){var c=sr();if(o!==void 0){var f=o(r);if(jo){Me(!0);try{o(r)}finally{Me(!1)}}}else f=r;return c.memoizedState=c.baseState=f,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:f},c.queue=t,t=t.dispatch=eT.bind(null,en,t),[c.memoizedState,t]},useRef:function(t){var r=sr();return t={current:t},r.memoizedState=t},useState:function(t){t=sm(t);var r=t.queue,o=hb.bind(null,en,r);return r.dispatch=o,[t.memoizedState,o]},useDebugValue:im,useDeferredValue:function(t,r){var o=sr();return om(o,t,r)},useTransition:function(){var t=sm(!1);return t=ib.bind(null,en,t.queue,!0,!1),sr().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,r,o){var c=en,f=sr();if(_n){if(o===void 0)throw Error(i(407));o=o()}else{if(o=r(),Yn===null)throw Error(i(349));(hn&127)!==0||Pv(c,r,o)}f.memoizedState=o;var m={value:o,getSnapshot:r};return f.queue=m,Xv(Ov.bind(null,c,m,t),[t]),c.flags|=2048,fl(9,{destroy:void 0},Lv.bind(null,c,m,o,r),null),o},useId:function(){var t=sr(),r=Yn.identifierPrefix;if(_n){var o=ba,c=va;o=(c&~(1<<32-Le(c)-1)).toString(32)+o,r="_"+r+"R_"+o,o=uh++,0<o&&(r+="H"+o.toString(32)),r+="_"}else o=Gk++,r="_"+r+"r_"+o.toString(32)+"_";return t.memoizedState=r},useHostTransitionStatus:cm,useFormState:Wv,useActionState:Wv,useOptimistic:function(t){var r=sr();r.memoizedState=r.baseState=t;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=o,r=um.bind(null,en,!0,o),o.dispatch=r,[t,r]},useMemoCache:em,useCacheRefresh:function(){return sr().memoizedState=Zk.bind(null,en)},useEffectEvent:function(t){var r=sr(),o={impl:t};return r.memoizedState=o,function(){if((Dn&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},hm={readContext:Bs,use:dh,useCallback:sb,useContext:Bs,useEffect:am,useImperativeHandle:nb,useInsertionEffect:Zv,useLayoutEffect:eb,useMemo:rb,useReducer:fh,useRef:Qv,useState:function(){return fh(qa)},useDebugValue:im,useDeferredValue:function(t,r){var o=xs();return ab(o,Hn.memoizedState,t,r)},useTransition:function(){var t=fh(qa)[0],r=xs().memoizedState;return[typeof t=="boolean"?t:gc(t),r]},useSyncExternalStore:Dv,useId:cb,useHostTransitionStatus:cm,useFormState:Gv,useActionState:Gv,useOptimistic:function(t,r){var o=xs();return Uv(o,Hn,t,r)},useMemoCache:em,useCacheRefresh:ub};hm.useEffectEvent=Jv;var pb={readContext:Bs,use:dh,useCallback:sb,useContext:Bs,useEffect:am,useImperativeHandle:nb,useInsertionEffect:Zv,useLayoutEffect:eb,useMemo:rb,useReducer:nm,useRef:Qv,useState:function(){return nm(qa)},useDebugValue:im,useDeferredValue:function(t,r){var o=xs();return Hn===null?om(o,t,r):ab(o,Hn.memoizedState,t,r)},useTransition:function(){var t=nm(qa)[0],r=xs().memoizedState;return[typeof t=="boolean"?t:gc(t),r]},useSyncExternalStore:Dv,useId:cb,useHostTransitionStatus:cm,useFormState:Yv,useActionState:Yv,useOptimistic:function(t,r){var o=xs();return Hn!==null?Uv(o,Hn,t,r):(o.baseState=t,[t,o.queue.dispatch])},useMemoCache:em,useCacheRefresh:ub};pb.useEffectEvent=Jv;function dm(t,r,o,c){r=t.memoizedState,o=o(c,r),o=o==null?r:k({},r,o),t.memoizedState=o,t.lanes===0&&(t.updateQueue.baseState=o)}var fm={enqueueSetState:function(t,r,o){t=t._reactInternals;var c=Ir(),f=xi(c);f.payload=r,o!=null&&(f.callback=o),r=wi(t,f,c),r!==null&&(gr(r,t,c),dc(r,t,c))},enqueueReplaceState:function(t,r,o){t=t._reactInternals;var c=Ir(),f=xi(c);f.tag=1,f.payload=r,o!=null&&(f.callback=o),r=wi(t,f,c),r!==null&&(gr(r,t,c),dc(r,t,c))},enqueueForceUpdate:function(t,r){t=t._reactInternals;var o=Ir(),c=xi(o);c.tag=2,r!=null&&(c.callback=r),r=wi(t,c,o),r!==null&&(gr(r,t,o),dc(r,t,o))}};function gb(t,r,o,c,f,m,b){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(c,m,b):r.prototype&&r.prototype.isPureReactComponent?!rc(o,c)||!rc(f,m):!0}function yb(t,r,o,c){t=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,c),r.state!==t&&fm.enqueueReplaceState(r,r.state,null)}function Eo(t,r){var o=r;if("ref"in r){o={};for(var c in r)c!=="ref"&&(o[c]=r[c])}if(t=t.defaultProps){o===r&&(o=k({},o));for(var f in t)o[f]===void 0&&(o[f]=t[f])}return o}function vb(t){Ku(t)}function bb(t){console.error(t)}function xb(t){Ku(t)}function yh(t,r){try{var o=t.onUncaughtError;o(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function wb(t,r,o){try{var c=t.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function mm(t,r,o){return o=xi(o),o.tag=3,o.payload={element:null},o.callback=function(){yh(t,r)},o}function _b(t){return t=xi(t),t.tag=3,t}function kb(t,r,o,c){var f=o.type.getDerivedStateFromError;if(typeof f=="function"){var m=c.value;t.payload=function(){return f(m)},t.callback=function(){wb(r,o,c)}}var b=o.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(t.callback=function(){wb(r,o,c),typeof f!="function"&&(Si===null?Si=new Set([this]):Si.add(this));var S=c.stack;this.componentDidCatch(c.value,{componentStack:S!==null?S:""})})}function tT(t,r,o,c,f){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=o.alternate,r!==null&&al(r,o,f,!0),o=Nr.current,o!==null){switch(o.tag){case 31:case 13:return Hr===null?Ch():o.alternate===null&&fs===0&&(fs=3),o.flags&=-257,o.flags|=65536,o.lanes=f,c===rh?o.flags|=16384:(r=o.updateQueue,r===null?o.updateQueue=new Set([c]):r.add(c),Bm(t,c,f)),!1;case 22:return o.flags|=65536,c===rh?o.flags|=16384:(r=o.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=r):(o=r.retryQueue,o===null?r.retryQueue=new Set([c]):o.add(c)),Bm(t,c,f)),!1}throw Error(i(435,o.tag))}return Bm(t,c,f),Ch(),!1}if(_n)return r=Nr.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=f,c!==Mf&&(t=Error(i(422),{cause:c}),oc(Ur(t,o)))):(c!==Mf&&(r=Error(i(423),{cause:c}),oc(Ur(r,o))),t=t.current.alternate,t.flags|=65536,f&=-f,t.lanes|=f,c=Ur(c,o),f=mm(t.stateNode,c,f),Hf(t,f),fs!==4&&(fs=2)),!1;var m=Error(i(520),{cause:c});if(m=Ur(m,o),Ec===null?Ec=[m]:Ec.push(m),fs!==4&&(fs=2),r===null)return!0;c=Ur(c,o),o=r;do{switch(o.tag){case 3:return o.flags|=65536,t=f&-f,o.lanes|=t,t=mm(o.stateNode,c,t),Hf(o,t),!1;case 1:if(r=o.type,m=o.stateNode,(o.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Si===null||!Si.has(m))))return o.flags|=65536,f&=-f,o.lanes|=f,f=_b(f),kb(f,t,o,c),Hf(o,f),!1}o=o.return}while(o!==null);return!1}var pm=Error(i(461)),Es=!1;function Us(t,r,o,c){r.child=t===null?Sv(r,null,o,c):To(r,t.child,o,c)}function Tb(t,r,o,c,f){o=o.render;var m=r.ref;if("ref"in c){var b={};for(var S in c)S!=="ref"&&(b[S]=c[S])}else b=c;return xo(r),c=Qf(t,r,o,b,m,f),S=Xf(),t!==null&&!Es?(Jf(t,r,f),Ha(t,r,f)):(_n&&S&&Af(r),r.flags|=1,Us(t,r,c,f),r.child)}function jb(t,r,o,c,f){if(t===null){var m=o.type;return typeof m=="function"&&!Nf(m)&&m.defaultProps===void 0&&o.compare===null?(r.tag=15,r.type=m,Eb(t,r,m,c,f)):(t=Ju(o.type,null,c,r,r.mode,f),t.ref=r.ref,t.return=r,r.child=t)}if(m=t.child,!km(t,f)){var b=m.memoizedProps;if(o=o.compare,o=o!==null?o:rc,o(b,c)&&t.ref===r.ref)return Ha(t,r,f)}return r.flags|=1,t=Va(m,c),t.ref=r.ref,t.return=r,r.child=t}function Eb(t,r,o,c,f){if(t!==null){var m=t.memoizedProps;if(rc(m,c)&&t.ref===r.ref)if(Es=!1,r.pendingProps=c=m,km(t,f))(t.flags&131072)!==0&&(Es=!0);else return r.lanes=t.lanes,Ha(t,r,f)}return gm(t,r,o,c,f)}function Sb(t,r,o,c){var f=c.children,m=t!==null?t.memoizedState:null;if(t===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((r.flags&128)!==0){if(m=m!==null?m.baseLanes|o:o,t!==null){for(c=r.child=t.child,f=0;c!==null;)f=f|c.lanes|c.childLanes,c=c.sibling;c=f&~m}else c=0,r.child=null;return Nb(t,r,m,o,c)}if((o&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},t!==null&&nh(r,m!==null?m.cachePool:null),m!==null?Rv(r,m):Wf(),Av(r);else return c=r.lanes=536870912,Nb(t,r,m!==null?m.baseLanes|o:o,o,c)}else m!==null?(nh(r,m.cachePool),Rv(r,m),ki(),r.memoizedState=null):(t!==null&&nh(r,null),Wf(),ki());return Us(t,r,f,o),r.child}function bc(t,r){return t!==null&&t.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function Nb(t,r,o,c,f){var m=Uf();return m=m===null?null:{parent:Ts._currentValue,pool:m},r.memoizedState={baseLanes:o,cachePool:m},t!==null&&nh(r,null),Wf(),Av(r),t!==null&&al(t,r,c,!0),r.childLanes=f,null}function vh(t,r){return r=xh({mode:r.mode,children:r.children},t.mode),r.ref=t.ref,t.child=r,r.return=t,r}function Cb(t,r,o){return To(r,t.child,null,o),t=vh(r,r.pendingProps),t.flags|=2,Cr(r),r.memoizedState=null,t}function nT(t,r,o){var c=r.pendingProps,f=(r.flags&128)!==0;if(r.flags&=-129,t===null){if(_n){if(c.mode==="hidden")return t=vh(r,c),r.lanes=536870912,bc(null,t);if(Kf(r),(t=ts)?(t=z0(t,qr),t=t!==null&&t.data==="&"?t:null,t!==null&&(r.memoizedState={dehydrated:t,treeContext:pi!==null?{id:va,overflow:ba}:null,retryLane:536870912,hydrationErrors:null},o=dv(t),o.return=r,r.child=o,Vs=r,ts=null)):t=null,t===null)throw yi(r);return r.lanes=536870912,null}return vh(r,c)}var m=t.memoizedState;if(m!==null){var b=m.dehydrated;if(Kf(r),f)if(r.flags&256)r.flags&=-257,r=Cb(t,r,o);else if(r.memoizedState!==null)r.child=t.child,r.flags|=128,r=null;else throw Error(i(558));else if(Es||al(t,r,o,!1),f=(o&t.childLanes)!==0,Es||f){if(c=Yn,c!==null&&(b=rs(c,o),b!==0&&b!==m.retryLane))throw m.retryLane=b,go(t,b),gr(c,t,b),pm;Ch(),r=Cb(t,r,o)}else t=m.treeContext,ts=$r(b.nextSibling),Vs=r,_n=!0,gi=null,qr=!1,t!==null&&pv(r,t),r=vh(r,c),r.flags|=4096;return r}return t=Va(t.child,{mode:c.mode,children:c.children}),t.ref=r.ref,r.child=t,t.return=r,t}function bh(t,r){var o=r.ref;if(o===null)t!==null&&t.ref!==null&&(r.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(t===null||t.ref!==o)&&(r.flags|=4194816)}}function gm(t,r,o,c,f){return xo(r),o=Qf(t,r,o,c,void 0,f),c=Xf(),t!==null&&!Es?(Jf(t,r,f),Ha(t,r,f)):(_n&&c&&Af(r),r.flags|=1,Us(t,r,o,f),r.child)}function Rb(t,r,o,c,f,m){return xo(r),r.updateQueue=null,o=Mv(r,c,o,f),Iv(t),c=Xf(),t!==null&&!Es?(Jf(t,r,m),Ha(t,r,m)):(_n&&c&&Af(r),r.flags|=1,Us(t,r,o,m),r.child)}function Ab(t,r,o,c,f){if(xo(r),r.stateNode===null){var m=tl,b=o.contextType;typeof b=="object"&&b!==null&&(m=Bs(b)),m=new o(c,m),r.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=fm,r.stateNode=m,m._reactInternals=r,m=r.stateNode,m.props=c,m.state=r.memoizedState,m.refs={},Ff(r),b=o.contextType,m.context=typeof b=="object"&&b!==null?Bs(b):tl,m.state=r.memoizedState,b=o.getDerivedStateFromProps,typeof b=="function"&&(dm(r,o,b,c),m.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(b=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),b!==m.state&&fm.enqueueReplaceState(m,m.state,null),mc(r,c,m,f),fc(),m.state=r.memoizedState),typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(t===null){m=r.stateNode;var S=r.memoizedProps,B=Eo(o,S);m.props=B;var re=m.context,xe=o.contextType;b=tl,typeof xe=="object"&&xe!==null&&(b=Bs(xe));var Re=o.getDerivedStateFromProps;xe=typeof Re=="function"||typeof m.getSnapshotBeforeUpdate=="function",S=r.pendingProps!==S,xe||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(S||re!==b)&&yb(r,m,c,b),bi=!1;var le=r.memoizedState;m.state=le,mc(r,c,m,f),fc(),re=r.memoizedState,S||le!==re||bi?(typeof Re=="function"&&(dm(r,o,Re,c),re=r.memoizedState),(B=bi||gb(r,o,B,c,le,re,b))?(xe||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(r.flags|=4194308)):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=re),m.props=c,m.state=re,m.context=b,c=B):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{m=r.stateNode,qf(t,r),b=r.memoizedProps,xe=Eo(o,b),m.props=xe,Re=r.pendingProps,le=m.context,re=o.contextType,B=tl,typeof re=="object"&&re!==null&&(B=Bs(re)),S=o.getDerivedStateFromProps,(re=typeof S=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(b!==Re||le!==B)&&yb(r,m,c,B),bi=!1,le=r.memoizedState,m.state=le,mc(r,c,m,f),fc();var de=r.memoizedState;b!==Re||le!==de||bi||t!==null&&t.dependencies!==null&&eh(t.dependencies)?(typeof S=="function"&&(dm(r,o,S,c),de=r.memoizedState),(xe=bi||gb(r,o,xe,c,le,de,B)||t!==null&&t.dependencies!==null&&eh(t.dependencies))?(re||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(c,de,B),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(c,de,B)),typeof m.componentDidUpdate=="function"&&(r.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof m.componentDidUpdate!="function"||b===t.memoizedProps&&le===t.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||b===t.memoizedProps&&le===t.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=de),m.props=c,m.state=de,m.context=B,c=xe):(typeof m.componentDidUpdate!="function"||b===t.memoizedProps&&le===t.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||b===t.memoizedProps&&le===t.memoizedState||(r.flags|=1024),c=!1)}return m=c,bh(t,r),c=(r.flags&128)!==0,m||c?(m=r.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:m.render(),r.flags|=1,t!==null&&c?(r.child=To(r,t.child,null,f),r.child=To(r,null,o,f)):Us(t,r,o,f),r.memoizedState=m.state,t=r.child):t=Ha(t,r,f),t}function Ib(t,r,o,c){return vo(),r.flags|=256,Us(t,r,o,c),r.child}var ym={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function vm(t){return{baseLanes:t,cachePool:wv()}}function bm(t,r,o){return t=t!==null?t.childLanes&~o:0,r&&(t|=Ar),t}function Mb(t,r,o){var c=r.pendingProps,f=!1,m=(r.flags&128)!==0,b;if((b=m)||(b=t!==null&&t.memoizedState===null?!1:(bs.current&2)!==0),b&&(f=!0,r.flags&=-129),b=(r.flags&32)!==0,r.flags&=-33,t===null){if(_n){if(f?_i(r):ki(),(t=ts)?(t=z0(t,qr),t=t!==null&&t.data!=="&"?t:null,t!==null&&(r.memoizedState={dehydrated:t,treeContext:pi!==null?{id:va,overflow:ba}:null,retryLane:536870912,hydrationErrors:null},o=dv(t),o.return=r,r.child=o,Vs=r,ts=null)):t=null,t===null)throw yi(r);return tp(t)?r.lanes=32:r.lanes=536870912,null}var S=c.children;return c=c.fallback,f?(ki(),f=r.mode,S=xh({mode:"hidden",children:S},f),c=yo(c,f,o,null),S.return=r,c.return=r,S.sibling=c,r.child=S,c=r.child,c.memoizedState=vm(o),c.childLanes=bm(t,b,o),r.memoizedState=ym,bc(null,c)):(_i(r),xm(r,S))}var B=t.memoizedState;if(B!==null&&(S=B.dehydrated,S!==null)){if(m)r.flags&256?(_i(r),r.flags&=-257,r=wm(t,r,o)):r.memoizedState!==null?(ki(),r.child=t.child,r.flags|=128,r=null):(ki(),S=c.fallback,f=r.mode,c=xh({mode:"visible",children:c.children},f),S=yo(S,f,o,null),S.flags|=2,c.return=r,S.return=r,c.sibling=S,r.child=c,To(r,t.child,null,o),c=r.child,c.memoizedState=vm(o),c.childLanes=bm(t,b,o),r.memoizedState=ym,r=bc(null,c));else if(_i(r),tp(S)){if(b=S.nextSibling&&S.nextSibling.dataset,b)var re=b.dgst;b=re,c=Error(i(419)),c.stack="",c.digest=b,oc({value:c,source:null,stack:null}),r=wm(t,r,o)}else if(Es||al(t,r,o,!1),b=(o&t.childLanes)!==0,Es||b){if(b=Yn,b!==null&&(c=rs(b,o),c!==0&&c!==B.retryLane))throw B.retryLane=c,go(t,c),gr(b,t,c),pm;ep(S)||Ch(),r=wm(t,r,o)}else ep(S)?(r.flags|=192,r.child=t.child,r=null):(t=B.treeContext,ts=$r(S.nextSibling),Vs=r,_n=!0,gi=null,qr=!1,t!==null&&pv(r,t),r=xm(r,c.children),r.flags|=4096);return r}return f?(ki(),S=c.fallback,f=r.mode,B=t.child,re=B.sibling,c=Va(B,{mode:"hidden",children:c.children}),c.subtreeFlags=B.subtreeFlags&65011712,re!==null?S=Va(re,S):(S=yo(S,f,o,null),S.flags|=2),S.return=r,c.return=r,c.sibling=S,r.child=c,bc(null,c),c=r.child,S=t.child.memoizedState,S===null?S=vm(o):(f=S.cachePool,f!==null?(B=Ts._currentValue,f=f.parent!==B?{parent:B,pool:B}:f):f=wv(),S={baseLanes:S.baseLanes|o,cachePool:f}),c.memoizedState=S,c.childLanes=bm(t,b,o),r.memoizedState=ym,bc(t.child,c)):(_i(r),o=t.child,t=o.sibling,o=Va(o,{mode:"visible",children:c.children}),o.return=r,o.sibling=null,t!==null&&(b=r.deletions,b===null?(r.deletions=[t],r.flags|=16):b.push(t)),r.child=o,r.memoizedState=null,o)}function xm(t,r){return r=xh({mode:"visible",children:r},t.mode),r.return=t,t.child=r}function xh(t,r){return t=Sr(22,t,null,r),t.lanes=0,t}function wm(t,r,o){return To(r,t.child,null,o),t=xm(r,r.pendingProps.children),t.flags|=2,r.memoizedState=null,t}function Db(t,r,o){t.lanes|=r;var c=t.alternate;c!==null&&(c.lanes|=r),Lf(t.return,r,o)}function _m(t,r,o,c,f,m){var b=t.memoizedState;b===null?t.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:f,treeForkCount:m}:(b.isBackwards=r,b.rendering=null,b.renderingStartTime=0,b.last=c,b.tail=o,b.tailMode=f,b.treeForkCount=m)}function Pb(t,r,o){var c=r.pendingProps,f=c.revealOrder,m=c.tail;c=c.children;var b=bs.current,S=(b&2)!==0;if(S?(b=b&1|2,r.flags|=128):b&=1,ye(bs,b),Us(t,r,c,o),c=_n?ic:0,!S&&t!==null&&(t.flags&128)!==0)e:for(t=r.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Db(t,o,r);else if(t.tag===19)Db(t,o,r);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===r)break e;for(;t.sibling===null;){if(t.return===null||t.return===r)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(f){case"forwards":for(o=r.child,f=null;o!==null;)t=o.alternate,t!==null&&lh(t)===null&&(f=o),o=o.sibling;o=f,o===null?(f=r.child,r.child=null):(f=o.sibling,o.sibling=null),_m(r,!1,f,o,m,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,f=r.child,r.child=null;f!==null;){if(t=f.alternate,t!==null&&lh(t)===null){r.child=f;break}t=f.sibling,f.sibling=o,o=f,f=t}_m(r,!0,o,null,m,c);break;case"together":_m(r,!1,null,null,void 0,c);break;default:r.memoizedState=null}return r.child}function Ha(t,r,o){if(t!==null&&(r.dependencies=t.dependencies),Ei|=r.lanes,(o&r.childLanes)===0)if(t!==null){if(al(t,r,o,!1),(o&r.childLanes)===0)return null}else return null;if(t!==null&&r.child!==t.child)throw Error(i(153));if(r.child!==null){for(t=r.child,o=Va(t,t.pendingProps),r.child=o,o.return=r;t.sibling!==null;)t=t.sibling,o=o.sibling=Va(t,t.pendingProps),o.return=r;o.sibling=null}return r.child}function km(t,r){return(t.lanes&r)!==0?!0:(t=t.dependencies,!!(t!==null&&eh(t)))}function sT(t,r,o){switch(r.tag){case 3:pt(r,r.stateNode.containerInfo),vi(r,Ts,t.memoizedState.cache),vo();break;case 27:case 5:qt(r);break;case 4:pt(r,r.stateNode.containerInfo);break;case 10:vi(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,Kf(r),null;break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(_i(r),r.flags|=128,null):(o&r.child.childLanes)!==0?Mb(t,r,o):(_i(r),t=Ha(t,r,o),t!==null?t.sibling:null);_i(r);break;case 19:var f=(t.flags&128)!==0;if(c=(o&r.childLanes)!==0,c||(al(t,r,o,!1),c=(o&r.childLanes)!==0),f){if(c)return Pb(t,r,o);r.flags|=128}if(f=r.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),ye(bs,bs.current),c)break;return null;case 22:return r.lanes=0,Sb(t,r,o,r.pendingProps);case 24:vi(r,Ts,t.memoizedState.cache)}return Ha(t,r,o)}function Lb(t,r,o){if(t!==null)if(t.memoizedProps!==r.pendingProps)Es=!0;else{if(!km(t,o)&&(r.flags&128)===0)return Es=!1,sT(t,r,o);Es=(t.flags&131072)!==0}else Es=!1,_n&&(r.flags&1048576)!==0&&mv(r,ic,r.index);switch(r.lanes=0,r.tag){case 16:e:{var c=r.pendingProps;if(t=_o(r.elementType),r.type=t,typeof t=="function")Nf(t)?(c=Eo(t,c),r.tag=1,r=Ab(null,r,t,c,o)):(r.tag=0,r=gm(null,r,t,c,o));else{if(t!=null){var f=t.$$typeof;if(f===Te){r.tag=11,r=Tb(null,r,t,c,o);break e}else if(f===I){r.tag=14,r=jb(null,r,t,c,o);break e}}throw r=We(t)||t,Error(i(306,r,""))}}return r;case 0:return gm(t,r,r.type,r.pendingProps,o);case 1:return c=r.type,f=Eo(c,r.pendingProps),Ab(t,r,c,f,o);case 3:e:{if(pt(r,r.stateNode.containerInfo),t===null)throw Error(i(387));c=r.pendingProps;var m=r.memoizedState;f=m.element,qf(t,r),mc(r,c,null,o);var b=r.memoizedState;if(c=b.cache,vi(r,Ts,c),c!==m.cache&&Of(r,[Ts],o,!0),fc(),c=b.element,m.isDehydrated)if(m={element:c,isDehydrated:!1,cache:b.cache},r.updateQueue.baseState=m,r.memoizedState=m,r.flags&256){r=Ib(t,r,c,o);break e}else if(c!==f){f=Ur(Error(i(424)),r),oc(f),r=Ib(t,r,c,o);break e}else for(t=r.stateNode.containerInfo,t.nodeType===9?t=t.body:t=t.nodeName==="HTML"?t.ownerDocument.body:t,ts=$r(t.firstChild),Vs=r,_n=!0,gi=null,qr=!0,o=Sv(r,null,c,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(vo(),c===f){r=Ha(t,r,o);break e}Us(t,r,c,o)}r=r.child}return r;case 26:return bh(t,r),t===null?(o=G0(r.type,null,r.pendingProps,null))?r.memoizedState=o:_n||(o=r.type,t=r.pendingProps,c=Lh(Ae.current).createElement(o),c[st]=r,c[At]=t,zs(c,o,t),C(c),r.stateNode=c):r.memoizedState=G0(r.type,t.memoizedProps,r.pendingProps,t.memoizedState),null;case 27:return qt(r),t===null&&_n&&(c=r.stateNode=H0(r.type,r.pendingProps,Ae.current),Vs=r,qr=!0,f=ts,Ai(r.type)?(np=f,ts=$r(c.firstChild)):ts=f),Us(t,r,r.pendingProps.children,o),bh(t,r),t===null&&(r.flags|=4194304),r.child;case 5:return t===null&&_n&&((f=c=ts)&&(c=MT(c,r.type,r.pendingProps,qr),c!==null?(r.stateNode=c,Vs=r,ts=$r(c.firstChild),qr=!1,f=!0):f=!1),f||yi(r)),qt(r),f=r.type,m=r.pendingProps,b=t!==null?t.memoizedProps:null,c=m.children,Xm(f,m)?c=null:b!==null&&Xm(f,b)&&(r.flags|=32),r.memoizedState!==null&&(f=Qf(t,r,Kk,null,null,o),Dc._currentValue=f),bh(t,r),Us(t,r,c,o),r.child;case 6:return t===null&&_n&&((t=o=ts)&&(o=DT(o,r.pendingProps,qr),o!==null?(r.stateNode=o,Vs=r,ts=null,t=!0):t=!1),t||yi(r)),null;case 13:return Mb(t,r,o);case 4:return pt(r,r.stateNode.containerInfo),c=r.pendingProps,t===null?r.child=To(r,null,c,o):Us(t,r,c,o),r.child;case 11:return Tb(t,r,r.type,r.pendingProps,o);case 7:return Us(t,r,r.pendingProps,o),r.child;case 8:return Us(t,r,r.pendingProps.children,o),r.child;case 12:return Us(t,r,r.pendingProps.children,o),r.child;case 10:return c=r.pendingProps,vi(r,r.type,c.value),Us(t,r,c.children,o),r.child;case 9:return f=r.type._context,c=r.pendingProps.children,xo(r),f=Bs(f),c=c(f),r.flags|=1,Us(t,r,c,o),r.child;case 14:return jb(t,r,r.type,r.pendingProps,o);case 15:return Eb(t,r,r.type,r.pendingProps,o);case 19:return Pb(t,r,o);case 31:return nT(t,r,o);case 22:return Sb(t,r,o,r.pendingProps);case 24:return xo(r),c=Bs(Ts),t===null?(f=Uf(),f===null&&(f=Yn,m=Vf(),f.pooledCache=m,m.refCount++,m!==null&&(f.pooledCacheLanes|=o),f=m),r.memoizedState={parent:c,cache:f},Ff(r),vi(r,Ts,f)):((t.lanes&o)!==0&&(qf(t,r),mc(r,null,null,o),fc()),f=t.memoizedState,m=r.memoizedState,f.parent!==c?(f={parent:c,cache:c},r.memoizedState=f,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=f),vi(r,Ts,c)):(c=m.cache,vi(r,Ts,c),c!==f.cache&&Of(r,[Ts],o,!0))),Us(t,r,r.pendingProps.children,o),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function $a(t){t.flags|=4}function Tm(t,r,o,c,f){if((r=(t.mode&32)!==0)&&(r=!1),r){if(t.flags|=16777216,(f&335544128)===f)if(t.stateNode.complete)t.flags|=8192;else if(c0())t.flags|=8192;else throw ko=rh,zf}else t.flags&=-16777217}function Ob(t,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!J0(r))if(c0())t.flags|=8192;else throw ko=rh,zf}function wh(t,r){r!==null&&(t.flags|=4),t.flags&16384&&(r=t.tag!==22?Vn():536870912,t.lanes|=r,yl|=r)}function xc(t,r){if(!_n)switch(t.tailMode){case"hidden":r=t.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?t.tail=null:o.sibling=null;break;case"collapsed":o=t.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?r||t.tail===null?t.tail=null:t.tail.sibling=null:c.sibling=null}}function ns(t){var r=t.alternate!==null&&t.alternate.child===t.child,o=0,c=0;if(r)for(var f=t.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags&65011712,c|=f.flags&65011712,f.return=t,f=f.sibling;else for(f=t.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=t,f=f.sibling;return t.subtreeFlags|=c,t.childLanes=o,r}function rT(t,r,o){var c=r.pendingProps;switch(If(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ns(r),null;case 1:return ns(r),null;case 3:return o=r.stateNode,c=null,t!==null&&(c=t.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),za(Ts),Je(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(t===null||t.child===null)&&(rl(r)?$a(r):t===null||t.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Df())),ns(r),null;case 26:var f=r.type,m=r.memoizedState;return t===null?($a(r),m!==null?(ns(r),Ob(r,m)):(ns(r),Tm(r,f,null,c,o))):m?m!==t.memoizedState?($a(r),ns(r),Ob(r,m)):(ns(r),r.flags&=-16777217):(t=t.memoizedProps,t!==c&&$a(r),ns(r),Tm(r,f,t,c,o)),null;case 27:if(cn(r),o=Ae.current,f=r.type,t!==null&&r.stateNode!=null)t.memoizedProps!==c&&$a(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return ns(r),null}t=Se.current,rl(r)?gv(r):(t=H0(f,c,o),r.stateNode=t,$a(r))}return ns(r),null;case 5:if(cn(r),f=r.type,t!==null&&r.stateNode!=null)t.memoizedProps!==c&&$a(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return ns(r),null}if(m=Se.current,rl(r))gv(r);else{var b=Lh(Ae.current);switch(m){case 1:m=b.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:m=b.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":m=b.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":m=b.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":m=b.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof c.is=="string"?b.createElement("select",{is:c.is}):b.createElement("select"),c.multiple?m.multiple=!0:c.size&&(m.size=c.size);break;default:m=typeof c.is=="string"?b.createElement(f,{is:c.is}):b.createElement(f)}}m[st]=r,m[At]=c;e:for(b=r.child;b!==null;){if(b.tag===5||b.tag===6)m.appendChild(b.stateNode);else if(b.tag!==4&&b.tag!==27&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===r)break e;for(;b.sibling===null;){if(b.return===null||b.return===r)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}r.stateNode=m;e:switch(zs(m,f,c),f){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&$a(r)}}return ns(r),Tm(r,r.type,t===null?null:t.memoizedProps,r.pendingProps,o),null;case 6:if(t&&r.stateNode!=null)t.memoizedProps!==c&&$a(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(i(166));if(t=Ae.current,rl(r)){if(t=r.stateNode,o=r.memoizedProps,c=null,f=Vs,f!==null)switch(f.tag){case 27:case 5:c=f.memoizedProps}t[st]=r,t=!!(t.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||M0(t.nodeValue,o)),t||yi(r,!0)}else t=Lh(t).createTextNode(c),t[st]=r,r.stateNode=t}return ns(r),null;case 31:if(o=r.memoizedState,t===null||t.memoizedState!==null){if(c=rl(r),o!==null){if(t===null){if(!c)throw Error(i(318));if(t=r.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(i(557));t[st]=r}else vo(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;ns(r),t=!1}else o=Df(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=o),t=!0;if(!t)return r.flags&256?(Cr(r),r):(Cr(r),null);if((r.flags&128)!==0)throw Error(i(558))}return ns(r),null;case 13:if(c=r.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(f=rl(r),c!==null&&c.dehydrated!==null){if(t===null){if(!f)throw Error(i(318));if(f=r.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));f[st]=r}else vo(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;ns(r),f=!1}else f=Df(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=f),f=!0;if(!f)return r.flags&256?(Cr(r),r):(Cr(r),null)}return Cr(r),(r.flags&128)!==0?(r.lanes=o,r):(o=c!==null,t=t!==null&&t.memoizedState!==null,o&&(c=r.child,f=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(f=c.alternate.memoizedState.cachePool.pool),m=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(m=c.memoizedState.cachePool.pool),m!==f&&(c.flags|=2048)),o!==t&&o&&(r.child.flags|=8192),wh(r,r.updateQueue),ns(r),null);case 4:return Je(),t===null&&Wm(r.stateNode.containerInfo),ns(r),null;case 10:return za(r.type),ns(r),null;case 19:if(H(bs),c=r.memoizedState,c===null)return ns(r),null;if(f=(r.flags&128)!==0,m=c.rendering,m===null)if(f)xc(c,!1);else{if(fs!==0||t!==null&&(t.flags&128)!==0)for(t=r.child;t!==null;){if(m=lh(t),m!==null){for(r.flags|=128,xc(c,!1),t=m.updateQueue,r.updateQueue=t,wh(r,t),r.subtreeFlags=0,t=o,o=r.child;o!==null;)hv(o,t),o=o.sibling;return ye(bs,bs.current&1|2),_n&&Ba(r,c.treeForkCount),r.child}t=t.sibling}c.tail!==null&&Et()>Eh&&(r.flags|=128,f=!0,xc(c,!1),r.lanes=4194304)}else{if(!f)if(t=lh(m),t!==null){if(r.flags|=128,f=!0,t=t.updateQueue,r.updateQueue=t,wh(r,t),xc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!m.alternate&&!_n)return ns(r),null}else 2*Et()-c.renderingStartTime>Eh&&o!==536870912&&(r.flags|=128,f=!0,xc(c,!1),r.lanes=4194304);c.isBackwards?(m.sibling=r.child,r.child=m):(t=c.last,t!==null?t.sibling=m:r.child=m,c.last=m)}return c.tail!==null?(t=c.tail,c.rendering=t,c.tail=t.sibling,c.renderingStartTime=Et(),t.sibling=null,o=bs.current,ye(bs,f?o&1|2:o&1),_n&&Ba(r,c.treeForkCount),t):(ns(r),null);case 22:case 23:return Cr(r),Gf(),c=r.memoizedState!==null,t!==null?t.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(o&536870912)!==0&&(r.flags&128)===0&&(ns(r),r.subtreeFlags&6&&(r.flags|=8192)):ns(r),o=r.updateQueue,o!==null&&wh(r,o.retryQueue),o=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(o=t.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==o&&(r.flags|=2048),t!==null&&H(wo),null;case 24:return o=null,t!==null&&(o=t.memoizedState.cache),r.memoizedState.cache!==o&&(r.flags|=2048),za(Ts),ns(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function aT(t,r){switch(If(r),r.tag){case 1:return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 3:return za(Ts),Je(),t=r.flags,(t&65536)!==0&&(t&128)===0?(r.flags=t&-65537|128,r):null;case 26:case 27:case 5:return cn(r),null;case 31:if(r.memoizedState!==null){if(Cr(r),r.alternate===null)throw Error(i(340));vo()}return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 13:if(Cr(r),t=r.memoizedState,t!==null&&t.dehydrated!==null){if(r.alternate===null)throw Error(i(340));vo()}return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 19:return H(bs),null;case 4:return Je(),null;case 10:return za(r.type),null;case 22:case 23:return Cr(r),Gf(),t!==null&&H(wo),t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 24:return za(Ts),null;case 25:return null;default:return null}}function Vb(t,r){switch(If(r),r.tag){case 3:za(Ts),Je();break;case 26:case 27:case 5:cn(r);break;case 4:Je();break;case 31:r.memoizedState!==null&&Cr(r);break;case 13:Cr(r);break;case 19:H(bs);break;case 10:za(r.type);break;case 22:case 23:Cr(r),Gf(),t!==null&&H(wo);break;case 24:za(Ts)}}function wc(t,r){try{var o=r.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var f=c.next;o=f;do{if((o.tag&t)===t){c=void 0;var m=o.create,b=o.inst;c=m(),b.destroy=c}o=o.next}while(o!==f)}}catch(S){Fn(r,r.return,S)}}function Ti(t,r,o){try{var c=r.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var m=f.next;c=m;do{if((c.tag&t)===t){var b=c.inst,S=b.destroy;if(S!==void 0){b.destroy=void 0,f=r;var B=o,re=S;try{re()}catch(xe){Fn(f,B,xe)}}}c=c.next}while(c!==m)}}catch(xe){Fn(r,r.return,xe)}}function Bb(t){var r=t.updateQueue;if(r!==null){var o=t.stateNode;try{Cv(r,o)}catch(c){Fn(t,t.return,c)}}}function Ub(t,r,o){o.props=Eo(t.type,t.memoizedProps),o.state=t.memoizedState;try{o.componentWillUnmount()}catch(c){Fn(t,r,c)}}function _c(t,r){try{var o=t.ref;if(o!==null){switch(t.tag){case 26:case 27:case 5:var c=t.stateNode;break;case 30:c=t.stateNode;break;default:c=t.stateNode}typeof o=="function"?t.refCleanup=o(c):o.current=c}}catch(f){Fn(t,r,f)}}function xa(t,r){var o=t.ref,c=t.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(f){Fn(t,r,f)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(f){Fn(t,r,f)}else o.current=null}function zb(t){var r=t.type,o=t.memoizedProps,c=t.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(f){Fn(t,t.return,f)}}function jm(t,r,o){try{var c=t.stateNode;ST(c,t.type,o,r),c[At]=r}catch(f){Fn(t,t.return,f)}}function Fb(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&Ai(t.type)||t.tag===4}function Em(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Fb(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&Ai(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Sm(t,r,o){var c=t.tag;if(c===5||c===6)t=t.stateNode,r?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(t,r):(r=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,r.appendChild(t),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=A));else if(c!==4&&(c===27&&Ai(t.type)&&(o=t.stateNode,r=null),t=t.child,t!==null))for(Sm(t,r,o),t=t.sibling;t!==null;)Sm(t,r,o),t=t.sibling}function _h(t,r,o){var c=t.tag;if(c===5||c===6)t=t.stateNode,r?o.insertBefore(t,r):o.appendChild(t);else if(c!==4&&(c===27&&Ai(t.type)&&(o=t.stateNode),t=t.child,t!==null))for(_h(t,r,o),t=t.sibling;t!==null;)_h(t,r,o),t=t.sibling}function qb(t){var r=t.stateNode,o=t.memoizedProps;try{for(var c=t.type,f=r.attributes;f.length;)r.removeAttributeNode(f[0]);zs(r,c,o),r[st]=t,r[At]=o}catch(m){Fn(t,t.return,m)}}var Wa=!1,Ss=!1,Nm=!1,Hb=typeof WeakSet=="function"?WeakSet:Set,Ls=null;function iT(t,r){if(t=t.containerInfo,Ym=qh,t=nv(t),wf(t)){if("selectionStart"in t)var o={start:t.selectionStart,end:t.selectionEnd};else e:{o=(o=t.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var f=c.anchorOffset,m=c.focusNode;c=c.focusOffset;try{o.nodeType,m.nodeType}catch{o=null;break e}var b=0,S=-1,B=-1,re=0,xe=0,Re=t,le=null;t:for(;;){for(var de;Re!==o||f!==0&&Re.nodeType!==3||(S=b+f),Re!==m||c!==0&&Re.nodeType!==3||(B=b+c),Re.nodeType===3&&(b+=Re.nodeValue.length),(de=Re.firstChild)!==null;)le=Re,Re=de;for(;;){if(Re===t)break t;if(le===o&&++re===f&&(S=b),le===m&&++xe===c&&(B=b),(de=Re.nextSibling)!==null)break;Re=le,le=Re.parentNode}Re=de}o=S===-1||B===-1?null:{start:S,end:B}}else o=null}o=o||{start:0,end:0}}else o=null;for(Qm={focusedElem:t,selectionRange:o},qh=!1,Ls=r;Ls!==null;)if(r=Ls,t=r.child,(r.subtreeFlags&1028)!==0&&t!==null)t.return=r,Ls=t;else for(;Ls!==null;){switch(r=Ls,m=r.alternate,t=r.flags,r.tag){case 0:if((t&4)!==0&&(t=r.updateQueue,t=t!==null?t.events:null,t!==null))for(o=0;o<t.length;o++)f=t[o],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((t&1024)!==0&&m!==null){t=void 0,o=r,f=m.memoizedProps,m=m.memoizedState,c=o.stateNode;try{var ut=Eo(o.type,f);t=c.getSnapshotBeforeUpdate(ut,m),c.__reactInternalSnapshotBeforeUpdate=t}catch(Mt){Fn(o,o.return,Mt)}}break;case 3:if((t&1024)!==0){if(t=r.stateNode.containerInfo,o=t.nodeType,o===9)Zm(t);else if(o===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":Zm(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(i(163))}if(t=r.sibling,t!==null){t.return=r.return,Ls=t;break}Ls=r.return}}function $b(t,r,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:Ka(t,o),c&4&&wc(5,o);break;case 1:if(Ka(t,o),c&4)if(t=o.stateNode,r===null)try{t.componentDidMount()}catch(b){Fn(o,o.return,b)}else{var f=Eo(o.type,r.memoizedProps);r=r.memoizedState;try{t.componentDidUpdate(f,r,t.__reactInternalSnapshotBeforeUpdate)}catch(b){Fn(o,o.return,b)}}c&64&&Bb(o),c&512&&_c(o,o.return);break;case 3:if(Ka(t,o),c&64&&(t=o.updateQueue,t!==null)){if(r=null,o.child!==null)switch(o.child.tag){case 27:case 5:r=o.child.stateNode;break;case 1:r=o.child.stateNode}try{Cv(t,r)}catch(b){Fn(o,o.return,b)}}break;case 27:r===null&&c&4&&qb(o);case 26:case 5:Ka(t,o),r===null&&c&4&&zb(o),c&512&&_c(o,o.return);break;case 12:Ka(t,o);break;case 31:Ka(t,o),c&4&&Kb(t,o);break;case 13:Ka(t,o),c&4&&Yb(t,o),c&64&&(t=o.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(o=pT.bind(null,o),PT(t,o))));break;case 22:if(c=o.memoizedState!==null||Wa,!c){r=r!==null&&r.memoizedState!==null||Ss,f=Wa;var m=Ss;Wa=c,(Ss=r)&&!m?Ya(t,o,(o.subtreeFlags&8772)!==0):Ka(t,o),Wa=f,Ss=m}break;case 30:break;default:Ka(t,o)}}function Wb(t){var r=t.alternate;r!==null&&(t.alternate=null,Wb(r)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(r=t.stateNode,r!==null&&Ds(r)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var os=null,dr=!1;function Ga(t,r,o){for(o=o.child;o!==null;)Gb(t,r,o),o=o.sibling}function Gb(t,r,o){if(Be&&typeof Be.onCommitFiberUnmount=="function")try{Be.onCommitFiberUnmount(Ye,o)}catch{}switch(o.tag){case 26:Ss||xa(o,r),Ga(t,r,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Ss||xa(o,r);var c=os,f=dr;Ai(o.type)&&(os=o.stateNode,dr=!1),Ga(t,r,o),Ac(o.stateNode),os=c,dr=f;break;case 5:Ss||xa(o,r);case 6:if(c=os,f=dr,os=null,Ga(t,r,o),os=c,dr=f,os!==null)if(dr)try{(os.nodeType===9?os.body:os.nodeName==="HTML"?os.ownerDocument.body:os).removeChild(o.stateNode)}catch(m){Fn(o,r,m)}else try{os.removeChild(o.stateNode)}catch(m){Fn(o,r,m)}break;case 18:os!==null&&(dr?(t=os,B0(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,o.stateNode),jl(t)):B0(os,o.stateNode));break;case 4:c=os,f=dr,os=o.stateNode.containerInfo,dr=!0,Ga(t,r,o),os=c,dr=f;break;case 0:case 11:case 14:case 15:Ti(2,o,r),Ss||Ti(4,o,r),Ga(t,r,o);break;case 1:Ss||(xa(o,r),c=o.stateNode,typeof c.componentWillUnmount=="function"&&Ub(o,r,c)),Ga(t,r,o);break;case 21:Ga(t,r,o);break;case 22:Ss=(c=Ss)||o.memoizedState!==null,Ga(t,r,o),Ss=c;break;default:Ga(t,r,o)}}function Kb(t,r){if(r.memoizedState===null&&(t=r.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{jl(t)}catch(o){Fn(r,r.return,o)}}}function Yb(t,r){if(r.memoizedState===null&&(t=r.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{jl(t)}catch(o){Fn(r,r.return,o)}}function oT(t){switch(t.tag){case 31:case 13:case 19:var r=t.stateNode;return r===null&&(r=t.stateNode=new Hb),r;case 22:return t=t.stateNode,r=t._retryCache,r===null&&(r=t._retryCache=new Hb),r;default:throw Error(i(435,t.tag))}}function kh(t,r){var o=oT(t);r.forEach(function(c){if(!o.has(c)){o.add(c);var f=gT.bind(null,t,c);c.then(f,f)}})}function fr(t,r){var o=r.deletions;if(o!==null)for(var c=0;c<o.length;c++){var f=o[c],m=t,b=r,S=b;e:for(;S!==null;){switch(S.tag){case 27:if(Ai(S.type)){os=S.stateNode,dr=!1;break e}break;case 5:os=S.stateNode,dr=!1;break e;case 3:case 4:os=S.stateNode.containerInfo,dr=!0;break e}S=S.return}if(os===null)throw Error(i(160));Gb(m,b,f),os=null,dr=!1,m=f.alternate,m!==null&&(m.return=null),f.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)Qb(r,t),r=r.sibling}var ra=null;function Qb(t,r){var o=t.alternate,c=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:fr(r,t),mr(t),c&4&&(Ti(3,t,t.return),wc(3,t),Ti(5,t,t.return));break;case 1:fr(r,t),mr(t),c&512&&(Ss||o===null||xa(o,o.return)),c&64&&Wa&&(t=t.updateQueue,t!==null&&(c=t.callbacks,c!==null&&(o=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var f=ra;if(fr(r,t),mr(t),c&512&&(Ss||o===null||xa(o,o.return)),c&4){var m=o!==null?o.memoizedState:null;if(c=t.memoizedState,o===null)if(c===null)if(t.stateNode===null){e:{c=t.type,o=t.memoizedProps,f=f.ownerDocument||f;t:switch(c){case"title":m=f.getElementsByTagName("title")[0],(!m||m[_s]||m[st]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=f.createElement(c),f.head.insertBefore(m,f.querySelector("head > title"))),zs(m,c,o),m[st]=t,C(m),c=m;break e;case"link":var b=Q0("link","href",f).get(c+(o.href||""));if(b){for(var S=0;S<b.length;S++)if(m=b[S],m.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&m.getAttribute("rel")===(o.rel==null?null:o.rel)&&m.getAttribute("title")===(o.title==null?null:o.title)&&m.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){b.splice(S,1);break t}}m=f.createElement(c),zs(m,c,o),f.head.appendChild(m);break;case"meta":if(b=Q0("meta","content",f).get(c+(o.content||""))){for(S=0;S<b.length;S++)if(m=b[S],m.getAttribute("content")===(o.content==null?null:""+o.content)&&m.getAttribute("name")===(o.name==null?null:o.name)&&m.getAttribute("property")===(o.property==null?null:o.property)&&m.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&m.getAttribute("charset")===(o.charSet==null?null:o.charSet)){b.splice(S,1);break t}}m=f.createElement(c),zs(m,c,o),f.head.appendChild(m);break;default:throw Error(i(468,c))}m[st]=t,C(m),c=m}t.stateNode=c}else X0(f,t.type,t.stateNode);else t.stateNode=Y0(f,c,t.memoizedProps);else m!==c?(m===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):m.count--,c===null?X0(f,t.type,t.stateNode):Y0(f,c,t.memoizedProps)):c===null&&t.stateNode!==null&&jm(t,t.memoizedProps,o.memoizedProps)}break;case 27:fr(r,t),mr(t),c&512&&(Ss||o===null||xa(o,o.return)),o!==null&&c&4&&jm(t,t.memoizedProps,o.memoizedProps);break;case 5:if(fr(r,t),mr(t),c&512&&(Ss||o===null||xa(o,o.return)),t.flags&32){f=t.stateNode;try{Kn(f,"")}catch(ut){Fn(t,t.return,ut)}}c&4&&t.stateNode!=null&&(f=t.memoizedProps,jm(t,f,o!==null?o.memoizedProps:f)),c&1024&&(Nm=!0);break;case 6:if(fr(r,t),mr(t),c&4){if(t.stateNode===null)throw Error(i(162));c=t.memoizedProps,o=t.stateNode;try{o.nodeValue=c}catch(ut){Fn(t,t.return,ut)}}break;case 3:if(Bh=null,f=ra,ra=Oh(r.containerInfo),fr(r,t),ra=f,mr(t),c&4&&o!==null&&o.memoizedState.isDehydrated)try{jl(r.containerInfo)}catch(ut){Fn(t,t.return,ut)}Nm&&(Nm=!1,Xb(t));break;case 4:c=ra,ra=Oh(t.stateNode.containerInfo),fr(r,t),mr(t),ra=c;break;case 12:fr(r,t),mr(t);break;case 31:fr(r,t),mr(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,kh(t,c)));break;case 13:fr(r,t),mr(t),t.child.flags&8192&&t.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(jh=Et()),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,kh(t,c)));break;case 22:f=t.memoizedState!==null;var B=o!==null&&o.memoizedState!==null,re=Wa,xe=Ss;if(Wa=re||f,Ss=xe||B,fr(r,t),Ss=xe,Wa=re,mr(t),c&8192)e:for(r=t.stateNode,r._visibility=f?r._visibility&-2:r._visibility|1,f&&(o===null||B||Wa||Ss||So(t)),o=null,r=t;;){if(r.tag===5||r.tag===26){if(o===null){B=o=r;try{if(m=B.stateNode,f)b=m.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{S=B.stateNode;var Re=B.memoizedProps.style,le=Re!=null&&Re.hasOwnProperty("display")?Re.display:null;S.style.display=le==null||typeof le=="boolean"?"":(""+le).trim()}}catch(ut){Fn(B,B.return,ut)}}}else if(r.tag===6){if(o===null){B=r;try{B.stateNode.nodeValue=f?"":B.memoizedProps}catch(ut){Fn(B,B.return,ut)}}}else if(r.tag===18){if(o===null){B=r;try{var de=B.stateNode;f?U0(de,!0):U0(B.stateNode,!1)}catch(ut){Fn(B,B.return,ut)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===t)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break e;for(;r.sibling===null;){if(r.return===null||r.return===t)break e;o===r&&(o=null),r=r.return}o===r&&(o=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=t.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,kh(t,o))));break;case 19:fr(r,t),mr(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,kh(t,c)));break;case 30:break;case 21:break;default:fr(r,t),mr(t)}}function mr(t){var r=t.flags;if(r&2){try{for(var o,c=t.return;c!==null;){if(Fb(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var f=o.stateNode,m=Em(t);_h(t,m,f);break;case 5:var b=o.stateNode;o.flags&32&&(Kn(b,""),o.flags&=-33);var S=Em(t);_h(t,S,b);break;case 3:case 4:var B=o.stateNode.containerInfo,re=Em(t);Sm(t,re,B);break;default:throw Error(i(161))}}catch(xe){Fn(t,t.return,xe)}t.flags&=-3}r&4096&&(t.flags&=-4097)}function Xb(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var r=t;Xb(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),t=t.sibling}}function Ka(t,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)$b(t,r.alternate,r),r=r.sibling}function So(t){for(t=t.child;t!==null;){var r=t;switch(r.tag){case 0:case 11:case 14:case 15:Ti(4,r,r.return),So(r);break;case 1:xa(r,r.return);var o=r.stateNode;typeof o.componentWillUnmount=="function"&&Ub(r,r.return,o),So(r);break;case 27:Ac(r.stateNode);case 26:case 5:xa(r,r.return),So(r);break;case 22:r.memoizedState===null&&So(r);break;case 30:So(r);break;default:So(r)}t=t.sibling}}function Ya(t,r,o){for(o=o&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,f=t,m=r,b=m.flags;switch(m.tag){case 0:case 11:case 15:Ya(f,m,o),wc(4,m);break;case 1:if(Ya(f,m,o),c=m,f=c.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(re){Fn(c,c.return,re)}if(c=m,f=c.updateQueue,f!==null){var S=c.stateNode;try{var B=f.shared.hiddenCallbacks;if(B!==null)for(f.shared.hiddenCallbacks=null,f=0;f<B.length;f++)Nv(B[f],S)}catch(re){Fn(c,c.return,re)}}o&&b&64&&Bb(m),_c(m,m.return);break;case 27:qb(m);case 26:case 5:Ya(f,m,o),o&&c===null&&b&4&&zb(m),_c(m,m.return);break;case 12:Ya(f,m,o);break;case 31:Ya(f,m,o),o&&b&4&&Kb(f,m);break;case 13:Ya(f,m,o),o&&b&4&&Yb(f,m);break;case 22:m.memoizedState===null&&Ya(f,m,o),_c(m,m.return);break;case 30:break;default:Ya(f,m,o)}r=r.sibling}}function Cm(t,r){var o=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(o=t.memoizedState.cachePool.pool),t=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(t=r.memoizedState.cachePool.pool),t!==o&&(t!=null&&t.refCount++,o!=null&&lc(o))}function Rm(t,r){t=null,r.alternate!==null&&(t=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==t&&(r.refCount++,t!=null&&lc(t))}function aa(t,r,o,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Jb(t,r,o,c),r=r.sibling}function Jb(t,r,o,c){var f=r.flags;switch(r.tag){case 0:case 11:case 15:aa(t,r,o,c),f&2048&&wc(9,r);break;case 1:aa(t,r,o,c);break;case 3:aa(t,r,o,c),f&2048&&(t=null,r.alternate!==null&&(t=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==t&&(r.refCount++,t!=null&&lc(t)));break;case 12:if(f&2048){aa(t,r,o,c),t=r.stateNode;try{var m=r.memoizedProps,b=m.id,S=m.onPostCommit;typeof S=="function"&&S(b,r.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(B){Fn(r,r.return,B)}}else aa(t,r,o,c);break;case 31:aa(t,r,o,c);break;case 13:aa(t,r,o,c);break;case 23:break;case 22:m=r.stateNode,b=r.alternate,r.memoizedState!==null?m._visibility&2?aa(t,r,o,c):kc(t,r):m._visibility&2?aa(t,r,o,c):(m._visibility|=2,ml(t,r,o,c,(r.subtreeFlags&10256)!==0||!1)),f&2048&&Cm(b,r);break;case 24:aa(t,r,o,c),f&2048&&Rm(r.alternate,r);break;default:aa(t,r,o,c)}}function ml(t,r,o,c,f){for(f=f&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var m=t,b=r,S=o,B=c,re=b.flags;switch(b.tag){case 0:case 11:case 15:ml(m,b,S,B,f),wc(8,b);break;case 23:break;case 22:var xe=b.stateNode;b.memoizedState!==null?xe._visibility&2?ml(m,b,S,B,f):kc(m,b):(xe._visibility|=2,ml(m,b,S,B,f)),f&&re&2048&&Cm(b.alternate,b);break;case 24:ml(m,b,S,B,f),f&&re&2048&&Rm(b.alternate,b);break;default:ml(m,b,S,B,f)}r=r.sibling}}function kc(t,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var o=t,c=r,f=c.flags;switch(c.tag){case 22:kc(o,c),f&2048&&Cm(c.alternate,c);break;case 24:kc(o,c),f&2048&&Rm(c.alternate,c);break;default:kc(o,c)}r=r.sibling}}var Tc=8192;function pl(t,r,o){if(t.subtreeFlags&Tc)for(t=t.child;t!==null;)Zb(t,r,o),t=t.sibling}function Zb(t,r,o){switch(t.tag){case 26:pl(t,r,o),t.flags&Tc&&t.memoizedState!==null&&GT(o,ra,t.memoizedState,t.memoizedProps);break;case 5:pl(t,r,o);break;case 3:case 4:var c=ra;ra=Oh(t.stateNode.containerInfo),pl(t,r,o),ra=c;break;case 22:t.memoizedState===null&&(c=t.alternate,c!==null&&c.memoizedState!==null?(c=Tc,Tc=16777216,pl(t,r,o),Tc=c):pl(t,r,o));break;default:pl(t,r,o)}}function e0(t){var r=t.alternate;if(r!==null&&(t=r.child,t!==null)){r.child=null;do r=t.sibling,t.sibling=null,t=r;while(t!==null)}}function jc(t){var r=t.deletions;if((t.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];Ls=c,n0(c,t)}e0(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)t0(t),t=t.sibling}function t0(t){switch(t.tag){case 0:case 11:case 15:jc(t),t.flags&2048&&Ti(9,t,t.return);break;case 3:jc(t);break;case 12:jc(t);break;case 22:var r=t.stateNode;t.memoizedState!==null&&r._visibility&2&&(t.return===null||t.return.tag!==13)?(r._visibility&=-3,Th(t)):jc(t);break;default:jc(t)}}function Th(t){var r=t.deletions;if((t.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];Ls=c,n0(c,t)}e0(t)}for(t=t.child;t!==null;){switch(r=t,r.tag){case 0:case 11:case 15:Ti(8,r,r.return),Th(r);break;case 22:o=r.stateNode,o._visibility&2&&(o._visibility&=-3,Th(r));break;default:Th(r)}t=t.sibling}}function n0(t,r){for(;Ls!==null;){var o=Ls;switch(o.tag){case 0:case 11:case 15:Ti(8,o,r);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:lc(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,Ls=c;else e:for(o=t;Ls!==null;){c=Ls;var f=c.sibling,m=c.return;if(Wb(c),c===o){Ls=null;break e}if(f!==null){f.return=m,Ls=f;break e}Ls=m}}}var lT={getCacheForType:function(t){var r=Bs(Ts),o=r.data.get(t);return o===void 0&&(o=t(),r.data.set(t,o)),o},cacheSignal:function(){return Bs(Ts).controller.signal}},cT=typeof WeakMap=="function"?WeakMap:Map,Dn=0,Yn=null,on=null,hn=0,zn=0,Rr=null,ji=!1,gl=!1,Am=!1,Qa=0,fs=0,Ei=0,No=0,Im=0,Ar=0,yl=0,Ec=null,pr=null,Mm=!1,jh=0,s0=0,Eh=1/0,Sh=null,Si=null,Is=0,Ni=null,vl=null,Xa=0,Dm=0,Pm=null,r0=null,Sc=0,Lm=null;function Ir(){return(Dn&2)!==0&&hn!==0?hn&-hn:Q.T!==null?Fm():we()}function a0(){if(Ar===0)if((hn&536870912)===0||_n){var t=Qe;Qe<<=1,(Qe&3932160)===0&&(Qe=262144),Ar=t}else Ar=536870912;return t=Nr.current,t!==null&&(t.flags|=32),Ar}function gr(t,r,o){(t===Yn&&(zn===2||zn===9)||t.cancelPendingCommit!==null)&&(bl(t,0),Ci(t,hn,Ar,!1)),rn(t,o),((Dn&2)===0||t!==Yn)&&(t===Yn&&((Dn&2)===0&&(No|=o),fs===4&&Ci(t,hn,Ar,!1)),wa(t))}function i0(t,r,o){if((Dn&6)!==0)throw Error(i(327));var c=!o&&(r&127)===0&&(r&t.expiredLanes)===0||Rt(t,r),f=c?dT(t,r):Vm(t,r,!0),m=c;do{if(f===0){gl&&!c&&Ci(t,r,0,!1);break}else{if(o=t.current.alternate,m&&!uT(o)){f=Vm(t,r,!1),m=!1;continue}if(f===2){if(m=r,t.errorRecoveryDisabledLanes&m)var b=0;else b=t.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){r=b;e:{var S=t;f=Ec;var B=S.current.memoizedState.isDehydrated;if(B&&(bl(S,b).flags|=256),b=Vm(S,b,!1),b!==2){if(Am&&!B){S.errorRecoveryDisabledLanes|=m,No|=m,f=4;break e}m=pr,pr=f,m!==null&&(pr===null?pr=m:pr.push.apply(pr,m))}f=b}if(m=!1,f!==2)continue}}if(f===1){bl(t,0),Ci(t,r,0,!0);break}e:{switch(c=t,m=f,m){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:Ci(c,r,Ar,!ji);break e;case 2:pr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(f=jh+300-Et(),10<f)){if(Ci(c,r,Ar,!ji),Ft(c,0,!0)!==0)break e;Xa=r,c.timeoutHandle=O0(o0.bind(null,c,o,pr,Sh,Mm,r,Ar,No,yl,ji,m,"Throttled",-0,0),f);break e}o0(c,o,pr,Sh,Mm,r,Ar,No,yl,ji,m,null,-0,0)}}break}while(!0);wa(t)}function o0(t,r,o,c,f,m,b,S,B,re,xe,Re,le,de){if(t.timeoutHandle=-1,Re=r.subtreeFlags,Re&8192||(Re&16785408)===16785408){Re={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:A},Zb(r,m,Re);var ut=(m&62914560)===m?jh-Et():(m&4194048)===m?s0-Et():0;if(ut=KT(Re,ut),ut!==null){Xa=m,t.cancelPendingCommit=ut(p0.bind(null,t,r,m,o,c,f,b,S,B,xe,Re,null,le,de)),Ci(t,m,b,!re);return}}p0(t,r,m,o,c,f,b,S,B)}function uT(t){for(var r=t;;){var o=r.tag;if((o===0||o===11||o===15)&&r.flags&16384&&(o=r.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var f=o[c],m=f.getSnapshot;f=f.value;try{if(!Er(m(),f))return!1}catch{return!1}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Ci(t,r,o,c){r&=~Im,r&=~No,t.suspendedLanes|=r,t.pingedLanes&=~r,c&&(t.warmLanes|=r),c=t.expirationTimes;for(var f=r;0<f;){var m=31-Le(f),b=1<<m;c[m]=-1,f&=~b}o!==0&&In(t,o,r)}function Nh(){return(Dn&6)===0?(Nc(0),!1):!0}function Om(){if(on!==null){if(zn===0)var t=on.return;else t=on,Ua=bo=null,Zf(t),cl=null,uc=0,t=on;for(;t!==null;)Vb(t.alternate,t),t=t.return;on=null}}function bl(t,r){var o=t.timeoutHandle;o!==-1&&(t.timeoutHandle=-1,RT(o)),o=t.cancelPendingCommit,o!==null&&(t.cancelPendingCommit=null,o()),Xa=0,Om(),Yn=t,on=o=Va(t.current,null),hn=r,zn=0,Rr=null,ji=!1,gl=Rt(t,r),Am=!1,yl=Ar=Im=No=Ei=fs=0,pr=Ec=null,Mm=!1,(r&8)!==0&&(r|=r&32);var c=t.entangledLanes;if(c!==0)for(t=t.entanglements,c&=r;0<c;){var f=31-Le(c),m=1<<f;r|=t[f],c&=~m}return Qa=r,Yu(),o}function l0(t,r){en=null,Q.H=vc,r===ll||r===sh?(r=Tv(),zn=3):r===zf?(r=Tv(),zn=4):zn=r===pm?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Rr=r,on===null&&(fs=1,yh(t,Ur(r,t.current)))}function c0(){var t=Nr.current;return t===null?!0:(hn&4194048)===hn?Hr===null:(hn&62914560)===hn||(hn&536870912)!==0?t===Hr:!1}function u0(){var t=Q.H;return Q.H=vc,t===null?vc:t}function h0(){var t=Q.A;return Q.A=lT,t}function Ch(){fs=4,ji||(hn&4194048)!==hn&&Nr.current!==null||(gl=!0),(Ei&134217727)===0&&(No&134217727)===0||Yn===null||Ci(Yn,hn,Ar,!1)}function Vm(t,r,o){var c=Dn;Dn|=2;var f=u0(),m=h0();(Yn!==t||hn!==r)&&(Sh=null,bl(t,r)),r=!1;var b=fs;e:do try{if(zn!==0&&on!==null){var S=on,B=Rr;switch(zn){case 8:Om(),b=6;break e;case 3:case 2:case 9:case 6:Nr.current===null&&(r=!0);var re=zn;if(zn=0,Rr=null,xl(t,S,B,re),o&&gl){b=0;break e}break;default:re=zn,zn=0,Rr=null,xl(t,S,B,re)}}hT(),b=fs;break}catch(xe){l0(t,xe)}while(!0);return r&&t.shellSuspendCounter++,Ua=bo=null,Dn=c,Q.H=f,Q.A=m,on===null&&(Yn=null,hn=0,Yu()),b}function hT(){for(;on!==null;)d0(on)}function dT(t,r){var o=Dn;Dn|=2;var c=u0(),f=h0();Yn!==t||hn!==r?(Sh=null,Eh=Et()+500,bl(t,r)):gl=Rt(t,r);e:do try{if(zn!==0&&on!==null){r=on;var m=Rr;t:switch(zn){case 1:zn=0,Rr=null,xl(t,r,m,1);break;case 2:case 9:if(_v(m)){zn=0,Rr=null,f0(r);break}r=function(){zn!==2&&zn!==9||Yn!==t||(zn=7),wa(t)},m.then(r,r);break e;case 3:zn=7;break e;case 4:zn=5;break e;case 7:_v(m)?(zn=0,Rr=null,f0(r)):(zn=0,Rr=null,xl(t,r,m,7));break;case 5:var b=null;switch(on.tag){case 26:b=on.memoizedState;case 5:case 27:var S=on;if(b?J0(b):S.stateNode.complete){zn=0,Rr=null;var B=S.sibling;if(B!==null)on=B;else{var re=S.return;re!==null?(on=re,Rh(re)):on=null}break t}}zn=0,Rr=null,xl(t,r,m,5);break;case 6:zn=0,Rr=null,xl(t,r,m,6);break;case 8:Om(),fs=6;break e;default:throw Error(i(462))}}fT();break}catch(xe){l0(t,xe)}while(!0);return Ua=bo=null,Q.H=c,Q.A=f,Dn=o,on!==null?0:(Yn=null,hn=0,Yu(),fs)}function fT(){for(;on!==null&&!ss();)d0(on)}function d0(t){var r=Lb(t.alternate,t,Qa);t.memoizedProps=t.pendingProps,r===null?Rh(t):on=r}function f0(t){var r=t,o=r.alternate;switch(r.tag){case 15:case 0:r=Rb(o,r,r.pendingProps,r.type,void 0,hn);break;case 11:r=Rb(o,r,r.pendingProps,r.type.render,r.ref,hn);break;case 5:Zf(r);default:Vb(o,r),r=on=hv(r,Qa),r=Lb(o,r,Qa)}t.memoizedProps=t.pendingProps,r===null?Rh(t):on=r}function xl(t,r,o,c){Ua=bo=null,Zf(r),cl=null,uc=0;var f=r.return;try{if(tT(t,f,r,o,hn)){fs=1,yh(t,Ur(o,t.current)),on=null;return}}catch(m){if(f!==null)throw on=f,m;fs=1,yh(t,Ur(o,t.current)),on=null;return}r.flags&32768?(_n||c===1?t=!0:gl||(hn&536870912)!==0?t=!1:(ji=t=!0,(c===2||c===9||c===3||c===6)&&(c=Nr.current,c!==null&&c.tag===13&&(c.flags|=16384))),m0(r,t)):Rh(r)}function Rh(t){var r=t;do{if((r.flags&32768)!==0){m0(r,ji);return}t=r.return;var o=rT(r.alternate,r,Qa);if(o!==null){on=o;return}if(r=r.sibling,r!==null){on=r;return}on=r=t}while(r!==null);fs===0&&(fs=5)}function m0(t,r){do{var o=aT(t.alternate,t);if(o!==null){o.flags&=32767,on=o;return}if(o=t.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!r&&(t=t.sibling,t!==null)){on=t;return}on=t=o}while(t!==null);fs=6,on=null}function p0(t,r,o,c,f,m,b,S,B){t.cancelPendingCommit=null;do Ah();while(Is!==0);if((Dn&6)!==0)throw Error(i(327));if(r!==null){if(r===t.current)throw Error(i(177));if(m=r.lanes|r.childLanes,m|=Ef,yn(t,o,m,b,S,B),t===Yn&&(on=Yn=null,hn=0),vl=r,Ni=t,Xa=o,Dm=m,Pm=f,r0=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,yT(Kt,function(){return x0(),null})):(t.callbackNode=null,t.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=Q.T,Q.T=null,f=je.p,je.p=2,b=Dn,Dn|=4;try{iT(t,r,o)}finally{Dn=b,je.p=f,Q.T=c}}Is=1,g0(),y0(),v0()}}function g0(){if(Is===1){Is=0;var t=Ni,r=vl,o=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||o){o=Q.T,Q.T=null;var c=je.p;je.p=2;var f=Dn;Dn|=4;try{Qb(r,t);var m=Qm,b=nv(t.containerInfo),S=m.focusedElem,B=m.selectionRange;if(b!==S&&S&&S.ownerDocument&&tv(S.ownerDocument.documentElement,S)){if(B!==null&&wf(S)){var re=B.start,xe=B.end;if(xe===void 0&&(xe=re),"selectionStart"in S)S.selectionStart=re,S.selectionEnd=Math.min(xe,S.value.length);else{var Re=S.ownerDocument||document,le=Re&&Re.defaultView||window;if(le.getSelection){var de=le.getSelection(),ut=S.textContent.length,Mt=Math.min(B.start,ut),Wn=B.end===void 0?Mt:Math.min(B.end,ut);!de.extend&&Mt>Wn&&(b=Wn,Wn=Mt,Mt=b);var X=ev(S,Mt),W=ev(S,Wn);if(X&&W&&(de.rangeCount!==1||de.anchorNode!==X.node||de.anchorOffset!==X.offset||de.focusNode!==W.node||de.focusOffset!==W.offset)){var se=Re.createRange();se.setStart(X.node,X.offset),de.removeAllRanges(),Mt>Wn?(de.addRange(se),de.extend(W.node,W.offset)):(se.setEnd(W.node,W.offset),de.addRange(se))}}}}for(Re=[],de=S;de=de.parentNode;)de.nodeType===1&&Re.push({element:de,left:de.scrollLeft,top:de.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<Re.length;S++){var ke=Re[S];ke.element.scrollLeft=ke.left,ke.element.scrollTop=ke.top}}qh=!!Ym,Qm=Ym=null}finally{Dn=f,je.p=c,Q.T=o}}t.current=r,Is=2}}function y0(){if(Is===2){Is=0;var t=Ni,r=vl,o=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||o){o=Q.T,Q.T=null;var c=je.p;je.p=2;var f=Dn;Dn|=4;try{$b(t,r.alternate,r)}finally{Dn=f,je.p=c,Q.T=o}}Is=3}}function v0(){if(Is===4||Is===3){Is=0,Pt();var t=Ni,r=vl,o=Xa,c=r0;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Is=5:(Is=0,vl=Ni=null,b0(t,t.pendingLanes));var f=t.pendingLanes;if(f===0&&(Si=null),pe(o),r=r.stateNode,Be&&typeof Be.onCommitFiberRoot=="function")try{Be.onCommitFiberRoot(Ye,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=Q.T,f=je.p,je.p=2,Q.T=null;try{for(var m=t.onRecoverableError,b=0;b<c.length;b++){var S=c[b];m(S.value,{componentStack:S.stack})}}finally{Q.T=r,je.p=f}}(Xa&3)!==0&&Ah(),wa(t),f=t.pendingLanes,(o&261930)!==0&&(f&42)!==0?t===Lm?Sc++:(Sc=0,Lm=t):Sc=0,Nc(0)}}function b0(t,r){(t.pooledCacheLanes&=r)===0&&(r=t.pooledCache,r!=null&&(t.pooledCache=null,lc(r)))}function Ah(){return g0(),y0(),v0(),x0()}function x0(){if(Is!==5)return!1;var t=Ni,r=Dm;Dm=0;var o=pe(Xa),c=Q.T,f=je.p;try{je.p=32>o?32:o,Q.T=null,o=Pm,Pm=null;var m=Ni,b=Xa;if(Is=0,vl=Ni=null,Xa=0,(Dn&6)!==0)throw Error(i(331));var S=Dn;if(Dn|=4,t0(m.current),Jb(m,m.current,b,o),Dn=S,Nc(0,!1),Be&&typeof Be.onPostCommitFiberRoot=="function")try{Be.onPostCommitFiberRoot(Ye,m)}catch{}return!0}finally{je.p=f,Q.T=c,b0(t,r)}}function w0(t,r,o){r=Ur(o,r),r=mm(t.stateNode,r,2),t=wi(t,r,2),t!==null&&(rn(t,2),wa(t))}function Fn(t,r,o){if(t.tag===3)w0(t,t,o);else for(;r!==null;){if(r.tag===3){w0(r,t,o);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Si===null||!Si.has(c))){t=Ur(o,t),o=_b(2),c=wi(r,o,2),c!==null&&(kb(o,c,r,t),rn(c,2),wa(c));break}}r=r.return}}function Bm(t,r,o){var c=t.pingCache;if(c===null){c=t.pingCache=new cT;var f=new Set;c.set(r,f)}else f=c.get(r),f===void 0&&(f=new Set,c.set(r,f));f.has(o)||(Am=!0,f.add(o),t=mT.bind(null,t,r,o),r.then(t,t))}function mT(t,r,o){var c=t.pingCache;c!==null&&c.delete(r),t.pingedLanes|=t.suspendedLanes&o,t.warmLanes&=~o,Yn===t&&(hn&o)===o&&(fs===4||fs===3&&(hn&62914560)===hn&&300>Et()-jh?(Dn&2)===0&&bl(t,0):Im|=o,yl===hn&&(yl=0)),wa(t)}function _0(t,r){r===0&&(r=Vn()),t=go(t,r),t!==null&&(rn(t,r),wa(t))}function pT(t){var r=t.memoizedState,o=0;r!==null&&(o=r.retryLane),_0(t,o)}function gT(t,r){var o=0;switch(t.tag){case 31:case 13:var c=t.stateNode,f=t.memoizedState;f!==null&&(o=f.retryLane);break;case 19:c=t.stateNode;break;case 22:c=t.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(r),_0(t,o)}function yT(t,r){return et(t,r)}var Ih=null,wl=null,Um=!1,Mh=!1,zm=!1,Ri=0;function wa(t){t!==wl&&t.next===null&&(wl===null?Ih=wl=t:wl=wl.next=t),Mh=!0,Um||(Um=!0,bT())}function Nc(t,r){if(!zm&&Mh){zm=!0;do for(var o=!1,c=Ih;c!==null;){if(t!==0){var f=c.pendingLanes;if(f===0)var m=0;else{var b=c.suspendedLanes,S=c.pingedLanes;m=(1<<31-Le(42|t)+1)-1,m&=f&~(b&~S),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(o=!0,E0(c,m))}else m=hn,m=Ft(c,c===Yn?m:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(m&3)===0||Rt(c,m)||(o=!0,E0(c,m));c=c.next}while(o);zm=!1}}function vT(){k0()}function k0(){Mh=Um=!1;var t=0;Ri!==0&&CT()&&(t=Ri);for(var r=Et(),o=null,c=Ih;c!==null;){var f=c.next,m=T0(c,r);m===0?(c.next=null,o===null?Ih=f:o.next=f,f===null&&(wl=o)):(o=c,(t!==0||(m&3)!==0)&&(Mh=!0)),c=f}Is!==0&&Is!==5||Nc(t),Ri!==0&&(Ri=0)}function T0(t,r){for(var o=t.suspendedLanes,c=t.pingedLanes,f=t.expirationTimes,m=t.pendingLanes&-62914561;0<m;){var b=31-Le(m),S=1<<b,B=f[b];B===-1?((S&o)===0||(S&c)!==0)&&(f[b]=nn(S,r)):B<=r&&(t.expiredLanes|=S),m&=~S}if(r=Yn,o=hn,o=Ft(t,t===r?o:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),c=t.callbackNode,o===0||t===r&&(zn===2||zn===9)||t.cancelPendingCommit!==null)return c!==null&&c!==null&&tn(c),t.callbackNode=null,t.callbackPriority=0;if((o&3)===0||Rt(t,o)){if(r=o&-o,r===t.callbackPriority)return r;switch(c!==null&&tn(c),pe(o)){case 2:case 8:o=Sn;break;case 32:o=Kt;break;case 268435456:o=me;break;default:o=Kt}return c=j0.bind(null,t),o=et(o,c),t.callbackPriority=r,t.callbackNode=o,r}return c!==null&&c!==null&&tn(c),t.callbackPriority=2,t.callbackNode=null,2}function j0(t,r){if(Is!==0&&Is!==5)return t.callbackNode=null,t.callbackPriority=0,null;var o=t.callbackNode;if(Ah()&&t.callbackNode!==o)return null;var c=hn;return c=Ft(t,t===Yn?c:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),c===0?null:(i0(t,c,r),T0(t,Et()),t.callbackNode!=null&&t.callbackNode===o?j0.bind(null,t):null)}function E0(t,r){if(Ah())return null;i0(t,r,!0)}function bT(){AT(function(){(Dn&6)!==0?et(zt,vT):k0()})}function Fm(){if(Ri===0){var t=il;t===0&&(t=Ne,Ne<<=1,(Ne&261888)===0&&(Ne=256)),Ri=t}return Ri}function S0(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:pa(""+t)}function N0(t,r){var o=r.ownerDocument.createElement("input");return o.name=r.name,o.value=r.value,t.id&&o.setAttribute("form",t.id),r.parentNode.insertBefore(o,r),t=new FormData(t),o.parentNode.removeChild(o),t}function xT(t,r,o,c,f){if(r==="submit"&&o&&o.stateNode===f){var m=S0((f[At]||null).action),b=c.submitter;b&&(r=(r=b[At]||null)?S0(r.formAction):b.getAttribute("formAction"),r!==null&&(m=r,b=null));var S=new tr("action","action",null,c,f);t.push({event:S,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Ri!==0){var B=b?N0(f,b):new FormData(f);lm(o,{pending:!0,data:B,method:f.method,action:m},null,B)}}else typeof m=="function"&&(S.preventDefault(),B=b?N0(f,b):new FormData(f),lm(o,{pending:!0,data:B,method:f.method,action:m},m,B))},currentTarget:f}]})}}for(var qm=0;qm<jf.length;qm++){var Hm=jf[qm],wT=Hm.toLowerCase(),_T=Hm[0].toUpperCase()+Hm.slice(1);sa(wT,"on"+_T)}sa(av,"onAnimationEnd"),sa(iv,"onAnimationIteration"),sa(ov,"onAnimationStart"),sa("dblclick","onDoubleClick"),sa("focusin","onFocus"),sa("focusout","onBlur"),sa(Vk,"onTransitionRun"),sa(Bk,"onTransitionStart"),sa(Uk,"onTransitionCancel"),sa(lv,"onTransitionEnd"),Ue("onMouseEnter",["mouseout","mouseover"]),Ue("onMouseLeave",["mouseout","mouseover"]),Ue("onPointerEnter",["pointerout","pointerover"]),Ue("onPointerLeave",["pointerout","pointerover"]),He("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),He("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),He("onBeforeInput",["compositionend","keypress","textInput","paste"]),He("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),He("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),He("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Cc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),kT=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Cc));function C0(t,r){r=(r&4)!==0;for(var o=0;o<t.length;o++){var c=t[o],f=c.event;c=c.listeners;e:{var m=void 0;if(r)for(var b=c.length-1;0<=b;b--){var S=c[b],B=S.instance,re=S.currentTarget;if(S=S.listener,B!==m&&f.isPropagationStopped())break e;m=S,f.currentTarget=re;try{m(f)}catch(xe){Ku(xe)}f.currentTarget=null,m=B}else for(b=0;b<c.length;b++){if(S=c[b],B=S.instance,re=S.currentTarget,S=S.listener,B!==m&&f.isPropagationStopped())break e;m=S,f.currentTarget=re;try{m(f)}catch(xe){Ku(xe)}f.currentTarget=null,m=B}}}}function ln(t,r){var o=r[_t];o===void 0&&(o=r[_t]=new Set);var c=t+"__bubble";o.has(c)||(R0(r,t,2,!1),o.add(c))}function $m(t,r,o){var c=0;r&&(c|=4),R0(o,t,c,r)}var Dh="_reactListening"+Math.random().toString(36).slice(2);function Wm(t){if(!t[Dh]){t[Dh]=!0,K.forEach(function(o){o!=="selectionchange"&&(kT.has(o)||$m(o,!1,t),$m(o,!0,t))});var r=t.nodeType===9?t:t.ownerDocument;r===null||r[Dh]||(r[Dh]=!0,$m("selectionchange",!1,r))}}function R0(t,r,o,c){switch(a1(r)){case 2:var f=XT;break;case 8:f=JT;break;default:f=op}o=f.bind(null,r,o,t),f=void 0,!Jt||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(f=!0),c?f!==void 0?t.addEventListener(r,o,{capture:!0,passive:f}):t.addEventListener(r,o,!0):f!==void 0?t.addEventListener(r,o,{passive:f}):t.addEventListener(r,o,!1)}function Gm(t,r,o,c,f){var m=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var b=c.tag;if(b===3||b===4){var S=c.stateNode.containerInfo;if(S===f)break;if(b===4)for(b=c.return;b!==null;){var B=b.tag;if((B===3||B===4)&&b.stateNode.containerInfo===f)return;b=b.return}for(;S!==null;){if(b=Bn(S),b===null)return;if(B=b.tag,B===5||B===6||B===26||B===27){c=m=b;continue e}S=S.parentNode}}c=c.return}Lt(function(){var re=m,xe=De(o),Re=[];e:{var le=cv.get(t);if(le!==void 0){var de=tr,ut=t;switch(t){case"keypress":if(ks(o)===0)break e;case"keydown":case"keyup":de=$u;break;case"focusin":ut="focus",de=ho;break;case"focusout":ut="blur",de=ho;break;case"beforeblur":case"afterblur":de=ho;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":de=uo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":de=Zr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":de=v;break;case av:case iv:case ov:de=Vu;break;case lv:de=N;break;case"scroll":case"scrollend":de=Ws;break;case"wheel":de=ue;break;case"copy":case"cut":case"paste":de=Bu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":de=Oa;break;case"toggle":case"beforetoggle":de=Zt}var Mt=(r&4)!==0,Wn=!Mt&&(t==="scroll"||t==="scrollend"),X=Mt?le!==null?le+"Capture":null:le;Mt=[];for(var W=re,se;W!==null;){var ke=W;if(se=ke.stateNode,ke=ke.tag,ke!==5&&ke!==26&&ke!==27||se===null||X===null||(ke=Dt(W,X),ke!=null&&Mt.push(Rc(W,ke,se))),Wn)break;W=W.return}0<Mt.length&&(le=new de(le,ut,null,o,xe),Re.push({event:le,listeners:Mt}))}}if((r&7)===0){e:{if(le=t==="mouseover"||t==="pointerover",de=t==="mouseout"||t==="pointerout",le&&o!==Z&&(ut=o.relatedTarget||o.fromElement)&&(Bn(ut)||ut[ct]))break e;if((de||le)&&(le=xe.window===xe?xe:(le=xe.ownerDocument)?le.defaultView||le.parentWindow:window,de?(ut=o.relatedTarget||o.toElement,de=re,ut=ut?Bn(ut):null,ut!==null&&(Wn=u(ut),Mt=ut.tag,ut!==Wn||Mt!==5&&Mt!==27&&Mt!==6)&&(ut=null)):(de=null,ut=re),de!==ut)){if(Mt=uo,ke="onMouseLeave",X="onMouseEnter",W="mouse",(t==="pointerout"||t==="pointerover")&&(Mt=Oa,ke="onPointerLeave",X="onPointerEnter",W="pointer"),Wn=de==null?le:ce(de),se=ut==null?le:ce(ut),le=new Mt(ke,W+"leave",de,o,xe),le.target=Wn,le.relatedTarget=se,ke=null,Bn(xe)===re&&(Mt=new Mt(X,W+"enter",ut,o,xe),Mt.target=se,Mt.relatedTarget=Wn,ke=Mt),Wn=ke,de&&ut)t:{for(Mt=TT,X=de,W=ut,se=0,ke=X;ke;ke=Mt(ke))se++;ke=0;for(var Tt=W;Tt;Tt=Mt(Tt))ke++;for(;0<se-ke;)X=Mt(X),se--;for(;0<ke-se;)W=Mt(W),ke--;for(;se--;){if(X===W||W!==null&&X===W.alternate){Mt=X;break t}X=Mt(X),W=Mt(W)}Mt=null}else Mt=null;de!==null&&A0(Re,le,de,Mt,!1),ut!==null&&Wn!==null&&A0(Re,Wn,ut,Mt,!0)}}e:{if(le=re?ce(re):window,de=le.nodeName&&le.nodeName.toLowerCase(),de==="select"||de==="input"&&le.type==="file")var Cn=Ky;else if(Wy(le))if(Yy)Cn=Pk;else{Cn=Mk;var yt=Ik}else de=le.nodeName,!de||de.toLowerCase()!=="input"||le.type!=="checkbox"&&le.type!=="radio"?re&&Ps(re.elementType)&&(Cn=Ky):Cn=Dk;if(Cn&&(Cn=Cn(t,re))){Gy(Re,Cn,o,xe);break e}yt&&yt(t,le,re),t==="focusout"&&re&&le.type==="number"&&re.memoizedProps.value!=null&&Jr(le,"number",le.value)}switch(yt=re?ce(re):window,t){case"focusin":(Wy(yt)||yt.contentEditable==="true")&&(Jo=yt,_f=re,ac=null);break;case"focusout":ac=_f=Jo=null;break;case"mousedown":kf=!0;break;case"contextmenu":case"mouseup":case"dragend":kf=!1,sv(Re,o,xe);break;case"selectionchange":if(Ok)break;case"keydown":case"keyup":sv(Re,o,xe)}var sn;if(Mn)e:{switch(t){case"compositionstart":var dn="onCompositionStart";break e;case"compositionend":dn="onCompositionEnd";break e;case"compositionupdate":dn="onCompositionUpdate";break e}dn=void 0}else Xo?fo(t,o)&&(dn="onCompositionEnd"):t==="keydown"&&o.keyCode===229&&(dn="onCompositionStart");dn&&(ya&&o.locale!=="ko"&&(Xo||dn!=="onCompositionStart"?dn==="onCompositionEnd"&&Xo&&(sn=cs()):(kn=xe,Zn="value"in kn?kn.value:kn.textContent,Xo=!0)),yt=Ph(re,dn),0<yt.length&&(dn=new ga(dn,t,null,o,xe),Re.push({event:dn,listeners:yt}),sn?dn.data=sn:(sn=Qo(o),sn!==null&&(dn.data=sn)))),(sn=Vr?Nk(t,o):Ck(t,o))&&(dn=Ph(re,"onBeforeInput"),0<dn.length&&(yt=new ga("onBeforeInput","beforeinput",null,o,xe),Re.push({event:yt,listeners:dn}),yt.data=sn)),xT(Re,t,re,o,xe)}C0(Re,r)})}function Rc(t,r,o){return{instance:t,listener:r,currentTarget:o}}function Ph(t,r){for(var o=r+"Capture",c=[];t!==null;){var f=t,m=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||m===null||(f=Dt(t,o),f!=null&&c.unshift(Rc(t,f,m)),f=Dt(t,r),f!=null&&c.push(Rc(t,f,m))),t.tag===3)return c;t=t.return}return[]}function TT(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function A0(t,r,o,c,f){for(var m=r._reactName,b=[];o!==null&&o!==c;){var S=o,B=S.alternate,re=S.stateNode;if(S=S.tag,B!==null&&B===c)break;S!==5&&S!==26&&S!==27||re===null||(B=re,f?(re=Dt(o,m),re!=null&&b.unshift(Rc(o,re,B))):f||(re=Dt(o,m),re!=null&&b.push(Rc(o,re,B)))),o=o.return}b.length!==0&&t.push({event:r,listeners:b})}var jT=/\r\n?/g,ET=/\u0000|\uFFFD/g;function I0(t){return(typeof t=="string"?t:""+t).replace(jT,`
`).replace(ET,"")}function M0(t,r){return r=I0(r),I0(t)===r}function $n(t,r,o,c,f,m){switch(o){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||Kn(t,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&Kn(t,""+c);break;case"className":ae(t,"class",c);break;case"tabIndex":ae(t,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":ae(t,o,c);break;case"style":As(t,c,m);break;case"data":if(r!=="object"){ae(t,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||o!=="href")){t.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(o);break}c=pa(""+c),t.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){t.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(o==="formAction"?(r!=="input"&&$n(t,r,"name",f.name,f,null),$n(t,r,"formEncType",f.formEncType,f,null),$n(t,r,"formMethod",f.formMethod,f,null),$n(t,r,"formTarget",f.formTarget,f,null)):($n(t,r,"encType",f.encType,f,null),$n(t,r,"method",f.method,f,null),$n(t,r,"target",f.target,f,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(o);break}c=pa(""+c),t.setAttribute(o,c);break;case"onClick":c!=null&&(t.onclick=A);break;case"onScroll":c!=null&&ln("scroll",t);break;case"onScrollEnd":c!=null&&ln("scrollend",t);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(i(60));t.innerHTML=o}}break;case"multiple":t.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":t.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){t.removeAttribute("xlink:href");break}o=pa(""+c),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(o,""+c):t.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(o,""):t.removeAttribute(o);break;case"capture":case"download":c===!0?t.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(o,c):t.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?t.setAttribute(o,c):t.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?t.removeAttribute(o):t.setAttribute(o,c);break;case"popover":ln("beforetoggle",t),ln("toggle",t),he(t,"popover",c);break;case"xlinkActuate":Ce(t,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Ce(t,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Ce(t,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Ce(t,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Ce(t,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Ce(t,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Ce(t,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Ce(t,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Ce(t,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":he(t,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Lr.get(o)||o,he(t,o,c))}}function Km(t,r,o,c,f,m){switch(o){case"style":As(t,c,m);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(i(60));t.innerHTML=o}}break;case"children":typeof c=="string"?Kn(t,c):(typeof c=="number"||typeof c=="bigint")&&Kn(t,""+c);break;case"onScroll":c!=null&&ln("scroll",t);break;case"onScrollEnd":c!=null&&ln("scrollend",t);break;case"onClick":c!=null&&(t.onclick=A);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!te.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(f=o.endsWith("Capture"),r=o.slice(2,f?o.length-7:void 0),m=t[At]||null,m=m!=null?m[o]:null,typeof m=="function"&&t.removeEventListener(r,m,f),typeof c=="function")){typeof m!="function"&&m!==null&&(o in t?t[o]=null:t.hasAttribute(o)&&t.removeAttribute(o)),t.addEventListener(r,c,f);break e}o in t?t[o]=c:c===!0?t.setAttribute(o,""):he(t,o,c)}}}function zs(t,r,o){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ln("error",t),ln("load",t);var c=!1,f=!1,m;for(m in o)if(o.hasOwnProperty(m)){var b=o[m];if(b!=null)switch(m){case"src":c=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:$n(t,r,m,b,o,null)}}f&&$n(t,r,"srcSet",o.srcSet,o,null),c&&$n(t,r,"src",o.src,o,null);return;case"input":ln("invalid",t);var S=m=b=f=null,B=null,re=null;for(c in o)if(o.hasOwnProperty(c)){var xe=o[c];if(xe!=null)switch(c){case"name":f=xe;break;case"type":b=xe;break;case"checked":B=xe;break;case"defaultChecked":re=xe;break;case"value":m=xe;break;case"defaultValue":S=xe;break;case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(i(137,r));break;default:$n(t,r,c,xe,o,null)}}La(t,m,S,B,re,b,f,!1);return;case"select":ln("invalid",t),c=b=m=null;for(f in o)if(o.hasOwnProperty(f)&&(S=o[f],S!=null))switch(f){case"value":m=S;break;case"defaultValue":b=S;break;case"multiple":c=S;default:$n(t,r,f,S,o,null)}r=m,o=b,t.multiple=!!c,r!=null?wr(t,!!c,r,!1):o!=null&&wr(t,!!c,o,!0);return;case"textarea":ln("invalid",t),m=f=c=null;for(b in o)if(o.hasOwnProperty(b)&&(S=o[b],S!=null))switch(b){case"value":c=S;break;case"defaultValue":f=S;break;case"children":m=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(i(91));break;default:$n(t,r,b,S,o,null)}Jn(t,c,f,m);return;case"option":for(B in o)o.hasOwnProperty(B)&&(c=o[B],c!=null)&&(B==="selected"?t.selected=c&&typeof c!="function"&&typeof c!="symbol":$n(t,r,B,c,o,null));return;case"dialog":ln("beforetoggle",t),ln("toggle",t),ln("cancel",t),ln("close",t);break;case"iframe":case"object":ln("load",t);break;case"video":case"audio":for(c=0;c<Cc.length;c++)ln(Cc[c],t);break;case"image":ln("error",t),ln("load",t);break;case"details":ln("toggle",t);break;case"embed":case"source":case"link":ln("error",t),ln("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(re in o)if(o.hasOwnProperty(re)&&(c=o[re],c!=null))switch(re){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:$n(t,r,re,c,o,null)}return;default:if(Ps(r)){for(xe in o)o.hasOwnProperty(xe)&&(c=o[xe],c!==void 0&&Km(t,r,xe,c,o,void 0));return}}for(S in o)o.hasOwnProperty(S)&&(c=o[S],c!=null&&$n(t,r,S,c,o,null))}function ST(t,r,o,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,m=null,b=null,S=null,B=null,re=null,xe=null;for(de in o){var Re=o[de];if(o.hasOwnProperty(de)&&Re!=null)switch(de){case"checked":break;case"value":break;case"defaultValue":B=Re;default:c.hasOwnProperty(de)||$n(t,r,de,null,c,Re)}}for(var le in c){var de=c[le];if(Re=o[le],c.hasOwnProperty(le)&&(de!=null||Re!=null))switch(le){case"type":m=de;break;case"name":f=de;break;case"checked":re=de;break;case"defaultChecked":xe=de;break;case"value":b=de;break;case"defaultValue":S=de;break;case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(i(137,r));break;default:de!==Re&&$n(t,r,le,de,c,Re)}}xr(t,b,S,B,re,xe,m,f);return;case"select":de=b=S=le=null;for(m in o)if(B=o[m],o.hasOwnProperty(m)&&B!=null)switch(m){case"value":break;case"multiple":de=B;default:c.hasOwnProperty(m)||$n(t,r,m,null,c,B)}for(f in c)if(m=c[f],B=o[f],c.hasOwnProperty(f)&&(m!=null||B!=null))switch(f){case"value":le=m;break;case"defaultValue":S=m;break;case"multiple":b=m;default:m!==B&&$n(t,r,f,m,c,B)}r=S,o=b,c=de,le!=null?wr(t,!!o,le,!1):!!c!=!!o&&(r!=null?wr(t,!!o,r,!0):wr(t,!!o,o?[]:"",!1));return;case"textarea":de=le=null;for(S in o)if(f=o[S],o.hasOwnProperty(S)&&f!=null&&!c.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:$n(t,r,S,null,c,f)}for(b in c)if(f=c[b],m=o[b],c.hasOwnProperty(b)&&(f!=null||m!=null))switch(b){case"value":le=f;break;case"defaultValue":de=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(i(91));break;default:f!==m&&$n(t,r,b,f,c,m)}wn(t,le,de);return;case"option":for(var ut in o)le=o[ut],o.hasOwnProperty(ut)&&le!=null&&!c.hasOwnProperty(ut)&&(ut==="selected"?t.selected=!1:$n(t,r,ut,null,c,le));for(B in c)le=c[B],de=o[B],c.hasOwnProperty(B)&&le!==de&&(le!=null||de!=null)&&(B==="selected"?t.selected=le&&typeof le!="function"&&typeof le!="symbol":$n(t,r,B,le,c,de));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Mt in o)le=o[Mt],o.hasOwnProperty(Mt)&&le!=null&&!c.hasOwnProperty(Mt)&&$n(t,r,Mt,null,c,le);for(re in c)if(le=c[re],de=o[re],c.hasOwnProperty(re)&&le!==de&&(le!=null||de!=null))switch(re){case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(i(137,r));break;default:$n(t,r,re,le,c,de)}return;default:if(Ps(r)){for(var Wn in o)le=o[Wn],o.hasOwnProperty(Wn)&&le!==void 0&&!c.hasOwnProperty(Wn)&&Km(t,r,Wn,void 0,c,le);for(xe in c)le=c[xe],de=o[xe],!c.hasOwnProperty(xe)||le===de||le===void 0&&de===void 0||Km(t,r,xe,le,c,de);return}}for(var X in o)le=o[X],o.hasOwnProperty(X)&&le!=null&&!c.hasOwnProperty(X)&&$n(t,r,X,null,c,le);for(Re in c)le=c[Re],de=o[Re],!c.hasOwnProperty(Re)||le===de||le==null&&de==null||$n(t,r,Re,le,c,de)}function D0(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function NT(){if(typeof performance.getEntriesByType=="function"){for(var t=0,r=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var f=o[c],m=f.transferSize,b=f.initiatorType,S=f.duration;if(m&&S&&D0(b)){for(b=0,S=f.responseEnd,c+=1;c<o.length;c++){var B=o[c],re=B.startTime;if(re>S)break;var xe=B.transferSize,Re=B.initiatorType;xe&&D0(Re)&&(B=B.responseEnd,b+=xe*(B<S?1:(S-re)/(B-re)))}if(--c,r+=8*(m+b)/(f.duration/1e3),t++,10<t)break}}if(0<t)return r/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var Ym=null,Qm=null;function Lh(t){return t.nodeType===9?t:t.ownerDocument}function P0(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function L0(t,r){if(t===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&r==="foreignObject"?0:t}function Xm(t,r){return t==="textarea"||t==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Jm=null;function CT(){var t=window.event;return t&&t.type==="popstate"?t===Jm?!1:(Jm=t,!0):(Jm=null,!1)}var O0=typeof setTimeout=="function"?setTimeout:void 0,RT=typeof clearTimeout=="function"?clearTimeout:void 0,V0=typeof Promise=="function"?Promise:void 0,AT=typeof queueMicrotask=="function"?queueMicrotask:typeof V0<"u"?function(t){return V0.resolve(null).then(t).catch(IT)}:O0;function IT(t){setTimeout(function(){throw t})}function Ai(t){return t==="head"}function B0(t,r){var o=r,c=0;do{var f=o.nextSibling;if(t.removeChild(o),f&&f.nodeType===8)if(o=f.data,o==="/$"||o==="/&"){if(c===0){t.removeChild(f),jl(r);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")Ac(t.ownerDocument.documentElement);else if(o==="head"){o=t.ownerDocument.head,Ac(o);for(var m=o.firstChild;m;){var b=m.nextSibling,S=m.nodeName;m[_s]||S==="SCRIPT"||S==="STYLE"||S==="LINK"&&m.rel.toLowerCase()==="stylesheet"||o.removeChild(m),m=b}}else o==="body"&&Ac(t.ownerDocument.body);o=f}while(o);jl(r)}function U0(t,r){var o=t;t=0;do{var c=o.nextSibling;if(o.nodeType===1?r?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(r?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(t===0)break;t--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||t++;o=c}while(o)}function Zm(t){var r=t.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var o=r;switch(r=r.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Zm(o),Ds(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}t.removeChild(o)}}function MT(t,r,o,c){for(;t.nodeType===1;){var f=o;if(t.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(c){if(!t[_s])switch(r){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(m=t.getAttribute("rel"),m==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(m!==f.rel||t.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||t.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||t.getAttribute("title")!==(f.title==null?null:f.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(m=t.getAttribute("src"),(m!==(f.src==null?null:f.src)||t.getAttribute("type")!==(f.type==null?null:f.type)||t.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&m&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(r==="input"&&t.type==="hidden"){var m=f.name==null?null:""+f.name;if(f.type==="hidden"&&t.getAttribute("name")===m)return t}else return t;if(t=$r(t.nextSibling),t===null)break}return null}function DT(t,r,o){if(r==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!o||(t=$r(t.nextSibling),t===null))return null;return t}function z0(t,r){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!r||(t=$r(t.nextSibling),t===null))return null;return t}function ep(t){return t.data==="$?"||t.data==="$~"}function tp(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function PT(t,r){var o=t.ownerDocument;if(t.data==="$~")t._reactRetry=r;else if(t.data!=="$?"||o.readyState!=="loading")r();else{var c=function(){r(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),t._reactRetry=c}}function $r(t){for(;t!=null;t=t.nextSibling){var r=t.nodeType;if(r===1||r===3)break;if(r===8){if(r=t.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return t}var np=null;function F0(t){t=t.nextSibling;for(var r=0;t;){if(t.nodeType===8){var o=t.data;if(o==="/$"||o==="/&"){if(r===0)return $r(t.nextSibling);r--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||r++}t=t.nextSibling}return null}function q0(t){t=t.previousSibling;for(var r=0;t;){if(t.nodeType===8){var o=t.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(r===0)return t;r--}else o!=="/$"&&o!=="/&"||r++}t=t.previousSibling}return null}function H0(t,r,o){switch(r=Lh(o),t){case"html":if(t=r.documentElement,!t)throw Error(i(452));return t;case"head":if(t=r.head,!t)throw Error(i(453));return t;case"body":if(t=r.body,!t)throw Error(i(454));return t;default:throw Error(i(451))}}function Ac(t){for(var r=t.attributes;r.length;)t.removeAttributeNode(r[0]);Ds(t)}var Wr=new Map,$0=new Set;function Oh(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var Ja=je.d;je.d={f:LT,r:OT,D:VT,C:BT,L:UT,m:zT,X:qT,S:FT,M:HT};function LT(){var t=Ja.f(),r=Nh();return t||r}function OT(t){var r=F(t);r!==null&&r.tag===5&&r.type==="form"?lb(r):Ja.r(t)}var _l=typeof document>"u"?null:document;function W0(t,r,o){var c=_l;if(c&&typeof r=="string"&&r){var f=xn(r);f='link[rel="'+t+'"][href="'+f+'"]',typeof o=="string"&&(f+='[crossorigin="'+o+'"]'),$0.has(f)||($0.add(f),t={rel:t,crossOrigin:o,href:r},c.querySelector(f)===null&&(r=c.createElement("link"),zs(r,"link",t),C(r),c.head.appendChild(r)))}}function VT(t){Ja.D(t),W0("dns-prefetch",t,null)}function BT(t,r){Ja.C(t,r),W0("preconnect",t,r)}function UT(t,r,o){Ja.L(t,r,o);var c=_l;if(c&&t&&r){var f='link[rel="preload"][as="'+xn(r)+'"]';r==="image"&&o&&o.imageSrcSet?(f+='[imagesrcset="'+xn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(f+='[imagesizes="'+xn(o.imageSizes)+'"]')):f+='[href="'+xn(t)+'"]';var m=f;switch(r){case"style":m=kl(t);break;case"script":m=Tl(t)}Wr.has(m)||(t=k({rel:"preload",href:r==="image"&&o&&o.imageSrcSet?void 0:t,as:r},o),Wr.set(m,t),c.querySelector(f)!==null||r==="style"&&c.querySelector(Ic(m))||r==="script"&&c.querySelector(Mc(m))||(r=c.createElement("link"),zs(r,"link",t),C(r),c.head.appendChild(r)))}}function zT(t,r){Ja.m(t,r);var o=_l;if(o&&t){var c=r&&typeof r.as=="string"?r.as:"script",f='link[rel="modulepreload"][as="'+xn(c)+'"][href="'+xn(t)+'"]',m=f;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=Tl(t)}if(!Wr.has(m)&&(t=k({rel:"modulepreload",href:t},r),Wr.set(m,t),o.querySelector(f)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Mc(m)))return}c=o.createElement("link"),zs(c,"link",t),C(c),o.head.appendChild(c)}}}function FT(t,r,o){Ja.S(t,r,o);var c=_l;if(c&&t){var f=T(c).hoistableStyles,m=kl(t);r=r||"default";var b=f.get(m);if(!b){var S={loading:0,preload:null};if(b=c.querySelector(Ic(m)))S.loading=5;else{t=k({rel:"stylesheet",href:t,"data-precedence":r},o),(o=Wr.get(m))&&sp(t,o);var B=b=c.createElement("link");C(B),zs(B,"link",t),B._p=new Promise(function(re,xe){B.onload=re,B.onerror=xe}),B.addEventListener("load",function(){S.loading|=1}),B.addEventListener("error",function(){S.loading|=2}),S.loading|=4,Vh(b,r,c)}b={type:"stylesheet",instance:b,count:1,state:S},f.set(m,b)}}}function qT(t,r){Ja.X(t,r);var o=_l;if(o&&t){var c=T(o).hoistableScripts,f=Tl(t),m=c.get(f);m||(m=o.querySelector(Mc(f)),m||(t=k({src:t,async:!0},r),(r=Wr.get(f))&&rp(t,r),m=o.createElement("script"),C(m),zs(m,"link",t),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function HT(t,r){Ja.M(t,r);var o=_l;if(o&&t){var c=T(o).hoistableScripts,f=Tl(t),m=c.get(f);m||(m=o.querySelector(Mc(f)),m||(t=k({src:t,async:!0,type:"module"},r),(r=Wr.get(f))&&rp(t,r),m=o.createElement("script"),C(m),zs(m,"link",t),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function G0(t,r,o,c){var f=(f=Ae.current)?Oh(f):null;if(!f)throw Error(i(446));switch(t){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(r=kl(o.href),o=T(f).hoistableStyles,c=o.get(r),c||(c={type:"style",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){t=kl(o.href);var m=T(f).hoistableStyles,b=m.get(t);if(b||(f=f.ownerDocument||f,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(t,b),(m=f.querySelector(Ic(t)))&&!m._p&&(b.instance=m,b.state.loading=5),Wr.has(t)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Wr.set(t,o),m||$T(f,t,o,b.state))),r&&c===null)throw Error(i(528,""));return b}if(r&&c!==null)throw Error(i(529,""));return null;case"script":return r=o.async,o=o.src,typeof o=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=Tl(o),o=T(f).hoistableScripts,c=o.get(r),c||(c={type:"script",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,t))}}function kl(t){return'href="'+xn(t)+'"'}function Ic(t){return'link[rel="stylesheet"]['+t+"]"}function K0(t){return k({},t,{"data-precedence":t.precedence,precedence:null})}function $T(t,r,o,c){t.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=t.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),zs(r,"link",o),C(r),t.head.appendChild(r))}function Tl(t){return'[src="'+xn(t)+'"]'}function Mc(t){return"script[async]"+t}function Y0(t,r,o){if(r.count++,r.instance===null)switch(r.type){case"style":var c=t.querySelector('style[data-href~="'+xn(o.href)+'"]');if(c)return r.instance=c,C(c),c;var f=k({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(t.ownerDocument||t).createElement("style"),C(c),zs(c,"style",f),Vh(c,o.precedence,t),r.instance=c;case"stylesheet":f=kl(o.href);var m=t.querySelector(Ic(f));if(m)return r.state.loading|=4,r.instance=m,C(m),m;c=K0(o),(f=Wr.get(f))&&sp(c,f),m=(t.ownerDocument||t).createElement("link"),C(m);var b=m;return b._p=new Promise(function(S,B){b.onload=S,b.onerror=B}),zs(m,"link",c),r.state.loading|=4,Vh(m,o.precedence,t),r.instance=m;case"script":return m=Tl(o.src),(f=t.querySelector(Mc(m)))?(r.instance=f,C(f),f):(c=o,(f=Wr.get(m))&&(c=k({},o),rp(c,f)),t=t.ownerDocument||t,f=t.createElement("script"),C(f),zs(f,"link",c),t.head.appendChild(f),r.instance=f);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,Vh(c,o.precedence,t));return r.instance}function Vh(t,r,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=c.length?c[c.length-1]:null,m=f,b=0;b<c.length;b++){var S=c[b];if(S.dataset.precedence===r)m=S;else if(m!==f)break}m?m.parentNode.insertBefore(t,m.nextSibling):(r=o.nodeType===9?o.head:o,r.insertBefore(t,r.firstChild))}function sp(t,r){t.crossOrigin==null&&(t.crossOrigin=r.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=r.referrerPolicy),t.title==null&&(t.title=r.title)}function rp(t,r){t.crossOrigin==null&&(t.crossOrigin=r.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=r.referrerPolicy),t.integrity==null&&(t.integrity=r.integrity)}var Bh=null;function Q0(t,r,o){if(Bh===null){var c=new Map,f=Bh=new Map;f.set(o,c)}else f=Bh,c=f.get(o),c||(c=new Map,f.set(o,c));if(c.has(t))return c;for(c.set(t,null),o=o.getElementsByTagName(t),f=0;f<o.length;f++){var m=o[f];if(!(m[_s]||m[st]||t==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var b=m.getAttribute(r)||"";b=t+b;var S=c.get(b);S?S.push(m):c.set(b,[m])}}return c}function X0(t,r,o){t=t.ownerDocument||t,t.head.insertBefore(o,r==="title"?t.querySelector("head > title"):null)}function WT(t,r,o){if(o===1||r.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;return r.rel==="stylesheet"?(t=r.disabled,typeof r.precedence=="string"&&t==null):!0;case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function J0(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}function GT(t,r,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var f=kl(c.href),m=r.querySelector(Ic(f));if(m){r=m._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(t.count++,t=Uh.bind(t),r.then(t,t)),o.state.loading|=4,o.instance=m,C(m);return}m=r.ownerDocument||r,c=K0(c),(f=Wr.get(f))&&sp(c,f),m=m.createElement("link"),C(m);var b=m;b._p=new Promise(function(S,B){b.onload=S,b.onerror=B}),zs(m,"link",c),o.instance=m}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(o,r),(r=o.state.preload)&&(o.state.loading&3)===0&&(t.count++,o=Uh.bind(t),r.addEventListener("load",o),r.addEventListener("error",o))}}var ap=0;function KT(t,r){return t.stylesheets&&t.count===0&&Fh(t,t.stylesheets),0<t.count||0<t.imgCount?function(o){var c=setTimeout(function(){if(t.stylesheets&&Fh(t,t.stylesheets),t.unsuspend){var m=t.unsuspend;t.unsuspend=null,m()}},6e4+r);0<t.imgBytes&&ap===0&&(ap=62500*NT());var f=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&Fh(t,t.stylesheets),t.unsuspend)){var m=t.unsuspend;t.unsuspend=null,m()}},(t.imgBytes>ap?50:800)+r);return t.unsuspend=o,function(){t.unsuspend=null,clearTimeout(c),clearTimeout(f)}}:null}function Uh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Fh(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var zh=null;function Fh(t,r){t.stylesheets=null,t.unsuspend!==null&&(t.count++,zh=new Map,r.forEach(YT,t),zh=null,Uh.call(t))}function YT(t,r){if(!(r.state.loading&4)){var o=zh.get(t);if(o)var c=o.get(null);else{o=new Map,zh.set(t,o);for(var f=t.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<f.length;m++){var b=f[m];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(o.set(b.dataset.precedence,b),c=b)}c&&o.set(null,c)}f=r.instance,b=f.getAttribute("data-precedence"),m=o.get(b)||c,m===c&&o.set(null,f),o.set(b,f),this.count++,c=Uh.bind(this),f.addEventListener("load",c),f.addEventListener("error",c),m?m.parentNode.insertBefore(f,m.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(f,t.firstChild)),r.state.loading|=4}}var Dc={$$typeof:fe,Provider:null,Consumer:null,_currentValue:ze,_currentValue2:ze,_threadCount:0};function QT(t,r,o,c,f,m,b,S,B){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=An(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=An(0),this.hiddenUpdates=An(null),this.identifierPrefix=c,this.onUncaughtError=f,this.onCaughtError=m,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=B,this.incompleteTransitions=new Map}function Z0(t,r,o,c,f,m,b,S,B,re,xe,Re){return t=new QT(t,r,o,b,B,re,xe,Re,S),r=1,m===!0&&(r|=24),m=Sr(3,null,null,r),t.current=m,m.stateNode=t,r=Vf(),r.refCount++,t.pooledCache=r,r.refCount++,m.memoizedState={element:c,isDehydrated:o,cache:r},Ff(m),t}function e1(t){return t?(t=tl,t):tl}function t1(t,r,o,c,f,m){f=e1(f),c.context===null?c.context=f:c.pendingContext=f,c=xi(r),c.payload={element:o},m=m===void 0?null:m,m!==null&&(c.callback=m),o=wi(t,c,r),o!==null&&(gr(o,t,r),dc(o,t,r))}function n1(t,r){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var o=t.retryLane;t.retryLane=o!==0&&o<r?o:r}}function ip(t,r){n1(t,r),(t=t.alternate)&&n1(t,r)}function s1(t){if(t.tag===13||t.tag===31){var r=go(t,67108864);r!==null&&gr(r,t,67108864),ip(t,67108864)}}function r1(t){if(t.tag===13||t.tag===31){var r=Ir();r=q(r);var o=go(t,r);o!==null&&gr(o,t,r),ip(t,r)}}var qh=!0;function XT(t,r,o,c){var f=Q.T;Q.T=null;var m=je.p;try{je.p=2,op(t,r,o,c)}finally{je.p=m,Q.T=f}}function JT(t,r,o,c){var f=Q.T;Q.T=null;var m=je.p;try{je.p=8,op(t,r,o,c)}finally{je.p=m,Q.T=f}}function op(t,r,o,c){if(qh){var f=lp(c);if(f===null)Gm(t,r,c,Hh,o),i1(t,c);else if(ej(f,t,r,o,c))c.stopPropagation();else if(i1(t,c),r&4&&-1<ZT.indexOf(t)){for(;f!==null;){var m=F(f);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var b=dt(m.pendingLanes);if(b!==0){var S=m;for(S.pendingLanes|=2,S.entangledLanes|=2;b;){var B=1<<31-Le(b);S.entanglements[1]|=B,b&=~B}wa(m),(Dn&6)===0&&(Eh=Et()+500,Nc(0))}}break;case 31:case 13:S=go(m,2),S!==null&&gr(S,m,2),Nh(),ip(m,2)}if(m=lp(c),m===null&&Gm(t,r,c,Hh,o),m===f)break;f=m}f!==null&&c.stopPropagation()}else Gm(t,r,c,null,o)}}function lp(t){return t=De(t),cp(t)}var Hh=null;function cp(t){if(Hh=null,t=Bn(t),t!==null){var r=u(t);if(r===null)t=null;else{var o=r.tag;if(o===13){if(t=h(r),t!==null)return t;t=null}else if(o===31){if(t=p(r),t!==null)return t;t=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;t=null}else r!==t&&(t=null)}}return Hh=t,null}function a1(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ln()){case zt:return 2;case Sn:return 8;case Kt:case Nn:return 32;case me:return 268435456;default:return 32}default:return 32}}var up=!1,Ii=null,Mi=null,Di=null,Pc=new Map,Lc=new Map,Pi=[],ZT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function i1(t,r){switch(t){case"focusin":case"focusout":Ii=null;break;case"dragenter":case"dragleave":Mi=null;break;case"mouseover":case"mouseout":Di=null;break;case"pointerover":case"pointerout":Pc.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lc.delete(r.pointerId)}}function Oc(t,r,o,c,f,m){return t===null||t.nativeEvent!==m?(t={blockedOn:r,domEventName:o,eventSystemFlags:c,nativeEvent:m,targetContainers:[f]},r!==null&&(r=F(r),r!==null&&s1(r)),t):(t.eventSystemFlags|=c,r=t.targetContainers,f!==null&&r.indexOf(f)===-1&&r.push(f),t)}function ej(t,r,o,c,f){switch(r){case"focusin":return Ii=Oc(Ii,t,r,o,c,f),!0;case"dragenter":return Mi=Oc(Mi,t,r,o,c,f),!0;case"mouseover":return Di=Oc(Di,t,r,o,c,f),!0;case"pointerover":var m=f.pointerId;return Pc.set(m,Oc(Pc.get(m)||null,t,r,o,c,f)),!0;case"gotpointercapture":return m=f.pointerId,Lc.set(m,Oc(Lc.get(m)||null,t,r,o,c,f)),!0}return!1}function o1(t){var r=Bn(t.target);if(r!==null){var o=u(r);if(o!==null){if(r=o.tag,r===13){if(r=h(o),r!==null){t.blockedOn=r,ve(t.priority,function(){r1(o)});return}}else if(r===31){if(r=p(o),r!==null){t.blockedOn=r,ve(t.priority,function(){r1(o)});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){t.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}t.blockedOn=null}function $h(t){if(t.blockedOn!==null)return!1;for(var r=t.targetContainers;0<r.length;){var o=lp(t.nativeEvent);if(o===null){o=t.nativeEvent;var c=new o.constructor(o.type,o);Z=c,o.target.dispatchEvent(c),Z=null}else return r=F(o),r!==null&&s1(r),t.blockedOn=o,!1;r.shift()}return!0}function l1(t,r,o){$h(t)&&o.delete(r)}function tj(){up=!1,Ii!==null&&$h(Ii)&&(Ii=null),Mi!==null&&$h(Mi)&&(Mi=null),Di!==null&&$h(Di)&&(Di=null),Pc.forEach(l1),Lc.forEach(l1)}function Wh(t,r){t.blockedOn===r&&(t.blockedOn=null,up||(up=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,tj)))}var Gh=null;function c1(t){Gh!==t&&(Gh=t,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){Gh===t&&(Gh=null);for(var r=0;r<t.length;r+=3){var o=t[r],c=t[r+1],f=t[r+2];if(typeof c!="function"){if(cp(c||o)===null)continue;break}var m=F(o);m!==null&&(t.splice(r,3),r-=3,lm(m,{pending:!0,data:f,method:o.method,action:c},c,f))}}))}function jl(t){function r(B){return Wh(B,t)}Ii!==null&&Wh(Ii,t),Mi!==null&&Wh(Mi,t),Di!==null&&Wh(Di,t),Pc.forEach(r),Lc.forEach(r);for(var o=0;o<Pi.length;o++){var c=Pi[o];c.blockedOn===t&&(c.blockedOn=null)}for(;0<Pi.length&&(o=Pi[0],o.blockedOn===null);)o1(o),o.blockedOn===null&&Pi.shift();if(o=(t.ownerDocument||t).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var f=o[c],m=o[c+1],b=f[At]||null;if(typeof m=="function")b||c1(o);else if(b){var S=null;if(m&&m.hasAttribute("formAction")){if(f=m,b=m[At]||null)S=b.formAction;else if(cp(f)!==null)continue}else S=b.action;typeof S=="function"?o[c+1]=S:(o.splice(c,3),c-=3),c1(o)}}}function u1(){function t(m){m.canIntercept&&m.info==="react-transition"&&m.intercept({handler:function(){return new Promise(function(b){return f=b})},focusReset:"manual",scroll:"manual"})}function r(){f!==null&&(f(),f=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var m=navigation.currentEntry;m&&m.url!=null&&navigation.navigate(m.url,{state:m.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,f=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),f!==null&&(f(),f=null)}}}function hp(t){this._internalRoot=t}Kh.prototype.render=hp.prototype.render=function(t){var r=this._internalRoot;if(r===null)throw Error(i(409));var o=r.current,c=Ir();t1(o,c,t,r,null,null)},Kh.prototype.unmount=hp.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var r=t.containerInfo;t1(t.current,2,null,t,null,null),Nh(),r[ct]=null}};function Kh(t){this._internalRoot=t}Kh.prototype.unstable_scheduleHydration=function(t){if(t){var r=we();t={blockedOn:null,target:t,priority:r};for(var o=0;o<Pi.length&&r!==0&&r<Pi[o].priority;o++);Pi.splice(o,0,t),o===0&&o1(t)}};var h1=e.version;if(h1!=="19.2.4")throw Error(i(527,h1,"19.2.4"));je.findDOMNode=function(t){var r=t._reactInternals;if(r===void 0)throw typeof t.render=="function"?Error(i(188)):(t=Object.keys(t).join(","),Error(i(268,t)));return t=y(r),t=t!==null?w(t):null,t=t===null?null:t.stateNode,t};var nj={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:Q,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Yh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yh.isDisabled&&Yh.supportsFiber)try{Ye=Yh.inject(nj),Be=Yh}catch{}}return Bc.createRoot=function(t,r){if(!l(t))throw Error(i(299));var o=!1,c="",f=vb,m=bb,b=xb;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(f=r.onUncaughtError),r.onCaughtError!==void 0&&(m=r.onCaughtError),r.onRecoverableError!==void 0&&(b=r.onRecoverableError)),r=Z0(t,1,!1,null,null,o,c,null,f,m,b,u1),t[ct]=r.current,Wm(t),new hp(r)},Bc.hydrateRoot=function(t,r,o){if(!l(t))throw Error(i(299));var c=!1,f="",m=vb,b=bb,S=xb,B=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(m=o.onUncaughtError),o.onCaughtError!==void 0&&(b=o.onCaughtError),o.onRecoverableError!==void 0&&(S=o.onRecoverableError),o.formState!==void 0&&(B=o.formState)),r=Z0(t,1,!0,r,o??null,c,f,B,m,b,S,u1),r.context=e1(null),o=r.current,c=Ir(),c=q(c),f=xi(c),f.callback=null,wi(o,f,c),o=c,r.current.lanes=o,rn(r,o),wa(r),t[ct]=r.current,Wm(t),new Kh(r)},Bc.version="19.2.4",Bc}var w1;function dj(){if(w1)return mp.exports;w1=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),mp.exports=hj(),mp.exports}var fj=dj();const mj="modulepreload",pj=function(s){return"/login/"+s},_1={},Qr=function(e,n,i){let l=Promise.resolve();if(n&&n.length>0){let g=function(y){return Promise.all(y.map(w=>Promise.resolve(w).then(k=>({status:"fulfilled",value:k}),k=>({status:"rejected",reason:k}))))};document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),p=h?.nonce||h?.getAttribute("nonce");l=g(n.map(y=>{if(y=pj(y),y in _1)return;_1[y]=!0;const w=y.endsWith(".css"),k=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${k}`))return;const E=document.createElement("link");if(E.rel=w?"stylesheet":mj,w||(E.as="script"),E.crossOrigin="",E.href=y,p&&E.setAttribute("nonce",p),document.head.appendChild(E),w)return new Promise((O,G)=>{E.addEventListener("load",O),E.addEventListener("error",()=>G(new Error(`Unable to preload CSS for ${y}`)))})}))}function u(h){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=h,window.dispatchEvent(p),!p.defaultPrevented)throw h}return l.then(h=>{for(const p of h||[])p.status==="rejected"&&u(p.reason);return e().catch(u)})};var k1="popstate";function gj(s={}){function e(i,l){let{pathname:u,search:h,hash:p}=i.location;return Xp("",{pathname:u,search:h,hash:p},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function n(i,l){return typeof l=="string"?l:iu(l)}return vj(e,n,null,s)}function ls(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function Yr(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function yj(){return Math.random().toString(36).substring(2,10)}function T1(s,e){return{usr:s.state,key:s.key,idx:e}}function Xp(s,e,n=null,i){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?Wl(e):e,state:n,key:e&&e.key||i||yj()}}function iu({pathname:s="/",search:e="",hash:n=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(s+=n.charAt(0)==="#"?n:"#"+n),s}function Wl(s){let e={};if(s){let n=s.indexOf("#");n>=0&&(e.hash=s.substring(n),s=s.substring(0,n));let i=s.indexOf("?");i>=0&&(e.search=s.substring(i),s=s.substring(0,i)),s&&(e.pathname=s)}return e}function vj(s,e,n,i={}){let{window:l=document.defaultView,v5Compat:u=!1}=i,h=l.history,p="POP",g=null,y=w();y==null&&(y=0,h.replaceState({...h.state,idx:y},""));function w(){return(h.state||{idx:null}).idx}function k(){p="POP";let V=w(),ne=V==null?null:V-y;y=V,g&&g({action:p,location:U.location,delta:ne})}function E(V,ne){p="PUSH";let J=Xp(U.location,V,ne);y=w()+1;let fe=T1(J,y),Te=U.createHref(J);try{h.pushState(fe,"",Te)}catch($e){if($e instanceof DOMException&&$e.name==="DataCloneError")throw $e;l.location.assign(Te)}u&&g&&g({action:p,location:U.location,delta:1})}function O(V,ne){p="REPLACE";let J=Xp(U.location,V,ne);y=w();let fe=T1(J,y),Te=U.createHref(J);h.replaceState(fe,"",Te),u&&g&&g({action:p,location:U.location,delta:0})}function G(V){return bj(V)}let U={get action(){return p},get location(){return s(l,h)},listen(V){if(g)throw new Error("A history only accepts one active listener");return l.addEventListener(k1,k),g=V,()=>{l.removeEventListener(k1,k),g=null}},createHref(V){return e(l,V)},createURL:G,encodeLocation(V){let ne=G(V);return{pathname:ne.pathname,search:ne.search,hash:ne.hash}},push:E,replace:O,go(V){return h.go(V)}};return U}function bj(s,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),ls(n,"No window.location.(origin|href) available to create URL");let i=typeof s=="string"?s:iu(s);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=n+i),new URL(i,n)}function _2(s,e,n="/"){return xj(s,e,n,!1)}function xj(s,e,n,i){let l=typeof e=="string"?Wl(e):e,u=ai(l.pathname||"/",n);if(u==null)return null;let h=k2(s);wj(h);let p=null;for(let g=0;p==null&&g<h.length;++g){let y=Ij(u);p=Rj(h[g],y,i)}return p}function k2(s,e=[],n=[],i="",l=!1){let u=(h,p,g=l,y)=>{let w={relativePath:y===void 0?h.path||"":y,caseSensitive:h.caseSensitive===!0,childrenIndex:p,route:h};if(w.relativePath.startsWith("/")){if(!w.relativePath.startsWith(i)&&g)return;ls(w.relativePath.startsWith(i),`Absolute route path "${w.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),w.relativePath=w.relativePath.slice(i.length)}let k=ti([i,w.relativePath]),E=n.concat(w);h.children&&h.children.length>0&&(ls(h.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${k}".`),k2(h.children,e,E,k,g)),!(h.path==null&&!h.index)&&e.push({path:k,score:Nj(k,h.index),routesMeta:E})};return s.forEach((h,p)=>{if(h.path===""||!h.path?.includes("?"))u(h,p);else for(let g of T2(h.path))u(h,p,!0,g)}),e}function T2(s){let e=s.split("/");if(e.length===0)return[];let[n,...i]=e,l=n.endsWith("?"),u=n.replace(/\?$/,"");if(i.length===0)return l?[u,""]:[u];let h=T2(i.join("/")),p=[];return p.push(...h.map(g=>g===""?u:[u,g].join("/"))),l&&p.push(...h),p.map(g=>s.startsWith("/")&&g===""?"/":g)}function wj(s){s.sort((e,n)=>e.score!==n.score?n.score-e.score:Cj(e.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}var _j=/^:[\w-]+$/,kj=3,Tj=2,jj=1,Ej=10,Sj=-2,j1=s=>s==="*";function Nj(s,e){let n=s.split("/"),i=n.length;return n.some(j1)&&(i+=Sj),e&&(i+=Tj),n.filter(l=>!j1(l)).reduce((l,u)=>l+(_j.test(u)?kj:u===""?jj:Ej),i)}function Cj(s,e){return s.length===e.length&&s.slice(0,-1).every((i,l)=>i===e[l])?s[s.length-1]-e[e.length-1]:0}function Rj(s,e,n=!1){let{routesMeta:i}=s,l={},u="/",h=[];for(let p=0;p<i.length;++p){let g=i[p],y=p===i.length-1,w=u==="/"?e:e.slice(u.length)||"/",k=kd({path:g.relativePath,caseSensitive:g.caseSensitive,end:y},w),E=g.route;if(!k&&y&&n&&!i[i.length-1].route.index&&(k=kd({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},w)),!k)return null;Object.assign(l,k.params),h.push({params:l,pathname:ti([u,k.pathname]),pathnameBase:Lj(ti([u,k.pathnameBase])),route:E}),k.pathnameBase!=="/"&&(u=ti([u,k.pathnameBase]))}return h}function kd(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[n,i]=Aj(s.path,s.caseSensitive,s.end),l=e.match(n);if(!l)return null;let u=l[0],h=u.replace(/(.)\/+$/,"$1"),p=l.slice(1);return{params:i.reduce((y,{paramName:w,isOptional:k},E)=>{if(w==="*"){let G=p[E]||"";h=u.slice(0,u.length-G.length).replace(/(.)\/+$/,"$1")}const O=p[E];return k&&!O?y[w]=void 0:y[w]=(O||"").replace(/%2F/g,"/"),y},{}),pathname:u,pathnameBase:h,pattern:s}}function Aj(s,e=!1,n=!0){Yr(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let i=[],l="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(h,p,g)=>(i.push({paramName:p,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(i.push({paramName:"*"}),l+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?l+="\\/*$":s!==""&&s!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,e?void 0:"i"),i]}function Ij(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Yr(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function ai(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,i=s.charAt(n);return i&&i!=="/"?null:s.slice(n)||"/"}var Mj=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function Dj(s,e="/"){let{pathname:n,search:i="",hash:l=""}=typeof s=="string"?Wl(s):s,u;return n?(n=n.replace(/\/\/+/g,"/"),n.startsWith("/")?u=E1(n.substring(1),"/"):u=E1(n,e)):u=e,{pathname:u,search:Oj(i),hash:Vj(l)}}function E1(s,e){let n=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(l=>{l===".."?n.length>1&&n.pop():l!=="."&&n.push(l)}),n.length>1?n.join("/"):"/"}function vp(s,e,n,i){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Pj(s){return s.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Sg(s){let e=Pj(s);return e.map((n,i)=>i===e.length-1?n.pathname:n.pathnameBase)}function Ng(s,e,n,i=!1){let l;typeof s=="string"?l=Wl(s):(l={...s},ls(!l.pathname||!l.pathname.includes("?"),vp("?","pathname","search",l)),ls(!l.pathname||!l.pathname.includes("#"),vp("#","pathname","hash",l)),ls(!l.search||!l.search.includes("#"),vp("#","search","hash",l)));let u=s===""||l.pathname==="",h=u?"/":l.pathname,p;if(h==null)p=n;else{let k=e.length-1;if(!i&&h.startsWith("..")){let E=h.split("/");for(;E[0]==="..";)E.shift(),k-=1;l.pathname=E.join("/")}p=k>=0?e[k]:"/"}let g=Dj(l,p),y=h&&h!=="/"&&h.endsWith("/"),w=(u||h===".")&&n.endsWith("/");return!g.pathname.endsWith("/")&&(y||w)&&(g.pathname+="/"),g}var ti=s=>s.join("/").replace(/\/\/+/g,"/"),Lj=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),Oj=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,Vj=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s,Bj=class{constructor(s,e,n,i=!1){this.status=s,this.statusText=e||"",this.internal=i,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function Uj(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}function zj(s){return s.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var j2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function E2(s,e){let n=s;if(typeof n!="string"||!Mj.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let i=n,l=!1;if(j2)try{let u=new URL(window.location.href),h=n.startsWith("//")?new URL(u.protocol+n):new URL(n),p=ai(h.pathname,e);h.origin===u.origin&&p!=null?n=p+h.search+h.hash:l=!0}catch{Yr(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:l,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var S2=["POST","PUT","PATCH","DELETE"];new Set(S2);var Fj=["GET",...S2];new Set(Fj);var Gl=x.createContext(null);Gl.displayName="DataRouter";var Wd=x.createContext(null);Wd.displayName="DataRouterState";var qj=x.createContext(!1),N2=x.createContext({isTransitioning:!1});N2.displayName="ViewTransition";var Hj=x.createContext(new Map);Hj.displayName="Fetchers";var $j=x.createContext(null);$j.displayName="Await";var Pr=x.createContext(null);Pr.displayName="Navigation";var bu=x.createContext(null);bu.displayName="Location";var fa=x.createContext({outlet:null,matches:[],isDataRoute:!1});fa.displayName="Route";var Cg=x.createContext(null);Cg.displayName="RouteError";var C2="REACT_ROUTER_ERROR",Wj="REDIRECT",Gj="ROUTE_ERROR_RESPONSE";function Kj(s){if(s.startsWith(`${C2}:${Wj}:{`))try{let e=JSON.parse(s.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function Yj(s){if(s.startsWith(`${C2}:${Gj}:{`))try{let e=JSON.parse(s.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new Bj(e.status,e.statusText,e.data)}catch{}}function Qj(s,{relative:e}={}){ls(Kl(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=x.useContext(Pr),{hash:l,pathname:u,search:h}=xu(s,{relative:e}),p=u;return n!=="/"&&(p=u==="/"?n:ti([n,u])),i.createHref({pathname:p,search:h,hash:l})}function Kl(){return x.useContext(bu)!=null}function ma(){return ls(Kl(),"useLocation() may be used only in the context of a <Router> component."),x.useContext(bu).location}var R2="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function A2(s){x.useContext(Pr).static||x.useLayoutEffect(s)}function Zs(){let{isDataRoute:s}=x.useContext(fa);return s?uE():Xj()}function Xj(){ls(Kl(),"useNavigate() may be used only in the context of a <Router> component.");let s=x.useContext(Gl),{basename:e,navigator:n}=x.useContext(Pr),{matches:i}=x.useContext(fa),{pathname:l}=ma(),u=JSON.stringify(Sg(i)),h=x.useRef(!1);return A2(()=>{h.current=!0}),x.useCallback((g,y={})=>{if(Yr(h.current,R2),!h.current)return;if(typeof g=="number"){n.go(g);return}let w=Ng(g,JSON.parse(u),l,y.relative==="path");s==null&&e!=="/"&&(w.pathname=w.pathname==="/"?e:ti([e,w.pathname])),(y.replace?n.replace:n.push)(w,y.state,y)},[e,n,u,l,s])}x.createContext(null);function Jj(){let{matches:s}=x.useContext(fa),e=s[s.length-1];return e?e.params:{}}function xu(s,{relative:e}={}){let{matches:n}=x.useContext(fa),{pathname:i}=ma(),l=JSON.stringify(Sg(n));return x.useMemo(()=>Ng(s,JSON.parse(l),i,e==="path"),[s,l,i,e])}function Zj(s,e){return I2(s,e)}function I2(s,e,n,i,l){ls(Kl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=x.useContext(Pr),{matches:h}=x.useContext(fa),p=h[h.length-1],g=p?p.params:{},y=p?p.pathname:"/",w=p?p.pathnameBase:"/",k=p&&p.route;{let J=k&&k.path||"";D2(y,!k||J.endsWith("*")||J.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${y}" (under <Route path="${J}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${J}"> to <Route path="${J==="/"?"*":`${J}/*`}">.`)}let E=ma(),O;if(e){let J=typeof e=="string"?Wl(e):e;ls(w==="/"||J.pathname?.startsWith(w),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${w}" but pathname "${J.pathname}" was given in the \`location\` prop.`),O=J}else O=E;let G=O.pathname||"/",U=G;if(w!=="/"){let J=w.replace(/^\//,"").split("/");U="/"+G.replace(/^\//,"").split("/").slice(J.length).join("/")}let V=_2(s,{pathname:U});Yr(k||V!=null,`No routes matched location "${O.pathname}${O.search}${O.hash}" `),Yr(V==null||V[V.length-1].route.element!==void 0||V[V.length-1].route.Component!==void 0||V[V.length-1].route.lazy!==void 0,`Matched leaf route at location "${O.pathname}${O.search}${O.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let ne=rE(V&&V.map(J=>Object.assign({},J,{params:Object.assign({},g,J.params),pathname:ti([w,u.encodeLocation?u.encodeLocation(J.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:J.pathname]),pathnameBase:J.pathnameBase==="/"?w:ti([w,u.encodeLocation?u.encodeLocation(J.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:J.pathnameBase])})),h,n,i,l);return e&&ne?x.createElement(bu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...O},navigationType:"POP"}},ne):ne}function eE(){let s=cE(),e=Uj(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),n=s instanceof Error?s.stack:null,i="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},h=null;return console.error("Error handled by React Router default ErrorBoundary:",s),h=x.createElement(x.Fragment,null,x.createElement("p",null," Hey developer "),x.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",x.createElement("code",{style:u},"ErrorBoundary")," or"," ",x.createElement("code",{style:u},"errorElement")," prop on your route.")),x.createElement(x.Fragment,null,x.createElement("h2",null,"Unexpected Application Error!"),x.createElement("h3",{style:{fontStyle:"italic"}},e),n?x.createElement("pre",{style:l},n):null,h)}var tE=x.createElement(eE,null),M2=class extends x.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){this.props.onError?this.props.onError(s,e):console.error("React Router caught the following error during render",s)}render(){let s=this.state.error;if(this.context&&typeof s=="object"&&s&&"digest"in s&&typeof s.digest=="string"){const n=Yj(s.digest);n&&(s=n)}let e=s!==void 0?x.createElement(fa.Provider,{value:this.props.routeContext},x.createElement(Cg.Provider,{value:s,children:this.props.component})):this.props.children;return this.context?x.createElement(nE,{error:s},e):e}};M2.contextType=qj;var bp=new WeakMap;function nE({children:s,error:e}){let{basename:n}=x.useContext(Pr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=Kj(e.digest);if(i){let l=bp.get(e);if(l)throw l;let u=E2(i.location,n);if(j2&&!bp.get(e))if(u.isExternal||i.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const h=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:i.replace}));throw bp.set(e,h),h}return x.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return s}function sE({routeContext:s,match:e,children:n}){let i=x.useContext(Gl);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),x.createElement(fa.Provider,{value:s},n)}function rE(s,e=[],n=null,i=null,l=null){if(s==null){if(!n)return null;if(n.errors)s=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)s=n.matches;else return null}let u=s,h=n?.errors;if(h!=null){let w=u.findIndex(k=>k.route.id&&h?.[k.route.id]!==void 0);ls(w>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(h).join(",")}`),u=u.slice(0,Math.min(u.length,w+1))}let p=!1,g=-1;if(n)for(let w=0;w<u.length;w++){let k=u[w];if((k.route.HydrateFallback||k.route.hydrateFallbackElement)&&(g=w),k.route.id){let{loaderData:E,errors:O}=n,G=k.route.loader&&!E.hasOwnProperty(k.route.id)&&(!O||O[k.route.id]===void 0);if(k.route.lazy||G){p=!0,g>=0?u=u.slice(0,g+1):u=[u[0]];break}}}let y=n&&i?(w,k)=>{i(w,{location:n.location,params:n.matches?.[0]?.params??{},unstable_pattern:zj(n.matches),errorInfo:k})}:void 0;return u.reduceRight((w,k,E)=>{let O,G=!1,U=null,V=null;n&&(O=h&&k.route.id?h[k.route.id]:void 0,U=k.route.errorElement||tE,p&&(g<0&&E===0?(D2("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),G=!0,V=null):g===E&&(G=!0,V=k.route.hydrateFallbackElement||null)));let ne=e.concat(u.slice(0,E+1)),J=()=>{let fe;return O?fe=U:G?fe=V:k.route.Component?fe=x.createElement(k.route.Component,null):k.route.element?fe=k.route.element:fe=w,x.createElement(sE,{match:k,routeContext:{outlet:w,matches:ne,isDataRoute:n!=null},children:fe})};return n&&(k.route.ErrorBoundary||k.route.errorElement||E===0)?x.createElement(M2,{location:n.location,revalidation:n.revalidation,component:U,error:O,children:J(),routeContext:{outlet:null,matches:ne,isDataRoute:!0},onError:y}):J()},null)}function Rg(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function aE(s){let e=x.useContext(Gl);return ls(e,Rg(s)),e}function iE(s){let e=x.useContext(Wd);return ls(e,Rg(s)),e}function oE(s){let e=x.useContext(fa);return ls(e,Rg(s)),e}function Ag(s){let e=oE(s),n=e.matches[e.matches.length-1];return ls(n.route.id,`${s} can only be used on routes that contain a unique "id"`),n.route.id}function lE(){return Ag("useRouteId")}function cE(){let s=x.useContext(Cg),e=iE("useRouteError"),n=Ag("useRouteError");return s!==void 0?s:e.errors?.[n]}function uE(){let{router:s}=aE("useNavigate"),e=Ag("useNavigate"),n=x.useRef(!1);return A2(()=>{n.current=!0}),x.useCallback(async(l,u={})=>{Yr(n.current,R2),n.current&&(typeof l=="number"?await s.navigate(l):await s.navigate(l,{fromRouteId:e,...u}))},[s,e])}var S1={};function D2(s,e,n){!e&&!S1[s]&&(S1[s]=!0,Yr(!1,n))}x.memo(hE);function hE({routes:s,future:e,state:n,onError:i}){return I2(s,void 0,n,i,e)}function dE({to:s,replace:e,state:n,relative:i}){ls(Kl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=x.useContext(Pr);Yr(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=x.useContext(fa),{pathname:h}=ma(),p=Zs(),g=Ng(s,Sg(u),h,i==="path"),y=JSON.stringify(g);return x.useEffect(()=>{p(JSON.parse(y),{replace:e,state:n,relative:i})},[p,y,i,e,n]),null}function us(s){ls(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function fE({basename:s="/",children:e=null,location:n,navigationType:i="POP",navigator:l,static:u=!1,unstable_useTransitions:h}){ls(!Kl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=s.replace(/^\/*/,"/"),g=x.useMemo(()=>({basename:p,navigator:l,static:u,unstable_useTransitions:h,future:{}}),[p,l,u,h]);typeof n=="string"&&(n=Wl(n));let{pathname:y="/",search:w="",hash:k="",state:E=null,key:O="default"}=n,G=x.useMemo(()=>{let U=ai(y,p);return U==null?null:{location:{pathname:U,search:w,hash:k,state:E,key:O},navigationType:i}},[p,y,w,k,E,O,i]);return Yr(G!=null,`<Router basename="${p}"> is not able to match the URL "${y}${w}${k}" because it does not start with the basename, so the <Router> won't render anything.`),G==null?null:x.createElement(Pr.Provider,{value:g},x.createElement(bu.Provider,{children:e,value:G}))}function mE({children:s,location:e}){return Zj(Jp(s),e)}function Jp(s,e=[]){let n=[];return x.Children.forEach(s,(i,l)=>{if(!x.isValidElement(i))return;let u=[...e,l];if(i.type===x.Fragment){n.push.apply(n,Jp(i.props.children,u));return}ls(i.type===us,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ls(!i.props.index||!i.props.children,"An index route cannot have child routes.");let h={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(h.children=Jp(i.props.children,u)),n.push(h)}),n}var hd="get",dd="application/x-www-form-urlencoded";function Gd(s){return typeof HTMLElement<"u"&&s instanceof HTMLElement}function pE(s){return Gd(s)&&s.tagName.toLowerCase()==="button"}function gE(s){return Gd(s)&&s.tagName.toLowerCase()==="form"}function yE(s){return Gd(s)&&s.tagName.toLowerCase()==="input"}function vE(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function bE(s,e){return s.button===0&&(!e||e==="_self")&&!vE(s)}function Zp(s=""){return new URLSearchParams(typeof s=="string"||Array.isArray(s)||s instanceof URLSearchParams?s:Object.keys(s).reduce((e,n)=>{let i=s[n];return e.concat(Array.isArray(i)?i.map(l=>[n,l]):[[n,i]])},[]))}function xE(s,e){let n=Zp(s);return e&&e.forEach((i,l)=>{n.has(l)||e.getAll(l).forEach(u=>{n.append(l,u)})}),n}var Qh=null;function wE(){if(Qh===null)try{new FormData(document.createElement("form"),0),Qh=!1}catch{Qh=!0}return Qh}var _E=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function xp(s){return s!=null&&!_E.has(s)?(Yr(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${dd}"`),null):s}function kE(s,e){let n,i,l,u,h;if(gE(s)){let p=s.getAttribute("action");i=p?ai(p,e):null,n=s.getAttribute("method")||hd,l=xp(s.getAttribute("enctype"))||dd,u=new FormData(s)}else if(pE(s)||yE(s)&&(s.type==="submit"||s.type==="image")){let p=s.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=s.getAttribute("formaction")||p.getAttribute("action");if(i=g?ai(g,e):null,n=s.getAttribute("formmethod")||p.getAttribute("method")||hd,l=xp(s.getAttribute("formenctype"))||xp(p.getAttribute("enctype"))||dd,u=new FormData(p,s),!wE()){let{name:y,type:w,value:k}=s;if(w==="image"){let E=y?`${y}.`:"";u.append(`${E}x`,"0"),u.append(`${E}y`,"0")}else y&&u.append(y,k)}}else{if(Gd(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=hd,i=null,l=dd,h=s}return u&&l==="text/plain"&&(h=u,u=void 0),{action:i,method:n.toLowerCase(),encType:l,formData:u,body:h}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Ig(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function TE(s,e,n,i){let l=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return n?l.pathname.endsWith("/")?l.pathname=`${l.pathname}_.${i}`:l.pathname=`${l.pathname}.${i}`:l.pathname==="/"?l.pathname=`_root.${i}`:e&&ai(l.pathname,e)==="/"?l.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${i}`,l}async function jE(s,e){if(s.id in e)return e[s.id];try{let n=await import(s.module);return e[s.id]=n,n}catch(n){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function EE(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function SE(s,e,n){let i=await Promise.all(s.map(async l=>{let u=e.routes[l.route.id];if(u){let h=await jE(u,n);return h.links?h.links():[]}return[]}));return AE(i.flat(1).filter(EE).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function N1(s,e,n,i,l,u){let h=(g,y)=>n[y]?g.route.id!==n[y].route.id:!0,p=(g,y)=>n[y].pathname!==g.pathname||n[y].route.path?.endsWith("*")&&n[y].params["*"]!==g.params["*"];return u==="assets"?e.filter((g,y)=>h(g,y)||p(g,y)):u==="data"?e.filter((g,y)=>{let w=i.routes[g.route.id];if(!w||!w.hasLoader)return!1;if(h(g,y)||p(g,y))return!0;if(g.route.shouldRevalidate){let k=g.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(s,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof k=="boolean")return k}return!0}):[]}function NE(s,e,{includeHydrateFallback:n}={}){return CE(s.map(i=>{let l=e.routes[i.route.id];if(!l)return[];let u=[l.module];return l.clientActionModule&&(u=u.concat(l.clientActionModule)),l.clientLoaderModule&&(u=u.concat(l.clientLoaderModule)),n&&l.hydrateFallbackModule&&(u=u.concat(l.hydrateFallbackModule)),l.imports&&(u=u.concat(l.imports)),u}).flat(1))}function CE(s){return[...new Set(s)]}function RE(s){let e={},n=Object.keys(s).sort();for(let i of n)e[i]=s[i];return e}function AE(s,e){let n=new Set;return new Set(e),s.reduce((i,l)=>{let u=JSON.stringify(RE(l));return n.has(u)||(n.add(u),i.push({key:u,link:l})),i},[])}function P2(){let s=x.useContext(Gl);return Ig(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function IE(){let s=x.useContext(Wd);return Ig(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var Mg=x.createContext(void 0);Mg.displayName="FrameworkContext";function L2(){let s=x.useContext(Mg);return Ig(s,"You must render this element inside a <HydratedRouter> element"),s}function ME(s,e){let n=x.useContext(Mg),[i,l]=x.useState(!1),[u,h]=x.useState(!1),{onFocus:p,onBlur:g,onMouseEnter:y,onMouseLeave:w,onTouchStart:k}=e,E=x.useRef(null);x.useEffect(()=>{if(s==="render"&&h(!0),s==="viewport"){let U=ne=>{ne.forEach(J=>{h(J.isIntersecting)})},V=new IntersectionObserver(U,{threshold:.5});return E.current&&V.observe(E.current),()=>{V.disconnect()}}},[s]),x.useEffect(()=>{if(i){let U=setTimeout(()=>{h(!0)},100);return()=>{clearTimeout(U)}}},[i]);let O=()=>{l(!0)},G=()=>{l(!1),h(!1)};return n?s!=="intent"?[u,E,{}]:[u,E,{onFocus:Uc(p,O),onBlur:Uc(g,G),onMouseEnter:Uc(y,O),onMouseLeave:Uc(w,G),onTouchStart:Uc(k,O)}]:[!1,E,{}]}function Uc(s,e){return n=>{s&&s(n),n.defaultPrevented||e(n)}}function DE({page:s,...e}){let{router:n}=P2(),i=x.useMemo(()=>_2(n.routes,s,n.basename),[n.routes,s,n.basename]);return i?x.createElement(LE,{page:s,matches:i,...e}):null}function PE(s){let{manifest:e,routeModules:n}=L2(),[i,l]=x.useState([]);return x.useEffect(()=>{let u=!1;return SE(s,e,n).then(h=>{u||l(h)}),()=>{u=!0}},[s,e,n]),i}function LE({page:s,matches:e,...n}){let i=ma(),{future:l,manifest:u,routeModules:h}=L2(),{basename:p}=P2(),{loaderData:g,matches:y}=IE(),w=x.useMemo(()=>N1(s,e,y,u,i,"data"),[s,e,y,u,i]),k=x.useMemo(()=>N1(s,e,y,u,i,"assets"),[s,e,y,u,i]),E=x.useMemo(()=>{if(s===i.pathname+i.search+i.hash)return[];let U=new Set,V=!1;if(e.forEach(J=>{let fe=u.routes[J.route.id];!fe||!fe.hasLoader||(!w.some(Te=>Te.route.id===J.route.id)&&J.route.id in g&&h[J.route.id]?.shouldRevalidate||fe.hasClientLoader?V=!0:U.add(J.route.id))}),U.size===0)return[];let ne=TE(s,p,l.unstable_trailingSlashAwareDataRequests,"data");return V&&U.size>0&&ne.searchParams.set("_routes",e.filter(J=>U.has(J.route.id)).map(J=>J.route.id).join(",")),[ne.pathname+ne.search]},[p,l.unstable_trailingSlashAwareDataRequests,g,i,u,w,e,s,h]),O=x.useMemo(()=>NE(k,u),[k,u]),G=PE(k);return x.createElement(x.Fragment,null,E.map(U=>x.createElement("link",{key:U,rel:"prefetch",as:"fetch",href:U,...n})),O.map(U=>x.createElement("link",{key:U,rel:"modulepreload",href:U,...n})),G.map(({key:U,link:V})=>x.createElement("link",{key:U,nonce:n.nonce,...V,crossOrigin:V.crossOrigin??n.crossOrigin})))}function OE(...s){return e=>{s.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var VE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{VE&&(window.__reactRouterVersion="7.13.0")}catch{}function BE({basename:s,children:e,unstable_useTransitions:n,window:i}){let l=x.useRef();l.current==null&&(l.current=gj({window:i,v5Compat:!0}));let u=l.current,[h,p]=x.useState({action:u.action,location:u.location}),g=x.useCallback(y=>{n===!1?p(y):x.startTransition(()=>p(y))},[n]);return x.useLayoutEffect(()=>u.listen(g),[u,g]),x.createElement(fE,{basename:s,children:e,location:h.location,navigationType:h.action,navigator:u,unstable_useTransitions:n})}var O2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,V2=x.forwardRef(function({onClick:e,discover:n="render",prefetch:i="none",relative:l,reloadDocument:u,replace:h,state:p,target:g,to:y,preventScrollReset:w,viewTransition:k,unstable_defaultShouldRevalidate:E,...O},G){let{basename:U,unstable_useTransitions:V}=x.useContext(Pr),ne=typeof y=="string"&&O2.test(y),J=E2(y,U);y=J.to;let fe=Qj(y,{relative:l}),[Te,$e,Ve]=ME(i,O),I=qE(y,{replace:h,state:p,target:g,preventScrollReset:w,relative:l,viewTransition:k,unstable_defaultShouldRevalidate:E,unstable_useTransitions:V});function j(P){e&&e(P),P.defaultPrevented||I(P)}let R=x.createElement("a",{...O,...Ve,href:J.absoluteURL||fe,onClick:J.isExternal||u?e:j,ref:OE(G,$e),target:g,"data-discover":!ne&&n==="render"?"true":void 0});return Te&&!ne?x.createElement(x.Fragment,null,R,x.createElement(DE,{page:fe})):R});V2.displayName="Link";var UE=x.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:i="",end:l=!1,style:u,to:h,viewTransition:p,children:g,...y},w){let k=xu(h,{relative:y.relative}),E=ma(),O=x.useContext(Wd),{navigator:G,basename:U}=x.useContext(Pr),V=O!=null&&YE(k)&&p===!0,ne=G.encodeLocation?G.encodeLocation(k).pathname:k.pathname,J=E.pathname,fe=O&&O.navigation&&O.navigation.location?O.navigation.location.pathname:null;n||(J=J.toLowerCase(),fe=fe?fe.toLowerCase():null,ne=ne.toLowerCase()),fe&&U&&(fe=ai(fe,U)||fe);const Te=ne!=="/"&&ne.endsWith("/")?ne.length-1:ne.length;let $e=J===ne||!l&&J.startsWith(ne)&&J.charAt(Te)==="/",Ve=fe!=null&&(fe===ne||!l&&fe.startsWith(ne)&&fe.charAt(ne.length)==="/"),I={isActive:$e,isPending:Ve,isTransitioning:V},j=$e?e:void 0,R;typeof i=="function"?R=i(I):R=[i,$e?"active":null,Ve?"pending":null,V?"transitioning":null].filter(Boolean).join(" ");let P=typeof u=="function"?u(I):u;return x.createElement(V2,{...y,"aria-current":j,className:R,ref:w,style:P,to:h,viewTransition:p},typeof g=="function"?g(I):g)});UE.displayName="NavLink";var zE=x.forwardRef(({discover:s="render",fetcherKey:e,navigate:n,reloadDocument:i,replace:l,state:u,method:h=hd,action:p,onSubmit:g,relative:y,preventScrollReset:w,viewTransition:k,unstable_defaultShouldRevalidate:E,...O},G)=>{let{unstable_useTransitions:U}=x.useContext(Pr),V=GE(),ne=KE(p,{relative:y}),J=h.toLowerCase()==="get"?"get":"post",fe=typeof p=="string"&&O2.test(p),Te=$e=>{if(g&&g($e),$e.defaultPrevented)return;$e.preventDefault();let Ve=$e.nativeEvent.submitter,I=Ve?.getAttribute("formmethod")||h,j=()=>V(Ve||$e.currentTarget,{fetcherKey:e,method:I,navigate:n,replace:l,state:u,relative:y,preventScrollReset:w,viewTransition:k,unstable_defaultShouldRevalidate:E});U&&n!==!1?x.startTransition(()=>j()):j()};return x.createElement("form",{ref:G,method:J,action:ne,onSubmit:i?g:Te,...O,"data-discover":!fe&&s==="render"?"true":void 0})});zE.displayName="Form";function FE(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function B2(s){let e=x.useContext(Gl);return ls(e,FE(s)),e}function qE(s,{target:e,replace:n,state:i,preventScrollReset:l,relative:u,viewTransition:h,unstable_defaultShouldRevalidate:p,unstable_useTransitions:g}={}){let y=Zs(),w=ma(),k=xu(s,{relative:u});return x.useCallback(E=>{if(bE(E,e)){E.preventDefault();let O=n!==void 0?n:iu(w)===iu(k),G=()=>y(s,{replace:O,state:i,preventScrollReset:l,relative:u,viewTransition:h,unstable_defaultShouldRevalidate:p});g?x.startTransition(()=>G()):G()}},[w,y,k,n,i,e,s,l,u,h,p,g])}function HE(s){Yr(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=x.useRef(Zp(s)),n=x.useRef(!1),i=ma(),l=x.useMemo(()=>xE(i.search,n.current?null:e.current),[i.search]),u=Zs(),h=x.useCallback((p,g)=>{const y=Zp(typeof p=="function"?p(new URLSearchParams(l)):p);n.current=!0,u("?"+y,g)},[u,l]);return[l,h]}var $E=0,WE=()=>`__${String(++$E)}__`;function GE(){let{router:s}=B2("useSubmit"),{basename:e}=x.useContext(Pr),n=lE(),i=s.fetch,l=s.navigate;return x.useCallback(async(u,h={})=>{let{action:p,method:g,encType:y,formData:w,body:k}=kE(u,e);if(h.navigate===!1){let E=h.fetcherKey||WE();await i(E,n,h.action||p,{unstable_defaultShouldRevalidate:h.unstable_defaultShouldRevalidate,preventScrollReset:h.preventScrollReset,formData:w,body:k,formMethod:h.method||g,formEncType:h.encType||y,flushSync:h.flushSync})}else await l(h.action||p,{unstable_defaultShouldRevalidate:h.unstable_defaultShouldRevalidate,preventScrollReset:h.preventScrollReset,formData:w,body:k,formMethod:h.method||g,formEncType:h.encType||y,replace:h.replace,state:h.state,fromRouteId:n,flushSync:h.flushSync,viewTransition:h.viewTransition})},[i,l,e,n])}function KE(s,{relative:e}={}){let{basename:n}=x.useContext(Pr),i=x.useContext(fa);ls(i,"useFormAction must be used inside a RouteContext");let[l]=i.matches.slice(-1),u={...xu(s||".",{relative:e})},h=ma();if(s==null){u.search=h.search;let p=new URLSearchParams(u.search),g=p.getAll("index");if(g.some(w=>w==="")){p.delete("index"),g.filter(k=>k).forEach(k=>p.append("index",k));let w=p.toString();u.search=w?`?${w}`:""}}return(!s||s===".")&&l.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(u.pathname=u.pathname==="/"?n:ti([n,u.pathname])),iu(u)}function YE(s,{relative:e}={}){let n=x.useContext(N2);ls(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=B2("useViewTransitionState"),l=xu(s,{relative:e});if(!n.isTransitioning)return!1;let u=ai(n.currentLocation.pathname,i)||n.currentLocation.pathname,h=ai(n.nextLocation.pathname,i)||n.nextLocation.pathname;return kd(l.pathname,h)!=null||kd(l.pathname,u)!=null}const QE=()=>{};var C1={};const U2=function(s){const e=[];let n=0;for(let i=0;i<s.length;i++){let l=s.charCodeAt(i);l<128?e[n++]=l:l<2048?(e[n++]=l>>6|192,e[n++]=l&63|128):(l&64512)===55296&&i+1<s.length&&(s.charCodeAt(i+1)&64512)===56320?(l=65536+((l&1023)<<10)+(s.charCodeAt(++i)&1023),e[n++]=l>>18|240,e[n++]=l>>12&63|128,e[n++]=l>>6&63|128,e[n++]=l&63|128):(e[n++]=l>>12|224,e[n++]=l>>6&63|128,e[n++]=l&63|128)}return e},XE=function(s){const e=[];let n=0,i=0;for(;n<s.length;){const l=s[n++];if(l<128)e[i++]=String.fromCharCode(l);else if(l>191&&l<224){const u=s[n++];e[i++]=String.fromCharCode((l&31)<<6|u&63)}else if(l>239&&l<365){const u=s[n++],h=s[n++],p=s[n++],g=((l&7)<<18|(u&63)<<12|(h&63)<<6|p&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const u=s[n++],h=s[n++];e[i++]=String.fromCharCode((l&15)<<12|(u&63)<<6|h&63)}}return e.join("")},z2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let l=0;l<s.length;l+=3){const u=s[l],h=l+1<s.length,p=h?s[l+1]:0,g=l+2<s.length,y=g?s[l+2]:0,w=u>>2,k=(u&3)<<4|p>>4;let E=(p&15)<<2|y>>6,O=y&63;g||(O=64,h||(E=64)),i.push(n[w],n[k],n[E],n[O])}return i.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(U2(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):XE(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let l=0;l<s.length;){const u=n[s.charAt(l++)],p=l<s.length?n[s.charAt(l)]:0;++l;const y=l<s.length?n[s.charAt(l)]:64;++l;const k=l<s.length?n[s.charAt(l)]:64;if(++l,u==null||p==null||y==null||k==null)throw new JE;const E=u<<2|p>>4;if(i.push(E),y!==64){const O=p<<4&240|y>>2;if(i.push(O),k!==64){const G=y<<6&192|k;i.push(G)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class JE extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ZE=function(s){const e=U2(s);return z2.encodeByteArray(e,!0)},Td=function(s){return ZE(s).replace(/\./g,"")},F2=function(s){try{return z2.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function eS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const tS=()=>eS().__FIREBASE_DEFAULTS__,nS=()=>{if(typeof process>"u"||typeof C1>"u")return;const s=C1.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},sS=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&F2(s[1]);return e&&JSON.parse(e)},Kd=()=>{try{return QE()||tS()||nS()||sS()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},q2=s=>Kd()?.emulatorHosts?.[s],H2=s=>{const e=q2(s);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),i]:[e.substring(0,n),i]},$2=()=>Kd()?.config,W2=s=>Kd()?.[`_${s}`];class rS{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,i))}}}function io(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Dg(s){return(await fetch(s,{credentials:"include"})).ok}function G2(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},i=e||"demo-project",l=s.iat||0,u=s.sub||s.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const h={iss:`https://securetoken.google.com/${i}`,aud:i,iat:l,exp:l+3600,auth_time:l,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...s};return[Td(JSON.stringify(n)),Td(JSON.stringify(h)),""].join(".")}const Jc={};function aS(){const s={prod:[],emulator:[]};for(const e of Object.keys(Jc))Jc[e]?s.emulator.push(e):s.prod.push(e);return s}function iS(s){let e=document.getElementById(s),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),n=!0),{created:n,element:e}}let R1=!1;function Pg(s,e){if(typeof window>"u"||typeof document>"u"||!io(window.location.host)||Jc[s]===e||Jc[s]||R1)return;Jc[s]=e;function n(E){return`__firebase__banner__${E}`}const i="__firebase__banner",u=aS().prod.length>0;function h(){const E=document.getElementById(i);E&&E.remove()}function p(E){E.style.display="flex",E.style.background="#7faaf0",E.style.position="fixed",E.style.bottom="5px",E.style.left="5px",E.style.padding=".5em",E.style.borderRadius="5px",E.style.alignItems="center"}function g(E,O){E.setAttribute("width","24"),E.setAttribute("id",O),E.setAttribute("height","24"),E.setAttribute("viewBox","0 0 24 24"),E.setAttribute("fill","none"),E.style.marginLeft="-6px"}function y(){const E=document.createElement("span");return E.style.cursor="pointer",E.style.marginLeft="16px",E.style.fontSize="24px",E.innerHTML=" &times;",E.onclick=()=>{R1=!0,h()},E}function w(E,O){E.setAttribute("id",O),E.innerText="Learn more",E.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",E.setAttribute("target","__blank"),E.style.paddingLeft="5px",E.style.textDecoration="underline"}function k(){const E=iS(i),O=n("text"),G=document.getElementById(O)||document.createElement("span"),U=n("learnmore"),V=document.getElementById(U)||document.createElement("a"),ne=n("preprendIcon"),J=document.getElementById(ne)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(E.created){const fe=E.element;p(fe),w(V,U);const Te=y();g(J,ne),fe.append(J,G,V,Te),document.body.appendChild(fe)}u?(G.innerText="Preview backend disconnected.",J.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(J.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,G.innerText="Preview backend running in this workspace."),G.setAttribute("id",O)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",k):k()}function Js(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function oS(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Js())}function lS(){const s=Kd()?.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function cS(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function uS(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function hS(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function dS(){const s=Js();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function fS(){return!lS()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function mS(){try{return typeof indexedDB=="object"}catch{return!1}}function pS(){return new Promise((s,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(i);l.onsuccess=()=>{l.result.close(),n||self.indexedDB.deleteDatabase(i),s(!0)},l.onupgradeneeded=()=>{n=!1},l.onerror=()=>{e(l.error?.message||"")}}catch(n){e(n)}})}const gS="FirebaseError";class Da extends Error{constructor(e,n,i){super(n),this.code=e,this.customData=i,this.name=gS,Object.setPrototypeOf(this,Da.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,wu.prototype.create)}}class wu{constructor(e,n,i){this.service=e,this.serviceName=n,this.errors=i}create(e,...n){const i=n[0]||{},l=`${this.service}/${e}`,u=this.errors[e],h=u?yS(u,i):"Error",p=`${this.serviceName}: ${h} (${l}).`;return new Da(l,p,i)}}function yS(s,e){return s.replace(vS,(n,i)=>{const l=e[i];return l!=null?String(l):`<${i}?>`})}const vS=/\{\$([^}]+)}/g;function bS(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function Vo(s,e){if(s===e)return!0;const n=Object.keys(s),i=Object.keys(e);for(const l of n){if(!i.includes(l))return!1;const u=s[l],h=e[l];if(A1(u)&&A1(h)){if(!Vo(u,h))return!1}else if(u!==h)return!1}for(const l of i)if(!n.includes(l))return!1;return!0}function A1(s){return s!==null&&typeof s=="object"}function _u(s){const e=[];for(const[n,i]of Object.entries(s))Array.isArray(i)?i.forEach(l=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Wc(s){const e={};return s.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[l,u]=i.split("=");e[decodeURIComponent(l)]=decodeURIComponent(u)}}),e}function Gc(s){const e=s.indexOf("?");if(!e)return"";const n=s.indexOf("#",e);return s.substring(e,n>0?n:void 0)}function xS(s,e){const n=new wS(s,e);return n.subscribe.bind(n)}class wS{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,i){let l;if(e===void 0&&n===void 0&&i===void 0)throw new Error("Missing Observer.");_S(e,["next","error","complete"])?l=e:l={next:e,error:n,complete:i},l.next===void 0&&(l.next=wp),l.error===void 0&&(l.error=wp),l.complete===void 0&&(l.complete=wp);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch{}}),this.observers.push(l),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function _S(s,e){if(typeof s!="object"||s===null)return!1;for(const n of e)if(n in s&&typeof s[n]=="function")return!0;return!1}function wp(){}function Qn(s){return s&&s._delegate?s._delegate:s}class Zi{constructor(e,n,i){this.name=e,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ao="[DEFAULT]";class kS{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const i=new rS;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:n});l&&i.resolve(l)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(l){if(i)return null;throw l}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(jS(e))try{this.getOrInitializeService({instanceIdentifier:Ao})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(n);try{const u=this.getOrInitializeService({instanceIdentifier:l});i.resolve(u)}catch{}}}}clearInstance(e=Ao){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ao){return this.instances.has(e)}getOptions(e=Ao){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[u,h]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(u);i===p&&h.resolve(l)}return l}onInit(e,n){const i=this.normalizeInstanceIdentifier(n),l=this.onInitCallbacks.get(i)??new Set;l.add(e),this.onInitCallbacks.set(i,l);const u=this.instances.get(i);return u&&e(u,i),()=>{l.delete(e)}}invokeOnInitCallbacks(e,n){const i=this.onInitCallbacks.get(n);if(i)for(const l of i)try{l(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:TS(e),options:n}),this.instances.set(e,i),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Ao){return this.component?this.component.multipleInstances?e:Ao:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function TS(s){return s===Ao?void 0:s}function jS(s){return s.instantiationMode==="EAGER"}class ES{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new kS(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var mn;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(mn||(mn={}));const SS={debug:mn.DEBUG,verbose:mn.VERBOSE,info:mn.INFO,warn:mn.WARN,error:mn.ERROR,silent:mn.SILENT},NS=mn.INFO,CS={[mn.DEBUG]:"log",[mn.VERBOSE]:"log",[mn.INFO]:"info",[mn.WARN]:"warn",[mn.ERROR]:"error"},RS=(s,e,...n)=>{if(e<s.logLevel)return;const i=new Date().toISOString(),l=CS[e];if(l)console[l](`[${i}]  ${s.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Lg{constructor(e){this.name=e,this._logLevel=NS,this._logHandler=RS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in mn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?SS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,mn.DEBUG,...e),this._logHandler(this,mn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,mn.VERBOSE,...e),this._logHandler(this,mn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,mn.INFO,...e),this._logHandler(this,mn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,mn.WARN,...e),this._logHandler(this,mn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,mn.ERROR,...e),this._logHandler(this,mn.ERROR,...e)}}const AS=(s,e)=>e.some(n=>s instanceof n);let I1,M1;function IS(){return I1||(I1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function MS(){return M1||(M1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const K2=new WeakMap,eg=new WeakMap,Y2=new WeakMap,_p=new WeakMap,Og=new WeakMap;function DS(s){const e=new Promise((n,i)=>{const l=()=>{s.removeEventListener("success",u),s.removeEventListener("error",h)},u=()=>{n(Yi(s.result)),l()},h=()=>{i(s.error),l()};s.addEventListener("success",u),s.addEventListener("error",h)});return e.then(n=>{n instanceof IDBCursor&&K2.set(n,s)}).catch(()=>{}),Og.set(e,s),e}function PS(s){if(eg.has(s))return;const e=new Promise((n,i)=>{const l=()=>{s.removeEventListener("complete",u),s.removeEventListener("error",h),s.removeEventListener("abort",h)},u=()=>{n(),l()},h=()=>{i(s.error||new DOMException("AbortError","AbortError")),l()};s.addEventListener("complete",u),s.addEventListener("error",h),s.addEventListener("abort",h)});eg.set(s,e)}let tg={get(s,e,n){if(s instanceof IDBTransaction){if(e==="done")return eg.get(s);if(e==="objectStoreNames")return s.objectStoreNames||Y2.get(s);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Yi(s[e])},set(s,e,n){return s[e]=n,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function LS(s){tg=s(tg)}function OS(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const i=s.call(kp(this),e,...n);return Y2.set(i,e.sort?e.sort():[e]),Yi(i)}:MS().includes(s)?function(...e){return s.apply(kp(this),e),Yi(K2.get(this))}:function(...e){return Yi(s.apply(kp(this),e))}}function VS(s){return typeof s=="function"?OS(s):(s instanceof IDBTransaction&&PS(s),AS(s,IS())?new Proxy(s,tg):s)}function Yi(s){if(s instanceof IDBRequest)return DS(s);if(_p.has(s))return _p.get(s);const e=VS(s);return e!==s&&(_p.set(s,e),Og.set(e,s)),e}const kp=s=>Og.get(s);function BS(s,e,{blocked:n,upgrade:i,blocking:l,terminated:u}={}){const h=indexedDB.open(s,e),p=Yi(h);return i&&h.addEventListener("upgradeneeded",g=>{i(Yi(h.result),g.oldVersion,g.newVersion,Yi(h.transaction),g)}),n&&h.addEventListener("blocked",g=>n(g.oldVersion,g.newVersion,g)),p.then(g=>{u&&g.addEventListener("close",()=>u()),l&&g.addEventListener("versionchange",y=>l(y.oldVersion,y.newVersion,y))}).catch(()=>{}),p}const US=["get","getKey","getAll","getAllKeys","count"],zS=["put","add","delete","clear"],Tp=new Map;function D1(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(Tp.get(e))return Tp.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,l=zS.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(l||US.includes(n)))return;const u=async function(h,...p){const g=this.transaction(h,l?"readwrite":"readonly");let y=g.store;return i&&(y=y.index(p.shift())),(await Promise.all([y[n](...p),l&&g.done]))[0]};return Tp.set(e,u),u}LS(s=>({...s,get:(e,n,i)=>D1(e,n)||s.get(e,n,i),has:(e,n)=>!!D1(e,n)||s.has(e,n)}));class FS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(qS(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function qS(s){return s.getComponent()?.type==="VERSION"}const ng="@firebase/app",P1="0.14.7";const ii=new Lg("@firebase/app"),HS="@firebase/app-compat",$S="@firebase/analytics-compat",WS="@firebase/analytics",GS="@firebase/app-check-compat",KS="@firebase/app-check",YS="@firebase/auth",QS="@firebase/auth-compat",XS="@firebase/database",JS="@firebase/data-connect",ZS="@firebase/database-compat",eN="@firebase/functions",tN="@firebase/functions-compat",nN="@firebase/installations",sN="@firebase/installations-compat",rN="@firebase/messaging",aN="@firebase/messaging-compat",iN="@firebase/performance",oN="@firebase/performance-compat",lN="@firebase/remote-config",cN="@firebase/remote-config-compat",uN="@firebase/storage",hN="@firebase/storage-compat",dN="@firebase/firestore",fN="@firebase/ai",mN="@firebase/firestore-compat",pN="firebase",gN="12.8.0";const sg="[DEFAULT]",yN={[ng]:"fire-core",[HS]:"fire-core-compat",[WS]:"fire-analytics",[$S]:"fire-analytics-compat",[KS]:"fire-app-check",[GS]:"fire-app-check-compat",[YS]:"fire-auth",[QS]:"fire-auth-compat",[XS]:"fire-rtdb",[JS]:"fire-data-connect",[ZS]:"fire-rtdb-compat",[eN]:"fire-fn",[tN]:"fire-fn-compat",[nN]:"fire-iid",[sN]:"fire-iid-compat",[rN]:"fire-fcm",[aN]:"fire-fcm-compat",[iN]:"fire-perf",[oN]:"fire-perf-compat",[lN]:"fire-rc",[cN]:"fire-rc-compat",[uN]:"fire-gcs",[hN]:"fire-gcs-compat",[dN]:"fire-fst",[mN]:"fire-fst-compat",[fN]:"fire-vertex","fire-js":"fire-js",[pN]:"fire-js-all"};const jd=new Map,vN=new Map,rg=new Map;function L1(s,e){try{s.container.addComponent(e)}catch(n){ii.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,n)}}function Bo(s){const e=s.name;if(rg.has(e))return ii.debug(`There were multiple attempts to register component ${e}.`),!1;rg.set(e,s);for(const n of jd.values())L1(n,s);for(const n of vN.values())L1(n,s);return!0}function Yd(s,e){const n=s.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),s.container.getProvider(e)}function Mr(s){return s==null?!1:s.settings!==void 0}const bN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Qi=new wu("app","Firebase",bN);class xN{constructor(e,n,i){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Zi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Qi.create("app-deleted",{appName:this._name})}}const Wo=gN;function Vg(s,e={}){let n=s;typeof e!="object"&&(e={name:e});const i={name:sg,automaticDataCollectionEnabled:!0,...e},l=i.name;if(typeof l!="string"||!l)throw Qi.create("bad-app-name",{appName:String(l)});if(n||(n=$2()),!n)throw Qi.create("no-options");const u=jd.get(l);if(u){if(Vo(n,u.options)&&Vo(i,u.config))return u;throw Qi.create("duplicate-app",{appName:l})}const h=new ES(l);for(const g of rg.values())h.addComponent(g);const p=new xN(n,i,h);return jd.set(l,p),p}function Bg(s=sg){const e=jd.get(s);if(!e&&s===sg&&$2())return Vg();if(!e)throw Qi.create("no-app",{appName:s});return e}function ja(s,e,n){let i=yN[s]??s;n&&(i+=`-${n}`);const l=i.match(/\s|\//),u=e.match(/\s|\//);if(l||u){const h=[`Unable to register library "${i}" with version "${e}":`];l&&h.push(`library name "${i}" contains illegal characters (whitespace or "/")`),l&&u&&h.push("and"),u&&h.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ii.warn(h.join(" "));return}Bo(new Zi(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const wN="firebase-heartbeat-database",_N=1,ou="firebase-heartbeat-store";let jp=null;function Q2(){return jp||(jp=BS(wN,_N,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(ou)}catch(n){console.warn(n)}}}}).catch(s=>{throw Qi.create("idb-open",{originalErrorMessage:s.message})})),jp}async function kN(s){try{const n=(await Q2()).transaction(ou),i=await n.objectStore(ou).get(X2(s));return await n.done,i}catch(e){if(e instanceof Da)ii.warn(e.message);else{const n=Qi.create("idb-get",{originalErrorMessage:e?.message});ii.warn(n.message)}}}async function O1(s,e){try{const i=(await Q2()).transaction(ou,"readwrite");await i.objectStore(ou).put(e,X2(s)),await i.done}catch(n){if(n instanceof Da)ii.warn(n.message);else{const i=Qi.create("idb-set",{originalErrorMessage:n?.message});ii.warn(i.message)}}}function X2(s){return`${s.name}!${s.options.appId}`}const TN=1024,jN=30;class EN{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new NN(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=V1();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats.length>jN){const l=CN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){ii.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=V1(),{heartbeatsToSend:n,unsentEntries:i}=SN(this._heartbeatsCache.heartbeats),l=Td(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(e){return ii.warn(e),""}}}function V1(){return new Date().toISOString().substring(0,10)}function SN(s,e=TN){const n=[];let i=s.slice();for(const l of s){const u=n.find(h=>h.agent===l.agent);if(u){if(u.dates.push(l.date),B1(n)>e){u.dates.pop();break}}else if(n.push({agent:l.agent,dates:[l.date]}),B1(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}class NN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return mS()?pS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await kN(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return O1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return O1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function B1(s){return Td(JSON.stringify({version:2,heartbeats:s})).length}function CN(s){if(s.length===0)return-1;let e=0,n=s[0].date;for(let i=1;i<s.length;i++)s[i].date<n&&(n=s[i].date,e=i);return e}function RN(s){Bo(new Zi("platform-logger",e=>new FS(e),"PRIVATE")),Bo(new Zi("heartbeat",e=>new EN(e),"PRIVATE")),ja(ng,P1,s),ja(ng,P1,"esm2020"),ja("fire-js","")}RN("");function J2(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const AN=J2,Z2=new wu("auth","Firebase",J2());const Ed=new Lg("@firebase/auth");function IN(s,...e){Ed.logLevel<=mn.WARN&&Ed.warn(`Auth (${Wo}): ${s}`,...e)}function fd(s,...e){Ed.logLevel<=mn.ERROR&&Ed.error(`Auth (${Wo}): ${s}`,...e)}function ha(s,...e){throw Ug(s,...e)}function Ea(s,...e){return Ug(s,...e)}function ew(s,e,n){const i={...AN(),[e]:n};return new wu("auth","Firebase",i).create(e,{appName:s.name})}function ni(s){return ew(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ug(s,...e){if(typeof s!="string"){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=s.name),s._errorFactory.create(n,...i)}return Z2.create(s,...e)}function Ot(s,e,...n){if(!s)throw Ug(e,...n)}function Za(s){const e="INTERNAL ASSERTION FAILED: "+s;throw fd(e),new Error(e)}function oi(s,e){s||Za(e)}function ag(){return typeof self<"u"&&self.location?.href||""}function MN(){return U1()==="http:"||U1()==="https:"}function U1(){return typeof self<"u"&&self.location?.protocol||null}function DN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(MN()||uS()||"connection"in navigator)?navigator.onLine:!0}function PN(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}class ku{constructor(e,n){this.shortDelay=e,this.longDelay=n,oi(n>e,"Short delay should be less than long delay!"),this.isMobile=oS()||hS()}get(){return DN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function zg(s,e){oi(s.emulator,"Emulator should always be set here");const{url:n}=s.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class tw{static initialize(e,n,i){this.fetchImpl=e,n&&(this.headersImpl=n),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Za("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Za("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Za("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const LN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const ON=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],VN=new ku(3e4,6e4);function ui(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function hi(s,e,n,i,l={}){return nw(s,l,async()=>{let u={},h={};i&&(e==="GET"?h=i:u={body:JSON.stringify(i)});const p=_u({key:s.config.apiKey,...h}).slice(1),g=await s._getAdditionalHeaders();g["Content-Type"]="application/json",s.languageCode&&(g["X-Firebase-Locale"]=s.languageCode);const y={method:e,headers:g,...u};return cS()||(y.referrerPolicy="no-referrer"),s.emulatorConfig&&io(s.emulatorConfig.host)&&(y.credentials="include"),tw.fetch()(await sw(s,s.config.apiHost,n,p),y)})}async function nw(s,e,n){s._canInitEmulator=!1;const i={...LN,...e};try{const l=new UN(s),u=await Promise.race([n(),l.promise]);l.clearNetworkTimeout();const h=await u.json();if("needConfirmation"in h)throw Xh(s,"account-exists-with-different-credential",h);if(u.ok&&!("errorMessage"in h))return h;{const p=u.ok?h.errorMessage:h.error.message,[g,y]=p.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw Xh(s,"credential-already-in-use",h);if(g==="EMAIL_EXISTS")throw Xh(s,"email-already-in-use",h);if(g==="USER_DISABLED")throw Xh(s,"user-disabled",h);const w=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw ew(s,w,y);ha(s,w)}}catch(l){if(l instanceof Da)throw l;ha(s,"network-request-failed",{message:String(l)})}}async function Tu(s,e,n,i,l={}){const u=await hi(s,e,n,i,l);return"mfaPendingCredential"in u&&ha(s,"multi-factor-auth-required",{_serverResponse:u}),u}async function sw(s,e,n,i){const l=`${e}${n}?${i}`,u=s,h=u.config.emulator?zg(s.config,l):`${s.config.apiScheme}://${l}`;return ON.includes(n)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(h).toString():h}function BN(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class UN{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,i)=>{this.timer=setTimeout(()=>i(Ea(this.auth,"network-request-failed")),VN.get())})}}function Xh(s,e,n){const i={appName:s.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const l=Ea(s,e,i);return l.customData._tokenResponse=n,l}function z1(s){return s!==void 0&&s.enterprise!==void 0}class zN{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return BN(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function FN(s,e){return hi(s,"GET","/v2/recaptchaConfig",ui(s,e))}async function qN(s,e){return hi(s,"POST","/v1/accounts:delete",e)}async function Sd(s,e){return hi(s,"POST","/v1/accounts:lookup",e)}function Zc(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function HN(s,e=!1){const n=Qn(s),i=await n.getIdToken(e),l=Fg(i);Ot(l&&l.exp&&l.auth_time&&l.iat,n.auth,"internal-error");const u=typeof l.firebase=="object"?l.firebase:void 0,h=u?.sign_in_provider;return{claims:l,token:i,authTime:Zc(Ep(l.auth_time)),issuedAtTime:Zc(Ep(l.iat)),expirationTime:Zc(Ep(l.exp)),signInProvider:h||null,signInSecondFactor:u?.sign_in_second_factor||null}}function Ep(s){return Number(s)*1e3}function Fg(s){const[e,n,i]=s.split(".");if(e===void 0||n===void 0||i===void 0)return fd("JWT malformed, contained fewer than 3 sections"),null;try{const l=F2(n);return l?JSON.parse(l):(fd("Failed to decode base64 JWT payload"),null)}catch(l){return fd("Caught error parsing JWT payload as JSON",l?.toString()),null}}function F1(s){const e=Fg(s);return Ot(e,"internal-error"),Ot(typeof e.exp<"u","internal-error"),Ot(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function lu(s,e,n=!1){if(n)return e;try{return await e}catch(i){throw i instanceof Da&&$N(i)&&s.auth.currentUser===s&&await s.auth.signOut(),i}}function $N({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}class WN{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class ig{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Zc(this.lastLoginAt),this.creationTime=Zc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Nd(s){const e=s.auth,n=await s.getIdToken(),i=await lu(s,Sd(e,{idToken:n}));Ot(i?.users.length,e,"internal-error");const l=i.users[0];s._notifyReloadListener(l);const u=l.providerUserInfo?.length?rw(l.providerUserInfo):[],h=KN(s.providerData,u),p=s.isAnonymous,g=!(s.email&&l.passwordHash)&&!h?.length,y=p?g:!1,w={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:h,metadata:new ig(l.createdAt,l.lastLoginAt),isAnonymous:y};Object.assign(s,w)}async function GN(s){const e=Qn(s);await Nd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function KN(s,e){return[...s.filter(i=>!e.some(l=>l.providerId===i.providerId)),...e]}function rw(s){return s.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function YN(s,e){const n=await nw(s,{},async()=>{const i=_u({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:l,apiKey:u}=s.config,h=await sw(s,l,"/v1/token",`key=${u}`),p=await s._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:p,body:i};return s.emulatorConfig&&io(s.emulatorConfig.host)&&(g.credentials="include"),tw.fetch()(h,g)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function QN(s,e){return hi(s,"POST","/v2/accounts:revokeToken",ui(s,e))}class Pl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ot(e.idToken,"internal-error"),Ot(typeof e.idToken<"u","internal-error"),Ot(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):F1(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Ot(e.length!==0,"internal-error");const n=F1(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Ot(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:i,refreshToken:l,expiresIn:u}=await YN(e,n);this.updateTokensAndExpiration(i,l,Number(u))}updateTokensAndExpiration(e,n,i){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,n){const{refreshToken:i,accessToken:l,expirationTime:u}=n,h=new Pl;return i&&(Ot(typeof i=="string","internal-error",{appName:e}),h.refreshToken=i),l&&(Ot(typeof l=="string","internal-error",{appName:e}),h.accessToken=l),u&&(Ot(typeof u=="number","internal-error",{appName:e}),h.expirationTime=u),h}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Pl,this.toJSON())}_performRefresh(){return Za("not implemented")}}function Oi(s,e){Ot(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class ca{constructor({uid:e,auth:n,stsTokenManager:i,...l}){this.providerId="firebase",this.proactiveRefresh=new WN(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new ig(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const n=await lu(this,this.stsTokenManager.getToken(this.auth,e));return Ot(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return HN(this,e)}reload(){return GN(this)}_assign(e){this!==e&&(Ot(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new ca({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Ot(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),n&&await Nd(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Mr(this.auth.app))return Promise.reject(ni(this.auth));const e=await this.getIdToken();return await lu(this,qN(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const i=n.displayName??void 0,l=n.email??void 0,u=n.phoneNumber??void 0,h=n.photoURL??void 0,p=n.tenantId??void 0,g=n._redirectEventId??void 0,y=n.createdAt??void 0,w=n.lastLoginAt??void 0,{uid:k,emailVerified:E,isAnonymous:O,providerData:G,stsTokenManager:U}=n;Ot(k&&U,e,"internal-error");const V=Pl.fromJSON(this.name,U);Ot(typeof k=="string",e,"internal-error"),Oi(i,e.name),Oi(l,e.name),Ot(typeof E=="boolean",e,"internal-error"),Ot(typeof O=="boolean",e,"internal-error"),Oi(u,e.name),Oi(h,e.name),Oi(p,e.name),Oi(g,e.name),Oi(y,e.name),Oi(w,e.name);const ne=new ca({uid:k,auth:e,email:l,emailVerified:E,displayName:i,isAnonymous:O,photoURL:h,phoneNumber:u,tenantId:p,stsTokenManager:V,createdAt:y,lastLoginAt:w});return G&&Array.isArray(G)&&(ne.providerData=G.map(J=>({...J}))),g&&(ne._redirectEventId=g),ne}static async _fromIdTokenResponse(e,n,i=!1){const l=new Pl;l.updateFromServerResponse(n);const u=new ca({uid:n.localId,auth:e,stsTokenManager:l,isAnonymous:i});return await Nd(u),u}static async _fromGetAccountInfoResponse(e,n,i){const l=n.users[0];Ot(l.localId!==void 0,"internal-error");const u=l.providerUserInfo!==void 0?rw(l.providerUserInfo):[],h=!(l.email&&l.passwordHash)&&!u?.length,p=new Pl;p.updateFromIdToken(i);const g=new ca({uid:l.localId,auth:e,stsTokenManager:p,isAnonymous:h}),y={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:u,metadata:new ig(l.createdAt,l.lastLoginAt),isAnonymous:!(l.email&&l.passwordHash)&&!u?.length};return Object.assign(g,y),g}}const q1=new Map;function ei(s){oi(s instanceof Function,"Expected a class definition");let e=q1.get(s);return e?(oi(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,q1.set(s,e),e)}class aw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}aw.type="NONE";const H1=aw;function md(s,e,n){return`firebase:${s}:${e}:${n}`}class Ll{constructor(e,n,i){this.persistence=e,this.auth=n,this.userKey=i;const{config:l,name:u}=this.auth;this.fullUserKey=md(this.userKey,l.apiKey,u),this.fullPersistenceKey=md("persistence",l.apiKey,u),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Sd(this.auth,{idToken:e}).catch(()=>{});return n?ca._fromGetAccountInfoResponse(this.auth,n,e):null}return ca._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,i="authUser"){if(!n.length)return new Ll(ei(H1),e,i);const l=(await Promise.all(n.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let u=l[0]||ei(H1);const h=md(i,e.config.apiKey,e.name);let p=null;for(const y of n)try{const w=await y._get(h);if(w){let k;if(typeof w=="string"){const E=await Sd(e,{idToken:w}).catch(()=>{});if(!E)break;k=await ca._fromGetAccountInfoResponse(e,E,w)}else k=ca._fromJSON(e,w);y!==u&&(p=k),u=y;break}}catch{}const g=l.filter(y=>y._shouldAllowMigration);return!u._shouldAllowMigration||!g.length?new Ll(u,e,i):(u=g[0],p&&await u._set(h,p.toJSON()),await Promise.all(n.map(async y=>{if(y!==u)try{await y._remove(h)}catch{}})),new Ll(u,e,i))}}function $1(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(cw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(iw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(hw(e))return"Blackberry";if(dw(e))return"Webos";if(ow(e))return"Safari";if((e.includes("chrome/")||lw(e))&&!e.includes("edge/"))return"Chrome";if(uw(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=s.match(n);if(i?.length===2)return i[1]}return"Other"}function iw(s=Js()){return/firefox\//i.test(s)}function ow(s=Js()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function lw(s=Js()){return/crios\//i.test(s)}function cw(s=Js()){return/iemobile/i.test(s)}function uw(s=Js()){return/android/i.test(s)}function hw(s=Js()){return/blackberry/i.test(s)}function dw(s=Js()){return/webos/i.test(s)}function qg(s=Js()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function XN(s=Js()){return qg(s)&&!!window.navigator?.standalone}function JN(){return dS()&&document.documentMode===10}function fw(s=Js()){return qg(s)||uw(s)||dw(s)||hw(s)||/windows phone/i.test(s)||cw(s)}function mw(s,e=[]){let n;switch(s){case"Browser":n=$1(Js());break;case"Worker":n=`${$1(Js())}-${s}`;break;default:n=s}const i=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Wo}/${i}`}class ZN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const i=u=>new Promise((h,p)=>{try{const g=e(u);h(g)}catch(g){p(g)}});i.onAbort=n,this.queue.push(i);const l=this.queue.length-1;return()=>{this.queue[l]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const i of this.queue)await i(e),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const l of n)try{l()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function eC(s,e={}){return hi(s,"GET","/v2/passwordPolicy",ui(s,e))}const tC=6;class nC{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??tC,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const i=this.customStrengthOptions.minPasswordLength,l=this.customStrengthOptions.maxPasswordLength;i&&(n.meetsMinPasswordLength=e.length>=i),l&&(n.meetsMaxPasswordLength=e.length<=l)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let i;for(let l=0;l<e.length;l++)i=e.charAt(l),this.updatePasswordCharacterOptionsStatuses(n,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,n,i,l,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=l)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}class sC{constructor(e,n,i,l){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=i,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new W1(this),this.idTokenSubscription=new W1(this),this.beforeStateQueue=new ZN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Z2,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=l.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=ei(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Ll.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Sd(this,{idToken:e}),i=await ca._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(i)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Mr(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(h=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(h,h))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,h=i?._redirectEventId,p=await this.tryRedirectSignIn(e);(!u||u===h)&&p?.user&&(i=p.user,l=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ot(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Nd(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=PN()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Mr(this.app))return Promise.reject(ni(this));const n=e?Qn(e):null;return n&&Ot(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Ot(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Mr(this.app)?Promise.reject(ni(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Mr(this.app)?Promise.reject(ni(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ei(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await eC(this),n=new nC(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new wu("auth","Firebase",e())}onAuthStateChanged(e,n,i){return this.registerStateListener(this.authStateSubscription,e,n,i)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,i){return this.registerStateListener(this.idTokenSubscription,e,n,i)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(i.tenantId=this.tenantId),await QN(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const i=await this.getOrInitRedirectPersistenceManager(n);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&ei(e)||this._popupRedirectResolver;Ot(n,this,"argument-error"),this.redirectPersistenceManager=await Ll.create(this,[ei(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,i,l){if(this._deleted)return()=>{};const u=typeof n=="function"?n:n.next.bind(n);let h=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ot(p,this,"internal-error"),p.then(()=>{h||u(this.currentUser)}),typeof n=="function"){const g=e.addObserver(n,i,l);return()=>{h=!0,g()}}else{const g=e.addObserver(n);return()=>{h=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ot(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=mw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Mr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&IN(`Error while retrieving App Check token: ${e.error}`),e?.token}}function oo(s){return Qn(s)}class W1{constructor(e){this.auth=e,this.observer=null,this.addObserver=xS(n=>this.observer=n)}get next(){return Ot(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Qd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function rC(s){Qd=s}function pw(s){return Qd.loadJS(s)}function aC(){return Qd.recaptchaEnterpriseScript}function iC(){return Qd.gapiScript}function oC(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class lC{constructor(){this.enterprise=new cC}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class cC{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const uC="recaptcha-enterprise",gw="NO_RECAPTCHA";class hC{constructor(e){this.type=uC,this.auth=oo(e)}async verify(e="verify",n=!1){async function i(u){if(!n){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(h,p)=>{FN(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const y=new zN(g);return u.tenantId==null?u._agentRecaptchaConfig=y:u._tenantRecaptchaConfigs[u.tenantId]=y,h(y.siteKey)}}).catch(g=>{p(g)})})}function l(u,h,p){const g=window.grecaptcha;z1(g)?g.enterprise.ready(()=>{g.enterprise.execute(u,{action:e}).then(y=>{h(y)}).catch(()=>{h(gw)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new lC().execute("siteKey",{action:"verify"}):new Promise((u,h)=>{i(this.auth).then(p=>{if(!n&&z1(window.grecaptcha))l(p,u,h);else{if(typeof window>"u"){h(new Error("RecaptchaVerifier is only supported in browser"));return}let g=aC();g.length!==0&&(g+=p),pw(g).then(()=>{l(p,u,h)}).catch(y=>{h(y)})}}).catch(p=>{h(p)})})}}async function G1(s,e,n,i=!1,l=!1){const u=new hC(s);let h;if(l)h=gw;else try{h=await u.verify(n)}catch{h=await u.verify(n,!0)}const p={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const g=p.phoneEnrollmentInfo.phoneNumber,y=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:y,captchaResponse:h,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const g=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:h,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return i?Object.assign(p,{captchaResp:h}):Object.assign(p,{captchaResponse:h}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function Cd(s,e,n,i,l){if(s._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await G1(s,e,n,n==="getOobCode");return i(s,u)}else return i(s,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const h=await G1(s,e,n,n==="getOobCode");return i(s,h)}else return Promise.reject(u)})}function dC(s,e){const n=Yd(s,"auth");if(n.isInitialized()){const l=n.getImmediate(),u=n.getOptions();if(Vo(u,e??{}))return l;ha(l,"already-initialized")}return n.initialize({options:e})}function fC(s,e){const n=e?.persistence||[],i=(Array.isArray(n)?n:[n]).map(ei);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(i,e?.popupRedirectResolver)}function mC(s,e,n){const i=oo(s);Ot(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const l=!1,u=yw(e),{host:h,port:p}=pC(e),g=p===null?"":`:${p}`,y={url:`${u}//${h}${g}/`},w=Object.freeze({host:h,port:p,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!i._canInitEmulator){Ot(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Ot(Vo(y,i.config.emulator)&&Vo(w,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=y,i.emulatorConfig=w,i.settings.appVerificationDisabledForTesting=!0,io(h)?(Dg(`${u}//${h}${g}`),Pg("Auth",!0)):gC()}function yw(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function pC(s){const e=yw(s),n=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",l=/^(\[[^\]]+\])(:|$)/.exec(i);if(l){const u=l[1];return{host:u,port:K1(i.substr(u.length+1))}}else{const[u,h]=i.split(":");return{host:u,port:K1(h)}}}function K1(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function gC(){function s(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}class Hg{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Za("not implemented")}_getIdTokenResponse(e){return Za("not implemented")}_linkToIdToken(e,n){return Za("not implemented")}_getReauthenticationResolver(e){return Za("not implemented")}}async function yC(s,e){return hi(s,"POST","/v1/accounts:signUp",e)}async function vC(s,e){return Tu(s,"POST","/v1/accounts:signInWithPassword",ui(s,e))}async function bC(s,e){return hi(s,"POST","/v1/accounts:sendOobCode",ui(s,e))}async function xC(s,e){return bC(s,e)}async function wC(s,e){return Tu(s,"POST","/v1/accounts:signInWithEmailLink",ui(s,e))}async function _C(s,e){return Tu(s,"POST","/v1/accounts:signInWithEmailLink",ui(s,e))}class cu extends Hg{constructor(e,n,i,l=null){super("password",i),this._email=e,this._password=n,this._tenantId=l}static _fromEmailAndPassword(e,n){return new cu(e,n,"password")}static _fromEmailAndCode(e,n,i=null){return new cu(e,n,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Cd(e,n,"signInWithPassword",vC);case"emailLink":return wC(e,{email:this._email,oobCode:this._password});default:ha(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const i={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Cd(e,i,"signUpPassword",yC);case"emailLink":return _C(e,{idToken:n,email:this._email,oobCode:this._password});default:ha(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Ol(s,e){return Tu(s,"POST","/v1/accounts:signInWithIdp",ui(s,e))}const kC="http://localhost";class Uo extends Hg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Uo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):ha("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:l,...u}=n;if(!i||!l)return null;const h=new Uo(i,l);return h.idToken=u.idToken||void 0,h.accessToken=u.accessToken||void 0,h.secret=u.secret,h.nonce=u.nonce,h.pendingToken=u.pendingToken||null,h}_getIdTokenResponse(e){const n=this.buildRequest();return Ol(e,n)}_linkToIdToken(e,n){const i=this.buildRequest();return i.idToken=n,Ol(e,i)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ol(e,n)}buildRequest(){const e={requestUri:kC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=_u(n)}return e}}function TC(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function jC(s){const e=Wc(Gc(s)).link,n=e?Wc(Gc(e)).deep_link_id:null,i=Wc(Gc(s)).deep_link_id;return(i?Wc(Gc(i)).link:null)||i||n||e||s}class $g{constructor(e){const n=Wc(Gc(e)),i=n.apiKey??null,l=n.oobCode??null,u=TC(n.mode??null);Ot(i&&l&&u,"argument-error"),this.apiKey=i,this.operation=u,this.code=l,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=jC(e);try{return new $g(n)}catch{return null}}}class Yl{constructor(){this.providerId=Yl.PROVIDER_ID}static credential(e,n){return cu._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const i=$g.parseLink(n);return Ot(i,"argument-error"),cu._fromEmailAndCode(e,i.code,i.tenantId)}}Yl.PROVIDER_ID="password";Yl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Yl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class vw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class ju extends vw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ui extends ju{constructor(){super("facebook.com")}static credential(e){return Uo._fromParams({providerId:Ui.PROVIDER_ID,signInMethod:Ui.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ui.credentialFromTaggedObject(e)}static credentialFromError(e){return Ui.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ui.credential(e.oauthAccessToken)}catch{return null}}}Ui.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ui.PROVIDER_ID="facebook.com";class zi extends ju{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Uo._fromParams({providerId:zi.PROVIDER_ID,signInMethod:zi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return zi.credentialFromTaggedObject(e)}static credentialFromError(e){return zi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:i}=e;if(!n&&!i)return null;try{return zi.credential(n,i)}catch{return null}}}zi.GOOGLE_SIGN_IN_METHOD="google.com";zi.PROVIDER_ID="google.com";class Fi extends ju{constructor(){super("github.com")}static credential(e){return Uo._fromParams({providerId:Fi.PROVIDER_ID,signInMethod:Fi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fi.credentialFromTaggedObject(e)}static credentialFromError(e){return Fi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Fi.credential(e.oauthAccessToken)}catch{return null}}}Fi.GITHUB_SIGN_IN_METHOD="github.com";Fi.PROVIDER_ID="github.com";class qi extends ju{constructor(){super("twitter.com")}static credential(e,n){return Uo._fromParams({providerId:qi.PROVIDER_ID,signInMethod:qi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return qi.credentialFromTaggedObject(e)}static credentialFromError(e){return qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:i}=e;if(!n||!i)return null;try{return qi.credential(n,i)}catch{return null}}}qi.TWITTER_SIGN_IN_METHOD="twitter.com";qi.PROVIDER_ID="twitter.com";async function EC(s,e){return Tu(s,"POST","/v1/accounts:signUp",ui(s,e))}class zo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,i,l=!1){const u=await ca._fromIdTokenResponse(e,i,l),h=Y1(i);return new zo({user:u,providerId:h,_tokenResponse:i,operationType:n})}static async _forOperation(e,n,i){await e._updateTokensIfNecessary(i,!0);const l=Y1(i);return new zo({user:e,providerId:l,_tokenResponse:i,operationType:n})}}function Y1(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}class Rd extends Da{constructor(e,n,i,l){super(n.code,n.message),this.operationType=i,this.user=l,Object.setPrototypeOf(this,Rd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,n,i,l){return new Rd(e,n,i,l)}}function bw(s,e,n,i){return(e==="reauthenticate"?n._getReauthenticationResolver(s):n._getIdTokenResponse(s)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?Rd._fromErrorAndOperation(s,u,e,i):u})}async function SC(s,e,n=!1){const i=await lu(s,e._linkToIdToken(s.auth,await s.getIdToken()),n);return zo._forOperation(s,"link",i)}async function NC(s,e,n=!1){const{auth:i}=s;if(Mr(i.app))return Promise.reject(ni(i));const l="reauthenticate";try{const u=await lu(s,bw(i,l,e,s),n);Ot(u.idToken,i,"internal-error");const h=Fg(u.idToken);Ot(h,i,"internal-error");const{sub:p}=h;return Ot(s.uid===p,i,"user-mismatch"),zo._forOperation(s,l,u)}catch(u){throw u?.code==="auth/user-not-found"&&ha(i,"user-mismatch"),u}}async function xw(s,e,n=!1){if(Mr(s.app))return Promise.reject(ni(s));const i="signIn",l=await bw(s,i,e),u=await zo._fromIdTokenResponse(s,i,l);return n||await s._updateCurrentUser(u.user),u}async function CC(s,e){return xw(oo(s),e)}async function ww(s){const e=oo(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function RC(s,e,n){const i=oo(s);await Cd(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",xC)}async function qD(s,e,n){if(Mr(s.app))return Promise.reject(ni(s));const i=oo(s),h=await Cd(i,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",EC).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&ww(s),g}),p=await zo._fromIdTokenResponse(i,"signIn",h);return await i._updateCurrentUser(p.user),p}function AC(s,e,n){return Mr(s.app)?Promise.reject(ni(s)):CC(Qn(s),Yl.credential(e,n)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&ww(s),i})}function IC(s,e){return Qn(s).setPersistence(e)}function MC(s,e,n,i){return Qn(s).onIdTokenChanged(e,n,i)}function DC(s,e,n){return Qn(s).beforeAuthStateChanged(e,n)}function PC(s,e,n,i){return Qn(s).onAuthStateChanged(e,n,i)}function LC(s){return Qn(s).signOut()}const Ad="__sak";class _w{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Ad,"1"),this.storage.removeItem(Ad),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const OC=1e3,VC=10;class kw extends _w{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=fw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),l=this.localCache[n];i!==l&&e(n,l,i)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((h,p,g)=>{this.notifyListeners(h,g)});return}const i=e.key;n?this.detachListener():this.stopPolling();const l=()=>{const h=this.storage.getItem(i);!n&&this.localCache[i]===h||this.notifyListeners(i,h)},u=this.storage.getItem(i);JN()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(l,VC):l()}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:i}),!0)})},OC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}kw.type="LOCAL";const Tw=kw;class jw extends _w{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}jw.type="SESSION";const Wg=jw;function BC(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class Xd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(l=>l.isListeningto(e));if(n)return n;const i=new Xd(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:i,eventType:l,data:u}=n.data,h=this.handlersMap[l];if(!h?.size)return;n.ports[0].postMessage({status:"ack",eventId:i,eventType:l});const p=Array.from(h).map(async y=>y(n.origin,u)),g=await BC(p);n.ports[0].postMessage({status:"done",eventId:i,eventType:l,response:g})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Xd.receivers=[];function Gg(s="",e=10){let n="";for(let i=0;i<e;i++)n+=Math.floor(Math.random()*10);return s+n}class UC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,i=50){const l=typeof MessageChannel<"u"?new MessageChannel:null;if(!l)throw new Error("connection_unavailable");let u,h;return new Promise((p,g)=>{const y=Gg("",20);l.port1.start();const w=setTimeout(()=>{g(new Error("unsupported_event"))},i);h={messageChannel:l,onMessage(k){const E=k;if(E.data.eventId===y)switch(E.data.status){case"ack":clearTimeout(w),u=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),p(E.data.response);break;default:clearTimeout(w),clearTimeout(u),g(new Error("invalid_response"));break}}},this.handlers.add(h),l.port1.addEventListener("message",h.onMessage),this.target.postMessage({eventType:e,eventId:y,data:n},[l.port2])}).finally(()=>{h&&this.removeMessageHandler(h)})}}function Sa(){return window}function zC(s){Sa().location.href=s}function Ew(){return typeof Sa().WorkerGlobalScope<"u"&&typeof Sa().importScripts=="function"}async function FC(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function qC(){return navigator?.serviceWorker?.controller||null}function HC(){return Ew()?self:null}const Sw="firebaseLocalStorageDb",$C=1,Id="firebaseLocalStorage",Nw="fbase_key";class Eu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Jd(s,e){return s.transaction([Id],e?"readwrite":"readonly").objectStore(Id)}function WC(){const s=indexedDB.deleteDatabase(Sw);return new Eu(s).toPromise()}function og(){const s=indexedDB.open(Sw,$C);return new Promise((e,n)=>{s.addEventListener("error",()=>{n(s.error)}),s.addEventListener("upgradeneeded",()=>{const i=s.result;try{i.createObjectStore(Id,{keyPath:Nw})}catch(l){n(l)}}),s.addEventListener("success",async()=>{const i=s.result;i.objectStoreNames.contains(Id)?e(i):(i.close(),await WC(),e(await og()))})})}async function Q1(s,e,n){const i=Jd(s,!0).put({[Nw]:e,value:n});return new Eu(i).toPromise()}async function GC(s,e){const n=Jd(s,!1).get(e),i=await new Eu(n).toPromise();return i===void 0?null:i.value}function X1(s,e){const n=Jd(s,!0).delete(e);return new Eu(n).toPromise()}const KC=800,YC=3;class Cw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await og(),this.db)}async _withRetries(e){let n=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(n++>YC)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ew()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Xd._getInstance(HC()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await FC(),!this.activeServiceWorker)return;this.sender=new UC(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||qC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await og();return await Q1(e,Ad,"1"),await X1(e,Ad),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(i=>Q1(i,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(i=>GC(i,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>X1(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(l=>{const u=Jd(l,!1).getAll();return new Eu(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],i=new Set;if(e.length!==0)for(const{fbase_key:l,value:u}of e)i.add(l),JSON.stringify(this.localCache[l])!==JSON.stringify(u)&&(this.notifyListeners(l,u),n.push(l));for(const l of Object.keys(this.localCache))this.localCache[l]&&!i.has(l)&&(this.notifyListeners(l,null),n.push(l));return n}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),KC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Cw.type="LOCAL";const QC=Cw;new ku(3e4,6e4);function XC(s,e){return e?ei(e):(Ot(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}class Kg extends Hg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ol(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ol(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ol(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function JC(s){return xw(s.auth,new Kg(s),s.bypassAuthState)}function ZC(s){const{auth:e,user:n}=s;return Ot(n,e,"internal-error"),NC(n,new Kg(s),s.bypassAuthState)}async function e4(s){const{auth:e,user:n}=s;return Ot(n,e,"internal-error"),SC(n,new Kg(s),s.bypassAuthState)}class Rw{constructor(e,n,i,l,u=!1){this.auth=e,this.resolver=i,this.user=l,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:i,postBody:l,tenantId:u,error:h,type:p}=e;if(h){this.reject(h);return}const g={auth:this.auth,requestUri:n,sessionId:i,tenantId:u||void 0,postBody:l||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(g))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return JC;case"linkViaPopup":case"linkViaRedirect":return e4;case"reauthViaPopup":case"reauthViaRedirect":return ZC;default:ha(this.auth,"internal-error")}}resolve(e){oi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){oi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const t4=new ku(2e3,1e4);class Dl extends Rw{constructor(e,n,i,l,u){super(e,n,l,u),this.provider=i,this.authWindow=null,this.pollId=null,Dl.currentPopupAction&&Dl.currentPopupAction.cancel(),Dl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ot(e,this.auth,"internal-error"),e}async onExecution(){oi(this.filter.length===1,"Popup operations only handle one event");const e=Gg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Ea(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ea(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Dl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ea(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,t4.get())};e()}}Dl.currentPopupAction=null;const n4="pendingRedirect",pd=new Map;class s4 extends Rw{constructor(e,n,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,i),this.eventId=null}async execute(){let e=pd.get(this.auth._key());if(!e){try{const i=await r4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(n){e=()=>Promise.reject(n)}pd.set(this.auth._key(),e)}return this.bypassAuthState||pd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function r4(s,e){const n=o4(e),i=i4(s);if(!await i._isAvailable())return!1;const l=await i._get(n)==="true";return await i._remove(n),l}function a4(s,e){pd.set(s._key(),e)}function i4(s){return ei(s._redirectPersistence)}function o4(s){return md(n4,s.config.apiKey,s.name)}async function l4(s,e,n=!1){if(Mr(s.app))return Promise.reject(ni(s));const i=oo(s),l=XC(i,e),h=await new s4(i,l,n).execute();return h&&!n&&(delete h.user._redirectEventId,await i._persistUserIfCurrent(h.user),await i._setRedirectUser(null,e)),h}const c4=600*1e3;class u4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(n=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!h4(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!Aw(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";n.onError(Ea(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const i=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=c4&&this.cachedEventUids.clear(),this.cachedEventUids.has(J1(e))}saveEventToCache(e){this.cachedEventUids.add(J1(e)),this.lastProcessedEventTime=Date.now()}}function J1(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function Aw({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function h4(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Aw(s);default:return!1}}async function d4(s,e={}){return hi(s,"GET","/v1/projects",e)}const f4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,m4=/^https?/;async function p4(s){if(s.config.emulator)return;const{authorizedDomains:e}=await d4(s);for(const n of e)try{if(g4(n))return}catch{}ha(s,"unauthorized-domain")}function g4(s){const e=ag(),{protocol:n,hostname:i}=new URL(e);if(s.startsWith("chrome-extension://")){const h=new URL(s);return h.hostname===""&&i===""?n==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&h.hostname===i}if(!m4.test(n))return!1;if(f4.test(s))return i===s;const l=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(i)}const y4=new ku(3e4,6e4);function Z1(){const s=Sa().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let n=0;n<s.CP.length;n++)s.CP[n]=null}}function v4(s){return new Promise((e,n)=>{function i(){Z1(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Z1(),n(Ea(s,"network-request-failed"))},timeout:y4.get()})}if(Sa().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Sa().gapi?.load)i();else{const l=oC("iframefcb");return Sa()[l]=()=>{gapi.load?i():n(Ea(s,"network-request-failed"))},pw(`${iC()}?onload=${l}`).catch(u=>n(u))}}).catch(e=>{throw gd=null,e})}let gd=null;function b4(s){return gd=gd||v4(s),gd}const x4=new ku(5e3,15e3),w4="__/auth/iframe",_4="emulator/auth/iframe",k4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},T4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function j4(s){const e=s.config;Ot(e.authDomain,s,"auth-domain-config-required");const n=e.emulator?zg(e,_4):`https://${s.config.authDomain}/${w4}`,i={apiKey:e.apiKey,appName:s.name,v:Wo},l=T4.get(s.config.apiHost);l&&(i.eid=l);const u=s._getFrameworks();return u.length&&(i.fw=u.join(",")),`${n}?${_u(i).slice(1)}`}async function E4(s){const e=await b4(s),n=Sa().gapi;return Ot(n,s,"internal-error"),e.open({where:document.body,url:j4(s),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:k4,dontclear:!0},i=>new Promise(async(l,u)=>{await i.restyle({setHideOnLeave:!1});const h=Ea(s,"network-request-failed"),p=Sa().setTimeout(()=>{u(h)},x4.get());function g(){Sa().clearTimeout(p),l(i)}i.ping(g).then(g,()=>{u(h)})}))}const S4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},N4=500,C4=600,R4="_blank",A4="http://localhost";class ex{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function I4(s,e,n,i=N4,l=C4){const u=Math.max((window.screen.availHeight-l)/2,0).toString(),h=Math.max((window.screen.availWidth-i)/2,0).toString();let p="";const g={...S4,width:i.toString(),height:l.toString(),top:u,left:h},y=Js().toLowerCase();n&&(p=lw(y)?R4:n),iw(y)&&(e=e||A4,g.scrollbars="yes");const w=Object.entries(g).reduce((E,[O,G])=>`${E}${O}=${G},`,"");if(XN(y)&&p!=="_self")return M4(e||"",p),new ex(null);const k=window.open(e||"",p,w);Ot(k,s,"popup-blocked");try{k.focus()}catch{}return new ex(k)}function M4(s,e){const n=document.createElement("a");n.href=s,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}const D4="__/auth/handler",P4="emulator/auth/handler",L4=encodeURIComponent("fac");async function tx(s,e,n,i,l,u){Ot(s.config.authDomain,s,"auth-domain-config-required"),Ot(s.config.apiKey,s,"invalid-api-key");const h={apiKey:s.config.apiKey,appName:s.name,authType:n,redirectUrl:i,v:Wo,eventId:l};if(e instanceof vw){e.setDefaultLanguage(s.languageCode),h.providerId=e.providerId||"",bS(e.getCustomParameters())||(h.customParameters=JSON.stringify(e.getCustomParameters()));for(const[w,k]of Object.entries({}))h[w]=k}if(e instanceof ju){const w=e.getScopes().filter(k=>k!=="");w.length>0&&(h.scopes=w.join(","))}s.tenantId&&(h.tid=s.tenantId);const p=h;for(const w of Object.keys(p))p[w]===void 0&&delete p[w];const g=await s._getAppCheckToken(),y=g?`#${L4}=${encodeURIComponent(g)}`:"";return`${O4(s)}?${_u(p).slice(1)}${y}`}function O4({config:s}){return s.emulator?zg(s,P4):`https://${s.authDomain}/${D4}`}const Sp="webStorageSupport";class V4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Wg,this._completeRedirectFn=l4,this._overrideRedirectResult=a4}async _openPopup(e,n,i,l){oi(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await tx(e,n,i,ag(),l);return I4(e,u,Gg())}async _openRedirect(e,n,i,l){await this._originValidation(e);const u=await tx(e,n,i,ag(),l);return zC(u),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:l,promise:u}=this.eventManagers[n];return l?Promise.resolve(l):(oi(u,"If manager is not set, promise should be"),u)}const i=this.initAndGetManager(e);return this.eventManagers[n]={promise:i},i.catch(()=>{delete this.eventManagers[n]}),i}async initAndGetManager(e){const n=await E4(e),i=new u4(e);return n.register("authEvent",l=>(Ot(l?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(l.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=n,i}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Sp,{type:Sp},l=>{const u=l?.[0]?.[Sp];u!==void 0&&n(!!u),ha(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=p4(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return fw()||ow()||qg()}}const B4=V4;var nx="@firebase/auth",sx="1.12.0";class U4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ot(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function z4(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function F4(s){Bo(new Zi("auth",(e,{options:n})=>{const i=e.getProvider("app").getImmediate(),l=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:h,authDomain:p}=i.options;Ot(h&&!h.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:h,authDomain:p,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:mw(s)},y=new sC(i,l,u,g);return fC(y,n),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,i)=>{e.getProvider("auth-internal").initialize()})),Bo(new Zi("auth-internal",e=>{const n=oo(e.getProvider("auth").getImmediate());return(i=>new U4(i))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),ja(nx,sx,z4(s)),ja(nx,sx,"esm2020")}const q4=300,H4=W2("authIdTokenMaxAge")||q4;let rx=null;const $4=s=>async e=>{const n=e&&await e.getIdTokenResult(),i=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>H4)return;const l=n?.token;rx!==l&&(rx=l,await fetch(s,{method:l?"POST":"DELETE",headers:l?{Authorization:`Bearer ${l}`}:{}}))};function Iw(s=Bg()){const e=Yd(s,"auth");if(e.isInitialized())return e.getImmediate();const n=dC(s,{popupRedirectResolver:B4,persistence:[QC,Tw,Wg]}),i=W2("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(i,location.origin);if(location.origin===u.origin){const h=$4(u.toString());DC(n,h,()=>h(n.currentUser)),MC(n,p=>h(p))}}const l=q2("auth");return l&&mC(n,`http://${l}`),n}function W4(){return document.getElementsByTagName("head")?.[0]??document}rC({loadJS(s){return new Promise((e,n)=>{const i=document.createElement("script");i.setAttribute("src",s),i.onload=e,i.onerror=l=>{const u=Ea("internal-error");u.customData=l,n(u)},i.type="text/javascript",i.charset="UTF-8",W4().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});F4("Browser");var ax=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Xi,Mw;(function(){var s;function e(I,j){function R(){}R.prototype=j.prototype,I.F=j.prototype,I.prototype=new R,I.prototype.constructor=I,I.D=function(P,D,z){for(var M=Array(arguments.length-2),We=2;We<arguments.length;We++)M[We-2]=arguments[We];return j.prototype[D].apply(P,M)}}function n(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,n),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function l(I,j,R){R||(R=0);const P=Array(16);if(typeof j=="string")for(var D=0;D<16;++D)P[D]=j.charCodeAt(R++)|j.charCodeAt(R++)<<8|j.charCodeAt(R++)<<16|j.charCodeAt(R++)<<24;else for(D=0;D<16;++D)P[D]=j[R++]|j[R++]<<8|j[R++]<<16|j[R++]<<24;j=I.g[0],R=I.g[1],D=I.g[2];let z=I.g[3],M;M=j+(z^R&(D^z))+P[0]+3614090360&4294967295,j=R+(M<<7&4294967295|M>>>25),M=z+(D^j&(R^D))+P[1]+3905402710&4294967295,z=j+(M<<12&4294967295|M>>>20),M=D+(R^z&(j^R))+P[2]+606105819&4294967295,D=z+(M<<17&4294967295|M>>>15),M=R+(j^D&(z^j))+P[3]+3250441966&4294967295,R=D+(M<<22&4294967295|M>>>10),M=j+(z^R&(D^z))+P[4]+4118548399&4294967295,j=R+(M<<7&4294967295|M>>>25),M=z+(D^j&(R^D))+P[5]+1200080426&4294967295,z=j+(M<<12&4294967295|M>>>20),M=D+(R^z&(j^R))+P[6]+2821735955&4294967295,D=z+(M<<17&4294967295|M>>>15),M=R+(j^D&(z^j))+P[7]+4249261313&4294967295,R=D+(M<<22&4294967295|M>>>10),M=j+(z^R&(D^z))+P[8]+1770035416&4294967295,j=R+(M<<7&4294967295|M>>>25),M=z+(D^j&(R^D))+P[9]+2336552879&4294967295,z=j+(M<<12&4294967295|M>>>20),M=D+(R^z&(j^R))+P[10]+4294925233&4294967295,D=z+(M<<17&4294967295|M>>>15),M=R+(j^D&(z^j))+P[11]+2304563134&4294967295,R=D+(M<<22&4294967295|M>>>10),M=j+(z^R&(D^z))+P[12]+1804603682&4294967295,j=R+(M<<7&4294967295|M>>>25),M=z+(D^j&(R^D))+P[13]+4254626195&4294967295,z=j+(M<<12&4294967295|M>>>20),M=D+(R^z&(j^R))+P[14]+2792965006&4294967295,D=z+(M<<17&4294967295|M>>>15),M=R+(j^D&(z^j))+P[15]+1236535329&4294967295,R=D+(M<<22&4294967295|M>>>10),M=j+(D^z&(R^D))+P[1]+4129170786&4294967295,j=R+(M<<5&4294967295|M>>>27),M=z+(R^D&(j^R))+P[6]+3225465664&4294967295,z=j+(M<<9&4294967295|M>>>23),M=D+(j^R&(z^j))+P[11]+643717713&4294967295,D=z+(M<<14&4294967295|M>>>18),M=R+(z^j&(D^z))+P[0]+3921069994&4294967295,R=D+(M<<20&4294967295|M>>>12),M=j+(D^z&(R^D))+P[5]+3593408605&4294967295,j=R+(M<<5&4294967295|M>>>27),M=z+(R^D&(j^R))+P[10]+38016083&4294967295,z=j+(M<<9&4294967295|M>>>23),M=D+(j^R&(z^j))+P[15]+3634488961&4294967295,D=z+(M<<14&4294967295|M>>>18),M=R+(z^j&(D^z))+P[4]+3889429448&4294967295,R=D+(M<<20&4294967295|M>>>12),M=j+(D^z&(R^D))+P[9]+568446438&4294967295,j=R+(M<<5&4294967295|M>>>27),M=z+(R^D&(j^R))+P[14]+3275163606&4294967295,z=j+(M<<9&4294967295|M>>>23),M=D+(j^R&(z^j))+P[3]+4107603335&4294967295,D=z+(M<<14&4294967295|M>>>18),M=R+(z^j&(D^z))+P[8]+1163531501&4294967295,R=D+(M<<20&4294967295|M>>>12),M=j+(D^z&(R^D))+P[13]+2850285829&4294967295,j=R+(M<<5&4294967295|M>>>27),M=z+(R^D&(j^R))+P[2]+4243563512&4294967295,z=j+(M<<9&4294967295|M>>>23),M=D+(j^R&(z^j))+P[7]+1735328473&4294967295,D=z+(M<<14&4294967295|M>>>18),M=R+(z^j&(D^z))+P[12]+2368359562&4294967295,R=D+(M<<20&4294967295|M>>>12),M=j+(R^D^z)+P[5]+4294588738&4294967295,j=R+(M<<4&4294967295|M>>>28),M=z+(j^R^D)+P[8]+2272392833&4294967295,z=j+(M<<11&4294967295|M>>>21),M=D+(z^j^R)+P[11]+1839030562&4294967295,D=z+(M<<16&4294967295|M>>>16),M=R+(D^z^j)+P[14]+4259657740&4294967295,R=D+(M<<23&4294967295|M>>>9),M=j+(R^D^z)+P[1]+2763975236&4294967295,j=R+(M<<4&4294967295|M>>>28),M=z+(j^R^D)+P[4]+1272893353&4294967295,z=j+(M<<11&4294967295|M>>>21),M=D+(z^j^R)+P[7]+4139469664&4294967295,D=z+(M<<16&4294967295|M>>>16),M=R+(D^z^j)+P[10]+3200236656&4294967295,R=D+(M<<23&4294967295|M>>>9),M=j+(R^D^z)+P[13]+681279174&4294967295,j=R+(M<<4&4294967295|M>>>28),M=z+(j^R^D)+P[0]+3936430074&4294967295,z=j+(M<<11&4294967295|M>>>21),M=D+(z^j^R)+P[3]+3572445317&4294967295,D=z+(M<<16&4294967295|M>>>16),M=R+(D^z^j)+P[6]+76029189&4294967295,R=D+(M<<23&4294967295|M>>>9),M=j+(R^D^z)+P[9]+3654602809&4294967295,j=R+(M<<4&4294967295|M>>>28),M=z+(j^R^D)+P[12]+3873151461&4294967295,z=j+(M<<11&4294967295|M>>>21),M=D+(z^j^R)+P[15]+530742520&4294967295,D=z+(M<<16&4294967295|M>>>16),M=R+(D^z^j)+P[2]+3299628645&4294967295,R=D+(M<<23&4294967295|M>>>9),M=j+(D^(R|~z))+P[0]+4096336452&4294967295,j=R+(M<<6&4294967295|M>>>26),M=z+(R^(j|~D))+P[7]+1126891415&4294967295,z=j+(M<<10&4294967295|M>>>22),M=D+(j^(z|~R))+P[14]+2878612391&4294967295,D=z+(M<<15&4294967295|M>>>17),M=R+(z^(D|~j))+P[5]+4237533241&4294967295,R=D+(M<<21&4294967295|M>>>11),M=j+(D^(R|~z))+P[12]+1700485571&4294967295,j=R+(M<<6&4294967295|M>>>26),M=z+(R^(j|~D))+P[3]+2399980690&4294967295,z=j+(M<<10&4294967295|M>>>22),M=D+(j^(z|~R))+P[10]+4293915773&4294967295,D=z+(M<<15&4294967295|M>>>17),M=R+(z^(D|~j))+P[1]+2240044497&4294967295,R=D+(M<<21&4294967295|M>>>11),M=j+(D^(R|~z))+P[8]+1873313359&4294967295,j=R+(M<<6&4294967295|M>>>26),M=z+(R^(j|~D))+P[15]+4264355552&4294967295,z=j+(M<<10&4294967295|M>>>22),M=D+(j^(z|~R))+P[6]+2734768916&4294967295,D=z+(M<<15&4294967295|M>>>17),M=R+(z^(D|~j))+P[13]+1309151649&4294967295,R=D+(M<<21&4294967295|M>>>11),M=j+(D^(R|~z))+P[4]+4149444226&4294967295,j=R+(M<<6&4294967295|M>>>26),M=z+(R^(j|~D))+P[11]+3174756917&4294967295,z=j+(M<<10&4294967295|M>>>22),M=D+(j^(z|~R))+P[2]+718787259&4294967295,D=z+(M<<15&4294967295|M>>>17),M=R+(z^(D|~j))+P[9]+3951481745&4294967295,I.g[0]=I.g[0]+j&4294967295,I.g[1]=I.g[1]+(D+(M<<21&4294967295|M>>>11))&4294967295,I.g[2]=I.g[2]+D&4294967295,I.g[3]=I.g[3]+z&4294967295}i.prototype.v=function(I,j){j===void 0&&(j=I.length);const R=j-this.blockSize,P=this.C;let D=this.h,z=0;for(;z<j;){if(D==0)for(;z<=R;)l(this,I,z),z+=this.blockSize;if(typeof I=="string"){for(;z<j;)if(P[D++]=I.charCodeAt(z++),D==this.blockSize){l(this,P),D=0;break}}else for(;z<j;)if(P[D++]=I[z++],D==this.blockSize){l(this,P),D=0;break}}this.h=D,this.o+=j},i.prototype.A=function(){var I=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);I[0]=128;for(var j=1;j<I.length-8;++j)I[j]=0;j=this.o*8;for(var R=I.length-8;R<I.length;++R)I[R]=j&255,j/=256;for(this.v(I),I=Array(16),j=0,R=0;R<4;++R)for(let P=0;P<32;P+=8)I[j++]=this.g[R]>>>P&255;return I};function u(I,j){var R=p;return Object.prototype.hasOwnProperty.call(R,I)?R[I]:R[I]=j(I)}function h(I,j){this.h=j;const R=[];let P=!0;for(let D=I.length-1;D>=0;D--){const z=I[D]|0;P&&z==j||(R[D]=z,P=!1)}this.g=R}var p={};function g(I){return-128<=I&&I<128?u(I,function(j){return new h([j|0],j<0?-1:0)}):new h([I|0],I<0?-1:0)}function y(I){if(isNaN(I)||!isFinite(I))return k;if(I<0)return V(y(-I));const j=[];let R=1;for(let P=0;I>=R;P++)j[P]=I/R|0,R*=4294967296;return new h(j,0)}function w(I,j){if(I.length==0)throw Error("number format error: empty string");if(j=j||10,j<2||36<j)throw Error("radix out of range: "+j);if(I.charAt(0)=="-")return V(w(I.substring(1),j));if(I.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=y(Math.pow(j,8));let P=k;for(let z=0;z<I.length;z+=8){var D=Math.min(8,I.length-z);const M=parseInt(I.substring(z,z+D),j);D<8?(D=y(Math.pow(j,D)),P=P.j(D).add(y(M))):(P=P.j(R),P=P.add(y(M)))}return P}var k=g(0),E=g(1),O=g(16777216);s=h.prototype,s.m=function(){if(U(this))return-V(this).m();let I=0,j=1;for(let R=0;R<this.g.length;R++){const P=this.i(R);I+=(P>=0?P:4294967296+P)*j,j*=4294967296}return I},s.toString=function(I){if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(G(this))return"0";if(U(this))return"-"+V(this).toString(I);const j=y(Math.pow(I,6));var R=this;let P="";for(;;){const D=Te(R,j).g;R=ne(R,D.j(j));let z=((R.g.length>0?R.g[0]:R.h)>>>0).toString(I);if(R=D,G(R))return z+P;for(;z.length<6;)z="0"+z;P=z+P}},s.i=function(I){return I<0?0:I<this.g.length?this.g[I]:this.h};function G(I){if(I.h!=0)return!1;for(let j=0;j<I.g.length;j++)if(I.g[j]!=0)return!1;return!0}function U(I){return I.h==-1}s.l=function(I){return I=ne(this,I),U(I)?-1:G(I)?0:1};function V(I){const j=I.g.length,R=[];for(let P=0;P<j;P++)R[P]=~I.g[P];return new h(R,~I.h).add(E)}s.abs=function(){return U(this)?V(this):this},s.add=function(I){const j=Math.max(this.g.length,I.g.length),R=[];let P=0;for(let D=0;D<=j;D++){let z=P+(this.i(D)&65535)+(I.i(D)&65535),M=(z>>>16)+(this.i(D)>>>16)+(I.i(D)>>>16);P=M>>>16,z&=65535,M&=65535,R[D]=M<<16|z}return new h(R,R[R.length-1]&-2147483648?-1:0)};function ne(I,j){return I.add(V(j))}s.j=function(I){if(G(this)||G(I))return k;if(U(this))return U(I)?V(this).j(V(I)):V(V(this).j(I));if(U(I))return V(this.j(V(I)));if(this.l(O)<0&&I.l(O)<0)return y(this.m()*I.m());const j=this.g.length+I.g.length,R=[];for(var P=0;P<2*j;P++)R[P]=0;for(P=0;P<this.g.length;P++)for(let D=0;D<I.g.length;D++){const z=this.i(P)>>>16,M=this.i(P)&65535,We=I.i(D)>>>16,wt=I.i(D)&65535;R[2*P+2*D]+=M*wt,J(R,2*P+2*D),R[2*P+2*D+1]+=z*wt,J(R,2*P+2*D+1),R[2*P+2*D+1]+=M*We,J(R,2*P+2*D+1),R[2*P+2*D+2]+=z*We,J(R,2*P+2*D+2)}for(I=0;I<j;I++)R[I]=R[2*I+1]<<16|R[2*I];for(I=j;I<2*j;I++)R[I]=0;return new h(R,0)};function J(I,j){for(;(I[j]&65535)!=I[j];)I[j+1]+=I[j]>>>16,I[j]&=65535,j++}function fe(I,j){this.g=I,this.h=j}function Te(I,j){if(G(j))throw Error("division by zero");if(G(I))return new fe(k,k);if(U(I))return j=Te(V(I),j),new fe(V(j.g),V(j.h));if(U(j))return j=Te(I,V(j)),new fe(V(j.g),j.h);if(I.g.length>30){if(U(I)||U(j))throw Error("slowDivide_ only works with positive integers.");for(var R=E,P=j;P.l(I)<=0;)R=$e(R),P=$e(P);var D=Ve(R,1),z=Ve(P,1);for(P=Ve(P,2),R=Ve(R,2);!G(P);){var M=z.add(P);M.l(I)<=0&&(D=D.add(R),z=M),P=Ve(P,1),R=Ve(R,1)}return j=ne(I,D.j(j)),new fe(D,j)}for(D=k;I.l(j)>=0;){for(R=Math.max(1,Math.floor(I.m()/j.m())),P=Math.ceil(Math.log(R)/Math.LN2),P=P<=48?1:Math.pow(2,P-48),z=y(R),M=z.j(j);U(M)||M.l(I)>0;)R-=P,z=y(R),M=z.j(j);G(z)&&(z=E),D=D.add(z),I=ne(I,M)}return new fe(D,I)}s.B=function(I){return Te(this,I).h},s.and=function(I){const j=Math.max(this.g.length,I.g.length),R=[];for(let P=0;P<j;P++)R[P]=this.i(P)&I.i(P);return new h(R,this.h&I.h)},s.or=function(I){const j=Math.max(this.g.length,I.g.length),R=[];for(let P=0;P<j;P++)R[P]=this.i(P)|I.i(P);return new h(R,this.h|I.h)},s.xor=function(I){const j=Math.max(this.g.length,I.g.length),R=[];for(let P=0;P<j;P++)R[P]=this.i(P)^I.i(P);return new h(R,this.h^I.h)};function $e(I){const j=I.g.length+1,R=[];for(let P=0;P<j;P++)R[P]=I.i(P)<<1|I.i(P-1)>>>31;return new h(R,I.h)}function Ve(I,j){const R=j>>5;j%=32;const P=I.g.length-R,D=[];for(let z=0;z<P;z++)D[z]=j>0?I.i(z+R)>>>j|I.i(z+R+1)<<32-j:I.i(z+R);return new h(D,I.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Mw=i,h.prototype.add=h.prototype.add,h.prototype.multiply=h.prototype.j,h.prototype.modulo=h.prototype.B,h.prototype.compare=h.prototype.l,h.prototype.toNumber=h.prototype.m,h.prototype.toString=h.prototype.toString,h.prototype.getBits=h.prototype.i,h.fromNumber=y,h.fromString=w,Xi=h}).apply(typeof ax<"u"?ax:typeof self<"u"?self:typeof window<"u"?window:{});var Jh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Dw,Kc,Pw,yd,lg,Lw,Ow,Vw;(function(){var s,e=Object.defineProperty;function n(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof Jh=="object"&&Jh];for(var v=0;v<d.length;++v){var _=d[v];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var i=n(this);function l(d,v){if(v)e:{var _=i;d=d.split(".");for(var N=0;N<d.length-1;N++){var ee=d[N];if(!(ee in _))break e;_=_[ee]}d=d[d.length-1],N=_[d],v=v(N),v!=N&&v!=null&&e(_,d,{configurable:!0,writable:!0,value:v})}}l("Symbol.dispose",function(d){return d||Symbol("Symbol.dispose")}),l("Array.prototype.values",function(d){return d||function(){return this[Symbol.iterator]()}}),l("Object.entries",function(d){return d||function(v){var _=[],N;for(N in v)Object.prototype.hasOwnProperty.call(v,N)&&_.push([N,v[N]]);return _}});var u=u||{},h=this||self;function p(d){var v=typeof d;return v=="object"&&d!=null||v=="function"}function g(d,v,_){return d.call.apply(d.bind,arguments)}function y(d,v,_){return y=g,y.apply(null,arguments)}function w(d,v){var _=Array.prototype.slice.call(arguments,1);return function(){var N=_.slice();return N.push.apply(N,arguments),d.apply(this,N)}}function k(d,v){function _(){}_.prototype=v.prototype,d.Z=v.prototype,d.prototype=new _,d.prototype.constructor=d,d.Ob=function(N,ee,ue){for(var Ge=Array(arguments.length-2),Zt=2;Zt<arguments.length;Zt++)Ge[Zt-2]=arguments[Zt];return v.prototype[ee].apply(N,Ge)}}var E=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?d=>d&&AsyncContext.Snapshot.wrap(d):d=>d;function O(d){const v=d.length;if(v>0){const _=Array(v);for(let N=0;N<v;N++)_[N]=d[N];return _}return[]}function G(d,v){for(let N=1;N<arguments.length;N++){const ee=arguments[N];var _=typeof ee;if(_=_!="object"?_:ee?Array.isArray(ee)?"array":_:"null",_=="array"||_=="object"&&typeof ee.length=="number"){_=d.length||0;const ue=ee.length||0;d.length=_+ue;for(let Ge=0;Ge<ue;Ge++)d[_+Ge]=ee[Ge]}else d.push(ee)}}class U{constructor(v,_){this.i=v,this.j=_,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function V(d){h.setTimeout(()=>{throw d},0)}function ne(){var d=I;let v=null;return d.g&&(v=d.g,d.g=d.g.next,d.g||(d.h=null),v.next=null),v}class J{constructor(){this.h=this.g=null}add(v,_){const N=fe.get();N.set(v,_),this.h?this.h.next=N:this.g=N,this.h=N}}var fe=new U(()=>new Te,d=>d.reset());class Te{constructor(){this.next=this.g=this.h=null}set(v,_){this.h=v,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let $e,Ve=!1,I=new J,j=()=>{const d=Promise.resolve(void 0);$e=()=>{d.then(R)}};function R(){for(var d;d=ne();){try{d.h.call(d.g)}catch(_){V(_)}var v=fe;v.j(d),v.h<100&&(v.h++,d.next=v.g,v.g=d)}Ve=!1}function P(){this.u=this.u,this.C=this.C}P.prototype.u=!1,P.prototype.dispose=function(){this.u||(this.u=!0,this.N())},P.prototype[Symbol.dispose]=function(){this.dispose()},P.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(d,v){this.type=d,this.g=this.target=v,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var z=(function(){if(!h.addEventListener||!Object.defineProperty)return!1;var d=!1,v=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const _=()=>{};h.addEventListener("test",_,v),h.removeEventListener("test",_,v)}catch{}return d})();function M(d){return/^[\s\xa0]*$/.test(d)}function We(d,v){D.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d&&this.init(d,v)}k(We,D),We.prototype.init=function(d,v){const _=this.type=d.type,N=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;this.target=d.target||d.srcElement,this.g=v,v=d.relatedTarget,v||(_=="mouseover"?v=d.fromElement:_=="mouseout"&&(v=d.toElement)),this.relatedTarget=v,N?(this.clientX=N.clientX!==void 0?N.clientX:N.pageX,this.clientY=N.clientY!==void 0?N.clientY:N.pageY,this.screenX=N.screenX||0,this.screenY=N.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=d.pointerType,this.state=d.state,this.i=d,d.defaultPrevented&&We.Z.h.call(this)},We.prototype.h=function(){We.Z.h.call(this);const d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var wt="closure_listenable_"+(Math.random()*1e6|0),Q=0;function je(d,v,_,N,ee){this.listener=d,this.proxy=null,this.src=v,this.type=_,this.capture=!!N,this.ha=ee,this.key=++Q,this.da=this.fa=!1}function ze(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function lt(d,v,_){for(const N in d)v.call(_,d[N],N,d)}function ie(d,v){for(const _ in d)v.call(void 0,d[_],_,d)}function L(d){const v={};for(const _ in d)v[_]=d[_];return v}const H="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ye(d,v){let _,N;for(let ee=1;ee<arguments.length;ee++){N=arguments[ee];for(_ in N)d[_]=N[_];for(let ue=0;ue<H.length;ue++)_=H[ue],Object.prototype.hasOwnProperty.call(N,_)&&(d[_]=N[_])}}function Se(d){this.src=d,this.g={},this.h=0}Se.prototype.add=function(d,v,_,N,ee){const ue=d.toString();d=this.g[ue],d||(d=this.g[ue]=[],this.h++);const Ge=Ae(d,v,N,ee);return Ge>-1?(v=d[Ge],_||(v.fa=!1)):(v=new je(v,this.src,ue,!!N,ee),v.fa=_,d.push(v)),v};function qe(d,v){const _=v.type;if(_ in d.g){var N=d.g[_],ee=Array.prototype.indexOf.call(N,v,void 0),ue;(ue=ee>=0)&&Array.prototype.splice.call(N,ee,1),ue&&(ze(v),d.g[_].length==0&&(delete d.g[_],d.h--))}}function Ae(d,v,_,N){for(let ee=0;ee<d.length;++ee){const ue=d[ee];if(!ue.da&&ue.listener==v&&ue.capture==!!_&&ue.ha==N)return ee}return-1}var nt="closure_lm_"+(Math.random()*1e6|0),pt={};function Je(d,v,_,N,ee){if(Array.isArray(v)){for(let ue=0;ue<v.length;ue++)Je(d,v[ue],_,N,ee);return null}return _=Bt(_),d&&d[wt]?d.J(v,_,p(N)?!!N.capture:!1,ee):qt(d,v,_,!1,N,ee)}function qt(d,v,_,N,ee,ue){if(!v)throw Error("Invalid event type");const Ge=p(ee)?!!ee.capture:!!ee;let Zt=Ht(d);if(Zt||(d[nt]=Zt=new Se(d)),_=Zt.add(v,_,N,Ge,ue),_.proxy)return _;if(N=cn(),_.proxy=N,N.src=d,N.listener=_,d.addEventListener)z||(ee=Ge),ee===void 0&&(ee=!1),d.addEventListener(v.toString(),N,ee);else if(d.attachEvent)d.attachEvent(oe(v.toString()),N);else if(d.addListener&&d.removeListener)d.addListener(N);else throw Error("addEventListener and attachEvent are unavailable.");return _}function cn(){function d(_){return v.call(d.src,d.listener,_)}const v=En;return d}function Nt(d,v,_,N,ee){if(Array.isArray(v))for(var ue=0;ue<v.length;ue++)Nt(d,v[ue],_,N,ee);else N=p(N)?!!N.capture:!!N,_=Bt(_),d&&d[wt]?(d=d.i,ue=String(v).toString(),ue in d.g&&(v=d.g[ue],_=Ae(v,_,N,ee),_>-1&&(ze(v[_]),Array.prototype.splice.call(v,_,1),v.length==0&&(delete d.g[ue],d.h--)))):d&&(d=Ht(d))&&(v=d.g[v.toString()],d=-1,v&&(d=Ae(v,_,N,ee)),(_=d>-1?v[d]:null)&&Ct(_))}function Ct(d){if(typeof d!="number"&&d&&!d.da){var v=d.src;if(v&&v[wt])qe(v.i,d);else{var _=d.type,N=d.proxy;v.removeEventListener?v.removeEventListener(_,N,d.capture):v.detachEvent?v.detachEvent(oe(_),N):v.addListener&&v.removeListener&&v.removeListener(N),(_=Ht(v))?(qe(_,d),_.h==0&&(_.src=null,v[nt]=null)):ze(d)}}}function oe(d){return d in pt?pt[d]:pt[d]="on"+d}function En(d,v){if(d.da)d=!0;else{v=new We(v,this);const _=d.listener,N=d.ha||d.src;d.fa&&Ct(d),d=_.call(N,v)}return d}function Ht(d){return d=d[nt],d instanceof Se?d:null}var St="__closure_events_fn_"+(Math.random()*1e9>>>0);function Bt(d){return typeof d=="function"?d:(d[St]||(d[St]=function(v){return d.handleEvent(v)}),d[St])}function ht(){P.call(this),this.i=new Se(this),this.M=this,this.G=null}k(ht,P),ht.prototype[wt]=!0,ht.prototype.removeEventListener=function(d,v,_,N){Nt(this,d,v,_,N)};function et(d,v){var _,N=d.G;if(N)for(_=[];N;N=N.G)_.push(N);if(d=d.M,N=v.type||v,typeof v=="string")v=new D(v,d);else if(v instanceof D)v.target=v.target||d;else{var ee=v;v=new D(N,d),ye(v,ee)}ee=!0;let ue,Ge;if(_)for(Ge=_.length-1;Ge>=0;Ge--)ue=v.g=_[Ge],ee=tn(ue,N,!0,v)&&ee;if(ue=v.g=d,ee=tn(ue,N,!0,v)&&ee,ee=tn(ue,N,!1,v)&&ee,_)for(Ge=0;Ge<_.length;Ge++)ue=v.g=_[Ge],ee=tn(ue,N,!1,v)&&ee}ht.prototype.N=function(){if(ht.Z.N.call(this),this.i){var d=this.i;for(const v in d.g){const _=d.g[v];for(let N=0;N<_.length;N++)ze(_[N]);delete d.g[v],d.h--}}this.G=null},ht.prototype.J=function(d,v,_,N){return this.i.add(String(d),v,!1,_,N)},ht.prototype.K=function(d,v,_,N){return this.i.add(String(d),v,!0,_,N)};function tn(d,v,_,N){if(v=d.i.g[String(v)],!v)return!0;v=v.concat();let ee=!0;for(let ue=0;ue<v.length;++ue){const Ge=v[ue];if(Ge&&!Ge.da&&Ge.capture==_){const Zt=Ge.listener,vs=Ge.ha||Ge.src;Ge.fa&&qe(d.i,Ge),ee=Zt.call(vs,N)!==!1&&ee}}return ee&&!N.defaultPrevented}function ss(d,v){if(typeof d!="function")if(d&&typeof d.handleEvent=="function")d=y(d.handleEvent,d);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:h.setTimeout(d,v||0)}function Pt(d){d.g=ss(()=>{d.g=null,d.i&&(d.i=!1,Pt(d))},d.l);const v=d.h;d.h=null,d.m.apply(null,v)}class Et extends P{constructor(v,_){super(),this.m=v,this.l=_,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:Pt(this)}N(){super.N(),this.g&&(h.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ln(d){P.call(this),this.h=d,this.g={}}k(Ln,P);var zt=[];function Sn(d){lt(d.g,function(v,_){this.g.hasOwnProperty(_)&&Ct(v)},d),d.g={}}Ln.prototype.N=function(){Ln.Z.N.call(this),Sn(this)},Ln.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Kt=h.JSON.stringify,Nn=h.JSON.parse,me=class{stringify(d){return h.JSON.stringify(d,void 0)}parse(d){return h.JSON.parse(d,void 0)}};function Ee(){}function Fe(){}var Ye={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Be(){D.call(this,"d")}k(Be,D);function Me(){D.call(this,"c")}k(Me,D);var Le={},xt=null;function mt(){return xt=xt||new ht}Le.Ia="serverreachability";function Y(d){D.call(this,Le.Ia,d)}k(Y,D);function Ne(d){const v=mt();et(v,new Y(v))}Le.STAT_EVENT="statevent";function Qe(d,v){D.call(this,Le.STAT_EVENT,d),this.stat=v}k(Qe,D);function Xe(d){const v=mt();et(v,new Qe(v,d))}Le.Ja="timingevent";function dt(d,v){D.call(this,Le.Ja,d),this.size=v}k(dt,D);function Ft(d,v){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return h.setTimeout(function(){d()},v)}function Rt(){this.g=!0}Rt.prototype.ua=function(){this.g=!1};function nn(d,v,_,N,ee,ue){d.info(function(){if(d.g)if(ue){var Ge="",Zt=ue.split("&");for(let Mn=0;Mn<Zt.length;Mn++){var vs=Zt[Mn].split("=");if(vs.length>1){const is=vs[0];vs=vs[1];const Vr=is.split("_");Ge=Vr.length>=2&&Vr[1]=="type"?Ge+(is+"="+vs+"&"):Ge+(is+"=redacted&")}}}else Ge=null;else Ge=ue;return"XMLHTTP REQ ("+N+") [attempt "+ee+"]: "+v+`
`+_+`
`+Ge})}function Vn(d,v,_,N,ee,ue,Ge){d.info(function(){return"XMLHTTP RESP ("+N+") [ attempt "+ee+"]: "+v+`
`+_+`
`+ue+" "+Ge})}function An(d,v,_,N){d.info(function(){return"XMLHTTP TEXT ("+v+"): "+yn(d,_)+(N?" "+N:"")})}function rn(d,v){d.info(function(){return"TIMEOUT: "+v})}Rt.prototype.info=function(){};function yn(d,v){if(!d.g)return v;if(!v)return null;try{const ue=JSON.parse(v);if(ue){for(d=0;d<ue.length;d++)if(Array.isArray(ue[d])){var _=ue[d];if(!(_.length<2)){var N=_[1];if(Array.isArray(N)&&!(N.length<1)){var ee=N[0];if(ee!="noop"&&ee!="stop"&&ee!="close")for(let Ge=1;Ge<N.length;Ge++)N[Ge]=""}}}}return Kt(ue)}catch{return v}}var In={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},un={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},rs;function q(){}k(q,Ee),q.prototype.g=function(){return new XMLHttpRequest},rs=new q;function pe(d){return encodeURIComponent(String(d))}function we(d){var v=1;d=d.split(":");const _=[];for(;v>0&&d.length;)_.push(d.shift()),v--;return d.length&&_.push(d.join(":")),_}function ve(d,v,_,N){this.j=d,this.i=v,this.l=_,this.S=N||1,this.V=new Ln(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ge}function ge(){this.i=null,this.g="",this.h=!1}var st={},At={};function ct(d,v,_){d.M=1,d.A=an(Ce(v)),d.u=_,d.R=!0,_t(d,null)}function _t(d,v){d.F=Date.now(),_s(d),d.B=Ce(d.A);var _=d.B,N=d.S;Array.isArray(N)||(N=[String(N)]),Ps(_.i,"t",N),d.C=0,_=d.j.L,d.h=new ge,d.g=qu(d.j,_?v:null,!d.u),d.P>0&&(d.O=new Et(y(d.Y,d,d.g),d.P)),v=d.V,_=d.g,N=d.ba;var ee="readystatechange";Array.isArray(ee)||(ee&&(zt[0]=ee.toString()),ee=zt);for(let ue=0;ue<ee.length;ue++){const Ge=Je(_,ee[ue],N||v.handleEvent,!1,v.h||v);if(!Ge)break;v.g[Ge.key]=Ge}v=d.J?L(d.J):{},d.u?(d.v||(d.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.B,d.v,d.u,v)):(d.v="GET",d.g.ea(d.B,d.v,null,v)),Ne(),nn(d.i,d.v,d.B,d.l,d.S,d.u)}ve.prototype.ba=function(d){d=d.target;const v=this.O;v&&$s(d)==3?v.j():this.Y(d)},ve.prototype.Y=function(d){try{if(d==this.g)e:{const Zt=$s(this.g),vs=this.g.ya(),Mn=this.g.ca();if(!(Zt<3)&&(Zt!=3||this.g&&(this.h.h||this.g.la()||es(this.g)))){this.K||Zt!=4||vs==7||(vs==8||Mn<=0?Ne(3):Ne(2)),Bn(this);var v=this.g.ca();this.X=v;var _=vt(this);if(this.o=v==200,Vn(this.i,this.v,this.B,this.l,this.S,Zt,v),this.o){if(this.U&&!this.L){t:{if(this.g){var N,ee=this.g;if((N=ee.g?ee.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(N)){var ue=N;break t}}ue=null}if(d=ue)An(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,T(this,d);else{this.o=!1,this.m=3,Xe(12),ce(this),F(this);break e}}if(this.R){d=!0;let is;for(;!this.K&&this.C<_.length;)if(is=er(this,_),is==At){Zt==4&&(this.m=4,Xe(14),d=!1),An(this.i,this.l,null,"[Incomplete Response]");break}else if(is==st){this.m=4,Xe(15),An(this.i,this.l,_,"[Invalid Chunk]"),d=!1;break}else An(this.i,this.l,is,null),T(this,is);if(vn(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Zt!=4||_.length!=0||this.h.h||(this.m=1,Xe(16),d=!1),this.o=this.o&&d,!d)An(this.i,this.l,_,"[Invalid Chunked Response]"),ce(this),F(this);else if(_.length>0&&!this.W){this.W=!0;var Ge=this.j;Ge.g==this&&Ge.aa&&!Ge.P&&(Ge.j.info("Great, no buffering proxy detected. Bytes received: "+_.length),tc(Ge),Ge.P=!0,Xe(11))}}else An(this.i,this.l,_,null),T(this,_);Zt==4&&ce(this),this.o&&!this.K&&(Zt==4?Bu(this.j,this):(this.o=!1,_s(this)))}else hr(this.g),v==400&&_.indexOf("Unknown SID")>0?(this.m=3,Xe(12)):(this.m=0,Xe(13)),ce(this),F(this)}}}catch{}};function vt(d){if(!vn(d))return d.g.la();const v=es(d.g);if(v==="")return"";let _="";const N=v.length,ee=$s(d.g)==4;if(!d.h.i){if(typeof TextDecoder>"u")return ce(d),F(d),"";d.h.i=new h.TextDecoder}for(let ue=0;ue<N;ue++)d.h.h=!0,_+=d.h.i.decode(v[ue],{stream:!(ee&&ue==N-1)});return v.length=0,d.h.g+=_,d.C=0,d.h.g}function vn(d){return d.g?d.v=="GET"&&d.M!=2&&d.j.Aa:!1}function er(d,v){var _=d.C,N=v.indexOf(`
`,_);return N==-1?At:(_=Number(v.substring(_,N)),isNaN(_)?st:(N+=1,N+_>v.length?At:(v=v.slice(N,N+_),d.C=N+_,v)))}ve.prototype.cancel=function(){this.K=!0,ce(this)};function _s(d){d.T=Date.now()+d.H,Ds(d,d.H)}function Ds(d,v){if(d.D!=null)throw Error("WatchDog timer not null");d.D=Ft(y(d.aa,d),v)}function Bn(d){d.D&&(h.clearTimeout(d.D),d.D=null)}ve.prototype.aa=function(){this.D=null;const d=Date.now();d-this.T>=0?(rn(this.i,this.B),this.M!=2&&(Ne(),Xe(17)),ce(this),this.m=2,F(this)):Ds(this,this.T-d)};function F(d){d.j.I==0||d.K||Bu(d.j,d)}function ce(d){Bn(d);var v=d.O;v&&typeof v.dispose=="function"&&v.dispose(),d.O=null,Sn(d.V),d.g&&(v=d.g,d.g=null,v.abort(),v.dispose())}function T(d,v){try{var _=d.j;if(_.I!=0&&(_.g==d||Ue(_.h,d))){if(!d.L&&Ue(_.h,d)&&_.I==3){try{var N=_.Ba.g.parse(v)}catch{N=null}if(Array.isArray(N)&&N.length==3){var ee=N;if(ee[0]==0){e:if(!_.v){if(_.g)if(_.g.F+3e3<d.F)Yo(_),Gs(_);else break e;ho(_),Xe(18)}}else _.xa=ee[1],0<_.xa-_.K&&ee[2]<37500&&_.F&&_.A==0&&!_.C&&(_.C=Ft(y(_.Va,_),6e3));He(_.h)<=1&&_.ta&&(_.ta=void 0)}else ga(_,11)}else if((d.L||_.g==d)&&Yo(_),!M(v))for(ee=_.Ba.g.parse(v),v=0;v<ee.length;v++){let Mn=ee[v];const is=Mn[0];if(!(is<=_.K))if(_.K=is,Mn=Mn[1],_.I==2)if(Mn[0]=="c"){_.M=Mn[1],_.ba=Mn[2];const Vr=Mn[3];Vr!=null&&(_.ka=Vr,_.j.info("VER="+_.ka));const ya=Mn[4];ya!=null&&(_.za=ya,_.j.info("SVER="+_.za));const ta=Mn[5];ta!=null&&typeof ta=="number"&&ta>0&&(N=1.5*ta,_.O=N,_.j.info("backChannelRequestTimeoutMs_="+N)),N=_;const na=d.g;if(na){const fo=na.g?na.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(fo){var ue=N.h;ue.g||fo.indexOf("spdy")==-1&&fo.indexOf("quic")==-1&&fo.indexOf("h2")==-1||(ue.j=ue.l,ue.g=new Set,ue.h&&(Oe(ue,ue.h),ue.h=null))}if(N.G){const Qo=na.g?na.g.getResponseHeader("X-HTTP-Session-Id"):null;Qo&&(N.wa=Qo,ot(N.J,N.G,Qo))}}_.I=3,_.l&&_.l.ra(),_.aa&&(_.T=Date.now()-d.F,_.j.info("Handshake RTT: "+_.T+"ms")),N=_;var Ge=d;if(N.na=Fu(N,N.L?N.ba:null,N.W),Ge.L){Ut(N.h,Ge);var Zt=Ge,vs=N.O;vs&&(Zt.H=vs),Zt.D&&(Bn(Zt),_s(Zt)),N.g=Ge}else ea(N);_.i.length>0&&jr(_)}else Mn[0]!="stop"&&Mn[0]!="close"||ga(_,7);else _.I==3&&(Mn[0]=="stop"||Mn[0]=="close"?Mn[0]=="stop"?ga(_,7):Ws(_):Mn[0]!="noop"&&_.l&&_.l.qa(Mn),_.A=0)}}Ne(4)}catch{}}var C=class{constructor(d,v){this.g=d,this.map=v}};function K(d){this.l=d||10,h.PerformanceNavigationTiming?(d=h.performance.getEntriesByType("navigation"),d=d.length>0&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(h.chrome&&h.chrome.loadTimes&&h.chrome.loadTimes()&&h.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function te(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function He(d){return d.h?1:d.g?d.g.size:0}function Ue(d,v){return d.h?d.h==v:d.g?d.g.has(v):!1}function Oe(d,v){d.g?d.g.add(v):d.h=v}function Ut(d,v){d.h&&d.h==v?d.h=null:d.g&&d.g.has(v)&&d.g.delete(v)}K.prototype.cancel=function(){if(this.i=kt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function kt(d){if(d.h!=null)return d.i.concat(d.h.G);if(d.g!=null&&d.g.size!==0){let v=d.i;for(const _ of d.g.values())v=v.concat(_.G);return v}return O(d.i)}var $=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function he(d,v){if(d){d=d.split("&");for(let _=0;_<d.length;_++){const N=d[_].indexOf("=");let ee,ue=null;N>=0?(ee=d[_].substring(0,N),ue=d[_].substring(N+1)):ee=d[_],v(ee,ue?decodeURIComponent(ue.replace(/\+/g," ")):"")}}}function ae(d){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;d instanceof ae?(this.l=d.l,Pe(this,d.j),this.o=d.o,this.g=d.g,rt(this,d.u),this.h=d.h,It(this,Lr(d.i)),this.m=d.m):d&&(v=String(d).match($))?(this.l=!1,Pe(this,v[1]||"",!0),this.o=Un(v[2]||""),this.g=Un(v[3]||"",!0),rt(this,v[4]),this.h=Un(v[5]||"",!0),It(this,v[6]||"",!0),this.m=Un(v[7]||"")):(this.l=!1,this.i=new Jn(null,this.l))}ae.prototype.toString=function(){const d=[];var v=this.j;v&&d.push(bn(v,xr,!0),":");var _=this.g;return(_||v=="file")&&(d.push("//"),(v=this.o)&&d.push(bn(v,xr,!0),"@"),d.push(pe(_).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.u,_!=null&&d.push(":",String(_))),(_=this.h)&&(this.g&&_.charAt(0)!="/"&&d.push("/"),d.push(bn(_,_.charAt(0)=="/"?Jr:La,!0))),(_=this.i.toString())&&d.push("?",_),(_=this.m)&&d.push("#",bn(_,wn)),d.join("")},ae.prototype.resolve=function(d){const v=Ce(this);let _=!!d.j;_?Pe(v,d.j):_=!!d.o,_?v.o=d.o:_=!!d.g,_?v.g=d.g:_=d.u!=null;var N=d.h;if(_)rt(v,d.u);else if(_=!!d.h){if(N.charAt(0)!="/")if(this.g&&!this.h)N="/"+N;else{var ee=v.h.lastIndexOf("/");ee!=-1&&(N=v.h.slice(0,ee+1)+N)}if(ee=N,ee==".."||ee==".")N="";else if(ee.indexOf("./")!=-1||ee.indexOf("/.")!=-1){N=ee.lastIndexOf("/",0)==0,ee=ee.split("/");const ue=[];for(let Ge=0;Ge<ee.length;){const Zt=ee[Ge++];Zt=="."?N&&Ge==ee.length&&ue.push(""):Zt==".."?((ue.length>1||ue.length==1&&ue[0]!="")&&ue.pop(),N&&Ge==ee.length&&ue.push("")):(ue.push(Zt),N=!0)}N=ue.join("/")}else N=ee}return _?v.h=N:_=d.i.toString()!=="",_?It(v,Lr(d.i)):_=!!d.m,_&&(v.m=d.m),v};function Ce(d){return new ae(d)}function Pe(d,v,_){d.j=_?Un(v,!0):v,d.j&&(d.j=d.j.replace(/:$/,""))}function rt(d,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);d.u=v}else d.u=null}function It(d,v,_){v instanceof Jn?(d.i=v,pa(d.i,d.l)):(_||(v=bn(v,wr)),d.i=new Jn(v,d.l))}function ot(d,v,_){d.i.set(v,_)}function an(d){return ot(d,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),d}function Un(d,v){return d?v?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function bn(d,v,_){return typeof d=="string"?(d=encodeURI(d).replace(v,xn),_&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function xn(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var xr=/[#\/\?@]/g,La=/[#\?:]/g,Jr=/[#\?]/g,wr=/[#\?@]/g,wn=/#/g;function Jn(d,v){this.h=this.g=null,this.i=d||null,this.j=!!v}function Kn(d){d.g||(d.g=new Map,d.h=0,d.i&&he(d.i,function(v,_){d.add(decodeURIComponent(v.replace(/\+/g," ")),_)}))}s=Jn.prototype,s.add=function(d,v){Kn(this),this.i=null,d=kr(this,d);let _=this.g.get(d);return _||this.g.set(d,_=[]),_.push(v),this.h+=1,this};function _r(d,v){Kn(d),v=kr(d,v),d.g.has(v)&&(d.i=null,d.h-=d.g.get(v).length,d.g.delete(v))}function cr(d,v){return Kn(d),v=kr(d,v),d.g.has(v)}s.forEach=function(d,v){Kn(this),this.g.forEach(function(_,N){_.forEach(function(ee){d.call(v,ee,N,this)},this)},this)};function As(d,v){Kn(d);let _=[];if(typeof v=="string")cr(d,v)&&(_=_.concat(d.g.get(kr(d,v))));else for(d=Array.from(d.g.values()),v=0;v<d.length;v++)_=_.concat(d[v]);return _}s.set=function(d,v){return Kn(this),this.i=null,d=kr(this,d),cr(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[v]),this.h+=1,this},s.get=function(d,v){return d?(d=As(this,d),d.length>0?String(d[0]):v):v};function Ps(d,v,_){_r(d,v),_.length>0&&(d.i=null,d.g.set(kr(d,v),O(_)),d.h+=_.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],v=Array.from(this.g.keys());for(let N=0;N<v.length;N++){var _=v[N];const ee=pe(_);_=As(this,_);for(let ue=0;ue<_.length;ue++){let Ge=ee;_[ue]!==""&&(Ge+="="+pe(_[ue])),d.push(Ge)}}return this.i=d.join("&")};function Lr(d){const v=new Jn;return v.i=d.i,d.g&&(v.g=new Map(d.g),v.h=d.h),v}function kr(d,v){return v=String(v),d.j&&(v=v.toLowerCase()),v}function pa(d,v){v&&!d.j&&(Kn(d),d.i=null,d.g.forEach(function(_,N){const ee=N.toLowerCase();N!=ee&&(_r(this,N),Ps(this,ee,_))},d)),d.j=v}function A(d,v){const _=new Rt;if(h.Image){const N=new Image;N.onload=w(De,_,"TestLoadImage: loaded",!0,v,N),N.onerror=w(De,_,"TestLoadImage: error",!1,v,N),N.onabort=w(De,_,"TestLoadImage: abort",!1,v,N),N.ontimeout=w(De,_,"TestLoadImage: timeout",!1,v,N),h.setTimeout(function(){N.ontimeout&&N.ontimeout()},1e4),N.src=d}else v(!1)}function Z(d,v){const _=new Rt,N=new AbortController,ee=setTimeout(()=>{N.abort(),De(_,"TestPingServer: timeout",!1,v)},1e4);fetch(d,{signal:N.signal}).then(ue=>{clearTimeout(ee),ue.ok?De(_,"TestPingServer: ok",!0,v):De(_,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(ee),De(_,"TestPingServer: error",!1,v)})}function De(d,v,_,N,ee){try{ee&&(ee.onload=null,ee.onerror=null,ee.onabort=null,ee.ontimeout=null),N(_)}catch{}}function Ze(){this.g=new me}function ft(d){this.i=d.Sb||null,this.h=d.ab||!1}k(ft,Ee),ft.prototype.g=function(){return new at(this.i,this.h)};function at(d,v){ht.call(this),this.H=d,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}k(at,ht),s=at.prototype,s.open=function(d,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=d,this.D=v,this.readyState=1,Dt(this)},s.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};d&&(v.body=d),(this.H||h).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Lt(this)),this.readyState=0},s.Pa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Dt(this)),this.g&&(this.readyState=3,Dt(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof h.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;gt(this)}else d.text().then(this.Oa.bind(this),this.ga.bind(this))};function gt(d){d.j.read().then(d.Ma.bind(d)).catch(d.ga.bind(d))}s.Ma=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var v=d.value?d.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!d.done}))&&(this.response=this.responseText+=v)}d.done?Lt(this):Dt(this),this.readyState==3&&gt(this)}},s.Oa=function(d){this.g&&(this.response=this.responseText=d,Lt(this))},s.Na=function(d){this.g&&(this.response=d,Lt(this))},s.ga=function(){this.g&&Lt(this)};function Lt(d){d.readyState=4,d.l=null,d.j=null,d.B=null,Dt(d)}s.setRequestHeader=function(d,v){this.A.append(d,v)},s.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],v=this.h.entries();for(var _=v.next();!_.done;)_=_.value,d.push(_[0]+": "+_[1]),_=v.next();return d.join(`\r
`)};function Dt(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(at.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function $t(d){let v="";return lt(d,function(_,N){v+=N,v+=":",v+=_,v+=`\r
`}),v}function Jt(d,v,_){e:{for(N in _){var N=!1;break e}N=!0}N||(_=$t(_),typeof d=="string"?_!=null&&pe(_):ot(d,v,_))}function Wt(d){ht.call(this),this.headers=new Map,this.L=d||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}k(Wt,ht);var kn=/^https?$/i,Zn=["POST","PUT"];s=Wt.prototype,s.Fa=function(d){this.H=d},s.ea=function(d,v,_,N){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);v=v?v.toUpperCase():"GET",this.D=d,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():rs.g(),this.g.onreadystatechange=E(y(this.Ca,this));try{this.B=!0,this.g.open(v,String(d),!0),this.B=!1}catch(ue){as(this,ue);return}if(d=_||"",_=new Map(this.headers),N)if(Object.getPrototypeOf(N)===Object.prototype)for(var ee in N)_.set(ee,N[ee]);else if(typeof N.keys=="function"&&typeof N.get=="function")for(const ue of N.keys())_.set(ue,N.get(ue));else throw Error("Unknown input type for opt_headers: "+String(N));N=Array.from(_.keys()).find(ue=>ue.toLowerCase()=="content-type"),ee=h.FormData&&d instanceof h.FormData,!(Array.prototype.indexOf.call(Zn,v,void 0)>=0)||N||ee||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ue,Ge]of _)this.g.setRequestHeader(ue,Ge);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(d),this.v=!1}catch(ue){as(this,ue)}};function as(d,v){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=v,d.o=5,cs(d),ur(d)}function cs(d){d.A||(d.A=!0,et(d,"complete"),et(d,"error"))}s.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=d||7,et(this,"complete"),et(this,"abort"),ur(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ur(this,!0)),Wt.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?ks(this):this.Xa())},s.Xa=function(){ks(this)};function ks(d){if(d.h&&typeof u<"u"){if(d.v&&$s(d)==4)setTimeout(d.Ca.bind(d),0);else if(et(d,"readystatechange"),$s(d)==4){d.h=!1;try{const ue=d.ca();e:switch(ue){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var _;if(!(_=v)){var N;if(N=ue===0){let Ge=String(d.D).match($)[1]||null;!Ge&&h.self&&h.self.location&&(Ge=h.self.location.protocol.slice(0,-1)),N=!kn.test(Ge?Ge.toLowerCase():"")}_=N}if(_)et(d,"complete"),et(d,"success");else{d.o=6;try{var ee=$s(d)>2?d.g.statusText:""}catch{ee=""}d.l=ee+" ["+d.ca()+"]",cs(d)}}finally{ur(d)}}}}function ur(d,v){if(d.g){d.m&&(clearTimeout(d.m),d.m=null);const _=d.g;d.g=null,v||et(d,"ready");try{_.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function $s(d){return d.g?d.g.readyState:0}s.ca=function(){try{return $s(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(d){if(this.g){var v=this.g.responseText;return d&&v.indexOf(d)==0&&(v=v.substring(d.length)),Nn(v)}};function es(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.F){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function hr(d){const v={};d=(d.g&&$s(d)>=2&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let N=0;N<d.length;N++){if(M(d[N]))continue;var _=we(d[N]);const ee=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const ue=v[ee]||[];v[ee]=ue,ue.push(_)}ie(v,function(N){return N.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function tr(d,v,_){return _&&_.internalChannelParams&&_.internalChannelParams[d]||v}function ys(d){this.za=0,this.i=[],this.j=new Rt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=tr("failFast",!1,d),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=tr("baseRetryDelayMs",5e3,d),this.Za=tr("retryDelaySeedMs",1e4,d),this.Ta=tr("forwardChannelMaxRetries",2,d),this.va=tr("forwardChannelRequestTimeoutMs",2e4,d),this.ma=d&&d.xmlHttpFactory||void 0,this.Ua=d&&d.Rb||void 0,this.Aa=d&&d.useFetchStreams||!1,this.O=void 0,this.L=d&&d.supportsCrossDomainXhr||!1,this.M="",this.h=new K(d&&d.concurrentRequestLimit),this.Ba=new Ze,this.S=d&&d.fastHandshake||!1,this.R=d&&d.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=d&&d.Pb||!1,d&&d.ua&&this.j.ua(),d&&d.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&d&&d.detectBufferingProxy||!1,this.ia=void 0,d&&d.longPollingTimeout&&d.longPollingTimeout>0&&(this.ia=d.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=ys.prototype,s.ka=8,s.I=1,s.connect=function(d,v,_,N){Xe(0),this.W=d,this.H=v||{},_&&N!==void 0&&(this.H.OSID=_,this.H.OAID=N),this.F=this.X,this.J=Fu(this,null,this.W),jr(this)};function Ws(d){if(Tr(d),d.I==3){var v=d.V++,_=Ce(d.J);if(ot(_,"SID",d.M),ot(_,"RID",v),ot(_,"TYPE","terminate"),Or(d,_),v=new ve(d,d.j,v),v.M=2,v.A=an(Ce(_)),_=!1,h.navigator&&h.navigator.sendBeacon)try{_=h.navigator.sendBeacon(v.A.toString(),"")}catch{}!_&&h.Image&&(new Image().src=v.A,_=!0),_||(v.g=qu(v.j,null),v.g.ea(v.A)),v.F=Date.now(),_s(v)}zu(d)}function Gs(d){d.g&&(tc(d),d.g.cancel(),d.g=null)}function Tr(d){Gs(d),d.v&&(h.clearTimeout(d.v),d.v=null),Yo(d),d.h.cancel(),d.m&&(typeof d.m=="number"&&h.clearTimeout(d.m),d.m=null)}function jr(d){if(!te(d.h)&&!d.m){d.m=!0;var v=d.Ea;$e||j(),Ve||($e(),Ve=!0),I.add(v,d),d.D=0}}function fi(d,v){return He(d.h)>=d.h.j-(d.m?1:0)?!1:d.m?(d.i=v.G.concat(d.i),!0):d.I==1||d.I==2||d.D>=(d.Sa?0:d.Ta)?!1:(d.m=Ft(y(d.Ea,d,v),Uu(d,d.D)),d.D++,!0)}s.Ea=function(d){if(this.m)if(this.m=null,this.I==1){if(!d){this.V=Math.floor(Math.random()*1e5),d=this.V++;const ee=new ve(this,this.j,d);let ue=this.o;if(this.U&&(ue?(ue=L(ue),ye(ue,this.U)):ue=this.U),this.u!==null||this.R||(ee.J=ue,ue=null),this.S)e:{for(var v=0,_=0;_<this.i.length;_++){t:{var N=this.i[_];if("__data__"in N.map&&(N=N.map.__data__,typeof N=="string")){N=N.length;break t}N=void 0}if(N===void 0)break;if(v+=N,v>4096){v=_;break e}if(v===4096||_===this.i.length-1){v=_+1;break e}}v=1e3}else v=1e3;v=Zr(this,ee,v),_=Ce(this.J),ot(_,"RID",d),ot(_,"CVER",22),this.G&&ot(_,"X-HTTP-Session-Id",this.G),Or(this,_),ue&&(this.R?v="headers="+pe($t(ue))+"&"+v:this.u&&Jt(_,this.u,ue)),Oe(this.h,ee),this.Ra&&ot(_,"TYPE","init"),this.S?(ot(_,"$req",v),ot(_,"SID","null"),ee.U=!0,ct(ee,_,null)):ct(ee,_,v),this.I=2}}else this.I==3&&(d?uo(this,d):this.i.length==0||te(this.h)||uo(this))};function uo(d,v){var _;v?_=v.l:_=d.V++;const N=Ce(d.J);ot(N,"SID",d.M),ot(N,"RID",_),ot(N,"AID",d.K),Or(d,N),d.u&&d.o&&Jt(N,d.u,d.o),_=new ve(d,d.j,_,d.D+1),d.u===null&&(_.J=d.o),v&&(d.i=v.G.concat(d.i)),v=Zr(d,_,1e3),_.H=Math.round(d.va*.5)+Math.round(d.va*.5*Math.random()),Oe(d.h,_),ct(_,N,v)}function Or(d,v){d.H&&lt(d.H,function(_,N){ot(v,N,_)}),d.l&&lt({},function(_,N){ot(v,N,_)})}function Zr(d,v,_){_=Math.min(d.i.length,_);const N=d.l?y(d.l.Ka,d.l,d):null;e:{var ee=d.i;let Zt=-1;for(;;){const vs=["count="+_];Zt==-1?_>0?(Zt=ee[0].g,vs.push("ofs="+Zt)):Zt=0:vs.push("ofs="+Zt);let Mn=!0;for(let is=0;is<_;is++){var ue=ee[is].g;const Vr=ee[is].map;if(ue-=Zt,ue<0)Zt=Math.max(0,ee[is].g-100),Mn=!1;else try{ue="req"+ue+"_"||"";try{var Ge=Vr instanceof Map?Vr:Object.entries(Vr);for(const[ya,ta]of Ge){let na=ta;p(ta)&&(na=Kt(ta)),vs.push(ue+ya+"="+encodeURIComponent(na))}}catch(ya){throw vs.push(ue+"type="+encodeURIComponent("_badmap")),ya}}catch{N&&N(Vr)}}if(Mn){Ge=vs.join("&");break e}}Ge=void 0}return d=d.i.splice(0,_),v.G=d,Ge}function ea(d){if(!d.g&&!d.v){d.Y=1;var v=d.Da;$e||j(),Ve||($e(),Ve=!0),I.add(v,d),d.A=0}}function ho(d){return d.g||d.v||d.A>=3?!1:(d.Y++,d.v=Ft(y(d.Da,d),Uu(d,d.A)),d.A++,!0)}s.Da=function(){if(this.v=null,Vu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var d=4*this.T;this.j.info("BP detection timer enabled: "+d),this.B=Ft(y(this.Wa,this),d)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Xe(10),Gs(this),Vu(this))};function tc(d){d.B!=null&&(h.clearTimeout(d.B),d.B=null)}function Vu(d){d.g=new ve(d,d.j,"rpc",d.Y),d.u===null&&(d.g.J=d.o),d.g.P=0;var v=Ce(d.na);ot(v,"RID","rpc"),ot(v,"SID",d.M),ot(v,"AID",d.K),ot(v,"CI",d.F?"0":"1"),!d.F&&d.ia&&ot(v,"TO",d.ia),ot(v,"TYPE","xmlhttp"),Or(d,v),d.u&&d.o&&Jt(v,d.u,d.o),d.O&&(d.g.H=d.O);var _=d.g;d=d.ba,_.M=1,_.A=an(Ce(v)),_.u=null,_.R=!0,_t(_,d)}s.Va=function(){this.C!=null&&(this.C=null,Gs(this),ho(this),Xe(19))};function Yo(d){d.C!=null&&(h.clearTimeout(d.C),d.C=null)}function Bu(d,v){var _=null;if(d.g==v){Yo(d),tc(d),d.g=null;var N=2}else if(Ue(d.h,v))_=v.G,Ut(d.h,v),N=1;else return;if(d.I!=0){if(v.o)if(N==1){_=v.u?v.u.length:0,v=Date.now()-v.F;var ee=d.D;N=mt(),et(N,new dt(N,_)),jr(d)}else ea(d);else if(ee=v.m,ee==3||ee==0&&v.X>0||!(N==1&&fi(d,v)||N==2&&ho(d)))switch(_&&_.length>0&&(v=d.h,v.i=v.i.concat(_)),ee){case 1:ga(d,5);break;case 4:ga(d,10);break;case 3:ga(d,6);break;default:ga(d,2)}}}function Uu(d,v){let _=d.Qa+Math.floor(Math.random()*d.Za);return d.isActive()||(_*=2),_*v}function ga(d,v){if(d.j.info("Error code "+v),v==2){var _=y(d.bb,d),N=d.Ua;const ee=!N;N=new ae(N||"//www.google.com/images/cleardot.gif"),h.location&&h.location.protocol=="http"||Pe(N,"https"),an(N),ee?A(N.toString(),_):Z(N.toString(),_)}else Xe(2);d.I=0,d.l&&d.l.pa(v),zu(d),Tr(d)}s.bb=function(d){d?(this.j.info("Successfully pinged google.com"),Xe(2)):(this.j.info("Failed to ping google.com"),Xe(1))};function zu(d){if(d.I=0,d.ja=[],d.l){const v=kt(d.h);(v.length!=0||d.i.length!=0)&&(G(d.ja,v),G(d.ja,d.i),d.h.i.length=0,O(d.i),d.i.length=0),d.l.oa()}}function Fu(d,v,_){var N=_ instanceof ae?Ce(_):new ae(_);if(N.g!="")v&&(N.g=v+"."+N.g),rt(N,N.u);else{var ee=h.location;N=ee.protocol,v=v?v+"."+ee.hostname:ee.hostname,ee=+ee.port;const ue=new ae(null);N&&Pe(ue,N),v&&(ue.g=v),ee&&rt(ue,ee),_&&(ue.h=_),N=ue}return _=d.G,v=d.wa,_&&v&&ot(N,_,v),ot(N,"VER",d.ka),Or(d,N),N}function qu(d,v,_){if(v&&!d.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=d.Aa&&!d.ma?new Wt(new ft({ab:_})):new Wt(d.ma),v.Fa(d.L),v}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function Hu(){}s=Hu.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function mi(){}mi.prototype.g=function(d,v){return new nr(d,v)};function nr(d,v){ht.call(this),this.g=new ys(v),this.l=d,this.h=v&&v.messageUrlParams||null,d=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(d?d["X-WebChannel-Content-Type"]=v.messageContentType:d={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(d?d["X-WebChannel-Client-Profile"]=v.sa:d={"X-WebChannel-Client-Profile":v.sa}),this.g.U=d,(d=v&&v.Qb)&&!M(d)&&(this.g.u=d),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!M(v)&&(this.g.G=v,d=this.h,d!==null&&v in d&&(d=this.h,v in d&&delete d[v])),this.j=new Oa(this)}k(nr,ht),nr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},nr.prototype.close=function(){Ws(this.g)},nr.prototype.o=function(d){var v=this.g;if(typeof d=="string"){var _={};_.__data__=d,d=_}else this.v&&(_={},_.__data__=Kt(d),d=_);v.i.push(new C(v.Ya++,d)),v.I==3&&jr(v)},nr.prototype.N=function(){this.g.l=null,delete this.j,Ws(this.g),delete this.g,nr.Z.N.call(this)};function $u(d){Be.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var v=d.__sm__;if(v){e:{for(const _ in v){d=_;break e}d=void 0}(this.i=d)&&(d=this.i,v=v!==null&&d in v?v[d]:void 0),this.data=v}else this.data=d}k($u,Be);function Wu(){Me.call(this),this.status=1}k(Wu,Me);function Oa(d){this.g=d}k(Oa,Hu),Oa.prototype.ra=function(){et(this.g,"a")},Oa.prototype.qa=function(d){et(this.g,new $u(d))},Oa.prototype.pa=function(d){et(this.g,new Wu)},Oa.prototype.oa=function(){et(this.g,"b")},mi.prototype.createWebChannel=mi.prototype.g,nr.prototype.send=nr.prototype.o,nr.prototype.open=nr.prototype.m,nr.prototype.close=nr.prototype.close,Vw=function(){return new mi},Ow=function(){return mt()},Lw=Le,lg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},In.NO_ERROR=0,In.TIMEOUT=8,In.HTTP_ERROR=6,yd=In,un.COMPLETE="complete",Pw=un,Fe.EventType=Ye,Ye.OPEN="a",Ye.CLOSE="b",Ye.ERROR="c",Ye.MESSAGE="d",ht.prototype.listen=ht.prototype.J,Kc=Fe,Wt.prototype.listenOnce=Wt.prototype.K,Wt.prototype.getLastError=Wt.prototype.Ha,Wt.prototype.getLastErrorCode=Wt.prototype.ya,Wt.prototype.getStatus=Wt.prototype.ca,Wt.prototype.getResponseJson=Wt.prototype.La,Wt.prototype.getResponseText=Wt.prototype.la,Wt.prototype.send=Wt.prototype.ea,Wt.prototype.setWithCredentials=Wt.prototype.Fa,Dw=Wt}).apply(typeof Jh<"u"?Jh:typeof self<"u"?self:typeof window<"u"?window:{});class Qs{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Qs.UNAUTHENTICATED=new Qs(null),Qs.GOOGLE_CREDENTIALS=new Qs("google-credentials-uid"),Qs.FIRST_PARTY=new Qs("first-party-uid"),Qs.MOCK_USER=new Qs("mock-user");let Ql="12.8.0";function G4(s){Ql=s}const Fo=new Lg("@firebase/firestore");function Rl(){return Fo.logLevel}function it(s,...e){if(Fo.logLevel<=mn.DEBUG){const n=e.map(Yg);Fo.debug(`Firestore (${Ql}): ${s}`,...n)}}function li(s,...e){if(Fo.logLevel<=mn.ERROR){const n=e.map(Yg);Fo.error(`Firestore (${Ql}): ${s}`,...n)}}function Ul(s,...e){if(Fo.logLevel<=mn.WARN){const n=e.map(Yg);Fo.warn(`Firestore (${Ql}): ${s}`,...n)}}function Yg(s){if(typeof s=="string")return s;try{return(function(n){return JSON.stringify(n)})(s)}catch{return s}}function Vt(s,e,n){let i="Unexpected state";typeof e=="string"?i=e:n=e,Bw(s,i,n)}function Bw(s,e,n){let i=`FIRESTORE (${Ql}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(n!==void 0)try{i+=" CONTEXT: "+JSON.stringify(n)}catch{i+=" CONTEXT: "+n}throw li(i),new Error(i)}function On(s,e,n,i){let l="Unexpected state";typeof n=="string"?l=n:i=n,s||Bw(e,l,i)}function Xt(s,e){return s}const _e={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class tt extends Da{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class si{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class Uw{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class K4{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(Qs.UNAUTHENTICATED)))}shutdown(){}}class Y4{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class Q4{constructor(e){this.t=e,this.currentUser=Qs.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){On(this.o===void 0,42304);let i=this.i;const l=g=>this.i!==i?(i=this.i,n(g)):Promise.resolve();let u=new si;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new si,e.enqueueRetryable((()=>l(this.currentUser)))};const h=()=>{const g=u;e.enqueueRetryable((async()=>{await g.promise,await l(this.currentUser)}))},p=g=>{it("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),h())};this.t.onInit((g=>p(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?p(g):(it("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new si)}}),0),h()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((i=>this.i!==e?(it("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(On(typeof i.accessToken=="string",31837,{l:i}),new Uw(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return On(e===null||typeof e=="string",2055,{h:e}),new Qs(e)}}class X4{constructor(e,n,i){this.P=e,this.T=n,this.I=i,this.type="FirstParty",this.user=Qs.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class J4{constructor(e,n,i){this.P=e,this.T=n,this.I=i}getToken(){return Promise.resolve(new X4(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(Qs.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class ix{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Z4{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Mr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){On(this.o===void 0,3512);const i=u=>{u.error!=null&&it("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const h=u.token!==this.m;return this.m=u.token,it("FirebaseAppCheckTokenProvider",`Received ${h?"new":"existing"} token.`),h?n(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>i(u)))};const l=u=>{it("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>l(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?l(u):it("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new ix(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(On(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new ix(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function eR(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let i=0;i<s;i++)n[i]=Math.floor(256*Math.random());return n}class Qg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const l=eR(40);for(let u=0;u<l.length;++u)i.length<20&&l[u]<n&&(i+=e.charAt(l[u]%62))}return i}}function pn(s,e){return s<e?-1:s>e?1:0}function cg(s,e){const n=Math.min(s.length,e.length);for(let i=0;i<n;i++){const l=s.charAt(i),u=e.charAt(i);if(l!==u)return Np(l)===Np(u)?pn(l,u):Np(l)?1:-1}return pn(s.length,e.length)}const tR=55296,nR=57343;function Np(s){const e=s.charCodeAt(0);return e>=tR&&e<=nR}function zl(s,e,n){return s.length===e.length&&s.every(((i,l)=>n(i,e[l])))}const ox="__name__";class ka{constructor(e,n,i){n===void 0?n=0:n>e.length&&Vt(637,{offset:n,range:e.length}),i===void 0?i=e.length-n:i>e.length-n&&Vt(1746,{length:i,range:e.length-n}),this.segments=e,this.offset=n,this.len=i}get length(){return this.len}isEqual(e){return ka.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ka?e.forEach((i=>{n.push(i)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,i=this.limit();n<i;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const i=Math.min(e.length,n.length);for(let l=0;l<i;l++){const u=ka.compareSegments(e.get(l),n.get(l));if(u!==0)return u}return pn(e.length,n.length)}static compareSegments(e,n){const i=ka.isNumericId(e),l=ka.isNumericId(n);return i&&!l?-1:!i&&l?1:i&&l?ka.extractNumericId(e).compare(ka.extractNumericId(n)):cg(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Xi.fromString(e.substring(4,e.length-2))}}class Xn extends ka{construct(e,n,i){return new Xn(e,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const i of e){if(i.indexOf("//")>=0)throw new tt(_e.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter((l=>l.length>0)))}return new Xn(n)}static emptyPath(){return new Xn([])}}const sR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class qs extends ka{construct(e,n,i){return new qs(e,n,i)}static isValidIdentifier(e){return sR.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),qs.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===ox}static keyField(){return new qs([ox])}static fromServerFormat(e){const n=[];let i="",l=0;const u=()=>{if(i.length===0)throw new tt(_e.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""};let h=!1;for(;l<e.length;){const p=e[l];if(p==="\\"){if(l+1===e.length)throw new tt(_e.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[l+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new tt(_e.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,l+=2}else p==="`"?(h=!h,l++):p!=="."||h?(i+=p,l++):(u(),l++)}if(u(),h)throw new tt(_e.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new qs(n)}static emptyPath(){return new qs([])}}class jt{constructor(e){this.path=e}static fromPath(e){return new jt(Xn.fromString(e))}static fromName(e){return new jt(Xn.fromString(e).popFirst(5))}static empty(){return new jt(Xn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Xn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Xn.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new jt(new Xn(e.slice()))}}function zw(s,e,n){if(!n)throw new tt(_e.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function rR(s,e,n,i){if(e===!0&&i===!0)throw new tt(_e.INVALID_ARGUMENT,`${s} and ${n} cannot be used together.`)}function lx(s){if(!jt.isDocumentKey(s))throw new tt(_e.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function cx(s){if(jt.isDocumentKey(s))throw new tt(_e.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function Fw(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function Zd(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":Vt(12329,{type:typeof s})}function or(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new tt(_e.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Zd(s);throw new tt(_e.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return s}function aR(s,e){if(e<=0)throw new tt(_e.INVALID_ARGUMENT,`Function ${s}() requires a positive number, but it was: ${e}.`)}function Rs(s,e){const n={typeString:s};return e&&(n.value=e),n}function Su(s,e){if(!Fw(s))throw new tt(_e.INVALID_ARGUMENT,"JSON must be an object");let n;for(const i in e)if(e[i]){const l=e[i].typeString,u="value"in e[i]?{value:e[i].value}:void 0;if(!(i in s)){n=`JSON missing required field: '${i}'`;break}const h=s[i];if(l&&typeof h!==l){n=`JSON field '${i}' must be a ${l}.`;break}if(u!==void 0&&h!==u.value){n=`Expected '${i}' field to equal '${u.value}'`;break}}if(n)throw new tt(_e.INVALID_ARGUMENT,n);return!0}const ux=-62135596800,hx=1e6;class bt{static now(){return bt.fromMillis(Date.now())}static fromDate(e){return bt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),i=Math.floor((e-1e3*n)*hx);return new bt(n,i)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new tt(_e.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new tt(_e.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<ux)throw new tt(_e.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new tt(_e.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/hx}_compareTo(e){return this.seconds===e.seconds?pn(this.nanoseconds,e.nanoseconds):pn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:bt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Su(e,bt._jsonSchema))return new bt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-ux;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}bt._jsonSchemaVersion="firestore/timestamp/1.0",bt._jsonSchema={type:Rs("string",bt._jsonSchemaVersion),seconds:Rs("number"),nanoseconds:Rs("number")};class Gt{static fromTimestamp(e){return new Gt(e)}static min(){return new Gt(new bt(0,0))}static max(){return new Gt(new bt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const uu=-1;function iR(s,e){const n=s.toTimestamp().seconds,i=s.toTimestamp().nanoseconds+1,l=Gt.fromTimestamp(i===1e9?new bt(n+1,0):new bt(n,i));return new eo(l,jt.empty(),e)}function oR(s){return new eo(s.readTime,s.key,uu)}class eo{constructor(e,n,i){this.readTime=e,this.documentKey=n,this.largestBatchId=i}static min(){return new eo(Gt.min(),jt.empty(),uu)}static max(){return new eo(Gt.max(),jt.empty(),uu)}}function lR(s,e){let n=s.readTime.compareTo(e.readTime);return n!==0?n:(n=jt.comparator(s.documentKey,e.documentKey),n!==0?n:pn(s.largestBatchId,e.largestBatchId))}const cR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class uR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Xl(s){if(s.code!==_e.FAILED_PRECONDITION||s.message!==cR)throw s;it("LocalStore","Unexpectedly lost primary lease")}class Ie{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Vt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new Ie(((i,l)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,l)},this.catchCallback=u=>{this.wrapFailure(n,u).next(i,l)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof Ie?n:Ie.resolve(n)}catch(n){return Ie.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):Ie.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):Ie.reject(n)}static resolve(e){return new Ie(((n,i)=>{n(e)}))}static reject(e){return new Ie(((n,i)=>{i(e)}))}static waitFor(e){return new Ie(((n,i)=>{let l=0,u=0,h=!1;e.forEach((p=>{++l,p.next((()=>{++u,h&&u===l&&n()}),(g=>i(g)))})),h=!0,u===l&&n()}))}static or(e){let n=Ie.resolve(!1);for(const i of e)n=n.next((l=>l?Ie.resolve(l):i()));return n}static forEach(e,n){const i=[];return e.forEach(((l,u)=>{i.push(n.call(this,l,u))})),this.waitFor(i)}static mapArray(e,n){return new Ie(((i,l)=>{const u=e.length,h=new Array(u);let p=0;for(let g=0;g<u;g++){const y=g;n(e[y]).next((w=>{h[y]=w,++p,p===u&&i(h)}),(w=>l(w)))}}))}static doWhile(e,n){return new Ie(((i,l)=>{const u=()=>{e()===!0?n().next((()=>{u()}),l):i()};u()}))}}function hR(s){const e=s.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Jl(s){return s.name==="IndexedDbTransactionError"}class ef{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>n.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ef.ce=-1;const Xg=-1;function tf(s){return s==null}function Md(s){return s===0&&1/s==-1/0}function dR(s){return typeof s=="number"&&Number.isInteger(s)&&!Md(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}const qw="";function fR(s){let e="";for(let n=0;n<s.length;n++)e.length>0&&(e=dx(e)),e=mR(s.get(n),e);return dx(e)}function mR(s,e){let n=e;const i=s.length;for(let l=0;l<i;l++){const u=s.charAt(l);switch(u){case"\0":n+="";break;case qw:n+="";break;default:n+=u}}return n}function dx(s){return s+qw+""}function fx(s){let e=0;for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&e++;return e}function lo(s,e){for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&e(n,s[n])}function Hw(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}class hs{constructor(e,n){this.comparator=e,this.root=n||Fs.EMPTY}insert(e,n){return new hs(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Fs.BLACK,null,null))}remove(e){return new hs(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Fs.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(e){let n=0,i=this.root;for(;!i.isEmpty();){const l=this.comparator(e,i.key);if(l===0)return n+i.left.size;l<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,i)=>(e(n,i),!1)))}toString(){const e=[];return this.inorderTraversal(((n,i)=>(e.push(`${n}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Zh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Zh(this.root,e,this.comparator,!1)}getReverseIterator(){return new Zh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Zh(this.root,e,this.comparator,!0)}}class Zh{constructor(e,n,i,l){this.isReverse=l,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=n?i(e.key,n):1,n&&l&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Fs{constructor(e,n,i,l,u){this.key=e,this.value=n,this.color=i??Fs.RED,this.left=l??Fs.EMPTY,this.right=u??Fs.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,i,l,u){return new Fs(e??this.key,n??this.value,i??this.color,l??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,i){let l=this;const u=i(e,l.key);return l=u<0?l.copy(null,null,null,l.left.insert(e,n,i),null):u===0?l.copy(null,n,null,null,null):l.copy(null,null,null,null,l.right.insert(e,n,i)),l.fixUp()}removeMin(){if(this.left.isEmpty())return Fs.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let i,l=this;if(n(e,l.key)<0)l.left.isEmpty()||l.left.isRed()||l.left.left.isRed()||(l=l.moveRedLeft()),l=l.copy(null,null,null,l.left.remove(e,n),null);else{if(l.left.isRed()&&(l=l.rotateRight()),l.right.isEmpty()||l.right.isRed()||l.right.left.isRed()||(l=l.moveRedRight()),n(e,l.key)===0){if(l.right.isEmpty())return Fs.EMPTY;i=l.right.min(),l=l.copy(i.key,i.value,null,null,l.right.removeMin())}l=l.copy(null,null,null,null,l.right.remove(e,n))}return l.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Fs.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Fs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Vt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Vt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Vt(27949);return e+(this.isRed()?0:1)}}Fs.EMPTY=null,Fs.RED=!0,Fs.BLACK=!1;Fs.EMPTY=new class{constructor(){this.size=0}get key(){throw Vt(57766)}get value(){throw Vt(16141)}get color(){throw Vt(16727)}get left(){throw Vt(29726)}get right(){throw Vt(36894)}copy(e,n,i,l,u){return this}insert(e,n,i){return new Fs(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ms{constructor(e){this.comparator=e,this.data=new hs(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,i)=>(e(n),!1)))}forEachInRange(e,n){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const l=i.getNext();if(this.comparator(l.key,e[1])>=0)return;n(l.key)}}forEachWhile(e,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new mx(this.data.getIterator())}getIteratorFrom(e){return new mx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((i=>{n=n.add(i)})),n}isEqual(e){if(!(e instanceof Ms)||this.size!==e.size)return!1;const n=this.data.getIterator(),i=e.data.getIterator();for(;n.hasNext();){const l=n.getNext().key,u=i.getNext().key;if(this.comparator(l,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new Ms(this.comparator);return n.data=e,n}}class mx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Dr{constructor(e){this.fields=e,e.sort(qs.comparator)}static empty(){return new Dr([])}unionWith(e){let n=new Ms(qs.comparator);for(const i of this.fields)n=n.add(i);for(const i of e)n=n.add(i);return new Dr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return zl(this.fields,e.fields,((n,i)=>n.isEqual(i)))}}class $w extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Hs{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(l){try{return atob(l)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new $w("Invalid base64 string: "+u):u}})(e);return new Hs(n)}static fromUint8Array(e){const n=(function(l){let u="";for(let h=0;h<l.length;++h)u+=String.fromCharCode(l[h]);return u})(e);return new Hs(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const i=new Uint8Array(n.length);for(let l=0;l<n.length;l++)i[l]=n.charCodeAt(l);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return pn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Hs.EMPTY_BYTE_STRING=new Hs("");const pR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function to(s){if(On(!!s,39018),typeof s=="string"){let e=0;const n=pR.exec(s);if(On(!!n,46558,{timestamp:s}),n[1]){let l=n[1];l=(l+"000000000").substr(0,9),e=Number(l)}const i=new Date(s);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:ws(s.seconds),nanos:ws(s.nanos)}}function ws(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function no(s){return typeof s=="string"?Hs.fromBase64String(s):Hs.fromUint8Array(s)}const Ww="server_timestamp",Gw="__type__",Kw="__previous_value__",Yw="__local_write_time__";function Jg(s){return(s?.mapValue?.fields||{})[Gw]?.stringValue===Ww}function nf(s){const e=s.mapValue.fields[Kw];return Jg(e)?nf(e):e}function hu(s){const e=to(s.mapValue.fields[Yw].timestampValue);return new bt(e.seconds,e.nanos)}class gR{constructor(e,n,i,l,u,h,p,g,y,w,k){this.databaseId=e,this.appId=n,this.persistenceKey=i,this.host=l,this.ssl=u,this.forceLongPolling=h,this.autoDetectLongPolling=p,this.longPollingOptions=g,this.useFetchStreams=y,this.isUsingEmulator=w,this.apiKey=k}}const Dd="(default)";class du{constructor(e,n){this.projectId=e,this.database=n||Dd}static empty(){return new du("","")}get isDefaultDatabase(){return this.database===Dd}isEqual(e){return e instanceof du&&e.projectId===this.projectId&&e.database===this.database}}function yR(s,e){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new tt(_e.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new du(s.options.projectId,e)}const Qw="__type__",vR="__max__",ed={mapValue:{}},Xw="__vector__",Pd="value";function so(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?Jg(s)?4:xR(s)?9007199254740991:bR(s)?10:11:Vt(28295,{value:s})}function Aa(s,e){if(s===e)return!0;const n=so(s);if(n!==so(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return hu(s).isEqual(hu(e));case 3:return(function(l,u){if(typeof l.timestampValue=="string"&&typeof u.timestampValue=="string"&&l.timestampValue.length===u.timestampValue.length)return l.timestampValue===u.timestampValue;const h=to(l.timestampValue),p=to(u.timestampValue);return h.seconds===p.seconds&&h.nanos===p.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(l,u){return no(l.bytesValue).isEqual(no(u.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(l,u){return ws(l.geoPointValue.latitude)===ws(u.geoPointValue.latitude)&&ws(l.geoPointValue.longitude)===ws(u.geoPointValue.longitude)})(s,e);case 2:return(function(l,u){if("integerValue"in l&&"integerValue"in u)return ws(l.integerValue)===ws(u.integerValue);if("doubleValue"in l&&"doubleValue"in u){const h=ws(l.doubleValue),p=ws(u.doubleValue);return h===p?Md(h)===Md(p):isNaN(h)&&isNaN(p)}return!1})(s,e);case 9:return zl(s.arrayValue.values||[],e.arrayValue.values||[],Aa);case 10:case 11:return(function(l,u){const h=l.mapValue.fields||{},p=u.mapValue.fields||{};if(fx(h)!==fx(p))return!1;for(const g in h)if(h.hasOwnProperty(g)&&(p[g]===void 0||!Aa(h[g],p[g])))return!1;return!0})(s,e);default:return Vt(52216,{left:s})}}function fu(s,e){return(s.values||[]).find((n=>Aa(n,e)))!==void 0}function Fl(s,e){if(s===e)return 0;const n=so(s),i=so(e);if(n!==i)return pn(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return pn(s.booleanValue,e.booleanValue);case 2:return(function(u,h){const p=ws(u.integerValue||u.doubleValue),g=ws(h.integerValue||h.doubleValue);return p<g?-1:p>g?1:p===g?0:isNaN(p)?isNaN(g)?0:-1:1})(s,e);case 3:return px(s.timestampValue,e.timestampValue);case 4:return px(hu(s),hu(e));case 5:return cg(s.stringValue,e.stringValue);case 6:return(function(u,h){const p=no(u),g=no(h);return p.compareTo(g)})(s.bytesValue,e.bytesValue);case 7:return(function(u,h){const p=u.split("/"),g=h.split("/");for(let y=0;y<p.length&&y<g.length;y++){const w=pn(p[y],g[y]);if(w!==0)return w}return pn(p.length,g.length)})(s.referenceValue,e.referenceValue);case 8:return(function(u,h){const p=pn(ws(u.latitude),ws(h.latitude));return p!==0?p:pn(ws(u.longitude),ws(h.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return gx(s.arrayValue,e.arrayValue);case 10:return(function(u,h){const p=u.fields||{},g=h.fields||{},y=p[Pd]?.arrayValue,w=g[Pd]?.arrayValue,k=pn(y?.values?.length||0,w?.values?.length||0);return k!==0?k:gx(y,w)})(s.mapValue,e.mapValue);case 11:return(function(u,h){if(u===ed.mapValue&&h===ed.mapValue)return 0;if(u===ed.mapValue)return 1;if(h===ed.mapValue)return-1;const p=u.fields||{},g=Object.keys(p),y=h.fields||{},w=Object.keys(y);g.sort(),w.sort();for(let k=0;k<g.length&&k<w.length;++k){const E=cg(g[k],w[k]);if(E!==0)return E;const O=Fl(p[g[k]],y[w[k]]);if(O!==0)return O}return pn(g.length,w.length)})(s.mapValue,e.mapValue);default:throw Vt(23264,{he:n})}}function px(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return pn(s,e);const n=to(s),i=to(e),l=pn(n.seconds,i.seconds);return l!==0?l:pn(n.nanos,i.nanos)}function gx(s,e){const n=s.values||[],i=e.values||[];for(let l=0;l<n.length&&l<i.length;++l){const u=Fl(n[l],i[l]);if(u)return u}return pn(n.length,i.length)}function ql(s){return ug(s)}function ug(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(n){const i=to(n);return`time(${i.seconds},${i.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(n){return no(n).toBase64()})(s.bytesValue):"referenceValue"in s?(function(n){return jt.fromName(n).toString()})(s.referenceValue):"geoPointValue"in s?(function(n){return`geo(${n.latitude},${n.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(n){let i="[",l=!0;for(const u of n.values||[])l?l=!1:i+=",",i+=ug(u);return i+"]"})(s.arrayValue):"mapValue"in s?(function(n){const i=Object.keys(n.fields||{}).sort();let l="{",u=!0;for(const h of i)u?u=!1:l+=",",l+=`${h}:${ug(n.fields[h])}`;return l+"}"})(s.mapValue):Vt(61005,{value:s})}function vd(s){switch(so(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=nf(s);return e?16+vd(e):16;case 5:return 2*s.stringValue.length;case 6:return no(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((l,u)=>l+vd(u)),0)})(s.arrayValue);case 10:case 11:return(function(i){let l=0;return lo(i.fields,((u,h)=>{l+=u.length+vd(h)})),l})(s.mapValue);default:throw Vt(13486,{value:s})}}function yx(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function hg(s){return!!s&&"integerValue"in s}function Zg(s){return!!s&&"arrayValue"in s}function vx(s){return!!s&&"nullValue"in s}function bx(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function bd(s){return!!s&&"mapValue"in s}function bR(s){return(s?.mapValue?.fields||{})[Qw]?.stringValue===Xw}function eu(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return lo(s.mapValue.fields,((n,i)=>e.mapValue.fields[n]=eu(i))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(s.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=eu(s.arrayValue.values[n]);return e}return{...s}}function xR(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===vR}class br{constructor(e){this.value=e}static empty(){return new br({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let i=0;i<e.length-1;++i)if(n=(n.mapValue.fields||{})[e.get(i)],!bd(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=eu(n)}setAll(e){let n=qs.emptyPath(),i={},l=[];e.forEach(((h,p)=>{if(!n.isImmediateParentOf(p)){const g=this.getFieldsMap(n);this.applyChanges(g,i,l),i={},l=[],n=p.popLast()}h?i[p.lastSegment()]=eu(h):l.push(p.lastSegment())}));const u=this.getFieldsMap(n);this.applyChanges(u,i,l)}delete(e){const n=this.field(e.popLast());bd(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Aa(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<e.length;++i){let l=n.mapValue.fields[e.get(i)];bd(l)&&l.mapValue.fields||(l={mapValue:{fields:{}}},n.mapValue.fields[e.get(i)]=l),n=l}return n.mapValue.fields}applyChanges(e,n,i){lo(n,((l,u)=>e[l]=u));for(const l of i)delete e[l]}clone(){return new br(eu(this.value))}}function Jw(s){const e=[];return lo(s.fields,((n,i)=>{const l=new qs([n]);if(bd(i)){const u=Jw(i.mapValue).fields;if(u.length===0)e.push(l);else for(const h of u)e.push(l.child(h))}else e.push(l)})),new Dr(e)}class Xs{constructor(e,n,i,l,u,h,p){this.key=e,this.documentType=n,this.version=i,this.readTime=l,this.createTime=u,this.data=h,this.documentState=p}static newInvalidDocument(e){return new Xs(e,0,Gt.min(),Gt.min(),Gt.min(),br.empty(),0)}static newFoundDocument(e,n,i,l){return new Xs(e,1,n,Gt.min(),i,l,0)}static newNoDocument(e,n){return new Xs(e,2,n,Gt.min(),Gt.min(),br.empty(),0)}static newUnknownDocument(e,n){return new Xs(e,3,n,Gt.min(),Gt.min(),br.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Gt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=br.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=br.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Gt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Xs&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Xs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Ld{constructor(e,n){this.position=e,this.inclusive=n}}function xx(s,e,n){let i=0;for(let l=0;l<s.position.length;l++){const u=e[l],h=s.position[l];if(u.field.isKeyField()?i=jt.comparator(jt.fromName(h.referenceValue),n.key):i=Fl(h,n.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function wx(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let n=0;n<s.position.length;n++)if(!Aa(s.position[n],e.position[n]))return!1;return!0}class mu{constructor(e,n="asc"){this.field=e,this.dir=n}}function wR(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}class Zw{}class Cs extends Zw{constructor(e,n,i){super(),this.field=e,this.op=n,this.value=i}static create(e,n,i){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,i):new kR(e,n,i):n==="array-contains"?new ER(e,i):n==="in"?new SR(e,i):n==="not-in"?new NR(e,i):n==="array-contains-any"?new CR(e,i):new Cs(e,n,i)}static createKeyFieldInFilter(e,n,i){return n==="in"?new TR(e,i):new jR(e,i)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Fl(n,this.value)):n!==null&&so(this.value)===so(n)&&this.matchesComparison(Fl(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Vt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class da extends Zw{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new da(e,n)}matches(e){return e_(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function e_(s){return s.op==="and"}function t_(s){return _R(s)&&e_(s)}function _R(s){for(const e of s.filters)if(e instanceof da)return!1;return!0}function dg(s){if(s instanceof Cs)return s.field.canonicalString()+s.op.toString()+ql(s.value);if(t_(s))return s.filters.map((e=>dg(e))).join(",");{const e=s.filters.map((n=>dg(n))).join(",");return`${s.op}(${e})`}}function n_(s,e){return s instanceof Cs?(function(i,l){return l instanceof Cs&&i.op===l.op&&i.field.isEqual(l.field)&&Aa(i.value,l.value)})(s,e):s instanceof da?(function(i,l){return l instanceof da&&i.op===l.op&&i.filters.length===l.filters.length?i.filters.reduce(((u,h,p)=>u&&n_(h,l.filters[p])),!0):!1})(s,e):void Vt(19439)}function s_(s){return s instanceof Cs?(function(n){return`${n.field.canonicalString()} ${n.op} ${ql(n.value)}`})(s):s instanceof da?(function(n){return n.op.toString()+" {"+n.getFilters().map(s_).join(" ,")+"}"})(s):"Filter"}class kR extends Cs{constructor(e,n,i){super(e,n,i),this.key=jt.fromName(i.referenceValue)}matches(e){const n=jt.comparator(e.key,this.key);return this.matchesComparison(n)}}class TR extends Cs{constructor(e,n){super(e,"in",n),this.keys=r_("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class jR extends Cs{constructor(e,n){super(e,"not-in",n),this.keys=r_("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function r_(s,e){return(e.arrayValue?.values||[]).map((n=>jt.fromName(n.referenceValue)))}class ER extends Cs{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Zg(n)&&fu(n.arrayValue,this.value)}}class SR extends Cs{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&fu(this.value.arrayValue,n)}}class NR extends Cs{constructor(e,n){super(e,"not-in",n)}matches(e){if(fu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!fu(this.value.arrayValue,n)}}class CR extends Cs{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Zg(n)||!n.arrayValue.values)&&n.arrayValue.values.some((i=>fu(this.value.arrayValue,i)))}}class RR{constructor(e,n=null,i=[],l=[],u=null,h=null,p=null){this.path=e,this.collectionGroup=n,this.orderBy=i,this.filters=l,this.limit=u,this.startAt=h,this.endAt=p,this.Te=null}}function _x(s,e=null,n=[],i=[],l=null,u=null,h=null){return new RR(s,e,n,i,l,u,h)}function ey(s){const e=Xt(s);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((i=>dg(i))).join(","),n+="|ob:",n+=e.orderBy.map((i=>(function(u){return u.field.canonicalString()+u.dir})(i))).join(","),tf(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((i=>ql(i))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((i=>ql(i))).join(",")),e.Te=n}return e.Te}function ty(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<s.orderBy.length;n++)if(!wR(s.orderBy[n],e.orderBy[n]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let n=0;n<s.filters.length;n++)if(!n_(s.filters[n],e.filters[n]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!wx(s.startAt,e.startAt)&&wx(s.endAt,e.endAt)}function fg(s){return jt.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}class Zl{constructor(e,n=null,i=[],l=[],u=null,h="F",p=null,g=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=l,this.limit=u,this.limitType=h,this.startAt=p,this.endAt=g,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function AR(s,e,n,i,l,u,h,p){return new Zl(s,e,n,i,l,u,h,p)}function sf(s){return new Zl(s)}function kx(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function IR(s){return jt.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function a_(s){return s.collectionGroup!==null}function tu(s){const e=Xt(s);if(e.Ie===null){e.Ie=[];const n=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),n.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(h){let p=new Ms(qs.comparator);return h.filters.forEach((g=>{g.getFlattenedFilters().forEach((y=>{y.isInequality()&&(p=p.add(y.field))}))})),p})(e).forEach((u=>{n.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new mu(u,i))})),n.has(qs.keyField().canonicalString())||e.Ie.push(new mu(qs.keyField(),i))}return e.Ie}function Na(s){const e=Xt(s);return e.Ee||(e.Ee=MR(e,tu(s))),e.Ee}function MR(s,e){if(s.limitType==="F")return _x(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((l=>{const u=l.dir==="desc"?"asc":"desc";return new mu(l.field,u)}));const n=s.endAt?new Ld(s.endAt.position,s.endAt.inclusive):null,i=s.startAt?new Ld(s.startAt.position,s.startAt.inclusive):null;return _x(s.path,s.collectionGroup,e,s.filters,s.limit,n,i)}}function mg(s,e){const n=s.filters.concat([e]);return new Zl(s.path,s.collectionGroup,s.explicitOrderBy.slice(),n,s.limit,s.limitType,s.startAt,s.endAt)}function DR(s,e){const n=s.explicitOrderBy.concat([e]);return new Zl(s.path,s.collectionGroup,n,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}function Od(s,e,n){return new Zl(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,n,s.startAt,s.endAt)}function rf(s,e){return ty(Na(s),Na(e))&&s.limitType===e.limitType}function i_(s){return`${ey(Na(s))}|lt:${s.limitType}`}function Al(s){return`Query(target=${(function(n){let i=n.path.canonicalString();return n.collectionGroup!==null&&(i+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(i+=`, filters: [${n.filters.map((l=>s_(l))).join(", ")}]`),tf(n.limit)||(i+=", limit: "+n.limit),n.orderBy.length>0&&(i+=`, orderBy: [${n.orderBy.map((l=>(function(h){return`${h.field.canonicalString()} (${h.dir})`})(l))).join(", ")}]`),n.startAt&&(i+=", startAt: ",i+=n.startAt.inclusive?"b:":"a:",i+=n.startAt.position.map((l=>ql(l))).join(",")),n.endAt&&(i+=", endAt: ",i+=n.endAt.inclusive?"a:":"b:",i+=n.endAt.position.map((l=>ql(l))).join(",")),`Target(${i})`})(Na(s))}; limitType=${s.limitType})`}function af(s,e){return e.isFoundDocument()&&(function(i,l){const u=l.key.path;return i.collectionGroup!==null?l.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):jt.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)})(s,e)&&(function(i,l){for(const u of tu(i))if(!u.field.isKeyField()&&l.data.field(u.field)===null)return!1;return!0})(s,e)&&(function(i,l){for(const u of i.filters)if(!u.matches(l))return!1;return!0})(s,e)&&(function(i,l){return!(i.startAt&&!(function(h,p,g){const y=xx(h,p,g);return h.inclusive?y<=0:y<0})(i.startAt,tu(i),l)||i.endAt&&!(function(h,p,g){const y=xx(h,p,g);return h.inclusive?y>=0:y>0})(i.endAt,tu(i),l))})(s,e)}function PR(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function o_(s){return(e,n)=>{let i=!1;for(const l of tu(s)){const u=LR(l,e,n);if(u!==0)return u;i=i||l.field.isKeyField()}return 0}}function LR(s,e,n){const i=s.field.isKeyField()?jt.comparator(e.key,n.key):(function(u,h,p){const g=h.data.field(u),y=p.data.field(u);return g!==null&&y!==null?Fl(g,y):Vt(42886)})(s.field,e,n);switch(s.dir){case"asc":return i;case"desc":return-1*i;default:return Vt(19790,{direction:s.dir})}}class Go{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i!==void 0){for(const[l,u]of i)if(this.equalsFn(l,e))return u}}has(e){return this.get(e)!==void 0}set(e,n){const i=this.mapKeyFn(e),l=this.inner[i];if(l===void 0)return this.inner[i]=[[e,n]],void this.innerSize++;for(let u=0;u<l.length;u++)if(this.equalsFn(l[u][0],e))return void(l[u]=[e,n]);l.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return!1;for(let l=0;l<i.length;l++)if(this.equalsFn(i[l][0],e))return i.length===1?delete this.inner[n]:i.splice(l,1),this.innerSize--,!0;return!1}forEach(e){lo(this.inner,((n,i)=>{for(const[l,u]of i)e(l,u)}))}isEmpty(){return Hw(this.inner)}size(){return this.innerSize}}const OR=new hs(jt.comparator);function ci(){return OR}const l_=new hs(jt.comparator);function Yc(...s){let e=l_;for(const n of s)e=e.insert(n.key,n);return e}function c_(s){let e=l_;return s.forEach(((n,i)=>e=e.insert(n,i.overlayedDocument))),e}function Io(){return nu()}function u_(){return nu()}function nu(){return new Go((s=>s.toString()),((s,e)=>s.isEqual(e)))}const VR=new hs(jt.comparator),BR=new Ms(jt.comparator);function gn(...s){let e=BR;for(const n of s)e=e.add(n);return e}const UR=new Ms(pn);function zR(){return UR}function ny(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Md(e)?"-0":e}}function h_(s){return{integerValue:""+s}}function d_(s,e){return dR(e)?h_(e):ny(s,e)}class of{constructor(){this._=void 0}}function FR(s,e,n){return s instanceof pu?(function(l,u){const h={fields:{[Gw]:{stringValue:Ww},[Yw]:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}};return u&&Jg(u)&&(u=nf(u)),u&&(h.fields[Kw]=u),{mapValue:h}})(n,e):s instanceof gu?m_(s,e):s instanceof yu?p_(s,e):(function(l,u){const h=f_(l,u),p=Tx(h)+Tx(l.Ae);return hg(h)&&hg(l.Ae)?h_(p):ny(l.serializer,p)})(s,e)}function qR(s,e,n){return s instanceof gu?m_(s,e):s instanceof yu?p_(s,e):n}function f_(s,e){return s instanceof vu?(function(i){return hg(i)||(function(u){return!!u&&"doubleValue"in u})(i)})(e)?e:{integerValue:0}:null}class pu extends of{}class gu extends of{constructor(e){super(),this.elements=e}}function m_(s,e){const n=g_(e);for(const i of s.elements)n.some((l=>Aa(l,i)))||n.push(i);return{arrayValue:{values:n}}}class yu extends of{constructor(e){super(),this.elements=e}}function p_(s,e){let n=g_(e);for(const i of s.elements)n=n.filter((l=>!Aa(l,i)));return{arrayValue:{values:n}}}class vu extends of{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function Tx(s){return ws(s.integerValue||s.doubleValue)}function g_(s){return Zg(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}class y_{constructor(e,n){this.field=e,this.transform=n}}function HR(s,e){return s.field.isEqual(e.field)&&(function(i,l){return i instanceof gu&&l instanceof gu||i instanceof yu&&l instanceof yu?zl(i.elements,l.elements,Aa):i instanceof vu&&l instanceof vu?Aa(i.Ae,l.Ae):i instanceof pu&&l instanceof pu})(s.transform,e.transform)}class $R{constructor(e,n){this.version=e,this.transformResults=n}}class lr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new lr}static exists(e){return new lr(void 0,e)}static updateTime(e){return new lr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function xd(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class lf{}function v_(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new cf(s.key,lr.none()):new Nu(s.key,s.data,lr.none());{const n=s.data,i=br.empty();let l=new Ms(qs.comparator);for(let u of e.fields)if(!l.has(u)){let h=n.field(u);h===null&&u.length>1&&(u=u.popLast(),h=n.field(u)),h===null?i.delete(u):i.set(u,h),l=l.add(u)}return new co(s.key,i,new Dr(l.toArray()),lr.none())}}function WR(s,e,n){s instanceof Nu?(function(l,u,h){const p=l.value.clone(),g=Ex(l.fieldTransforms,u,h.transformResults);p.setAll(g),u.convertToFoundDocument(h.version,p).setHasCommittedMutations()})(s,e,n):s instanceof co?(function(l,u,h){if(!xd(l.precondition,u))return void u.convertToUnknownDocument(h.version);const p=Ex(l.fieldTransforms,u,h.transformResults),g=u.data;g.setAll(b_(l)),g.setAll(p),u.convertToFoundDocument(h.version,g).setHasCommittedMutations()})(s,e,n):(function(l,u,h){u.convertToNoDocument(h.version).setHasCommittedMutations()})(0,e,n)}function su(s,e,n,i){return s instanceof Nu?(function(u,h,p,g){if(!xd(u.precondition,h))return p;const y=u.value.clone(),w=Sx(u.fieldTransforms,g,h);return y.setAll(w),h.convertToFoundDocument(h.version,y).setHasLocalMutations(),null})(s,e,n,i):s instanceof co?(function(u,h,p,g){if(!xd(u.precondition,h))return p;const y=Sx(u.fieldTransforms,g,h),w=h.data;return w.setAll(b_(u)),w.setAll(y),h.convertToFoundDocument(h.version,w).setHasLocalMutations(),p===null?null:p.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((k=>k.field)))})(s,e,n,i):(function(u,h,p){return xd(u.precondition,h)?(h.convertToNoDocument(h.version).setHasLocalMutations(),null):p})(s,e,n)}function GR(s,e){let n=null;for(const i of s.fieldTransforms){const l=e.data.field(i.field),u=f_(i.transform,l||null);u!=null&&(n===null&&(n=br.empty()),n.set(i.field,u))}return n||null}function jx(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(i,l){return i===void 0&&l===void 0||!(!i||!l)&&zl(i,l,((u,h)=>HR(u,h)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class Nu extends lf{constructor(e,n,i,l=[]){super(),this.key=e,this.value=n,this.precondition=i,this.fieldTransforms=l,this.type=0}getFieldMask(){return null}}class co extends lf{constructor(e,n,i,l,u=[]){super(),this.key=e,this.data=n,this.fieldMask=i,this.precondition=l,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function b_(s){const e=new Map;return s.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=s.data.field(n);e.set(n,i)}})),e}function Ex(s,e,n){const i=new Map;On(s.length===n.length,32656,{Ve:n.length,de:s.length});for(let l=0;l<n.length;l++){const u=s[l],h=u.transform,p=e.data.field(u.field);i.set(u.field,qR(h,p,n[l]))}return i}function Sx(s,e,n){const i=new Map;for(const l of s){const u=l.transform,h=n.data.field(l.field);i.set(l.field,FR(u,h,e))}return i}class cf extends lf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class KR extends lf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class YR{constructor(e,n,i,l){this.batchId=e,this.localWriteTime=n,this.baseMutations=i,this.mutations=l}applyToRemoteDocument(e,n){const i=n.mutationResults;for(let l=0;l<this.mutations.length;l++){const u=this.mutations[l];u.key.isEqual(e.key)&&WR(u,e,i[l])}}applyToLocalView(e,n){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(n=su(i,e,n,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(n=su(i,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const i=u_();return this.mutations.forEach((l=>{const u=e.get(l.key),h=u.overlayedDocument;let p=this.applyToLocalView(h,u.mutatedFields);p=n.has(l.key)?null:p;const g=v_(h,p);g!==null&&i.set(l.key,g),h.isValidDocument()||h.convertToNoDocument(Gt.min())})),i}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),gn())}isEqual(e){return this.batchId===e.batchId&&zl(this.mutations,e.mutations,((n,i)=>jx(n,i)))&&zl(this.baseMutations,e.baseMutations,((n,i)=>jx(n,i)))}}class sy{constructor(e,n,i,l){this.batch=e,this.commitVersion=n,this.mutationResults=i,this.docVersions=l}static from(e,n,i){On(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let l=(function(){return VR})();const u=e.mutations;for(let h=0;h<u.length;h++)l=l.insert(u[h].key,i[h].version);return new sy(e,n,i,l)}}class QR{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class XR{constructor(e,n){this.count=e,this.unchangedNames=n}}var Ns,Tn;function JR(s){switch(s){case _e.OK:return Vt(64938);case _e.CANCELLED:case _e.UNKNOWN:case _e.DEADLINE_EXCEEDED:case _e.RESOURCE_EXHAUSTED:case _e.INTERNAL:case _e.UNAVAILABLE:case _e.UNAUTHENTICATED:return!1;case _e.INVALID_ARGUMENT:case _e.NOT_FOUND:case _e.ALREADY_EXISTS:case _e.PERMISSION_DENIED:case _e.FAILED_PRECONDITION:case _e.ABORTED:case _e.OUT_OF_RANGE:case _e.UNIMPLEMENTED:case _e.DATA_LOSS:return!0;default:return Vt(15467,{code:s})}}function x_(s){if(s===void 0)return li("GRPC error has no .code"),_e.UNKNOWN;switch(s){case Ns.OK:return _e.OK;case Ns.CANCELLED:return _e.CANCELLED;case Ns.UNKNOWN:return _e.UNKNOWN;case Ns.DEADLINE_EXCEEDED:return _e.DEADLINE_EXCEEDED;case Ns.RESOURCE_EXHAUSTED:return _e.RESOURCE_EXHAUSTED;case Ns.INTERNAL:return _e.INTERNAL;case Ns.UNAVAILABLE:return _e.UNAVAILABLE;case Ns.UNAUTHENTICATED:return _e.UNAUTHENTICATED;case Ns.INVALID_ARGUMENT:return _e.INVALID_ARGUMENT;case Ns.NOT_FOUND:return _e.NOT_FOUND;case Ns.ALREADY_EXISTS:return _e.ALREADY_EXISTS;case Ns.PERMISSION_DENIED:return _e.PERMISSION_DENIED;case Ns.FAILED_PRECONDITION:return _e.FAILED_PRECONDITION;case Ns.ABORTED:return _e.ABORTED;case Ns.OUT_OF_RANGE:return _e.OUT_OF_RANGE;case Ns.UNIMPLEMENTED:return _e.UNIMPLEMENTED;case Ns.DATA_LOSS:return _e.DATA_LOSS;default:return Vt(39323,{code:s})}}(Tn=Ns||(Ns={}))[Tn.OK=0]="OK",Tn[Tn.CANCELLED=1]="CANCELLED",Tn[Tn.UNKNOWN=2]="UNKNOWN",Tn[Tn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Tn[Tn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Tn[Tn.NOT_FOUND=5]="NOT_FOUND",Tn[Tn.ALREADY_EXISTS=6]="ALREADY_EXISTS",Tn[Tn.PERMISSION_DENIED=7]="PERMISSION_DENIED",Tn[Tn.UNAUTHENTICATED=16]="UNAUTHENTICATED",Tn[Tn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Tn[Tn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Tn[Tn.ABORTED=10]="ABORTED",Tn[Tn.OUT_OF_RANGE=11]="OUT_OF_RANGE",Tn[Tn.UNIMPLEMENTED=12]="UNIMPLEMENTED",Tn[Tn.INTERNAL=13]="INTERNAL",Tn[Tn.UNAVAILABLE=14]="UNAVAILABLE",Tn[Tn.DATA_LOSS=15]="DATA_LOSS";function ZR(){return new TextEncoder}const eA=new Xi([4294967295,4294967295],0);function Nx(s){const e=ZR().encode(s),n=new Mw;return n.update(e),new Uint8Array(n.digest())}function Cx(s){const e=new DataView(s.buffer),n=e.getUint32(0,!0),i=e.getUint32(4,!0),l=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new Xi([n,i],0),new Xi([l,u],0)]}class ry{constructor(e,n,i){if(this.bitmap=e,this.padding=n,this.hashCount=i,n<0||n>=8)throw new Qc(`Invalid padding: ${n}`);if(i<0)throw new Qc(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Qc(`Invalid hash count: ${i}`);if(e.length===0&&n!==0)throw new Qc(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Xi.fromNumber(this.ge)}ye(e,n,i){let l=e.add(n.multiply(Xi.fromNumber(i)));return l.compare(eA)===1&&(l=new Xi([l.getBits(0),l.getBits(1)],0)),l.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=Nx(e),[i,l]=Cx(n);for(let u=0;u<this.hashCount;u++){const h=this.ye(i,l,u);if(!this.we(h))return!1}return!0}static create(e,n,i){const l=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),h=new ry(u,l,n);return i.forEach((p=>h.insert(p))),h}insert(e){if(this.ge===0)return;const n=Nx(e),[i,l]=Cx(n);for(let u=0;u<this.hashCount;u++){const h=this.ye(i,l,u);this.be(h)}}be(e){const n=Math.floor(e/8),i=e%8;this.bitmap[n]|=1<<i}}class Qc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class uf{constructor(e,n,i,l,u){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=i,this.documentUpdates=l,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,n,i){const l=new Map;return l.set(e,Cu.createSynthesizedTargetChangeForCurrentChange(e,n,i)),new uf(Gt.min(),l,new hs(pn),ci(),gn())}}class Cu{constructor(e,n,i,l,u){this.resumeToken=e,this.current=n,this.addedDocuments=i,this.modifiedDocuments=l,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,n,i){return new Cu(i,n,gn(),gn(),gn())}}class wd{constructor(e,n,i,l){this.Se=e,this.removedTargetIds=n,this.key=i,this.De=l}}class w_{constructor(e,n){this.targetId=e,this.Ce=n}}class __{constructor(e,n,i=Hs.EMPTY_BYTE_STRING,l=null){this.state=e,this.targetIds=n,this.resumeToken=i,this.cause=l}}class Rx{constructor(){this.ve=0,this.Fe=Ax(),this.Me=Hs.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=gn(),n=gn(),i=gn();return this.Fe.forEach(((l,u)=>{switch(u){case 0:e=e.add(l);break;case 2:n=n.add(l);break;case 1:i=i.add(l);break;default:Vt(38017,{changeType:u})}})),new Cu(this.Me,this.xe,e,n,i)}Ke(){this.Oe=!1,this.Fe=Ax()}qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,On(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class tA{constructor(e){this.Ge=e,this.ze=new Map,this.je=ci(),this.He=td(),this.Je=td(),this.Ze=new hs(pn)}Xe(e){for(const n of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const i=this.nt(n);switch(e.state){case 0:this.rt(n)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),i.Le(e.resumeToken));break;default:Vt(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((i,l)=>{this.rt(l)&&n(l)}))}st(e){const n=e.targetId,i=e.Ce.count,l=this.ot(n);if(l){const u=l.target;if(fg(u))if(i===0){const h=new jt(u.path);this.et(n,h,Xs.newNoDocument(h,Gt.min()))}else On(i===1,20013,{expectedCount:i});else{const h=this._t(n);if(h!==i){const p=this.ut(e),g=p?this.ct(p,e,h):1;if(g!==0){this.it(n);const y=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(n,y)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:i="",padding:l=0},hashCount:u=0}=n;let h,p;try{h=no(i).toUint8Array()}catch(g){if(g instanceof $w)return Ul("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{p=new ry(h,l,u)}catch(g){return Ul(g instanceof Qc?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return p.ge===0?null:p}ct(e,n,i){return n.Ce.count===i-this.Pt(e,n.targetId)?0:2}Pt(e,n){const i=this.Ge.getRemoteKeysForTarget(n);let l=0;return i.forEach((u=>{const h=this.Ge.ht(),p=`projects/${h.projectId}/databases/${h.database}/documents/${u.path.canonicalString()}`;e.mightContain(p)||(this.et(n,u,null),l++)})),l}Tt(e){const n=new Map;this.ze.forEach(((u,h)=>{const p=this.ot(h);if(p){if(u.current&&fg(p.target)){const g=new jt(p.target.path);this.It(g).has(h)||this.Et(h,g)||this.et(h,g,Xs.newNoDocument(g,e))}u.Be&&(n.set(h,u.ke()),u.Ke())}}));let i=gn();this.Je.forEach(((u,h)=>{let p=!0;h.forEachWhile((g=>{const y=this.ot(g);return!y||y.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(i=i.add(u))})),this.je.forEach(((u,h)=>h.setReadTime(e)));const l=new uf(e,n,this.Ze,this.je,i);return this.je=ci(),this.He=td(),this.Je=td(),this.Ze=new hs(pn),l}Ye(e,n){if(!this.rt(e))return;const i=this.Et(e,n.key)?2:0;this.nt(e).qe(n.key,i),this.je=this.je.insert(n.key,n),this.He=this.He.insert(n.key,this.It(n.key).add(e)),this.Je=this.Je.insert(n.key,this.Rt(n.key).add(e))}et(e,n,i){if(!this.rt(e))return;const l=this.nt(e);this.Et(e,n)?l.qe(n,1):l.Ue(n),this.Je=this.Je.insert(n,this.Rt(n).delete(e)),this.Je=this.Je.insert(n,this.Rt(n).add(e)),i&&(this.je=this.je.insert(n,i))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let n=this.ze.get(e);return n||(n=new Rx,this.ze.set(e,n)),n}Rt(e){let n=this.Je.get(e);return n||(n=new Ms(pn),this.Je=this.Je.insert(e,n)),n}It(e){let n=this.He.get(e);return n||(n=new Ms(pn),this.He=this.He.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||it("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Rx),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function td(){return new hs(jt.comparator)}function Ax(){return new hs(jt.comparator)}const nA={asc:"ASCENDING",desc:"DESCENDING"},sA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},rA={and:"AND",or:"OR"};class aA{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function pg(s,e){return s.useProto3Json||tf(e)?e:{value:e}}function Vd(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function k_(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function iA(s,e){return Vd(s,e.toTimestamp())}function Ca(s){return On(!!s,49232),Gt.fromTimestamp((function(n){const i=to(n);return new bt(i.seconds,i.nanos)})(s))}function ay(s,e){return gg(s,e).canonicalString()}function gg(s,e){const n=(function(l){return new Xn(["projects",l.projectId,"databases",l.database])})(s).child("documents");return e===void 0?n:n.child(e)}function T_(s){const e=Xn.fromString(s);return On(C_(e),10190,{key:e.toString()}),e}function yg(s,e){return ay(s.databaseId,e.path)}function Cp(s,e){const n=T_(e);if(n.get(1)!==s.databaseId.projectId)throw new tt(_e.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+s.databaseId.projectId);if(n.get(3)!==s.databaseId.database)throw new tt(_e.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+s.databaseId.database);return new jt(E_(n))}function j_(s,e){return ay(s.databaseId,e)}function oA(s){const e=T_(s);return e.length===4?Xn.emptyPath():E_(e)}function vg(s){return new Xn(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function E_(s){return On(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function Ix(s,e,n){return{name:yg(s,e),fields:n.value.mapValue.fields}}function lA(s,e){let n;if("targetChange"in e){e.targetChange;const i=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:Vt(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),l=e.targetChange.targetIds||[],u=(function(y,w){return y.useProto3Json?(On(w===void 0||typeof w=="string",58123),Hs.fromBase64String(w||"")):(On(w===void 0||w instanceof Buffer||w instanceof Uint8Array,16193),Hs.fromUint8Array(w||new Uint8Array))})(s,e.targetChange.resumeToken),h=e.targetChange.cause,p=h&&(function(y){const w=y.code===void 0?_e.UNKNOWN:x_(y.code);return new tt(w,y.message||"")})(h);n=new __(i,l,u,p||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const l=Cp(s,i.document.name),u=Ca(i.document.updateTime),h=i.document.createTime?Ca(i.document.createTime):Gt.min(),p=new br({mapValue:{fields:i.document.fields}}),g=Xs.newFoundDocument(l,u,h,p),y=i.targetIds||[],w=i.removedTargetIds||[];n=new wd(y,w,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const l=Cp(s,i.document),u=i.readTime?Ca(i.readTime):Gt.min(),h=Xs.newNoDocument(l,u),p=i.removedTargetIds||[];n=new wd([],p,h.key,h)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const l=Cp(s,i.document),u=i.removedTargetIds||[];n=new wd([],u,l,null)}else{if(!("filter"in e))return Vt(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:l=0,unchangedNames:u}=i,h=new XR(l,u),p=i.targetId;n=new w_(p,h)}}return n}function cA(s,e){let n;if(e instanceof Nu)n={update:Ix(s,e.key,e.value)};else if(e instanceof cf)n={delete:yg(s,e.key)};else if(e instanceof co)n={update:Ix(s,e.key,e.data),updateMask:vA(e.fieldMask)};else{if(!(e instanceof KR))return Vt(16599,{dt:e.type});n={verify:yg(s,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((i=>(function(u,h){const p=h.transform;if(p instanceof pu)return{fieldPath:h.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof gu)return{fieldPath:h.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof yu)return{fieldPath:h.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof vu)return{fieldPath:h.field.canonicalString(),increment:p.Ae};throw Vt(20930,{transform:h.transform})})(0,i)))),e.precondition.isNone||(n.currentDocument=(function(l,u){return u.updateTime!==void 0?{updateTime:iA(l,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:Vt(27497)})(s,e.precondition)),n}function uA(s,e){return s&&s.length>0?(On(e!==void 0,14353),s.map((n=>(function(l,u){let h=l.updateTime?Ca(l.updateTime):Ca(u);return h.isEqual(Gt.min())&&(h=Ca(u)),new $R(h,l.transformResults||[])})(n,e)))):[]}function hA(s,e){return{documents:[j_(s,e.path)]}}function dA(s,e){const n={structuredQuery:{}},i=e.path;let l;e.collectionGroup!==null?(l=i,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(l=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=j_(s,l);const u=(function(y){if(y.length!==0)return N_(da.create(y,"and"))})(e.filters);u&&(n.structuredQuery.where=u);const h=(function(y){if(y.length!==0)return y.map((w=>(function(E){return{field:Il(E.field),direction:pA(E.dir)}})(w)))})(e.orderBy);h&&(n.structuredQuery.orderBy=h);const p=pg(s,e.limit);return p!==null&&(n.structuredQuery.limit=p),e.startAt&&(n.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:n,parent:l}}function fA(s){let e=oA(s.parent);const n=s.structuredQuery,i=n.from?n.from.length:0;let l=null;if(i>0){On(i===1,65062);const w=n.from[0];w.allDescendants?l=w.collectionId:e=e.child(w.collectionId)}let u=[];n.where&&(u=(function(k){const E=S_(k);return E instanceof da&&t_(E)?E.getFilters():[E]})(n.where));let h=[];n.orderBy&&(h=(function(k){return k.map((E=>(function(G){return new mu(Ml(G.field),(function(V){switch(V){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(G.direction))})(E)))})(n.orderBy));let p=null;n.limit&&(p=(function(k){let E;return E=typeof k=="object"?k.value:k,tf(E)?null:E})(n.limit));let g=null;n.startAt&&(g=(function(k){const E=!!k.before,O=k.values||[];return new Ld(O,E)})(n.startAt));let y=null;return n.endAt&&(y=(function(k){const E=!k.before,O=k.values||[];return new Ld(O,E)})(n.endAt)),AR(e,l,h,u,p,"F",g,y)}function mA(s,e){const n=(function(l){switch(l){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Vt(28987,{purpose:l})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function S_(s){return s.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const i=Ml(n.unaryFilter.field);return Cs.create(i,"==",{doubleValue:NaN});case"IS_NULL":const l=Ml(n.unaryFilter.field);return Cs.create(l,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=Ml(n.unaryFilter.field);return Cs.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const h=Ml(n.unaryFilter.field);return Cs.create(h,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Vt(61313);default:return Vt(60726)}})(s):s.fieldFilter!==void 0?(function(n){return Cs.create(Ml(n.fieldFilter.field),(function(l){switch(l){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Vt(58110);default:return Vt(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(n){return da.create(n.compositeFilter.filters.map((i=>S_(i))),(function(l){switch(l){case"AND":return"and";case"OR":return"or";default:return Vt(1026)}})(n.compositeFilter.op))})(s):Vt(30097,{filter:s})}function pA(s){return nA[s]}function gA(s){return sA[s]}function yA(s){return rA[s]}function Il(s){return{fieldPath:s.canonicalString()}}function Ml(s){return qs.fromServerFormat(s.fieldPath)}function N_(s){return s instanceof Cs?(function(n){if(n.op==="=="){if(bx(n.value))return{unaryFilter:{field:Il(n.field),op:"IS_NAN"}};if(vx(n.value))return{unaryFilter:{field:Il(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(bx(n.value))return{unaryFilter:{field:Il(n.field),op:"IS_NOT_NAN"}};if(vx(n.value))return{unaryFilter:{field:Il(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Il(n.field),op:gA(n.op),value:n.value}}})(s):s instanceof da?(function(n){const i=n.getFilters().map((l=>N_(l)));return i.length===1?i[0]:{compositeFilter:{op:yA(n.op),filters:i}}})(s):Vt(54877,{filter:s})}function vA(s){const e=[];return s.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function C_(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}function R_(s){return!!s&&typeof s._toProto=="function"&&s._protoValueType==="ProtoValue"}class Wi{constructor(e,n,i,l,u=Gt.min(),h=Gt.min(),p=Hs.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=n,this.purpose=i,this.sequenceNumber=l,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=h,this.resumeToken=p,this.expectedCount=g}withSequenceNumber(e){return new Wi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Wi(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Wi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Wi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class bA{constructor(e){this.yt=e}}function xA(s){const e=fA({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?Od(e,e.limit,"L"):e}class wA{constructor(){this.Sn=new _A}addToCollectionParentIndex(e,n){return this.Sn.add(n),Ie.resolve()}getCollectionParents(e,n){return Ie.resolve(this.Sn.getEntries(n))}addFieldIndex(e,n){return Ie.resolve()}deleteFieldIndex(e,n){return Ie.resolve()}deleteAllFieldIndexes(e){return Ie.resolve()}createTargetIndexes(e,n){return Ie.resolve()}getDocumentsMatchingTarget(e,n){return Ie.resolve(null)}getIndexType(e,n){return Ie.resolve(0)}getFieldIndexes(e,n){return Ie.resolve([])}getNextCollectionGroupToUpdate(e){return Ie.resolve(null)}getMinOffset(e,n){return Ie.resolve(eo.min())}getMinOffsetFromCollectionGroup(e,n){return Ie.resolve(eo.min())}updateCollectionGroup(e,n,i){return Ie.resolve()}updateIndexEntries(e,n){return Ie.resolve()}}class _A{constructor(){this.index={}}add(e){const n=e.lastSegment(),i=e.popLast(),l=this.index[n]||new Ms(Xn.comparator),u=!l.has(i);return this.index[n]=l.add(i),u}has(e){const n=e.lastSegment(),i=e.popLast(),l=this.index[n];return l&&l.has(i)}getEntries(e){return(this.index[e]||new Ms(Xn.comparator)).toArray()}}const Mx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},A_=41943040;class vr{static withCacheSize(e){return new vr(e,vr.DEFAULT_COLLECTION_PERCENTILE,vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=i}}vr.DEFAULT_COLLECTION_PERCENTILE=10,vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,vr.DEFAULT=new vr(A_,vr.DEFAULT_COLLECTION_PERCENTILE,vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),vr.DISABLED=new vr(-1,0,0);class Hl{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Hl(0)}static ar(){return new Hl(-1)}}const Dx="LruGarbageCollector",kA=1048576;function Px([s,e],[n,i]){const l=pn(s,n);return l===0?pn(e,i):l}class TA{constructor(e){this.Pr=e,this.buffer=new Ms(Px),this.Tr=0}Ir(){return++this.Tr}Er(e){const n=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(n);else{const i=this.buffer.last();Px(n,i)<0&&(this.buffer=this.buffer.delete(i).add(n))}}get maxValue(){return this.buffer.last()[0]}}class jA{constructor(e,n,i){this.garbageCollector=e,this.asyncQueue=n,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){it(Dx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Jl(n)?it(Dx,"Ignoring IndexedDB error during garbage collection: ",n):await Xl(n)}await this.Ar(3e5)}))}}class EA{constructor(e,n){this.Vr=e,this.params=n}calculateTargetCount(e,n){return this.Vr.dr(e).next((i=>Math.floor(n/100*i)))}nthSequenceNumber(e,n){if(n===0)return Ie.resolve(ef.ce);const i=new TA(n);return this.Vr.forEachTarget(e,(l=>i.Er(l.sequenceNumber))).next((()=>this.Vr.mr(e,(l=>i.Er(l))))).next((()=>i.maxValue))}removeTargets(e,n,i){return this.Vr.removeTargets(e,n,i)}removeOrphanedDocuments(e,n){return this.Vr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(it("LruGarbageCollector","Garbage collection skipped; disabled"),Ie.resolve(Mx)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(it("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Mx):this.gr(e,n)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,n){let i,l,u,h,p,g,y;const w=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((k=>(k>this.params.maximumSequenceNumbersToCollect?(it("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${k}`),l=this.params.maximumSequenceNumbersToCollect):l=k,h=Date.now(),this.nthSequenceNumber(e,l)))).next((k=>(i=k,p=Date.now(),this.removeTargets(e,i,n)))).next((k=>(u=k,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((k=>(y=Date.now(),Rl()<=mn.DEBUG&&it("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${h-w}ms
	Determined least recently used ${l} in `+(p-h)+`ms
	Removed ${u} targets in `+(g-p)+`ms
	Removed ${k} documents in `+(y-g)+`ms
Total Duration: ${y-w}ms`),Ie.resolve({didRun:!0,sequenceNumbersCollected:l,targetsRemoved:u,documentsRemoved:k}))))}}function SA(s,e){return new EA(s,e)}class NA{constructor(){this.changes=new Go((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Xs.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const i=this.changes.get(n);return i!==void 0?Ie.resolve(i):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class CA{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class RA{constructor(e,n,i,l){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=i,this.indexManager=l}getDocument(e,n){let i=null;return this.documentOverlayCache.getOverlay(e,n).next((l=>(i=l,this.remoteDocumentCache.getEntry(e,n)))).next((l=>(i!==null&&su(i.mutation,l,Dr.empty(),bt.now()),l)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((i=>this.getLocalViewOfDocuments(e,i,gn()).next((()=>i))))}getLocalViewOfDocuments(e,n,i=gn()){const l=Io();return this.populateOverlays(e,l,n).next((()=>this.computeViews(e,n,l,i).next((u=>{let h=Yc();return u.forEach(((p,g)=>{h=h.insert(p,g.overlayedDocument)})),h}))))}getOverlayedDocuments(e,n){const i=Io();return this.populateOverlays(e,i,n).next((()=>this.computeViews(e,n,i,gn())))}populateOverlays(e,n,i){const l=[];return i.forEach((u=>{n.has(u)||l.push(u)})),this.documentOverlayCache.getOverlays(e,l).next((u=>{u.forEach(((h,p)=>{n.set(h,p)}))}))}computeViews(e,n,i,l){let u=ci();const h=nu(),p=(function(){return nu()})();return n.forEach(((g,y)=>{const w=i.get(y.key);l.has(y.key)&&(w===void 0||w.mutation instanceof co)?u=u.insert(y.key,y):w!==void 0?(h.set(y.key,w.mutation.getFieldMask()),su(w.mutation,y,w.mutation.getFieldMask(),bt.now())):h.set(y.key,Dr.empty())})),this.recalculateAndSaveOverlays(e,u).next((g=>(g.forEach(((y,w)=>h.set(y,w))),n.forEach(((y,w)=>p.set(y,new CA(w,h.get(y)??null)))),p)))}recalculateAndSaveOverlays(e,n){const i=nu();let l=new hs(((h,p)=>h-p)),u=gn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((h=>{for(const p of h)p.keys().forEach((g=>{const y=n.get(g);if(y===null)return;let w=i.get(g)||Dr.empty();w=p.applyToLocalView(y,w),i.set(g,w);const k=(l.get(p.batchId)||gn()).add(g);l=l.insert(p.batchId,k)}))})).next((()=>{const h=[],p=l.getReverseIterator();for(;p.hasNext();){const g=p.getNext(),y=g.key,w=g.value,k=u_();w.forEach((E=>{if(!u.has(E)){const O=v_(n.get(E),i.get(E));O!==null&&k.set(E,O),u=u.add(E)}})),h.push(this.documentOverlayCache.saveOverlays(e,y,k))}return Ie.waitFor(h)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,n,i,l){return IR(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):a_(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,i,l):this.getDocumentsMatchingCollectionQuery(e,n,i,l)}getNextDocuments(e,n,i,l){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,i,l).next((u=>{const h=l-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,i.largestBatchId,l-u.size):Ie.resolve(Io());let p=uu,g=u;return h.next((y=>Ie.forEach(y,((w,k)=>(p<k.largestBatchId&&(p=k.largestBatchId),u.get(w)?Ie.resolve():this.remoteDocumentCache.getEntry(e,w).next((E=>{g=g.insert(w,E)}))))).next((()=>this.populateOverlays(e,y,u))).next((()=>this.computeViews(e,g,y,gn()))).next((w=>({batchId:p,changes:c_(w)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new jt(n)).next((i=>{let l=Yc();return i.isFoundDocument()&&(l=l.insert(i.key,i)),l}))}getDocumentsMatchingCollectionGroupQuery(e,n,i,l){const u=n.collectionGroup;let h=Yc();return this.indexManager.getCollectionParents(e,u).next((p=>Ie.forEach(p,(g=>{const y=(function(k,E){return new Zl(E,null,k.explicitOrderBy.slice(),k.filters.slice(),k.limit,k.limitType,k.startAt,k.endAt)})(n,g.child(u));return this.getDocumentsMatchingCollectionQuery(e,y,i,l).next((w=>{w.forEach(((k,E)=>{h=h.insert(k,E)}))}))})).next((()=>h))))}getDocumentsMatchingCollectionQuery(e,n,i,l){let u;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,i.largestBatchId).next((h=>(u=h,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,i,u,l)))).next((h=>{u.forEach(((g,y)=>{const w=y.getKey();h.get(w)===null&&(h=h.insert(w,Xs.newInvalidDocument(w)))}));let p=Yc();return h.forEach(((g,y)=>{const w=u.get(g);w!==void 0&&su(w.mutation,y,Dr.empty(),bt.now()),af(n,y)&&(p=p.insert(g,y))})),p}))}}class AA{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,n){return Ie.resolve(this.Nr.get(n))}saveBundleMetadata(e,n){return this.Nr.set(n.id,(function(l){return{id:l.id,version:l.version,createTime:Ca(l.createTime)}})(n)),Ie.resolve()}getNamedQuery(e,n){return Ie.resolve(this.Br.get(n))}saveNamedQuery(e,n){return this.Br.set(n.name,(function(l){return{name:l.name,query:xA(l.bundledQuery),readTime:Ca(l.readTime)}})(n)),Ie.resolve()}}class IA{constructor(){this.overlays=new hs(jt.comparator),this.Lr=new Map}getOverlay(e,n){return Ie.resolve(this.overlays.get(n))}getOverlays(e,n){const i=Io();return Ie.forEach(n,(l=>this.getOverlay(e,l).next((u=>{u!==null&&i.set(l,u)})))).next((()=>i))}saveOverlays(e,n,i){return i.forEach(((l,u)=>{this.bt(e,n,u)})),Ie.resolve()}removeOverlaysForBatchId(e,n,i){const l=this.Lr.get(i);return l!==void 0&&(l.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(i)),Ie.resolve()}getOverlaysForCollection(e,n,i){const l=Io(),u=n.length+1,h=new jt(n.child("")),p=this.overlays.getIteratorFrom(h);for(;p.hasNext();){const g=p.getNext().value,y=g.getKey();if(!n.isPrefixOf(y.path))break;y.path.length===u&&g.largestBatchId>i&&l.set(g.getKey(),g)}return Ie.resolve(l)}getOverlaysForCollectionGroup(e,n,i,l){let u=new hs(((y,w)=>y-w));const h=this.overlays.getIterator();for(;h.hasNext();){const y=h.getNext().value;if(y.getKey().getCollectionGroup()===n&&y.largestBatchId>i){let w=u.get(y.largestBatchId);w===null&&(w=Io(),u=u.insert(y.largestBatchId,w)),w.set(y.getKey(),y)}}const p=Io(),g=u.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((y,w)=>p.set(y,w))),!(p.size()>=l)););return Ie.resolve(p)}bt(e,n,i){const l=this.overlays.get(i.key);if(l!==null){const h=this.Lr.get(l.largestBatchId).delete(i.key);this.Lr.set(l.largestBatchId,h)}this.overlays=this.overlays.insert(i.key,new QR(n,i));let u=this.Lr.get(n);u===void 0&&(u=gn(),this.Lr.set(n,u)),this.Lr.set(n,u.add(i.key))}}class MA{constructor(){this.sessionToken=Hs.EMPTY_BYTE_STRING}getSessionToken(e){return Ie.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,Ie.resolve()}}class iy{constructor(){this.kr=new Ms(Os.Kr),this.qr=new Ms(Os.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,n){const i=new Os(e,n);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,n){e.forEach((i=>this.addReference(i,n)))}removeReference(e,n){this.Wr(new Os(e,n))}Qr(e,n){e.forEach((i=>this.removeReference(i,n)))}Gr(e){const n=new jt(new Xn([])),i=new Os(n,e),l=new Os(n,e+1),u=[];return this.qr.forEachInRange([i,l],(h=>{this.Wr(h),u.push(h.key)})),u}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const n=new jt(new Xn([])),i=new Os(n,e),l=new Os(n,e+1);let u=gn();return this.qr.forEachInRange([i,l],(h=>{u=u.add(h.key)})),u}containsKey(e){const n=new Os(e,0),i=this.kr.firstAfterOrEqual(n);return i!==null&&e.isEqual(i.key)}}class Os{constructor(e,n){this.key=e,this.Hr=n}static Kr(e,n){return jt.comparator(e.key,n.key)||pn(e.Hr,n.Hr)}static Ur(e,n){return pn(e.Hr,n.Hr)||jt.comparator(e.key,n.key)}}class DA{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Yn=1,this.Jr=new Ms(Os.Kr)}checkEmpty(e){return Ie.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,i,l){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const h=new YR(u,n,i,l);this.mutationQueue.push(h);for(const p of l)this.Jr=this.Jr.add(new Os(p.key,u)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return Ie.resolve(h)}lookupMutationBatch(e,n){return Ie.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(e,n){const i=n+1,l=this.Xr(i),u=l<0?0:l;return Ie.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return Ie.resolve(this.mutationQueue.length===0?Xg:this.Yn-1)}getAllMutationBatches(e){return Ie.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const i=new Os(n,0),l=new Os(n,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([i,l],(h=>{const p=this.Zr(h.Hr);u.push(p)})),Ie.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,n){let i=new Ms(pn);return n.forEach((l=>{const u=new Os(l,0),h=new Os(l,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,h],(p=>{i=i.add(p.Hr)}))})),Ie.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,n){const i=n.path,l=i.length+1;let u=i;jt.isDocumentKey(u)||(u=u.child(""));const h=new Os(new jt(u),0);let p=new Ms(pn);return this.Jr.forEachWhile((g=>{const y=g.key.path;return!!i.isPrefixOf(y)&&(y.length===l&&(p=p.add(g.Hr)),!0)}),h),Ie.resolve(this.Yr(p))}Yr(e){const n=[];return e.forEach((i=>{const l=this.Zr(i);l!==null&&n.push(l)})),n}removeMutationBatch(e,n){On(this.ei(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return Ie.forEach(n.mutations,(l=>{const u=new Os(l.key,n.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,l.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,n){const i=new Os(n,0),l=this.Jr.firstAfterOrEqual(i);return Ie.resolve(n.isEqual(l&&l.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ie.resolve()}ei(e,n){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const n=this.Xr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class PA{constructor(e){this.ti=e,this.docs=(function(){return new hs(jt.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const i=n.key,l=this.docs.get(i),u=l?l.size:0,h=this.ti(n);return this.docs=this.docs.insert(i,{document:n.mutableCopy(),size:h}),this.size+=h-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const i=this.docs.get(n);return Ie.resolve(i?i.document.mutableCopy():Xs.newInvalidDocument(n))}getEntries(e,n){let i=ci();return n.forEach((l=>{const u=this.docs.get(l);i=i.insert(l,u?u.document.mutableCopy():Xs.newInvalidDocument(l))})),Ie.resolve(i)}getDocumentsMatchingQuery(e,n,i,l){let u=ci();const h=n.path,p=new jt(h.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(p);for(;g.hasNext();){const{key:y,value:{document:w}}=g.getNext();if(!h.isPrefixOf(y.path))break;y.path.length>h.length+1||lR(oR(w),i)<=0||(l.has(w.key)||af(n,w))&&(u=u.insert(w.key,w.mutableCopy()))}return Ie.resolve(u)}getAllFromCollectionGroup(e,n,i,l){Vt(9500)}ni(e,n){return Ie.forEach(this.docs,(i=>n(i)))}newChangeBuffer(e){return new LA(this)}getSize(e){return Ie.resolve(this.size)}}class LA extends NA{constructor(e){super(),this.Mr=e}applyChanges(e){const n=[];return this.changes.forEach(((i,l)=>{l.isValidDocument()?n.push(this.Mr.addEntry(e,l)):this.Mr.removeEntry(i)})),Ie.waitFor(n)}getFromCache(e,n){return this.Mr.getEntry(e,n)}getAllFromCache(e,n){return this.Mr.getEntries(e,n)}}class OA{constructor(e){this.persistence=e,this.ri=new Go((n=>ey(n)),ty),this.lastRemoteSnapshotVersion=Gt.min(),this.highestTargetId=0,this.ii=0,this.si=new iy,this.targetCount=0,this.oi=Hl._r()}forEachTarget(e,n){return this.ri.forEach(((i,l)=>n(l))),Ie.resolve()}getLastRemoteSnapshotVersion(e){return Ie.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ie.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),Ie.resolve(this.highestTargetId)}setTargetsMetadata(e,n,i){return i&&(this.lastRemoteSnapshotVersion=i),n>this.ii&&(this.ii=n),Ie.resolve()}lr(e){this.ri.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.oi=new Hl(n),this.highestTargetId=n),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,n){return this.lr(n),this.targetCount+=1,Ie.resolve()}updateTargetData(e,n){return this.lr(n),Ie.resolve()}removeTargetData(e,n){return this.ri.delete(n.target),this.si.Gr(n.targetId),this.targetCount-=1,Ie.resolve()}removeTargets(e,n,i){let l=0;const u=[];return this.ri.forEach(((h,p)=>{p.sequenceNumber<=n&&i.get(p.targetId)===null&&(this.ri.delete(h),u.push(this.removeMatchingKeysForTargetId(e,p.targetId)),l++)})),Ie.waitFor(u).next((()=>l))}getTargetCount(e){return Ie.resolve(this.targetCount)}getTargetData(e,n){const i=this.ri.get(n)||null;return Ie.resolve(i)}addMatchingKeys(e,n,i){return this.si.$r(n,i),Ie.resolve()}removeMatchingKeys(e,n,i){this.si.Qr(n,i);const l=this.persistence.referenceDelegate,u=[];return l&&n.forEach((h=>{u.push(l.markPotentiallyOrphaned(e,h))})),Ie.waitFor(u)}removeMatchingKeysForTargetId(e,n){return this.si.Gr(n),Ie.resolve()}getMatchingKeysForTargetId(e,n){const i=this.si.jr(n);return Ie.resolve(i)}containsKey(e,n){return Ie.resolve(this.si.containsKey(n))}}class I_{constructor(e,n){this._i={},this.overlays={},this.ai=new ef(0),this.ui=!1,this.ui=!0,this.ci=new MA,this.referenceDelegate=e(this),this.li=new OA(this),this.indexManager=new wA,this.remoteDocumentCache=(function(l){return new PA(l)})((i=>this.referenceDelegate.hi(i))),this.serializer=new bA(n),this.Pi=new AA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new IA,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let i=this._i[e.toKey()];return i||(i=new DA(n,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,n,i){it("MemoryPersistence","Starting transaction:",e);const l=new VA(this.ai.next());return this.referenceDelegate.Ti(),i(l).next((u=>this.referenceDelegate.Ii(l).next((()=>u)))).toPromise().then((u=>(l.raiseOnCommittedEvent(),u)))}Ei(e,n){return Ie.or(Object.values(this._i).map((i=>()=>i.containsKey(e,n))))}}class VA extends uR{constructor(e){super(),this.currentSequenceNumber=e}}class oy{constructor(e){this.persistence=e,this.Ri=new iy,this.Ai=null}static Vi(e){return new oy(e)}get di(){if(this.Ai)return this.Ai;throw Vt(60996)}addReference(e,n,i){return this.Ri.addReference(i,n),this.di.delete(i.toString()),Ie.resolve()}removeReference(e,n,i){return this.Ri.removeReference(i,n),this.di.add(i.toString()),Ie.resolve()}markPotentiallyOrphaned(e,n){return this.di.add(n.toString()),Ie.resolve()}removeTarget(e,n){this.Ri.Gr(n.targetId).forEach((l=>this.di.add(l.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,n.targetId).next((l=>{l.forEach((u=>this.di.add(u.toString())))})).next((()=>i.removeTargetData(e,n)))}Ti(){this.Ai=new Set}Ii(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ie.forEach(this.di,(i=>{const l=jt.fromPath(i);return this.mi(e,l).next((u=>{u||n.removeEntry(l,Gt.min())}))})).next((()=>(this.Ai=null,n.apply(e))))}updateLimboDocument(e,n){return this.mi(e,n).next((i=>{i?this.di.delete(n.toString()):this.di.add(n.toString())}))}hi(e){return 0}mi(e,n){return Ie.or([()=>Ie.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ei(e,n)])}}class Bd{constructor(e,n){this.persistence=e,this.fi=new Go((i=>fR(i.path)),((i,l)=>i.isEqual(l))),this.garbageCollector=SA(this,n)}static Vi(e,n){return new Bd(e,n)}Ti(){}Ii(e){return Ie.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}dr(e){const n=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>n.next((l=>i+l))))}pr(e){let n=0;return this.mr(e,(i=>{n++})).next((()=>n))}mr(e,n){return Ie.forEach(this.fi,((i,l)=>this.wr(e,i,l).next((u=>u?Ie.resolve():n(l)))))}removeTargets(e,n,i){return this.persistence.getTargetCache().removeTargets(e,n,i)}removeOrphanedDocuments(e,n){let i=0;const l=this.persistence.getRemoteDocumentCache(),u=l.newChangeBuffer();return l.ni(e,(h=>this.wr(e,h,n).next((p=>{p||(i++,u.removeEntry(h,Gt.min()))})))).next((()=>u.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,n){return this.fi.set(n,e.currentSequenceNumber),Ie.resolve()}removeTarget(e,n){const i=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,n,i){return this.fi.set(i,e.currentSequenceNumber),Ie.resolve()}removeReference(e,n,i){return this.fi.set(i,e.currentSequenceNumber),Ie.resolve()}updateLimboDocument(e,n){return this.fi.set(n,e.currentSequenceNumber),Ie.resolve()}hi(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=vd(e.data.value)),n}wr(e,n,i){return Ie.or([()=>this.persistence.Ei(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const l=this.fi.get(n);return Ie.resolve(l!==void 0&&l>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class ly{constructor(e,n,i,l){this.targetId=e,this.fromCache=n,this.Ts=i,this.Is=l}static Es(e,n){let i=gn(),l=gn();for(const u of n.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:l=l.add(u.doc.key)}return new ly(e,n.fromCache,i,l)}}class BA{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class UA{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return fS()?8:hR(Js())>0?6:4})()}initialize(e,n){this.fs=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,i,l){const u={result:null};return this.gs(e,n).next((h=>{u.result=h})).next((()=>{if(!u.result)return this.ps(e,n,l,i).next((h=>{u.result=h}))})).next((()=>{if(u.result)return;const h=new BA;return this.ys(e,n,h).next((p=>{if(u.result=p,this.As)return this.ws(e,n,h,p.size)}))})).next((()=>u.result))}ws(e,n,i,l){return i.documentReadCount<this.Vs?(Rl()<=mn.DEBUG&&it("QueryEngine","SDK will not create cache indexes for query:",Al(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Ie.resolve()):(Rl()<=mn.DEBUG&&it("QueryEngine","Query:",Al(n),"scans",i.documentReadCount,"local documents and returns",l,"documents as results."),i.documentReadCount>this.ds*l?(Rl()<=mn.DEBUG&&it("QueryEngine","The SDK decides to create cache indexes for query:",Al(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Na(n))):Ie.resolve())}gs(e,n){if(kx(n))return Ie.resolve(null);let i=Na(n);return this.indexManager.getIndexType(e,i).next((l=>l===0?null:(n.limit!==null&&l===1&&(n=Od(n,null,"F"),i=Na(n)),this.indexManager.getDocumentsMatchingTarget(e,i).next((u=>{const h=gn(...u);return this.fs.getDocuments(e,h).next((p=>this.indexManager.getMinOffset(e,i).next((g=>{const y=this.bs(n,p);return this.Ss(n,y,h,g.readTime)?this.gs(e,Od(n,null,"F")):this.Ds(e,y,n,g)}))))})))))}ps(e,n,i,l){return kx(n)||l.isEqual(Gt.min())?Ie.resolve(null):this.fs.getDocuments(e,i).next((u=>{const h=this.bs(n,u);return this.Ss(n,h,i,l)?Ie.resolve(null):(Rl()<=mn.DEBUG&&it("QueryEngine","Re-using previous result from %s to execute query: %s",l.toString(),Al(n)),this.Ds(e,h,n,iR(l,uu)).next((p=>p)))}))}bs(e,n){let i=new Ms(o_(e));return n.forEach(((l,u)=>{af(e,u)&&(i=i.add(u))})),i}Ss(e,n,i,l){if(e.limit===null)return!1;if(i.size!==n.size)return!0;const u=e.limitType==="F"?n.last():n.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(l)>0)}ys(e,n,i){return Rl()<=mn.DEBUG&&it("QueryEngine","Using full collection scan to execute query:",Al(n)),this.fs.getDocumentsMatchingQuery(e,n,eo.min(),i)}Ds(e,n,i,l){return this.fs.getDocumentsMatchingQuery(e,i,l).next((u=>(n.forEach((h=>{u=u.insert(h.key,h)})),u)))}}const cy="LocalStore",zA=3e8;class FA{constructor(e,n,i,l){this.persistence=e,this.Cs=n,this.serializer=l,this.vs=new hs(pn),this.Fs=new Go((u=>ey(u)),ty),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new RA(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.vs)))}}function qA(s,e,n,i){return new FA(s,e,n,i)}async function M_(s,e){const n=Xt(s);return await n.persistence.runTransaction("Handle user change","readonly",(i=>{let l;return n.mutationQueue.getAllMutationBatches(i).next((u=>(l=u,n.Os(e),n.mutationQueue.getAllMutationBatches(i)))).next((u=>{const h=[],p=[];let g=gn();for(const y of l){h.push(y.batchId);for(const w of y.mutations)g=g.add(w.key)}for(const y of u){p.push(y.batchId);for(const w of y.mutations)g=g.add(w.key)}return n.localDocuments.getDocuments(i,g).next((y=>({Ns:y,removedBatchIds:h,addedBatchIds:p})))}))}))}function HA(s,e){const n=Xt(s);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const l=e.batch.keys(),u=n.xs.newChangeBuffer({trackRemovals:!0});return(function(p,g,y,w){const k=y.batch,E=k.keys();let O=Ie.resolve();return E.forEach((G=>{O=O.next((()=>w.getEntry(g,G))).next((U=>{const V=y.docVersions.get(G);On(V!==null,48541),U.version.compareTo(V)<0&&(k.applyToRemoteDocument(U,y),U.isValidDocument()&&(U.setReadTime(y.commitVersion),w.addEntry(U)))}))})),O.next((()=>p.mutationQueue.removeMutationBatch(g,k)))})(n,i,e,u).next((()=>u.apply(i))).next((()=>n.mutationQueue.performConsistencyCheck(i))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(i,l,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(p){let g=gn();for(let y=0;y<p.mutationResults.length;++y)p.mutationResults[y].transformResults.length>0&&(g=g.add(p.batch.mutations[y].key));return g})(e)))).next((()=>n.localDocuments.getDocuments(i,l)))}))}function D_(s){const e=Xt(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.li.getLastRemoteSnapshotVersion(n)))}function $A(s,e){const n=Xt(s),i=e.snapshotVersion;let l=n.vs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const h=n.xs.newChangeBuffer({trackRemovals:!0});l=n.vs;const p=[];e.targetChanges.forEach(((w,k)=>{const E=l.get(k);if(!E)return;p.push(n.li.removeMatchingKeys(u,w.removedDocuments,k).next((()=>n.li.addMatchingKeys(u,w.addedDocuments,k))));let O=E.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(k)!==null?O=O.withResumeToken(Hs.EMPTY_BYTE_STRING,Gt.min()).withLastLimboFreeSnapshotVersion(Gt.min()):w.resumeToken.approximateByteSize()>0&&(O=O.withResumeToken(w.resumeToken,i)),l=l.insert(k,O),(function(U,V,ne){return U.resumeToken.approximateByteSize()===0||V.snapshotVersion.toMicroseconds()-U.snapshotVersion.toMicroseconds()>=zA?!0:ne.addedDocuments.size+ne.modifiedDocuments.size+ne.removedDocuments.size>0})(E,O,w)&&p.push(n.li.updateTargetData(u,O))}));let g=ci(),y=gn();if(e.documentUpdates.forEach((w=>{e.resolvedLimboDocuments.has(w)&&p.push(n.persistence.referenceDelegate.updateLimboDocument(u,w))})),p.push(WA(u,h,e.documentUpdates).next((w=>{g=w.Bs,y=w.Ls}))),!i.isEqual(Gt.min())){const w=n.li.getLastRemoteSnapshotVersion(u).next((k=>n.li.setTargetsMetadata(u,u.currentSequenceNumber,i)));p.push(w)}return Ie.waitFor(p).next((()=>h.apply(u))).next((()=>n.localDocuments.getLocalViewOfDocuments(u,g,y))).next((()=>g))})).then((u=>(n.vs=l,u)))}function WA(s,e,n){let i=gn(),l=gn();return n.forEach((u=>i=i.add(u))),e.getEntries(s,i).next((u=>{let h=ci();return n.forEach(((p,g)=>{const y=u.get(p);g.isFoundDocument()!==y.isFoundDocument()&&(l=l.add(p)),g.isNoDocument()&&g.version.isEqual(Gt.min())?(e.removeEntry(p,g.readTime),h=h.insert(p,g)):!y.isValidDocument()||g.version.compareTo(y.version)>0||g.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(g),h=h.insert(p,g)):it(cy,"Ignoring outdated watch update for ",p,". Current version:",y.version," Watch version:",g.version)})),{Bs:h,Ls:l}}))}function GA(s,e){const n=Xt(s);return n.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=Xg),n.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function KA(s,e){const n=Xt(s);return n.persistence.runTransaction("Allocate target","readwrite",(i=>{let l;return n.li.getTargetData(i,e).next((u=>u?(l=u,Ie.resolve(l)):n.li.allocateTargetId(i).next((h=>(l=new Wi(e,h,"TargetPurposeListen",i.currentSequenceNumber),n.li.addTargetData(i,l).next((()=>l)))))))})).then((i=>{const l=n.vs.get(i.targetId);return(l===null||i.snapshotVersion.compareTo(l.snapshotVersion)>0)&&(n.vs=n.vs.insert(i.targetId,i),n.Fs.set(e,i.targetId)),i}))}async function bg(s,e,n){const i=Xt(s),l=i.vs.get(e),u=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",u,(h=>i.persistence.referenceDelegate.removeTarget(h,l)))}catch(h){if(!Jl(h))throw h;it(cy,`Failed to update sequence numbers for target ${e}: ${h}`)}i.vs=i.vs.remove(e),i.Fs.delete(l.target)}function Lx(s,e,n){const i=Xt(s);let l=Gt.min(),u=gn();return i.persistence.runTransaction("Execute query","readwrite",(h=>(function(g,y,w){const k=Xt(g),E=k.Fs.get(w);return E!==void 0?Ie.resolve(k.vs.get(E)):k.li.getTargetData(y,w)})(i,h,Na(e)).next((p=>{if(p)return l=p.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(h,p.targetId).next((g=>{u=g}))})).next((()=>i.Cs.getDocumentsMatchingQuery(h,e,n?l:Gt.min(),n?u:gn()))).next((p=>(YA(i,PR(e),p),{documents:p,ks:u})))))}function YA(s,e,n){let i=s.Ms.get(e)||Gt.min();n.forEach(((l,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)})),s.Ms.set(e,i)}class Ox{constructor(){this.activeTargetIds=zR()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class QA{constructor(){this.vo=new Ox,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,i){}addLocalQueryTarget(e,n=!0){return n&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,n,i){this.Fo[e]=n}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Ox,Promise.resolve()}handleUserChange(e,n,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class XA{Mo(e){}shutdown(){}}const Vx="ConnectivityMonitor";class Bx{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){it(Vx,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){it(Vx,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let nd=null;function xg(){return nd===null?nd=(function(){return 268435456+Math.round(2147483648*Math.random())})():nd++,"0x"+nd.toString(16)}const Rp="RestConnection",JA={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class ZA{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.qo=n+"://"+e.host,this.Uo=`projects/${i}/databases/${l}`,this.$o=this.databaseId.database===Dd?`project_id=${i}`:`project_id=${i}&database_id=${l}`}Wo(e,n,i,l,u){const h=xg(),p=this.Qo(e,n.toUriEncodedString());it(Rp,`Sending RPC '${e}' ${h}:`,p,i);const g={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(g,l,u);const{host:y}=new URL(p),w=io(y);return this.zo(e,p,g,i,w).then((k=>(it(Rp,`Received RPC '${e}' ${h}: `,k),k)),(k=>{throw Ul(Rp,`RPC '${e}' ${h} failed with error: `,k,"url: ",p,"request:",i),k}))}jo(e,n,i,l,u,h){return this.Wo(e,n,i,l,u)}Go(e,n,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ql})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((l,u)=>e[u]=l)),i&&i.headers.forEach(((l,u)=>e[u]=l))}Qo(e,n){const i=JA[e];let l=`${this.qo}/v1/${n}:${i}`;return this.databaseInfo.apiKey&&(l=`${l}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),l}terminate(){}}class eI{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const Ys="WebChannelConnection",zc=(s,e,n)=>{s.listen(e,(i=>{try{n(i)}catch(l){setTimeout((()=>{throw l}),0)}}))};class Vl extends ZA{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Vl.c_){const e=Ow();zc(e,Lw.STAT_EVENT,(n=>{n.stat===lg.PROXY?it(Ys,"STAT_EVENT: detected buffering proxy"):n.stat===lg.NOPROXY&&it(Ys,"STAT_EVENT: detected no buffering proxy")})),Vl.c_=!0}}zo(e,n,i,l,u){const h=xg();return new Promise(((p,g)=>{const y=new Dw;y.setWithCredentials(!0),y.listenOnce(Pw.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case yd.NO_ERROR:const k=y.getResponseJson();it(Ys,`XHR for RPC '${e}' ${h} received:`,JSON.stringify(k)),p(k);break;case yd.TIMEOUT:it(Ys,`RPC '${e}' ${h} timed out`),g(new tt(_e.DEADLINE_EXCEEDED,"Request time out"));break;case yd.HTTP_ERROR:const E=y.getStatus();if(it(Ys,`RPC '${e}' ${h} failed with status:`,E,"response text:",y.getResponseText()),E>0){let O=y.getResponseJson();Array.isArray(O)&&(O=O[0]);const G=O?.error;if(G&&G.status&&G.message){const U=(function(ne){const J=ne.toLowerCase().replace(/_/g,"-");return Object.values(_e).indexOf(J)>=0?J:_e.UNKNOWN})(G.status);g(new tt(U,G.message))}else g(new tt(_e.UNKNOWN,"Server responded with status "+y.getStatus()))}else g(new tt(_e.UNAVAILABLE,"Connection failed."));break;default:Vt(9055,{l_:e,streamId:h,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{it(Ys,`RPC '${e}' ${h} completed.`)}}));const w=JSON.stringify(l);it(Ys,`RPC '${e}' ${h} sending request:`,l),y.send(n,"POST",w,i,15)}))}T_(e,n,i){const l=xg(),u=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],h=this.createWebChannelTransport(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Go(p.initMessageHeaders,n,i),p.encodeInitMessageHeaders=!0;const y=u.join("");it(Ys,`Creating RPC '${e}' stream ${l}: ${y}`,p);const w=h.createWebChannel(y,p);this.I_(w);let k=!1,E=!1;const O=new eI({Ho:G=>{E?it(Ys,`Not sending because RPC '${e}' stream ${l} is closed:`,G):(k||(it(Ys,`Opening RPC '${e}' stream ${l} transport.`),w.open(),k=!0),it(Ys,`RPC '${e}' stream ${l} sending:`,G),w.send(G))},Jo:()=>w.close()});return zc(w,Kc.EventType.OPEN,(()=>{E||(it(Ys,`RPC '${e}' stream ${l} transport opened.`),O.i_())})),zc(w,Kc.EventType.CLOSE,(()=>{E||(E=!0,it(Ys,`RPC '${e}' stream ${l} transport closed`),O.o_(),this.E_(w))})),zc(w,Kc.EventType.ERROR,(G=>{E||(E=!0,Ul(Ys,`RPC '${e}' stream ${l} transport errored. Name:`,G.name,"Message:",G.message),O.o_(new tt(_e.UNAVAILABLE,"The operation could not be completed")))})),zc(w,Kc.EventType.MESSAGE,(G=>{if(!E){const U=G.data[0];On(!!U,16349);const V=U,ne=V?.error||V[0]?.error;if(ne){it(Ys,`RPC '${e}' stream ${l} received error:`,ne);const J=ne.status;let fe=(function(Ve){const I=Ns[Ve];if(I!==void 0)return x_(I)})(J),Te=ne.message;fe===void 0&&(fe=_e.INTERNAL,Te="Unknown error status: "+J+" with message "+ne.message),E=!0,O.o_(new tt(fe,Te)),w.close()}else it(Ys,`RPC '${e}' stream ${l} received:`,U),O.__(U)}})),Vl.u_(),setTimeout((()=>{O.s_()}),0),O}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((n=>n===e))}Go(e,n,i){super.Go(e,n,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return Vw()}}function tI(s){return new Vl(s)}function Ap(){return typeof document<"u"?document:null}function hf(s){return new aA(s,!0)}Vl.c_=!1;class P_{constructor(e,n,i=1e3,l=1.5,u=6e4){this.Ci=e,this.timerId=n,this.R_=i,this.A_=l,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const n=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),l=Math.max(0,n-i);l>0&&it("ExponentialBackoff",`Backing off for ${l} ms (base delay: ${this.d_} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,l,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const Ux="PersistentStream";class L_{constructor(e,n,i,l,u,h,p,g){this.Ci=e,this.b_=i,this.S_=l,this.connection=u,this.authCredentialsProvider=h,this.appCheckCredentialsProvider=p,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new P_(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===_e.RESOURCE_EXHAUSTED?(li(n.toString()),li("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===_e.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(n)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,l])=>{this.D_===n&&this.G_(i,l)}),(i=>{e((()=>{const l=new tt(_e.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(l)}))}))}G_(e,n){const i=this.Q_(this.D_);this.stream=this.j_(e,n),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((l=>{i((()=>this.z_(l)))})),this.stream.onMessage((l=>{i((()=>++this.F_==1?this.H_(l):this.onNext(l)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return it(Ux,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return n=>{this.Ci.enqueueAndForget((()=>this.D_===e?n():(it(Ux,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class nI extends L_{constructor(e,n,i,l,u,h){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,i,l,h),this.serializer=u}j_(e,n){return this.connection.T_("Listen",e,n)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=lA(this.serializer,e),i=(function(u){if(!("targetChange"in u))return Gt.min();const h=u.targetChange;return h.targetIds&&h.targetIds.length?Gt.min():h.readTime?Ca(h.readTime):Gt.min()})(e);return this.listener.J_(n,i)}Z_(e){const n={};n.database=vg(this.serializer),n.addTarget=(function(u,h){let p;const g=h.target;if(p=fg(g)?{documents:hA(u,g)}:{query:dA(u,g).ft},p.targetId=h.targetId,h.resumeToken.approximateByteSize()>0){p.resumeToken=k_(u,h.resumeToken);const y=pg(u,h.expectedCount);y!==null&&(p.expectedCount=y)}else if(h.snapshotVersion.compareTo(Gt.min())>0){p.readTime=Vd(u,h.snapshotVersion.toTimestamp());const y=pg(u,h.expectedCount);y!==null&&(p.expectedCount=y)}return p})(this.serializer,e);const i=mA(this.serializer,e);i&&(n.labels=i),this.K_(n)}X_(e){const n={};n.database=vg(this.serializer),n.removeTarget=e,this.K_(n)}}class sI extends L_{constructor(e,n,i,l,u,h){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,i,l,h),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}H_(e){return On(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,On(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){On(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=uA(e.writeResults,e.commitTime),i=Ca(e.commitTime);return this.listener.na(i,n)}ra(){const e={};e.database=vg(this.serializer),this.K_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((i=>cA(this.serializer,i)))};this.K_(n)}}class rI{}class aI extends rI{constructor(e,n,i,l){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=i,this.serializer=l,this.ia=!1}sa(){if(this.ia)throw new tt(_e.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,n,i,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,h])=>this.connection.Wo(e,gg(n,i),l,u,h))).catch((u=>{throw u.name==="FirebaseError"?(u.code===_e.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new tt(_e.UNKNOWN,u.toString())}))}jo(e,n,i,l,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([h,p])=>this.connection.jo(e,gg(n,i),l,h,p,u))).catch((h=>{throw h.name==="FirebaseError"?(h.code===_e.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),h):new tt(_e.UNKNOWN,h.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function iI(s,e,n,i){return new aI(s,e,n,i)}class oI{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(li(n),this.aa=!1):it("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const qo="RemoteStore";class lI{constructor(e,n,i,l,u){this.localStore=e,this.datastore=n,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((h=>{i.enqueueAndForget((async()=>{Ko(this)&&(it(qo,"Restarting streams for network reachability change."),await(async function(g){const y=Xt(g);y.Ea.add(4),await Ru(y),y.Va.set("Unknown"),y.Ea.delete(4),await df(y)})(this))}))})),this.Va=new oI(i,l)}}async function df(s){if(Ko(s))for(const e of s.Ra)await e(!0)}async function Ru(s){for(const e of s.Ra)await e(!1)}function O_(s,e){const n=Xt(s);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),fy(n)?dy(n):ec(n).O_()&&hy(n,e))}function uy(s,e){const n=Xt(s),i=ec(n);n.Ia.delete(e),i.O_()&&V_(n,e),n.Ia.size===0&&(i.O_()?i.L_():Ko(n)&&n.Va.set("Unknown"))}function hy(s,e){if(s.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Gt.min())>0){const n=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}ec(s).Z_(e)}function V_(s,e){s.da.$e(e),ec(s).X_(e)}function dy(s){s.da=new tA({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),ec(s).start(),s.Va.ua()}function fy(s){return Ko(s)&&!ec(s).x_()&&s.Ia.size>0}function Ko(s){return Xt(s).Ea.size===0}function B_(s){s.da=void 0}async function cI(s){s.Va.set("Online")}async function uI(s){s.Ia.forEach(((e,n)=>{hy(s,e)}))}async function hI(s,e){B_(s),fy(s)?(s.Va.ha(e),dy(s)):s.Va.set("Unknown")}async function dI(s,e,n){if(s.Va.set("Online"),e instanceof __&&e.state===2&&e.cause)try{await(async function(l,u){const h=u.cause;for(const p of u.targetIds)l.Ia.has(p)&&(await l.remoteSyncer.rejectListen(p,h),l.Ia.delete(p),l.da.removeTarget(p))})(s,e)}catch(i){it(qo,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Ud(s,i)}else if(e instanceof wd?s.da.Xe(e):e instanceof w_?s.da.st(e):s.da.tt(e),!n.isEqual(Gt.min()))try{const i=await D_(s.localStore);n.compareTo(i)>=0&&await(function(u,h){const p=u.da.Tt(h);return p.targetChanges.forEach(((g,y)=>{if(g.resumeToken.approximateByteSize()>0){const w=u.Ia.get(y);w&&u.Ia.set(y,w.withResumeToken(g.resumeToken,h))}})),p.targetMismatches.forEach(((g,y)=>{const w=u.Ia.get(g);if(!w)return;u.Ia.set(g,w.withResumeToken(Hs.EMPTY_BYTE_STRING,w.snapshotVersion)),V_(u,g);const k=new Wi(w.target,g,y,w.sequenceNumber);hy(u,k)})),u.remoteSyncer.applyRemoteEvent(p)})(s,n)}catch(i){it(qo,"Failed to raise snapshot:",i),await Ud(s,i)}}async function Ud(s,e,n){if(!Jl(e))throw e;s.Ea.add(1),await Ru(s),s.Va.set("Offline"),n||(n=()=>D_(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{it(qo,"Retrying IndexedDB access"),await n(),s.Ea.delete(1),await df(s)}))}function U_(s,e){return e().catch((n=>Ud(s,n,e)))}async function ff(s){const e=Xt(s),n=ro(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Xg;for(;fI(e);)try{const l=await GA(e.localStore,i);if(l===null){e.Ta.length===0&&n.L_();break}i=l.batchId,mI(e,l)}catch(l){await Ud(e,l)}z_(e)&&F_(e)}function fI(s){return Ko(s)&&s.Ta.length<10}function mI(s,e){s.Ta.push(e);const n=ro(s);n.O_()&&n.Y_&&n.ea(e.mutations)}function z_(s){return Ko(s)&&!ro(s).x_()&&s.Ta.length>0}function F_(s){ro(s).start()}async function pI(s){ro(s).ra()}async function gI(s){const e=ro(s);for(const n of s.Ta)e.ea(n.mutations)}async function yI(s,e,n){const i=s.Ta.shift(),l=sy.from(i,e,n);await U_(s,(()=>s.remoteSyncer.applySuccessfulWrite(l))),await ff(s)}async function vI(s,e){e&&ro(s).Y_&&await(async function(i,l){if((function(h){return JR(h)&&h!==_e.ABORTED})(l.code)){const u=i.Ta.shift();ro(i).B_(),await U_(i,(()=>i.remoteSyncer.rejectFailedWrite(u.batchId,l))),await ff(i)}})(s,e),z_(s)&&F_(s)}async function zx(s,e){const n=Xt(s);n.asyncQueue.verifyOperationInProgress(),it(qo,"RemoteStore received new credentials");const i=Ko(n);n.Ea.add(3),await Ru(n),i&&n.Va.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await df(n)}async function bI(s,e){const n=Xt(s);e?(n.Ea.delete(2),await df(n)):e||(n.Ea.add(2),await Ru(n),n.Va.set("Unknown"))}function ec(s){return s.ma||(s.ma=(function(n,i,l){const u=Xt(n);return u.sa(),new nI(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(s.datastore,s.asyncQueue,{Zo:cI.bind(null,s),Yo:uI.bind(null,s),t_:hI.bind(null,s),J_:dI.bind(null,s)}),s.Ra.push((async e=>{e?(s.ma.B_(),fy(s)?dy(s):s.Va.set("Unknown")):(await s.ma.stop(),B_(s))}))),s.ma}function ro(s){return s.fa||(s.fa=(function(n,i,l){const u=Xt(n);return u.sa(),new sI(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(s.datastore,s.asyncQueue,{Zo:()=>Promise.resolve(),Yo:pI.bind(null,s),t_:vI.bind(null,s),ta:gI.bind(null,s),na:yI.bind(null,s)}),s.Ra.push((async e=>{e?(s.fa.B_(),await ff(s)):(await s.fa.stop(),s.Ta.length>0&&(it(qo,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}class my{constructor(e,n,i,l,u){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=i,this.op=l,this.removalCallback=u,this.deferred=new si,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((h=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,i,l,u){const h=Date.now()+i,p=new my(e,n,h,l,u);return p.start(i),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new tt(_e.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function py(s,e){if(li("AsyncQueue",`${e}: ${s}`),Jl(s))return new tt(_e.UNAVAILABLE,`${e}: ${s}`);throw s}class Bl{static emptySet(e){return new Bl(e.comparator)}constructor(e){this.comparator=e?(n,i)=>e(n,i)||jt.comparator(n.key,i.key):(n,i)=>jt.comparator(n.key,i.key),this.keyedMap=Yc(),this.sortedSet=new hs(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,i)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Bl)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;n.hasNext();){const l=n.getNext().key,u=i.getNext().key;if(!l.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const i=new Bl;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=n,i}}class Fx{constructor(){this.ga=new hs(jt.comparator)}track(e){const n=e.doc.key,i=this.ga.get(n);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(n,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(n,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(n):e.type===1&&i.type===2?this.ga=this.ga.insert(n,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Vt(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,i)=>{e.push(i)})),e}}class $l{constructor(e,n,i,l,u,h,p,g,y){this.query=e,this.docs=n,this.oldDocs=i,this.docChanges=l,this.mutatedKeys=u,this.fromCache=h,this.syncStateChanged=p,this.excludesMetadataChanges=g,this.hasCachedResults=y}static fromInitialDocuments(e,n,i,l,u){const h=[];return n.forEach((p=>{h.push({type:0,doc:p})})),new $l(e,n,Bl.emptySet(n),h,i,l,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&rf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,i=e.docChanges;if(n.length!==i.length)return!1;for(let l=0;l<n.length;l++)if(n[l].type!==i[l].type||!n[l].doc.isEqual(i[l].doc))return!1;return!0}}class xI{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class wI{constructor(){this.queries=qx(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,i){const l=Xt(n),u=l.queries;l.queries=qx(),u.forEach(((h,p)=>{for(const g of p.ba)g.onError(i)}))})(this,new tt(_e.ABORTED,"Firestore shutting down"))}}function qx(){return new Go((s=>i_(s)),rf)}async function gy(s,e){const n=Xt(s);let i=3;const l=e.query;let u=n.queries.get(l);u?!u.Sa()&&e.Da()&&(i=2):(u=new xI,i=e.Da()?0:1);try{switch(i){case 0:u.wa=await n.onListen(l,!0);break;case 1:u.wa=await n.onListen(l,!1);break;case 2:await n.onFirstRemoteStoreListen(l)}}catch(h){const p=py(h,`Initialization of query '${Al(e.query)}' failed`);return void e.onError(p)}n.queries.set(l,u),u.ba.push(e),e.va(n.onlineState),u.wa&&e.Fa(u.wa)&&vy(n)}async function yy(s,e){const n=Xt(s),i=e.query;let l=3;const u=n.queries.get(i);if(u){const h=u.ba.indexOf(e);h>=0&&(u.ba.splice(h,1),u.ba.length===0?l=e.Da()?0:1:!u.Sa()&&e.Da()&&(l=2))}switch(l){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function _I(s,e){const n=Xt(s);let i=!1;for(const l of e){const u=l.query,h=n.queries.get(u);if(h){for(const p of h.ba)p.Fa(l)&&(i=!0);h.wa=l}}i&&vy(n)}function kI(s,e,n){const i=Xt(s),l=i.queries.get(e);if(l)for(const u of l.ba)u.onError(n);i.queries.delete(e)}function vy(s){s.Ca.forEach((e=>{e.next()}))}var wg,Hx;(Hx=wg||(wg={})).Ma="default",Hx.Cache="cache";class by{constructor(e,n,i){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const l of e.docChanges)l.type!==3&&i.push(l);e=new $l(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const i=n!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=$l.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==wg.Cache}}class q_{constructor(e){this.key=e}}class H_{constructor(e){this.key=e}}class TI{constructor(e,n){this.query=e,this.Za=n,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=gn(),this.mutatedKeys=gn(),this.eu=o_(e),this.tu=new Bl(this.eu)}get nu(){return this.Za}ru(e,n){const i=n?n.iu:new Fx,l=n?n.tu:this.tu;let u=n?n.mutatedKeys:this.mutatedKeys,h=l,p=!1;const g=this.query.limitType==="F"&&l.size===this.query.limit?l.last():null,y=this.query.limitType==="L"&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal(((w,k)=>{const E=l.get(w),O=af(this.query,k)?k:null,G=!!E&&this.mutatedKeys.has(E.key),U=!!O&&(O.hasLocalMutations||this.mutatedKeys.has(O.key)&&O.hasCommittedMutations);let V=!1;E&&O?E.data.isEqual(O.data)?G!==U&&(i.track({type:3,doc:O}),V=!0):this.su(E,O)||(i.track({type:2,doc:O}),V=!0,(g&&this.eu(O,g)>0||y&&this.eu(O,y)<0)&&(p=!0)):!E&&O?(i.track({type:0,doc:O}),V=!0):E&&!O&&(i.track({type:1,doc:E}),V=!0,(g||y)&&(p=!0)),V&&(O?(h=h.add(O),u=U?u.add(w):u.delete(w)):(h=h.delete(w),u=u.delete(w)))})),this.query.limit!==null)for(;h.size>this.query.limit;){const w=this.query.limitType==="F"?h.last():h.first();h=h.delete(w.key),u=u.delete(w.key),i.track({type:1,doc:w})}return{tu:h,iu:i,Ss:p,mutatedKeys:u}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,i,l){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const h=e.iu.ya();h.sort(((w,k)=>(function(O,G){const U=V=>{switch(V){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Vt(20277,{Vt:V})}};return U(O)-U(G)})(w.type,k.type)||this.eu(w.doc,k.doc))),this.ou(i),l=l??!1;const p=n&&!l?this._u():[],g=this.Ya.size===0&&this.current&&!l?1:0,y=g!==this.Xa;return this.Xa=g,h.length!==0||y?{snapshot:new $l(this.query,e.tu,u,h,e.mutatedKeys,g===0,y,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Fx,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Za=this.Za.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Za=this.Za.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=gn(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const n=[];return e.forEach((i=>{this.Ya.has(i)||n.push(new H_(i))})),this.Ya.forEach((i=>{e.has(i)||n.push(new q_(i))})),n}cu(e){this.Za=e.ks,this.Ya=gn();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return $l.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const xy="SyncEngine";class jI{constructor(e,n,i){this.query=e,this.targetId=n,this.view=i}}class EI{constructor(e){this.key=e,this.hu=!1}}class SI{constructor(e,n,i,l,u,h){this.localStore=e,this.remoteStore=n,this.eventManager=i,this.sharedClientState=l,this.currentUser=u,this.maxConcurrentLimboResolutions=h,this.Pu={},this.Tu=new Go((p=>i_(p)),rf),this.Iu=new Map,this.Eu=new Set,this.Ru=new hs(jt.comparator),this.Au=new Map,this.Vu=new iy,this.du={},this.mu=new Map,this.fu=Hl.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function NI(s,e,n=!0){const i=Q_(s);let l;const u=i.Tu.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),l=u.view.lu()):l=await $_(i,e,n,!0),l}async function CI(s,e){const n=Q_(s);await $_(n,e,!0,!1)}async function $_(s,e,n,i){const l=await KA(s.localStore,Na(e)),u=l.targetId,h=s.sharedClientState.addLocalQueryTarget(u,n);let p;return i&&(p=await RI(s,e,u,h==="current",l.resumeToken)),s.isPrimaryClient&&n&&O_(s.remoteStore,l),p}async function RI(s,e,n,i,l){s.pu=(k,E,O)=>(async function(U,V,ne,J){let fe=V.view.ru(ne);fe.Ss&&(fe=await Lx(U.localStore,V.query,!1).then((({documents:I})=>V.view.ru(I,fe))));const Te=J&&J.targetChanges.get(V.targetId),$e=J&&J.targetMismatches.get(V.targetId)!=null,Ve=V.view.applyChanges(fe,U.isPrimaryClient,Te,$e);return Wx(U,V.targetId,Ve.au),Ve.snapshot})(s,k,E,O);const u=await Lx(s.localStore,e,!0),h=new TI(e,u.ks),p=h.ru(u.documents),g=Cu.createSynthesizedTargetChangeForCurrentChange(n,i&&s.onlineState!=="Offline",l),y=h.applyChanges(p,s.isPrimaryClient,g);Wx(s,n,y.au);const w=new jI(e,n,h);return s.Tu.set(e,w),s.Iu.has(n)?s.Iu.get(n).push(e):s.Iu.set(n,[e]),y.snapshot}async function AI(s,e,n){const i=Xt(s),l=i.Tu.get(e),u=i.Iu.get(l.targetId);if(u.length>1)return i.Iu.set(l.targetId,u.filter((h=>!rf(h,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(l.targetId),i.sharedClientState.isActiveQueryTarget(l.targetId)||await bg(i.localStore,l.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(l.targetId),n&&uy(i.remoteStore,l.targetId),_g(i,l.targetId)})).catch(Xl)):(_g(i,l.targetId),await bg(i.localStore,l.targetId,!0))}async function II(s,e){const n=Xt(s),i=n.Tu.get(e),l=n.Iu.get(i.targetId);n.isPrimaryClient&&l.length===1&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),uy(n.remoteStore,i.targetId))}async function MI(s,e,n){const i=UI(s);try{const l=await(function(h,p){const g=Xt(h),y=bt.now(),w=p.reduce(((O,G)=>O.add(G.key)),gn());let k,E;return g.persistence.runTransaction("Locally write mutations","readwrite",(O=>{let G=ci(),U=gn();return g.xs.getEntries(O,w).next((V=>{G=V,G.forEach(((ne,J)=>{J.isValidDocument()||(U=U.add(ne))}))})).next((()=>g.localDocuments.getOverlayedDocuments(O,G))).next((V=>{k=V;const ne=[];for(const J of p){const fe=GR(J,k.get(J.key).overlayedDocument);fe!=null&&ne.push(new co(J.key,fe,Jw(fe.value.mapValue),lr.exists(!0)))}return g.mutationQueue.addMutationBatch(O,y,ne,p)})).next((V=>{E=V;const ne=V.applyToLocalDocumentSet(k,U);return g.documentOverlayCache.saveOverlays(O,V.batchId,ne)}))})).then((()=>({batchId:E.batchId,changes:c_(k)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(l.batchId),(function(h,p,g){let y=h.du[h.currentUser.toKey()];y||(y=new hs(pn)),y=y.insert(p,g),h.du[h.currentUser.toKey()]=y})(i,l.batchId,n),await Au(i,l.changes),await ff(i.remoteStore)}catch(l){const u=py(l,"Failed to persist write");n.reject(u)}}async function W_(s,e){const n=Xt(s);try{const i=await $A(n.localStore,e);e.targetChanges.forEach(((l,u)=>{const h=n.Au.get(u);h&&(On(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size<=1,22616),l.addedDocuments.size>0?h.hu=!0:l.modifiedDocuments.size>0?On(h.hu,14607):l.removedDocuments.size>0&&(On(h.hu,42227),h.hu=!1))})),await Au(n,i,e)}catch(i){await Xl(i)}}function $x(s,e,n){const i=Xt(s);if(i.isPrimaryClient&&n===0||!i.isPrimaryClient&&n===1){const l=[];i.Tu.forEach(((u,h)=>{const p=h.view.va(e);p.snapshot&&l.push(p.snapshot)})),(function(h,p){const g=Xt(h);g.onlineState=p;let y=!1;g.queries.forEach(((w,k)=>{for(const E of k.ba)E.va(p)&&(y=!0)})),y&&vy(g)})(i.eventManager,e),l.length&&i.Pu.J_(l),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function DI(s,e,n){const i=Xt(s);i.sharedClientState.updateQueryState(e,"rejected",n);const l=i.Au.get(e),u=l&&l.key;if(u){let h=new hs(jt.comparator);h=h.insert(u,Xs.newNoDocument(u,Gt.min()));const p=gn().add(u),g=new uf(Gt.min(),new Map,new hs(pn),h,p);await W_(i,g),i.Ru=i.Ru.remove(u),i.Au.delete(e),wy(i)}else await bg(i.localStore,e,!1).then((()=>_g(i,e,n))).catch(Xl)}async function PI(s,e){const n=Xt(s),i=e.batch.batchId;try{const l=await HA(n.localStore,e);K_(n,i,null),G_(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await Au(n,l)}catch(l){await Xl(l)}}async function LI(s,e,n){const i=Xt(s);try{const l=await(function(h,p){const g=Xt(h);return g.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let w;return g.mutationQueue.lookupMutationBatch(y,p).next((k=>(On(k!==null,37113),w=k.keys(),g.mutationQueue.removeMutationBatch(y,k)))).next((()=>g.mutationQueue.performConsistencyCheck(y))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(y,w,p))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,w))).next((()=>g.localDocuments.getDocuments(y,w)))}))})(i.localStore,e);K_(i,e,n),G_(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await Au(i,l)}catch(l){await Xl(l)}}function G_(s,e){(s.mu.get(e)||[]).forEach((n=>{n.resolve()})),s.mu.delete(e)}function K_(s,e,n){const i=Xt(s);let l=i.du[i.currentUser.toKey()];if(l){const u=l.get(e);u&&(n?u.reject(n):u.resolve(),l=l.remove(e)),i.du[i.currentUser.toKey()]=l}}function _g(s,e,n=null){s.sharedClientState.removeLocalQueryTarget(e);for(const i of s.Iu.get(e))s.Tu.delete(i),n&&s.Pu.yu(i,n);s.Iu.delete(e),s.isPrimaryClient&&s.Vu.Gr(e).forEach((i=>{s.Vu.containsKey(i)||Y_(s,i)}))}function Y_(s,e){s.Eu.delete(e.path.canonicalString());const n=s.Ru.get(e);n!==null&&(uy(s.remoteStore,n),s.Ru=s.Ru.remove(e),s.Au.delete(n),wy(s))}function Wx(s,e,n){for(const i of n)i instanceof q_?(s.Vu.addReference(i.key,e),OI(s,i)):i instanceof H_?(it(xy,"Document no longer in limbo: "+i.key),s.Vu.removeReference(i.key,e),s.Vu.containsKey(i.key)||Y_(s,i.key)):Vt(19791,{wu:i})}function OI(s,e){const n=e.key,i=n.path.canonicalString();s.Ru.get(n)||s.Eu.has(i)||(it(xy,"New document in limbo: "+n),s.Eu.add(i),wy(s))}function wy(s){for(;s.Eu.size>0&&s.Ru.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const n=new jt(Xn.fromString(e)),i=s.fu.next();s.Au.set(i,new EI(n)),s.Ru=s.Ru.insert(n,i),O_(s.remoteStore,new Wi(Na(sf(n.path)),i,"TargetPurposeLimboResolution",ef.ce))}}async function Au(s,e,n){const i=Xt(s),l=[],u=[],h=[];i.Tu.isEmpty()||(i.Tu.forEach(((p,g)=>{h.push(i.pu(g,e,n).then((y=>{if((y||n)&&i.isPrimaryClient){const w=y?!y.fromCache:n?.targetChanges.get(g.targetId)?.current;i.sharedClientState.updateQueryState(g.targetId,w?"current":"not-current")}if(y){l.push(y);const w=ly.Es(g.targetId,y);u.push(w)}})))})),await Promise.all(h),i.Pu.J_(l),await(async function(g,y){const w=Xt(g);try{await w.persistence.runTransaction("notifyLocalViewChanges","readwrite",(k=>Ie.forEach(y,(E=>Ie.forEach(E.Ts,(O=>w.persistence.referenceDelegate.addReference(k,E.targetId,O))).next((()=>Ie.forEach(E.Is,(O=>w.persistence.referenceDelegate.removeReference(k,E.targetId,O)))))))))}catch(k){if(!Jl(k))throw k;it(cy,"Failed to update sequence numbers: "+k)}for(const k of y){const E=k.targetId;if(!k.fromCache){const O=w.vs.get(E),G=O.snapshotVersion,U=O.withLastLimboFreeSnapshotVersion(G);w.vs=w.vs.insert(E,U)}}})(i.localStore,u))}async function VI(s,e){const n=Xt(s);if(!n.currentUser.isEqual(e)){it(xy,"User change. New user:",e.toKey());const i=await M_(n.localStore,e);n.currentUser=e,(function(u,h){u.mu.forEach((p=>{p.forEach((g=>{g.reject(new tt(_e.CANCELLED,h))}))})),u.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Au(n,i.Ns)}}function BI(s,e){const n=Xt(s),i=n.Au.get(e);if(i&&i.hu)return gn().add(i.key);{let l=gn();const u=n.Iu.get(e);if(!u)return l;for(const h of u){const p=n.Tu.get(h);l=l.unionWith(p.view.nu)}return l}}function Q_(s){const e=Xt(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=W_.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=BI.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=DI.bind(null,e),e.Pu.J_=_I.bind(null,e.eventManager),e.Pu.yu=kI.bind(null,e.eventManager),e}function UI(s){const e=Xt(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=PI.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=LI.bind(null,e),e}class zd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=hf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return qA(this.persistence,new UA,e.initialUser,this.serializer)}Cu(e){return new I_(oy.Vi,this.serializer)}Du(e){return new QA}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}zd.provider={build:()=>new zd};class zI extends zd{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){On(this.persistence.referenceDelegate instanceof Bd,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new jA(i,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?vr.withCacheSize(this.cacheSizeBytes):vr.DEFAULT;return new I_((i=>Bd.Vi(i,n)),this.serializer)}}class kg{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>$x(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=VI.bind(null,this.syncEngine),await bI(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new wI})()}createDatastore(e){const n=hf(e.databaseInfo.databaseId),i=tI(e.databaseInfo);return iI(e.authCredentials,e.appCheckCredentials,i,n)}createRemoteStore(e){return(function(i,l,u,h,p){return new lI(i,l,u,h,p)})(this.localStore,this.datastore,e.asyncQueue,(n=>$x(this.syncEngine,n,0)),(function(){return Bx.v()?new Bx:new XA})())}createSyncEngine(e,n){return(function(l,u,h,p,g,y,w){const k=new SI(l,u,h,p,g,y);return w&&(k.gu=!0),k})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const i=Xt(n);it(qo,"RemoteStore shutting down."),i.Ea.add(5),await Ru(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}kg.provider={build:()=>new kg};class _y{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):li("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}const ao="FirestoreClient";class FI{constructor(e,n,i,l,u){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=i,this._databaseInfo=l,this.user=Qs.UNAUTHENTICATED,this.clientId=Qg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,(async h=>{it(ao,"Received user=",h.uid),await this.authCredentialListener(h),this.user=h})),this.appCheckCredentials.start(i,(h=>(it(ao,"Received new app check token=",h),this.appCheckCredentialListener(h,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new si;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const i=py(n,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Ip(s,e){s.asyncQueue.verifyOperationInProgress(),it(ao,"Initializing OfflineComponentProvider");const n=s.configuration;await e.initialize(n);let i=n.initialUser;s.setCredentialChangeListener((async l=>{i.isEqual(l)||(await M_(e.localStore,l),i=l)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function Gx(s,e){s.asyncQueue.verifyOperationInProgress();const n=await qI(s);it(ao,"Initializing OnlineComponentProvider"),await e.initialize(n,s.configuration),s.setCredentialChangeListener((i=>zx(e.remoteStore,i))),s.setAppCheckTokenChangeListener(((i,l)=>zx(e.remoteStore,l))),s._onlineComponents=e}async function qI(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){it(ao,"Using user provided OfflineComponentProvider");try{await Ip(s,s._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(l){return l.name==="FirebaseError"?l.code===_e.FAILED_PRECONDITION||l.code===_e.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11})(n))throw n;Ul("Error using user provided cache. Falling back to memory cache: "+n),await Ip(s,new zd)}}else it(ao,"Using default OfflineComponentProvider"),await Ip(s,new zI(void 0));return s._offlineComponents}async function X_(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(it(ao,"Using user provided OnlineComponentProvider"),await Gx(s,s._uninitializedComponentsProvider._online)):(it(ao,"Using default OnlineComponentProvider"),await Gx(s,new kg))),s._onlineComponents}function HI(s){return X_(s).then((e=>e.syncEngine))}async function Fd(s){const e=await X_(s),n=e.eventManager;return n.onListen=NI.bind(null,e.syncEngine),n.onUnlisten=AI.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=CI.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=II.bind(null,e.syncEngine),n}function $I(s,e,n,i){const l=new _y(i),u=new by(e,l,n);return s.asyncQueue.enqueueAndForget((async()=>gy(await Fd(s),u))),()=>{l.Nu(),s.asyncQueue.enqueueAndForget((async()=>yy(await Fd(s),u)))}}function WI(s,e,n={}){const i=new si;return s.asyncQueue.enqueueAndForget((async()=>(function(u,h,p,g,y){const w=new _y({next:E=>{w.Nu(),h.enqueueAndForget((()=>yy(u,k)));const O=E.docs.has(p);!O&&E.fromCache?y.reject(new tt(_e.UNAVAILABLE,"Failed to get document because the client is offline.")):O&&E.fromCache&&g&&g.source==="server"?y.reject(new tt(_e.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(E)},error:E=>y.reject(E)}),k=new by(sf(p.path),w,{includeMetadataChanges:!0,Ka:!0});return gy(u,k)})(await Fd(s),s.asyncQueue,e,n,i))),i.promise}function GI(s,e,n={}){const i=new si;return s.asyncQueue.enqueueAndForget((async()=>(function(u,h,p,g,y){const w=new _y({next:E=>{w.Nu(),h.enqueueAndForget((()=>yy(u,k))),E.fromCache&&g.source==="server"?y.reject(new tt(_e.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(E)},error:E=>y.reject(E)}),k=new by(p,w,{includeMetadataChanges:!0,Ka:!0});return gy(u,k)})(await Fd(s),s.asyncQueue,e,n,i))),i.promise}function KI(s,e){const n=new si;return s.asyncQueue.enqueueAndForget((async()=>MI(await HI(s),e,n))),n.promise}function J_(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}const YI="ComponentProvider",Kx=new Map;function QI(s,e,n,i,l){return new gR(s,e,n,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,J_(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator,i)}const Z_="firestore.googleapis.com",Yx=!0;class Qx{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new tt(_e.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Z_,this.ssl=Yx}else this.host=e.host,this.ssl=e.ssl??Yx;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=A_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<kA)throw new tt(_e.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}rR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=J_(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new tt(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new tt(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new tt(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,l){return i.timeoutSeconds===l.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class mf{constructor(e,n,i,l){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=i,this._app=l,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Qx({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new tt(_e.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new tt(_e.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Qx(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new K4;switch(i.type){case"firstParty":return new J4(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new tt(_e.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const i=Kx.get(n);i&&(it(YI,"Removing Datastore"),Kx.delete(n),i.terminate())})(this),Promise.resolve()}}function XI(s,e,n,i={}){s=or(s,mf);const l=io(e),u=s._getSettings(),h={...u,emulatorOptions:s._getEmulatorOptions()},p=`${e}:${n}`;l&&(Dg(`https://${p}`),Pg("Firestore",!0)),u.host!==Z_&&u.host!==p&&Ul("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...u,host:p,ssl:l,emulatorOptions:i};if(!Vo(g,h)&&(s._setSettings(g),i.mockUserToken)){let y,w;if(typeof i.mockUserToken=="string")y=i.mockUserToken,w=Qs.MOCK_USER;else{y=G2(i.mockUserToken,s._app?.options.projectId);const k=i.mockUserToken.sub||i.mockUserToken.user_id;if(!k)throw new tt(_e.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");w=new Qs(k)}s._authCredentials=new Y4(new Uw(y,w))}}class di{constructor(e,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new di(this.firestore,e,this._query)}}class ms{constructor(e,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ji(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ms(this.firestore,e,this._key)}toJSON(){return{type:ms._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,i){if(Su(n,ms._jsonSchema))return new ms(e,i||null,new jt(Xn.fromString(n.referencePath)))}}ms._jsonSchemaVersion="firestore/documentReference/1.0",ms._jsonSchema={type:Rs("string",ms._jsonSchemaVersion),referencePath:Rs("string")};class Ji extends di{constructor(e,n,i){super(e,n,sf(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ms(this.firestore,null,new jt(e))}withConverter(e){return new Ji(this.firestore,e,this._path)}}function Qt(s,e,...n){if(s=Qn(s),zw("collection","path",e),s instanceof mf){const i=Xn.fromString(e,...n);return cx(i),new Ji(s,null,i)}{if(!(s instanceof ms||s instanceof Ji))throw new tt(_e.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(Xn.fromString(e,...n));return cx(i),new Ji(s.firestore,null,i)}}function Ke(s,e,...n){if(s=Qn(s),arguments.length===1&&(e=Qg.newId()),zw("doc","path",e),s instanceof mf){const i=Xn.fromString(e,...n);return lx(i),new ms(s,null,new jt(i))}{if(!(s instanceof ms||s instanceof Ji))throw new tt(_e.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(Xn.fromString(e,...n));return lx(i),new ms(s.firestore,s instanceof Ji?s.converter:null,new jt(i))}}const Xx="AsyncQueue";class Jx{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new P_(this,"async_queue_retry"),this._c=()=>{const i=Ap();i&&it(Xx,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const n=Ap();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Ap();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new si;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Jl(e))throw e;it(Xx,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,li("INTERNAL UNHANDLED ERROR: ",Zx(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=n,n}enqueueAfterDelay(e,n,i){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const l=my.createAndSchedule(this,e,n,i,(u=>this.hc(u)));return this.tc.push(l),l}uc(){this.nc&&Vt(47125,{Pc:Zx(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,i)=>n.targetTimeMs-i.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function Zx(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}class Ia extends mf{constructor(e,n,i,l){super(e,n,i,l),this.type="firestore",this._queue=new Jx,this._persistenceKey=l?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Jx(e),this._firestoreClient=void 0,await e}}}function JI(s,e){const n=typeof s=="object"?s:Bg(),i=typeof s=="string"?s:Dd,l=Yd(n,"firestore").getImmediate({identifier:i});if(!l._initialized){const u=H2("firestore");u&&XI(l,...u)}return l}function Iu(s){if(s._terminated)throw new tt(_e.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||ZI(s),s._firestoreClient}function ZI(s){const e=s._freezeSettings(),n=QI(s._databaseId,s._app?.options.appId||"",s._persistenceKey,s._app?.options.apiKey,e);s._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new FI(s._authCredentials,s._appCheckCredentials,s._queue,n,s._componentsProvider&&(function(l){const u=l?._online.build();return{_offline:l?._offline.build(u),_online:u}})(s._componentsProvider))}class Gr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Gr(Hs.fromBase64String(e))}catch(n){throw new tt(_e.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Gr(Hs.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Gr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Su(e,Gr._jsonSchema))return Gr.fromBase64String(e.bytes)}}Gr._jsonSchemaVersion="firestore/bytes/1.0",Gr._jsonSchema={type:Rs("string",Gr._jsonSchemaVersion),bytes:Rs("string")};class pf{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new tt(_e.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new qs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Mu{constructor(e){this._methodName=e}}class Ra{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new tt(_e.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new tt(_e.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return pn(this._lat,e._lat)||pn(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ra._jsonSchemaVersion}}static fromJSON(e){if(Su(e,Ra._jsonSchema))return new Ra(e.latitude,e.longitude)}}Ra._jsonSchemaVersion="firestore/geoPoint/1.0",Ra._jsonSchema={type:Rs("string",Ra._jsonSchemaVersion),latitude:Rs("number"),longitude:Rs("number")};class ua{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,l){if(i.length!==l.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==l[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ua._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Su(e,ua._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new ua(e.vectorValues);throw new tt(_e.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ua._jsonSchemaVersion="firestore/vectorValue/1.0",ua._jsonSchema={type:Rs("string",ua._jsonSchemaVersion),vectorValues:Rs("object")};const eM=/^__.*__$/;class tM{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return this.fieldMask!==null?new co(e,this.data,this.fieldMask,n,this.fieldTransforms):new Nu(e,this.data,n,this.fieldTransforms)}}class ek{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return new co(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function tk(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Vt(40011,{dataSource:s})}}class ky{constructor(e,n,i,l,u,h){this.settings=e,this.databaseId=n,this.serializer=i,this.ignoreUndefinedProperties=l,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=h||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new ky({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const n=this.path?.child(e),i=this.contextWith({path:n,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const n=this.path?.child(e),i=this.contextWith({path:n,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return qd(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(tk(this.dataSource)&&eM.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class nM{constructor(e,n,i){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=i||hf(e)}createContext(e,n,i,l=!1){return new ky({dataSource:e,methodName:n,targetDoc:i,path:qs.emptyPath(),arrayElement:!1,hasConverter:l},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Du(s){const e=s._freezeSettings(),n=hf(s._databaseId);return new nM(s._databaseId,!!e.ignoreUndefinedProperties,n)}function Ty(s,e,n,i,l,u={}){const h=s.createContext(u.merge||u.mergeFields?2:0,e,n,l);Sy("Data must be an object, but it was:",h,i);const p=rk(i,h);let g,y;if(u.merge)g=new Dr(h.fieldMask),y=h.fieldTransforms;else if(u.mergeFields){const w=[];for(const k of u.mergeFields){const E=Ho(e,k,n);if(!h.contains(E))throw new tt(_e.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);ok(w,E)||w.push(E)}g=new Dr(w),y=h.fieldTransforms.filter((k=>g.covers(k.field)))}else g=null,y=h.fieldTransforms;return new tM(new br(p),g,y)}class gf extends Mu{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof gf}}class jy extends Mu{_toFieldTransform(e){return new y_(e.path,new pu)}isEqual(e){return e instanceof jy}}class Ey extends Mu{constructor(e,n){super(e),this.Vc=n}_toFieldTransform(e){const n=new vu(e.serializer,d_(e.serializer,this.Vc));return new y_(e.path,n)}isEqual(e){return e instanceof Ey&&this.Vc===e.Vc}}function nk(s,e,n,i){const l=s.createContext(1,e,n);Sy("Data must be an object, but it was:",l,i);const u=[],h=br.empty();lo(i,((g,y)=>{const w=ik(e,g,n);y=Qn(y);const k=l.childContextForFieldPath(w);if(y instanceof gf)u.push(w);else{const E=Pu(y,k);E!=null&&(u.push(w),h.set(w,E))}}));const p=new Dr(u);return new ek(h,p,l.fieldTransforms)}function sk(s,e,n,i,l,u){const h=s.createContext(1,e,n),p=[Ho(e,i,n)],g=[l];if(u.length%2!=0)throw new tt(_e.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<u.length;E+=2)p.push(Ho(e,u[E])),g.push(u[E+1]);const y=[],w=br.empty();for(let E=p.length-1;E>=0;--E)if(!ok(y,p[E])){const O=p[E];let G=g[E];G=Qn(G);const U=h.childContextForFieldPath(O);if(G instanceof gf)y.push(O);else{const V=Pu(G,U);V!=null&&(y.push(O),w.set(O,V))}}const k=new Dr(y);return new ek(w,k,h.fieldTransforms)}function sM(s,e,n,i=!1){return Pu(n,s.createContext(i?4:3,e))}function Pu(s,e){if(ak(s=Qn(s)))return Sy("Unsupported field value:",e,s),rk(s,e);if(s instanceof Mu)return(function(i,l){if(!tk(l.dataSource))throw l.createError(`${i._methodName}() can only be used with update() and set()`);if(!l.path)throw l.createError(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(l);u&&l.fieldTransforms.push(u)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,l){const u=[];let h=0;for(const p of i){let g=Pu(p,l.childContextForArray(h));g==null&&(g={nullValue:"NULL_VALUE"}),u.push(g),h++}return{arrayValue:{values:u}}})(s,e)}return(function(i,l){if((i=Qn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return d_(l.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=bt.fromDate(i);return{timestampValue:Vd(l.serializer,u)}}if(i instanceof bt){const u=new bt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Vd(l.serializer,u)}}if(i instanceof Ra)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Gr)return{bytesValue:k_(l.serializer,i._byteString)};if(i instanceof ms){const u=l.databaseId,h=i.firestore._databaseId;if(!h.isEqual(u))throw l.createError(`Document reference is for database ${h.projectId}/${h.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:ay(i.firestore._databaseId||l.databaseId,i._key.path)}}if(i instanceof ua)return(function(h,p){const g=h instanceof ua?h.toArray():h;return{mapValue:{fields:{[Qw]:{stringValue:Xw},[Pd]:{arrayValue:{values:g.map((w=>{if(typeof w!="number")throw p.createError("VectorValues must only contain numeric values.");return ny(p.serializer,w)}))}}}}}})(i,l);if(R_(i))return i._toProto(l.serializer);throw l.createError(`Unsupported field value: ${Zd(i)}`)})(s,e)}function rk(s,e){const n={};return Hw(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):lo(s,((i,l)=>{const u=Pu(l,e.childContextForField(i));u!=null&&(n[i]=u)})),{mapValue:{fields:n}}}function ak(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof bt||s instanceof Ra||s instanceof Gr||s instanceof ms||s instanceof Mu||s instanceof ua||R_(s))}function Sy(s,e,n){if(!ak(n)||!Fw(n)){const i=Zd(n);throw i==="an object"?e.createError(s+" a custom object"):e.createError(s+" "+i)}}function Ho(s,e,n){if((e=Qn(e))instanceof pf)return e._internalPath;if(typeof e=="string")return ik(s,e);throw qd("Field path arguments must be of type string or ",s,!1,void 0,n)}const rM=new RegExp("[~\\*/\\[\\]]");function ik(s,e,n){if(e.search(rM)>=0)throw qd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,n);try{return new pf(...e.split("."))._internalPath}catch{throw qd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,n)}}function qd(s,e,n,i,l){const u=i&&!i.isEmpty(),h=l!==void 0;let p=`Function ${e}() called with invalid data`;n&&(p+=" (via `toFirestore()`)"),p+=". ";let g="";return(u||h)&&(g+=" (found",u&&(g+=` in field ${i}`),h&&(g+=` in document ${l}`),g+=")"),new tt(_e.INVALID_ARGUMENT,p+s+g)}function ok(s,e){return s.some((n=>n.isEqual(e)))}class aM{convertValue(e,n="none"){switch(so(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ws(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(no(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Vt(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const i={};return lo(e,((l,u)=>{i[l]=this.convertValue(u,n)})),i}convertVectorValue(e){const n=e.fields?.[Pd].arrayValue?.values?.map((i=>ws(i.doubleValue)));return new ua(n)}convertGeoPoint(e){return new Ra(ws(e.latitude),ws(e.longitude))}convertArray(e,n){return(e.values||[]).map((i=>this.convertValue(i,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const i=nf(e);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp(hu(e));default:return null}}convertTimestamp(e){const n=to(e);return new bt(n.seconds,n.nanos)}convertDocumentKey(e,n){const i=Xn.fromString(e);On(C_(i),9688,{name:e});const l=new du(i.get(1),i.get(3)),u=new jt(i.popFirst(5));return l.isEqual(n)||li(`Document ${u} contains a document reference within a different database (${l.projectId}/${l.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),u}}class Ny extends aM{constructor(e){super(),this.firestore=e}convertBytes(e){return new Gr(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new ms(this.firestore,null,n)}}function Kr(){return new jy("serverTimestamp")}function Mo(s){return new Ey("increment",s)}const e2="@firebase/firestore",t2="4.10.0";function n2(s){return(function(n,i){if(typeof n!="object"||n===null)return!1;const l=n;for(const u of i)if(u in l&&typeof l[u]=="function")return!0;return!1})(s,["next","error","complete"])}class lk{constructor(e,n,i,l,u){this._firestore=e,this._userDataWriter=n,this._key=i,this._document=l,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new ms(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new iM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const n=this._document.data.field(Ho("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class iM extends lk{data(){return super.data()}}function ck(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new tt(_e.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Cy{}class Ry extends Cy{}function Pn(s,e,...n){let i=[];e instanceof Cy&&i.push(e),i=i.concat(n),(function(u){const h=u.filter((g=>g instanceof Ay)).length,p=u.filter((g=>g instanceof yf)).length;if(h>1||h>0&&p>0)throw new tt(_e.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const l of i)s=l._apply(s);return s}class yf extends Ry{constructor(e,n,i){super(),this._field=e,this._op=n,this._value=i,this.type="where"}static _create(e,n,i){return new yf(e,n,i)}_apply(e){const n=this._parse(e);return uk(e._query,n),new di(e.firestore,e.converter,mg(e._query,n))}_parse(e){const n=Du(e.firestore);return(function(u,h,p,g,y,w,k){let E;if(y.isKeyField()){if(w==="array-contains"||w==="array-contains-any")throw new tt(_e.INVALID_ARGUMENT,`Invalid Query. You can't perform '${w}' queries on documentId().`);if(w==="in"||w==="not-in"){r2(k,w);const G=[];for(const U of k)G.push(s2(g,u,U));E={arrayValue:{values:G}}}else E=s2(g,u,k)}else w!=="in"&&w!=="not-in"&&w!=="array-contains-any"||r2(k,w),E=sM(p,h,k,w==="in"||w==="not-in");return Cs.create(y,w,E)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function fn(s,e,n){const i=e,l=Ho("where",s);return yf._create(l,i,n)}class Ay extends Cy{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Ay(e,n)}_parse(e){const n=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return n.length===1?n[0]:da.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(l,u){let h=l;const p=u.getFlattenedFilters();for(const g of p)uk(h,g),h=mg(h,g)})(e._query,n),new di(e.firestore,e.converter,mg(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Iy extends Ry{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Iy(e,n)}_apply(e){const n=(function(l,u,h){if(l.startAt!==null)throw new tt(_e.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(l.endAt!==null)throw new tt(_e.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new mu(u,h)})(e._query,this._field,this._direction);return new di(e.firestore,e.converter,DR(e._query,n))}}function Hd(s,e="asc"){const n=e,i=Ho("orderBy",s);return Iy._create(i,n)}class My extends Ry{constructor(e,n,i){super(),this.type=e,this._limit=n,this._limitType=i}static _create(e,n,i){return new My(e,n,i)}_apply(e){return new di(e.firestore,e.converter,Od(e._query,this._limit,this._limitType))}}function $d(s){return aR("limit",s),My._create("limit",s,"F")}function s2(s,e,n){if(typeof(n=Qn(n))=="string"){if(n==="")throw new tt(_e.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!a_(e)&&n.indexOf("/")!==-1)throw new tt(_e.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=e.path.child(Xn.fromString(n));if(!jt.isDocumentKey(i))throw new tt(_e.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return yx(s,new jt(i))}if(n instanceof ms)return yx(s,n._key);throw new tt(_e.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Zd(n)}.`)}function r2(s,e){if(!Array.isArray(s)||s.length===0)throw new tt(_e.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function uk(s,e){const n=(function(l,u){for(const h of l)for(const p of h.getFlattenedFilters())if(u.indexOf(p.op)>=0)return p.op;return null})(s.filters,(function(l){switch(l){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new tt(_e.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new tt(_e.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function Dy(s,e,n){let i;return i=s?n&&(n.merge||n.mergeFields)?s.toFirestore(e,n):s.toFirestore(e):e,i}class Xc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Do extends lk{constructor(e,n,i,l,u,h){super(e,n,i,l,h),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new _d(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const i=this._document.data.field(Ho("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new tt(_e.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Do._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Do._jsonSchemaVersion="firestore/documentSnapshot/1.0",Do._jsonSchema={type:Rs("string",Do._jsonSchemaVersion),bundleSource:Rs("string","DocumentSnapshot"),bundleName:Rs("string"),bundle:Rs("string")};class _d extends Do{data(e={}){return super.data(e)}}class Po{constructor(e,n,i,l){this._firestore=e,this._userDataWriter=n,this._snapshot=l,this.metadata=new Xc(l.hasPendingWrites,l.fromCache),this.query=i}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((i=>{e.call(n,new _d(this._firestore,this._userDataWriter,i.key,i,new Xc(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new tt(_e.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(l,u){if(l._snapshot.oldDocs.isEmpty()){let h=0;return l._snapshot.docChanges.map((p=>{const g=new _d(l._firestore,l._userDataWriter,p.doc.key,p.doc,new Xc(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);return p.doc,{type:"added",doc:g,oldIndex:-1,newIndex:h++}}))}{let h=l._snapshot.oldDocs;return l._snapshot.docChanges.filter((p=>u||p.type!==3)).map((p=>{const g=new _d(l._firestore,l._userDataWriter,p.doc.key,p.doc,new Xc(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);let y=-1,w=-1;return p.type!==0&&(y=h.indexOf(p.doc.key),h=h.delete(p.doc.key)),p.type!==1&&(h=h.add(p.doc),w=h.indexOf(p.doc.key)),{type:oM(p.type),doc:g,oldIndex:y,newIndex:w}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new tt(_e.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Po._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Qg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],i=[],l=[];return this.docs.forEach((u=>{u._document!==null&&(n.push(u._document),i.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),l.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function oM(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Vt(61501,{type:s})}}Po._jsonSchemaVersion="firestore/querySnapshot/1.0",Po._jsonSchema={type:Rs("string",Po._jsonSchemaVersion),bundleSource:Rs("string","QuerySnapshot"),bundleName:Rs("string"),bundle:Rs("string")};class lM{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Du(e)}set(e,n,i){this._verifyNotCommitted();const l=Mp(e,this._firestore),u=Dy(l.converter,n,i),h=Ty(this._dataReader,"WriteBatch.set",l._key,u,l.converter!==null,i);return this._mutations.push(h.toMutation(l._key,lr.none())),this}update(e,n,i,...l){this._verifyNotCommitted();const u=Mp(e,this._firestore);let h;return h=typeof(n=Qn(n))=="string"||n instanceof pf?sk(this._dataReader,"WriteBatch.update",u._key,n,i,l):nk(this._dataReader,"WriteBatch.update",u._key,n),this._mutations.push(h.toMutation(u._key,lr.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Mp(e,this._firestore);return this._mutations=this._mutations.concat(new cf(n._key,lr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new tt(_e.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Mp(s,e){if((s=Qn(s)).firestore!==e)throw new tt(_e.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}function qn(s){s=or(s,ms);const e=or(s.firestore,Ia),n=Iu(e);return WI(n,s._key).then((i=>hk(e,s,i)))}function jn(s){s=or(s,di);const e=or(s.firestore,Ia),n=Iu(e),i=new Ny(e);return ck(s._query),GI(n,s._query).then((l=>new Po(e,i,s,l)))}function Gn(s,e,n){s=or(s,ms);const i=or(s.firestore,Ia),l=Dy(s.converter,e,n),u=Du(i);return Lu(i,[Ty(u,"setDoc",s._key,l,s.converter!==null,n).toMutation(s._key,lr.none())])}function Hi(s,e,n,...i){s=or(s,ms);const l=or(s.firestore,Ia),u=Du(l);let h;return h=typeof(e=Qn(e))=="string"||e instanceof pf?sk(u,"updateDoc",s._key,e,n,i):nk(u,"updateDoc",s._key,e),Lu(l,[h.toMutation(s._key,lr.exists(!0))])}function ar(s){return Lu(or(s.firestore,Ia),[new cf(s._key,lr.none())])}function ri(s,e){const n=or(s.firestore,Ia),i=Ke(s),l=Dy(s.converter,e),u=Du(s.firestore);return Lu(n,[Ty(u,"addDoc",i._key,l,s.converter!==null,{}).toMutation(i._key,lr.exists(!1))]).then((()=>i))}function cM(s,...e){s=Qn(s);let n={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||n2(e[i])||(n=e[i++]);const l={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(n2(e[i])){const y=e[i];e[i]=y.next?.bind(y),e[i+1]=y.error?.bind(y),e[i+2]=y.complete?.bind(y)}let u,h,p;if(s instanceof ms)h=or(s.firestore,Ia),p=sf(s._key.path),u={next:y=>{e[i]&&e[i](hk(h,s,y))},error:e[i+1],complete:e[i+2]};else{const y=or(s,di);h=or(y.firestore,Ia),p=y._query;const w=new Ny(h);u={next:k=>{e[i]&&e[i](new Po(h,w,y,k))},error:e[i+1],complete:e[i+2]},ck(s._query)}const g=Iu(h);return $I(g,p,l,u)}function Lu(s,e){const n=Iu(s);return KI(n,e)}function hk(s,e,n){const i=n.docs.get(e._key),l=new Ny(s);return new Do(s,l,e._key,i,new Xc(n.hasPendingWrites,n.fromCache),e.converter)}function a2(s){return s=or(s,Ia),Iu(s),new lM(s,(e=>Lu(s,e)))}(function(e,n=!0){G4(Wo),Bo(new Zi("firestore",((i,{instanceIdentifier:l,options:u})=>{const h=i.getProvider("app").getImmediate(),p=new Ia(new Q4(i.getProvider("auth-internal")),new Z4(h,i.getProvider("app-check-internal")),yR(h,l),h);return u={useFetchStreams:n,...u},p._setSettings(u),p}),"PUBLIC").setMultipleInstances(!0)),ja(e2,t2,e),ja(e2,t2,"esm2020")})();var uM="firebase",hM="12.8.0";ja(uM,hM,"app");const dk="firebasestorage.googleapis.com",fk="storageBucket",dM=120*1e3,fM=600*1e3;class gs extends Da{constructor(e,n,i=0){super(Dp(e),`Firebase Storage: ${n} (${Dp(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,gs.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Dp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ps;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ps||(ps={}));function Dp(s){return"storage/"+s}function Py(){const s="An unknown error occurred, please check the error payload for server response.";return new gs(ps.UNKNOWN,s)}function mM(s){return new gs(ps.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")}function pM(s){return new gs(ps.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function gM(){const s="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new gs(ps.UNAUTHENTICATED,s)}function yM(){return new gs(ps.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function vM(s){return new gs(ps.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")}function bM(){return new gs(ps.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function xM(){return new gs(ps.CANCELED,"User canceled the upload/download.")}function wM(s){return new gs(ps.INVALID_URL,"Invalid URL '"+s+"'.")}function _M(s){return new gs(ps.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function kM(){return new gs(ps.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+fk+"' property when initializing the app?")}function TM(){return new gs(ps.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function jM(){return new gs(ps.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function EM(s){return new gs(ps.UNSUPPORTED_ENVIRONMENT,`${s} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Tg(s){return new gs(ps.INVALID_ARGUMENT,s)}function mk(){return new gs(ps.APP_DELETED,"The Firebase app was deleted.")}function SM(s){return new gs(ps.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function ru(s,e){return new gs(ps.INVALID_FORMAT,"String does not match format '"+s+"': "+e)}function Fc(s){throw new gs(ps.INTERNAL_ERROR,"Internal error: "+s)}class ir{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let i;try{i=ir.makeFromUrl(e,n)}catch{return new ir(e,"")}if(i.path==="")return i;throw _M(e)}static makeFromUrl(e,n){let i=null;const l="([A-Za-z0-9.\\-_]+)";function u(Te){Te.path.charAt(Te.path.length-1)==="/"&&(Te.path_=Te.path_.slice(0,-1))}const h="(/(.*))?$",p=new RegExp("^gs://"+l+h,"i"),g={bucket:1,path:3};function y(Te){Te.path_=decodeURIComponent(Te.path)}const w="v[A-Za-z0-9_]+",k=n.replace(/[.]/g,"\\."),E="(/([^?#]*).*)?$",O=new RegExp(`^https?://${k}/${w}/b/${l}/o${E}`,"i"),G={bucket:1,path:3},U=n===dk?"(?:storage.googleapis.com|storage.cloud.google.com)":n,V="([^?#]*)",ne=new RegExp(`^https?://${U}/${l}/${V}`,"i"),fe=[{regex:p,indices:g,postModify:u},{regex:O,indices:G,postModify:y},{regex:ne,indices:{bucket:1,path:2},postModify:y}];for(let Te=0;Te<fe.length;Te++){const $e=fe[Te],Ve=$e.regex.exec(e);if(Ve){const I=Ve[$e.indices.bucket];let j=Ve[$e.indices.path];j||(j=""),i=new ir(I,j),$e.postModify(i);break}}if(i==null)throw wM(e);return i}}class NM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function CM(s,e,n){let i=1,l=null,u=null,h=!1,p=0;function g(){return p===2}let y=!1;function w(...V){y||(y=!0,e.apply(null,V))}function k(V){l=setTimeout(()=>{l=null,s(O,g())},V)}function E(){u&&clearTimeout(u)}function O(V,...ne){if(y){E();return}if(V){E(),w.call(null,V,...ne);return}if(g()||h){E(),w.call(null,V,...ne);return}i<64&&(i*=2);let fe;p===1?(p=2,fe=0):fe=(i+Math.random())*1e3,k(fe)}let G=!1;function U(V){G||(G=!0,E(),!y&&(l!==null?(V||(p=2),clearTimeout(l),k(0)):V||(p=1)))}return k(0),u=setTimeout(()=>{h=!0,U(!0)},n),U}function RM(s){s(!1)}function AM(s){return s!==void 0}function IM(s){return typeof s=="object"&&!Array.isArray(s)}function Ly(s){return typeof s=="string"||s instanceof String}function i2(s){return Oy()&&s instanceof Blob}function Oy(){return typeof Blob<"u"}function jg(s,e,n,i){if(i<e)throw Tg(`Invalid value for '${s}'. Expected ${e} or greater.`);if(i>n)throw Tg(`Invalid value for '${s}'. Expected ${n} or less.`)}function vf(s,e,n){let i=e;return n==null&&(i=`https://${e}`),`${n}://${i}/v0${s}`}function pk(s){const e=encodeURIComponent;let n="?";for(const i in s)if(s.hasOwnProperty(i)){const l=e(i)+"="+e(s[i]);n=n+l+"&"}return n=n.slice(0,-1),n}var Lo;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(Lo||(Lo={}));function MM(s,e){const n=s>=500&&s<600,l=[408,429].indexOf(s)!==-1,u=e.indexOf(s)!==-1;return n||l||u}class DM{constructor(e,n,i,l,u,h,p,g,y,w,k,E=!0,O=!1){this.url_=e,this.method_=n,this.headers_=i,this.body_=l,this.successCodes_=u,this.additionalRetryCodes_=h,this.callback_=p,this.errorCallback_=g,this.timeout_=y,this.progressCallback_=w,this.connectionFactory_=k,this.retry=E,this.isUsingEmulator=O,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((G,U)=>{this.resolve_=G,this.reject_=U,this.start_()})}start_(){const e=(i,l)=>{if(l){i(!1,new sd(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const h=p=>{const g=p.loaded,y=p.lengthComputable?p.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,y)};this.progressCallback_!==null&&u.addUploadProgressListener(h),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(h),this.pendingConnection_=null;const p=u.getErrorCode()===Lo.NO_ERROR,g=u.getStatus();if(!p||MM(g,this.additionalRetryCodes_)&&this.retry){const w=u.getErrorCode()===Lo.ABORT;i(!1,new sd(!1,null,w));return}const y=this.successCodes_.indexOf(g)!==-1;i(!0,new sd(y,u))})},n=(i,l)=>{const u=this.resolve_,h=this.reject_,p=l.connection;if(l.wasSuccessCode)try{const g=this.callback_(p,p.getResponse());AM(g)?u(g):u()}catch(g){h(g)}else if(p!==null){const g=Py();g.serverResponse=p.getErrorText(),this.errorCallback_?h(this.errorCallback_(p,g)):h(g)}else if(l.canceled){const g=this.appDelete_?mk():xM();h(g)}else{const g=bM();h(g)}};this.canceled_?n(!1,new sd(!1,null,!0)):this.backoffId_=CM(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&RM(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class sd{constructor(e,n,i){this.wasSuccessCode=e,this.connection=n,this.canceled=!!i}}function PM(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function LM(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function OM(s,e){e&&(s["X-Firebase-GMPID"]=e)}function VM(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function BM(s,e,n,i,l,u,h=!0,p=!1){const g=pk(s.urlParams),y=s.url+g,w=Object.assign({},s.headers);return OM(w,e),PM(w,n),LM(w,u),VM(w,i),new DM(y,s.method,w,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,l,h,p)}function UM(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function zM(...s){const e=UM();if(e!==void 0){const n=new e;for(let i=0;i<s.length;i++)n.append(s[i]);return n.getBlob()}else{if(Oy())return new Blob(s);throw new gs(ps.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function FM(s,e,n){return s.webkitSlice?s.webkitSlice(e,n):s.mozSlice?s.mozSlice(e,n):s.slice?s.slice(e,n):null}function qM(s){if(typeof atob>"u")throw EM("base-64");return atob(s)}const Ta={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Pp{constructor(e,n){this.data=e,this.contentType=n||null}}function HM(s,e){switch(s){case Ta.RAW:return new Pp(gk(e));case Ta.BASE64:case Ta.BASE64URL:return new Pp(yk(s,e));case Ta.DATA_URL:return new Pp(WM(e),GM(e))}throw Py()}function gk(s){const e=[];for(let n=0;n<s.length;n++){let i=s.charCodeAt(n);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(n<s.length-1&&(s.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const u=i,h=s.charCodeAt(++n);i=65536|(u&1023)<<10|h&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function $M(s){let e;try{e=decodeURIComponent(s)}catch{throw ru(Ta.DATA_URL,"Malformed data URL.")}return gk(e)}function yk(s,e){switch(s){case Ta.BASE64:{const l=e.indexOf("-")!==-1,u=e.indexOf("_")!==-1;if(l||u)throw ru(s,"Invalid character '"+(l?"-":"_")+"' found: is it base64url encoded?");break}case Ta.BASE64URL:{const l=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(l||u)throw ru(s,"Invalid character '"+(l?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=qM(e)}catch(l){throw l.message.includes("polyfill")?l:ru(s,"Invalid character found")}const i=new Uint8Array(n.length);for(let l=0;l<n.length;l++)i[l]=n.charCodeAt(l);return i}class vk{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw ru(Ta.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=n[1]||null;i!=null&&(this.base64=KM(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function WM(s){const e=new vk(s);return e.base64?yk(Ta.BASE64,e.rest):$M(e.rest)}function GM(s){return new vk(s).contentType}function KM(s,e){return s.length>=e.length?s.substring(s.length-e.length)===e:!1}class $i{constructor(e,n){let i=0,l="";i2(e)?(this.data_=e,i=e.size,l=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=l}size(){return this.size_}type(){return this.type_}slice(e,n){if(i2(this.data_)){const i=this.data_,l=FM(i,e,n);return l===null?null:new $i(l)}else{const i=new Uint8Array(this.data_.buffer,e,n-e);return new $i(i,!0)}}static getBlob(...e){if(Oy()){const n=e.map(i=>i instanceof $i?i.data_:i);return new $i(zM.apply(null,n))}else{const n=e.map(h=>Ly(h)?HM(Ta.RAW,h).data:h.data_);let i=0;n.forEach(h=>{i+=h.byteLength});const l=new Uint8Array(i);let u=0;return n.forEach(h=>{for(let p=0;p<h.length;p++)l[u++]=h[p]}),new $i(l,!0)}}uploadData(){return this.data_}}function Vy(s){let e;try{e=JSON.parse(s)}catch{return null}return IM(e)?e:null}function YM(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function QM(s,e){const n=e.split("/").filter(i=>i.length>0).join("/");return s.length===0?n:s+"/"+n}function bk(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}function XM(s,e){return e}class rr{constructor(e,n,i,l){this.server=e,this.local=n||e,this.writable=!!i,this.xform=l||XM}}let rd=null;function JM(s){return!Ly(s)||s.length<2?s:bk(s)}function xk(){if(rd)return rd;const s=[];s.push(new rr("bucket")),s.push(new rr("generation")),s.push(new rr("metageneration")),s.push(new rr("name","fullPath",!0));function e(u,h){return JM(h)}const n=new rr("name");n.xform=e,s.push(n);function i(u,h){return h!==void 0?Number(h):h}const l=new rr("size");return l.xform=i,s.push(l),s.push(new rr("timeCreated")),s.push(new rr("updated")),s.push(new rr("md5Hash",null,!0)),s.push(new rr("cacheControl",null,!0)),s.push(new rr("contentDisposition",null,!0)),s.push(new rr("contentEncoding",null,!0)),s.push(new rr("contentLanguage",null,!0)),s.push(new rr("contentType",null,!0)),s.push(new rr("metadata","customMetadata",!0)),rd=s,rd}function ZM(s,e){function n(){const i=s.bucket,l=s.fullPath,u=new ir(i,l);return e._makeStorageReference(u)}Object.defineProperty(s,"ref",{get:n})}function e3(s,e,n){const i={};i.type="file";const l=n.length;for(let u=0;u<l;u++){const h=n[u];i[h.local]=h.xform(i,e[h.server])}return ZM(i,s),i}function wk(s,e,n){const i=Vy(e);return i===null?null:e3(s,i,n)}function t3(s,e,n,i){const l=Vy(e);if(l===null||!Ly(l.downloadTokens))return null;const u=l.downloadTokens;if(u.length===0)return null;const h=encodeURIComponent;return u.split(",").map(y=>{const w=s.bucket,k=s.fullPath,E="/b/"+h(w)+"/o/"+h(k),O=vf(E,n,i),G=pk({alt:"media",token:y});return O+G})[0]}function n3(s,e){const n={},i=e.length;for(let l=0;l<i;l++){const u=e[l];u.writable&&(n[u.server]=s[u.local])}return JSON.stringify(n)}const o2="prefixes",l2="items";function s3(s,e,n){const i={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[o2])for(const l of n[o2]){const u=l.replace(/\/$/,""),h=s._makeStorageReference(new ir(e,u));i.prefixes.push(h)}if(n[l2])for(const l of n[l2]){const u=s._makeStorageReference(new ir(e,l.name));i.items.push(u)}return i}function r3(s,e,n){const i=Vy(n);return i===null?null:s3(s,e,i)}class By{constructor(e,n,i,l){this.url=e,this.method=n,this.handler=i,this.timeout=l,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Uy(s){if(!s)throw Py()}function a3(s,e){function n(i,l){const u=wk(s,l,e);return Uy(u!==null),u}return n}function i3(s,e){function n(i,l){const u=r3(s,e,l);return Uy(u!==null),u}return n}function o3(s,e){function n(i,l){const u=wk(s,l,e);return Uy(u!==null),t3(u,l,s.host,s._protocol)}return n}function zy(s){function e(n,i){let l;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?l=yM():l=gM():n.getStatus()===402?l=pM(s.bucket):n.getStatus()===403?l=vM(s.path):l=i,l.status=n.getStatus(),l.serverResponse=i.serverResponse,l}return e}function l3(s){const e=zy(s);function n(i,l){let u=e(i,l);return i.getStatus()===404&&(u=mM(s.path)),u.serverResponse=l.serverResponse,u}return n}function c3(s,e,n,i,l){const u={};e.isRoot?u.prefix="":u.prefix=e.path+"/",n.length>0&&(u.delimiter=n),i&&(u.pageToken=i),l&&(u.maxResults=l);const h=e.bucketOnlyServerUrl(),p=vf(h,s.host,s._protocol),g="GET",y=s.maxOperationRetryTime,w=new By(p,g,i3(s,e.bucket),y);return w.urlParams=u,w.errorHandler=zy(e),w}function u3(s,e,n){const i=e.fullServerUrl(),l=vf(i,s.host,s._protocol),u="GET",h=s.maxOperationRetryTime,p=new By(l,u,o3(s,n),h);return p.errorHandler=l3(e),p}function h3(s,e){return s&&s.contentType||e&&e.type()||"application/octet-stream"}function d3(s,e,n){const i=Object.assign({},n);return i.fullPath=s.path,i.size=e.size(),i.contentType||(i.contentType=h3(null,e)),i}function f3(s,e,n,i,l){const u=e.bucketOnlyServerUrl(),h={"X-Goog-Upload-Protocol":"multipart"};function p(){let fe="";for(let Te=0;Te<2;Te++)fe=fe+Math.random().toString().slice(2);return fe}const g=p();h["Content-Type"]="multipart/related; boundary="+g;const y=d3(e,i,l),w=n3(y,n),k="--"+g+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+w+`\r
--`+g+`\r
Content-Type: `+y.contentType+`\r
\r
`,E=`\r
--`+g+"--",O=$i.getBlob(k,i,E);if(O===null)throw TM();const G={name:y.fullPath},U=vf(u,s.host,s._protocol),V="POST",ne=s.maxUploadRetryTime,J=new By(U,V,a3(s,n),ne);return J.urlParams=G,J.headers=h,J.body=O.uploadData(),J.errorHandler=zy(e),J}class m3{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Lo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Lo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Lo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,i,l,u){if(this.sent_)throw Fc("cannot .send() more than once");if(io(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),u!==void 0)for(const h in u)u.hasOwnProperty(h)&&this.xhr_.setRequestHeader(h,u[h].toString());return l!==void 0?this.xhr_.send(l):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Fc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Fc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Fc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Fc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class p3 extends m3{initXhr(){this.xhr_.responseType="text"}}function Fy(){return new p3}class $o{constructor(e,n){this._service=e,n instanceof ir?this._location=n:this._location=ir.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new $o(e,n)}get root(){const e=new ir(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return bk(this._location.path)}get storage(){return this._service}get parent(){const e=YM(this._location.path);if(e===null)return null;const n=new ir(this._location.bucket,e);return new $o(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw SM(e)}}function g3(s,e,n){s._throwIfRoot("uploadBytes");const i=f3(s.storage,s._location,xk(),new $i(e,!0),n);return s.storage.makeRequestWithTokens(i,Fy).then(l=>({metadata:l,ref:s}))}function y3(s){const e={prefixes:[],items:[]};return _k(s,e).then(()=>e)}async function _k(s,e,n){const l=await v3(s,{pageToken:n});e.prefixes.push(...l.prefixes),e.items.push(...l.items),l.nextPageToken!=null&&await _k(s,e,l.nextPageToken)}function v3(s,e){e!=null&&typeof e.maxResults=="number"&&jg("options.maxResults",1,1e3,e.maxResults);const n=e||{},i=c3(s.storage,s._location,"/",n.pageToken,n.maxResults);return s.storage.makeRequestWithTokens(i,Fy)}function b3(s){s._throwIfRoot("getDownloadURL");const e=u3(s.storage,s._location,xk());return s.storage.makeRequestWithTokens(e,Fy).then(n=>{if(n===null)throw jM();return n})}function x3(s,e){const n=QM(s._location.path,e),i=new ir(s._location.bucket,n);return new $o(s.storage,i)}function w3(s){return/^[A-Za-z]+:\/\//.test(s)}function _3(s,e){return new $o(s,e)}function kk(s,e){if(s instanceof qy){const n=s;if(n._bucket==null)throw kM();const i=new $o(n,n._bucket);return e!=null?kk(i,e):i}else return e!==void 0?x3(s,e):s}function k3(s,e){if(e&&w3(e)){if(s instanceof qy)return _3(s,e);throw Tg("To use ref(service, url), the first argument must be a Storage instance.")}else return kk(s,e)}function c2(s,e){const n=e?.[fk];return n==null?null:ir.makeFromBucketSpec(n,s)}function T3(s,e,n,i={}){s.host=`${e}:${n}`;const l=io(e);l&&(Dg(`https://${s.host}/b`),Pg("Storage",!0)),s._isUsingEmulator=!0,s._protocol=l?"https":"http";const{mockUserToken:u}=i;u&&(s._overrideAuthToken=typeof u=="string"?u:G2(u,s.app.options.projectId))}class qy{constructor(e,n,i,l,u,h=!1){this.app=e,this._authProvider=n,this._appCheckProvider=i,this._url=l,this._firebaseVersion=u,this._isUsingEmulator=h,this._bucket=null,this._host=dk,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=dM,this._maxUploadRetryTime=fM,this._requests=new Set,l!=null?this._bucket=ir.makeFromBucketSpec(l,this._host):this._bucket=c2(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ir.makeFromBucketSpec(this._url,e):this._bucket=c2(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){jg("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){jg("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Mr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new $o(this,e)}_makeRequest(e,n,i,l,u=!0){if(this._deleted)return new NM(mk());{const h=BM(e,this._appId,i,l,n,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(h),h.getPromise().then(()=>this._requests.delete(h),()=>this._requests.delete(h)),h}}async makeRequestWithTokens(e,n){const[i,l]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,i,l).getPromise()}}const u2="@firebase/storage",h2="0.14.0";const Tk="storage";function Lp(s,e,n){return s=Qn(s),g3(s,e,n)}function d2(s){return s=Qn(s),y3(s)}function Oo(s){return s=Qn(s),b3(s)}function Gi(s,e){return s=Qn(s),k3(s,e)}function j3(s=Bg(),e){s=Qn(s);const i=Yd(s,Tk).getImmediate({identifier:e}),l=H2("storage");return l&&E3(i,...l),i}function E3(s,e,n,i={}){T3(s,e,n,i)}function S3(s,{instanceIdentifier:e}){const n=s.getProvider("app").getImmediate(),i=s.getProvider("auth-internal"),l=s.getProvider("app-check-internal");return new qy(n,i,l,e,Wo)}function N3(){Bo(new Zi(Tk,S3,"PUBLIC").setMultipleInstances(!0)),ja(u2,h2,""),ja(u2,h2,"esm2020")}N3();const jk={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},Hy=Vg(jk),qc=Iw(Hy),be=JI(Hy),Ki=j3(Hy),C3=Vg(jk,"secondary"),$D=Iw(C3),R3="EYdciKDOi3UYBLk1u8hHams5tmO2",Ek=x.createContext();function Xr(){return x.useContext(Ek)}function A3({children:s}){const[e,n]=x.useState(null),[i,l]=x.useState(!1),[u,h]=x.useState(!1),[p,g]=x.useState(null),[y,w]=x.useState(!0);x.useEffect(()=>PC(qc,async ne=>{if(n(ne),ne)if(ne.uid===R3)l(!0),h(!1),g(null);else{l(!1);try{const J=Pn(Qt(be,"clients"),fn("uid","==",ne.uid)),fe=await jn(J);if(fe.empty)h(!1),g(null);else{const Te=fe.docs[0];h(!0),g({id:Te.id,...Te.data()})}}catch(J){console.error("Error fetching client data:",J),h(!1),g(null)}}else l(!1),h(!1),g(null);w(!1)}),[]);const U={currentUser:e,isAdmin:i,isClient:u,clientData:p,updateClientData:V=>{g(ne=>ne&&{...ne,...V})},login:async(V,ne,J=!0)=>(await IC(qc,J?Tw:Wg),await AC(qc,V,ne)),logout:()=>LC(qc),resetPassword:V=>RC(qc,V),loading:y};return a.jsx(Ek.Provider,{value:U,children:s})}const Sk=x.createContext();function Pa(){return x.useContext(Sk)}function I3({children:s}){const[e,n]=x.useState(()=>{const g=localStorage.getItem("theme");return g?g==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),[i,l]=x.useState(()=>localStorage.getItem("accent")||"red");x.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light")},[e]),x.useEffect(()=>{localStorage.setItem("accent",i)},[i]);const p={isDark:e,toggleTheme:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),n(!e),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)},accent:i,setAccent:g=>l(g)};return a.jsx(Sk.Provider,{value:p,children:s})}function M3(){const[s,e]=x.useState(""),[n,i]=x.useState(""),[l,u]=x.useState(!0),[h,p]=x.useState(""),[g,y]=x.useState(!1),[w,k]=x.useState(!1),[E,O]=x.useState(!1),{login:G,resetPassword:U,currentUser:V,isAdmin:ne,isClient:J,clientData:fe,loading:Te}=Xr(),$e=Zs();if(x.useEffect(()=>{if(!Te&&V){if(ne)$e("/dashboard");else if(J){const j=fe?.clientType;$e(j==="core_buddy"?"/client/core-buddy":j==="circuit_vip"||j==="circuit_dropin"?"/client/circuit":"/client")}}},[Te,V,ne,J,fe,$e]),Te)return null;const Ve=async j=>{j.preventDefault(),p(""),y(!0);try{await G(s,n,l)}catch(R){p(R.message||"Failed to log in"),y(!1)}},I=async j=>{if(j.preventDefault(),p(""),!s.trim()){p("Please enter your email address");return}y(!0);try{await U(s.trim()),O(!0)}catch(R){R.code==="auth/user-not-found"?p("No account found with this email"):p(R.message||"Failed to send reset email")}y(!1)};return a.jsx("div",{className:"login-container",children:a.jsxs("div",{className:"login-card",children:[a.jsxs("div",{className:"login-header",children:[a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),a.jsx("p",{children:w?"Reset Password":"Client Portal"})]}),h&&a.jsx("div",{className:"error-message",children:h}),E?a.jsxs("div",{className:"reset-sent",children:[a.jsx("div",{className:"reset-sent-icon",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),a.jsx("p",{children:"Reset email sent!"}),a.jsx("span",{children:"Check your inbox for a password reset link"}),a.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{k(!1),O(!1),p("")},children:"Back to Log In"})]}):w?a.jsxs("form",{onSubmit:I,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:s,onChange:j=>e(j.target.value),placeholder:"Enter your email",required:!0})]}),a.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Sending...":"Send Reset Link"}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{k(!1),p("")},children:"Back to Log In"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("form",{onSubmit:Ve,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:s,onChange:j=>e(j.target.value),required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"password",children:"Password"}),a.jsx("input",{type:"password",id:"password",value:n,onChange:j=>i(j.target.value),required:!0})]}),a.jsx("div",{className:"remember-me",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:l,onChange:j=>u(j.target.checked)}),a.jsx("span",{children:"Remember me"})]})}),a.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Logging in...":"Log In"})]}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{k(!0),p("")},children:"Forgot password?"})]}),a.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})})}function Ma({active:s}){const e=Zs(),{clientData:n}=Xr(),i=n?.clientType==="block"&&n?.coreBuddyAccess;return a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:`block-nav-tab${s==="home"?" active":""}`,onClick:()=>e("/client/core-buddy"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),a.jsx("span",{children:"Profile"})]}),a.jsxs("button",{className:`block-nav-tab${s==="workouts"?" active":""}`,onClick:()=>e("/client/core-buddy/workouts"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:a.jsx("path",{d:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"})}),a.jsx("span",{children:"Workouts"})]}),a.jsxs("button",{className:`block-nav-tab${s==="nutrition"?" active":""}`,onClick:()=>e("/client/core-buddy/nutrition"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"})}),a.jsx("span",{children:"Nutrition"})]}),a.jsxs("button",{className:`block-nav-tab${s==="buddies"?" active":""}`,onClick:()=>e("/client/core-buddy/buddies"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"Buddies"})]}),i&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>e("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),a.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),a.jsx("span",{children:"Block"})]})]})}function Ou(s,e,n,i,l){const u=[];for(let h=0;h<s;h++){const p=(h*(360/s)-90)*(Math.PI/180);u.push({x1:e+i*Math.cos(p),y1:n+i*Math.sin(p),x2:e+l*Math.cos(p),y2:n+l*Math.sin(p),thick:h%5===0})}return u}const $y=Ou(60,100,100,85,96),au=Ou(60,100,100,78,94),D3=Ou(60,100,100,82,94);Ou(60,50,50,38,46);const P3=Ou(60,40,40,30,37),Op=[10,25,50,100,200,500,1e3],Vi=5;function El(s){return s.toISOString().split("T")[0]}function L3(s){let e=0;for(const n of Op){if(s<n)return{prev:e,next:n};e=n}return{prev:Op[Op.length-1],next:s+100}}const O3={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},V3={fullbody_4wk:["Push Focus","Pull Focus","Legs & Core"],fullbody_8wk:["Strength","Power","Endurance"],fullbody_12wk:["Upper Push","Lower Body","Upper Pull"],core_4wk:["Abs","Stability","Power Core"],core_8wk:["Anti-Extension","Rotation","Power"],core_12wk:["Strength","Endurance","Power"],upper_4wk:["Push","Pull","Mixed"],lower_4wk:["Quad Dominant","Hamstring & Glute","Power & Stability"]},Vp=[{text:"You have 24 hours a day...",bold:"make it count"},{text:"Discipline beats motivation...",bold:"every single time"},{text:"Rest when you're done,",bold:"not when you're tired"},{text:"Small daily gains...",bold:"create massive results"},{text:"Your body keeps score,",bold:"train it well"},{text:"Consistency over intensity...",bold:"always wins"},{text:"The only bad workout...",bold:"is the one you skipped"}];function Bp(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),n=Math.floor((new Date-e)/1e3);return n<60?"just now":n<3600?`${Math.floor(n/60)}m ago`:n<86400?`${Math.floor(n/3600)}h ago`:n<604800?`${Math.floor(n/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function Hc(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function B3(s,e=800){return new Promise(n=>{const i=new Image;i.onload=()=>{const l=document.createElement("canvas");let u=i.width,h=i.height;u>h?u>e&&(h=Math.round(h*e/u),u=e):h>e&&(u=Math.round(u*e/h),h=e),l.width=u,l.height=h,l.getContext("2d").drawImage(i,0,0,u,h),l.toBlob(p=>n(p),"image/jpeg",.8)},i.src=URL.createObjectURL(s)})}const yr={first_workout:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M6 4v16"}),a.jsx("path",{d:"M18 4v16"}),a.jsx("path",{d:"M6 12h12"}),a.jsx("rect",{x:"3",y:"7",width:"6",height:"10",rx:"1"}),a.jsx("rect",{x:"15",y:"7",width:"6",height:"10",rx:"1"})]}),workouts_10:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 2c1 3 4 5.5 4 8.5a4 4 0 1 1-8 0C8 7.5 11 5 12 2z"}),a.jsx("path",{d:"M12 14v4"}),a.jsx("path",{d:"M10 18h4"})]}),workouts_25:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),workouts_50:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M4 12h4"}),a.jsx("path",{d:"M16 12h4"}),a.jsx("path",{d:"M12 4v4"}),a.jsx("path",{d:"M12 16v4"}),a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M12 2a10 10 0 1 1 0 20 10 10 0 0 1 0-20z"})]}),workouts_100:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 2L15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26z"}),a.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),streak_2:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2"}),a.jsx("path",{d:"M16 2v4"}),a.jsx("path",{d:"M8 2v4"}),a.jsx("path",{d:"M3 10h18"}),a.jsx("path",{d:"M9 16l2 2 4-4"})]}),streak_4:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2"}),a.jsx("path",{d:"M16 2v4"}),a.jsx("path",{d:"M8 2v4"}),a.jsx("path",{d:"M3 10h18"}),a.jsx("path",{d:"M8 16h8"}),a.jsx("path",{d:"M12 14v4"})]}),streak_8:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M10 2c-1.5 3-5 5-5 9a7 7 0 0 0 14 0c0-4-3.5-6-5-9"}),a.jsx("path",{d:"M12 18c-2 0-3-1.5-3-3 0-2 1.5-3 3-5 1.5 2 3 3 3 5 0 1.5-1 3-3 3z"})]}),programme_done:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),a.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),a.jsx("path",{d:"M4 22h16"}),a.jsx("path",{d:"M10 22V8a4 4 0 0 0-4-4H8a4 4 0 0 0 4 4h0a4 4 0 0 0 4-4h2a4 4 0 0 0-4 4v14"}),a.jsx("path",{d:"M9 12l2 2 4-4"})]}),habits_7:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),nutrition_7:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 2a5 5 0 0 1 5 5c0 2-1.5 3.5-3 4.5V20a2 2 0 0 1-4 0v-8.5C8.5 10.5 7 9 7 7a5 5 0 0 1 5-5z"}),a.jsx("path",{d:"M9 7h6"})]}),first_pb:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"8",r:"6"}),a.jsx("path",{d:"M12 14v8"}),a.jsx("path",{d:"M9 18l3 3 3-3"}),a.jsx("path",{d:"M10 6l2 2 2-2"})]}),pbs_5:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M3 20h18"}),a.jsx("path",{d:"M5 20V10l4-6"}),a.jsx("path",{d:"M9 20V4"}),a.jsx("path",{d:"M13 20V10l4-6"}),a.jsx("path",{d:"M17 20V4"}),a.jsx("path",{d:"M21 20V10"})]}),leaderboard_join:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]})},f2=[{id:"first_workout",icon:yr.first_workout,name:"First Rep",desc:"Complete your first workout",category:"workouts"},{id:"workouts_10",icon:yr.workouts_10,name:"On Fire",desc:"Complete 10 workouts",category:"workouts"},{id:"workouts_25",icon:yr.workouts_25,name:"Lightning",desc:"Complete 25 workouts",category:"workouts"},{id:"workouts_50",icon:yr.workouts_50,name:"Iron Will",desc:"Complete 50 workouts",category:"workouts"},{id:"workouts_100",icon:yr.workouts_100,name:"Century Club",desc:"Complete 100 workouts",category:"workouts"},{id:"streak_2",icon:yr.streak_2,name:"2 Week Warrior",desc:"2-week workout streak",category:"streak"},{id:"streak_4",icon:yr.streak_4,name:"Month Strong",desc:"4-week workout streak",category:"streak"},{id:"streak_8",icon:yr.streak_8,name:"Unbreakable",desc:"8-week workout streak",category:"streak"},{id:"programme_done",icon:yr.programme_done,name:"Finisher",desc:"Complete a programme",category:"programme"},{id:"habits_7",icon:yr.habits_7,name:"Habit Machine",desc:"7-day perfect habit streak",category:"habits"},{id:"nutrition_7",icon:yr.nutrition_7,name:"Fuel Master",desc:"Log nutrition 7 days in a row",category:"nutrition"},{id:"first_pb",icon:yr.first_pb,name:"Record Breaker",desc:"Set your first PB",category:"pbs"},{id:"pbs_5",icon:yr.pbs_5,name:"Climbing",desc:"Set 5 personal bests",category:"pbs"},{id:"leaderboard_join",icon:yr.leaderboard_join,name:"Competitor",desc:"Join the leaderboard",category:"social"}];function U3(){const{currentUser:s,isClient:e,clientData:n,logout:i,updateClientData:l,loading:u}=Xr(),{isDark:h,toggleTheme:p}=Pa(),g=Zs(),[y,w]=x.useState({hours:0,minutes:0,seconds:0}),[k,E]=x.useState(0),[O,G]=x.useState(0),[U,V]=x.useState(""),[ne,J]=x.useState(0),[fe,Te]=x.useState(0),[$e,Ve]=x.useState(!1),[I,j]=x.useState({protein:0,carbs:0,fats:0,calories:0}),[R,P]=x.useState(null),[D,z]=x.useState(0),[M,We]=x.useState(null),[wt,Q]=x.useState(!1),[je,ze]=x.useState(!1),[lt,ie]=x.useState(0),[L,H]=x.useState(0),[ye,Se]=x.useState([]),[qe,Ae]=x.useState([]),[nt,pt]=x.useState(null),[Je,qt]=x.useState(!1),cn=x.useRef(null),[Nt,Ct]=x.useState([]),[oe,En]=x.useState(null),[Ht,St]=x.useState(0),[Bt,ht]=x.useState(0),[et,tn]=x.useState(0),[ss,Pt]=x.useState(0),[Et,Ln]=x.useState(null),zt=x.useCallback((A,Z="info")=>{Ln({message:A,type:Z}),setTimeout(()=>Ln(null),4e3)},[]),[Sn,Kt]=x.useState([]),[Nn,me]=x.useState(!1),[Ee,Fe]=x.useState(""),[Ye,Be]=x.useState(null),[Me,Le]=x.useState(null),[xt,mt]=x.useState(!1),[Y,Ne]=x.useState(new Set),[Qe,Xe]=x.useState(new Set),[dt,Ft]=x.useState({}),[Rt,nn]=x.useState({}),[Vn,An]=x.useState({}),[rn,yn]=x.useState({}),[In,un]=x.useState({}),[rs,q]=x.useState({}),pe=x.useRef(null),we=x.useRef(null),ve=x.useRef({}),[ge,st]=x.useState([]),[At,ct]=x.useState(!1),_t=x.useRef(null),[vt,vn]=x.useState([]),[er,_s]=x.useState(""),[Ds,Bn]=x.useState(!1),[F,ce]=x.useState(null),[T,C]=x.useState([]),[K,te]=x.useState(null);x.useEffect(()=>{!u&&!s&&g("/")},[u,s,g]),x.useEffect(()=>{if(n)try{const A=sessionStorage.getItem(`cbDash_${n.id}`);if(A){const Z=JSON.parse(A);G(Z.programmePct??0),V(Z.programmeName??""),J(Z.totalWorkouts??0),Te(Z.habitWeekPct??0),j(Z.nutritionTotals??{protein:0,carbs:0,fats:0,calories:0}),P(Z.nutritionTargetData??null),z(Z.todayHabitsCount??0),We(Z.nextSession??null),Q(Z.hasProgramme??!1),ze(Z.programmeComplete??!1),ie(Z.weeklyWorkouts??0),H(Z.pbCount??0),Se(Z.topPBs??[]),Ae(Z.leaderboardTop3??[]),Ct(Z.unlockedBadges??[]),St(Z.streakWeeks??0),Ve(!0)}}catch{}},[n]),x.useEffect(()=>{n?.photoURL&&pt(n.photoURL)},[n]),x.useEffect(()=>{if(!n)return;const A=Pn(Qt(be,"notifications"),fn("toId","==",n.id)),Z=cM(A,De=>{const Ze=De.docs.map(ft=>({id:ft.id,...ft.data()}));Ze.sort((ft,at)=>{const gt=ft.createdAt?.toMillis?.()||0;return(at.createdAt?.toMillis?.()||0)-gt}),st(Ze.slice(0,50))},De=>{console.error("Notification listener error:",De),De.code==="permission-denied"&&console.warn("Firestore rules may be missing for the notifications collection. Please update your Firestore rules in the Firebase Console.")});return()=>Z()},[n]),x.useEffect(()=>{const A=Z=>{_t.current&&!_t.current.contains(Z.target)&&ct(!1)};return document.addEventListener("mousedown",A),()=>document.removeEventListener("mousedown",A)},[]),x.useEffect(()=>{if(!n)return;const A=n.id;(async()=>{try{const[Z,De,Ze]=await Promise.all([jn(Pn(Qt(be,"buddies"),fn("user1","==",A))),jn(Pn(Qt(be,"buddies"),fn("user2","==",A))),jn(Qt(be,"clients"))]),ft=new Set;[...Z.docs,...De.docs].forEach(gt=>{const Lt=gt.data();ft.add(Lt.user1===A?Lt.user2:Lt.user1)});const at={};Ze.docs.forEach(gt=>{at[gt.id]=gt.data()}),vn(Array.from(ft).filter(gt=>at[gt]).map(gt=>({id:gt,name:at[gt].name,photoURL:at[gt].photoURL||null})))}catch(Z){console.error("Error loading buddies for mentions:",Z)}})()},[n]);const He=ge.filter(A=>!A.read).length,Ue=async()=>{const A=ge.filter(De=>!De.read);if(!A.length)return;const Z=a2(be);A.forEach(De=>Z.update(Ke(be,"notifications",De.id),{read:!0})),await Z.commit()},Oe=async()=>{if(!ge.length)return;const A=a2(be);ge.forEach(Z=>A.delete(Ke(be,"notifications",Z.id))),await A.commit()},Ut=async(A,Z,De={})=>{if(!(!n||A===n.id))try{await ri(Qt(be,"notifications"),{toId:A,fromId:n.id,fromName:n.name||"Someone",fromPhotoURL:n.photoURL||null,type:Z,read:!1,createdAt:Kr(),...De})}catch(Ze){console.error("Notification create error:",Ze),Ze.code==="permission-denied"&&zt("Notifications blocked  check Firestore rules","error")}},kt=(A,Z)=>{const De=Z==="compose"?pe.current?.selectionStart:null,ft=(De!=null?A.slice(0,De):A).match(/@(\w*)$/);if(ft){Bn(!0),ce(Z),_s(ft[1].toLowerCase());const at=vt.filter(gt=>gt.name&&gt.name.toLowerCase().includes(ft[1].toLowerCase())).slice(0,5);C(at)}else Bn(!1),C([])},$=(A,Z)=>{if(Z==="compose"){const De=pe.current,Ze=Ee,ft=De?.selectionStart??Ze.length,at=Ze.slice(0,ft),gt=Ze.slice(ft),Lt=at.replace(/@\w*$/,`@${A.name} `);Fe(Lt+gt),setTimeout(()=>{De?.focus(),De.selectionStart=De.selectionEnd=Lt.length},0)}else{const Ze=(Rt[Z]||"").replace(/@\w*$/,`@${A.name} `);nn(ft=>({...ft,[Z]:Ze}))}Bn(!1),C([])},he=A=>A&&A.split(/(@\w[\w\s]*?\s)/g).map((De,Ze)=>De.startsWith("@")&&vt.some(ft=>De.trim()===`@${ft.name}`)?a.jsx("span",{className:"mention-highlight",children:De.trim()},Ze):De),ae=async A=>{const Z=A.target.files?.[0];if(!(!Z||!n)){if(!Z.type.startsWith("image/")){zt("Please select an image file","error");return}if(Z.size>5*1024*1024){zt("Image must be under 5MB","error");return}qt(!0);try{const De=await new Promise(at=>{const gt=new Image;gt.onload=()=>{const Lt=document.createElement("canvas"),Dt=400;let $t=gt.width,Jt=gt.height;$t>Jt?(Jt=Jt/$t*Dt,$t=Dt):($t=$t/Jt*Dt,Jt=Dt),Lt.width=$t,Lt.height=Jt,Lt.getContext("2d").drawImage(gt,0,0,$t,Jt),Lt.toBlob(Wt=>at(Wt),"image/jpeg",.75)},gt.src=URL.createObjectURL(Z)}),Ze=Gi(Ki,`profilePhotos/${n.id}`);await Lp(Ze,De);const ft=await Oo(Ze);await Hi(Ke(be,"clients",n.id),{photoURL:ft}),pt(ft),l({photoURL:ft}),zt("Profile photo updated!","success")}catch(De){console.error("Photo upload error:",De),zt("Failed to upload photo","error")}qt(!1),cn.current&&(cn.current.value="")}};x.useEffect(()=>{const A=()=>{const De=new Date,Ze=new Date(De);Ze.setHours(23,59,59,999);const ft=Ze-De,at=Math.floor(ft/(1e3*60*60)),gt=Math.floor(ft%(1e3*60*60)/(1e3*60)),Lt=Math.floor(ft%(1e3*60)/1e3);w({hours:at,minutes:gt,seconds:Lt}),E(60-Lt)};A();const Z=setInterval(A,1e3);return()=>clearInterval(Z)},[]),x.useEffect(()=>{const A=setInterval(()=>{Pt(Z=>(Z+1)%Vp.length)},8e3);return()=>clearInterval(A)},[]),x.useEffect(()=>{if(!s||!n)return;(async()=>{let Z=null,De=0,Ze=[],ft=!1;try{const at=El(new Date),gt=await qn(Ke(be,"clientProgrammes",n.id));if(gt.exists()){const ys=gt.data(),Ws=O3[ys.templateId];if(Q(!0),Ws){const Gs=ys.completedSessions||{},Tr=Object.keys(Gs).length,jr=Ws.duration*Ws.daysPerWeek;G(jr>0?Math.round(Tr/jr*100):0);const fi=ys.templateId.replace(/_/g," ").replace(/\b\w/g,Zr=>Zr.toUpperCase());V(fi);const uo=V3[ys.templateId];let Or=!1;for(let Zr=1;Zr<=Ws.duration&&!Or;Zr++)for(let ea=0;ea<Ws.daysPerWeek&&!Or;ea++)Gs[`w${Zr}d${ea}`]||(We({week:Zr,dayIdx:ea,label:uo?.[ea]||`Day ${ea+1}`}),Or=!0);Or||(ze(!0),ft=!0)}}const Lt=Qt(be,"workoutLogs"),Dt=Pn(Lt,fn("clientId","==",n.id));Z=await jn(Dt);const $t=Z.docs.filter(ys=>ys.data().type!=="programme").length;J($t);const Jt=new Date,Wt=Jt.getDay(),kn=Wt===0?6:Wt-1,Zn=new Date(Jt);Zn.setDate(Jt.getDate()-kn),Zn.setHours(0,0,0,0);const as=El(Zn),cs=Z.docs.filter(ys=>(ys.data().date||"")>=as).length;ie(cs);const ks=Qt(be,"habitLogs"),ur=Pn(ks,fn("clientId","==",n.id),fn("date","==",at)),$s=await jn(ur);let es=0;if(!$s.empty){const ys=$s.docs[0].data().habits||{};es=Object.values(ys).filter(Boolean).length}Te(Math.round(es/Vi*100)),z(es);const hr=await qn(Ke(be,"nutritionTargets",n.id));hr.exists()&&P(hr.data());const tr=await qn(Ke(be,"nutritionLogs",`${n.id}_${at}`));if(tr.exists()){const Ws=(tr.data().entries||[]).reduce((Gs,Tr)=>({protein:Gs.protein+(Tr.protein||0),carbs:Gs.carbs+(Tr.carbs||0),fats:Gs.fats+(Tr.fats||0),calories:Gs.calories+(Tr.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});j(Ws)}}catch(at){console.error("Error loading dashboard stats:",at)}try{let at=[];const gt=await qn(Ke(be,"coreBuddyPBs",n.id));if(gt.exists()){const Lt=gt.data().exercises||{};H(Object.keys(Lt).length),De=Object.keys(Lt).length,at=Object.entries(Lt).sort(([,Dt],[,$t])=>($t.weight||0)-(Dt.weight||0)).slice(0,3).map(([Dt,$t])=>({name:Dt,weight:$t.weight,reps:$t.reps}))}if(at.length===0){const Lt={chestPress:"Chest Press",shoulderPress:"Shoulder Press",seatedRow:"Seated Row",latPulldown:"Lat Pulldown",squat:"Squat",deadlift:"Deadlift"},Dt=Pn(Qt(be,"personalBests"),fn("clientId","==",n.id)),$t=await jn(Dt);if(!$t.empty){const Jt={};$t.docs.forEach(kn=>{const Zn=kn.data().benchmarks||{};Object.entries(Zn).forEach(([as,cs])=>{if(!cs.weight||!Lt[as])return;const ks=(cs.weight||0)*(cs.reps||1);(!Jt[as]||ks>(Jt[as].weight||0)*(Jt[as].reps||1))&&(Jt[as]={name:Lt[as],weight:cs.weight,reps:cs.reps})})});const Wt=Object.values(Jt);H(Wt.length),De=Wt.length,at=Wt.sort((kn,Zn)=>(Zn.weight||0)-(kn.weight||0)).slice(0,3)}}Ze=at,Se(at)}catch(at){console.error("PB fetch error:",at)}try{const at=Qt(be,"clients"),gt=Pn(at,fn("leaderboardOptIn","==",!0)),Dt=(await jn(gt)).docs.map($t=>({id:$t.id,name:$t.data().name,photoURL:$t.data().photoURL||null}));Ae(Dt.slice(0,3))}catch(at){console.error("Leaderboard preview error:",at)}try{let at=0;if(Z){const kn=Z.docs.map(Zn=>Zn.data().date).filter(Boolean).sort().reverse();if(kn.length>0){const Zn=new Date;let as=new Date(Zn);e:for(let cs=0;cs<52;cs++){const ks=new Date(as),ur=ks.getDay(),$s=ur===0?6:ur-1;ks.setDate(ks.getDate()-$s),ks.setHours(0,0,0,0);const es=new Date(ks);es.setDate(es.getDate()+7);const hr=El(ks),tr=El(es);if(kn.some(Ws=>Ws>=hr&&Ws<tr))at++;else{if(cs>0)break e;break}as.setDate(as.getDate()-7)}}}St(at);let gt=0;for(let kn=0;kn<30;kn++){const Zn=new Date;Zn.setDate(Zn.getDate()-kn);const as=El(Zn);try{const cs=await jn(Pn(Qt(be,"habitLogs"),fn("clientId","==",n.id),fn("date","==",as)));if(cs.empty)break;{const ks=cs.docs[0].data().habits||{};if(Object.values(ks).filter(Boolean).length>=Vi)gt++;else break}}catch{break}}ht(gt);let Lt=0;for(let kn=0;kn<30;kn++){const Zn=new Date;Zn.setDate(Zn.getDate()-kn);const as=El(Zn);try{const cs=await qn(Ke(be,"nutritionLogs",`${n.id}_${as}`));if(cs.exists()&&(cs.data().entries||[]).length>0)Lt++;else break}catch{break}}tn(Lt);const Dt=Z?Z.docs.length:0,$t=[],Jt=kn=>$t.push(kn);Dt>=1&&Jt("first_workout"),Dt>=10&&Jt("workouts_10"),Dt>=25&&Jt("workouts_25"),Dt>=50&&Jt("workouts_50"),Dt>=100&&Jt("workouts_100"),at>=2&&Jt("streak_2"),at>=4&&Jt("streak_4"),at>=8&&Jt("streak_8"),ft&&Jt("programme_done"),gt>=7&&Jt("habits_7"),Lt>=7&&Jt("nutrition_7"),(De>0||Ze.length>0)&&Jt("first_pb"),De>=5&&Jt("pbs_5"),n.leaderboardOptIn&&Jt("leaderboard_join"),Ct($t);const Wt={};$t.forEach(kn=>{Wt[kn]={unlockedAt:new Date().toISOString()}}),Gn(Ke(be,"achievements",n.id),{badges:Wt,updatedAt:new Date().toISOString()},{merge:!0}).catch(()=>{})}catch(at){console.error("Achievement computation error:",at)}Ve(!0)})()},[s,n]),x.useEffect(()=>{if(!(!$e||!n))try{sessionStorage.setItem(`cbDash_${n.id}`,JSON.stringify({programmePct:O,programmeName:U,totalWorkouts:ne,habitWeekPct:fe,nutritionTotals:I,nutritionTargetData:R,todayHabitsCount:D,nextSession:M,hasProgramme:wt,programmeComplete:je,weeklyWorkouts:lt,pbCount:L,topPBs:ye,leaderboardTop3:qe,unlockedBadges:Nt,streakWeeks:Ht}))}catch{}},[$e,O,U,ne,fe,I,R,D,M,wt,je,lt,L,ye,qe,Nt,Ht,n]);const Ce=A=>{const Z=A.currentTarget,De=Z.querySelector(".ripple");De&&De.remove();const Ze=Z.getBoundingClientRect(),ft=Math.max(Ze.width,Ze.height),at=A.clientX-Ze.left-ft/2,gt=A.clientY-Ze.top-ft/2,Lt=document.createElement("span");Lt.className="ripple",Lt.style.cssText=`width:${ft}px;height:${ft}px;left:${at}px;top:${gt}px;`,Z.appendChild(Lt),setTimeout(()=>Lt.remove(),600)},Pe=n?.name?.split(" ")[0]||"there",{prev:rt,next:It}=L3(ne),ot=It>rt?Math.round((ne-rt)/(It-rt)*100):100,an=[{label:"Programme",value:`${O}%`,pct:O,color:"#14b8a6",size:"normal"},{label:"Workouts",value:`${ne}`,pct:ot,color:"var(--color-primary)",size:"large"},{label:"Habits Today",value:`${fe}%`,pct:fe,color:"#38B6FF",size:"normal"}],Un=A=>!R||!R[A]?0:Math.min(Math.round(I[A]/R[A]*100),100),bn=(()=>{const A=new Date().getHours();return $e&&D>=Vi&&I.calories>0?{main:"Smashed it today,",sub:"Rest up and go again tomorrow."}:A>=5&&A<12?{main:"Rise and grind,",sub:"let's get after it!"}:A>=12&&A<17?{main:"Oye",sub:"crack on and make it count!"}:A>=17&&A<21?{main:"Evening session?",sub:"Let's finish strong!"}:{main:"Burning the midnight oil,",sub:"Respect the hustle!"}})(),xn=$e?wt&&M&&!je?{label:"NEXT SESSION",message:`Week ${M.week}, Day ${M.dayIdx+1}  ${M.label}`,cta:"Continue",action:()=>g("/client/core-buddy/programmes"),pct:O,ringLabel:`${O}%`}:D<Vi?{label:"DAILY HABITS",message:`${D}/${Vi} completed`,cta:"Open Habits",action:()=>g("/client/core-buddy/consistency"),pct:fe,ringLabel:`${D}/${Vi}`}:I.calories===0?{label:"NUTRITION",message:"No meals logged today",cta:"Log Meal",action:()=>g("/client/core-buddy/nutrition"),pct:0,ringLabel:"0"}:wt?je?{label:"COMPLETE",message:"Programme finished!",cta:"New Programme",action:()=>g("/client/core-buddy/workouts"),pct:100,ringLabel:"100%"}:{label:"TODAY",message:"You're crushing it!",cta:null,action:null,pct:100,ringLabel:""}:{label:"PROGRAMMES",message:"Start a programme to level up",cta:"Browse",action:()=>g("/client/core-buddy/workouts"),pct:0,ringLabel:""}:null,xr=x.useCallback(async()=>{if(n){me(!0);try{const A=await jn(Pn(Qt(be,"posts"),fn("authorId","==",n.id),Hd("createdAt","desc"),$d(30)));Kt(A.docs.map(De=>({id:De.id,...De.data()})));const Z=await jn(Pn(Qt(be,"postLikes"),fn("userId","==",n.id)));Ne(new Set(Z.docs.map(De=>De.data().postId)))}catch(A){console.error("Error loading journey:",A)}finally{me(!1)}}},[n]);x.useEffect(()=>{$e&&n&&xr()},[$e,n,xr]);const La=A=>{const Z=A.target.files?.[0];if(Z){if(!Z.type.startsWith("image/")){zt("Please select an image file","error");return}if(Z.size>10*1024*1024){zt("Image must be under 10MB","error");return}Be(Z),Le(URL.createObjectURL(Z))}},Jr=()=>{Be(null),Me&&URL.revokeObjectURL(Me),Le(null),we.current&&(we.current.value="")},wr=async()=>{if(!(!Ee.trim()&&!Ye||xt||!n)){mt(!0);try{let A=null;if(Ye){const Ze=await B3(Ye),ft=`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,at=Gi(Ki,`postImages/${n.id}/${ft}`);await Lp(at,Ze),A=await Oo(at)}await ri(Qt(be,"posts"),{authorId:n.id,authorName:n.name||"Unknown",authorPhotoURL:n.photoURL||null,content:Ee.trim(),type:A?"image":"text",imageURL:A||null,createdAt:Kr(),likeCount:0,commentCount:0});const De=Ee.trim().match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(De){const Ze=new Set;De.forEach(ft=>{const at=ft.slice(1).trim(),gt=vt.find(Lt=>Lt.name&&Lt.name.toLowerCase()===at.toLowerCase());gt&&!Ze.has(gt.id)&&(Ze.add(gt.id),Ut(gt.id,"mention",{}))})}Fe(""),Jr(),pe.current&&(pe.current.style.height="auto"),await xr(),zt("Posted!","success")}catch(A){console.error("Error posting:",A),zt(A?.message||"Failed to post","error")}finally{mt(!1)}}},wn=async A=>{if(window.confirm("Delete this post?"))try{await ar(Ke(be,"posts",A)),Kt(Z=>Z.filter(De=>De.id!==A)),zt("Post deleted","info")}catch(Z){console.error("Delete error:",Z),zt("Failed to delete","error")}},Jn=async A=>{if(!n)return;const Z=n.id,De=`${A}_${Z}`,Ze=Y.has(A),ft=new Set(Y);Ze?ft.delete(A):ft.add(A),Ne(ft),Kt(at=>at.map(gt=>gt.id===A?{...gt,likeCount:Math.max(0,(gt.likeCount||0)+(Ze?-1:1))}:gt));try{if(Ze)await ar(Ke(be,"postLikes",De)),await Hi(Ke(be,"posts",A),{likeCount:Mo(-1)});else{await Gn(Ke(be,"postLikes",De),{postId:A,userId:Z,createdAt:Kr()}),await Hi(Ke(be,"posts",A),{likeCount:Mo(1)});const at=Sn.find(gt=>gt.id===A);at&&Ut(at.authorId,"like",{postId:A})}}catch(at){console.error("Like error:",at),xr()}},Kn=async A=>{try{const Z=await jn(Pn(Qt(be,"postComments"),fn("postId","==",A),Hd("createdAt","asc"),$d(50)));Ft(De=>({...De,[A]:Z.docs.map(Ze=>({id:Ze.id,...Ze.data()}))}))}catch(Z){console.error("Error loading comments:",Z)}},_r=A=>{const Z=new Set(Qe);Z.has(A)?Z.delete(A):(Z.add(A),dt[A]||Kn(A)),Xe(Z)},cr=async A=>{const Z=(Rt[A]||"").trim(),De=In[A];if(!(!Z&&!De||!n)){An(Ze=>({...Ze,[A]:!0}));try{let Ze=null;if(De){const Dt=Gi(Ki,`comment-images/${Date.now()}_${De.name}`);await Lp(Dt,De),Ze=await Oo(Dt)}const ft={postId:A,authorId:n.id,authorName:n.name||"Unknown",authorPhotoURL:n.photoURL||null,content:Z||"",createdAt:Kr()};Ze&&(ft.imageURL=Ze);const at=rn[A];at&&(ft.replyToId=at.id,ft.replyToName=at.authorName),await ri(Qt(be,"postComments"),ft),await Hi(Ke(be,"posts",A),{commentCount:Mo(1)});const gt=Sn.find(Dt=>Dt.id===A);gt&&Ut(gt.authorId,"comment",{postId:A});const Lt=Z.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Lt){const Dt=new Set;Lt.forEach($t=>{const Jt=$t.slice(1).trim(),Wt=vt.find(kn=>kn.name&&kn.name.toLowerCase()===Jt.toLowerCase());Wt&&!Dt.has(Wt.id)&&(Dt.add(Wt.id),Ut(Wt.id,"mention",{postId:A}))})}nn(Dt=>({...Dt,[A]:""})),un(Dt=>({...Dt,[A]:null})),q(Dt=>({...Dt,[A]:null})),yn(Dt=>({...Dt,[A]:null})),ve.current[A]&&(ve.current[A].value=""),Kt(Dt=>Dt.map($t=>$t.id===A?{...$t,commentCount:($t.commentCount||0)+1}:$t)),await Kn(A)}catch(Ze){console.error("Comment error:",Ze),zt("Failed to comment","error")}finally{An(Ze=>({...Ze,[A]:!1}))}}},As=async(A,Z)=>{try{await ar(Ke(be,"postComments",Z)),await Hi(Ke(be,"posts",A),{commentCount:Mo(-1)}),Ft(De=>({...De,[A]:(De[A]||[]).filter(Ze=>Ze.id!==Z)})),Kt(De=>De.map(Ze=>Ze.id===A?{...Ze,commentCount:Math.max((Ze.commentCount||1)-1,0)}:Ze))}catch(De){console.error("Delete comment error:",De),zt("Failed to delete comment","error")}},Ps=(A,Z)=>{const De=Z.target.files?.[0];if(!De)return;if(De.size>5*1024*1024){zt("Image must be under 5MB","error");return}un(ft=>({...ft,[A]:De}));const Ze=new FileReader;Ze.onload=ft=>q(at=>({...at,[A]:ft.target.result})),Ze.readAsDataURL(De)},Lr=A=>{un(Z=>({...Z,[A]:null})),q(Z=>({...Z,[A]:null})),ve.current[A]&&(ve.current[A].value="")},kr=A=>{Fe(A.target.value),A.target.style.height="auto",A.target.style.height=Math.min(A.target.scrollHeight,120)+"px",kt(A.target.value,"compose")},pa=(A,Z)=>{nn(De=>({...De,[A]:Z})),kt(Z,A)};return a.jsxs("div",{className:"cb-dashboard","data-theme":h?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsxs("div",{className:"header-notif-wrap",ref:_t,children:[a.jsxs("button",{className:"header-notif-btn",onClick:()=>{ct(!At),At||Ue()},"aria-label":"Notifications",children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),a.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),He>0&&a.jsx("span",{className:"header-notif-badge",children:He>9?"9+":He})]}),At&&a.jsxs("div",{className:"notif-panel",children:[a.jsxs("div",{className:"notif-panel-header",children:[a.jsx("span",{className:"notif-panel-title",children:"Notifications"}),ge.length>0&&a.jsx("button",{className:"notif-clear-btn",onClick:Oe,children:"Clear all"})]}),a.jsx("div",{className:"notif-panel-list",children:ge.length===0?a.jsx("div",{className:"notif-empty",children:"No notifications yet"}):ge.map(A=>a.jsxs("div",{className:`notif-item${A.read?"":" unread"}`,onClick:()=>{if(ct(!1),A.type==="buddy_request"||A.type==="buddy_accept")g("/client/core-buddy/buddies");else if((A.type==="like"||A.type==="comment")&&A.postId){if(!Qe.has(A.postId)){const Z=new Set(Qe);Z.add(A.postId),Xe(Z),dt[A.postId]||Kn(A.postId)}setTimeout(()=>{const Z=document.getElementById(`post-${A.postId}`);Z&&Z.scrollIntoView({behavior:"smooth",block:"center"})},150)}else A.type==="like"||A.type==="comment"?document.querySelector(".cb-journey-section")?.scrollIntoView({behavior:"smooth"}):A.type==="mention"&&g(`/client/core-buddy/profile/${A.fromId}`)},children:[a.jsx("div",{className:"notif-item-avatar",children:A.fromPhotoURL?a.jsx("img",{src:A.fromPhotoURL,alt:""}):a.jsx("span",{children:(A.fromName||"?")[0]})}),a.jsxs("div",{className:"notif-item-body",children:[a.jsxs("p",{className:"notif-item-text",children:[a.jsx("strong",{children:A.fromName})," ",A.type==="buddy_request"&&"sent you a buddy request",A.type==="buddy_accept"&&"accepted your buddy request",A.type==="like"&&"liked your post",A.type==="comment"&&"commented on your post",A.type==="mention"&&"mentioned you"]}),a.jsx("span",{className:"notif-item-time",children:Bp(A.createdAt)})]})]},A.id))})]})]}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:p,"aria-label":"Toggle theme",children:h?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),a.jsx("button",{onClick:i,"aria-label":"Log out",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),a.jsxs("main",{className:"cb-main",children:[a.jsxs("div",{className:"cb-ring-container",children:[a.jsxs("div",{className:"cb-ring",children:[a.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:$y.map((A,Z)=>{const De=Z<k;return a.jsx("line",{x1:A.x1,y1:A.y1,x2:A.x2,y2:A.y2,className:`ring-tick ${De?"elapsed":"remaining"}`,strokeWidth:A.thick?"3":"2"},Z)})}),a.jsxs("div",{className:"cb-ring-center",children:[a.jsxs("div",{className:"cb-ring-logo",onClick:()=>cn.current?.click(),role:"button",tabIndex:0,"aria-label":"Change profile photo",children:[a.jsx("img",{src:nt||"/Logo.webp",alt:nt?"Profile":"Mind Core Fitness"}),a.jsx("div",{className:`cb-photo-overlay${Je?" uploading":""}`,children:Je?a.jsx("div",{className:"cb-photo-spinner"}):a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),a.jsx("input",{ref:cn,type:"file",accept:"image/*",onChange:ae,style:{display:"none"}})]}),!nt&&!Je&&a.jsx("div",{className:"cb-photo-badge",onClick:()=>cn.current?.click(),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),a.jsxs("div",{className:"cb-ring-countdown",children:[a.jsx("span",{className:"cb-timer-digit",children:String(y.hours).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit",children:String(y.minutes).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(y.seconds).padStart(2,"0")})]}),a.jsx("span",{className:"cb-ring-label",children:"remaining today"}),a.jsxs("p",{className:"cb-ring-tagline",children:[Vp[ss].text," ",a.jsx("strong",{children:Vp[ss].bold})]},ss)]}),a.jsx("div",{className:"cb-stats-row",children:an.map(A=>{const Z=(A.size==="large",38),De=2*Math.PI*Z,Ze=De-A.pct/100*De;return a.jsxs("div",{className:`cb-stat-item${A.size==="large"?" cb-stat-large":""}`,children:[a.jsxs("div",{className:"cb-stat-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-stat-track",cx:"50",cy:"50",r:Z}),a.jsx("circle",{className:"cb-stat-fill",cx:"50",cy:"50",r:Z,style:{stroke:A.color},strokeDasharray:De,strokeDashoffset:Ze})]}),a.jsx("span",{className:"cb-stat-value",style:{color:A.color},children:A.value})]}),a.jsx("span",{className:"cb-stat-label",children:A.label})]},A.label)})}),a.jsxs("p",{className:"cb-coach-msg",children:[bn.main," ",a.jsx("strong",{children:Pe}),"  ",bn.sub]}),xn&&a.jsxs("button",{className:"cb-nudge-card",onClick:xn.action||void 0,style:xn.action?void 0:{cursor:"default"},children:[a.jsxs("div",{className:"cb-nudge-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-nudge-ring-track",cx:"50",cy:"50",r:"38"}),a.jsx("circle",{className:"cb-nudge-ring-fill",cx:"50",cy:"50",r:"38",strokeDasharray:2*Math.PI*38,strokeDashoffset:2*Math.PI*38-xn.pct/100*2*Math.PI*38})]}),a.jsx("span",{className:"cb-nudge-ring-val",children:xn.ringLabel})]}),a.jsxs("div",{className:"cb-nudge-info",children:[a.jsx("span",{className:"cb-nudge-label",children:xn.label}),a.jsx("span",{className:"cb-nudge-title",children:xn.message}),xn.cta&&a.jsxs("span",{className:"cb-nudge-cta",children:[xn.cta," "]})]})]}),a.jsxs("div",{className:"cb-features",children:[a.jsxs("button",{className:"cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn",onClick:A=>{Ce(A),g("/client/core-buddy/nutrition")},children:[a.jsxs("div",{className:"cb-card-top-row",children:[a.jsx("div",{className:"cb-card-content",children:a.jsx("h3",{children:"Today's Nutrition"})}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsx("div",{className:"cb-card-preview-row",children:a.jsx("div",{className:"cb-mini-rings",children:[{label:"P",pct:Un("protein"),color:"#14b8a6"},{label:"C",pct:Un("carbs"),color:"var(--color-primary)"},{label:"F",pct:Un("fats"),color:"#eab308"},{label:"Cal",pct:Un("calories"),color:"#38B6FF"}].map(A=>{const De=2*Math.PI*38,Ze=De-A.pct/100*De;return a.jsxs("div",{className:"cb-mini-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-mini-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"cb-mini-fill",cx:"50",cy:"50",r:38,style:{stroke:A.color},strokeDasharray:De,strokeDashoffset:Ze})]}),a.jsx("span",{style:{color:A.color},children:A.label})]},A.label)})})}),a.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),a.jsxs("button",{className:"cb-feature-card cb-card-workouts-hero ripple-btn",onClick:A=>{Ce(A),g("/client/core-buddy/workouts")},children:[a.jsx("h3",{className:"cb-hero-title",children:"Workouts"}),a.jsxs("div",{className:"cb-hero-stats",children:[a.jsxs("span",{children:[lt," this week"]}),a.jsx("span",{className:"cb-hero-dot",children:""}),a.jsxs("span",{children:[ne," total"]})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"cb-grid-row",children:[a.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-consistency ripple-btn",onClick:A=>{Ce(A),g("/client/core-buddy/consistency")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Habits"}),a.jsx("div",{className:"cb-habit-dots",children:Array.from({length:Vi},(A,Z)=>a.jsx("span",{className:`cb-habit-dot${Z<D?" done":""}`},Z))}),a.jsxs("span",{className:"cb-habit-dots-label",children:[D,"/",Vi," today"]})]}),a.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-progress ripple-btn",onClick:A=>{Ce(A),g("/client/personal-bests?mode=corebuddy")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"PBs"}),ye.length>0?a.jsx("div",{className:"cb-pb-preview",children:ye.slice(0,2).map(A=>a.jsxs("div",{className:"cb-pb-entry",children:[a.jsx("span",{className:"cb-pb-name",children:A.name}),a.jsxs("span",{className:"cb-pb-value",children:[A.weight,"kg"]})]},A.name))}):a.jsxs("div",{className:"cb-progress-preview",children:[a.jsx("svg",{className:"cb-progress-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),a.jsx("span",{children:"Start lifting!"})]})]}),a.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),a.jsxs("button",{className:"cb-feature-card cb-card-leaderboard ripple-btn",onClick:A=>{Ce(A),g("/client/leaderboard")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Leaderboard"}),qe.length>0?a.jsx("div",{className:"cb-lb-preview",children:qe.map((A,Z)=>{const De=["#FFD700","#A8B4C0","#CD7F32"][Z],Ze=A.name?A.name.split(" ").map(at=>at[0]).join("").slice(0,2).toUpperCase():"?",ft=A.id===n?.id;return a.jsxs("div",{className:`cb-lb-entry${ft?" cb-lb-me":""}`,children:[a.jsx("div",{className:"cb-lb-avatar",style:{borderColor:De},children:A.photoURL?a.jsx("img",{src:A.photoURL,alt:"",className:"cb-lb-avatar-img"}):a.jsx("span",{children:Ze})}),a.jsxs("span",{className:"cb-lb-rank",style:{color:De},children:["#",Z+1]})]},A.id)})}):a.jsx("p",{children:"Opt in to compete with your Core Buddies"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"cb-feature-card cb-card-buddies ripple-btn",onClick:A=>{Ce(A),g("/client/core-buddy/buddies")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Buddies"}),a.jsx("p",{children:"Connect with other members and track each other's progress"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"cb-achievements-section",children:[a.jsx("h3",{className:"cb-achievements-title",children:"Achievements"}),a.jsx("div",{className:"cb-badges-scroll",children:f2.map(A=>{const Z=Nt.includes(A.id);return a.jsxs("button",{className:`cb-badge${Z?" unlocked":" locked"}`,onClick:()=>En(oe?.id===A.id?null:A),children:[a.jsx("span",{className:"cb-badge-icon",children:A.icon}),a.jsx("span",{className:"cb-badge-name",children:A.name})]},A.id)})}),oe&&a.jsxs("div",{className:"cb-badge-detail",children:[a.jsx("span",{className:"cb-badge-detail-icon",children:oe.icon}),a.jsxs("div",{className:"cb-badge-detail-info",children:[a.jsx("strong",{children:oe.name}),a.jsx("span",{children:oe.desc}),Nt.includes(oe.id)?a.jsx("span",{className:"cb-badge-status unlocked",children:"Unlocked"}):a.jsx("span",{className:"cb-badge-status locked",children:"Locked"})]})]}),a.jsxs("p",{className:"cb-badges-count",children:[Nt.length,"/",f2.length," unlocked"]})]}),a.jsxs("div",{className:"cb-journey-section",children:[a.jsx("h3",{className:"cb-journey-title",children:"My Journey"}),a.jsxs("div",{className:"journey-compose",children:[a.jsx("div",{className:"journey-compose-avatar",children:nt?a.jsx("img",{src:nt,alt:""}):a.jsx("span",{children:Hc(n?.name)})}),a.jsxs("div",{className:"journey-compose-body",style:{position:"relative"},children:[a.jsx("textarea",{ref:pe,placeholder:"Share your progress... (use @ to mention)",value:Ee,onChange:kr,rows:1,maxLength:500}),Ds&&F==="compose"&&T.length>0&&a.jsx("div",{className:"mention-dropdown",children:T.map(A=>a.jsxs("button",{className:"mention-option",onClick:()=>$(A,"compose"),children:[a.jsx("div",{className:"mention-option-avatar",children:A.photoURL?a.jsx("img",{src:A.photoURL,alt:""}):a.jsx("span",{children:Hc(A.name)})}),a.jsx("span",{children:A.name})]},A.id))}),Me&&a.jsxs("div",{className:"journey-image-preview",children:[a.jsx("img",{src:Me,alt:"Preview"}),a.jsx("button",{className:"journey-image-remove",onClick:Jr,"aria-label":"Remove image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-compose-actions",children:[a.jsx("button",{className:"journey-image-btn",onClick:()=>we.current?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:we,type:"file",accept:"image/*",onChange:La,hidden:!0}),(Ee.trim()||Ye)&&a.jsx("button",{className:"journey-post-btn",onClick:wr,disabled:xt,children:xt?a.jsx("div",{className:"journey-btn-spinner"}):"Post"})]})]})]}),Nn?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"cb-spinner"})}):Sn.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"Start sharing your fitness journey!"})]}):a.jsx("div",{className:"journey-list",children:Sn.map(A=>a.jsxs("div",{id:`post-${A.id}`,className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:A.authorPhotoURL?a.jsx("img",{src:A.authorPhotoURL,alt:""}):a.jsx("span",{children:Hc(A.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:A.authorName}),a.jsx("span",{className:"journey-post-time",children:Bp(A.createdAt)})]}),a.jsx("button",{className:"journey-delete-btn",onClick:()=>wn(A.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),A.content&&a.jsx("p",{className:"journey-post-content",children:he(A.content)}),A.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:A.imageURL,alt:"Post",loading:"lazy"})}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${Y.has(A.id)?" liked":""}`,onClick:()=>Jn(A.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:Y.has(A.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:A.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${Qe.has(A.id)?" active":""}`,onClick:()=>_r(A.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:A.commentCount||0})]})]}),Qe.has(A.id)&&a.jsxs("div",{className:"journey-comments",children:[dt[A.id]?.length>0?dt[A.id].map(Z=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",children:Z.authorPhotoURL?a.jsx("img",{src:Z.authorPhotoURL,alt:""}):a.jsx("span",{children:Hc(Z.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:Z.authorName}),Z.replyToName&&a.jsxs("span",{className:"journey-comment-reply-tag",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"9 14 4 9 9 4"}),a.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),Z.replyToName]}),Z.content&&a.jsx("span",{className:"journey-comment-text",children:he(Z.content)}),Z.imageURL&&a.jsx("img",{className:"journey-comment-image",src:Z.imageURL,alt:"Comment",loading:"lazy"})]}),a.jsxs("div",{className:"journey-comment-actions-row",children:[a.jsx("span",{className:"journey-comment-time",children:Bp(Z.createdAt)}),a.jsx("button",{className:"journey-comment-reply-btn",onClick:()=>yn(De=>({...De,[A.id]:{id:Z.id,authorName:Z.authorName}})),children:"Reply"}),a.jsx("button",{className:"journey-comment-delete-btn",onClick:()=>As(A.id,Z.id),"aria-label":"Delete comment",children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},Z.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),rn[A.id]&&a.jsxs("div",{className:"journey-comment-replying",children:[a.jsxs("span",{children:["Replying to ",a.jsx("strong",{children:rn[A.id].authorName})]}),a.jsx("button",{onClick:()=>yn(Z=>({...Z,[A.id]:null})),"aria-label":"Cancel reply",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),rs[A.id]&&a.jsxs("div",{className:"journey-comment-img-preview",children:[a.jsx("img",{src:rs[A.id],alt:"Preview"}),a.jsx("button",{onClick:()=>Lr(A.id),"aria-label":"Remove image",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("button",{className:"journey-comment-img-btn",onClick:()=>ve.current[A.id]?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:Z=>{ve.current[A.id]=Z},type:"file",accept:"image/*",onChange:Z=>Ps(A.id,Z),hidden:!0}),a.jsx("input",{type:"text",placeholder:"Comment",value:Rt[A.id]||"",onChange:Z=>pa(A.id,Z.target.value),onKeyDown:Z=>{Z.key==="Enter"&&cr(A.id)},maxLength:300}),Ds&&F===A.id&&T.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:T.map(Z=>a.jsxs("button",{className:"mention-option",onClick:()=>$(Z,A.id),children:[a.jsx("div",{className:"mention-option-avatar",children:Z.photoURL?a.jsx("img",{src:Z.photoURL,alt:""}):a.jsx("span",{children:Hc(Z.name)})}),a.jsx("span",{children:Z.name})]},Z.id))}),a.jsx("button",{onClick:()=>cr(A.id),disabled:!(Rt[A.id]||"").trim()&&!In[A.id]||Vn[A.id],children:Vn[A.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},A.id))})]})]})]}),a.jsx(Ma,{active:"home"}),Et&&a.jsxs("div",{className:`toast-notification ${Et.type}`,children:[Et.type==="info"&&a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),Et.message]})]})}const Up=new Map;function Bi(){return new Date().toISOString().split("T")[0]}const m2=[{key:"breakfast",label:"Breakfast"},{key:"lunch",label:"Lunch"},{key:"dinner",label:"Dinner"},{key:"snacks",label:"Snacks"}],z3={breakfast:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),a.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),a.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),a.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),a.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),lunch:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),dinner:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),snacks:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})};function F3(){const s=new Date().getHours();return s<11?"breakfast":s<14?"lunch":s<17?"snacks":"dinner"}function q3(){const{currentUser:s,isClient:e,clientData:n,loading:i}=Xr(),{isDark:l,toggleTheme:u,accent:h}=Pa(),p=Zs(),[g,y]=x.useState("loading"),[w,k]=x.useState(null),[E,O]=x.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",dailyActivity:"sedentary",trainingFrequency:"moderate",goal:"maintain",deficitLevel:"moderate"}),[G,U]=x.useState(null),[V,ne]=x.useState(Bi()),[J,fe]=x.useState({entries:[],water:0}),[Te,$e]=x.useState({protein:0,carbs:0,fats:0,calories:0}),[Ve,I]=x.useState(!1),[j,R]=x.useState(!1),[P,D]=x.useState(()=>{const T=new Date;return{year:T.getFullYear(),month:T.getMonth()}}),[z,M]=x.useState(F3),[We,wt]=x.useState(null),[Q,je]=x.useState(null),[ze,lt]=x.useState(!1),[ie,L]=x.useState(null),[H,ye]=x.useState(""),[Se,qe]=x.useState(!1),[Ae,nt]=x.useState(""),[pt,Je]=x.useState([]),[qt,cn]=x.useState(!1),[Nt,Ct]=x.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[oe,En]=x.useState(null),[Ht,St]=x.useState("100"),[Bt,ht]=x.useState(0),[et,tn]=x.useState("weight"),[ss,Pt]=x.useState(0),[Et,Ln]=x.useState(null);x.useRef(null);const zt=x.useRef(!1),Sn=x.useRef(null),Kt=x.useRef(null),Nn=x.useRef(null),me=x.useCallback((T,C="info")=>{Ln({message:T,type:C}),setTimeout(()=>Ln(null),3e3)},[]);x.useEffect(()=>{!i&&(!s||!e)&&p("/")},[s,e,i,p]),x.useEffect(()=>{if(!n?.id)return;(async()=>{try{const C=await qn(Ke(be,"nutritionTargets",n.id));C.exists()?(k(C.data()),y("dashboard")):y("setup")}catch(C){console.error("Error loading nutrition data:",C),y("setup")}})()},[n?.id]),x.useEffect(()=>{if(!n?.id)return;(async()=>{try{const C=await qn(Ke(be,"nutritionLogs",`${n.id}_${V}`));if(C.exists()){const K=C.data();fe({entries:K.entries||[],water:K.water||0})}else fe({entries:[],water:0})}catch(C){console.error("Error loading log:",C),fe({entries:[],water:0})}})()},[n?.id,V]),x.useEffect(()=>{const T=J.entries.reduce((C,K)=>({protein:C.protein+(K.protein||0),carbs:C.carbs+(K.carbs||0),fats:C.fats+(K.fats||0),calories:C.calories+(K.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});$e(T)},[J.entries]);const Ee=async T=>{try{await Gn(Ke(be,"nutritionLogs",`${n.id}_${V}`),{clientId:n.id,date:V,entries:T.entries,water:T.water,updatedAt:bt.now()})}catch(C){console.error("Error saving nutrition log:",C)}},Fe=V===Bi(),Ye=(T,C)=>new Date(T,C+1,0).getDate(),Be=(T,C)=>new Date(T,C,1).getDay(),Me=["January","February","March","April","May","June","July","August","September","October","November","December"],Le=["Su","Mo","Tu","We","Th","Fr","Sa"],xt=()=>{let T=parseFloat(E.weight);E.weightUnit==="lbs"&&(T*=.453592);let C;E.heightUnit==="cm"?C=parseFloat(E.height):C=(parseFloat(E.heightFeet)||0)*30.48+(parseFloat(E.heightInches)||0)*2.54;const K=parseInt(E.age);let te=E.gender==="male"?10*T+6.25*C-5*K+5:10*T+6.25*C-5*K-161;const Ue=te*{sedentary:1.2,light:1.3,moderate:1.4,active:1.5}[E.dailyActivity],Oe={low:100,moderate:200,high:300,daily:400},Ut=Math.round(Ue+Oe[E.trainingFrequency]);let kt=Ut,$,he;switch(E.goal){case"lose":kt=Ut*(1-{light:.15,moderate:.2,harsh:.25}[E.deficitLevel]),$=2.2,he=.3;break;case"build":kt=Ut*1.1,$=2,he=.22;break;default:$=1.8,he=.25}kt=Math.max(kt,E.gender==="male"?1400:1100);const ae=Math.round(T*$),Ce=Math.round(kt*he/9),Pe=Math.max(0,Math.round((kt-ae*4-Ce*9)/4));U({calories:Math.round(kt),protein:ae,carbs:Pe,fats:Ce,bmr:Math.round(te),neat:Math.round(Ue),exerciseAdd:Oe[E.trainingFrequency],tdee:Math.round(Ut)})},mt=async()=>{if(G)try{const T={clientId:n.id,calories:G.calories,protein:G.protein,carbs:G.carbs,fats:G.fats,waterGoal:8,goal:E.goal,updatedAt:bt.now()};await Gn(Ke(be,"nutritionTargets",n.id),T),k(T),y("dashboard"),me("Macro targets saved!","success")}catch(T){console.error("Error saving targets:",T),me("Failed to save targets. Please try again.","error")}},Y=()=>{const T=E.weight&&parseFloat(E.weight)>0,C=E.age&&parseInt(E.age)>0,K=E.heightUnit==="cm"?E.height&&parseFloat(E.height)>0:E.heightFeet&&parseFloat(E.heightFeet)>0||E.heightInches&&parseFloat(E.heightInches)>0;return T&&C&&K},Ne="nut_favourite_foods",Qe=()=>{try{return JSON.parse(localStorage.getItem(Ne)||"[]")}catch{return[]}},Xe=T=>Qe().some(C=>C.name.toLowerCase()===(T||"").toLowerCase()),dt=T=>{const C=Qe(),K=C.findIndex(te=>te.name.toLowerCase()===T.name.toLowerCase());K>=0?C.splice(K,1):C.unshift({name:T.name,protein:T.protein,carbs:T.carbs,fats:T.fats,calories:T.calories,serving:T.serving,per100g:T.per100g||null,servingUnit:T.servingUnit||"g",portion:T.portion||null}),localStorage.setItem(Ne,JSON.stringify(C)),Pt(te=>te+1)},Ft=T=>{const C=[...J.entries,{...T,meal:z,id:Date.now(),addedAt:new Date().toISOString()}],K={...J,entries:C};fe(K),Ee(K),je(null),En(null),St("100"),ht(0),tn("weight"),Ct({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),me("Food added!","success")},Rt=T=>{const C=J.entries.filter(te=>te.id!==T),K={...J,entries:C};fe(K),Ee(K)},nn=x.useRef(null),Vn=async()=>{lt(!0);const T=document.querySelector("#barcode-reader");if(!T){lt(!1),me("Scanner container not found.","error");return}if(!nn.current)try{const K=await Qr(()=>import("./quagga.min-BbicSfvA.js").then(te=>te.q),[]);nn.current=K.default}catch(K){console.error("Failed to load barcode scanner:",K),lt(!1),me("Could not load scanner.","error");return}const C=nn.current;C.init({inputStream:{type:"LiveStream",target:T,constraints:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader","ean_8_reader","upc_reader","upc_e_reader","code_128_reader","code_39_reader"]},locate:!0},K=>{if(K){console.error("Quagga init error:",K),lt(!1),me("Could not access camera. Check permissions.","error");return}C.start(),zt.current=!0}),C.onDetected(K=>{const te=K.codeResult.decodedCodes?.filter(Ue=>Ue.error!==void 0)?.map(Ue=>Ue.error)||[];if((te.length>0?te.reduce((Ue,Oe)=>Ue+Oe,0)/te.length:1)<.15){const Ue=K.codeResult.code;C.offDetected(),L(Ue)}})},An=()=>{const T=nn.current;zt.current&&T&&(T.stop(),T.offDetected(),zt.current=!1),lt(!1)},rn=/\b(milk|semi.skimmed|skimmed|whole milk|oat milk|almond milk|soy milk|juice|smoothie|water|squash|cordial|cola|pepsi|fanta|lemonade|soda|beer|wine|cider|lager|spirit|whisky|vodka|rum|gin|brandy|cream|yoghurt drink|milkshake|coffee|tea|broth|stock|soup|sauce|ketchup|vinegar|oil|syrup|honey|custard|coconut water|kombucha|energy drink|protein shake)\b/i,yn=T=>/ml|cl|\dl(?!b)|litre|liter|fl\s?oz/i.test((T||"").replace(/\s/g,"")),In=T=>{if(!T)return{value:100,unit:"g"};const C=T.toLowerCase().replace(/\s/g,""),K=C.match(/([\d.]+)/),te=K?parseFloat(K[1]):100;return yn(T)?/cl/.test(C)?{value:te*10,unit:"ml"}:/(?:^|\d)l(?!i)/.test(C)&&!/ml/.test(C)?{value:te*1e3,unit:"ml"}:{value:te,unit:"ml"}:{value:te,unit:"g"}},un=T=>{if(yn(T.serving_size)||yn(T.quantity))return"ml";const C=T.product_name||T.product_name_en||"";return rn.test(C)?"ml":"g"},rs=[{pattern:/\b(toast|bread|loaf|brioche|bagel|pitta|wrap|tortilla|crumpet|muffin|waffle|pancake)\b/i,label:"slice",weight:36},{pattern:/\begg\b/i,label:"egg",weight:60},{pattern:/\b(biscuit|cookie|digestive|hobnob|rich tea|oreo)\b/i,label:"biscuit",weight:13},{pattern:/\b(sausage|banger)\b/i,label:"sausage",weight:57},{pattern:/\b(rasher|bacon)\b/i,label:"rasher",weight:25},{pattern:/\b(rice cake)\b/i,label:"cake",weight:9},{pattern:/\b(cracker|ryvita)\b/i,label:"cracker",weight:10}],q=(T,C)=>{const K=T||"",te=K.match(/\((\d+\.?\d*)\s*g\)/i),He=K.match(/(?:^|per\s+)(\d*\s*[a-z][a-z\s]*?)(?:\s*\(|\s*-\s*|\s*$)/i);if(te&&He){const Ut=parseFloat(te[1]);let kt=He[1].replace(/^\d+\s*/,"").trim();if(kt&&Ut>0)return{label:kt,weight:Ut}}const Ue=K.match(/(\d+\.?\d*)\s*g\s*[\/=]\s*(\d*\s*[a-z][a-z\s]*)/i);if(Ue){const Ut=parseFloat(Ue[1]);let kt=Ue[2].replace(/^\d+\s*/,"").trim();if(kt&&Ut>0)return{label:kt,weight:Ut}}const Oe=C||"";for(const{pattern:Ut,label:kt,weight:$}of rs)if(Ut.test(Oe))return{label:kt,weight:$};return null},pe=T=>{const C=T.nutriments||{},K=un(T),te=In(T.serving_size),He=K==="ml"?te.unit==="ml"?te.value:100:te.value,Ue=T.product_name||T.product_name_en||"Unknown Product",Oe=q(T.serving_size,Ue);return{name:Ue,brand:T.brands||"",image:T.image_small_url||T.image_url||null,servingSize:T.serving_size||"100g",servingValue:He,servingUnit:K,portion:Oe,protein:Math.round(C.proteins_100g||C.proteins||0),carbs:Math.round(C.carbohydrates_100g||C.carbohydrates||0),fats:Math.round(C.fat_100g||C.fat||0),calories:Math.round(C["energy-kcal_100g"]||C["energy-kcal"]||(C.energy_100g?C.energy_100g/4.184:0)),per100g:!0}},we=async T=>{qe(!0);try{const C=`https://world.openfoodfacts.org/api/v2/product/${T}?fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,K=await fetch(C);if(!K.ok)throw new Error(`HTTP ${K.status}`);const te=await K.json();if(te.status==="success"||te.status===1||te.product){const He=pe(te.product);He.calories===0&&He.protein===0&&He.carbs===0?me("Product found but no nutrition data available.","error"):(En(He),He.portion?(ht(1),St(String(He.portion.weight)),tn("portion")):(ht(0),St(String(He.servingValue||100)),tn("weight")),ye(""))}else me("Product not found. Try search or manual entry.","error")}catch(C){console.error("Barcode lookup error:",C),me("Failed to look up product. Check your connection.","error")}qe(!1)},ve=(T,C,K)=>{const te=T.toLowerCase().trim(),He=C.toLowerCase().trim(),Ue=K.toLowerCase().trim();let Oe=0;return(te===Ue||te===Ue+"s"||te+"s"===Ue)&&(Oe+=100),(te.endsWith(" "+Ue)||te.endsWith(" "+Ue+"s"))&&(Oe+=40),(te.startsWith(Ue+" ")||te.startsWith(Ue+"s "))&&(Oe+=15),Ue.split(/\s+/).some(kt=>He===kt||He.startsWith(kt))&&(Oe+=30),Oe+=Math.max(0,30-te.length),Oe},ge=async()=>{if(!Ae.trim())return;Sn.current&&Sn.current.abort();const T=new AbortController;Sn.current=T;const C=Ae.trim().toLowerCase(),K=C.split(/\s+/).filter(Boolean);if(Up.has(C)){Je(Up.get(C));return}cn(!0);try{const He=`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(Ae.trim())}&search_simple=1&action=process&json=1&page_size=10&lc=en&sort_by=unique_scans_n&fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,Ue=await fetch(He,{signal:T.signal});if(!Ue.ok)throw new Error(`HTTP ${Ue.status}`);const Ut=((await Ue.json()).products||[]).map(kt=>pe(kt)).filter(kt=>kt.name!=="Unknown Product"&&(kt.calories>0||kt.protein>0)).filter(kt=>{const $=(kt.name+" "+kt.brand).toLowerCase();return K.every(he=>$.includes(he))}).sort((kt,$)=>ve($.name,$.brand,C)-ve(kt.name,kt.brand,C)).slice(0,10);Up.set(C,Ut),Je(Ut),Ut.length===0&&me("No results found. Try a different search.","info")}catch(te){if(te.name==="AbortError")return;console.error("Search error:",te),me("Search failed. Check your connection.","error")}cn(!1)};x.useEffect(()=>{if(Kt.current&&clearTimeout(Kt.current),!(!Ae.trim()||Q!=="search"||oe))return Kt.current=setTimeout(()=>{ge()},700),()=>clearTimeout(Kt.current)},[Ae]);const st=()=>{const T={...J,water:J.water+1};fe(T),Ee(T)},At=()=>{if(J.water<=0)return;const T={...J,water:J.water-1};fe(T),Ee(T)},ct={"ring-protein":"#14b8a6","ring-carbs":"var(--color-primary)","ring-fats":"#eab308","ring-cals":"rgba(150,150,150,0.55)"},_t=80,vt=2*Math.PI*_t,vn=(T,C,K,te,He)=>{const Ue=te>0?Math.min(100,Math.round(K/te*100)):0,Oe=vt-Ue/100*vt,Ut=ct[He]||"#14b8a6";return a.jsxs("div",{className:"nut-ring-wrap",children:[a.jsxs("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"nut-arc-track",cx:"100",cy:"100",r:_t}),a.jsx("circle",{className:"nut-arc-fill",cx:"100",cy:"100",r:_t,style:{stroke:Ut},strokeDasharray:vt,strokeDashoffset:Oe})]}),a.jsxs("div",{className:"nut-ring-center",children:[a.jsx("span",{className:"nut-ring-value",style:{color:Ut},children:Math.round(K)}),a.jsxs("span",{className:"nut-ring-target",children:["/ ",te,T==="Calories"?"":"g"]}),a.jsx("span",{className:"nut-ring-label",style:{color:Ut},children:C})]}),a.jsxs("span",{className:"nut-ring-pct",style:{color:Ut},children:[Ue,"%"]})]})};if(x.useEffect(()=>{if(!ie)return;const T=setTimeout(()=>{const C=ie;An(),L(null),we(C)},1500);return()=>clearTimeout(T)},[ie]),x.useEffect(()=>()=>{const T=nn.current;if(zt.current&&T){try{T.stop(),T.offDetected()}catch{}zt.current=!1}},[]),i||g==="loading")return a.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"nut-loading-inline",children:a.jsx("div",{className:"cb-loading-spinner"})})]});if(g==="setup")return a.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"nut-main",children:[a.jsxs("div",{className:"nut-setup-intro",children:[a.jsx("h2",{children:"Set Your Daily Targets"}),a.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),a.jsxs("div",{className:"nut-calc-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Gender"}),a.jsxs("div",{className:"nut-toggle-group",children:[a.jsx("button",{className:E.gender==="male"?"active":"",onClick:()=>{O(T=>({...T,gender:"male"})),U(null)},children:"Male"}),a.jsx("button",{className:E.gender==="female"?"active":"",onClick:()=>{O(T=>({...T,gender:"female"})),U(null)},children:"Female"})]})]}),a.jsxs("div",{className:"nut-form-row",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Age"}),a.jsx("input",{type:"number",value:E.age,onChange:T=>{O(C=>({...C,age:T.target.value})),U(null)},placeholder:"Years",min:"15",max:"100"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Weight"}),a.jsxs("div",{className:"nut-input-unit",children:[a.jsx("input",{type:"number",value:E.weight,onChange:T=>{O(C=>({...C,weight:T.target.value})),U(null)},placeholder:E.weightUnit,min:"30",max:"300"}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:E.weightUnit==="kg"?"active":"",onClick:()=>{O(T=>({...T,weightUnit:"kg"})),U(null)},children:"kg"}),a.jsx("button",{className:E.weightUnit==="lbs"?"active":"",onClick:()=>{O(T=>({...T,weightUnit:"lbs"})),U(null)},children:"lbs"})]})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Height"}),a.jsxs("div",{className:"nut-input-unit",children:[E.heightUnit==="cm"?a.jsx("input",{type:"number",value:E.height,onChange:T=>{O(C=>({...C,height:T.target.value})),U(null)},placeholder:"cm",min:"100",max:"250"}):a.jsxs("div",{className:"nut-height-imperial",children:[a.jsx("input",{type:"number",value:E.heightFeet,onChange:T=>{O(C=>({...C,heightFeet:T.target.value})),U(null)},placeholder:"ft",min:"4",max:"7"}),a.jsx("input",{type:"number",value:E.heightInches,onChange:T=>{O(C=>({...C,heightInches:T.target.value})),U(null)},placeholder:"in",min:"0",max:"11"})]}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:E.heightUnit==="cm"?"active":"",onClick:()=>{O(T=>({...T,heightUnit:"cm"})),U(null)},children:"cm"}),a.jsx("button",{className:E.heightUnit==="ft"?"active":"",onClick:()=>{O(T=>({...T,heightUnit:"ft"})),U(null)},children:"ft/in"})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Daily Activity (outside of training)"}),a.jsxs("select",{value:E.dailyActivity,onChange:T=>{O(C=>({...C,dailyActivity:T.target.value})),U(null)},children:[a.jsx("option",{value:"sedentary",children:"Sedentary  desk job, under 5k steps"}),a.jsx("option",{value:"light",children:"Lightly Active  office + walking, 5-8k steps"}),a.jsx("option",{value:"moderate",children:"Moderately Active  on feet often, 8-12k steps"}),a.jsx("option",{value:"active",children:"Very Active  physical job, 12k+ steps"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Training Sessions per Week"}),a.jsxs("select",{value:E.trainingFrequency,onChange:T=>{O(C=>({...C,trainingFrequency:T.target.value})),U(null)},children:[a.jsx("option",{value:"low",children:"1-2 sessions"}),a.jsx("option",{value:"moderate",children:"3-4 sessions"}),a.jsx("option",{value:"high",children:"5-6 sessions"}),a.jsx("option",{value:"daily",children:"7+ sessions"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fitness Goal"}),a.jsxs("div",{className:"nut-goal-options",children:[a.jsxs("button",{className:E.goal==="lose"?"active":"",onClick:()=>{O(T=>({...T,goal:"lose"})),U(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"-"}),a.jsx("span",{children:"Lose Weight"})]}),a.jsxs("button",{className:E.goal==="maintain"?"active":"",onClick:()=>{O(T=>({...T,goal:"maintain"})),U(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"="}),a.jsx("span",{children:"Maintain"})]}),a.jsxs("button",{className:E.goal==="build"?"active":"",onClick:()=>{O(T=>({...T,goal:"build"})),U(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"+"}),a.jsx("span",{children:"Build Muscle"})]})]})]}),E.goal==="lose"&&a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Deficit Level"}),a.jsxs("div",{className:"nut-deficit-options",children:[a.jsxs("button",{className:E.deficitLevel==="light"?"active":"",onClick:()=>{O(T=>({...T,deficitLevel:"light"})),U(null)},children:[a.jsx("strong",{children:"Mild"}),a.jsx("span",{children:"15% below TDEE"})]}),a.jsxs("button",{className:E.deficitLevel==="moderate"?"active":"",onClick:()=>{O(T=>({...T,deficitLevel:"moderate"})),U(null)},children:[a.jsx("strong",{children:"Moderate"}),a.jsx("span",{children:"20% below TDEE"})]}),a.jsxs("button",{className:E.deficitLevel==="harsh"?"active":"",onClick:()=>{O(T=>({...T,deficitLevel:"harsh"})),U(null)},children:[a.jsx("strong",{children:"Aggressive"}),a.jsx("span",{children:"25% below TDEE"})]})]})]}),a.jsx("button",{className:"nut-calc-btn",onClick:xt,disabled:!Y(),children:"Calculate Macros"})]}),G&&a.jsxs("div",{className:"nut-calc-results",children:[a.jsx("h3",{children:"Your Daily Targets"}),a.jsxs("div",{className:"nut-calc-rings",children:[vn("Protein","Protein",G.protein,G.protein,"ring-protein"),vn("Carbs","Carbs",G.carbs,G.carbs,"ring-carbs"),vn("Fats","Fats",G.fats,G.fats,"ring-fats"),vn("Calories","Calories",G.calories,G.calories,"ring-cals")]}),a.jsxs("div",{className:"nut-calc-info",children:[a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"BMR (body at rest)"}),a.jsxs("span",{children:[G.bmr," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Daily activity (NEAT)"}),a.jsxs("span",{children:[G.neat," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Training sessions"}),a.jsxs("span",{children:["+",G.exerciseAdd," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",style:{fontWeight:600},children:[a.jsx("span",{children:"TDEE (total burn)"}),a.jsxs("span",{children:[G.tdee," cal"]})]})]}),a.jsx("button",{className:"nut-save-targets-btn",onClick:mt,children:"Set as My Daily Targets"})]})]}),Et&&a.jsx("div",{className:`toast-notification ${Et.type}`,children:Et.message})]});const er=T=>{const C=new Date(T+"T12:00:00"),K=C.getDay(),te=new Date(C);te.setDate(C.getDate()-(K+6)%7);const He=[];for(let Ue=0;Ue<7;Ue++){const Oe=new Date(te);Oe.setDate(te.getDate()+Ue),He.push(Oe.toISOString().split("T")[0])}return He},_s=["M","T","W","T","F","S","S"],Ds=(T,C="search")=>{M(T),C==="scan"?(je("scan"),En(null)):C==="manual"?(je("manual"),Ct({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})):C==="favourites"?je("favourites"):(je("search"),Je([]),nt(""))},Bn=er(V),F=new Date(V+"T12:00:00"),ce=`${Me[F.getMonth()]} ${F.getFullYear()}`;return a.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsxs("div",{className:"nut-dark-zone",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:()=>{y("setup"),U(null)},"aria-label":"Recalculate macros",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]})}),a.jsxs("div",{className:"nut-dark-content",children:[a.jsxs("div",{className:"nut-week-strip",children:[a.jsxs("div",{className:"nut-week-header",children:[a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const T=new Date(V+"T12:00:00");T.setDate(T.getDate()-7);const C=T.toISOString().split("T")[0];ne(C)},"aria-label":"Previous week",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsx("button",{className:"nut-week-month-label",onClick:()=>{I(!Ve),D({year:F.getFullYear(),month:F.getMonth()})},children:ce}),a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const T=new Date(V+"T12:00:00");T.setDate(T.getDate()+7);const C=T.toISOString().split("T")[0];C<=Bi()&&ne(C)},"aria-label":"Next week",disabled:Bn[6]>=Bi(),children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-week-days",children:Bn.map((T,C)=>{const K=new Date(T+"T12:00:00").getDate(),te=T===V,He=T>Bi(),Ue=T===Bi();return a.jsxs("button",{className:`nut-week-day${te?" selected":""}${Ue?" today":""}${He?" future":""}`,disabled:He,onClick:()=>ne(T),children:[a.jsx("span",{className:"nut-week-day-letter",children:_s[C]}),a.jsx("span",{className:"nut-week-day-num",children:K})]},T)})})]}),Ve&&a.jsxs("div",{className:"nut-calendar nut-calendar-dark",children:[a.jsxs("div",{className:"nut-cal-header",children:[a.jsx("button",{onClick:()=>D(T=>{let C=T.month-1,K=T.year;return C<0&&(C=11,K--),{year:K,month:C}}),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsxs("span",{children:[Me[P.month]," ",P.year]}),a.jsx("button",{onClick:()=>D(T=>{let C=T.month+1,K=T.year;return C>11&&(C=0,K++),{year:K,month:C}}),disabled:P.year===new Date().getFullYear()&&P.month>=new Date().getMonth(),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-cal-days-header",children:Le.map(T=>a.jsx("span",{children:T},T))}),a.jsxs("div",{className:"nut-cal-grid",children:[[...Array(Be(P.year,P.month))].map((T,C)=>a.jsx("span",{},`e${C}`)),[...Array(Ye(P.year,P.month))].map((T,C)=>{const K=C+1,te=`${P.year}-${String(P.month+1).padStart(2,"0")}-${String(K).padStart(2,"0")}`,He=te>Bi(),Ue=te===V,Oe=te===Bi();return a.jsx("button",{className:`nut-cal-day${Ue?" selected":""}${Oe?" today":""}${He?" future":""}`,disabled:He,onClick:()=>{ne(te),I(!1)},children:K},K)})]})]}),a.jsxs("div",{className:"nut-rings-row",children:[vn("Protein","Protein",Te.protein,w.protein,"ring-protein"),vn("Carbs","Carbs",Te.carbs,w.carbs,"ring-carbs"),vn("Fats","Fats",Te.fats,w.fats,"ring-fats"),vn("Calories","kCal",Te.calories,w.calories,"ring-cals")]})]})]}),a.jsx("div",{className:"nut-light-zone",children:a.jsxs("div",{className:"nut-light-content",children:[Fe&&a.jsxs("button",{className:"nut-water-quick",onClick:()=>R(!0),children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"18",height:"18",children:a.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),a.jsxs("span",{className:"nut-water-quick-count",children:[J.water," / ",w?.waterGoal||8]}),a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",width:"14",height:"14",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})]}),a.jsx("div",{className:"nut-log-section",children:a.jsx("div",{className:"nut-meals-list",children:m2.map(T=>{const C=J.entries.filter(te=>(te.meal||"snacks")===T.key),K=C.reduce((te,He)=>({protein:te.protein+(He.protein||0),carbs:te.carbs+(He.carbs||0),fats:te.fats+(He.fats||0),calories:te.calories+(He.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});return a.jsxs("div",{className:"nut-meal-card",children:[a.jsxs("div",{className:"nut-meal-card-header",children:[a.jsx("span",{className:`nut-meal-card-icon nut-meal-icon-${T.key}`,children:z3[T.key]}),a.jsx("span",{className:"nut-meal-card-title",children:T.label}),C.length>0&&a.jsxs("span",{className:"nut-meal-card-cal",children:[K.calories," cal"]}),Fe&&a.jsx("button",{className:"nut-meal-add-btn",onClick:()=>wt(We===T.key?null:T.key),"aria-label":`Add to ${T.label}`,children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),C.length>0&&a.jsxs("div",{className:"nut-meal-bars",children:[a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-p",children:"P"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-protein",style:{width:`${Math.min(100,w.protein>0?K.protein/w.protein*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[K.protein,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-c",children:"C"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-carbs",style:{width:`${Math.min(100,w.carbs>0?K.carbs/w.carbs*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[K.carbs,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-f",children:"F"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-fats",style:{width:`${Math.min(100,w.fats>0?K.fats/w.fats*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[K.fats,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-cal",children:"K"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-cals",style:{width:`${Math.min(100,w.calories>0?K.calories/w.calories*100:0)}%`}})}),a.jsx("span",{className:"nut-meal-bar-val",children:K.calories})]})]}),C.length>0&&a.jsx("div",{className:"nut-log-list",children:C.map(te=>a.jsxs("div",{className:"nut-log-item",children:[a.jsxs("div",{className:"nut-log-item-info",children:[a.jsx("span",{className:"nut-log-item-name",children:te.name}),te.serving&&a.jsx("span",{className:"nut-log-item-serving",children:te.serving})]}),a.jsxs("div",{className:"nut-log-item-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[te.protein,"p"]}),a.jsxs("span",{className:"nut-macro-c",children:[te.carbs,"c"]}),a.jsxs("span",{className:"nut-macro-f",children:[te.fats,"f"]}),a.jsx("span",{className:"nut-macro-cal",children:te.calories})]}),Fe&&a.jsx("button",{className:"nut-log-delete",onClick:()=>Rt(te.id),"aria-label":"Remove",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},te.id))}),C.length===0&&a.jsx("div",{className:"nut-meal-empty",children:a.jsx("p",{children:Fe?"Tap + to add food":"No entries"})})]},T.key)})})})]})}),We&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"nut-add-picker-backdrop",onClick:()=>wt(null)}),a.jsxs("div",{className:"nut-add-picker",children:[a.jsx("div",{className:"nut-add-picker-handle"}),a.jsxs("h3",{className:"nut-add-picker-title",children:["Add to ",m2.find(T=>T.key===We)?.label]}),a.jsxs("div",{className:"nut-add-picker-options",children:[a.jsxs("button",{onClick:()=>{const T=We;wt(null),Ds(T,"scan")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),a.jsx("span",{children:"Scan Barcode"})]}),a.jsxs("button",{onClick:()=>{const T=We;wt(null),Ds(T,"search")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Search Food"})]}),a.jsxs("button",{onClick:()=>{const T=We;wt(null),Ds(T,"manual")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),a.jsx("span",{children:"Manual Entry"})]}),a.jsxs("button",{onClick:()=>{const T=We;wt(null),Ds(T,"favourites")},children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),a.jsx("span",{children:"Favourites"})]})]})]})]}),j&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>R(!1),children:a.jsxs("div",{className:"nut-water-popup",onClick:T=>T.stopPropagation(),children:[a.jsxs("div",{className:"nut-water-popup-header",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"20",height:"20",style:{color:"#2196f3"},children:a.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),a.jsx("span",{children:"Water Intake"}),a.jsx("button",{className:"nut-modal-close",onClick:()=>R(!1),children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsxs("div",{className:"nut-water-popup-body",children:[a.jsx("div",{className:"nut-water-glasses",children:[...Array(w?.waterGoal||8)].map((T,C)=>a.jsx("div",{className:`nut-water-glass ${C<J.water?"filled":""}`,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:C<J.water?"currentColor":"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})})},C))}),a.jsxs("div",{className:"nut-water-popup-count",children:[J.water," / ",w?.waterGoal||8," glasses"]}),a.jsxs("div",{className:"nut-water-btns",children:[a.jsx("button",{onClick:At,disabled:J.water<=0,children:"-"}),a.jsx("button",{onClick:st,children:"+"})]})]})]})}),Q&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>{An(),L(null),je(null),En(null)},children:a.jsxs("div",{className:"nut-modal",onClick:T=>T.stopPropagation(),children:[a.jsxs("div",{className:"nut-modal-header",children:[a.jsx("h3",{children:Q==="scan"?"Scan Barcode":Q==="search"?"Search Food":Q==="favourites"?"Favourites":"Manual Entry"}),a.jsx("button",{className:"nut-modal-close",onClick:()=>{An(),L(null),je(null),En(null)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),Q==="scan"&&!oe&&a.jsxs("div",{className:"nut-scan-area",children:[a.jsxs("div",{className:"nut-scanner-wrapper",children:[a.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),ze&&!ie&&a.jsx("div",{className:"nut-scan-line"}),ie&&a.jsxs("div",{className:"nut-scan-detected-overlay",children:[a.jsx("svg",{className:"nut-scan-detected-tick",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),a.jsx("p",{className:"nut-scan-detected-label",children:"Barcode found!"}),a.jsx("p",{className:"nut-scan-detected-code",children:ie})]})]}),!ze&&a.jsxs("button",{className:"nut-scan-start-btn",onClick:Vn,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),ze&&!ie&&a.jsx("p",{className:"nut-scan-hint",children:"Align barcode within the frame"}),a.jsx("div",{className:"nut-barcode-divider",children:a.jsx("span",{children:"or enter barcode manually"})}),a.jsxs("div",{className:"nut-barcode-manual",children:[a.jsx("input",{type:"text",inputMode:"numeric",value:H,onChange:T=>ye(T.target.value),onKeyDown:T=>T.key==="Enter"&&H.trim()&&we(H.trim()),placeholder:"Enter barcode number"}),a.jsx("button",{onClick:()=>H.trim()&&we(H.trim()),disabled:!H.trim()||Se,children:Se?"...":"Look Up"})]})]}),Q==="scan"&&oe&&(()=>{const T=oe.servingUnit||"g",C=oe.portion,K=et==="portion"&&C?Bt*C.weight:parseFloat(Ht)||0,te=K/100,He=T==="ml"?[100,200,250,500]:[50,100,150,200],Ue=et==="portion"&&C?`${Bt} ${C.label}${Bt!==1?"s":""} (${Math.round(K)}${T})`:`${Math.round(K)}${T}`;return a.jsxs("div",{className:"nut-product-result",children:[oe.image&&a.jsx("img",{src:oe.image,alt:oe.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:oe.name}),a.jsx("button",{className:`nut-fav-star confirm${Xe(oe.name)?" active":""}`,onClick:()=>dt({name:oe.name,protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories,serving:oe.servingSize,per100g:{protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories},servingUnit:oe.servingUnit||"g",portion:oe.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:Xe(oe.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),oe.brand&&a.jsx("p",{className:"nut-product-brand",children:oe.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",T,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[oe.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[oe.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[oe.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[oe.calories," cal"]})]}),C&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:et==="portion"?"active":"",onClick:()=>{tn("portion"),Bt<1&&ht(1)},children:"Portions"}),a.jsxs("button",{className:et==="weight"?"active":"",onClick:()=>{tn("weight"),St(String(Math.round(K)||100))},children:["Custom (",T,")"]})]}),et==="portion"&&C?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ht(Math.max(1,Bt-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:Bt}),a.jsxs("span",{className:"nut-stepper-label",children:[C.label,Bt!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(K),T]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ht(Bt+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",T,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:Ht,onChange:Oe=>St(Oe.target.value),onFocus:Oe=>Oe.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:He.map(Oe=>a.jsxs("button",{className:`nut-quick-btn${Ht===String(Oe)?" active":""}`,onClick:()=>St(String(Oe)),children:[Oe,T]},Oe))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(oe.protein*te),"p / ",Math.round(oe.carbs*te),"c / ",Math.round(oe.fats*te),"f / ",Math.round(oe.calories*te)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>{En(null),je("scan")},children:"Scan Again"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Ft({name:oe.name,protein:Math.round(oe.protein*te),carbs:Math.round(oe.carbs*te),fats:Math.round(oe.fats*te),calories:Math.round(oe.calories*te),serving:Ue}),children:"Add"})]})]})})(),Q==="search"&&!oe&&a.jsxs("div",{className:"nut-search-area",children:[a.jsxs("div",{className:"nut-search-bar",children:[a.jsx("input",{type:"text",ref:Nn,value:Ae,onChange:T=>nt(T.target.value),onKeyDown:T=>{T.key==="Enter"&&(clearTimeout(Kt.current),ge())},onFocus:()=>setTimeout(()=>Nn.current?.scrollIntoView({behavior:"smooth",block:"center"}),350),placeholder:"Search food or product...",autoFocus:!0}),a.jsx("button",{onClick:ge,disabled:qt,children:qt?"...":"Search"})]}),a.jsxs("div",{className:"nut-search-results",children:[pt.map((T,C)=>a.jsxs("button",{className:"nut-search-item",onClick:()=>{En(T),T.portion?(ht(1),St(String(T.portion.weight)),tn("portion")):(ht(0),St(String(T.servingValue||100)),tn("weight"))},children:[T.image&&a.jsx("img",{src:T.image,alt:T.name||"Product",loading:"lazy"}),a.jsxs("div",{className:"nut-search-item-info",children:[a.jsx("span",{className:"nut-search-item-name",children:T.name}),T.brand&&a.jsx("span",{className:"nut-search-item-brand",children:T.brand}),a.jsxs("span",{className:"nut-search-item-macros",children:[T.calories," cal  ",T.protein,"p  ",T.carbs,"c  ",T.fats,"f per 100",T.servingUnit||"g"]})]})]},C)),pt.length===0&&Ae&&!qt&&a.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]})]}),Q==="search"&&oe&&(()=>{const T=oe.servingUnit||"g",C=oe.portion,K=et==="portion"&&C?Bt*C.weight:parseFloat(Ht)||0,te=K/100,He=T==="ml"?[100,200,250,500]:[50,100,150,200],Ue=et==="portion"&&C?`${Bt} ${C.label}${Bt!==1?"s":""} (${Math.round(K)}${T})`:`${Math.round(K)}${T}`;return a.jsxs("div",{className:"nut-product-result",children:[oe.image&&a.jsx("img",{src:oe.image,alt:oe.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:oe.name}),a.jsx("button",{className:`nut-fav-star confirm${Xe(oe.name)?" active":""}`,onClick:()=>dt({name:oe.name,protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories,serving:oe.servingSize,per100g:{protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories},servingUnit:oe.servingUnit||"g",portion:oe.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:Xe(oe.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),oe.brand&&a.jsx("p",{className:"nut-product-brand",children:oe.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",T,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[oe.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[oe.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[oe.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[oe.calories," cal"]})]}),C&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:et==="portion"?"active":"",onClick:()=>{tn("portion"),Bt<1&&ht(1)},children:"Portions"}),a.jsxs("button",{className:et==="weight"?"active":"",onClick:()=>{tn("weight"),St(String(Math.round(K)||100))},children:["Custom (",T,")"]})]}),et==="portion"&&C?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ht(Math.max(1,Bt-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:Bt}),a.jsxs("span",{className:"nut-stepper-label",children:[C.label,Bt!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(K),T]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ht(Bt+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",T,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:Ht,onChange:Oe=>St(Oe.target.value),onFocus:Oe=>Oe.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:He.map(Oe=>a.jsxs("button",{className:`nut-quick-btn${Ht===String(Oe)?" active":""}`,onClick:()=>St(String(Oe)),children:[Oe,T]},Oe))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(oe.protein*te),"p / ",Math.round(oe.carbs*te),"c / ",Math.round(oe.fats*te),"f / ",Math.round(oe.calories*te)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>En(null),children:"Back to Search"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Ft({name:oe.name,protein:Math.round(oe.protein*te),carbs:Math.round(oe.carbs*te),fats:Math.round(oe.fats*te),calories:Math.round(oe.calories*te),serving:Ue}),children:"Add"})]})]})})(),Q==="manual"&&a.jsxs("div",{className:"nut-manual-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Food Name"}),a.jsx("input",{type:"text",value:Nt.name,onChange:T=>Ct(C=>({...C,name:T.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Serving Size (optional)"}),a.jsx("input",{type:"text",value:Nt.serving,onChange:T=>Ct(C=>({...C,serving:T.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),a.jsxs("div",{className:"nut-manual-macros",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Protein (g)"}),a.jsx("input",{type:"number",value:Nt.protein,onChange:T=>Ct(C=>({...C,protein:T.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Carbs (g)"}),a.jsx("input",{type:"number",value:Nt.carbs,onChange:T=>Ct(C=>({...C,carbs:T.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fats (g)"}),a.jsx("input",{type:"number",value:Nt.fats,onChange:T=>Ct(C=>({...C,fats:T.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Calories"}),a.jsx("input",{type:"number",value:Nt.calories,onChange:T=>Ct(C=>({...C,calories:T.target.value})),min:"0"})]})]}),a.jsx("button",{className:"nut-btn-primary",disabled:!Nt.name.trim(),onClick:()=>Ft({name:Nt.name,protein:parseFloat(Nt.protein)||0,carbs:parseFloat(Nt.carbs)||0,fats:parseFloat(Nt.fats)||0,calories:parseFloat(Nt.calories)||0,serving:Nt.serving||""}),children:"Add Food"})]}),Q==="favourites"&&!oe&&(()=>{const T=Qe(),C=K=>{if(K.per100g){const te=K.per100g;En({name:K.name,brand:"",image:null,servingSize:K.serving||"100g",servingValue:100,servingUnit:K.servingUnit||"g",portion:K.portion||null,protein:te.protein,carbs:te.carbs,fats:te.fats,calories:te.calories,per100g:!0}),K.portion?(ht(1),St(String(K.portion.weight)),tn("portion")):(ht(0),St("100"),tn("weight"))}else Ft({name:K.name,protein:K.protein,carbs:K.carbs,fats:K.fats,calories:K.calories,serving:K.serving||""})};return a.jsx("div",{className:"nut-recent-area",children:T.length===0?a.jsx("p",{className:"nut-search-empty",children:"No favourites yet. Tap the star on any food to save it here."}):a.jsx("div",{className:"nut-recent-list",children:T.map((K,te)=>a.jsxs("div",{className:"nut-recent-item-row",children:[a.jsx("button",{className:"nut-fav-star active",onClick:He=>{He.stopPropagation(),dt(K)},children:a.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("button",{className:"nut-recent-item",onClick:()=>C(K),children:[a.jsxs("div",{className:"nut-recent-item-info",children:[a.jsx("span",{className:"nut-recent-item-name",children:K.name}),a.jsx("span",{className:"nut-recent-item-serving",children:K.serving||""})]}),a.jsxs("span",{className:"nut-recent-item-macros",children:[K.calories," cal"]})]})]},te))})})})(),Q==="favourites"&&oe&&(()=>{const T=oe.servingUnit||"g",C=oe.portion,K=et==="portion"&&C?Bt*C.weight:parseFloat(Ht)||0,te=K/100,He=T==="ml"?[100,200,250,500]:[50,100,150,200],Ue=et==="portion"&&C?`${Bt} ${C.label}${Bt!==1?"s":""} (${Math.round(K)}${T})`:`${Math.round(K)}${T}`;return a.jsxs("div",{className:"nut-product-result",children:[a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:oe.name}),a.jsx("button",{className:`nut-fav-star confirm${Xe(oe.name)?" active":""}`,onClick:()=>dt({name:oe.name,protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories,serving:oe.servingSize,per100g:{protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories},servingUnit:oe.servingUnit||"g",portion:oe.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:Xe(oe.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",T,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[oe.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[oe.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[oe.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[oe.calories," cal"]})]}),C&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:et==="portion"?"active":"",onClick:()=>{tn("portion"),Bt<1&&ht(1)},children:"Portions"}),a.jsxs("button",{className:et==="weight"?"active":"",onClick:()=>{tn("weight"),St(String(Math.round(K)||100))},children:["Custom (",T,")"]})]}),et==="portion"&&C?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ht(Math.max(1,Bt-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:Bt}),a.jsxs("span",{className:"nut-stepper-label",children:[C.label,Bt!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(K),T]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ht(Bt+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",T,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:Ht,onChange:Oe=>St(Oe.target.value),onFocus:Oe=>Oe.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:He.map(Oe=>a.jsxs("button",{className:`nut-quick-btn${Ht===String(Oe)?" active":""}`,onClick:()=>St(String(Oe)),children:[Oe,T]},Oe))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(oe.protein*te),"p / ",Math.round(oe.carbs*te),"c / ",Math.round(oe.fats*te),"f / ",Math.round(oe.calories*te)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>En(null),children:"Back to Favourites"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Ft({name:oe.name,protein:Math.round(oe.protein*te),carbs:Math.round(oe.carbs*te),fats:Math.round(oe.fats*te),calories:Math.round(oe.calories*te),serving:Ue}),children:"Add"})]})]})})()]})}),a.jsx(Ma,{active:"nutrition"}),Et&&a.jsx("div",{className:`toast-notification ${Et.type}`,children:Et.message})]})}const p2="/login/assets/randomiser-glq9YJkL.jpg",H3="/login/assets/programme-card-workout-CnNzTYkz.webp",$3="/login/assets/prog-fullbody-4wk-r6m9HJys.jpg",W3="/login/assets/mg-arms-BeOQU3wx.jpg",G3=60,zp=5,K3=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],Y3={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Squeeze Press":"push","Incline Dumbbell Press":"push","Dumbbell Fly":"push","Dumbbell Pullover":"push","Tricep Kickback":"push","Dumbbell Shrug":"push","Dumbbell Y-Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Wide Dumbbell Bent Over Row":"pull","Reverse Fly":"pull","Concentration Curl":"pull","Wide Grip Bicep Curl":"pull","Wrist Curl":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core","Kettlebell Bird Dog Drag":"core"},Q3={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},X3={fullbody:"linear-gradient(160deg, rgba(153,49,60,0.15) 0%, rgba(153,49,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",upper:"linear-gradient(160deg, rgba(100,60,140,0.2) 0%, rgba(100,60,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",lower:"linear-gradient(160deg, rgba(40,120,80,0.2) 0%, rgba(40,120,80,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)"},Fp={arms:"linear-gradient(160deg, rgba(180,60,60,0.2) 0%, rgba(180,60,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",chest:"linear-gradient(160deg, rgba(50,100,160,0.2) 0%, rgba(50,100,160,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",back:"linear-gradient(160deg, rgba(80,130,60,0.2) 0%, rgba(80,130,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",shoulders:"linear-gradient(160deg, rgba(160,100,40,0.2) 0%, rgba(160,100,40,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",legs:"linear-gradient(160deg, rgba(100,50,140,0.2) 0%, rgba(100,50,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)"},qp=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,level:"All Levels",daysPerWeek:3,image:$3},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,level:"Intermediate",daysPerWeek:3},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,level:"Advanced",daysPerWeek:3},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,level:"Beginner",daysPerWeek:3},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,level:"Intermediate",daysPerWeek:3},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,level:"Advanced",daysPerWeek:3},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,level:"Intermediate",daysPerWeek:3},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,level:"Intermediate",daysPerWeek:3}],$c=[{key:"arms",label:"Arms",icon:"M7 5h2v14H7V5zm8 0h2v14h-2V5zm-5 4h4v6h-4V9z",image:W3},{key:"chest",label:"Chest",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-2h2v2zm4 0h-2v-2h2v2zm3-6c0 1.1-.36 2.12-.97 2.95l-.87-.87C16.7 12.53 17 11.8 17 11c0-2.76-2.24-5-5-5S7 8.24 7 11c0 .8.3 1.53.84 2.08l-.87.87A4.977 4.977 0 0 1 6 11c0-3.31 2.69-6 6-6s6 2.69 6 6z"},{key:"back",label:"Back",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm4 18H8v-6l-4-4 1.41-1.41L8 11.17V8h8v3.17l2.59-2.58L20 10l-4 4v6z"},{key:"shoulders",label:"Shoulders",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"legs",label:"Legs",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}],g2={chest:[{id:"chest_strength",name:"Chest Strength",desc:"Heavy pressing for max strength",level:"Intermediate",overview:"A heavy pressing session designed to build raw chest strength. Focus on controlled negatives and powerful pressing movements.",tips:["Go heavy  pick a weight where the last 2 reps are a real challenge","Control the negative (lowering phase) for 2-3 seconds","Keep your shoulder blades squeezed together throughout all pressing movements","Rest 90-120 seconds between sets to allow full recovery"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Squeeze Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"chest_hypertrophy",name:"Chest Hypertrophy",desc:"Volume training for muscle growth",level:"Intermediate",overview:"A high-volume chest session focused on time under tension and muscle growth. Lighter weights, more reps, and slow controlled movements.",tips:["Use moderate weight  you should feel the burn by rep 10","Squeeze your chest at the top of every rep for 1 second","Keep rest periods short at 60-90 seconds to keep the pump going","On press ups, go to failure on the final set"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Press Up",type:"reps",sets:3,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"}]},{id:"chest_endurance",name:"Chest Endurance",desc:"Bodyweight pushing to failure",level:"All Levels",overview:"No weights needed. This bodyweight-only session builds chest endurance and muscular stamina through high-rep push up variations.",tips:["Focus on full range of motion  chest to floor on every rep","Keep your core tight and body in a straight line throughout","Scale down to knee press ups if you can't maintain form","Push through the burn  the last 5 reps are where the growth happens"],exercises:[{name:"Press Up",type:"reps",sets:4,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null},{name:"Decline Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Press Up Hold",type:"timed",sets:3,time:30,storagePath:null}]}],back:[{id:"back_strength",name:"Back Strength",desc:"Heavy rows for a thick back",level:"Intermediate",overview:"Build a thick, powerful back with heavy rowing movements. This session targets your lats, rhomboids, and traps for overall back development.",tips:["Go heavy on rows  use a weight that challenges you by rep 6-8","Drive your elbows back and squeeze your shoulder blades together at the top","Keep a slight bend in your knees and hinge at the hips for bent over movements","Rest 90-120 seconds between sets for full recovery"],exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"back_hypertrophy",name:"Back Hypertrophy",desc:"Width and thickness volume work",level:"Intermediate",overview:"A volume-focused back session combining rows and isolation moves to build width and thickness. Focus on the mind-muscle connection.",tips:["Use moderate weight  feel the stretch and squeeze on every rep","On renegade rows, keep your hips square to the floor and avoid rotating","For reverse flys, use lighter weight and focus on squeezing your rear delts","Keep rest to 60-90 seconds to maintain intensity"],exercises:[{name:"Renegade Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Reverse Fly",type:"weighted",sets:3,reps:15,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null}]},{id:"back_endurance",name:"Back Endurance",desc:"Bodyweight back conditioning",level:"All Levels",overview:"A bodyweight session to strengthen your posterior chain and improve posture. Great for back health, mobility, and muscular endurance.",tips:["On superman holds, lift your arms and legs simultaneously and hold tight","Focus on slow, controlled movements  quality over speed","Breathe steadily throughout timed holds  don't hold your breath","Engage your glutes and lower back together on every movement"],exercises:[{name:"Superman Hold",type:"timed",sets:4,time:30,storagePath:"exercises/bodyweight/upper/Superman Hold.mp4"},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:12,storagePath:null},{name:"Reverse Snow Angel",type:"reps",sets:3,reps:12,storagePath:null},{name:"Bird Dog",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Back Extension Hold",type:"timed",sets:3,time:30,storagePath:null}]}],shoulders:[{id:"shoulders_strength",name:"Shoulder Strength",desc:"Heavy pressing for boulder shoulders",level:"Intermediate",overview:"A heavy overhead pressing session to build strong, powerful shoulders. Compound movements first, followed by isolation work for all three delt heads.",tips:["Go heavy on presses  pick a weight where you struggle on the last 2 reps","Brace your core and avoid arching your back during overhead movements","Press straight up and control the weight down slowly","Rest 90-120 seconds between pressing sets, 60 seconds for isolation moves"],exercises:[{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"shoulders_hypertrophy",name:"Shoulder Hypertrophy",desc:"Volume and isolation for 3D delts",level:"Intermediate",overview:"A high-volume session targeting all three heads of the deltoid for that 3D capped shoulder look. Moderate weight, high reps, constant tension.",tips:["Use lighter weight than you think  shoulders respond best to high reps","On lateral raises, lead with your elbows and don't swing the weight","Pause at the top of each raise for a 1-second squeeze","Keep rest periods at 60 seconds to maximise the pump"],exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Y-Raise",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"shoulders_endurance",name:"Shoulder Endurance",desc:"Bodyweight and high-rep work",level:"All Levels",overview:"A shoulder endurance session combining bodyweight movements with high-rep dumbbell work. Builds stamina, stability, and shoulder resilience.",tips:["On pike push ups, walk your feet close to your hands to increase the angle","For high-rep lateral raises, use a very light weight and focus on form","Wall walks are advanced  scale to pike push ups if needed","Keep your core braced throughout to protect your lower back"],exercises:[{name:"Pike Push Ups",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/upper/pike push ups.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,reps:20,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Wall Walks",type:"reps",sets:3,reps:6,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null},{name:"Shoulder Tap Hold",type:"timed",sets:3,time:30,storagePath:null}]}],arms:[{id:"arms_bicep",name:"Bicep Focus",desc:"Curl variations for peak biceps",level:"All Levels",overview:"An arm session dedicated entirely to biceps. Multiple curl variations target different parts of the bicep for maximum peak and thickness.",tips:["Keep your elbows pinned to your sides  no swinging","Control the negative (lowering) for 2-3 seconds on every rep","Start with your heaviest weight and decrease as you fatigue","Squeeze hard at the top of each curl for a full contraction"],exercises:[{name:"Bicep Curl",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Concentration Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Isometric Bicep Hold",type:"timed",sets:3,time:20,storagePath:null}]},{id:"arms_tricep",name:"Tricep Focus",desc:"Extensions and dips for horseshoe triceps",level:"All Levels",overview:"All-out tricep training with extensions, dips, and pressing movements. The triceps make up two-thirds of your arm  this session builds serious size.",tips:["On overhead extensions, keep your elbows close to your head","For skullcrushers, lower the weight slowly to just above your forehead","On dips, lean slightly forward to reduce shoulder strain","Full lockout at the top of every extension for maximum tricep contraction"],exercises:[{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Tricep Dips",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null}]},{id:"arms_full",name:"Full Arms",desc:"Superset biceps and triceps",level:"All Levels",overview:"A balanced arm session alternating between biceps and triceps. Superset style keeps the intensity high and maximises the pump.",tips:["Superset each pair  do biceps then immediately hit triceps","Use moderate weight that lets you maintain strict form for all reps","Rest 60 seconds after each superset pair","Focus on the squeeze at the peak contraction of every rep"],exercises:[{name:"Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Wrist Curl",type:"weighted",sets:3,reps:15,storagePath:null}]}],legs:[{id:"legs_quad",name:"Quad Dominant",desc:"Squats and lunges for quad power",level:"All Levels",overview:"A quad-focused leg session built around squats and lunges. Heavy compound movements to build strong, powerful quads and overall leg strength.",tips:["On goblet squats, hold the dumbbell close to your chest and sit deep","Keep your knees tracking over your toes  don't let them cave inward","Drive through your heels on all squatting movements","Rest 90-120 seconds between heavy sets, 60 seconds on bodyweight moves"],exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/lower/bulgarian split squats.mp4"},{name:"Squat And Hold",type:"timed",sets:3,time:30,storagePath:"exercises/bodyweight/lower/squat and hold.mp4"}]},{id:"legs_ham_glute",name:"Hamstring & Glute",desc:"Posterior chain focus",level:"Intermediate",overview:"Target the back of your legs with deadlift and hip hinge variations. This session builds a strong posterior chain  hamstrings, glutes, and lower back.",tips:["On RDLs, push your hips back and feel the stretch in your hamstrings","Keep a slight bend in your knees throughout hip hinge movements","Squeeze your glutes hard at the top of every rep","For single leg work, start with your weaker side first"],exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/romanian deadlifts.mp4"},{name:"1 Legged RDL",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.mp4"},{name:"Hip Thrusts",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/hip thrusts.mp4"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.mp4"},{name:"Donkey Kicks",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.mp4"}]},{id:"legs_power",name:"Power & Plyo",desc:"Explosive leg training",level:"Intermediate",overview:"An explosive leg session combining plyometrics with weighted movements. Build power, speed, and athletic performance.",tips:["On jump squats, land softly with bent knees to absorb the impact","Explode up on every rep  power comes from speed, not just weight","Keep rest periods at 60-90 seconds to maintain intensity","Focus on landing mechanics  knees out, chest up, soft landing"],exercises:[{name:"Jump Squats",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/lower/jump squats.mp4"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Skater Jumps",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/skater jumps.mp4"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.mp4"}]}],core:[{id:"core_lower_abs",name:"Lower Abs Blast",desc:"40s work / 20s rest  3 rounds",level:"Intermediate",overview:"An interval-based core burner targeting the lower abdominals. 40 seconds of work followed by 20 seconds of rest  keep the intensity high and your lower back pressed into the floor throughout.",tips:["Press your lower back firmly into the floor on every rep","Exhale hard as you contract your abs  don't hold your breath","If your lower back lifts off the ground, reduce the range of motion","Focus on slow, controlled movements rather than speed"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Leg Raises",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Reverse Crunch To Leg Raise",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Flutter Kicks",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Dead Bug Single Leg Drop",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Hollow Hold Flutter Kicks",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"}]},{id:"core_obliques",name:"Obliques & Rotation",desc:"35s work / 25s rest  3 rounds",level:"Intermediate",overview:"Target the obliques and rotational core muscles with this interval session. 35 seconds of work with 25 seconds rest  every exercise involves twisting, rotating, or side-bracing movements.",tips:["Rotate from your ribcage, not just your arms","Keep your hips as still as possible during twisting exercises","Brace your core before each movement  think about squeezing a belt","On side planks, stack your hips and push the floor away"],interval:!0,rounds:3,work:35,rest:25,exercises:[{name:"Russian Twist",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank Rotation",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Cross Body Mountain Climbers",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Hip Dips Plank",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Bicycle Crunch",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank",storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{id:"core_weighted",name:"Weighted Core",desc:"40s work / 20s rest  3 rounds",level:"Advanced",overview:"Add resistance to your core training with dumbbells and kettlebells. 40 seconds of weighted work followed by 20 seconds rest  this session builds serious core strength and stability.",tips:["Start with a moderate weight  form is more important than load","Brace your entire core before picking up the weight each round","Keep movements controlled  no swinging or using momentum","If grip fails before core does, go slightly lighter next time"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Russian Twists Dumbbell",storagePath:"exercises/dumbbells/core/russian twists dumbbell.mp4"},{name:"Kettlebell Russian Twist",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Dumbbell Plank Pull Through",storagePath:null}]}]},y2=[{key:"bodyweight",label:"Bodyweight",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"},{key:"dumbbells",label:"Dumbbells",icon:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"},{key:"kettlebells",label:"Kettlebells",icon:"M12 2C9.24 2 7 4.24 7 7c0 1.1.36 2.12.97 2.95C6.76 11.08 6 12.96 6 15c0 3.87 2.69 7 6 7s6-3.13 6-7c0-2.04-.76-3.92-1.97-5.05.61-.83.97-1.85.97-2.95 0-2.76-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}],Hp=[{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"},{key:"upper",label:"Upper",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"lower",label:"Lower",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"fullbody",label:"Full Body",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z"},{key:"mix",label:"Mix It Up",icon:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm-.83 9.41l-1.42 1.42L17.96 20.54l1.42-1.42-5.71-5.71z"}],Sl=[{key:"beginner",label:"Beginner",work:30,rest:30,desc:"30s work / 30s rest"},{key:"intermediate",label:"Intermediate",work:40,rest:20,desc:"40s work / 20s rest"},{key:"advanced",label:"Advanced",work:40,rest:15,desc:"40s work / 15s rest"}],J3=[5,10,15,20,30];function Z3(s){return s.replace(/\b\w/g,e=>e.toUpperCase())}function eD(s){const e=[...s];for(let n=e.length-1;n>0;n--){const i=Math.floor(Math.random()*(n+1));[e[n],e[i]]=[e[i],e[n]]}return e}function tD(){const{currentUser:s,isClient:e,clientData:n,loading:i}=Xr(),{isDark:l,toggleTheme:u,accent:h}=Pa(),p=Zs(),[g,y]=x.useState("menu"),[w,k]=x.useState(["bodyweight"]),[E,O]=x.useState("core"),[G,U]=x.useState("intermediate"),[V,ne]=x.useState(15),[J,fe]=x.useState([]),[Te,$e]=x.useState(!1),Ve=x.useRef(!1),I=x.useRef([]),[j,R]=x.useState([]),[P,D]=x.useState(2),[z,M]=x.useState(Sl[1]),[We,wt]=x.useState(1),[Q,je]=x.useState(0),[ze,lt]=x.useState("work"),[ie,L]=x.useState(0),[H,ye]=x.useState(!1),[Se,qe]=x.useState(0),[Ae,nt]=x.useState(null),pt=x.useRef(null);x.useRef(null),x.useRef(null);const[Je,qt]=x.useState(null),cn=x.useCallback(($,he="info")=>{qt({message:$,type:he}),setTimeout(()=>qt(null),3e3)},[]),[Nt,Ct]=x.useState(null),[oe,En]=x.useState(null),[Ht,St]=x.useState(0),[Bt,ht]=x.useState(0),[et,tn]=x.useState([]),[ss,Pt]=x.useState(""),[Et,Ln]=x.useState(""),[zt,Sn]=x.useState(!1),[Kt,Nn]=x.useState(0),[me,Ee]=x.useState(!1),[Fe,Ye]=x.useState({}),Be=x.useRef(null),Me=x.useRef(null),[Le,xt]=x.useState([]),[mt,Y]=x.useState(null),[Ne,Qe]=x.useState(0),[Xe,dt]=x.useState(0),[Ft,Rt]=x.useState(0),[nn,Vn]=x.useState(0),[An,rn]=x.useState(0),[yn,In]=x.useState(0),[un,rs]=x.useState({beginner:0,intermediate:0,advanced:0}),[q,pe]=x.useState(null),[we,ve]=x.useState(""),[ge,st]=x.useState(!1);x.useEffect(()=>{!i&&(!s||!e)&&p("/")},[s,e,i,p]),x.useEffect(()=>{if(!s||!n)return;(async()=>{try{const he=Qt(be,"workoutLogs"),ae=Pn(he,fn("clientId","==",n.id)),Pe=(await jn(ae)).docs.map(wn=>wn.data()),rt=Pe.filter(wn=>wn.type!=="programme");Vn(rt.length);const It=rt.reduce((wn,Jn)=>wn+(Jn.duration||0),0);rn(It);const ot={beginner:0,intermediate:0,advanced:0};rt.forEach(wn=>{wn.level&&ot[wn.level]!==void 0&&ot[wn.level]++}),rs(ot);const an=new Date,Un=an.getDay(),bn=Un===0?-6:1-Un,xn=new Date(an);xn.setDate(an.getDate()+bn),xn.setHours(0,0,0,0);const xr=xn.getTime(),La=Pe.filter(wn=>{const Jn=wn.completedAt;return Jn?(Jn.toDate?Jn.toDate().getTime():new Date(Jn).getTime())>=xr:!1});Qe(La.filter(wn=>wn.type!=="programme").length);let Jr=0;if(n)try{const wn=await qn(Ke(be,"clientProgrammes",n.id));if(wn.exists()){const Jn=wn.data(),Kn=Jn.templateId;Jr=La.filter(As=>As.type==="programme"&&As.programmeId===Kn).length,pe(Kn);const _r=qp.find(As=>As.id===Kn);_r&&ve(_r.name);const cr=Q3[Kn];if(cr){const As=Object.keys(Jn.completedSessions||{}).length,Ps=cr.duration*cr.daysPerWeek;Rt(Ps>0?Math.round(As/Ps*100):0)}}else pe(null),ve(""),Rt(0)}catch{}dt(Jr);const wr=rt.map(wn=>wn.completedAt).filter(Boolean).map(wn=>wn.toDate?wn.toDate().getTime():new Date(wn).getTime()).sort((wn,Jn)=>Jn-wn);if(wr.length===0)In(0);else{const wn=new Set;wr.forEach(Ps=>{const Lr=new Date(Ps),kr=Lr.getDay(),pa=kr===0?-6:1-kr,A=new Date(Lr);A.setDate(Lr.getDate()+pa),A.setHours(0,0,0,0),wn.add(A.getTime())});const Jn=[...wn].sort((Ps,Lr)=>Lr-Ps);let Kn=0;const _r=new Date(an),cr=an.getDay()===0?-6:1-an.getDay();_r.setDate(an.getDate()+cr),_r.setHours(0,0,0,0);let As=_r.getTime();Jn.includes(As)||(As-=10080*60*1e3);for(let Ps=0;Ps<200&&Jn.includes(As);Ps++)Kn++,As-=10080*60*1e3;In(Kn)}}catch(he){console.error("Error loading workout stats:",he)}finally{st(!0)}})()},[s,n,g]);const At=()=>{const $=[];let he;E==="mix"?he=["core","upper","lower"]:E==="fullbody"?he=["upper","lower"]:he=[E];for(const ae of w)for(const Ce of he)$.push(`exercises/${ae}/${Ce}`);return $},ct=async()=>{if(Ve.current){for(;Ve.current;)await new Promise($=>setTimeout($,200));return I.current}Ve.current=!0,$e(!0);try{const $=At(),he=[];for(const rt of $)try{const It=Gi(Ki,rt),ot=await d2(It);he.push(...ot.items)}catch{console.warn(`Folder ${rt} not found, skipping.`)}if(he.length===0&&w.includes("bodyweight")&&E==="core")try{const rt=Gi(Ki,"core"),It=await d2(rt);he.push(...It.items)}catch{console.warn("Legacy core/ folder not found either.")}if(he.length===0){const rt=w.map(ot=>y2.find(an=>an.key===ot)?.label).join(" + "),It=Hp.find(ot=>ot.key===E)?.label;return cn(`No exercises found for ${rt} / ${It}. Upload videos to Firebase Storage.`,"error"),Ve.current=!1,$e(!1),[]}const ae=new Set,Ce=he.filter(rt=>{const It=rt.name.replace(/\.(mp4|gif)$/i,"");return ae.has(It)?!1:(ae.add(It),!0)}),Pe=await Promise.all(Ce.map(async rt=>{const It=await Oo(rt),ot=Z3(rt.name.replace(/\.(mp4|gif)$/i,"")),an=/\.gif$/i.test(rt.name);return{name:ot,videoUrl:It,isGif:an}}));return I.current=Pe,fe(Pe),Ve.current=!1,$e(!1),Pe}catch($){console.error("Error loading exercises:",$);const he=$.code==="storage/unauthorized"?"Storage access denied. Check Firebase Storage rules allow read access.":`Failed to load exercises: ${$.message||$.code||"Unknown error"}`;return cn(he,"error"),Ve.current=!1,$e(!1),[]}},_t=async()=>{y("spinning"),I.current=[];const $=await ct();if($.length===0){y("setup");return}const he=Sl.find(Un=>Un.key===G);M(he);const ae=he.work+he.rest,Ce=V*60,Pe=Math.floor(Ce/ae);let rt,It;Pe<=6?(rt=Math.max(3,Math.floor(Pe/2)),It=Math.floor(Pe/rt)):Pe<=12?(rt=Math.min(6,Math.floor(Pe/2)),It=Math.floor(Pe/rt)):(rt=Math.min(10,Math.floor(Pe/2)),It=Math.floor(Pe/rt)),It=Math.max(2,It);const ot=eD($),an=ot.slice(0,Math.min(rt,ot.length));R(an),D(It),setTimeout(()=>y("preview"),2e3)},vt=()=>{y("countdown"),qe(3)};x.useEffect(()=>{if(g!=="countdown")return;if(Se<=0){y("workout"),wt(1),je(0),lt("work"),L(z.work),ye(!1),Ue();return}He();const $=setTimeout(()=>qe(he=>he-1),1e3);return()=>clearTimeout($)},[Se,g]),x.useEffect(()=>{if(g!=="workout"||H)return;if(ie<=0){vn();return}ie<=3&&He();const $=setTimeout(()=>L(he=>he-1),1e3);return()=>clearTimeout($)},[ie,g,H]);const vn=()=>{if(ze==="work")lt("rest"),L(z.rest);else{const $=Q+1;if($>=j.length){const he=We+1;if(he>P){y("complete"),er();return}wt(he),je(0)}else je($);lt("work"),L(z.work),Ue()}},er=async()=>{if(s)try{await ri(Qt(be,"workoutLogs"),{clientId:n.id,level:G,duration:V,equipment:w,focus:E,exerciseCount:j.length,rounds:P,exercises:j.map($=>$.name),completedAt:bt.now()}),Qe($=>$+1),Vn($=>$+1),rn($=>$+V),rs($=>({...$,[G]:($[G]||0)+1}))}catch($){console.error("Error saving workout log:",$)}},_s=async($,he,ae)=>{if(!(!n||!he))try{const Ce=n.id,Pe=await qn(Ke(be,"coreBuddyPBs",Ce)),It=(Pe.exists()?Pe.data():null)?.exercises||{},ot=It[$];let an=!1;if(ot?(he>(ot.weight||0)||he===(ot.weight||0)&&ae>(ot.reps||0))&&(an=!0):an=!0,an){const Un={...It,[$]:{weight:he,reps:ae,achievedAt:bt.now()}};await Gn(Ke(be,"coreBuddyPBs",Ce),{clientId:n.id,exercises:Un,updatedAt:bt.now()}),cn(`New PB! ${he}kg  ${ae} reps`,"success"),He(),await Ds($,he)}}catch(Ce){console.error("Error checking PB:",Ce)}},Ds=async($,he)=>{if(n)try{const ae=await qn(Ke(be,"coreBuddyTargets",n.id));if(!ae.exists())return;const Pe=(ae.data().targets||{})[$];if(!Pe||he<Pe.targetWeight)return;const rt=await qn(Ke(be,"coreBuddyAchievements",n.id)),It=rt.exists()?rt.data():{clientId:n.id,badges:[],totalVolume:0};if(It.badges.some(bn=>bn.type==="pb_target"&&bn.exercise===$&&bn.targetWeight===Pe.targetWeight))return;const an={type:"pb_target",exercise:$,group:Y3[$]||"push",targetWeight:Pe.targetWeight,achievedAt:bt.now()},Un=[...It.badges,an];await Gn(Ke(be,"coreBuddyAchievements",n.id),{...It,badges:Un,updatedAt:bt.now()}),xt(bn=>[...bn,an])}catch(ae){console.error("Error checking target badge:",ae)}},Bn=async $=>{if(!(!n||$<=0))try{const he=await qn(Ke(be,"coreBuddyAchievements",n.id)),ae=he.exists()?he.data():{clientId:n.id,badges:[],totalVolume:0},Ce=ae.totalVolume||0,Pe=Ce+$,rt=[];K3.forEach(ot=>{Pe>=ot.threshold&&Ce<ot.threshold&&(ae.badges.some(Un=>Un.type==="volume_milestone"&&Un.milestone===ot.threshold)||rt.push({type:"volume_milestone",milestone:ot.threshold,label:ot.label,achievedAt:bt.now()}))});const It=[...ae.badges,...rt];await Gn(Ke(be,"coreBuddyAchievements",n.id),{clientId:n.id,badges:It,totalVolume:Math.round(Pe),updatedAt:bt.now()}),rt.length>0&&xt(ot=>[...ot,...rt])}catch(he){console.error("Error updating volume:",he)}},F=async $=>{if(En($),$.interval){const Ce=[];for(const Pe of $.exercises){let rt=null,It=!1;if(Pe.storagePath)try{const ot=Gi(Ki,Pe.storagePath);rt=await Oo(ot),It=/\.gif$/i.test(Pe.storagePath)}catch{}Ce.push({name:Pe.name,videoUrl:rt,isGif:It})}R(Ce),D($.rounds),M({work:$.work,rest:$.rest}),y("preview");return}const he={};for(const Ce of $.exercises)if(Ce.storagePath)try{const Pe=Gi(Ki,Ce.storagePath);he[Ce.name]={url:await Oo(Pe),isGif:/\.gif$/i.test(Ce.storagePath)}}catch{}Ye(he);const ae=$.exercises.map(Ce=>({name:Ce.name,type:Ce.type,targetSets:Ce.sets,targetReps:Ce.reps||0,targetTime:Ce.time||0,sets:[]}));tn(ae),St(0),ht(0),Pt(""),Ln(""),Ee(!1),Sn(!1),Nn(0),xt([]),Y(null),y("muscle_workout")},ce=()=>{const $=Be.current;$&&($.paused?($.play(),Ee(!0)):($.pause(),Ee(!1)))};x.useEffect(()=>{if(g!=="muscle_workout"||!zt||Kt<=0){g==="muscle_workout"&&zt&&Kt<=0&&(Sn(!1),He());return}return Me.current=setTimeout(()=>Nn($=>$-1),1e3),()=>clearTimeout(Me.current)},[g,zt,Kt]);const T=async()=>{const $=et[Ht];let he={};if($.type==="weighted"){const Pe=parseFloat(ss)||0,rt=parseInt(Et)||0;if(rt===0){cn("Enter your reps","error");return}he={weight:Pe,reps:rt}}else if($.type==="reps"){const Pe=parseInt(Et)||0;if(Pe===0){cn("Enter your reps","error");return}he={reps:Pe}}else if($.type==="timed"){const Pe=$.targetTime-Kt;he={time:Math.max(Pe,1)}}const ae=[...et];ae[Ht]={...$,sets:[...$.sets,he]},tn(ae),$.type==="weighted"&&he.weight>0&&await _s($.name,he.weight,he.reps);const Ce=$.sets.length+1;if(Ce<$.targetSets)ht(Ce),Ln(""),Sn(!1),Nn(0);else if(Ht+1<et.length){const Pe=Ht+1;St(Pe),ht(0),Pt(""),Ln(""),Ee(!1),Sn(!1),Nn(0)}else await C(ae),y("muscle_complete")},C=async $=>{if(!(!s||!n))try{const he=$.reduce((Ce,Pe)=>Ce+Pe.sets.reduce((rt,It)=>rt+(It.weight||0)*(It.reps||0),0),0),ae=$.reduce((Ce,Pe)=>Ce+Pe.sets.length,0);await ri(Qt(be,"workoutLogs"),{clientId:n.id,type:"muscle_group",muscleGroup:Nt,sessionId:oe?.id,sessionName:oe?.name,exerciseCount:$.length,totalSets:ae,duration:Math.round(ae*1.5),volume:Math.round(he),exercises:$.map(Ce=>({name:Ce.name,type:Ce.type,sets:Ce.sets})),completedAt:bt.now()}),he>0&&await Bn(he),Le.length>0&&Y({badges:[...Le]})}catch(he){console.error("Error saving muscle group workout log:",he)}},K=x.useRef(null),te=()=>(K.current||(K.current=new(window.AudioContext||window.webkitAudioContext)),K.current),He=()=>{try{const $=te(),he=$.createOscillator(),ae=$.createGain();he.connect(ae),ae.connect($.destination),he.frequency.value=880,ae.gain.value=.3,he.start($.currentTime),he.stop($.currentTime+.15)}catch{}},Ue=()=>{try{const $=te(),he=$.createOscillator(),ae=$.createGain();he.connect(ae),ae.connect($.destination),he.frequency.value=1200,ae.gain.value=.4,he.start($.currentTime),he.stop($.currentTime+.3)}catch{}};x.useEffect(()=>{if(g!=="workout"||ze!=="work"||!j[Q]?.isGif)return;const he=setInterval(()=>{const ae=pt.current;if(!ae)return;const Ce=ae.getAttribute("src");ae.removeAttribute("src"),setTimeout(()=>{pt.current&&pt.current.setAttribute("src",Ce)},0)},4e3);return()=>clearInterval(he)},[g,ze,Q,We,j]);const Oe=($,he,ae)=>{const Ce=Math.round($/he*G3);return a.jsx("svg",{className:"wk-ring-svg",viewBox:"0 0 200 200",children:D3.map((Pe,rt)=>a.jsx("line",{x1:Pe.x1,y1:Pe.y1,x2:Pe.x2,y2:Pe.y2,className:rt<Ce?`wk-tick-filled ${ae}`:"wk-tick-empty",strokeWidth:Pe.thick?"3":"2"},rt))})},Ut=()=>{const $=j.length*P;return((We-1)*j.length+Q+(ze==="rest"?.5:0))/$},kt=Je&&a.jsx("div",{className:`toast-notification ${Je.type}`,children:Je.message});if(i)return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"wk-loading-inline",children:a.jsx("div",{className:"wk-loading-spinner"})})]});if(g==="menu")return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"wk-menu-heading",children:[a.jsx("h2",{children:"Choose Your Workout"}),a.jsx("p",{children:"No excuses. Just results."})]}),a.jsx("button",{className:"wk-hero-card",onClick:()=>y("setup"),children:a.jsx("img",{src:p2,alt:"Randomise Workout",className:"wk-hero-bg"})}),a.jsxs("div",{className:"wk-section-header",children:[a.jsx("h2",{children:"Programmes"}),a.jsxs("span",{className:"wk-section-count",children:[qp.length," available"]})]}),a.jsx("div",{className:"wk-prog-scroll-wrap",children:a.jsx("div",{className:"wk-prog-scroll",children:qp.map(($,he)=>$.image?a.jsxs("button",{className:"wk-prog-img-card",onClick:()=>p("/client/core-buddy/programmes",{state:{templateId:$.id}}),style:{animationDelay:`${he*.06}s`},children:[a.jsx("img",{src:$.image,alt:$.name,className:"wk-prog-img"}),he===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},$.id):a.jsxs("button",{className:"wk-prog-hero-card",onClick:()=>p("/client/core-buddy/programmes",{state:{templateId:$.id}}),style:{animationDelay:`${he*.06}s`},children:[a.jsx("img",{src:H3,alt:"Programme",className:"wk-prog-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-prog-hero-overlay",style:{background:X3[$.focus]}}),a.jsxs("div",{className:"wk-prog-hero-content",children:[a.jsxs("div",{className:"wk-prog-hero-top",children:[a.jsxs("span",{className:"wk-prog-hero-badge",children:[$.duration," WEEKS"]}),a.jsx("span",{className:"wk-prog-hero-level",children:$.level})]}),a.jsxs("div",{className:"wk-prog-hero-bottom",children:[a.jsx("h3",{children:$.name.toUpperCase()}),a.jsxs("p",{children:[$.daysPerWeek,"x per week  ",$.focus==="fullbody"?"Full Body":$.focus.charAt(0).toUpperCase()+$.focus.slice(1)," Focus"]}),a.jsx("span",{className:"wk-prog-hero-go",children:"VIEW PROGRAMME "})]})]}),he===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},$.id))})}),a.jsxs("div",{className:"wk-section-header",children:[a.jsx("h2",{children:"Muscle Groups"}),a.jsxs("span",{className:"wk-section-count",children:[$c.length," groups"]})]}),a.jsx("div",{className:"wk-muscle-grid",children:$c.map(($,he)=>a.jsx("button",{className:`wk-muscle-hero-card${$.image?" wk-muscle-thumb":""}`,onClick:()=>{Ct($.key),y("muscle_sessions")},style:{animationDelay:`${he*.05}s`},children:$.image?a.jsx("img",{src:$.image,alt:$.label,className:"wk-muscle-thumb-img"}):a.jsxs(a.Fragment,{children:[a.jsx("img",{src:p2,alt:"Muscle group",className:"wk-muscle-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-muscle-hero-overlay",style:{background:Fp[$.key]}}),a.jsxs("div",{className:"wk-muscle-hero-content",children:[a.jsx("div",{className:"wk-muscle-hero-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:$.icon})})}),a.jsxs("div",{className:"wk-muscle-hero-text",children:[a.jsx("span",{className:"wk-muscle-hero-name",children:$.label}),a.jsxs("span",{className:"wk-muscle-hero-count",children:[g2[$.key]?.length||0," sessions"]})]})]})]})},$.key))})]}),a.jsx(Ma,{active:"workouts"}),kt]});if(g==="setup"){const $=Hp.find(ae=>ae.key===E)?.label||E,he=Sl.find(ae=>ae.key===G)?.label||G;return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>y("menu"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main wk-setup-main",children:[a.jsx("div",{className:"wk-stats-row",children:[{label:"Total",value:`${nn}`,pct:nn>0?Math.min(Math.round(nn/100*100),100):0,color:"#14b8a6",size:"normal"},{label:"This Week",value:`${Ne}/${zp}`,pct:Math.round(Math.min(Ne,zp)/zp*100),color:"var(--color-primary)",size:"large"},{label:"Wk Streak",value:`${yn}`,pct:yn>0?Math.min(Math.round(yn/12*100),100):0,color:"#38B6FF",size:"normal"}].map(ae=>{const Pe=2*Math.PI*38,rt=Pe-ae.pct/100*Pe;return a.jsxs("div",{className:`wk-stat-item${ae.size==="large"?" wk-stat-large":""}`,children:[a.jsxs("div",{className:"wk-stat-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"wk-stat-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"wk-stat-fill",cx:"50",cy:"50",r:38,style:{stroke:ae.color},strokeDasharray:Pe,strokeDashoffset:rt})]}),a.jsx("span",{className:"wk-stat-value",style:{color:ae.color},children:ae.value})]}),a.jsx("span",{className:"wk-stat-label",children:ae.label})]},ae.label)})}),a.jsxs("div",{className:"wk-setup-flow",children:[a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Focus Area"}),a.jsx("div",{className:"wk-focus-grid",children:Hp.map(ae=>a.jsxs("button",{className:`wk-equip-btn${E===ae.key?" active":""}${ae.key==="mix"?" wk-mix-btn":""}`,onClick:()=>O(ae.key),children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:ae.icon})}),a.jsx("span",{children:ae.label})]},ae.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Level"}),a.jsx("div",{className:"wk-level-cards",children:Sl.map(ae=>a.jsxs("button",{className:`wk-level-card wk-level-${ae.key}${G===ae.key?" active":""}`,onClick:()=>U(ae.key),children:[a.jsx("span",{className:"wk-level-name",children:ae.label}),a.jsx("span",{className:"wk-level-desc",children:ae.desc})]},ae.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Time"}),a.jsx("div",{className:"wk-time-options",children:J3.map(ae=>a.jsxs("button",{className:`wk-time-btn${V===ae?" active":""}`,onClick:()=>ne(ae),children:[a.jsx("span",{className:"wk-time-num",children:ae}),a.jsx("span",{className:"wk-time-unit",children:"min"})]},ae))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Equipment"}),a.jsx("div",{className:"wk-equip-options",children:y2.map(ae=>{const Ce=w.includes(ae.key);return a.jsxs("button",{className:`wk-equip-btn${Ce?" active":""}`,onClick:()=>{k(Pe=>Ce&&Pe.length===1?Pe:Ce?Pe.filter(rt=>rt!==ae.key):[...Pe,ae.key])},children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:ae.icon})}),a.jsx("span",{children:ae.label})]},ae.key)})})]}),a.jsx("div",{className:"wk-setup-summary",children:a.jsxs("span",{children:[$,"  ",he,"  ",V," min"]})})]})]}),a.jsx("div",{className:"wk-go-sticky",children:a.jsx("button",{className:"wk-randomise-btn",onClick:_t,disabled:Te,children:Te?"Loading exercises...":"Randomise Workout"})}),kt]})}if(g==="spinning")return a.jsxs("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":h,children:[a.jsxs("div",{className:"wk-spin-container",children:[a.jsxs("div",{className:"wk-spin-ring",children:[a.jsx("svg",{className:"wk-spin-svg",viewBox:"0 0 200 200",children:au.map(($,he)=>a.jsx("line",{x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,className:"wk-spin-tick",strokeWidth:$.thick?"3.5":"2",style:{animationDelay:`${he*.03}s`}},he))}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-spin-logo",width:"50",height:"50"})]}),a.jsx("p",{className:"wk-spin-text",children:"Generating workout..."})]}),kt]});if(g==="preview"){const $=oe?.interval?{work:oe.work,rest:oe.rest}:Sl.find(ae=>ae.key===G),he=j.length*P*($.work+$.rest);return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>y(oe?.interval?"muscle_sessions":"setup"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[oe?.interval&&a.jsx("h2",{className:"mg-preview-title",children:oe.name}),a.jsxs("div",{className:"wk-preview-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:j.length}),a.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:P}),a.jsx("span",{className:"wk-stat-label",children:"Rounds"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.ceil(he/60)}),a.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsxs("span",{className:"wk-stat-val",children:[$.work,"/",$.rest]}),a.jsx("span",{className:"wk-stat-label",children:"Work/Rest"})]})]}),a.jsx("div",{className:"wk-preview-list",children:j.map((ae,Ce)=>a.jsxs("div",{className:"wk-preview-item",style:{animationDelay:`${Ce*.06}s`},onClick:()=>nt(ae),children:[a.jsx("span",{className:"wk-preview-num",children:Ce+1}),a.jsx("div",{className:"wk-preview-thumb",children:ae.isGif?a.jsx("img",{src:ae.videoUrl,alt:ae.name,loading:"lazy"}):a.jsx("video",{src:`${ae.videoUrl}#t=0.1`,muted:!0,playsInline:!0,preload:"auto"})}),a.jsx("span",{className:"wk-preview-name",children:ae.name}),a.jsx("svg",{className:"wk-preview-play",width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]},Ce))}),Ae&&a.jsx("div",{className:"wk-preview-modal-backdrop",onClick:()=>nt(null),children:a.jsxs("div",{className:"wk-preview-modal",onClick:ae=>ae.stopPropagation(),children:[a.jsx("button",{className:"wk-preview-modal-close",onClick:()=>nt(null),"aria-label":"Close preview",children:a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),a.jsx("div",{className:"wk-preview-modal-video",children:Ae.isGif?a.jsx("img",{src:Ae.videoUrl,alt:Ae.name}):a.jsx("video",{src:Ae.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}),a.jsx("h3",{className:"wk-preview-modal-title",children:Ae.name})]})}),a.jsxs("div",{className:"wk-preview-actions",children:[!oe?.interval&&a.jsxs("button",{className:"wk-btn-secondary",onClick:()=>_t(),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"1 4 1 10 7 10"}),a.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),"Reshuffle"]}),a.jsx("button",{className:"wk-btn-primary",onClick:vt,children:"Start Workout"})]})]})]})}if(g==="countdown")return a.jsx("div",{className:"wk-page wk-page-center wk-page-dark","data-theme":l?"dark":"light","data-accent":h,children:a.jsxs("div",{className:"wk-countdown-big",children:[a.jsx("span",{className:"wk-countdown-num",children:Se}),a.jsx("span",{className:"wk-countdown-label",children:"GET READY"})]})});if(g==="workout"){const $=j[Q],he=ze==="work"?z.work:z.rest,ae=ze==="rest"?Q+1<j.length?j[Q+1]:We<P?j[0]:null:null;return a.jsxs("div",{className:"wk-page wk-page-workout","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("div",{className:"wk-video-container",children:ze==="work"?$.isGif?a.jsx("img",{ref:pt,className:"wk-video",src:$.videoUrl,alt:$.name},$.videoUrl):a.jsx("video",{className:"wk-video",src:$.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0},$.videoUrl):a.jsxs("div",{className:"wk-rest-screen",children:[a.jsx("span",{className:"wk-rest-label",children:"REST"}),ae&&a.jsxs("span",{className:"wk-next-label",children:["Next: ",ae.name]})]})}),a.jsx("div",{className:"wk-back-row",children:a.jsxs("button",{className:"wk-back-btn",onClick:()=>{confirm("Leave workout?")&&y("menu")},children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]})}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"wk-exercise-info",children:[a.jsxs("span",{className:"wk-exercise-counter",children:[Q+1," / ",j.length]}),a.jsx("h2",{className:"wk-exercise-name",children:$.name}),a.jsxs("span",{className:"wk-round-label",children:["Round ",We," of ",P]})]}),a.jsx("div",{className:"wk-timer-section",children:a.jsxs("div",{className:"wk-timer-ring-wrap",children:[Oe(ie,he,ze==="work"?"wk-tick-work":"wk-tick-rest"),a.jsxs("div",{className:"wk-timer-center",children:[a.jsx("span",{className:"wk-timer-time",children:ie}),a.jsx("span",{className:`wk-timer-phase ${ze}`,children:ze==="work"?"WORK":"REST"})]})]})}),a.jsxs("div",{className:"wk-controls",children:[a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-stop",onClick:()=>{confirm("End workout early?")&&y("menu")},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-pause",onClick:()=>ye(!H),children:H?a.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}):a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),a.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-skip",onClick:()=>{L(0)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("polygon",{points:"5 4 15 12 5 20 5 4"}),a.jsx("rect",{x:"15",y:"4",width:"4",height:"16"})]})})]}),a.jsx("div",{className:"wk-progress-bar",children:a.jsx("div",{className:"wk-progress-fill",style:{width:`${Ut()*100}%`}})})]})}if(g==="complete"){const $=Sl.find(ae=>ae.key===G),he=j.length*P*($.work+$.rest);return a.jsx("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":h,children:a.jsxs("div",{className:"wk-complete",children:[a.jsxs("div",{className:"wk-complete-ring",children:[a.jsx("svg",{className:"wk-complete-svg",viewBox:"0 0 200 200",children:au.map((ae,Ce)=>a.jsx("line",{x1:ae.x1,y1:ae.y1,x2:ae.x2,y2:ae.y2,className:"wk-tick-complete",strokeWidth:ae.thick?"3.5":"2",style:{animationDelay:`${Ce*.02}s`}},Ce))}),a.jsx("div",{className:"wk-complete-center",children:a.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})})})]}),a.jsx("h2",{className:"wk-complete-title",children:"Workout Complete!"}),a.jsxs("div",{className:"wk-complete-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.ceil(he/60)}),a.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:j.length*P}),a.jsx("span",{className:"wk-stat-label",children:"Intervals"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:P}),a.jsx("span",{className:"wk-stat-label",children:"Rounds"})]})]}),a.jsx("div",{className:"wk-complete-actions",children:a.jsx("button",{className:"wk-btn-primary",onClick:()=>{En(null),Ct(null),y("menu")},children:"Done"})})]})})}if(g==="muscle_sessions"){const $=$c.find(ae=>ae.key===Nt),he=g2[Nt]||[];return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>y("menu"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"mg-sessions-header",children:[a.jsx("div",{className:"mg-sessions-icon",style:{background:Fp[Nt]},children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:$?.icon})})}),a.jsxs("h2",{children:[$?.label," Workouts"]}),a.jsxs("p",{children:[he.length," sessions available"]})]}),a.jsx("div",{className:"mg-sessions-list",children:he.map((ae,Ce)=>a.jsxs("button",{className:"mg-session-card",onClick:()=>{En(ae),y("muscle_overview")},style:{animationDelay:`${Ce*.08}s`},children:[a.jsxs("div",{className:"mg-session-info",children:[a.jsx("h3",{children:ae.name}),a.jsx("p",{children:ae.desc}),a.jsx("div",{className:"mg-session-meta",children:ae.interval?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-interval",children:"Interval"}),a.jsxs("span",{className:"mg-session-tag",children:[ae.exercises.length," exercises"]}),a.jsxs("span",{className:"mg-session-tag",children:[ae.rounds," rounds"]})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-strength",children:"Strength"}),a.jsxs("span",{className:"mg-session-tag",children:[ae.exercises.length," exercises"]}),a.jsx("span",{className:"mg-session-tag",children:(()=>{const Pe=ae.exercises.map(ot=>ot.sets||0),rt=Math.min(...Pe),It=Math.max(...Pe);return rt===It?`${rt} sets each`:`${rt}-${It} sets each`})()})]})})]}),a.jsx("div",{className:"mg-session-arrow",children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},ae.id))})]}),kt]})}if(g==="muscle_overview"){const $=oe;if(!$)return null;const he=$c.find(ae=>ae.key===Nt);return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>y("muscle_sessions"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main mg-overview-main",children:[a.jsx("div",{className:"mg-overview-hero",style:{background:Fp[Nt]},children:a.jsx("div",{className:"mg-overview-hero-content",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"mg-overview-hero-icon",children:a.jsx("path",{d:he?.icon})})})}),a.jsxs("div",{className:"mg-overview-header",children:[a.jsxs("div",{className:"mg-overview-title-row",children:[a.jsx("h2",{children:$.name}),$.level&&a.jsx("span",{className:"mg-overview-level",children:$.level})]}),a.jsx("p",{className:"mg-overview-desc",children:$.desc})]}),$.overview&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"About This Workout"]}),a.jsx("p",{children:$.overview})]}),$.tips&&$.tips.length>0&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Tips & Form"]}),a.jsx("ul",{className:"mg-overview-tips",children:$.tips.map((ae,Ce)=>a.jsx("li",{children:ae},Ce))})]}),a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"}),a.jsx("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),a.jsx("path",{d:"M9 14l2 2 4-4"})]}),"Exercises (",$.exercises.length,")"]}),a.jsx("div",{className:"mg-overview-exercises",children:$.exercises.map((ae,Ce)=>a.jsxs("div",{className:"mg-overview-exercise",children:[a.jsx("span",{className:"mg-overview-ex-num",children:Ce+1}),a.jsxs("div",{className:"mg-overview-ex-info",children:[a.jsx("span",{className:"mg-overview-ex-name",children:ae.name}),$.interval?a.jsxs("span",{className:"mg-overview-ex-detail",children:[$.work,"s work / ",$.rest,"s rest"]}):a.jsxs("span",{className:"mg-overview-ex-detail",children:[ae.sets," sets  ",ae.reps?`${ae.reps} reps`:`${ae.time}s`,ae.type==="weighted"&&"  weighted"]})]})]},Ce))})]}),a.jsxs("button",{className:"mg-overview-start-btn",onClick:()=>F($),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Workout"]})]}),kt]})}if(g==="muscle_workout"){const $=oe;if(!$)return null;const he=$.exercises[Ht],ae=et[Ht];if(!he||!ae)return null;const Ce=ae.sets.length,Pe=$.exercises.length,rt=$.exercises.reduce((bn,xn)=>bn+(xn.sets||0),0),ot=et.reduce((bn,xn)=>bn+xn.sets.length,0)/rt*100,an=Fe[he.name];he.type==="timed"&&Kt===0&&!zt&&Ce===Bt&&setTimeout(()=>Nn(he.time),0);const Un=Ce+1<he.sets?"Log Set":Ht+1<Pe?"Log Set  Next Exercise":"Log Set  Complete";return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("div",{className:"mg-session-progress",children:a.jsx("div",{className:"mg-session-progress-fill",style:{width:`${ot}%`}})}),a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>{confirm("End workout early?")&&y("muscle_overview")},"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsxs("span",{className:"mg-header-info",children:["Exercise ",Ht+1,"/",Pe]}),a.jsx("div",{style:{width:22}})]})}),a.jsxs("main",{className:"wk-main",children:[an?a.jsxs("div",{className:"mg-video-container",onClick:ce,children:[an.isGif?a.jsx("img",{className:"mg-video",src:an.url,alt:he.name}):a.jsx("video",{ref:Be,className:"mg-video",src:an.url,loop:!0,muted:!0,playsInline:!0},he.name),!me&&!an.isGif&&a.jsxs("div",{className:"mg-video-overlay",children:[a.jsx("svg",{className:"mg-play-icon",width:"48",height:"48",viewBox:"0 0 24 24",fill:"rgba(255,255,255,0.9)",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),a.jsx("span",{className:"mg-video-hint",children:"Tap for demo"})]})]}):a.jsxs("div",{className:"mg-video-placeholder",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.4",children:[a.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),a.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),a.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),a.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),a.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),a.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),a.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),a.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"})]}),a.jsx("span",{children:"Video coming soon"})]}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"mg-exercise-card",children:[a.jsx("h2",{className:"mg-ex-name",children:he.name}),a.jsx("span",{className:`mg-ex-type-badge ${he.type}`,children:he.type==="weighted"?"Weight + Reps":he.type==="reps"?"Reps Only":"Timed"}),a.jsxs("div",{className:"mg-ex-set-info",children:[a.jsxs("span",{className:"mg-ex-set-num",children:["Set ",Ce+1," of ",he.sets]}),he.type!=="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",he.reps," reps"]}),he.type==="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",he.time,"s"]})]}),he.type==="weighted"&&a.jsxs("div",{className:"mg-input-area",children:[a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",className:"mg-input",value:ss,onChange:bn=>Pt(bn.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Et,onChange:bn=>Ln(bn.target.value),placeholder:"0"})]})]}),he.type==="reps"&&a.jsx("div",{className:"mg-input-area",children:a.jsxs("div",{className:"mg-input-group mg-input-single",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Et,onChange:bn=>Ln(bn.target.value),placeholder:"0"})]})}),he.type==="timed"&&a.jsxs("div",{className:"mg-timer-area",children:[a.jsx("div",{className:"mg-timer-display",children:a.jsxs("span",{className:"mg-timer-value",children:[Kt,"s"]})}),zt?a.jsx("button",{className:"mg-timer-btn mg-timer-stop",onClick:()=>Sn(!1),children:"Stop"}):a.jsx("button",{className:"mg-timer-btn",onClick:()=>{Kt===0&&Nn(he.time),Sn(!0)},children:Kt<he.time&&Kt>0?"Resume":"Start Timer"})]}),a.jsx("button",{className:"mg-log-set-btn",onClick:T,children:Un}),ae.sets.length>0&&a.jsx("div",{className:"mg-completed-sets",children:ae.sets.map((bn,xn)=>a.jsxs("div",{className:"mg-completed-set",children:[a.jsx("span",{className:"mg-completed-set-check",children:""}),a.jsxs("span",{children:["Set ",xn+1,": ",bn.weight!=null?`${bn.weight}kg  ${bn.reps}`:bn.reps!=null?`${bn.reps} reps`:`${bn.time}s`]})]},xn))})]})]}),kt]})}if(g==="muscle_complete"){const $=et.reduce((Ce,Pe)=>Ce+Pe.sets.length,0),he=et.reduce((Ce,Pe)=>Ce+Pe.sets.reduce((rt,It)=>rt+(It.weight||0)*(It.reps||0),0),0),ae=$c.find(Ce=>Ce.key===Nt)?.label||"";return a.jsxs("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":h,children:[a.jsxs("div",{className:"wk-complete",children:[a.jsxs("div",{className:"wk-complete-ring",children:[a.jsx("svg",{className:"wk-complete-svg",viewBox:"0 0 200 200",children:au.map((Ce,Pe)=>a.jsx("line",{x1:Ce.x1,y1:Ce.y1,x2:Ce.x2,y2:Ce.y2,className:"wk-tick-complete",strokeWidth:Ce.thick?"3.5":"2",style:{animationDelay:`${Pe*.02}s`}},Pe))}),a.jsx("div",{className:"wk-complete-center",children:a.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})})})]}),a.jsxs("h2",{className:"wk-complete-title",children:[ae," Complete!"]}),a.jsx("p",{className:"mg-complete-session-name",children:oe?.name}),a.jsxs("div",{className:"wk-complete-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:et.length}),a.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:$}),a.jsx("span",{className:"wk-stat-label",children:"Sets"})]}),he>0&&a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.round(he).toLocaleString()}),a.jsx("span",{className:"wk-stat-label",children:"Volume (kg)"})]})]}),a.jsx("div",{className:"wk-complete-actions",children:a.jsx("button",{className:"wk-btn-primary",onClick:()=>{En(null),Ct(null),Y(null),y("menu")},children:"Done"})})]}),mt&&a.jsx("div",{className:"mg-badge-celebration",onClick:()=>Y(null),children:a.jsxs("div",{className:"mg-badge-celebration-card",children:[a.jsx("div",{className:"mg-badge-celebration-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",width:"48",height:"48",fill:"#ffc107",children:a.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})}),a.jsx("h3",{className:"mg-badge-celebration-title",children:mt.badges.length===1?"Badge Earned!":`${mt.badges.length} Badges Earned!`}),a.jsx("div",{className:"mg-badge-celebration-list",children:mt.badges.map((Ce,Pe)=>a.jsx("div",{className:"mg-badge-celebration-item",children:Ce.type==="pb_target"?`${Ce.exercise}  ${Ce.targetWeight}kg`:Ce.label},Pe))}),a.jsx("button",{className:"mg-badge-celebration-dismiss",children:"Tap to dismiss"})]})})]})}return null}const nD=60,sD={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},rD=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],v2=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,daysPerWeek:3,level:"All Levels",description:"Build total body strength with compound dumbbell movements and bodyweight finishers",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push Focus",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Goblet Squats",type:"weighted",sets:3,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull Focus",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:3,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:3,baseReps:10,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Reverse Lunge",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Legs & Core",exercises:[{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Box Step Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,daysPerWeek:3,level:"Intermediate",description:"Two-phase programme building strength and endurance across your full body",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Power",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"}]},{name:"Day 3",label:"Endurance",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,daysPerWeek:3,level:"Advanced",description:"Complete transformation programme: push, pull, and legs over three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Upper Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Lower Body",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 3",label:"Upper Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,daysPerWeek:3,level:"Beginner",description:"Build a solid core foundation with targeted ab and stability work",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Abs",exercises:[{name:"Crunch",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Stability",exercises:[{name:"Dead Bug",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Bird Dog",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:20,storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"}]},{name:"Day 3",label:"Power Core",exercises:[{name:"Single Leg V-Up",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Toe Reaches",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Russian Twists Dumbbell",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Fast Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,daysPerWeek:3,level:"Intermediate",description:"Develop deep core strength and rotational power over two phases",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Anti-Extension",exercises:[{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Dead Bug",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Plank Walkout",type:"reps",sets:3,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"}]},{name:"Day 2",label:"Rotation",exercises:[{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank Rotation",type:"reps",sets:2,baseReps:10,storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",sets:3,baseReps:10,storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,daysPerWeek:3,level:"Advanced",description:"Ultimate core transformation: stability, strength, and power across three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Forearm Plank",type:"timed",sets:4,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Plank Walkout",type:"reps",sets:4,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Leg Raises",type:"reps",sets:4,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Kettlebell Side Bends",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 2",label:"Endurance",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:4,baseReps:15,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Hollow Hold To V-Sit",type:"reps",sets:4,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Hip Dips Plank",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,daysPerWeek:3,level:"Intermediate",description:"Sculpt and strengthen your chest, back, shoulders, and arms",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Tricep Dips",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Reverse Plank",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/upper/reverse plank.GIF"}]},{name:"Day 3",label:"Mixed",exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Renegade Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Superman Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Superman Hold.mp4"}]}]},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,daysPerWeek:3,level:"Intermediate",description:"Build powerful legs and glutes with squats, deadlifts, and plyometrics",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Quad Dominant",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Squat And Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/lower/squat and hold.GIF"}]},{name:"Day 2",label:"Hamstring & Glute",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"1 Legged RDL",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Hip Thrusts",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Donkey Kicks",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 3",label:"Power & Stability",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Skater Jumps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]}];function ad(s,e,n){const i=s.baseReps?s.baseReps+(e-1)*(n.repProg||0):void 0,l=s.baseTime?s.baseTime+(e-1)*(n.timeProg||0):void 0;return{sets:s.sets,reps:i,time:l}}const aD={fullbody:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z",core:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",upper:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",lower:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"};function iD(){const{currentUser:s,isClient:e,clientData:n,loading:i}=Xr(),{isDark:l,toggleTheme:u,accent:h}=Pa(),p=Zs(),g=ma(),[y,w]=x.useState("loading"),[k,E]=x.useState(null),O=x.useRef(!1),[G,U]=x.useState(null),[V,ne]=x.useState(1),[J,fe]=x.useState(0),[Te,$e]=x.useState(0),[Ve,I]=x.useState(0),[j,R]=x.useState([]),[P,D]=x.useState(""),[z,M]=x.useState(""),[We,wt]=x.useState(!1),[Q,je]=x.useState(0),ze=x.useRef(null),[lt,ie]=x.useState({}),[L,H]=x.useState(!1),ye=x.useRef(null),[Se,qe]=x.useState(null),[Ae,nt]=x.useState([]);x.useEffect(()=>{window.scrollTo(0,0)},[y]);const[pt,Je]=x.useState(null),qt=x.useCallback((me,Ee="info")=>{Je({message:me,type:Ee}),setTimeout(()=>Je(null),4e3)},[]),cn=x.useRef(null),Nt=()=>(cn.current||(cn.current=new(window.AudioContext||window.webkitAudioContext)),cn.current),Ct=()=>{try{const me=Nt(),Ee=me.createOscillator(),Fe=me.createGain();Ee.connect(Fe),Fe.connect(me.destination),Ee.frequency.value=1200,Fe.gain.value=.4,Ee.start(me.currentTime),Ee.stop(me.currentTime+.3)}catch{}};x.useEffect(()=>{!i&&(!s||!e)&&p("/")},[s,e,i,p]),x.useEffect(()=>{if(!n)return;(async()=>{try{const Ee=Ke(be,"clientProgrammes",n.id),Fe=await qn(Ee);Fe.exists()?(U(Fe.data()),w("dashboard")):g.state?.templateId?w("browse"):p("/client/core-buddy/workouts",{replace:!0})}catch(Ee){console.error("Error loading programme:",Ee),p("/client/core-buddy/workouts",{replace:!0})}})()},[n]),x.useEffect(()=>{if(O.current||y==="loading")return;const me=g.state?.templateId;if(!me)return;const Ee=v2.find(Fe=>Fe.id===me);Ee&&(O.current=!0,E(Ee),w("overview"))},[y,g.state]),x.useEffect(()=>{if(!We||Q<=0){We&&Q<=0&&(wt(!1),Ct());return}return ze.current=setTimeout(()=>je(me=>me-1),1e3),()=>clearTimeout(ze.current)},[We,Q]);const oe=async me=>{if(n)try{await Gn(Ke(be,"clientProgrammes",n.id),me),U(me)}catch(Ee){console.error("Error saving programme:",Ee),qt("Failed to save. Check Firestore rules for clientProgrammes.","error")}},En=async me=>{const Ee={templateId:me.id,startDate:bt.now(),completedSessions:{}};await oe(Ee),w("dashboard")},Ht=async()=>{if(n)try{await ar(Ke(be,"clientProgrammes",n.id)),U(null),w("browse")}catch(me){console.error("Error quitting programme:",me)}},St=()=>G?v2.find(me=>me.id===G.templateId):null,Bt=()=>{if(!G?.startDate)return 1;const me=G.startDate.toDate?G.startDate.toDate():new Date(G.startDate),Fe=new Date-me,Ye=Math.floor(Fe/(1e3*60*60*24));return Math.floor(Ye/7)+1},ht=()=>{if(!G)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const me=G.completedSessions||{},Ee=Object.keys(me).length,Fe=St();if(!Fe)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const Ye=Fe.duration*Fe.daysPerWeek,Be=Bt(),Me=Math.min(Be,Fe.duration);let Le=0;for(let mt=0;mt<Fe.daysPerWeek;mt++)me[`w${Me}d${mt}`]&&Le++;if(Ee>=Ye)return{currentWeek:Fe.duration,completedThisWeek:Fe.daysPerWeek,nextDay:-1,totalCompleted:Ee,totalSessions:Ye,complete:!0};if(Be>Fe.duration)return{currentWeek:Fe.duration,completedThisWeek:Le,nextDay:-1,totalCompleted:Ee,totalSessions:Ye,complete:!0};let xt=-1;for(let mt=0;mt<Fe.daysPerWeek;mt++)if(!me[`w${Me}d${mt}`]){xt=mt;break}return{currentWeek:Me,completedThisWeek:Le,nextDay:xt,nextWeek:Me,totalCompleted:Ee,totalSessions:Ye}},et=me=>{const Ee=Bt();return me<Ee},tn=(me,Ee,Fe)=>{if(!G||me<=1)return null;const Ye=`w${me-1}d${Ee}`,Be=G.completedSessions?.[Ye];if(!Be)return null;const Me=Be.exercises?.find(Le=>Le.name===Fe);return Me?.sets?.length?Me.sets[Me.sets.length-1]:null},ss=(me,Ee)=>{const Fe=St();if(!Fe)return;ne(me),fe(Ee),$e(0),I(0),R([]),M(""),wt(!1),je(0),H(!1),ie({});const Ye=Fe.days[Ee],Be=Ye.exercises.map(mt=>{const Y=ad(mt,me,Fe);return{name:mt.name,type:mt.type,pbKey:mt.pbKey,targetSets:Y.sets,targetReps:Y.reps,targetTime:Y.time,sets:[]}});R(Be);const Me=Ye.exercises[0],Le=tn(me,Ee,Me.name);Le?.weight&&Me.type==="weighted"?D(String(Le.weight)):D(""),(async()=>{const mt={};for(const Y of Ye.exercises)if(Y.storagePath)try{const Ne=Gi(Ki,Y.storagePath),Qe=await Oo(Ne);mt[Y.name]={url:Qe,isGif:/\.gif$/i.test(Y.storagePath)}}catch(Ne){console.warn(`Video not found for ${Y.name}:`,Ne)}ie(mt)})(),w("session")},Pt=async()=>{St();const me=j[Te];if(!me)return;let Ee={};if(me.type==="weighted"){const Be=parseFloat(P)||0,Me=parseInt(z)||0;if(Me===0){qt("Enter your reps","error");return}Ee={weight:Be,reps:Me}}else if(me.type==="reps"){const Be=parseInt(z)||0;if(Be===0){qt("Enter your reps","error");return}Ee={reps:Be}}else if(me.type==="timed"){const Be=me.targetTime-Q;Ee={time:Math.max(Be,1)}}const Fe=[...j];Fe[Te]={...me,sets:[...me.sets,Ee]},R(Fe),me.type==="weighted"&&Ee.weight>0&&await zt(me.name,Ee.weight,Ee.reps);const Ye=me.sets.length+1;if(Ye<me.targetSets)I(Ye),D(Ee.weight?String(Ee.weight):""),M(""),wt(!1),je(0);else if(Te+1<j.length){const Be=Te+1;$e(Be),I(0),H(!1);const Le=St()?.days[J]?.exercises[Be],xt=tn(V,J,Le?.name);xt?.weight&&Le?.type==="weighted"?D(String(xt.weight)):D(""),M(""),wt(!1),je(0)}else await Et(Fe)},Et=async me=>{if(!G||!n)return;const Ee=`w${V}d${J}`,Fe={...G.completedSessions,[Ee]:{completedAt:new Date().toISOString(),exercises:me.map(Me=>({name:Me.name,type:Me.type,sets:Me.sets}))}},Ye={...G,completedSessions:Fe};await oe(Ye);const Be=me.reduce((Me,Le)=>Me+Le.sets.reduce((xt,mt)=>xt+(mt.weight||0)*(mt.reps||0),0),0);Be>0&&await Ln(Be);try{const Me=St();await ri(Qt(be,"workoutLogs"),{clientId:n.id,type:"programme",programmeId:Me?.id,programmeName:Me?.name,week:V,day:J+1,exerciseCount:me.length,duration:Math.round(me.reduce((Le,xt)=>Le+xt.sets.length*1.5,0)),volume:Math.round(Be),completedAt:bt.now()})}catch(Me){console.error("Error saving workout log:",Me)}Ae.length>0&&(qe({badges:[...Ae]}),nt([])),w("sessionComplete")},Ln=async me=>{if(n)try{const Ee=await qn(Ke(be,"coreBuddyAchievements",n.id)),Fe=Ee.exists()?Ee.data():{clientId:n.id,badges:[],totalVolume:0},Ye=Fe.totalVolume||0,Be=Ye+me,Me=[];rD.forEach(xt=>{Be>=xt.threshold&&Ye<xt.threshold&&(Fe.badges.some(Y=>Y.type==="volume_milestone"&&Y.milestone===xt.threshold)||Me.push({type:"volume_milestone",milestone:xt.threshold,label:xt.label,achievedAt:bt.now()}))});const Le=[...Fe.badges,...Me];await Gn(Ke(be,"coreBuddyAchievements",n.id),{clientId:n.id,badges:Le,totalVolume:Math.round(Be),updatedAt:bt.now()}),Me.length>0&&nt(xt=>[...xt,...Me])}catch(Ee){console.error("Error updating volume:",Ee)}},zt=async(me,Ee,Fe)=>{if(n)try{const Ye=n.id,Be=await qn(Ke(be,"coreBuddyPBs",Ye)),Le=(Be.exists()?Be.data():null)?.exercises||{},xt=Le[me];let mt=!1;if(xt?(Ee>(xt.weight||0)||Ee===(xt.weight||0)&&Fe>(xt.reps||0))&&(mt=!0):mt=!0,mt){const Y={...Le,[me]:{weight:Ee,reps:Fe,achievedAt:bt.now()}};await Gn(Ke(be,"coreBuddyPBs",Ye),{clientId:n.id,exercises:Y,updatedAt:bt.now()}),qt(`New PB! ${Ee}kg  ${Fe} reps`,"success"),Ct(),await Sn(me,Ee)}}catch(Ye){console.error("Error checking PB:",Ye)}},Sn=async(me,Ee)=>{if(n)try{const Fe=await qn(Ke(be,"coreBuddyTargets",n.id));if(!Fe.exists())return;const Be=(Fe.data().targets||{})[me];if(!Be||Ee<Be.targetWeight)return;const Me=await qn(Ke(be,"coreBuddyAchievements",n.id)),Le=Me.exists()?Me.data():{clientId:n.id,badges:[],totalVolume:0};if(Le.badges.some(Ne=>Ne.type==="pb_target"&&Ne.exercise===me&&Ne.targetWeight===Be.targetWeight))return;const mt={type:"pb_target",exercise:me,group:sD[me]||"push",targetWeight:Be.targetWeight,achievedAt:bt.now()},Y=[...Le.badges,mt];await Gn(Ke(be,"coreBuddyAchievements",n.id),{...Le,badges:Y,updatedAt:bt.now()}),nt(Ne=>[...Ne,mt])}catch(Fe){console.error("Error checking target badge:",Fe)}},Kt=pt&&a.jsxs("div",{className:`toast-notification ${pt.type}`,children:[pt.type==="success"&&a.jsx("span",{children:" "}),pt.message]}),Nn=(me,Ee)=>a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:Ee,"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})});if(i||y==="loading")return a.jsx("div",{className:"cb-loading",children:a.jsx("div",{className:"cb-loading-spinner"})});if(y==="browse")return p("/client/core-buddy/workouts",{replace:!0}),null;if(y==="overview"&&k){const me=k;return a.jsxs("div",{className:"pg-page","data-theme":l?"dark":"light","data-accent":h,children:[Nn(me.name,()=>p("/client/core-buddy/workouts")),a.jsxs("main",{className:"pg-main",children:[a.jsxs("div",{className:"pg-overview-hero",children:[a.jsx("svg",{className:"pg-overview-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:aD[me.focus]})}),a.jsx("h2",{className:"pg-overview-name",children:me.name}),a.jsx("p",{className:"pg-overview-desc",children:me.description}),a.jsxs("div",{className:"pg-overview-stats",children:[a.jsxs("div",{className:"pg-ov-stat",children:[a.jsx("span",{className:"pg-ov-stat-num",children:me.duration}),a.jsx("span",{className:"pg-ov-stat-label",children:"Weeks"})]}),a.jsxs("div",{className:"pg-ov-stat",children:[a.jsx("span",{className:"pg-ov-stat-num",children:me.daysPerWeek}),a.jsx("span",{className:"pg-ov-stat-label",children:"Days/Week"})]}),a.jsxs("div",{className:"pg-ov-stat",children:[a.jsx("span",{className:"pg-ov-stat-num",children:me.duration*me.daysPerWeek}),a.jsx("span",{className:"pg-ov-stat-label",children:"Sessions"})]})]})]}),a.jsx("div",{className:"pg-overview-days",children:me.days.map((Ee,Fe)=>a.jsxs("div",{className:"pg-day-card",children:[a.jsxs("div",{className:"pg-day-header",children:[a.jsx("span",{className:"pg-day-name",children:Ee.name}),a.jsx("span",{className:"pg-day-label",children:Ee.label})]}),a.jsx("div",{className:"pg-day-exercises",children:Ee.exercises.map((Ye,Be)=>{const Me=ad(Ye,1,me);return a.jsxs("div",{className:"pg-day-ex",children:[a.jsx("span",{className:"pg-day-ex-name",children:Ye.name}),a.jsx("span",{className:"pg-day-ex-target",children:Ye.type==="timed"?`${Me.sets}${Me.time}s`:`${Me.sets}${Me.reps}`}),a.jsx("span",{className:`pg-day-ex-badge pg-badge-${Ye.type}`,children:Ye.type==="weighted"?"WT":Ye.type==="timed"?"TMR":"BW"})]},Be)})})]},Fe))}),a.jsxs("div",{className:"pg-overview-note",children:[a.jsx("strong",{children:"Progressive Overload:"})," +",me.repProg," reps/week",me.timeProg?`, +${me.timeProg}s/week for timed`:""]}),a.jsx("button",{className:"pg-start-btn",onClick:()=>En(me),children:"Start Programme"})]}),Kt]})}if(y==="dashboard"){const me=St();if(!me)return w("browse"),null;const Ee=ht(),Fe=G?.completedSessions||{},Ye=Ee.totalSessions?Math.round(Ee.totalCompleted/Ee.totalSessions*100):0;return Math.round(Ee.totalCompleted/(Ee.totalSessions||1)*nD),a.jsxs("div",{className:"pg-page","data-theme":l?"dark":"light","data-accent":h,children:[Nn("Programme",()=>p("/client/core-buddy/workouts")),a.jsxs("main",{className:"pg-main",children:[a.jsxs("div",{className:"pg-dash-hero",children:[a.jsxs("div",{className:"pg-dash-ring-wrap",children:[a.jsxs("svg",{viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"pg-arc-track",cx:"100",cy:"100",r:"80"}),a.jsx("circle",{className:"pg-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-Ye/100*2*Math.PI*80})]}),a.jsxs("div",{className:"pg-ring-center",children:[a.jsxs("span",{className:"pg-ring-pct",children:[Ye,"%"]}),a.jsx("span",{className:"pg-ring-label",children:"complete"})]})]}),a.jsx("h2",{className:"pg-dash-name",children:me.name}),a.jsxs("div",{className:"pg-dash-progress-text",children:[a.jsxs("span",{className:"pg-dash-pct",children:[Ye,"%"]}),a.jsxs("span",{className:"pg-dash-week",children:["Week ",Ee.currentWeek," of ",me.duration]})]})]}),a.jsx("div",{className:"pg-weeks",children:Array.from({length:me.duration},(Be,Me)=>{const Le=Me+1,xt=et(Le);return a.jsxs("div",{className:`pg-week-row${Le===Ee.currentWeek?" pg-week-current":""}`,children:[a.jsxs("span",{className:"pg-week-label",children:["W",Le]}),a.jsx("div",{className:"pg-week-days",children:me.days.map((mt,Y)=>{const Ne=`w${Le}d${Y}`,Qe=!!Fe[Ne],Xe=!Qe&&xt,dt=!Qe&&!Xe&&Le===Ee.currentWeek&&!Ee.complete;return a.jsx("button",{className:`pg-day-dot${Qe?" done":""}${Xe?" missed":""}${dt?" next":""}`,disabled:!dt,onClick:()=>{dt&&ss(Le,Y)},children:Qe?a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}):Xe?a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsx("span",{children:mt.name.replace("Day ","")})},Y)})})]},Me)})}),!Ee.complete&&(()=>{const Be=me.days.map((Me,Le)=>({day:Me,d:Le})).filter(({d:Me})=>!Fe[`w${Ee.currentWeek}d${Me}`]);return Be.length===0?null:a.jsxs("div",{className:"pg-next-session",children:[a.jsx("h3",{children:Be.length===me.daysPerWeek?"Choose a Session":"Remaining Sessions"}),a.jsxs("p",{className:"pg-next-info",children:["Week ",Ee.currentWeek,"  ",Be.length," session",Be.length!==1?"s":""," left this week"]}),Be.map(({day:Me,d:Le})=>a.jsxs("div",{className:"pg-available-session",children:[a.jsxs("div",{className:"pg-next-exercises",children:[a.jsxs("span",{className:"pg-avail-day-label",children:[Me.name,": ",Me.label]}),Me.exercises.map((xt,mt)=>{const Y=ad(xt,Ee.currentWeek,me);return a.jsxs("div",{className:"pg-next-ex",children:[a.jsx("span",{className:"pg-next-ex-name",children:xt.name}),a.jsx("span",{className:"pg-next-ex-target",children:xt.type==="timed"?`${Y.sets}${Y.time}s`:`${Y.sets}${Y.reps}`})]},mt)})]}),a.jsxs("button",{className:"pg-start-btn",onClick:()=>ss(Ee.currentWeek,Le),children:["Start ",Me.name]})]},Le))]})})(),Ee.complete&&a.jsxs("div",{className:"pg-complete-msg",children:[a.jsx("h3",{children:"Programme Complete! "}),a.jsxs("p",{children:["You finished all ",Ee.totalSessions," sessions."]}),a.jsx("button",{className:"pg-start-btn",onClick:Ht,children:"Choose New Programme"})]}),a.jsx("button",{className:"pg-quit-btn",onClick:()=>{confirm("Quit this programme? Progress will be lost.")&&Ht()},children:"Quit Programme"})]}),a.jsx(Ma,{active:"workouts"}),Kt]})}if(y==="session"){const me=St();if(!me)return null;const Ee=me.days[J],Fe=Ee.exercises[Te],Ye=ad(Fe,V,me),Be=j[Te],Me=Be?.sets?.length||0,Le=Ee.exercises.length,xt=(Te+Me/Ye.sets)/Le,mt=lt[Fe.name],Y=tn(V,J,Fe.name);Fe.type==="timed"&&Q===0&&!We&&Me===Ve&&setTimeout(()=>je(Ye.time),0);const Ne=()=>{mt?.isGif?H(!L):ye.current&&(L?ye.current.pause():ye.current.play(),H(!L))};return a.jsxs("div",{className:"pg-page pg-page-session","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("div",{className:"pg-session-progress",children:a.jsx("div",{className:"pg-session-progress-fill",style:{width:`${xt*100}%`}})}),a.jsxs("div",{className:"pg-session-header",children:[a.jsx("button",{className:"pg-session-back",onClick:()=>{confirm("Leave session? Progress will be lost.")&&w("dashboard")},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M19 12H5M12 5l-7 7 7 7"})})}),a.jsxs("div",{className:"pg-session-title",children:[a.jsxs("span",{className:"pg-session-counter",children:[Te+1," / ",Le]}),a.jsxs("span",{className:"pg-session-week",children:["Week ",V,"  ",Ee.name]})]})]}),mt&&a.jsxs("div",{className:"pg-video-container",onClick:Ne,children:[mt.isGif?a.jsx("img",{className:"pg-video",src:mt.url,alt:Fe.name}):a.jsx("video",{ref:ye,className:"pg-video",src:mt.url,loop:!0,muted:!0,playsInline:!0},Fe.name),!L&&a.jsxs("div",{className:"pg-video-overlay",children:[a.jsx("svg",{className:"pg-play-icon",viewBox:"0 0 24 24",fill:"white",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),a.jsx("span",{className:"pg-video-hint",children:"Tap for demo"})]})]}),a.jsx("div",{className:"pg-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"pg-exercise-card",children:[a.jsx("h2",{className:"pg-ex-name",children:Fe.name}),a.jsx("span",{className:`pg-ex-type-badge pg-badge-${Fe.type}`,children:Fe.type==="weighted"?"Weight + Reps":Fe.type==="timed"?"Timed":"Reps Only"}),Fe.type==="weighted"&&Y&&a.jsxs("div",{className:"pg-last-week",children:[a.jsx("span",{className:"pg-last-week-label",children:"Last week:"}),a.jsxs("span",{className:"pg-last-week-value",children:[Y.weight,"kg x ",Y.reps," reps"]})]}),a.jsxs("div",{className:"pg-ex-set-info",children:[a.jsxs("span",{className:"pg-ex-set-num",children:["Set ",Me+1," of ",Ye.sets]}),a.jsxs("span",{className:"pg-ex-target",children:["Target: ",Fe.type==="timed"?`${Ye.time}s hold`:`${Ye.reps} reps`]})]}),Fe.type==="weighted"&&a.jsxs("div",{className:"pg-input-area",children:[a.jsxs("div",{className:"pg-input-group",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",value:P,onChange:Qe=>D(Qe.target.value),placeholder:"0",className:"pg-input"})]}),a.jsxs("div",{className:"pg-input-group",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",value:z,onChange:Qe=>M(Qe.target.value),placeholder:String(Ye.reps),className:"pg-input"})]})]}),Fe.type==="reps"&&a.jsx("div",{className:"pg-input-area",children:a.jsxs("div",{className:"pg-input-group pg-input-single",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",value:z,onChange:Qe=>M(Qe.target.value),placeholder:String(Ye.reps),className:"pg-input"})]})}),Fe.type==="timed"&&a.jsxs("div",{className:"pg-timer-area",children:[a.jsx("div",{className:"pg-timer-display",children:a.jsxs("span",{className:"pg-timer-value",children:[Q,"s"]})}),We?a.jsx("button",{className:"pg-timer-btn pg-timer-stop",onClick:()=>wt(!1),children:"Stop"}):a.jsx("button",{className:"pg-timer-btn",onClick:()=>{Q===0&&je(Ye.time),wt(!0)},children:Q<Ye.time&&Q>0?"Resume":"Start Timer"})]}),a.jsx("button",{className:"pg-log-set-btn",onClick:Pt,disabled:Fe.type==="timed"&&We,children:Me+1<Ye.sets?"Log Set":Te+1<Le?"Log Set  Next Exercise":"Log Set  Complete"}),Be?.sets?.length>0&&a.jsx("div",{className:"pg-completed-sets",children:Be.sets.map((Qe,Xe)=>a.jsxs("div",{className:"pg-completed-set",children:[a.jsx("span",{className:"pg-completed-set-check",children:""}),a.jsxs("span",{children:["Set ",Xe+1,": ",Qe.weight!==void 0?`${Qe.weight}kg  ${Qe.reps}`:Qe.time!==void 0?`${Qe.time}s`:`${Qe.reps} reps`]})]},Xe))})]}),Kt]})}if(y==="sessionComplete"){const Ee=St()?.days[J],Fe=j.reduce((Be,Me)=>Be+Me.sets.length,0),Ye=j.reduce((Be,Me)=>Be+Me.sets.reduce((Le,xt)=>Le+(xt.weight||0)*(xt.reps||0),0),0);return a.jsxs("div",{className:"pg-page pg-page-center","data-theme":l?"dark":"light","data-accent":h,children:[a.jsxs("div",{className:"pg-session-done",children:[a.jsxs("div",{className:"pg-done-ring",children:[a.jsx("svg",{className:"pg-done-ring-svg",viewBox:"0 0 200 200",children:au.map((Be,Me)=>a.jsx("line",{x1:Be.x1,y1:Be.y1,x2:Be.x2,y2:Be.y2,className:"pg-tick-complete",strokeWidth:Be.thick?"3.5":"2",style:{animationDelay:`${Me*.02}s`}},Me))}),a.jsx("div",{className:"pg-done-center",children:a.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})})})]}),a.jsx("h2",{className:"pg-done-title",children:"Session Complete!"}),a.jsxs("p",{className:"pg-done-subtitle",children:["Week ",V,"  ",Ee?.name,": ",Ee?.label]}),a.jsxs("div",{className:"pg-done-stats",children:[a.jsxs("div",{className:"pg-done-stat",children:[a.jsx("span",{className:"pg-done-stat-num",children:j.length}),a.jsx("span",{className:"pg-done-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"pg-done-stat",children:[a.jsx("span",{className:"pg-done-stat-num",children:Fe}),a.jsx("span",{className:"pg-done-stat-label",children:"Sets"})]}),Ye>0&&a.jsxs("div",{className:"pg-done-stat",children:[a.jsx("span",{className:"pg-done-stat-num",children:Math.round(Ye).toLocaleString()}),a.jsx("span",{className:"pg-done-stat-label",children:"Volume (kg)"})]})]}),a.jsx("button",{className:"pg-start-btn",onClick:()=>w("dashboard"),children:"Back to Programme"})]}),Se&&a.jsx("div",{className:"pg-badge-celebration",onClick:()=>qe(null),children:a.jsxs("div",{className:"pg-badge-celebration-card",onClick:Be=>Be.stopPropagation(),children:[a.jsx("div",{className:"pg-badge-celebration-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsx("h3",{className:"pg-badge-celebration-title",children:Se.badges.length===1?"Badge Earned!":`${Se.badges.length} Badges Earned!`}),a.jsx("div",{className:"pg-badge-celebration-list",children:Se.badges.map((Be,Me)=>a.jsx("div",{className:"pg-badge-celebration-item",children:Be.type==="pb_target"?`${Be.exercise}  ${Be.targetWeight}kg`:Be.label},Me))}),a.jsx("button",{className:"pg-badge-celebration-dismiss",onClick:()=>qe(null),children:"Tap to dismiss"})]})}),Kt]})}return null}const oD={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},lD={push:{label:"Push",color:"#c75f6b",icon:"M4 12h3l3-9 4 18 3-9h3"},pull:{label:"Pull",color:"#5f8ac7",icon:"M12 2v10m0 0l-4-4m4 4l4-4M4 20h16"},lower:{label:"Lower",color:"#5fc77a",icon:"M12 2v8m-4 4l4 8 4-8m-8 0h8"},core:{label:"Core",color:"#c7a45f",icon:"M12 2a4 4 0 014 4v1h-2V6a2 2 0 10-4 0v1H8V6a4 4 0 014-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}},$p=[{threshold:1e3,label:"1 Tonne",icon:"1T"},{threshold:5e3,label:"5 Tonne",icon:"5T"},{threshold:1e4,label:"10 Tonne",icon:"10T"},{threshold:25e3,label:"25 Tonne",icon:"25T"},{threshold:5e4,label:"50 Tonne",icon:"50T"},{threshold:1e5,label:"100 Tonne",icon:"100T"},{threshold:25e4,label:"250 Tonne",icon:"250T"},{threshold:5e5,label:"500 Tonne",icon:"500T"},{threshold:1e6,label:"1 Million kg",icon:"1M"}];function cD(s){return oD[s]||"push"}function uD(s){return s>=1e6?`${(s/1e6).toFixed(1)}M`:s>=1e3?`${(s/1e3).toFixed(1)}T`:`${Math.round(s)}`}function hD(s){return s>=1e6?"million kg":s>=1e3?"tonnes":"kg"}function dD(){const{currentUser:s,isClient:e,clientData:n,loading:i}=Xr(),{isDark:l,toggleTheme:u,accent:h}=Pa(),p=Zs(),[g,y]=x.useState(!0),[w,k]=x.useState(null),[E,O]=x.useState({});x.useEffect(()=>{!i&&(!s||!e)&&p("/")},[s,e,i,p]),x.useEffect(()=>{if(!n)return;(async()=>{try{const[R,P]=await Promise.all([qn(Ke(be,"coreBuddyAchievements",n.id)),qn(Ke(be,"coreBuddyPBs",n.id))]);R.exists()&&k(R.data()),P.exists()&&O(P.data().exercises||{})}catch(R){console.error("Error loading achievements:",R)}y(!1)})()},[n]);const G=w?.badges||[],U=w?.totalVolume||0,V=G.filter(j=>j.type==="pb_target"),ne=G.filter(j=>j.type==="volume_milestone"),J={push:[],pull:[],lower:[],core:[]};V.forEach(j=>{const R=j.group||cD(j.exercise);J[R]&&J[R].push(j)});const fe=$p.find(j=>U<j.threshold),Te=$p.filter(j=>U>=j.threshold).pop()?.threshold||0,$e=fe?(U-Te)/(fe.threshold-Te):1;if(i||g)return a.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsx("div",{className:"header-content",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),a.jsx("div",{className:"ach-loading-inline",children:a.jsx("div",{className:"cb-loading-spinner"})})]});const Ve=G.length,I=Ve>0||U>0;return a.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"ach-main",children:[a.jsx("button",{className:"nut-back-btn",onClick:()=>p("/client/personal-bests?mode=corebuddy"),children:" Back"}),a.jsxs("div",{className:"ach-stats-banner",children:[a.jsxs("div",{className:"ach-stat-item",children:[a.jsx("span",{className:"ach-stat-num",children:Ve}),a.jsx("span",{className:"ach-stat-label",children:Ve===1?"Badge":"Badges"})]}),a.jsx("div",{className:"ach-stat-divider"}),a.jsxs("div",{className:"ach-stat-item",children:[a.jsx("span",{className:"ach-stat-num",children:uD(U)}),a.jsxs("span",{className:"ach-stat-label",children:[hD(U)," lifted"]})]}),a.jsx("div",{className:"ach-stat-divider"}),a.jsxs("div",{className:"ach-stat-item",children:[a.jsx("span",{className:"ach-stat-num",children:Object.keys(E).length}),a.jsx("span",{className:"ach-stat-label",children:"PBs"})]})]}),!I&&a.jsxs("div",{className:"ach-empty",children:[a.jsx("div",{className:"ach-empty-icon",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M12 15l-3-3h6l-3 3z"}),a.jsx("path",{d:"M5 7h14l-1.5 9h-11L5 7z"}),a.jsx("path",{d:"M8.5 7V5a3.5 3.5 0 017 0v2"})]})}),a.jsx("h4",{children:"No achievements yet"}),a.jsx("p",{children:"Complete workouts to track volume and set PB targets to start earning badges."})]}),a.jsxs("div",{className:"ach-section",children:[a.jsxs("h3",{className:"ach-section-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})}),"Volume Milestones"]}),a.jsxs("div",{className:"ach-volume-hero",children:[a.jsxs("div",{className:"ach-volume-ring",children:[a.jsx("svg",{className:"ach-volume-ring-svg",viewBox:"0 0 200 200",children:au.map((j,R)=>{const P=R<Math.round($e*60);return a.jsx("line",{x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,className:P?"ach-tick-filled":"ach-tick-empty",strokeWidth:j.thick?"3":"2"},R)})}),a.jsxs("div",{className:"ach-volume-center",children:[a.jsx("span",{className:"ach-volume-number",children:Math.round(U).toLocaleString()}),a.jsx("span",{className:"ach-volume-unit",children:"kg lifted"})]})]}),fe&&a.jsxs("div",{className:"ach-volume-next",children:["Next: ",a.jsx("strong",{children:fe.label})," (",(fe.threshold-U).toLocaleString(),"kg to go)"]})]}),a.jsx("div",{className:"ach-milestone-shelf",children:$p.map((j,R)=>{const P=U>=j.threshold,D=ne.find(z=>z.milestone===j.threshold);return a.jsxs("div",{className:`ach-milestone ${P?"unlocked":"locked"}`,children:[a.jsx("div",{className:"ach-milestone-hex",children:a.jsx("span",{className:"ach-milestone-icon",children:j.icon})}),a.jsx("span",{className:"ach-milestone-label",children:j.label}),D?.achievedAt&&a.jsx("span",{className:"ach-milestone-date",children:(D.achievedAt.toDate?D.achievedAt.toDate():new Date(D.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short"})})]},R)})})]}),a.jsxs("div",{className:"ach-section",children:[a.jsxs("h3",{className:"ach-section-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"PB Target Badges"]}),V.length===0?a.jsx("div",{className:"ach-pb-empty",children:a.jsxs("p",{children:["Set targets on your personal bests to start earning badges. Go to ",a.jsx("strong",{children:"My Progress"}),' and tap "Set Target" on any PB.']})}):Object.entries(J).map(([j,R])=>{if(R.length===0)return null;const P=lD[j];return a.jsxs("div",{className:"ach-group",children:[a.jsxs("div",{className:"ach-group-header",style:{borderLeftColor:P.color},children:[a.jsx("span",{className:"ach-group-label",style:{color:P.color},children:P.label}),a.jsx("span",{className:"ach-group-count",children:R.length})]}),a.jsx("div",{className:"ach-badge-grid",children:R.map((D,z)=>a.jsxs("div",{className:"ach-badge-card",style:{animationDelay:`${z*.06}s`,"--group-color":P.color},children:[a.jsx("div",{className:"ach-badge-hex",style:{borderColor:P.color,boxShadow:`0 0 12px ${P.color}33`},children:a.jsx("svg",{className:"ach-badge-hex-icon",viewBox:"0 0 24 24",fill:"none",stroke:P.color,strokeWidth:"2",strokeLinecap:"round",children:a.jsx("path",{d:P.icon})})}),a.jsxs("div",{className:"ach-badge-info",children:[a.jsx("span",{className:"ach-badge-exercise",children:D.exercise}),a.jsxs("span",{className:"ach-badge-value",style:{color:P.color},children:[D.targetWeight,"kg"]}),D.achievedAt&&a.jsx("span",{className:"ach-badge-date",children:(D.achievedAt.toDate?D.achievedAt.toDate():new Date(D.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})})]})]},z))})]},j)})]})]}),a.jsx(Ma,{active:"home"})]})}const id=[{key:"trained",label:"Trained",icon:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2.71 7 4.14 8.43 7.71 4.86 16.29 13.43 12.71 17 14.14 18.43 15.57 17 17 18.43 14.14 21.29l1.43 1.43 1.43-1.43 1.43 1.43 2.14-2.14 1.43 1.43L22 20.57z"},{key:"protein",label:"Hit Protein",icon:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"},{key:"steps",label:"10k Steps",icon:"M13.5 5.5c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zM9.8 8.9L7 23h2.1l1.8-8 2.1 2v6h2v-7.5l-2.1-2 .6-3C14.8 12 16.8 13 19 13v-2c-1.9 0-3.5-1-4.3-2.4l-1-1.6c-.4-.6-1-1-1.7-1-.3 0-.5.1-.8.1L6 8.3V13h2V9.6l1.8-.7"},{key:"sleep",label:"8hrs Sleep",icon:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"},{key:"water",label:"2L Water",icon:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"}];function fD(s){const e=new Date(s),n=e.getDay(),i=n===0?-6:1-n;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function Wp(s){return s.toISOString().split("T")[0]}function mD(s){return Array.from({length:7},(e,n)=>{const i=new Date(s);return i.setDate(s.getDate()+n),i})}function pD(){const{currentUser:s,isClient:e,clientData:n,loading:i}=Xr(),{isDark:l,toggleTheme:u,accent:h}=Pa(),p=Zs(),[g,y]=x.useState({}),[w,k]=x.useState(!0),[E,O]=x.useState(!1),[G,U]=x.useState(0),[V,ne]=x.useState(null),[J,fe]=x.useState(null),[Te,$e]=x.useState(!1),Ve=x.useRef([]),I=x.useRef([]),j=x.useCallback((H,ye="info")=>{ne({message:H,type:ye}),setTimeout(()=>ne(null),3e3)},[]),R=new Date,P=Wp(R),D=fD(R),z=mD(D),M=["M","T","W","T","F","S","S"];x.useEffect(()=>{!i&&(!s||!e)&&p("/")},[s,e,i,p]),x.useEffect(()=>{if(!s||!n)return;(async()=>{try{const ye=Qt(be,"habitLogs"),Se=Pn(ye,fn("clientId","==",n.id)),qe=await jn(Se),Ae={};qe.docs.forEach(Je=>{const qt=Je.data();Ae[qt.date]={...qt,_id:Je.id}}),y(Ae);let nt=0;const pt=new Date(R);for(;;){const Je=Wp(pt),qt=Ae[Je];if(qt)if(Object.values(qt.habits||{}).filter(Boolean).length>=3)nt++,pt.setDate(pt.getDate()-1);else break;else if(Je===P)pt.setDate(pt.getDate()-1);else break}U(nt)}catch(ye){console.error("Error loading habit logs:",ye)}finally{k(!1)}})()},[s,n]);const We=g[P]||{habits:{}},wt=async H=>{if(!s||E)return;const ye=We.habits?.[H]||!1;ye||(Ve.current=[...Array(10)].map((Se,qe)=>{const Ae=qe/10*2*Math.PI,nt=18+Math.random()*20;return{tx:Math.cos(Ae)*nt,ty:Math.sin(Ae)*nt,size:3+Math.random()*4,duration:.4+Math.random()*.3}}),fe(H),setTimeout(()=>fe(null),700)),O(!0);try{const Se=We.habits||{},qe={...Se,[H]:!Se[H]},Ae=We._id||`${n.id}_${P}`;await Gn(Ke(be,"habitLogs",Ae),{clientId:n.id,date:P,habits:qe}),y(pt=>({...pt,[P]:{clientId:n.id,date:P,habits:qe,_id:Ae}})),Object.values(qe).filter(Boolean).length===id.length&&!ye&&(I.current=[...Array(50)].map((pt,Je)=>({x:5+Math.random()*90,delay:Math.random()*.6,color:["#4caf50","#ff9800","#2196f3","#e91e63","#ffeb3b","#9c27b0"][Je%6],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.5+Math.random()*1.5,width:4+Math.random()*8,height:4+Math.random()*10})),setTimeout(()=>{$e(!0),setTimeout(()=>$e(!1),3500)},500))}catch(Se){console.error("Error saving habit:",Se),j("Failed to save. Try again.","error")}finally{O(!1)}},Q=z.map(H=>{const ye=Wp(H),Se=g[ye],qe=Se?Object.values(Se.habits||{}).filter(Boolean).length:0;return{date:H,dateStr:ye,completed:qe,total:id.length}}),je=Q.reduce((H,ye)=>H+ye.completed,0),ze=Q.reduce((H,ye)=>H+ye.total,0),lt=ze>0?Math.round(je/ze*100):0,ie=Object.values(We.habits||{}).filter(Boolean).length,L=Math.round(ie/id.length*100);return a.jsxs("div",{className:"cbc-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),i||w?a.jsx("div",{className:"cbc-loading-inline",children:a.jsx("div",{className:"cbc-loading-spinner"})}):a.jsxs("main",{className:"cbc-main",children:[a.jsxs("div",{className:"cbc-ring-section",children:[a.jsxs("div",{className:"cbc-progress-ring",children:[a.jsxs("svg",{viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"cbc-arc-track",cx:"100",cy:"100",r:"80"}),a.jsx("circle",{className:"cbc-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-L/100*2*Math.PI*80})]}),a.jsxs("div",{className:"cbc-ring-center",children:[a.jsxs("span",{className:"cbc-ring-pct",children:[L,"%"]}),a.jsx("span",{className:"cbc-ring-label",children:"today"})]})]}),a.jsxs("div",{className:"cbc-streak",children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2",children:a.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),a.jsx("span",{className:"cbc-streak-count",children:G}),a.jsx("span",{className:"cbc-streak-label",children:"day streak"})]})]}),a.jsxs("div",{className:"cbc-section",children:[a.jsx("h2",{className:"cbc-section-title",children:"Today's Habits"}),a.jsx("div",{className:"cbc-habits",children:id.map(H=>{const ye=We.habits?.[H.key]||!1,Se=J===H.key;return a.jsxs("button",{className:`cbc-habit-btn cbc-habit-${H.key} ${ye?"cbc-habit-done":""} ${Se?"cbc-habit-just-checked":""}`,onClick:()=>wt(H.key),disabled:E,children:[a.jsx("div",{className:"cbc-habit-check",children:ye?a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("polyline",{points:"20 6 9 17 4 12",className:`cbc-check-path ${Se?"cbc-check-animate":""}`})}):a.jsx("div",{className:"cbc-habit-circle"})}),Se&&a.jsx("div",{className:"cbc-particles",children:Ve.current.map((qe,Ae)=>a.jsx("span",{className:"cbc-particle",style:{"--tx":`${qe.tx}px`,"--ty":`${qe.ty}px`,"--size":`${qe.size}px`,animationDuration:`${qe.duration}s`}},Ae))}),a.jsx("div",{className:`cbc-habit-icon cbc-icon-${H.key}`,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:H.icon})})}),a.jsx("span",{className:"cbc-habit-label",children:H.label})]},H.key)})})]}),a.jsxs("div",{className:"cbc-section",children:[a.jsx("h2",{className:"cbc-section-title",children:"This Week"}),a.jsx("div",{className:"cbc-week-grid",children:Q.map((H,ye)=>{const Se=H.dateStr===P,qe=H.total>0?H.completed/H.total:0,Ae=38,nt=2*Math.PI*Ae,pt=nt-qe*nt;return a.jsxs("div",{className:`cbc-day-ring ${Se?"cbc-day-today":""} ${H.completed>0?"cbc-day-active":""}`,children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cbc-day-track",cx:"50",cy:"50",r:Ae}),a.jsx("circle",{className:"cbc-day-fill",cx:"50",cy:"50",r:Ae,strokeDasharray:nt,strokeDashoffset:pt})]}),a.jsx("span",{className:"cbc-day-label",children:M[ye]}),a.jsxs("span",{className:"cbc-day-count",children:[H.completed,"/",H.total]})]},ye)})}),a.jsxs("div",{className:"cbc-week-summary",children:[a.jsx("div",{className:"cbc-week-summary-bar",children:a.jsx("div",{className:"cbc-week-summary-fill",style:{width:`${lt}%`}})}),a.jsxs("span",{className:"cbc-week-summary-text",children:[je," / ",ze," habits this week (",lt,"%)"]})]})]})]}),a.jsx(Ma,{active:"home"}),Te&&a.jsxs("div",{className:"cbc-celebration",onClick:()=>$e(!1),children:[a.jsx("div",{className:"cbc-confetti-container",children:I.current.map((H,ye)=>a.jsx("span",{className:"cbc-confetti-piece",style:{"--x":`${H.x}%`,"--delay":`${H.delay}s`,"--color":H.color,"--drift":`${H.drift}px`,"--spin":`${H.spin}deg`,"--duration":`${H.duration}s`,width:`${H.width}px`,height:`${H.height}px`}},ye))}),a.jsxs("div",{className:"cbc-celebration-card",children:[a.jsxs("svg",{className:"cbc-celebration-icon",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),a.jsx("h2",{className:"cbc-celebration-title",children:"Crushed it!"}),a.jsx("p",{className:"cbc-celebration-sub",children:"All habits complete today"})]})]}),V&&a.jsx("div",{className:`toast-notification ${V.type}`,children:V.message})]})}function od(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function b2(s,e){return[s,e].sort().join("_")}function gD(){const{currentUser:s,isClient:e,clientData:n,loading:i}=Xr(),{isDark:l,toggleTheme:u}=Pa(),h=Zs(),[p,g]=x.useState("buddies"),[y,w]=x.useState([]),[k,E]=x.useState([]),[O,G]=x.useState([]),[U,V]=x.useState(""),[ne,J]=x.useState([]),[fe,Te]=x.useState([]),[$e,Ve]=x.useState(!0),[I,j]=x.useState(null),[R,P]=x.useState(null),D=x.useCallback((ie,L="info")=>{P({message:ie,type:L}),setTimeout(()=>P(null),3500)},[]);x.useEffect(()=>{!i&&(!s||!e)&&h("/")},[s,e,i,h]);const z=x.useCallback(async()=>{if(n){Ve(!0);try{const ie=n.id,H=(await jn(Qt(be,"clients"))).docs.map(Je=>({id:Je.id,...Je.data()}));Te(H);const ye=Object.fromEntries(H.map(Je=>[Je.id,Je])),Se=await jn(Pn(Qt(be,"buddies"),fn("user1","==",ie))),qe=await jn(Pn(Qt(be,"buddies"),fn("user2","==",ie))),Ae=new Set;[...Se.docs,...qe.docs].forEach(Je=>{const qt=Je.data(),cn=qt.user1===ie?qt.user2:qt.user1;Ae.add(cn)}),w(Array.from(Ae).map(Je=>ye[Je]).filter(Boolean));const nt=await jn(Pn(Qt(be,"buddyRequests"),fn("toId","==",ie),fn("status","==","pending")));E(nt.docs.map(Je=>({reqId:Je.id,...Je.data(),fromClient:ye[Je.data().fromId]})).filter(Je=>Je.fromClient));const pt=await jn(Pn(Qt(be,"buddyRequests"),fn("fromId","==",ie),fn("status","==","pending")));G(pt.docs.map(Je=>({reqId:Je.id,...Je.data(),toClient:ye[Je.data().toId]})).filter(Je=>Je.toClient))}catch(ie){console.error("Error fetching buddy data:",ie),D("Failed to load buddies","error")}finally{Ve(!1)}}},[n,D]);x.useEffect(()=>{z()},[z]),x.useEffect(()=>{if(!U.trim()||!n){J([]);return}const ie=U.toLowerCase(),L=n.id,H=new Set(y.map(Ae=>Ae.id)),ye=new Set(O.map(Ae=>Ae.toId)),Se=new Set(k.map(Ae=>Ae.fromId)),qe=fe.filter(Ae=>Ae.id===L||!Ae.name||!Ae.coreBuddyAccess&&Ae.clientType!=="core_buddy"?!1:Ae.name.toLowerCase().includes(ie)).map(Ae=>({...Ae,isBuddy:H.has(Ae.id),isPendingOut:ye.has(Ae.id),isPendingIn:Se.has(Ae.id)})).slice(0,20);J(qe)},[U,fe,y,O,k,n]);const M=async(ie,L)=>{if(!(!n||ie===n.id))try{await ri(Qt(be,"notifications"),{toId:ie,fromId:n.id,fromName:n.name||"Someone",fromPhotoURL:n.photoURL||null,type:L,read:!1,createdAt:Kr()})}catch(H){console.error("Notification error:",H),H.code==="permission-denied"&&D("Notifications blocked  check Firestore rules","error")}},We=async ie=>{j(ie);try{const L=`${n.id}_${ie}`;await Gn(Ke(be,"buddyRequests",L),{fromId:n.id,toId:ie,status:"pending",createdAt:Kr()}),await M(ie,"buddy_request"),D("Buddy request sent!","success"),await z()}catch(L){console.error("Error sending request:",L),D("Failed to send request","error")}finally{j(null)}},wt=async ie=>{j(ie.reqId);try{const L=b2(ie.fromId,n.id);await Gn(Ke(be,"buddies",L),{user1:[ie.fromId,n.id].sort()[0],user2:[ie.fromId,n.id].sort()[1],connectedAt:Kr()}),await ar(Ke(be,"buddyRequests",ie.reqId)),await M(ie.fromId,"buddy_accept"),D("Buddy added!","success"),await z()}catch(L){console.error("Error accepting request:",L),D("Failed to accept","error")}finally{j(null)}},Q=async ie=>{j(ie.reqId);try{await ar(Ke(be,"buddyRequests",ie.reqId)),D("Request declined","info"),await z()}catch(L){console.error("Error declining:",L),D("Failed to decline","error")}finally{j(null)}},je=async ie=>{j(ie.reqId);try{await ar(Ke(be,"buddyRequests",ie.reqId)),D("Request cancelled","info"),await z()}catch(L){console.error("Error cancelling:",L),D("Failed to cancel","error")}finally{j(null)}},ze=async ie=>{j(ie);try{const L=b2(n.id,ie);await ar(Ke(be,"buddies",L)),D("Buddy removed","info"),await z()}catch(L){console.error("Error removing buddy:",L),D("Failed to remove buddy","error")}finally{j(null)}},lt=k.length;return i?a.jsx("div",{className:"bdy-loading",children:a.jsx("div",{className:"bdy-spinner"})}):!s||!e||!n?null:a.jsxs("div",{className:"bdy-page","data-theme":l?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>h("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"bdy-main",children:[a.jsx("h1",{className:"bdy-title",children:"Buddies"}),a.jsxs("button",{className:"bdy-leaderboard-link",onClick:()=>h("/client/leaderboard"),children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),a.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),a.jsx("rect",{x:"6",y:"9",width:"12",height:"13",rx:"2"}),a.jsx("path",{d:"M12 9v13"}),a.jsx("path",{d:"M2 22h20"})]}),a.jsx("span",{children:"Leaderboard"}),a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"bdy-tabs",children:[a.jsxs("button",{className:`bdy-tab${p==="buddies"?" active":""}`,onClick:()=>g("buddies"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"My Buddies"})]}),a.jsxs("button",{className:`bdy-tab${p==="requests"?" active":""}`,onClick:()=>g("requests"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),a.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),a.jsx("span",{children:"Requests"}),lt>0&&a.jsx("span",{className:"bdy-tab-badge",children:lt})]}),a.jsxs("button",{className:`bdy-tab${p==="search"?" active":""}`,onClick:()=>g("search"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Find"})]})]}),$e?a.jsx("div",{className:"bdy-content-loading",children:a.jsx("div",{className:"bdy-spinner"})}):a.jsxs(a.Fragment,{children:[p==="buddies"&&a.jsx("div",{className:"bdy-section",children:y.length===0?a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("h3",{children:"No buddies yet"}),a.jsx("p",{children:"Find members and send buddy requests to connect!"}),a.jsx("button",{className:"bdy-empty-btn",onClick:()=>g("search"),children:"Find Buddies"})]}):a.jsx("div",{className:"bdy-list",children:y.map(ie=>a.jsxs("div",{className:"bdy-card",onClick:()=>h(`/client/core-buddy/profile/${ie.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:ie.photoURL?a.jsx("img",{src:ie.photoURL,alt:ie.name}):a.jsx("span",{children:od(ie.name)})}),a.jsx("div",{className:"bdy-card-info",children:a.jsx("span",{className:"bdy-card-name",children:ie.name})}),a.jsx("button",{className:"bdy-remove-btn",onClick:L=>{L.stopPropagation(),ze(ie.id)},disabled:I===ie.id,"aria-label":"Remove buddy",children:I===ie.id?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},ie.id))})}),p==="requests"&&a.jsxs("div",{className:"bdy-section",children:[k.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Incoming"}),a.jsx("div",{className:"bdy-list",children:k.map(ie=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:ie.fromClient.photoURL?a.jsx("img",{src:ie.fromClient.photoURL,alt:ie.fromClient.name}):a.jsx("span",{children:od(ie.fromClient.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:ie.fromClient.name}),a.jsx("span",{className:"bdy-card-sub",children:"wants to be your buddy"})]}),a.jsxs("div",{className:"bdy-action-pair",children:[a.jsx("button",{className:"bdy-accept-btn",onClick:()=>wt(ie),disabled:I===ie.reqId,children:I===ie.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}),a.jsx("button",{className:"bdy-decline-btn",onClick:()=>Q(ie),disabled:I===ie.reqId,children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},ie.reqId))})]}),O.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Sent"}),a.jsx("div",{className:"bdy-list",children:O.map(ie=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:ie.toClient?.photoURL?a.jsx("img",{src:ie.toClient.photoURL,alt:ie.toClient.name}):a.jsx("span",{children:od(ie.toClient?.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:ie.toClient?.name}),a.jsx("span",{className:"bdy-card-sub",children:"pending"})]}),a.jsx("button",{className:"bdy-cancel-btn",onClick:()=>je(ie),disabled:I===ie.reqId,children:I===ie.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):"Cancel"})]},ie.reqId))})]}),k.length===0&&O.length===0&&a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),a.jsx("h3",{children:"No pending requests"}),a.jsx("p",{children:"All caught up!"})]})]}),p==="search"&&a.jsxs("div",{className:"bdy-section",children:[a.jsxs("div",{className:"bdy-search-bar",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("input",{type:"text",placeholder:"Search by name...",value:U,onChange:ie=>V(ie.target.value),autoFocus:!0}),U&&a.jsx("button",{className:"bdy-search-clear",onClick:()=>V(""),children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),U.trim()&&ne.length===0&&a.jsx("div",{className:"bdy-empty bdy-empty-sm",children:a.jsxs("p",{children:['No members found for "',U,'"']})}),ne.length>0&&a.jsx("div",{className:"bdy-list",children:ne.map(ie=>a.jsxs("div",{className:"bdy-card",onClick:()=>h(`/client/core-buddy/profile/${ie.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:ie.photoURL?a.jsx("img",{src:ie.photoURL,alt:ie.name}):a.jsx("span",{children:od(ie.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:ie.name}),ie.isBuddy&&a.jsx("span",{className:"bdy-card-badge",children:"Buddy"})]}),ie.isBuddy?a.jsx("span",{className:"bdy-status-icon",children:a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-success)",strokeWidth:"2.5",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):ie.isPendingOut?a.jsx("span",{className:"bdy-pending-label",children:"Pending"}):ie.isPendingIn?a.jsx("button",{className:"bdy-accept-btn",onClick:L=>{L.stopPropagation();const H=k.find(ye=>ye.fromId===ie.id);H&&wt(H)},disabled:!!I,children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):a.jsx("button",{className:"bdy-add-btn",onClick:L=>{L.stopPropagation(),We(ie.id)},disabled:I===ie.id,children:I===ie.id?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]},ie.id))})]})]})]}),a.jsx(Ma,{}),R&&a.jsxs("div",{className:`toast-notification ${R.type}`,children:[a.jsx("span",{className:"toast-icon",children:R.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):R.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:R.message})]})]})}function ld(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function Gp(s,e){return[s,e].sort().join("_")}const yD=5;function Kp(s){return s.toISOString().split("T")[0]}function vD(s){return s>=1e6?`${(s/1e6).toFixed(1)}M`:s>=1e3?`${(s/1e3).toFixed(1)}T`:`${Math.round(s)}`}const bD={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}};function x2(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),n=Math.floor((new Date-e)/1e3);return n<60?"just now":n<3600?`${Math.floor(n/60)}m ago`:n<86400?`${Math.floor(n/3600)}h ago`:n<604800?`${Math.floor(n/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function xD(){const{userId:s}=Jj(),{currentUser:e,isClient:n,clientData:i,loading:l}=Xr(),{isDark:u,toggleTheme:h}=Pa(),p=Zs(),[g,y]=x.useState(null),[w,k]=x.useState("none"),[E,O]=x.useState(null),[G,U]=x.useState(!0),[V,ne]=x.useState(!1),[J,fe]=x.useState(null),[Te,$e]=x.useState([]),[Ve,I]=x.useState(!1),[j,R]=x.useState(new Set),[P,D]=x.useState(new Set),[z,M]=x.useState({}),[We,wt]=x.useState({}),[Q,je]=x.useState({}),[ze,lt]=x.useState(!0),[ie,L]=x.useState(0),[H,ye]=x.useState(0),[Se,qe]=x.useState(0),[Ae,nt]=x.useState(0),[pt,Je]=x.useState([]),[qt,cn]=x.useState([]),[Nt,Ct]=x.useState(null),[oe,En]=x.useState(0),[Ht,St]=x.useState([]),[Bt,ht]=x.useState(!1),[et,tn]=x.useState(null),[ss,Pt]=x.useState([]),Et=x.useCallback((Y,Ne="info")=>{fe({message:Y,type:Ne}),setTimeout(()=>fe(null),3500)},[]);x.useEffect(()=>{!l&&(!e||!n)&&p("/")},[e,n,l,p]),x.useEffect(()=>{i&&s&&i.id===s&&p("/client/core-buddy",{replace:!0})},[i,s,p]),x.useEffect(()=>{if(!i||!s||i.id===s)return;let Y=!1;return(async()=>{U(!0);try{const Xe=(await jn(Qt(be,"clients"))).docs.map(nn=>({id:nn.id,...nn.data()})).find(nn=>nn.id===s);if(!Xe){Y||U(!1);return}Y||y(Xe);const dt=i.id,Ft=Gp(dt,s);if((await qn(Ke(be,"buddies",Ft))).exists())Y||k("buddy");else{const nn=`${dt}_${s}`,Vn=await qn(Ke(be,"buddyRequests",nn));if(Vn.exists()&&Vn.data().status==="pending")Y||(k("pending_out"),O(nn));else{const An=`${s}_${dt}`,rn=await qn(Ke(be,"buddyRequests",An));rn.exists()&&rn.data().status==="pending"?Y||(k("pending_in"),O(An)):Y||k("none")}}}catch(Ne){console.error("Error loading profile:",Ne)}finally{Y||U(!1)}})(),()=>{Y=!0}},[i,s]),x.useEffect(()=>{if(!s||!g)return;let Y=!1;return(async()=>{lt(!0);try{const[Ne,Qe,Xe,dt]=await Promise.all([jn(Pn(Qt(be,"workoutLogs"),fn("clientId","==",s))),qn(Ke(be,"coreBuddyAchievements",s)),qn(Ke(be,"coreBuddyPBs",s)),qn(Ke(be,"clientProgrammes",s))]);if(Y)return;const Ft=Ne.docs.length;L(Ft),Qe.exists()&&ye(Qe.data().totalVolume||0);let Rt=0;const nn=Ne.docs.map(rn=>rn.data().date).filter(Boolean).sort().reverse();if(nn.length>0){const rn=new Date;let yn=new Date(rn);for(let In=0;In<52;In++){const un=new Date(yn),rs=un.getDay(),q=rs===0?6:rs-1;un.setDate(un.getDate()-q),un.setHours(0,0,0,0);const pe=new Date(un);pe.setDate(pe.getDate()+7);const we=Kp(un),ve=Kp(pe);if(nn.some(st=>st>=we&&st<ve))Rt++;else{if(In>0)break;break}yn.setDate(yn.getDate()-7)}}if(Y||qe(Rt),Xe.exists()){const rn=Xe.data().exercises||{},yn=Object.entries(rn).sort(([,In],[,un])=>(un.weight||0)-(In.weight||0)).slice(0,3).map(([In,un])=>({name:In,weight:un.weight,reps:un.reps}));Y||Je(yn)}if(dt.exists()){const rn=dt.data(),yn=bD[rn.templateId];if(yn){const In=Object.keys(rn.completedSessions||{}).length,un=yn.duration*yn.daysPerWeek;Y||(Ct(rn.templateId.replace(/_/g," ").replace(/\b\w/g,rs=>rs.toUpperCase())),En(un>0?Math.round(In/un*100):0))}}const Vn=await qn(Ke(be,"achievements",s));if(!Y&&Vn.exists()){const rn=Vn.data().badges||{};cn(Object.keys(rn))}let An=0;for(let rn=0;rn<30;rn++){const yn=new Date;yn.setDate(yn.getDate()-rn);const In=Kp(yn);try{const un=await jn(Pn(Qt(be,"habitLogs"),fn("clientId","==",s),fn("date","==",In)));if(un.empty)break;{const rs=un.docs[0].data().habits||{};if(Object.values(rs).filter(Boolean).length>=yD)An++;else break}}catch{break}}Y||nt(An)}catch(Ne){console.error("Error loading buddy stats:",Ne)}finally{Y||lt(!1)}})(),()=>{Y=!0}},[s,g]),x.useEffect(()=>{if(!i)return;const Y=i.id;(async()=>{try{const[Ne,Qe,Xe]=await Promise.all([jn(Pn(Qt(be,"buddies"),fn("user1","==",Y))),jn(Pn(Qt(be,"buddies"),fn("user2","==",Y))),jn(Qt(be,"clients"))]),dt=new Set;[...Ne.docs,...Qe.docs].forEach(Rt=>{const nn=Rt.data();dt.add(nn.user1===Y?nn.user2:nn.user1)});const Ft={};Xe.docs.forEach(Rt=>{Ft[Rt.id]=Rt.data()}),St(Array.from(dt).filter(Rt=>Ft[Rt]).map(Rt=>({id:Rt,name:Ft[Rt].name,photoURL:Ft[Rt].photoURL||null})))}catch(Ne){console.error("Error loading buddies for mentions:",Ne)}})()},[i]);const Ln=async(Y,Ne,Qe={})=>{if(!(!i||Y===i.id))try{await ri(Qt(be,"notifications"),{toId:Y,fromId:i.id,fromName:i.name||"Someone",fromPhotoURL:i.photoURL||null,type:Ne,read:!1,createdAt:Kr(),...Qe})}catch(Xe){console.error("Notification error:",Xe),Xe.code==="permission-denied"&&Et("Notifications blocked  check Firestore rules","error")}},zt=async()=>{ne(!0);try{const Y=`${i.id}_${s}`;await Gn(Ke(be,"buddyRequests",Y),{fromId:i.id,toId:s,status:"pending",createdAt:Kr()}),await Ln(s,"buddy_request"),k("pending_out"),O(Y),Et("Buddy request sent!","success")}catch(Y){console.error(Y),Et("Failed to send request","error")}finally{ne(!1)}},Sn=async()=>{if(E){ne(!0);try{const Y=Gp(i.id,s);await Gn(Ke(be,"buddies",Y),{user1:[i.id,s].sort()[0],user2:[i.id,s].sort()[1],connectedAt:Kr()}),await ar(Ke(be,"buddyRequests",E)),await Ln(s,"buddy_accept"),k("buddy"),Et("Buddy added!","success")}catch(Y){console.error(Y),Et("Failed to accept","error")}finally{ne(!1)}}},Kt=async()=>{if(E){ne(!0);try{await ar(Ke(be,"buddyRequests",E)),k("none"),Et(w==="pending_out"?"Request cancelled":"Request declined","info")}catch(Y){console.error(Y),Et("Failed","error")}finally{ne(!1)}}},Nn=async()=>{ne(!0);try{const Y=Gp(i.id,s);await ar(Ke(be,"buddies",Y)),k("none"),Et("Buddy removed","info")}catch(Y){console.error(Y),Et("Failed to remove","error")}finally{ne(!1)}},me=x.useCallback(async()=>{if(s){I(!0);try{const Y=await jn(Pn(Qt(be,"posts"),fn("authorId","==",s),Hd("createdAt","desc"),$d(30)));if($e(Y.docs.map(Ne=>({id:Ne.id,...Ne.data()}))),i){const Ne=await jn(Pn(Qt(be,"postLikes"),fn("userId","==",i.id)));R(new Set(Ne.docs.map(Qe=>Qe.data().postId)))}}catch(Y){console.error("Error loading journey:",Y)}finally{I(!1)}}},[s,i]);x.useEffect(()=>{!G&&g&&me()},[G,g,me]);const Ee=async Y=>{if(window.confirm("Delete this post?"))try{await ar(Ke(be,"posts",Y)),$e(Ne=>Ne.filter(Qe=>Qe.id!==Y)),Et("Post deleted","info")}catch(Ne){console.error("Delete error:",Ne),Et("Failed to delete","error")}},Fe=async Y=>{if(!i)return;const Ne=i.id,Qe=`${Y}_${Ne}`,Xe=j.has(Y),dt=new Set(j);Xe?dt.delete(Y):dt.add(Y),R(dt),$e(Ft=>Ft.map(Rt=>Rt.id===Y?{...Rt,likeCount:Math.max(0,(Rt.likeCount||0)+(Xe?-1:1))}:Rt));try{if(Xe)await ar(Ke(be,"postLikes",Qe)),await Hi(Ke(be,"posts",Y),{likeCount:Mo(-1)});else{await Gn(Ke(be,"postLikes",Qe),{postId:Y,userId:Ne,createdAt:Kr()}),await Hi(Ke(be,"posts",Y),{likeCount:Mo(1)});const Ft=Te.find(Rt=>Rt.id===Y);Ft&&Ln(Ft.authorId,"like",{postId:Y})}}catch(Ft){console.error("Like error:",Ft),me()}},Ye=async Y=>{try{const Ne=await jn(Pn(Qt(be,"postComments"),fn("postId","==",Y),Hd("createdAt","asc"),$d(50)));M(Qe=>({...Qe,[Y]:Ne.docs.map(Xe=>({id:Xe.id,...Xe.data()}))}))}catch(Ne){console.error("Error loading comments:",Ne)}},Be=Y=>{const Ne=new Set(P);Ne.has(Y)?Ne.delete(Y):(Ne.add(Y),z[Y]||Ye(Y)),D(Ne)},Me=(Y,Ne)=>{const Qe=Y.match(/@(\w*)$/);if(Qe){ht(!0),tn(Ne);const Xe=Ht.filter(dt=>dt.name&&dt.name.toLowerCase().includes(Qe[1].toLowerCase())).slice(0,5);Pt(Xe)}else ht(!1),Pt([])},Le=(Y,Ne)=>{const Xe=(We[Ne]||"").replace(/@\w*$/,`@${Y.name} `);wt(dt=>({...dt,[Ne]:Xe})),ht(!1),Pt([])},xt=(Y,Ne)=>{wt(Qe=>({...Qe,[Y]:Ne})),Me(Ne,Y)},mt=async Y=>{const Ne=(We[Y]||"").trim();if(!(!Ne||!i)){je(Qe=>({...Qe,[Y]:!0}));try{await ri(Qt(be,"postComments"),{postId:Y,authorId:i.id,authorName:i.name||"Unknown",authorPhotoURL:i.photoURL||null,content:Ne,createdAt:Kr()}),await Hi(Ke(be,"posts",Y),{commentCount:Mo(1)});const Qe=Te.find(dt=>dt.id===Y);Qe&&Ln(Qe.authorId,"comment",{postId:Y});const Xe=Ne.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Xe){const dt=new Set;Xe.forEach(Ft=>{const Rt=Ft.slice(1).trim(),nn=Ht.find(Vn=>Vn.name&&Vn.name.toLowerCase()===Rt.toLowerCase());nn&&!dt.has(nn.id)&&(dt.add(nn.id),Ln(nn.id,"mention",{postId:Y}))})}wt(dt=>({...dt,[Y]:""})),$e(dt=>dt.map(Ft=>Ft.id===Y?{...Ft,commentCount:(Ft.commentCount||0)+1}:Ft)),await Ye(Y)}catch(Qe){console.error("Comment error:",Qe),Et("Failed to comment","error")}finally{je(Qe=>({...Qe,[Y]:!1}))}}};return l||G||!i?a.jsx("div",{className:"prf-loading","data-theme":u?"dark":"light",children:a.jsx("div",{className:"prf-spinner"})}):!e||!n?null:g?a.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:h,"aria-label":"Toggle theme",children:u?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"prf-main",children:[a.jsxs("div",{className:"prf-hero",children:[a.jsx("div",{className:"prf-avatar-lg",children:g.photoURL?a.jsx("img",{src:g.photoURL,alt:g.name}):a.jsx("span",{children:ld(g.name)})}),a.jsx("h1",{className:"prf-name",children:g.name}),a.jsxs("div",{className:"prf-buddy-action",children:[w==="none"&&a.jsx("button",{className:"prf-btn prf-btn-primary",onClick:zt,disabled:V,children:V?a.jsx("div",{className:"prf-btn-spinner"}):a.jsxs(a.Fragment,{children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Buddy"]})}),w==="pending_out"&&a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:Kt,disabled:V,children:V?a.jsx("div",{className:"prf-btn-spinner dark"}):"Cancel Request"}),w==="pending_in"&&a.jsxs("div",{className:"prf-btn-pair",children:[a.jsx("button",{className:"prf-btn prf-btn-success",onClick:Sn,disabled:V,children:V?a.jsx("div",{className:"prf-btn-spinner"}):"Accept"}),a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:Kt,disabled:V,children:"Decline"})]}),w==="buddy"&&a.jsx("button",{className:"prf-btn prf-btn-danger",onClick:Nn,disabled:V,children:V?a.jsx("div",{className:"prf-btn-spinner"}):"Remove Buddy"})]})]}),ze?a.jsx("div",{className:"prf-stats-loading",children:a.jsx("div",{className:"prf-spinner"})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"prf-stats",children:[a.jsxs("div",{className:"prf-stat",children:[a.jsx("span",{className:"prf-stat-value",children:ie}),a.jsx("span",{className:"prf-stat-label",children:"Workouts"})]}),a.jsxs("div",{className:"prf-stat",children:[a.jsxs("span",{className:"prf-stat-value",children:[vD(H),a.jsx("span",{className:"prf-stat-unit",children:H>=1e3?"":"kg"})]}),a.jsxs("span",{className:"prf-stat-label",children:[H>=1e6?"Million kg":H>=1e3?"Tonnes":"Volume"," Lifted"]})]}),a.jsxs("div",{className:"prf-stat",children:[a.jsxs("span",{className:"prf-stat-value",children:[Se,a.jsx("span",{className:"prf-stat-unit",children:"wk"})]}),a.jsx("span",{className:"prf-stat-label",children:"Streak"})]})]}),(Nt||Ae>0)&&a.jsxs("div",{className:"prf-info-row",children:[Nt&&a.jsxs("div",{className:"prf-info-card info-programme",children:[a.jsx("div",{className:"prf-info-icon",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),a.jsx("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"})]})}),a.jsxs("div",{className:"prf-info-text",children:[a.jsx("span",{className:"prf-info-label",children:Nt}),a.jsx("div",{className:"prf-info-progress-bar",children:a.jsx("div",{className:"prf-info-progress-fill",style:{width:`${Math.min(oe,100)}%`}})}),a.jsxs("span",{className:"prf-info-sub",children:[oe,"% complete"]})]})]}),Ae>0&&a.jsxs("div",{className:"prf-info-card info-habit",children:[a.jsx("div",{className:"prf-info-icon",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]})}),a.jsxs("div",{className:"prf-info-text",children:[a.jsxs("span",{className:"prf-info-value",children:[Ae," day",Ae!==1?"s":""]}),a.jsx("span",{className:"prf-info-sub",children:"Habit Streak"})]})]})]}),pt.length>0&&a.jsxs("div",{className:"prf-section",children:[a.jsx("h2",{className:"prf-section-title",children:"Top Lifts"}),a.jsx("div",{className:"prf-pb-list",children:pt.map((Y,Ne)=>a.jsxs("div",{className:"prf-pb-item",children:[a.jsx("div",{className:"prf-pb-rank",children:Ne===0?a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:a.jsx("path",{d:"M12 2l2.4 7.4H22l-6 4.4 2.3 7.2L12 16.6 5.7 21l2.3-7.2-6-4.4h7.6z"})}):`#${Ne+1}`}),a.jsx("span",{className:"prf-pb-name",children:Y.name}),a.jsxs("span",{className:"prf-pb-weight",children:[Y.weight,a.jsx("span",{className:"prf-pb-unit",children:"kg"})," x",Y.reps]})]},Ne))})]}),qt.length>0&&a.jsxs("div",{className:"prf-section",children:[a.jsxs("h2",{className:"prf-section-title",children:["Badges Earned (",qt.length,")"]}),a.jsx("div",{className:"prf-badge-row",children:qt.map(Y=>{const Ne={first_workout:"First Rep",workouts_10:"On Fire",workouts_25:"Lightning",workouts_50:"Iron Will",workouts_100:"Century",streak_2:"2 Wk Warrior",streak_4:"Month Strong",streak_8:"Unbreakable",programme_done:"Finisher",habits_7:"Habit Machine",nutrition_7:"Fuel Master",first_pb:"Record Breaker",pbs_5:"Climbing",leaderboard_join:"Competitor"};return a.jsxs("div",{className:"prf-badge-chip",children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:a.jsx("path",{d:"M12 2L15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26z"})}),a.jsx("span",{children:Ne[Y]||Y})]},Y)})})]})]}),a.jsxs("div",{className:"prf-section",children:[a.jsx("h2",{className:"prf-section-title",children:`${g.name?.split(" ")[0]}'s Journey`}),Ve?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"prf-spinner"})}):Te.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"No posts yet"})]}):a.jsx("div",{className:"journey-list",children:Te.map(Y=>a.jsxs("div",{className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:Y.authorPhotoURL?a.jsx("img",{src:Y.authorPhotoURL,alt:""}):a.jsx("span",{children:ld(Y.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:Y.authorName}),a.jsx("span",{className:"journey-post-time",children:x2(Y.createdAt)})]}),Y.authorId===i.id&&a.jsx("button",{className:"journey-delete-btn",onClick:()=>Ee(Y.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),Y.content&&a.jsx("p",{className:"journey-post-content",children:Y.content}),Y.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:Y.imageURL,alt:"Post",loading:"lazy"})}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${j.has(Y.id)?" liked":""}`,onClick:()=>Fe(Y.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:j.has(Y.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:Y.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${P.has(Y.id)?" active":""}`,onClick:()=>Be(Y.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:Y.commentCount||0})]})]}),P.has(Y.id)&&a.jsxs("div",{className:"journey-comments",children:[z[Y.id]?.length>0?z[Y.id].map(Ne=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",onClick:()=>p(`/client/core-buddy/profile/${Ne.authorId}`),children:Ne.authorPhotoURL?a.jsx("img",{src:Ne.authorPhotoURL,alt:""}):a.jsx("span",{children:ld(Ne.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:Ne.authorName}),a.jsx("span",{className:"journey-comment-text",children:Ne.content})]}),a.jsx("span",{className:"journey-comment-time",children:x2(Ne.createdAt)})]})]},Ne.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("input",{type:"text",placeholder:"Comment... (@ to mention)",value:We[Y.id]||"",onChange:Ne=>xt(Y.id,Ne.target.value),onKeyDown:Ne=>{Ne.key==="Enter"&&mt(Y.id)},maxLength:300}),Bt&&et===Y.id&&ss.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:ss.map(Ne=>a.jsxs("button",{className:"mention-option",onClick:()=>Le(Ne,Y.id),children:[a.jsx("div",{className:"mention-option-avatar",children:Ne.photoURL?a.jsx("img",{src:Ne.photoURL,alt:""}):a.jsx("span",{children:ld(Ne.name)})}),a.jsx("span",{children:Ne.name})]},Ne.id))}),a.jsx("button",{onClick:()=>mt(Y.id),disabled:!(We[Y.id]||"").trim()||Q[Y.id],children:Q[Y.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},Y.id))})]})]}),a.jsx(Ma,{}),J&&a.jsxs("div",{className:`toast-notification ${J.type}`,children:[a.jsx("span",{className:"toast-icon",children:J.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):J.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:J.message})]})]}):a.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions"})]})}),a.jsx("main",{className:"prf-main",children:a.jsx("p",{style:{textAlign:"center",color:"var(--text-tertiary)",padding:"40px 0"},children:"User not found"})}),a.jsx(Ma,{})]})}const ia=[{key:"pressUps",name:"Press-Ups",category:"Upper Body",unit:"reps"},{key:"squats",name:"Squats",category:"Lower Body",unit:"reps"},{key:"longJump",name:"Standing Long Jump",category:"Power",unit:"distance"},{key:"deadHang",name:"Dead Hang",category:"Upper Body",unit:"time"},{key:"plank",name:"Plank",category:"Core",unit:"time"},{key:"wallSit",name:"Wall Sit",category:"Lower Body",unit:"time"},{key:"chestPress",name:"Chest Press",category:"Upper Body",unit:"weight"}],Co=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function wD(){const s=new Date;return`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}`}function oa(s){const[e,n]=s.split("-");return new Date(parseInt(e),parseInt(n)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function _D(s){if(!s&&s!==0)return"-";const e=Math.floor(s/60),n=(s%60).toFixed(2);return e>0?`${e}m ${parseFloat(n).toFixed(0)}s`:`${parseFloat(n).toFixed(2)}s`}function kD(s,e){return!s&&s!==0?"-":!e&&e!==0?`${s}kg`:`${s}kg x ${e}`}function cd(s,e){if(!e)return"-";switch(s.unit){case"weight":return kD(e.weight,e.reps);case"time":return _D(e.time);case"reps":return e.reps?`${e.reps} reps`:"-";case"distance":return e.distance?`${e.distance} cm`:"-";default:return"-"}}function Nl(s,e){if(!e)return 0;switch(s.unit){case"weight":return(e.weight||0)*(e.reps||0);case"time":return e.time||0;case"reps":return e.reps||0;case"distance":return e.distance||0;default:return 0}}function Yp(s,e){return!e||e===0?null:(s-e)/e*100}function TD({data:s,exerciseKey:e,unit:n}){if(!s||s.length<2)return a.jsx("div",{className:"pb-trend-empty",children:a.jsx("p",{children:"Not enough data for trend line yet"})});const i=s.map(U=>{const V=U.benchmarks?.[e];if(!V)return 0;switch(n){case"weight":return(V.weight||0)*(V.reps||0);case"time":return V.time||0;case"reps":return V.reps||0;case"distance":return V.distance||0;default:return 0}}),l=Math.max(...i),u=Math.min(...i),h=l-u||1,p=300,g=100,y=20,w=p-y*2,k=g-y*2,E=i.map((U,V)=>{const ne=y+V/(i.length-1)*w,J=y+k-(U-u)/h*k;return{x:ne,y:J,value:U}}),O=E.map((U,V)=>`${V===0?"M":"L"} ${U.x} ${U.y}`).join(" "),G=O+` L ${E[E.length-1].x} ${y+k} L ${E[0].x} ${y+k} Z`;return a.jsxs("div",{className:"pb-trend-chart",children:[a.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[a.jsx("defs",{children:a.jsxs("linearGradient",{id:"trendGradientJr",x1:"0",y1:"0",x2:"0",y2:"1",children:[a.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),a.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),a.jsx("path",{d:G,fill:"url(#trendGradientJr)"}),a.jsx("path",{d:O,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),E.map((U,V)=>a.jsx("circle",{cx:U.x,cy:U.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},V))]}),a.jsx("div",{className:"pb-trend-labels",children:s.map((U,V)=>a.jsxs("span",{className:"pb-trend-label",children:[U.month.split("-")[1],"/",U.month.split("-")[0].slice(2)]},V))})]})}function jD(){const[s,e]=x.useState("bests"),[n,i]=x.useState([]),[l,u]=x.useState(!0),[h,p]=x.useState(!1),[g,y]=x.useState(0),[w,k]=x.useState(!1),[E,O]=x.useState(!1),[G,U]=x.useState(!1),[V,ne]=x.useState({}),[J,fe]=x.useState({}),[Te,$e]=x.useState({}),[Ve,I]=x.useState({}),[j,R]=x.useState({}),[P,D]=x.useState(!1),[z,M]=x.useState({}),[We,wt]=x.useState([]),[Q,je]=x.useState(null),[ze,lt]=x.useState(null),[ie,L]=x.useState(!1),[H,ye]=x.useState(""),[Se,qe]=x.useState(""),Ae=x.useRef(null),nt=x.useRef(0),pt=x.useRef(0),Je=x.useRef("right"),qt=x.useCallback(q=>{y(pe=>{const we=Math.max(0,Math.min(ia.length-1,q));return we===pe?pe:(Je.current=we>pe?"right":"left",we)})},[]),{currentUser:cn,isClient:Nt,clientData:Ct,loading:oe}=Xr(),{isDark:En}=Pa(),Ht=Zs(),St=x.useCallback((q,pe="info")=>{lt({message:q,type:pe}),setTimeout(()=>lt(null),4e3)},[]);x.useEffect(()=>{!oe&&(!cn||!Nt)&&Ht("/")},[cn,Nt,oe,Ht]),x.useEffect(()=>{Ct&&Bt()},[Ct]);const Bt=async()=>{try{const q=Pn(Qt(be,"juniorPBs"),fn("clientId","==",Ct.id)),we=(await jn(q)).docs.map(ct=>({id:ct.id,...ct.data()}));we.sort((ct,_t)=>ct.month.localeCompare(_t.month)),i(we);const ve=Pn(Qt(be,"juniorPBTargets"),fn("clientId","==",Ct.id)),ge=await jn(ve);if(!ge.empty){const ct=ge.docs[0].data();$e(ct.targets||{}),I(ct.metricTargets||{}),R(ct.targets||{}),M(ct.metricTargets||{})}const st=Pn(Qt(be,"juniorAchievements"),fn("clientId","==",Ct.id)),At=await jn(st);At.empty||wt(At.docs[0].data().badges||[])}catch(q){console.error("Error fetching junior personal bests:",q)}u(!1)},ht=wD(),et=n.find(q=>q.month===ht),tn=n.filter(q=>q.month<ht),ss=tn.length>0?tn[tn.length-1]:null;x.useEffect(()=>{et?(ne(et.benchmarks||{}),fe(et.bodyMetrics||{})):(ne({}),fe({}))},[et?.id]);const Pt=async(q,pe)=>{const we=[];if(q==="strength"?ia.forEach(ve=>{const ge=Te[ve.key];if(!ge)return;const st=pe[ve.key];if(!st)return;let At;if(ge.targetType==="time"){if(!ge.targetValue)return;const ct=ge.startValue||0,_t=st.time||0,vt=ge.targetValue-ct;At=vt===0?_t>=ge.targetValue?1:0:Math.max(0,(_t-ct)/vt)}else if(ge.targetType==="reps"){if(!ge.targetReps)return;const ct=ge.startReps||0,_t=st.reps||0,vt=ge.targetReps-ct;At=vt===0?_t>=ge.targetReps?1:0:Math.max(0,(_t-ct)/vt)}else if(ge.targetType==="distance"){if(!ge.targetDistance)return;const ct=ge.startDistance||0,_t=st.distance||0,vt=ge.targetDistance-ct;At=vt===0?_t>=ge.targetDistance?1:0:Math.max(0,(_t-ct)/vt)}else{if(!ge.targetWeight&&!ge.targetReps)return;const ct=(ge.startWeight||0)*(ge.startReps||0),_t=(ge.targetWeight||0)*(ge.targetReps||0),vt=(st.weight||0)*(st.reps||0),vn=_t-ct;At=vn===0?vt>=_t?1:0:Math.max(0,(vt-ct)/vn)}if(At>=1){let ct,_t;ge.targetType==="time"?(ct=We.some(vt=>vt.type==="strength"&&vt.key===ve.key&&vt.targetValue===ge.targetValue),_t=`${ve.name} ${ge.targetValue}s`):ge.targetType==="reps"?(ct=We.some(vt=>vt.type==="strength"&&vt.key===ve.key&&vt.targetReps===ge.targetReps),_t=`${ve.name} ${ge.targetReps} reps`):ge.targetType==="distance"?(ct=We.some(vt=>vt.type==="strength"&&vt.key===ve.key&&vt.targetDistance===ge.targetDistance),_t=`${ve.name} ${ge.targetDistance}cm`):(ct=We.some(vt=>vt.type==="strength"&&vt.key===ve.key&&vt.targetWeight===ge.targetWeight&&vt.targetReps===ge.targetReps),_t=`${ve.name} ${ge.targetWeight}kg  ${ge.targetReps}`),ct||we.push({type:"strength",key:ve.key,...ge.targetType==="time"?{targetType:"time",targetValue:ge.targetValue}:ge.targetType==="reps"?{targetType:"reps",targetReps:ge.targetReps}:ge.targetType==="distance"?{targetType:"distance",targetDistance:ge.targetDistance}:{targetWeight:ge.targetWeight,targetReps:ge.targetReps},achievedMonth:ht,label:_t})}}):Co.forEach(ve=>{const ge=Ve[ve.key];if(!ge||!ge.targetValue)return;const st=pe[ve.key];if(st==null)return;const At=ge.startValue||0,ct=ge.targetValue,_t=ct-At;(_t===0?st===ct?1:0:Math.max(0,(st-At)/_t))>=1&&(We.some(er=>er.type==="metric"&&er.key===ve.key&&er.targetValue===ct)||we.push({type:"metric",key:ve.key,targetValue:ct,achievedMonth:ht,label:`${ve.name} ${ct}${ve.suffix}`}))}),we.length>0){const ve=[...We,...we];await Gn(Ke(be,"juniorAchievements",Ct.id),{clientId:Ct.id,badges:ve,updatedAt:bt.now()}),wt(ve),je(we),setTimeout(()=>je(null),5e3)}},Et=(q,pe)=>{if(q==="strength"){const we=Te[pe];if(!we)return!1;switch(ia.find(ge=>ge.key===pe)?.unit){case"time":return We.some(ge=>ge.type==="strength"&&ge.key===pe&&ge.targetValue===we.targetValue);case"reps":return We.some(ge=>ge.type==="strength"&&ge.key===pe&&ge.targetReps===we.targetReps);case"distance":return We.some(ge=>ge.type==="strength"&&ge.key===pe&&ge.targetDistance===we.targetDistance);default:return!we.targetWeight&&!we.targetReps?!1:We.some(ge=>ge.type==="strength"&&ge.key===pe&&ge.targetWeight===we.targetWeight&&ge.targetReps===we.targetReps)}}else{const we=Ve[pe];return!we||!we.targetValue?!1:We.some(ve=>ve.type==="metric"&&ve.key===pe&&ve.targetValue===we.targetValue)}},Ln=async()=>{p(!0);try{const q=`${Ct.id}_${ht}`,pe=et||{};await Gn(Ke(be,"juniorPBs",q),{clientId:Ct.id,month:ht,benchmarks:V,bodyMetrics:pe.bodyMetrics||J||{},createdAt:pe.createdAt||bt.now(),updatedAt:bt.now()}),await Pt("strength",V),St("Benchmarks saved!","success"),k(!1),await Bt()}catch(q){console.error("Error saving benchmarks:",q),St("Failed to save. Please try again.","error")}p(!1)},zt=async()=>{p(!0);try{const q=`${Ct.id}_${ht}`,pe=et||{};await Gn(Ke(be,"juniorPBs",q),{clientId:Ct.id,month:ht,benchmarks:pe.benchmarks||V||{},bodyMetrics:J,createdAt:pe.createdAt||bt.now(),updatedAt:bt.now()}),await Pt("metric",J),St("Body metrics saved!","success"),O(!1),await Bt()}catch(q){console.error("Error saving metrics:",q),St("Failed to save. Please try again.","error")}p(!1)},Sn=(q,pe,we)=>{ne(ve=>({...ve,[q]:{...ve[q],[pe]:we===""?"":parseFloat(we)}}))},Kt=(q,pe)=>{fe(we=>({...we,[q]:pe===""?"":parseFloat(pe)}))},Nn=(q,pe,we)=>{R(ve=>({...ve,[q]:{...ve[q],[pe]:we===""?"":parseFloat(we)}}))},me=async()=>{p(!0);try{const q=`targets_${Ct.id}`,pe=et?.benchmarks||{},we={};ia.forEach(ve=>{const ge=pe[ve.key];switch(ve.unit){case"time":j[ve.key]?.targetValue&&(we[ve.key]={targetType:"time",targetValue:j[ve.key].targetValue,startValue:ge?.time||0});break;case"reps":j[ve.key]?.targetReps&&(we[ve.key]={targetType:"reps",targetReps:j[ve.key].targetReps,startReps:ge?.reps||0});break;case"distance":j[ve.key]?.targetDistance&&(we[ve.key]={targetType:"distance",targetDistance:j[ve.key].targetDistance,startDistance:ge?.distance||0});break;default:(j[ve.key]?.targetWeight||j[ve.key]?.targetReps)&&(we[ve.key]={targetWeight:j[ve.key].targetWeight||0,targetReps:j[ve.key].targetReps||0,startWeight:ge?.weight||0,startReps:ge?.reps||0})}}),await Gn(Ke(be,"juniorPBTargets",q),{clientId:Ct.id,targets:we,metricTargets:Ve,updatedAt:bt.now()}),$e(we),R(we),St("Targets saved!","success"),U(!1)}catch(q){console.error("Error saving targets:",q),St("Failed to save targets.","error")}p(!1)},Ee=(q,pe)=>{M(we=>({...we,[q]:{...we[q],targetValue:pe===""?"":parseFloat(pe)}}))},Fe=async()=>{p(!0);try{const q=`targets_${Ct.id}`,pe={};Co.forEach(we=>{if(z[we.key]?.targetValue){const ve=et?.bodyMetrics?.[we.key]||0;pe[we.key]={targetValue:z[we.key].targetValue,startValue:ve}}}),await Gn(Ke(be,"juniorPBTargets",q),{clientId:Ct.id,targets:Te,metricTargets:pe,updatedAt:bt.now()}),I(pe),M(pe),St("Metric targets saved!","success"),D(!1)}catch(q){console.error("Error saving metric targets:",q),St("Failed to save targets.","error")}p(!1)},Ye=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const q=Ke(be,"juniorPBTargets",`targets_${Ct.id}`);await ar(q),$e({}),I({}),R({}),M({}),St("All goals have been reset","success")}catch(q){console.error("Error resetting targets:",q),St("Failed to reset goals","error")}p(!1)}},Be=(q,pe)=>{const we=Te[q];if(!we||!pe)return null;if(we.targetType==="time"){if(!we.targetValue)return null;const ct=we.startValue||0,_t=we.targetValue,vt=pe.time||0,vn=_t-ct;return vn<=0?vt>=_t?1:0:Math.max(0,Math.min((vt-ct)/vn,1))}if(we.targetType==="reps"){if(!we.targetReps)return null;const ct=we.startReps||0,_t=we.targetReps,vt=pe.reps||0,vn=_t-ct;return vn<=0?vt>=_t?1:0:Math.max(0,Math.min((vt-ct)/vn,1))}if(we.targetType==="distance"){if(!we.targetDistance)return null;const ct=we.startDistance||0,_t=we.targetDistance,vt=pe.distance||0,vn=_t-ct;return vn<=0?vt>=_t?1:0:Math.max(0,Math.min((vt-ct)/vn,1))}if(!we.targetWeight&&!we.targetReps)return null;const ve=(we.startWeight||0)*(we.startReps||0),ge=(we.targetWeight||0)*(we.targetReps||0),st=(pe.weight||0)*(pe.reps||0),At=ge-ve;return At<=0?st>=ge?1:0:Math.max(0,Math.min((st-ve)/At,1))},Me=q=>{const pe=Ve[q];if(!pe||!pe.targetValue)return null;const we=et?.bodyMetrics?.[q];if(we==null)return null;const ve=pe.startValue||0,ge=pe.targetValue,st=ge-ve;return st===0?we===ge?1:0:Math.max(0,Math.min((we-ve)/st,1))},Le=q=>{nt.current=q.touches[0].clientX,pt.current=0},xt=q=>{pt.current=q.touches[0].clientX-nt.current},mt=()=>{pt.current<-50?qt(g+1):pt.current>50&&qt(g-1),pt.current=0},Y=q=>{const pe=et?.bodyMetrics?.[q],we=ss?.bodyMetrics?.[q];return pe==null||we==null?null:parseFloat((pe-we).toFixed(2))},Ne=n.find(q=>q.month===H),Qe=n.find(q=>q.month===Se);if(oe||l)return a.jsxs("div",{className:"pb-page",children:[a.jsx("header",{className:"client-header",children:a.jsx("div",{className:"header-content",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),a.jsxs("main",{className:"pb-main",children:[a.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),a.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!cn||!Nt||!Ct)return null;const Xe=ia[g],dt=et?.benchmarks?.[Xe.key],Ft=ss?.benchmarks?.[Xe.key],Rt=Nl(Xe,dt),nn=Nl(Xe,Ft),Vn=Yp(Rt,nn),An=Be(Xe.key,dt),rn=An!==null,yn=An!==null&&An>=1,In=rn?Math.round(An*60):Rt>0?15:0,un=Te[Xe.key],rs=q=>q?q.targetType==="time"?`${q.startValue||0}s  ${q.targetValue}s`:q.targetType==="reps"?`${q.startReps||0}  ${q.targetReps} reps`:q.targetType==="distance"?`${q.startDistance||0}  ${q.targetDistance}cm`:`${q.startWeight||0}kg${q.startReps||0}  ${q.targetWeight}kg${q.targetReps}`:null;return a.jsxs("div",{className:"pb-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>Ht("/client"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsxs("main",{className:"pb-main page-transition-enter",children:[a.jsxs("div",{className:"pb-intro",children:[a.jsx("h2",{children:"Junior Strength Tests"}),a.jsx("p",{children:"Track your strength test results and body measurements each month."})]}),a.jsxs("div",{className:"pb-tabs",children:[a.jsx("button",{className:`pb-tab ${s==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),a.jsx("button",{className:`pb-tab ${s==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),a.jsx("button",{className:`pb-tab ${s==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),s==="bests"&&a.jsxs("div",{className:"pb-strength-section",children:[!w&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-carousel",ref:Ae,onTouchStart:Le,onTouchMove:xt,onTouchEnd:mt,children:[a.jsx("div",{className:`pb-ring-container slide-from-${Je.current}`,children:a.jsxs("div",{className:"pb-ring",children:[a.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:$y.map((q,pe)=>{const we=pe<Math.round(In);return a.jsx("line",{x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,className:`pb-ring-tick ${we?yn?"hit":"filled":"empty"}`,strokeWidth:q.thick?"3":"2"},pe)})}),a.jsxs("div",{className:"pb-ring-center",children:[a.jsx("div",{className:"pb-ring-category",children:Xe.category}),a.jsxs("div",{className:"pb-ring-exercise",children:[Xe.name,Et("strength",Xe.key)&&a.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),a.jsx("div",{className:"pb-ring-value",children:dt?cd(Xe,dt):"-"}),Vn!==null&&a.jsxs("div",{className:`pb-ring-change ${Vn>=0?"positive":"negative"}`,children:[Vn>=0?"+":"",Vn.toFixed(1),"%"]}),Vn===null&&dt&&a.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),un&&a.jsx("div",{className:`pb-ring-target ${yn?"hit":""}`,children:yn?"Target hit!":rs(un)}),!un&&a.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),a.jsx("div",{className:"pb-carousel-dots",children:ia.map((q,pe)=>a.jsx("button",{className:`pb-dot ${pe===g?"active":""}`,onClick:()=>qt(pe)},pe))}),a.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>qt(g-1),disabled:g===0,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),a.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>qt(g+1),disabled:g===ia.length-1,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),a.jsxs("div",{className:"pb-trend-section",children:[a.jsx("h4",{children:"Trend"}),a.jsx(TD,{data:n,exerciseKey:Xe.key,unit:Xe.unit})]})]}),!w&&!G&&a.jsxs("div",{className:"pb-action-buttons",children:[a.jsx("button",{className:"pb-edit-btn",onClick:()=>k(!0),children:et?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),a.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>U(!0),children:Object.keys(Te).length>0?"Edit Targets":"Set Targets"}),(Object.keys(Te).length>0||Object.keys(Ve).length>0)&&a.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Ye,disabled:h,children:"Reset All Goals"})]}),w&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsxs("h3",{children:["Benchmarks - ",oa(ht)]}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{k(!1),ne(et?.benchmarks||{})},children:""})]}),a.jsx("div",{className:"pb-edit-body",children:ia.map(q=>a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:q.name}),q.unit==="weight"?a.jsxs("div",{className:"pb-edit-row",children:[a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",step:"0.5",value:V[q.key]?.weight??"",onChange:pe=>Sn(q.key,"weight",pe.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",value:V[q.key]?.reps??"",onChange:pe=>Sn(q.key,"reps",pe.target.value),placeholder:"0"})]})]}):q.unit==="reps"?a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Reps (max in 1 min)"}),a.jsx("input",{type:"number",value:V[q.key]?.reps??"",onChange:pe=>Sn(q.key,"reps",pe.target.value),placeholder:"0"})]})}):q.unit==="distance"?a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Distance (cm)"}),a.jsx("input",{type:"number",step:"0.5",value:V[q.key]?.distance??"",onChange:pe=>Sn(q.key,"distance",pe.target.value),placeholder:"0"})]})}):a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Time (seconds)"}),a.jsx("input",{type:"number",step:"0.01",value:V[q.key]?.time??"",onChange:pe=>Sn(q.key,"time",pe.target.value),placeholder:"0"})]})})]},q.key))}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{k(!1),ne(et?.benchmarks||{})},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Ln,disabled:h,children:h?"Saving...":"Save"})]})]}),G&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsx("h3",{children:"Set Your Targets"}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{U(!1),R(Te)},children:""})]}),a.jsxs("div",{className:"pb-edit-body",children:[a.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),ia.map(q=>{const pe=et?.benchmarks?.[q.key];let we="-";if(pe)switch(q.unit){case"weight":(pe.weight||pe.reps)&&(we=`${pe.weight||0}kg  ${pe.reps||0}`);break;case"time":pe.time&&(we=`${pe.time}s`);break;case"reps":pe.reps&&(we=`${pe.reps} reps`);break;case"distance":pe.distance&&(we=`${pe.distance} cm`);break}return a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsxs("div",{className:"pb-edit-exercise-header",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:q.name}),a.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",we]})]}),q.unit==="weight"?a.jsxs("div",{className:"pb-edit-row",children:[a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Target Weight (kg)"}),a.jsx("input",{type:"number",step:"0.5",value:j[q.key]?.targetWeight??"",onChange:ve=>Nn(q.key,"targetWeight",ve.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Target Reps"}),a.jsx("input",{type:"number",value:j[q.key]?.targetReps??"",onChange:ve=>Nn(q.key,"targetReps",ve.target.value),placeholder:"0"})]})]}):q.unit==="reps"?a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Target Reps (in 1 min)"}),a.jsx("input",{type:"number",value:j[q.key]?.targetReps??"",onChange:ve=>Nn(q.key,"targetReps",ve.target.value),placeholder:"0"})]})}):q.unit==="distance"?a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Target Distance (cm)"}),a.jsx("input",{type:"number",step:"0.5",value:j[q.key]?.targetDistance??"",onChange:ve=>Nn(q.key,"targetDistance",ve.target.value),placeholder:"0"})]})}):a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Target (seconds)"}),a.jsx("input",{type:"number",step:"1",value:j[q.key]?.targetValue??"",onChange:ve=>Nn(q.key,"targetValue",ve.target.value),placeholder:"0"})]})})]},q.key)})]}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{U(!1),R(Te)},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:me,disabled:h,children:h?"Saving...":"Save Targets"})]})]})]}),s==="metrics"&&a.jsxs("div",{className:"pb-metrics-section",children:[!E&&!P&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-metrics-card",children:[a.jsx("h3",{children:"Body Measurements"}),a.jsx("p",{className:"pb-metrics-month",children:oa(ht)}),a.jsx("div",{className:"pb-metrics-list",children:Co.map(q=>{const pe=et?.bodyMetrics?.[q.key],we=Y(q.key),ve=Ve[q.key],ge=Me(q.key),st=ge!==null&&ge>=1;return a.jsxs("div",{className:"pb-metric-row",children:[a.jsxs("div",{className:"pb-metric-top",children:[a.jsxs("div",{className:"pb-metric-left",children:[a.jsxs("span",{className:"pb-metric-name",children:[q.name,Et("metric",q.key)&&a.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),ve&&a.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",ve.targetValue," ",q.suffix]})]}),a.jsxs("div",{className:"pb-metric-values",children:[a.jsx("span",{className:"pb-metric-current",children:pe!=null?`${pe} ${q.suffix}`:"-"}),we!==null&&a.jsxs("span",{className:`pb-metric-change ${we>0?"up":we<0?"down":"same"}`,children:[we>0?"+":"",we," ",q.suffix]})]})]}),ge!==null&&a.jsxs("div",{className:"pb-metric-progress",children:[a.jsx("div",{className:"pb-metric-bar",children:a.jsx("div",{className:`pb-metric-bar-fill ${st?"hit":""}`,style:{width:`${Math.round(ge*100)}%`}})}),a.jsx("span",{className:`pb-metric-percent ${st?"hit":""}`,children:st?"Hit!":`${Math.round(ge*100)}%`})]})]},q.key)})})]}),a.jsxs("div",{className:"pb-action-buttons",children:[a.jsx("button",{className:"pb-edit-btn",onClick:()=>O(!0),children:et?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),a.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>D(!0),children:Object.keys(Ve).length>0?"Edit Targets":"Set Targets"}),(Object.keys(Te).length>0||Object.keys(Ve).length>0)&&a.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Ye,disabled:h,children:"Reset All Goals"})]})]}),E&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsxs("h3",{children:["Measurements - ",oa(ht)]}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{O(!1),fe(et?.bodyMetrics||{})},children:""})]}),a.jsx("div",{className:"pb-edit-body",children:Co.map(q=>a.jsx("div",{className:"pb-edit-metric",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsxs("label",{children:[q.name," (",q.suffix,")"]}),a.jsx("input",{type:"number",step:"0.1",value:J[q.key]??"",onChange:pe=>Kt(q.key,pe.target.value),placeholder:"0"})]})},q.key))}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{O(!1),fe(et?.bodyMetrics||{})},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:zt,disabled:h,children:h?"Saving...":"Save"})]})]}),P&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsx("h3",{children:"Body Metric Targets"}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{D(!1),M(Ve)},children:""})]}),a.jsxs("div",{className:"pb-edit-body",children:[a.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),Co.map(q=>{const pe=et?.bodyMetrics?.[q.key];return a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsxs("div",{className:"pb-edit-exercise-header",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:q.name}),a.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",pe!=null?`${pe} ${q.suffix}`:"-"]})]}),a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsxs("label",{children:["Target (",q.suffix,")"]}),a.jsx("input",{type:"number",step:"0.1",value:z[q.key]?.targetValue??"",onChange:we=>Ee(q.key,we.target.value),placeholder:"0"})]})})]},q.key)})]}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{D(!1),M(Ve)},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Fe,disabled:h,children:h?"Saving...":"Save Targets"})]})]})]}),s==="history"&&a.jsx("div",{className:"pb-history-section",children:n.length===0?a.jsxs("div",{className:"pb-empty",children:[a.jsx("h4",{children:"No records yet"}),a.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):a.jsxs(a.Fragment,{children:[We.length>0&&a.jsxs("div",{className:"pb-achievements-wall",children:[a.jsxs("h4",{className:"pb-achievements-wall-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),a.jsx("div",{className:"pb-achievements-list",children:[...We].reverse().map((q,pe)=>a.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${pe*.05}s`},children:[a.jsx("div",{className:"pb-achievement-star",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("div",{className:"pb-achievement-info",children:[a.jsx("span",{className:"pb-achievement-label",children:q.label}),a.jsx("span",{className:"pb-achievement-date",children:oa(q.achievedMonth)})]})]},pe))})]}),a.jsx("div",{className:"pb-history-controls",children:a.jsx("button",{className:`pb-compare-toggle ${ie?"active":""}`,onClick:()=>{L(!ie),!ie&&n.length>=2&&(ye(n[0].month),qe(n[n.length-1].month))},children:ie?"Back to Timeline":"Compare Months"})}),ie?a.jsxs("div",{className:"pb-compare",children:[a.jsxs("div",{className:"pb-compare-selectors",children:[a.jsxs("div",{className:"pb-compare-select",children:[a.jsx("label",{children:"From"}),a.jsx("select",{value:H,onChange:q=>ye(q.target.value),children:n.map(q=>a.jsx("option",{value:q.month,children:oa(q.month)},q.month))})]}),a.jsx("div",{className:"pb-compare-vs",children:"vs"}),a.jsxs("div",{className:"pb-compare-select",children:[a.jsx("label",{children:"To"}),a.jsx("select",{value:Se,onChange:q=>qe(q.target.value),children:n.map(q=>a.jsx("option",{value:q.month,children:oa(q.month)},q.month))})]})]}),Ne&&Qe&&a.jsxs("div",{className:"pb-compare-results",children:[a.jsxs("div",{className:"pb-compare-group",children:[a.jsx("h4",{children:"Strength Tests"}),a.jsxs("div",{className:"pb-compare-table",children:[a.jsxs("div",{className:"pb-compare-header-row",children:[a.jsx("span",{children:"Exercise"}),a.jsx("span",{children:oa(H).split(" ")[0]}),a.jsx("span",{children:oa(Se).split(" ")[0]}),a.jsx("span",{children:"Change"})]}),ia.map(q=>{const pe=Ne.benchmarks?.[q.key],we=Qe.benchmarks?.[q.key],ve=Nl(q,pe),ge=Nl(q,we),st=Yp(ge,ve);return a.jsxs("div",{className:"pb-compare-row",children:[a.jsx("span",{className:"pb-compare-name",children:q.name}),a.jsx("span",{className:"pb-compare-val",children:pe?cd(q,pe):"-"}),a.jsx("span",{className:"pb-compare-val",children:we?cd(q,we):"-"}),a.jsx("span",{className:`pb-compare-change ${st!==null?st>=0?"positive":"negative":""}`,children:st!==null?`${st>=0?"+":""}${st.toFixed(1)}%`:"-"})]},q.key)})]})]}),a.jsxs("div",{className:"pb-compare-group",children:[a.jsx("h4",{children:"Body Measurements"}),a.jsxs("div",{className:"pb-compare-table",children:[a.jsxs("div",{className:"pb-compare-header-row",children:[a.jsx("span",{children:"Measurement"}),a.jsx("span",{children:oa(H).split(" ")[0]}),a.jsx("span",{children:oa(Se).split(" ")[0]}),a.jsx("span",{children:"Change"})]}),Co.map(q=>{const pe=Ne.bodyMetrics?.[q.key],we=Qe.bodyMetrics?.[q.key],ve=pe!=null&&we!=null?parseFloat((we-pe).toFixed(2)):null;return a.jsxs("div",{className:"pb-compare-row",children:[a.jsx("span",{className:"pb-compare-name",children:q.name}),a.jsx("span",{className:"pb-compare-val",children:pe!=null?`${pe}`:"-"}),a.jsx("span",{className:"pb-compare-val",children:we!=null?`${we}`:"-"}),a.jsx("span",{className:`pb-compare-change ${ve!==null?ve>0?"positive":ve<0?"negative":"neutral":""}`,children:ve!==null?`${ve>0?"+":""}${ve} ${q.suffix}`:"-"})]},q.key)})]})]})]})]}):a.jsx("div",{className:"pb-timeline",children:[...n].reverse().map((q,pe)=>{const we=n.filter(ve=>ve.month<q.month).pop();return a.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${pe*.05}s`},children:[a.jsx("div",{className:"pb-timeline-dot"}),a.jsxs("div",{className:"pb-timeline-card",children:[a.jsx("h4",{children:oa(q.month)}),q.benchmarks&&Object.keys(q.benchmarks).length>0&&a.jsxs("div",{className:"pb-timeline-group",children:[a.jsx("h5",{children:"Strength Tests"}),ia.map(ve=>{const ge=q.benchmarks[ve.key];if(!ge)return null;const st=we?.benchmarks?.[ve.key],At=Nl(ve,ge),ct=Nl(ve,st),_t=Yp(At,ct);return a.jsxs("div",{className:"pb-timeline-row",children:[a.jsx("span",{className:"pb-timeline-label",children:ve.name}),a.jsxs("div",{className:"pb-timeline-values",children:[a.jsx("span",{className:"pb-timeline-value",children:cd(ve,ge)}),_t!==null&&a.jsxs("span",{className:`pb-timeline-change ${_t>=0?"positive":"negative"}`,children:[_t>=0?"+":"",_t.toFixed(1),"%"]})]})]},ve.key)})]}),q.bodyMetrics&&Object.keys(q.bodyMetrics).length>0&&a.jsxs("div",{className:"pb-timeline-group",children:[a.jsx("h5",{children:"Body Measurements"}),Co.map(ve=>{const ge=q.bodyMetrics[ve.key];if(ge==null)return null;const st=we?.bodyMetrics?.[ve.key],At=st!=null?parseFloat((ge-st).toFixed(2)):null;return a.jsxs("div",{className:"pb-timeline-row",children:[a.jsx("span",{className:"pb-timeline-label",children:ve.name}),a.jsxs("div",{className:"pb-timeline-values",children:[a.jsxs("span",{className:"pb-timeline-value",children:[ge," ",ve.suffix]}),At!==null&&a.jsxs("span",{className:`pb-timeline-change ${At>0?"positive":At<0?"negative":"neutral"}`,children:[At>0?"+":"",At," ",ve.suffix]})]})]},ve.key)})]})]})]},q.id)})})]})})]}),Q&&a.jsx("div",{className:"pb-celebration-overlay",onClick:()=>je(null),children:a.jsxs("div",{className:"pb-celebration-card",children:[a.jsx("div",{className:"pb-celebration-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsx("h3",{className:"pb-celebration-title",children:Q.length===1?"Target Achieved!":`${Q.length} Targets Achieved!`}),a.jsx("div",{className:"pb-celebration-badges",children:Q.map((q,pe)=>a.jsx("div",{className:"pb-celebration-badge",children:q.label},pe))}),a.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),ze&&a.jsxs("div",{className:`toast-notification ${ze.type}`,children:[a.jsx("span",{className:"toast-icon",children:ze.type==="success"?a.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),a.jsx("span",{className:"toast-message",children:ze.message}),a.jsx("button",{className:"toast-close",onClick:()=>lt(null),children:""})]}),a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:"block-nav-tab",onClick:()=>Ht("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),a.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),a.jsx("span",{children:"Home"})]}),a.jsxs("button",{className:"block-nav-tab",onClick:()=>Ht("/client/forms"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),a.jsx("span",{children:"Forms"})]}),a.jsxs("button",{className:"block-nav-tab",onClick:()=>Ht("/client/tools"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),a.jsx("span",{children:"Tools"})]}),a.jsxs("button",{className:"block-nav-tab active",children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 20V10"}),a.jsx("path",{d:"M18 20V4"}),a.jsx("path",{d:"M6 20v-4"})]}),a.jsx("span",{children:"PBs"})]}),Ct?.circuitAccess&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>Ht("/client/circuit"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 6v6l4 2"})]}),a.jsx("span",{children:"Circuit"})]})]})]})}const _a=[{key:"chestPress",name:"Chest Press",category:"Upper Body - Push",unit:"weight"},{key:"shoulderPress",name:"Shoulder Press",category:"Upper Body - Push",unit:"weight"},{key:"seatedRow",name:"Seated Row",category:"Upper Body - Pull",unit:"weight"},{key:"latPulldown",name:"Lat Pulldown",category:"Upper Body - Pull",unit:"weight"},{key:"squat",name:"Squat",category:"Lower Body",unit:"weight"},{key:"deadlift",name:"Deadlift",category:"Lower Body",unit:"weight"},{key:"plank",name:"Plank",category:"Core",unit:"time"}],Ro=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function ED(){const s=new Date;return`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}`}function la(s){const[e,n]=s.split("-");return new Date(parseInt(e),parseInt(n)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function ud(s){if(!s&&s!==0)return"-";const e=Math.floor(s/60),n=(s%60).toFixed(2);return e>0?`${e}m ${parseFloat(n).toFixed(0)}s`:`${parseFloat(n).toFixed(2)}s`}function w2(s,e){return!s&&s!==0?"-":!e&&e!==0?`${s}kg`:`${s}kg x ${e}`}function Cl(s,e){return e?s.unit==="time"?e.time||0:(e.weight||0)*(e.reps||0):0}function Qp(s,e){return!e||e===0?null:(s-e)/e*100}function SD({data:s,exerciseKey:e,unit:n}){if(!s||s.length<2)return a.jsx("div",{className:"pb-trend-empty",children:a.jsx("p",{children:"Not enough data for trend line yet"})});const i=s.map(U=>{const V=U.benchmarks?.[e];return V?n==="time"?V.time||0:(V.weight||0)*(V.reps||0):0}),l=Math.max(...i),u=Math.min(...i),h=l-u||1,p=300,g=100,y=20,w=p-y*2,k=g-y*2,E=i.map((U,V)=>{const ne=y+V/(i.length-1)*w,J=y+k-(U-u)/h*k;return{x:ne,y:J,value:U}}),O=E.map((U,V)=>`${V===0?"M":"L"} ${U.x} ${U.y}`).join(" "),G=O+` L ${E[E.length-1].x} ${y+k} L ${E[0].x} ${y+k} Z`;return a.jsxs("div",{className:"pb-trend-chart",children:[a.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[a.jsx("defs",{children:a.jsxs("linearGradient",{id:"trendGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[a.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),a.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),a.jsx("path",{d:G,fill:"url(#trendGradient)"}),a.jsx("path",{d:O,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),E.map((U,V)=>a.jsx("circle",{cx:U.x,cy:U.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},V))]}),a.jsx("div",{className:"pb-trend-labels",children:s.map((U,V)=>a.jsxs("span",{className:"pb-trend-label",children:[U.month.split("-")[1],"/",U.month.split("-")[0].slice(2)]},V))})]})}function ND(){const[s,e]=x.useState("bests"),[n,i]=x.useState([]),[l,u]=x.useState(!0),[h,p]=x.useState(!1),[g,y]=x.useState(0),[w,k]=x.useState(!1),[E,O]=x.useState(!1),[G,U]=x.useState(!1),[V,ne]=x.useState({}),[J,fe]=x.useState({}),[Te,$e]=x.useState({}),[Ve,I]=x.useState({}),[j,R]=x.useState({}),[P,D]=x.useState(!1),[z,M]=x.useState({}),[We,wt]=x.useState([]),[Q,je]=x.useState(null),[ze,lt]=x.useState(null),[ie,L]=x.useState(!1),[H,ye]=x.useState(""),[Se,qe]=x.useState(""),[Ae,nt]=x.useState({}),[pt,Je]=x.useState({}),[qt,cn]=x.useState(null),[Nt,Ct]=x.useState(null),[oe,En]=x.useState(""),Ht=x.useRef(null),St=x.useRef(0),Bt=x.useRef(0),ht=x.useRef("right"),et=x.useCallback(F=>{y(ce=>{const T=Math.max(0,Math.min(_a.length-1,F));return T===ce?ce:(ht.current=T>ce?"right":"left",T)})},[]),{currentUser:tn,isClient:ss,clientData:Pt,loading:Et}=Xr(),{isDark:Ln}=Pa(),zt=Zs(),[Sn]=HE(),Kt=Sn.get("mode")==="corebuddy",Nn=!Kt&&(!Pt?.clientType||Pt.clientType==="block"),me=x.useCallback((F,ce="info")=>{lt({message:F,type:ce}),setTimeout(()=>lt(null),4e3)},[]);x.useEffect(()=>{!Et&&(!tn||!ss)&&zt("/")},[tn,ss,Et,zt]),x.useEffect(()=>{Pt&&(Nn?Ee():(async()=>{try{const[ce,T,C]=await Promise.all([qn(Ke(be,"coreBuddyPBs",Pt.id)),qn(Ke(be,"coreBuddyTargets",Pt.id)),qn(Ke(be,"coreBuddyAchievements",Pt.id))]);ce.exists()&&nt(ce.data().exercises||{}),T.exists()&&Je(T.data().targets||{}),C.exists()&&cn(C.data())}catch(ce){console.error("Error loading Core Buddy PBs:",ce)}u(!1)})())},[Pt]);const Ee=async()=>{try{const F=Pn(Qt(be,"personalBests"),fn("clientId","==",Pt.id)),T=(await jn(F)).docs.map(Ue=>({id:Ue.id,...Ue.data()}));T.sort((Ue,Oe)=>Ue.month.localeCompare(Oe.month)),i(T);const C=Pn(Qt(be,"personalBestTargets"),fn("clientId","==",Pt.id)),K=await jn(C);if(!K.empty){const Ue=K.docs[0].data();$e(Ue.targets||{}),I(Ue.metricTargets||{}),R(Ue.targets||{}),M(Ue.metricTargets||{})}const te=Pn(Qt(be,"achievements"),fn("clientId","==",Pt.id)),He=await jn(te);He.empty||wt(He.docs[0].data().badges||[])}catch(F){console.error("Error fetching personal bests:",F)}u(!1)},Fe=async()=>{if(!Nt||!oe||!Pt)return;const F=parseFloat(oe),ce=Ae[Nt];if(!ce||F<=ce.weight){me("Target must be higher than current PB","error");return}p(!0);try{const T={...pt,[Nt]:{targetWeight:F,setAt:bt.now(),currentPBWhenSet:ce.weight}};await Gn(Ke(be,"coreBuddyTargets",Pt.id),{clientId:Pt.id,targets:T,updatedAt:bt.now()}),Je(T),Ct(null),En(""),me("Target set!","success")}catch(T){console.error("Error saving target:",T),me("Failed to save target","error")}p(!1)},Ye=F=>{if(!qt?.badges)return!1;const ce=pt[F];return ce?qt.badges.some(T=>T.type==="pb_target"&&T.exercise===F&&T.targetWeight===ce.targetWeight):!1},Be=F=>{const ce=pt[F];if(!ce)return null;const T=Ae[F];if(!T)return 0;const C=ce.currentPBWhenSet||0,K=ce.targetWeight,te=K-C;return te<=0?T.weight>=K?1:0:Math.max(0,Math.min((T.weight-C)/te,1))},Me=ED(),Le=n.find(F=>F.month===Me),xt=n.filter(F=>F.month<Me),mt=xt.length>0?xt[xt.length-1]:null;x.useEffect(()=>{Le?(ne(Le.benchmarks||{}),fe(Le.bodyMetrics||{})):(ne({}),fe({}))},[Le?.id]);const Y=async(F,ce)=>{const T=[];if(F==="strength"?_a.forEach(C=>{const K=Te[C.key];if(!K)return;const te=ce[C.key];if(!te)return;let He;if(K.targetType==="time"){if(!K.targetValue)return;const Ue=K.startValue||0,Oe=te.time||0,Ut=K.targetValue-Ue;He=Ut===0?Oe>=K.targetValue?1:0:Math.max(0,(Oe-Ue)/Ut)}else{if(!K.targetWeight&&!K.targetReps)return;const Ue=(K.startWeight||0)*(K.startReps||0),Oe=(K.targetWeight||0)*(K.targetReps||0),Ut=(te.weight||0)*(te.reps||0),kt=Oe-Ue;He=kt===0?Ut>=Oe?1:0:Math.max(0,(Ut-Ue)/kt)}if(He>=1&&!(K.targetType==="time"?We.some(Oe=>Oe.type==="strength"&&Oe.key===C.key&&Oe.targetValue===K.targetValue):We.some(Oe=>Oe.type==="strength"&&Oe.key===C.key&&Oe.targetWeight===K.targetWeight&&Oe.targetReps===K.targetReps))){const Oe=K.targetType==="time"?`${C.name} ${K.targetValue}s`:`${C.name} ${K.targetWeight}kg  ${K.targetReps}`;T.push({type:"strength",key:C.key,...K.targetType==="time"?{targetType:"time",targetValue:K.targetValue}:{targetWeight:K.targetWeight,targetReps:K.targetReps},achievedMonth:Me,label:Oe})}}):Ro.forEach(C=>{const K=Ve[C.key];if(!K||!K.targetValue)return;const te=ce[C.key];if(te==null)return;const He=K.startValue||0,Ue=K.targetValue,Oe=Ue-He;(Oe===0?te===Ue?1:0:Math.max(0,(te-He)/Oe))>=1&&(We.some($=>$.type==="metric"&&$.key===C.key&&$.targetValue===Ue)||T.push({type:"metric",key:C.key,targetValue:Ue,achievedMonth:Me,label:`${C.name} ${Ue}${C.suffix}`}))}),T.length>0){const C=[...We,...T];await Gn(Ke(be,"achievements",Pt.id),{clientId:Pt.id,badges:C,updatedAt:bt.now()}),wt(C),je(T),setTimeout(()=>je(null),5e3)}},Ne=(F,ce)=>{if(F==="strength"){const T=Te[ce];return T?T.targetType==="time"?We.some(C=>C.type==="strength"&&C.key===ce&&C.targetValue===T.targetValue):!T.targetWeight&&!T.targetReps?!1:We.some(C=>C.type==="strength"&&C.key===ce&&C.targetWeight===T.targetWeight&&C.targetReps===T.targetReps):!1}else{const T=Ve[ce];return!T||!T.targetValue?!1:We.some(C=>C.type==="metric"&&C.key===ce&&C.targetValue===T.targetValue)}},Qe=async()=>{p(!0);try{const F=`${Pt.id}_${Me}`,ce=Le||{};await Gn(Ke(be,"personalBests",F),{clientId:Pt.id,month:Me,benchmarks:V,bodyMetrics:ce.bodyMetrics||J||{},createdAt:ce.createdAt||bt.now(),updatedAt:bt.now()}),await Y("strength",V),me("Benchmarks saved!","success"),k(!1),await Ee()}catch(F){console.error("Error saving benchmarks:",F),me("Failed to save. Please try again.","error")}p(!1)},Xe=async()=>{p(!0);try{const F=`${Pt.id}_${Me}`,ce=Le||{};await Gn(Ke(be,"personalBests",F),{clientId:Pt.id,month:Me,benchmarks:ce.benchmarks||V||{},bodyMetrics:J,createdAt:ce.createdAt||bt.now(),updatedAt:bt.now()}),await Y("metric",J),me("Body metrics saved!","success"),O(!1),await Ee()}catch(F){console.error("Error saving metrics:",F),me("Failed to save. Please try again.","error")}p(!1)},dt=(F,ce,T)=>{ne(C=>({...C,[F]:{...C[F],[ce]:T===""?"":parseFloat(T)}}))},Ft=(F,ce)=>{fe(T=>({...T,[F]:ce===""?"":parseFloat(ce)}))},Rt=(F,ce,T)=>{R(C=>({...C,[F]:{...C[F],[ce]:T===""?"":parseFloat(T)}}))},nn=async()=>{p(!0);try{const F=`targets_${Pt.id}`,ce=Le?.benchmarks||{},T={};_a.forEach(C=>{const K=ce[C.key];C.unit==="time"?j[C.key]?.targetValue&&(T[C.key]={targetType:"time",targetValue:j[C.key].targetValue,startValue:K?.time||0}):(j[C.key]?.targetWeight||j[C.key]?.targetReps)&&(T[C.key]={targetWeight:j[C.key].targetWeight||0,targetReps:j[C.key].targetReps||0,startWeight:K?.weight||0,startReps:K?.reps||0})}),await Gn(Ke(be,"personalBestTargets",F),{clientId:Pt.id,targets:T,metricTargets:Ve,updatedAt:bt.now()}),$e(T),R(T),me("Targets saved!","success"),U(!1)}catch(F){console.error("Error saving targets:",F),me("Failed to save targets.","error")}p(!1)},Vn=(F,ce)=>{M(T=>({...T,[F]:{...T[F],targetValue:ce===""?"":parseFloat(ce)}}))},An=async()=>{p(!0);try{const F=`targets_${Pt.id}`,ce={};Ro.forEach(T=>{if(z[T.key]?.targetValue){const C=Le?.bodyMetrics?.[T.key]||0;ce[T.key]={targetValue:z[T.key].targetValue,startValue:C}}}),await Gn(Ke(be,"personalBestTargets",F),{clientId:Pt.id,targets:Te,metricTargets:ce,updatedAt:bt.now()}),I(ce),M(ce),me("Metric targets saved!","success"),D(!1)}catch(F){console.error("Error saving metric targets:",F),me("Failed to save targets.","error")}p(!1)},rn=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const F=Ke(be,"personalBestTargets",`targets_${Pt.id}`);await ar(F),$e({}),I({}),R({}),M({}),me("All goals have been reset","success")}catch(F){console.error("Error resetting targets:",F),me("Failed to reset goals","error")}p(!1)}},yn=(F,ce)=>{const T=Te[F];if(!T||!ce)return null;if(T.targetType==="time"){if(!T.targetValue)return null;const Ue=T.startValue||0,Oe=T.targetValue,Ut=ce.time||0,kt=Oe-Ue;return kt<=0?Ut>=Oe?1:0:Math.max(0,Math.min((Ut-Ue)/kt,1))}if(!T.targetWeight&&!T.targetReps)return null;const C=(T.startWeight||0)*(T.startReps||0),K=(T.targetWeight||0)*(T.targetReps||0),te=(ce.weight||0)*(ce.reps||0),He=K-C;return He<=0?te>=K?1:0:Math.max(0,Math.min((te-C)/He,1))},In=F=>{const ce=Ve[F];if(!ce||!ce.targetValue)return null;const T=Le?.bodyMetrics?.[F];if(T==null)return null;const C=ce.startValue||0,K=ce.targetValue,te=K-C;return te===0?T===K?1:0:Math.max(0,Math.min((T-C)/te,1))},un=F=>{St.current=F.touches[0].clientX,Bt.current=0},rs=F=>{Bt.current=F.touches[0].clientX-St.current},q=()=>{Bt.current<-50?et(g+1):Bt.current>50&&et(g-1),Bt.current=0},pe=F=>{const ce=Le?.bodyMetrics?.[F],T=mt?.bodyMetrics?.[F];return ce==null||T==null?null:parseFloat((ce-T).toFixed(2))},we=n.find(F=>F.month===H),ve=n.find(F=>F.month===Se);if(Et||l)return a.jsxs("div",{className:"pb-page",children:[a.jsx("header",{className:"client-header",children:a.jsx("div",{className:"header-content",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),a.jsxs("main",{className:"pb-main",children:[a.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),a.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!tn||!ss||!Pt)return null;if(Nn&&Pt?.isJunior)return a.jsx(jD,{});const ge=_a[g],st=Le?.benchmarks?.[ge.key],At=mt?.benchmarks?.[ge.key],ct=Cl(ge,st),_t=Cl(ge,At),vt=Qp(ct,_t),vn=yn(ge.key,st),er=vn!==null,_s=vn!==null&&vn>=1,Ds=er?Math.round(vn*60):ct>0?15:0,Bn=Te[ge.key];return a.jsxs("div",{className:"pb-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>zt(Kt?"/client/core-buddy":"/client"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsxs("main",{className:"pb-main page-transition-enter",children:[a.jsxs("div",{className:"pb-intro",children:[a.jsx("h2",{children:"Personal Bests"}),a.jsx("p",{children:Nn?"Track your strength benchmarks and body measurements each month.":"Your all-time best lifts from programme workouts."})]}),!Nn&&a.jsxs("div",{className:"pb-cb-section",children:[Object.keys(Ae).length===0?a.jsxs("div",{className:"pb-empty",children:[a.jsx("div",{className:"pb-cb-empty-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),a.jsx("h4",{children:"No personal bests yet"}),a.jsx("p",{children:"Complete weight-based workouts to start tracking your personal bests."})]}):a.jsx("div",{className:"pb-cb-grid",children:Object.entries(Ae).sort(([F],[ce])=>F.localeCompare(ce)).map(([F,ce],T)=>{const C=pt[F],K=Be(F),te=K!==null&&K>=1,He=Ye(F),Ue=K!==null?Math.round(K*60):60;return a.jsxs("div",{className:"pb-cb-card",style:{animationDelay:`${T*.05}s`},children:[a.jsxs("div",{className:"pb-cb-card-ring",children:[a.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:P3.map((Oe,Ut)=>{const kt=Ut<Ue;return a.jsx("line",{x1:Oe.x1,y1:Oe.y1,x2:Oe.x2,y2:Oe.y2,className:`pb-ring-tick ${kt?te?"hit":"filled":"empty"}`,strokeWidth:Oe.thick?"2":"1.5"},Ut)})}),a.jsx("div",{className:"pb-cb-ring-icon",children:He?a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})})]}),a.jsxs("div",{className:"pb-cb-card-info",children:[a.jsx("h4",{className:"pb-cb-card-name",children:F}),a.jsxs("div",{className:"pb-cb-card-value",children:[ce.weight,"kg  ",ce.reps]}),ce.achievedAt&&a.jsx("div",{className:"pb-cb-card-date",children:(ce.achievedAt.toDate?ce.achievedAt.toDate():new Date(ce.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),C&&!te&&a.jsxs("div",{className:"pb-cb-target-info",children:["Target: ",C.targetWeight,"kg (",Math.round((K||0)*100),"%)"]}),C&&te&&!He&&a.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),He&&a.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),a.jsx("div",{className:"pb-cb-card-action",children:C?te&&He?a.jsx("button",{className:"pb-cb-target-btn",onClick:()=>{Ct(F),En("")},children:a.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 5v14M5 12h14"})})}):null:a.jsx("button",{className:"pb-cb-target-btn",onClick:()=>{Ct(F),En("")},children:a.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("circle",{cx:"12",cy:"12",r:"6"}),a.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]},F)})}),Object.keys(Ae).length>0&&a.jsxs("button",{className:"pb-cb-achievements-link",onClick:()=>zt("/client/core-buddy/achievements"),children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"View Achievements",a.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),Nt&&a.jsx("div",{className:"pb-cb-target-modal-overlay",onClick:()=>Ct(null),children:a.jsxs("div",{className:"pb-cb-target-modal",onClick:F=>F.stopPropagation(),children:[a.jsx("h3",{children:"Set Target"}),a.jsx("p",{className:"pb-cb-target-exercise-name",children:Nt}),a.jsxs("div",{className:"pb-cb-target-current",children:["Current PB: ",a.jsxs("strong",{children:[Ae[Nt]?.weight,"kg"]})]}),a.jsxs("div",{className:"pb-cb-target-input-wrap",children:[a.jsx("label",{children:"Your target (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",step:"0.5",value:oe,onChange:F=>En(F.target.value),placeholder:String((Ae[Nt]?.weight||0)+5),className:"pb-cb-target-input",autoFocus:!0})]}),a.jsxs("div",{className:"pb-cb-target-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>Ct(null),children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Fe,disabled:h,children:h?"Saving...":"Set Target"})]})]})})]}),Nn&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-tabs",children:[a.jsx("button",{className:`pb-tab ${s==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),a.jsx("button",{className:`pb-tab ${s==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),a.jsx("button",{className:`pb-tab ${s==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),s==="bests"&&a.jsxs("div",{className:"pb-strength-section",children:[!w&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-carousel",ref:Ht,onTouchStart:un,onTouchMove:rs,onTouchEnd:q,children:[a.jsx("div",{className:`pb-ring-container slide-from-${ht.current}`,children:a.jsxs("div",{className:"pb-ring",children:[a.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:$y.map((F,ce)=>{const T=ce<Math.round(Ds);return a.jsx("line",{x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,className:`pb-ring-tick ${T?_s?"hit":"filled":"empty"}`,strokeWidth:F.thick?"3":"2"},ce)})}),a.jsxs("div",{className:"pb-ring-center",children:[a.jsx("div",{className:"pb-ring-category",children:ge.category}),a.jsxs("div",{className:"pb-ring-exercise",children:[ge.name,Ne("strength",ge.key)&&a.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),a.jsx("div",{className:"pb-ring-value",children:st?ge.unit==="time"?ud(st.time):w2(st.weight,st.reps):"-"}),vt!==null&&a.jsxs("div",{className:`pb-ring-change ${vt>=0?"positive":"negative"}`,children:[vt>=0?"+":"",vt.toFixed(1),"%"]}),vt===null&&st&&a.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),Bn&&a.jsx("div",{className:`pb-ring-target ${_s?"hit":""}`,children:_s?"Target hit!":Bn.targetType==="time"?`${Bn.startValue||0}s  ${Bn.targetValue}s`:`${Bn.startWeight||0}kg${Bn.startReps||0}  ${Bn.targetWeight}kg${Bn.targetReps}`}),!Bn&&a.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),a.jsx("div",{className:"pb-carousel-dots",children:_a.map((F,ce)=>a.jsx("button",{className:`pb-dot ${ce===g?"active":""}`,onClick:()=>et(ce)},ce))}),a.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>et(g-1),disabled:g===0,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),a.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>et(g+1),disabled:g===_a.length-1,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),a.jsxs("div",{className:"pb-trend-section",children:[a.jsx("h4",{children:"Trend"}),a.jsx(SD,{data:n,exerciseKey:ge.key,unit:ge.unit})]})]}),!w&&!G&&a.jsxs("div",{className:"pb-action-buttons",children:[a.jsx("button",{className:"pb-edit-btn",onClick:()=>k(!0),children:Le?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),a.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>U(!0),children:Object.keys(Te).length>0?"Edit Targets":"Set Targets"}),(Object.keys(Te).length>0||Object.keys(Ve).length>0)&&a.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:rn,disabled:h,children:"Reset All Goals"})]}),w&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsxs("h3",{children:["Benchmarks - ",la(Me)]}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{k(!1),ne(Le?.benchmarks||{})},children:""})]}),a.jsx("div",{className:"pb-edit-body",children:_a.map(F=>a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:F.name}),F.unit==="weight"?a.jsxs("div",{className:"pb-edit-row",children:[a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",step:"0.5",value:V[F.key]?.weight??"",onChange:ce=>dt(F.key,"weight",ce.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",value:V[F.key]?.reps??"",onChange:ce=>dt(F.key,"reps",ce.target.value),placeholder:"0"})]})]}):a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Time (seconds)"}),a.jsx("input",{type:"number",step:"0.01",value:V[F.key]?.time??"",onChange:ce=>dt(F.key,"time",ce.target.value),placeholder:"0"})]})})]},F.key))}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{k(!1),ne(Le?.benchmarks||{})},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Qe,disabled:h,children:h?"Saving...":"Save"})]})]}),G&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsx("h3",{children:"Set Your Targets"}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{U(!1),R(Te)},children:""})]}),a.jsxs("div",{className:"pb-edit-body",children:[a.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),_a.map(F=>{const ce=Le?.benchmarks?.[F.key];let T="-";return ce&&(F.unit==="time"&&ce.time?T=`${ce.time}s`:(ce.weight||ce.reps)&&(T=`${ce.weight||0}kg  ${ce.reps||0}`)),a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsxs("div",{className:"pb-edit-exercise-header",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:F.name}),a.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",T]})]}),F.unit==="weight"?a.jsxs("div",{className:"pb-edit-row",children:[a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Target Weight (kg)"}),a.jsx("input",{type:"number",step:"0.5",value:j[F.key]?.targetWeight??"",onChange:C=>Rt(F.key,"targetWeight",C.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Target Reps"}),a.jsx("input",{type:"number",value:j[F.key]?.targetReps??"",onChange:C=>Rt(F.key,"targetReps",C.target.value),placeholder:"0"})]})]}):a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Target (seconds)"}),a.jsx("input",{type:"number",step:"1",value:j[F.key]?.targetValue??"",onChange:C=>Rt(F.key,"targetValue",C.target.value),placeholder:"0"})]})})]},F.key)})]}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{U(!1),R(Te)},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:nn,disabled:h,children:h?"Saving...":"Save Targets"})]})]})]}),s==="metrics"&&a.jsxs("div",{className:"pb-metrics-section",children:[!E&&!P&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-metrics-card",children:[a.jsx("h3",{children:"Body Measurements"}),a.jsx("p",{className:"pb-metrics-month",children:la(Me)}),a.jsx("div",{className:"pb-metrics-list",children:Ro.map(F=>{const ce=Le?.bodyMetrics?.[F.key],T=pe(F.key),C=Ve[F.key],K=In(F.key),te=K!==null&&K>=1;return a.jsxs("div",{className:"pb-metric-row",children:[a.jsxs("div",{className:"pb-metric-top",children:[a.jsxs("div",{className:"pb-metric-left",children:[a.jsxs("span",{className:"pb-metric-name",children:[F.name,Ne("metric",F.key)&&a.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),C&&a.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",C.targetValue," ",F.suffix]})]}),a.jsxs("div",{className:"pb-metric-values",children:[a.jsx("span",{className:"pb-metric-current",children:ce!=null?`${ce} ${F.suffix}`:"-"}),T!==null&&a.jsxs("span",{className:`pb-metric-change ${T>0?"up":T<0?"down":"same"}`,children:[T>0?"+":"",T," ",F.suffix]})]})]}),K!==null&&a.jsxs("div",{className:"pb-metric-progress",children:[a.jsx("div",{className:"pb-metric-bar",children:a.jsx("div",{className:`pb-metric-bar-fill ${te?"hit":""}`,style:{width:`${Math.round(K*100)}%`}})}),a.jsx("span",{className:`pb-metric-percent ${te?"hit":""}`,children:te?"Hit!":`${Math.round(K*100)}%`})]})]},F.key)})})]}),a.jsxs("div",{className:"pb-action-buttons",children:[a.jsx("button",{className:"pb-edit-btn",onClick:()=>O(!0),children:Le?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),a.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>D(!0),children:Object.keys(Ve).length>0?"Edit Targets":"Set Targets"}),(Object.keys(Te).length>0||Object.keys(Ve).length>0)&&a.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:rn,disabled:h,children:"Reset All Goals"})]})]}),E&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsxs("h3",{children:["Measurements - ",la(Me)]}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{O(!1),fe(Le?.bodyMetrics||{})},children:""})]}),a.jsx("div",{className:"pb-edit-body",children:Ro.map(F=>a.jsx("div",{className:"pb-edit-metric",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsxs("label",{children:[F.name," (",F.suffix,")"]}),a.jsx("input",{type:"number",step:"0.1",value:J[F.key]??"",onChange:ce=>Ft(F.key,ce.target.value),placeholder:"0"})]})},F.key))}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{O(!1),fe(Le?.bodyMetrics||{})},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Xe,disabled:h,children:h?"Saving...":"Save"})]})]}),P&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsx("h3",{children:"Body Metric Targets"}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{D(!1),M(Ve)},children:""})]}),a.jsxs("div",{className:"pb-edit-body",children:[a.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),Ro.map(F=>{const ce=Le?.bodyMetrics?.[F.key];return a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsxs("div",{className:"pb-edit-exercise-header",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:F.name}),a.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",ce!=null?`${ce} ${F.suffix}`:"-"]})]}),a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsxs("label",{children:["Target (",F.suffix,")"]}),a.jsx("input",{type:"number",step:"0.1",value:z[F.key]?.targetValue??"",onChange:T=>Vn(F.key,T.target.value),placeholder:"0"})]})})]},F.key)})]}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{D(!1),M(Ve)},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:An,disabled:h,children:h?"Saving...":"Save Targets"})]})]})]}),s==="history"&&a.jsx("div",{className:"pb-history-section",children:n.length===0?a.jsxs("div",{className:"pb-empty",children:[a.jsx("h4",{children:"No records yet"}),a.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):a.jsxs(a.Fragment,{children:[We.length>0&&a.jsxs("div",{className:"pb-achievements-wall",children:[a.jsxs("h4",{className:"pb-achievements-wall-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),a.jsx("div",{className:"pb-achievements-list",children:[...We].reverse().map((F,ce)=>a.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${ce*.05}s`},children:[a.jsx("div",{className:"pb-achievement-star",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("div",{className:"pb-achievement-info",children:[a.jsx("span",{className:"pb-achievement-label",children:F.label}),a.jsx("span",{className:"pb-achievement-date",children:la(F.achievedMonth)})]})]},ce))})]}),a.jsx("div",{className:"pb-history-controls",children:a.jsx("button",{className:`pb-compare-toggle ${ie?"active":""}`,onClick:()=>{L(!ie),!ie&&n.length>=2&&(ye(n[0].month),qe(n[n.length-1].month))},children:ie?"Back to Timeline":"Compare Months"})}),ie?a.jsxs("div",{className:"pb-compare",children:[a.jsxs("div",{className:"pb-compare-selectors",children:[a.jsxs("div",{className:"pb-compare-select",children:[a.jsx("label",{children:"From"}),a.jsx("select",{value:H,onChange:F=>ye(F.target.value),children:n.map(F=>a.jsx("option",{value:F.month,children:la(F.month)},F.month))})]}),a.jsx("div",{className:"pb-compare-vs",children:"vs"}),a.jsxs("div",{className:"pb-compare-select",children:[a.jsx("label",{children:"To"}),a.jsx("select",{value:Se,onChange:F=>qe(F.target.value),children:n.map(F=>a.jsx("option",{value:F.month,children:la(F.month)},F.month))})]})]}),we&&ve&&a.jsxs("div",{className:"pb-compare-results",children:[a.jsxs("div",{className:"pb-compare-group",children:[a.jsx("h4",{children:"Strength Benchmarks"}),a.jsxs("div",{className:"pb-compare-table",children:[a.jsxs("div",{className:"pb-compare-header-row",children:[a.jsx("span",{children:"Exercise"}),a.jsx("span",{children:la(H).split(" ")[0]}),a.jsx("span",{children:la(Se).split(" ")[0]}),a.jsx("span",{children:"Change"})]}),_a.map(F=>{const ce=we.benchmarks?.[F.key],T=ve.benchmarks?.[F.key],C=Cl(F,ce),K=Cl(F,T),te=Qp(K,C);return a.jsxs("div",{className:"pb-compare-row",children:[a.jsx("span",{className:"pb-compare-name",children:F.name}),a.jsx("span",{className:"pb-compare-val",children:ce?F.unit==="time"?ud(ce.time):`${ce.weight}x${ce.reps}`:"-"}),a.jsx("span",{className:"pb-compare-val",children:T?F.unit==="time"?ud(T.time):`${T.weight}x${T.reps}`:"-"}),a.jsx("span",{className:`pb-compare-change ${te!==null?te>=0?"positive":"negative":""}`,children:te!==null?`${te>=0?"+":""}${te.toFixed(1)}%`:"-"})]},F.key)})]})]}),a.jsxs("div",{className:"pb-compare-group",children:[a.jsx("h4",{children:"Body Measurements"}),a.jsxs("div",{className:"pb-compare-table",children:[a.jsxs("div",{className:"pb-compare-header-row",children:[a.jsx("span",{children:"Measurement"}),a.jsx("span",{children:la(H).split(" ")[0]}),a.jsx("span",{children:la(Se).split(" ")[0]}),a.jsx("span",{children:"Change"})]}),Ro.map(F=>{const ce=we.bodyMetrics?.[F.key],T=ve.bodyMetrics?.[F.key],C=ce!=null&&T!=null?parseFloat((T-ce).toFixed(2)):null;return a.jsxs("div",{className:"pb-compare-row",children:[a.jsx("span",{className:"pb-compare-name",children:F.name}),a.jsx("span",{className:"pb-compare-val",children:ce!=null?`${ce}`:"-"}),a.jsx("span",{className:"pb-compare-val",children:T!=null?`${T}`:"-"}),a.jsx("span",{className:`pb-compare-change ${C!==null?C>0?"positive":C<0?"negative":"neutral":""}`,children:C!==null?`${C>0?"+":""}${C} ${F.suffix}`:"-"})]},F.key)})]})]})]})]}):a.jsx("div",{className:"pb-timeline",children:[...n].reverse().map((F,ce)=>{const T=n.find(C=>C.month<F.month&&n.indexOf(C)===n.indexOf(F)-1)||n.filter(C=>C.month<F.month).pop();return a.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${ce*.05}s`},children:[a.jsx("div",{className:"pb-timeline-dot"}),a.jsxs("div",{className:"pb-timeline-card",children:[a.jsx("h4",{children:la(F.month)}),F.benchmarks&&Object.keys(F.benchmarks).length>0&&a.jsxs("div",{className:"pb-timeline-group",children:[a.jsx("h5",{children:"Strength Benchmarks"}),_a.map(C=>{const K=F.benchmarks[C.key];if(!K)return null;const te=T?.benchmarks?.[C.key],He=Cl(C,K),Ue=Cl(C,te),Oe=Qp(He,Ue);return a.jsxs("div",{className:"pb-timeline-row",children:[a.jsx("span",{className:"pb-timeline-label",children:C.name}),a.jsxs("div",{className:"pb-timeline-values",children:[a.jsx("span",{className:"pb-timeline-value",children:C.unit==="time"?ud(K.time):w2(K.weight,K.reps)}),Oe!==null&&a.jsxs("span",{className:`pb-timeline-change ${Oe>=0?"positive":"negative"}`,children:[Oe>=0?"+":"",Oe.toFixed(1),"%"]})]})]},C.key)})]}),F.bodyMetrics&&Object.keys(F.bodyMetrics).length>0&&a.jsxs("div",{className:"pb-timeline-group",children:[a.jsx("h5",{children:"Body Measurements"}),Ro.map(C=>{const K=F.bodyMetrics[C.key];if(K==null)return null;const te=T?.bodyMetrics?.[C.key],He=te!=null?parseFloat((K-te).toFixed(2)):null;return a.jsxs("div",{className:"pb-timeline-row",children:[a.jsx("span",{className:"pb-timeline-label",children:C.name}),a.jsxs("div",{className:"pb-timeline-values",children:[a.jsxs("span",{className:"pb-timeline-value",children:[K," ",C.suffix]}),He!==null&&a.jsxs("span",{className:`pb-timeline-change ${He>0?"positive":He<0?"negative":"neutral"}`,children:[He>0?"+":"",He," ",C.suffix]})]})]},C.key)})]})]})]},F.id)})})]})})]})]}),Q&&a.jsx("div",{className:"pb-celebration-overlay",onClick:()=>je(null),children:a.jsxs("div",{className:"pb-celebration-card",children:[a.jsx("div",{className:"pb-celebration-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsx("h3",{className:"pb-celebration-title",children:Q.length===1?"Target Achieved!":`${Q.length} Targets Achieved!`}),a.jsx("div",{className:"pb-celebration-badges",children:Q.map((F,ce)=>a.jsx("div",{className:"pb-celebration-badge",children:F.label},ce))}),a.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),ze&&a.jsxs("div",{className:`toast-notification ${ze.type}`,children:[a.jsx("span",{className:"toast-icon",children:ze.type==="success"?a.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),a.jsx("span",{className:"toast-message",children:ze.message}),a.jsx("button",{className:"toast-close",onClick:()=>lt(null),children:""})]}),Nn&&a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:"block-nav-tab",onClick:()=>zt("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),a.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),a.jsx("span",{children:"Home"})]}),a.jsxs("button",{className:"block-nav-tab",onClick:()=>zt("/client/forms"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),a.jsx("span",{children:"Forms"})]}),a.jsxs("button",{className:"block-nav-tab",onClick:()=>zt("/client/tools"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),a.jsx("span",{children:"Tools"})]}),a.jsxs("button",{className:"block-nav-tab active",children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 20V10"}),a.jsx("path",{d:"M18 20V4"}),a.jsx("path",{d:"M6 20v-4"})]}),a.jsx("span",{children:"PBs"})]}),Pt?.circuitAccess&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>zt("/client/circuit"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 6v6l4 2"})]}),a.jsx("span",{children:"Circuit"})]})]}),Kt&&a.jsx(Ma,{active:"progress"})]})}const CD=x.lazy(()=>Qr(()=>import("./Dashboard-CbImwsH8.js"),__vite__mapDeps([0,1]))),RD=x.lazy(()=>Qr(()=>import("./AddClient-CbwMPJa5.js"),__vite__mapDeps([2,3]))),AD=x.lazy(()=>Qr(()=>import("./ClientDashboard-BfzE875g.js"),[])),ID=x.lazy(()=>Qr(()=>import("./ClientForms-DFkrQD13.js"),__vite__mapDeps([4,5]))),MD=x.lazy(()=>Qr(()=>import("./ClientTools-CfSVtVgV.js"),__vite__mapDeps([6,7]))),DD=x.lazy(()=>Qr(()=>import("./MacroCalculator-ljrYOUrb.js"),__vite__mapDeps([8,7]))),PD=x.lazy(()=>Qr(()=>import("./ProteinSnacks-BwQ6mMo0.js"),__vite__mapDeps([9,7]))),LD=x.lazy(()=>Qr(()=>import("./DailyMotivation-Cmq6mzpe.js"),__vite__mapDeps([10,7]))),OD=x.lazy(()=>Qr(()=>import("./CircuitDashboard-DRRRp50M.js"),__vite__mapDeps([11,12]))),VD=x.lazy(()=>Qr(()=>import("./CircuitBooking-BjH2GaQI.js"),__vite__mapDeps([13,14,12]))),BD=x.lazy(()=>Qr(()=>import("./Leaderboard-CPaNl5PK.js"),__vite__mapDeps([15,16])));function UD({children:s}){const{pathname:e}=ma();return x.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),x.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),s}function zD(){const s=Zs();return x.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const n=e.replace("/login","")||"/";s(n,{replace:!0})}},[s]),null}function FD(){return a.jsx(I3,{children:a.jsx(A3,{children:a.jsxs(BE,{basename:"/login",children:[a.jsx(zD,{}),a.jsx(UD,{children:a.jsx(x.Suspense,{fallback:null,children:a.jsxs(mE,{children:[a.jsx(us,{path:"/",element:a.jsx(M3,{})}),a.jsx(us,{path:"/dashboard",element:a.jsx(CD,{})}),a.jsx(us,{path:"/add-client",element:a.jsx(RD,{})}),a.jsx(us,{path:"/client",element:a.jsx(AD,{})}),a.jsx(us,{path:"/client/forms",element:a.jsx(ID,{})}),a.jsx(us,{path:"/client/tools",element:a.jsx(MD,{})}),a.jsx(us,{path:"/client/tools/macros",element:a.jsx(DD,{})}),a.jsx(us,{path:"/client/tools/snacks",element:a.jsx(PD,{})}),a.jsx(us,{path:"/client/tools/motivation",element:a.jsx(LD,{})}),a.jsx(us,{path:"/client/personal-bests",element:a.jsx(ND,{})}),a.jsx(us,{path:"/client/circuit",element:a.jsx(OD,{})}),a.jsx(us,{path:"/client/circuit/booking",element:a.jsx(VD,{})}),a.jsx(us,{path:"/client/core-buddy",element:a.jsx(U3,{})}),a.jsx(us,{path:"/client/core-buddy/nutrition",element:a.jsx(q3,{})}),a.jsx(us,{path:"/client/core-buddy/workouts",element:a.jsx(tD,{})}),a.jsx(us,{path:"/client/core-buddy/programmes",element:a.jsx(iD,{})}),a.jsx(us,{path:"/client/core-buddy/achievements",element:a.jsx(dD,{})}),a.jsx(us,{path:"/client/core-buddy/consistency",element:a.jsx(pD,{})}),a.jsx(us,{path:"/client/core-buddy/buddies",element:a.jsx(gD,{})}),a.jsx(us,{path:"/client/core-buddy/profile/:userId",element:a.jsx(xD,{})}),a.jsx(us,{path:"/client/leaderboard",element:a.jsx(BD,{})}),a.jsx(us,{path:"*",element:a.jsx(dE,{to:"/",replace:!0})})]})})})]})})})}fj.createRoot(document.getElementById("root")).render(a.jsx(x.StrictMode,{children:a.jsx(FD,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/login/sw.js").catch(()=>{})});export{Ma as C,bt as T,ri as a,ar as b,Qt as c,be as d,Ke as e,qD as f,jn as g,LC as h,qn as i,a as j,Xr as k,Pa as l,Zs as m,$y as n,Hd as o,Gn as p,Pn as q,x as r,$D as s,Hi as u,fn as w};
