const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-BlKUnihI.js","assets/scheduleUtils-a2tn0x12.js","assets/Dashboard-CiteS8CF.css","assets/AddClient-nj7LQUz6.js","assets/AddClient-DH1OFzHo.css","assets/ClientDashboard-CUl34LSt.js","assets/ClientDashboard-CSizO3dZ.css","assets/ClientForms-CAY9CmWU.js","assets/ClientForms-QNtUjQJR.css","assets/ClientTools-C_EP5TXd.js","assets/ClientTools-Bezn5TAX.css","assets/MacroCalculator-DBelHl22.js","assets/ProteinSnacks-DtoUdsEK.js","assets/DailyMotivation-zgkCwfUE.js","assets/CircuitDashboard-CXEFpiuj.js","assets/CircuitDashboard-C8T0uect.css","assets/CircuitBooking-UZHzgBsQ.js","assets/CircuitBooking-ruk9Q4Wj.css","assets/PersonalBests-trzGCfTU.js","assets/PersonalBests-C2b_TGFz.css","assets/Leaderboard-Cz_McCrw.js","assets/Leaderboard-Bul59-ui.css","assets/UpgradePage-CmxCGVE9.js","assets/stripe-Da7IPrZW.js","assets/UpgradePage-COYPjotf.css","assets/Onboarding-D3J1_eqY.js","assets/Onboarding-CVQ7kVEZ.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(l){if(l.ep)return;l.ep=!0;const u=t(l);fetch(l.href,u)}})();var Tg={exports:{}},Yc={};var qb;function RT(){if(qb)return Yc;qb=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,l,u){var d=null;if(u!==void 0&&(d=""+u),l.key!==void 0&&(d=""+l.key),"key"in l){u={};for(var g in l)g!=="key"&&(u[g]=l[g])}else u=l;return l=u.ref,{$$typeof:s,type:i,key:d,ref:l!==void 0?l:null,props:u}}return Yc.Fragment=e,Yc.jsx=t,Yc.jsxs=t,Yc}var $b;function IT(){return $b||($b=1,Tg.exports=RT()),Tg.exports}var a=IT(),Sg={exports:{}},Lt={};var Wb;function MT(){if(Wb)return Lt;Wb=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),d=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),y=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),E=Symbol.iterator;function M(V){return V===null||typeof V!="object"?null:(V=E&&V[E]||V["@@iterator"],typeof V=="function"?V:null)}var H={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},K=Object.assign,B={};function Y(V,ce,je){this.props=V,this.context=ce,this.refs=B,this.updater=je||H}Y.prototype.isReactComponent={},Y.prototype.setState=function(V,ce){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,ce,"setState")},Y.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function ee(){}ee.prototype=Y.prototype;function ae(V,ce,je){this.props=V,this.context=ce,this.refs=B,this.updater=je||H}var ye=ae.prototype=new ee;ye.constructor=ae,K(ye,Y.prototype),ye.isPureReactComponent=!0;var ve=Array.isArray;function he(){}var D={H:null,A:null,T:null,S:null},T=Object.prototype.hasOwnProperty;function I(V,ce,je){var Ce=je.ref;return{$$typeof:s,type:V,key:ce,ref:Ce!==void 0?Ce:null,props:je}}function U(V,ce){return I(V.type,ce,V.props)}function L(V){return typeof V=="object"&&V!==null&&V.$$typeof===s}function P(V){var ce={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(je){return ce[je]})}var A=/\/+/g;function Le(V,ce){return typeof V=="object"&&V!==null&&V.key!=null?P(""+V.key):ce.toString(36)}function Ze(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(he,he):(V.status="pending",V.then(function(ce){V.status==="pending"&&(V.status="fulfilled",V.value=ce)},function(ce){V.status==="pending"&&(V.status="rejected",V.reason=ce)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function J(V,ce,je,Ce,ke){var Ue=typeof V;(Ue==="undefined"||Ue==="boolean")&&(V=null);var $e=!1;if(V===null)$e=!0;else switch(Ue){case"bigint":case"string":case"number":$e=!0;break;case"object":switch(V.$$typeof){case s:case e:$e=!0;break;case b:return $e=V._init,J($e(V._payload),ce,je,Ce,ke)}}if($e)return ke=ke(V),$e=Ce===""?"."+Le(V,0):Ce,ve(ke)?(je="",$e!=null&&(je=$e.replace(A,"$&/")+"/"),J(ke,ce,je,"",function(Wt){return Wt})):ke!=null&&(L(ke)&&(ke=U(ke,je+(ke.key==null||V&&V.key===ke.key?"":(""+ke.key).replace(A,"$&/")+"/")+$e)),ce.push(ke)),1;$e=0;var Qe=Ce===""?".":Ce+":";if(ve(V))for(var Je=0;Je<V.length;Je++)Ce=V[Je],Ue=Qe+Le(Ce,Je),$e+=J(Ce,ce,je,Ue,ke);else if(Je=M(V),typeof Je=="function")for(V=Je.call(V),Je=0;!(Ce=V.next()).done;)Ce=Ce.value,Ue=Qe+Le(Ce,Je++),$e+=J(Ce,ce,je,Ue,ke);else if(Ue==="object"){if(typeof V.then=="function")return J(Ze(V),ce,je,Ce,ke);throw ce=String(V),Error("Objects are not valid as a React child (found: "+(ce==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":ce)+"). If you meant to render a collection of children, use an array instead.")}return $e}function Te(V,ce,je){if(V==null)return V;var Ce=[],ke=0;return J(V,Ce,"","",function(Ue){return ce.call(je,Ue,ke++)}),Ce}function He(V){if(V._status===-1){var ce=V._result;ce=ce(),ce.then(function(je){(V._status===0||V._status===-1)&&(V._status=1,V._result=je)},function(je){(V._status===0||V._status===-1)&&(V._status=2,V._result=je)}),V._status===-1&&(V._status=0,V._result=ce)}if(V._status===1)return V._result.default;throw V._result}var Se=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ce=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(ce))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)},Pe={map:Te,forEach:function(V,ce,je){Te(V,function(){ce.apply(this,arguments)},je)},count:function(V){var ce=0;return Te(V,function(){ce++}),ce},toArray:function(V){return Te(V,function(ce){return ce})||[]},only:function(V){if(!L(V))throw Error("React.Children.only expected to receive a single React element child.");return V}};return Lt.Activity=k,Lt.Children=Pe,Lt.Component=Y,Lt.Fragment=t,Lt.Profiler=l,Lt.PureComponent=ae,Lt.StrictMode=i,Lt.Suspense=y,Lt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=D,Lt.__COMPILER_RUNTIME={__proto__:null,c:function(V){return D.H.useMemoCache(V)}},Lt.cache=function(V){return function(){return V.apply(null,arguments)}},Lt.cacheSignal=function(){return null},Lt.cloneElement=function(V,ce,je){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var Ce=K({},V.props),ke=V.key;if(ce!=null)for(Ue in ce.key!==void 0&&(ke=""+ce.key),ce)!T.call(ce,Ue)||Ue==="key"||Ue==="__self"||Ue==="__source"||Ue==="ref"&&ce.ref===void 0||(Ce[Ue]=ce[Ue]);var Ue=arguments.length-2;if(Ue===1)Ce.children=je;else if(1<Ue){for(var $e=Array(Ue),Qe=0;Qe<Ue;Qe++)$e[Qe]=arguments[Qe+2];Ce.children=$e}return I(V.type,ke,Ce)},Lt.createContext=function(V){return V={$$typeof:d,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:u,_context:V},V},Lt.createElement=function(V,ce,je){var Ce,ke={},Ue=null;if(ce!=null)for(Ce in ce.key!==void 0&&(Ue=""+ce.key),ce)T.call(ce,Ce)&&Ce!=="key"&&Ce!=="__self"&&Ce!=="__source"&&(ke[Ce]=ce[Ce]);var $e=arguments.length-2;if($e===1)ke.children=je;else if(1<$e){for(var Qe=Array($e),Je=0;Je<$e;Je++)Qe[Je]=arguments[Je+2];ke.children=Qe}if(V&&V.defaultProps)for(Ce in $e=V.defaultProps,$e)ke[Ce]===void 0&&(ke[Ce]=$e[Ce]);return I(V,Ue,ke)},Lt.createRef=function(){return{current:null}},Lt.forwardRef=function(V){return{$$typeof:g,render:V}},Lt.isValidElement=L,Lt.lazy=function(V){return{$$typeof:b,_payload:{_status:-1,_result:V},_init:He}},Lt.memo=function(V,ce){return{$$typeof:p,type:V,compare:ce===void 0?null:ce}},Lt.startTransition=function(V){var ce=D.T,je={};D.T=je;try{var Ce=V(),ke=D.S;ke!==null&&ke(je,Ce),typeof Ce=="object"&&Ce!==null&&typeof Ce.then=="function"&&Ce.then(he,Se)}catch(Ue){Se(Ue)}finally{ce!==null&&je.types!==null&&(ce.types=je.types),D.T=ce}},Lt.unstable_useCacheRefresh=function(){return D.H.useCacheRefresh()},Lt.use=function(V){return D.H.use(V)},Lt.useActionState=function(V,ce,je){return D.H.useActionState(V,ce,je)},Lt.useCallback=function(V,ce){return D.H.useCallback(V,ce)},Lt.useContext=function(V){return D.H.useContext(V)},Lt.useDebugValue=function(){},Lt.useDeferredValue=function(V,ce){return D.H.useDeferredValue(V,ce)},Lt.useEffect=function(V,ce){return D.H.useEffect(V,ce)},Lt.useEffectEvent=function(V){return D.H.useEffectEvent(V)},Lt.useId=function(){return D.H.useId()},Lt.useImperativeHandle=function(V,ce,je){return D.H.useImperativeHandle(V,ce,je)},Lt.useInsertionEffect=function(V,ce){return D.H.useInsertionEffect(V,ce)},Lt.useLayoutEffect=function(V,ce){return D.H.useLayoutEffect(V,ce)},Lt.useMemo=function(V,ce){return D.H.useMemo(V,ce)},Lt.useOptimistic=function(V,ce){return D.H.useOptimistic(V,ce)},Lt.useReducer=function(V,ce,je){return D.H.useReducer(V,ce,je)},Lt.useRef=function(V){return D.H.useRef(V)},Lt.useState=function(V){return D.H.useState(V)},Lt.useSyncExternalStore=function(V,ce,je){return D.H.useSyncExternalStore(V,ce,je)},Lt.useTransition=function(){return D.H.useTransition()},Lt.version="19.2.4",Lt}var Gb;function Xp(){return Gb||(Gb=1,Sg.exports=MT()),Sg.exports}var w=Xp(),Cg={exports:{}},Qc={},Ng={exports:{}},Ag={};var Kb;function DT(){return Kb||(Kb=1,(function(s){function e(J,Te){var He=J.length;J.push(Te);e:for(;0<He;){var Se=He-1>>>1,Pe=J[Se];if(0<l(Pe,Te))J[Se]=Te,J[He]=Pe,He=Se;else break e}}function t(J){return J.length===0?null:J[0]}function i(J){if(J.length===0)return null;var Te=J[0],He=J.pop();if(He!==Te){J[0]=He;e:for(var Se=0,Pe=J.length,V=Pe>>>1;Se<V;){var ce=2*(Se+1)-1,je=J[ce],Ce=ce+1,ke=J[Ce];if(0>l(je,He))Ce<Pe&&0>l(ke,je)?(J[Se]=ke,J[Ce]=He,Se=Ce):(J[Se]=je,J[ce]=He,Se=ce);else if(Ce<Pe&&0>l(ke,He))J[Se]=ke,J[Ce]=He,Se=Ce;else break e}}return Te}function l(J,Te){var He=J.sortIndex-Te.sortIndex;return He!==0?He:J.id-Te.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;s.unstable_now=function(){return u.now()}}else{var d=Date,g=d.now();s.unstable_now=function(){return d.now()-g}}var y=[],p=[],b=1,k=null,E=3,M=!1,H=!1,K=!1,B=!1,Y=typeof setTimeout=="function"?setTimeout:null,ee=typeof clearTimeout=="function"?clearTimeout:null,ae=typeof setImmediate<"u"?setImmediate:null;function ye(J){for(var Te=t(p);Te!==null;){if(Te.callback===null)i(p);else if(Te.startTime<=J)i(p),Te.sortIndex=Te.expirationTime,e(y,Te);else break;Te=t(p)}}function ve(J){if(K=!1,ye(J),!H)if(t(y)!==null)H=!0,he||(he=!0,P());else{var Te=t(p);Te!==null&&Ze(ve,Te.startTime-J)}}var he=!1,D=-1,T=5,I=-1;function U(){return B?!0:!(s.unstable_now()-I<T)}function L(){if(B=!1,he){var J=s.unstable_now();I=J;var Te=!0;try{e:{H=!1,K&&(K=!1,ee(D),D=-1),M=!0;var He=E;try{t:{for(ye(J),k=t(y);k!==null&&!(k.expirationTime>J&&U());){var Se=k.callback;if(typeof Se=="function"){k.callback=null,E=k.priorityLevel;var Pe=Se(k.expirationTime<=J);if(J=s.unstable_now(),typeof Pe=="function"){k.callback=Pe,ye(J),Te=!0;break t}k===t(y)&&i(y),ye(J)}else i(y);k=t(y)}if(k!==null)Te=!0;else{var V=t(p);V!==null&&Ze(ve,V.startTime-J),Te=!1}}break e}finally{k=null,E=He,M=!1}Te=void 0}}finally{Te?P():he=!1}}}var P;if(typeof ae=="function")P=function(){ae(L)};else if(typeof MessageChannel<"u"){var A=new MessageChannel,Le=A.port2;A.port1.onmessage=L,P=function(){Le.postMessage(null)}}else P=function(){Y(L,0)};function Ze(J,Te){D=Y(function(){J(s.unstable_now())},Te)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(J){J.callback=null},s.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<J?Math.floor(1e3/J):5},s.unstable_getCurrentPriorityLevel=function(){return E},s.unstable_next=function(J){switch(E){case 1:case 2:case 3:var Te=3;break;default:Te=E}var He=E;E=Te;try{return J()}finally{E=He}},s.unstable_requestPaint=function(){B=!0},s.unstable_runWithPriority=function(J,Te){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var He=E;E=J;try{return Te()}finally{E=He}},s.unstable_scheduleCallback=function(J,Te,He){var Se=s.unstable_now();switch(typeof He=="object"&&He!==null?(He=He.delay,He=typeof He=="number"&&0<He?Se+He:Se):He=Se,J){case 1:var Pe=-1;break;case 2:Pe=250;break;case 5:Pe=1073741823;break;case 4:Pe=1e4;break;default:Pe=5e3}return Pe=He+Pe,J={id:b++,callback:Te,priorityLevel:J,startTime:He,expirationTime:Pe,sortIndex:-1},He>Se?(J.sortIndex=He,e(p,J),t(y)===null&&J===t(p)&&(K?(ee(D),D=-1):K=!0,Ze(ve,He-Se))):(J.sortIndex=Pe,e(y,J),H||M||(H=!0,he||(he=!0,P()))),J},s.unstable_shouldYield=U,s.unstable_wrapCallback=function(J){var Te=E;return function(){var He=E;E=Te;try{return J.apply(this,arguments)}finally{E=He}}}})(Ag)),Ag}var Yb;function LT(){return Yb||(Yb=1,Ng.exports=DT()),Ng.exports}var Rg={exports:{}},Ks={};var Qb;function PT(){if(Qb)return Ks;Qb=1;var s=Xp();function e(y){var p="https://react.dev/errors/"+y;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)p+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+y+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(y,p,b){var k=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:k==null?null:""+k,children:y,containerInfo:p,implementation:b}}var d=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function g(y,p){if(y==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return Ks.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Ks.createPortal=function(y,p){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return u(y,p,null,b)},Ks.flushSync=function(y){var p=d.T,b=i.p;try{if(d.T=null,i.p=2,y)return y()}finally{d.T=p,i.p=b,i.d.f()}},Ks.preconnect=function(y,p){typeof y=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,i.d.C(y,p))},Ks.prefetchDNS=function(y){typeof y=="string"&&i.d.D(y)},Ks.preinit=function(y,p){if(typeof y=="string"&&p&&typeof p.as=="string"){var b=p.as,k=g(b,p.crossOrigin),E=typeof p.integrity=="string"?p.integrity:void 0,M=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;b==="style"?i.d.S(y,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:k,integrity:E,fetchPriority:M}):b==="script"&&i.d.X(y,{crossOrigin:k,integrity:E,fetchPriority:M,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},Ks.preinitModule=function(y,p){if(typeof y=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var b=g(p.as,p.crossOrigin);i.d.M(y,{crossOrigin:b,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&i.d.M(y)},Ks.preload=function(y,p){if(typeof y=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var b=p.as,k=g(b,p.crossOrigin);i.d.L(y,b,{crossOrigin:k,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},Ks.preloadModule=function(y,p){if(typeof y=="string")if(p){var b=g(p.as,p.crossOrigin);i.d.m(y,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:b,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else i.d.m(y)},Ks.requestFormReset=function(y){i.d.r(y)},Ks.unstable_batchedUpdates=function(y,p){return y(p)},Ks.useFormState=function(y,p,b){return d.H.useFormState(y,p,b)},Ks.useFormStatus=function(){return d.H.useHostTransitionStatus()},Ks.version="19.2.4",Ks}var Xb;function OT(){if(Xb)return Rg.exports;Xb=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Rg.exports=PT(),Rg.exports}var Jb;function VT(){if(Jb)return Qc;Jb=1;var s=LT(),e=Xp(),t=OT();function i(n){var r="https://react.dev/errors/"+n;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+n+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function u(n){var r=n,o=n;if(n.alternate)for(;r.return;)r=r.return;else{n=r;do r=n,(r.flags&4098)!==0&&(o=r.return),n=r.return;while(n)}return r.tag===3?o:null}function d(n){if(n.tag===13){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function g(n){if(n.tag===31){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function y(n){if(u(n)!==n)throw Error(i(188))}function p(n){var r=n.alternate;if(!r){if(r=u(n),r===null)throw Error(i(188));return r!==n?null:n}for(var o=n,c=r;;){var f=o.return;if(f===null)break;var m=f.alternate;if(m===null){if(c=f.return,c!==null){o=c;continue}break}if(f.child===m.child){for(m=f.child;m;){if(m===o)return y(f),n;if(m===c)return y(f),r;m=m.sibling}throw Error(i(188))}if(o.return!==c.return)o=f,c=m;else{for(var x=!1,j=f.child;j;){if(j===o){x=!0,o=f,c=m;break}if(j===c){x=!0,c=f,o=m;break}j=j.sibling}if(!x){for(j=m.child;j;){if(j===o){x=!0,o=m,c=f;break}if(j===c){x=!0,c=m,o=f;break}j=j.sibling}if(!x)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?n:r}function b(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n;for(n=n.child;n!==null;){if(r=b(n),r!==null)return r;n=n.sibling}return null}var k=Object.assign,E=Symbol.for("react.element"),M=Symbol.for("react.transitional.element"),H=Symbol.for("react.portal"),K=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),Y=Symbol.for("react.profiler"),ee=Symbol.for("react.consumer"),ae=Symbol.for("react.context"),ye=Symbol.for("react.forward_ref"),ve=Symbol.for("react.suspense"),he=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),U=Symbol.for("react.memo_cache_sentinel"),L=Symbol.iterator;function P(n){return n===null||typeof n!="object"?null:(n=L&&n[L]||n["@@iterator"],typeof n=="function"?n:null)}var A=Symbol.for("react.client.reference");function Le(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===A?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case K:return"Fragment";case Y:return"Profiler";case B:return"StrictMode";case ve:return"Suspense";case he:return"SuspenseList";case I:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case H:return"Portal";case ae:return n.displayName||"Context";case ee:return(n._context.displayName||"Context")+".Consumer";case ye:var r=n.render;return n=n.displayName,n||(n=r.displayName||r.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case D:return r=n.displayName||null,r!==null?r:Le(n.type)||"Memo";case T:r=n._payload,n=n._init;try{return Le(n(r))}catch{}}return null}var Ze=Array.isArray,J=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Te=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,He={pending:!1,data:null,method:null,action:null},Se=[],Pe=-1;function V(n){return{current:n}}function ce(n){0>Pe||(n.current=Se[Pe],Se[Pe]=null,Pe--)}function je(n,r){Pe++,Se[Pe]=n.current,n.current=r}var Ce=V(null),ke=V(null),Ue=V(null),$e=V(null);function Qe(n,r){switch(je(Ue,r),je(ke,n),je(Ce,null),r.nodeType){case 9:case 11:n=(n=r.documentElement)&&(n=n.namespaceURI)?fb(n):0;break;default:if(n=r.tagName,r=r.namespaceURI)r=fb(r),n=mb(r,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}ce(Ce),je(Ce,n)}function Je(){ce(Ce),ce(ke),ce(Ue)}function Wt(n){n.memoizedState!==null&&je($e,n);var r=Ce.current,o=mb(r,n.type);r!==o&&(je(ke,n),je(Ce,o))}function It(n){ke.current===n&&(ce(Ce),ce(ke)),$e.current===n&&(ce($e),$c._currentValue=He)}var Cn,ln;function qt(n){if(Cn===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);Cn=r&&r[1]||"",ln=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Cn+n+ln}var Et=!1;function pn(n,r){if(!n||Et)return"";Et=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var Ee=function(){throw Error()};if(Object.defineProperty(Ee.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ee,[])}catch(ge){var de=ge}Reflect.construct(n,[],Ee)}else{try{Ee.call()}catch(ge){de=ge}n.call(Ee.prototype)}}else{try{throw Error()}catch(ge){de=ge}(Ee=n())&&typeof Ee.catch=="function"&&Ee.catch(function(){})}}catch(ge){if(ge&&de&&typeof ge.stack=="string")return[ge.stack,de.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=c.DetermineComponentFrameRoot(),x=m[0],j=m[1];if(x&&j){var z=x.split(`
`),ie=j.split(`
`);for(f=c=0;c<z.length&&!z[c].includes("DetermineComponentFrameRoot");)c++;for(;f<ie.length&&!ie[f].includes("DetermineComponentFrameRoot");)f++;if(c===z.length||f===ie.length)for(c=z.length-1,f=ie.length-1;1<=c&&0<=f&&z[c]!==ie[f];)f--;for(;1<=c&&0<=f;c--,f--)if(z[c]!==ie[f]){if(c!==1||f!==1)do if(c--,f--,0>f||z[c]!==ie[f]){var we=`
`+z[c].replace(" at new "," at ");return n.displayName&&we.includes("<anonymous>")&&(we=we.replace("<anonymous>",n.displayName)),we}while(1<=c&&0<=f);break}}}finally{Et=!1,Error.prepareStackTrace=o}return(o=n?n.displayName||n.name:"")?qt(o):""}function Tt(n,r){switch(n.tag){case 26:case 27:case 5:return qt(n.type);case 16:return qt("Lazy");case 13:return n.child!==r&&r!==null?qt("Suspense Fallback"):qt("Suspense");case 19:return qt("SuspenseList");case 0:case 15:return pn(n.type,!1);case 11:return pn(n.type.render,!1);case 1:return pn(n.type,!0);case 31:return qt("Activity");default:return""}}function dt(n){try{var r="",o=null;do r+=Tt(n,o),o=n,n=n.return;while(n);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var le=Object.prototype.hasOwnProperty,pt=s.unstable_scheduleCallback,Ht=s.unstable_cancelCallback,it=s.unstable_shouldYield,yt=s.unstable_requestPaint,gt=s.unstable_now,_t=s.unstable_getCurrentPriorityLevel,zt=s.unstable_ImmediatePriority,fs=s.unstable_UserBlockingPriority,rn=s.unstable_NormalPriority,Zn=s.unstable_LowPriority,Fn=s.unstable_IdlePriority,Ln=s.log,Pn=s.unstable_setDisableYieldValue,un=null,Gt=null;function Ct(n){if(typeof Ln=="function"&&Pn(n),Gt&&typeof Gt.setStrictMode=="function")try{Gt.setStrictMode(un,n)}catch{}}var Mt=Math.clz32?Math.clz32:te,Z=Math.log,C=Math.LN2;function te(n){return n>>>=0,n===0?32:31-(Z(n)/C|0)|0}var Re=256,Ie=262144,Me=4194304;function Fe(n){var r=n&42;if(r!==0)return r;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Oe(n,r,o){var c=n.pendingLanes;if(c===0)return 0;var f=0,m=n.suspendedLanes,x=n.pingedLanes;n=n.warmLanes;var j=c&134217727;return j!==0?(c=j&~m,c!==0?f=Fe(c):(x&=j,x!==0?f=Fe(x):o||(o=j&~n,o!==0&&(f=Fe(o))))):(j=c&~m,j!==0?f=Fe(j):x!==0?f=Fe(x):o||(o=c&~n,o!==0&&(f=Fe(o)))),f===0?0:r!==0&&r!==f&&(r&m)===0&&(m=f&-f,o=r&-r,m>=o||m===32&&(o&4194048)!==0)?r:f}function Nt(n,r){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&r)===0}function bt(n,r){switch(n){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function lt(){var n=Me;return Me<<=1,(Me&62914560)===0&&(Me=4194304),n}function dn(n){for(var r=[],o=0;31>o;o++)r.push(n);return r}function hn(n,r){n.pendingLanes|=r,r!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function On(n,r,o,c,f,m){var x=n.pendingLanes;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=o,n.entangledLanes&=o,n.errorRecoveryDisabledLanes&=o,n.shellSuspendCounter=0;var j=n.entanglements,z=n.expirationTimes,ie=n.hiddenUpdates;for(o=x&~o;0<o;){var we=31-Mt(o),Ee=1<<we;j[we]=0,z[we]=-1;var de=ie[we];if(de!==null)for(ie[we]=null,we=0;we<de.length;we++){var ge=de[we];ge!==null&&(ge.lane&=-536870913)}o&=~Ee}c!==0&&ms(n,c,0),m!==0&&f===0&&n.tag!==0&&(n.suspendedLanes|=m&~(x&~r))}function ms(n,r,o){n.pendingLanes|=r,n.suspendedLanes&=~r;var c=31-Mt(r);n.entangledLanes|=r,n.entanglements[c]=n.entanglements[c]|1073741824|o&261930}function ue(n,r){var o=n.entangledLanes|=r;for(n=n.entanglements;o;){var c=31-Mt(o),f=1<<c;f&r|n[c]&r&&(n[c]|=r),o&=~f}}function De(n,r){var o=r&-r;return o=(o&42)!==0?1:Ke(o),(o&(n.suspendedLanes|r))!==0?0:o}function Ke(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function ct(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function rt(){var n=Te.p;return n!==0?n:(n=window.event,n===void 0?32:Ob(n.type))}function Kt(n,r){var o=Te.p;try{return Te.p=n,r()}finally{Te.p=o}}var fn=Math.random().toString(36).slice(2),At="__reactFiber$"+fn,St="__reactProps$"+fn,bn="__reactContainer$"+fn,Ss="__reactEvents$"+fn,si="__reactListeners$"+fn,xi="__reactHandles$"+fn,Or="__reactResources$"+fn,js="__reactMarker$"+fn;function hr(n){delete n[At],delete n[St],delete n[Ss],delete n[si],delete n[xi]}function Kn(n){var r=n[At];if(r)return r;for(var o=n.parentNode;o;){if(r=o[bn]||o[At]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(n=xb(n);n!==null;){if(o=n[At])return o;n=xb(n)}return r}n=o,o=n.parentNode}return null}function os(n){if(n=n[At]||n[bn]){var r=n.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return n}return null}function ls(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n.stateNode;throw Error(i(33))}function Vn(n){var r=n[Or];return r||(r=n[Or]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function wn(n){n[js]=!0}var es=new Set,kr={};function qs(n,r){Yn(n,r),Yn(n+"Capture",r)}function Yn(n,r){for(kr[n]=r,n=0;n<r.length;n++)es.add(r[n])}var jr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ts={},Vr={};function O(n){return le.call(Vr,n)?!0:le.call(ts,n)?!1:jr.test(n)?Vr[n]=!0:(ts[n]=!0,!1)}function q(n,r,o){if(O(r))if(o===null)n.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":n.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){n.removeAttribute(r);return}}n.setAttribute(r,""+o)}}function oe(n,r,o){if(o===null)n.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(r);return}n.setAttribute(r,""+o)}}function ne(n,r,o,c){if(c===null)n.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttributeNS(r,o,""+c)}}function Ye(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Ge(n){var r=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function qe(n,r,o){var c=Object.getOwnPropertyDescriptor(n.constructor.prototype,r);if(!n.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var f=c.get,m=c.set;return Object.defineProperty(n,r,{configurable:!0,get:function(){return f.call(this)},set:function(x){o=""+x,m.call(this,x)}}),Object.defineProperty(n,r,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(x){o=""+x},stopTracking:function(){n._valueTracker=null,delete n[r]}}}}function ot(n){if(!n._valueTracker){var r=Ge(n)?"checked":"value";n._valueTracker=qe(n,r,""+n[r])}}function Rt(n){if(!n)return!1;var r=n._valueTracker;if(!r)return!0;var o=r.getValue(),c="";return n&&(c=Ge(n)?n.checked?"true":"false":n.value),n=c,n!==o?(r.setValue(n),!0):!1}function Nn(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var Cs=/[\n"\\]/g;function Qn(n){return n.replace(Cs,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function Ms(n,r,o,c,f,m,x,j){n.name="",x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?n.type=x:n.removeAttribute("type"),r!=null?x==="number"?(r===0&&n.value===""||n.value!=r)&&(n.value=""+Ye(r)):n.value!==""+Ye(r)&&(n.value=""+Ye(r)):x!=="submit"&&x!=="reset"||n.removeAttribute("value"),r!=null?Ds(n,x,Ye(r)):o!=null?Ds(n,x,Ye(o)):c!=null&&n.removeAttribute("value"),f==null&&m!=null&&(n.defaultChecked=!!m),f!=null&&(n.checked=f&&typeof f!="function"&&typeof f!="symbol"),j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?n.name=""+Ye(j):n.removeAttribute("name")}function ri(n,r,o,c,f,m,x,j){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(n.type=m),r!=null||o!=null){if(!(m!=="submit"&&m!=="reset"||r!=null)){ot(n);return}o=o!=null?""+Ye(o):"",r=r!=null?""+Ye(r):o,j||r===n.value||(n.value=r),n.defaultValue=r}c=c??f,c=typeof c!="function"&&typeof c!="symbol"&&!!c,n.checked=j?n.checked:!!c,n.defaultChecked=!!c,x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(n.name=x),ot(n)}function Ds(n,r,o){r==="number"&&Nn(n.ownerDocument)===n||n.defaultValue===""+o||(n.defaultValue=""+o)}function er(n,r,o,c){if(n=n.options,r){r={};for(var f=0;f<o.length;f++)r["$"+o[f]]=!0;for(o=0;o<n.length;o++)f=r.hasOwnProperty("$"+n[o].value),n[o].selected!==f&&(n[o].selected=f),f&&c&&(n[o].defaultSelected=!0)}else{for(o=""+Ye(o),r=null,f=0;f<n.length;f++){if(n[f].value===o){n[f].selected=!0,c&&(n[f].defaultSelected=!0);return}r!==null||n[f].disabled||(r=n[f])}r!==null&&(r.selected=!0)}}function _i(n,r,o){if(r!=null&&(r=""+Ye(r),r!==n.value&&(n.value=r),o==null)){n.defaultValue!==r&&(n.defaultValue=r);return}n.defaultValue=o!=null?""+Ye(o):""}function Er(n,r,o,c){if(r==null){if(c!=null){if(o!=null)throw Error(i(92));if(Ze(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),r=o}o=Ye(r),n.defaultValue=o,c=n.textContent,c===o&&c!==""&&c!==null&&(n.value=c),ot(n)}function Ns(n,r){if(r){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=r;return}}n.textContent=r}var Ea=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function zi(n,r,o){var c=r.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?n.setProperty(r,""):r==="float"?n.cssFloat="":n[r]="":c?n.setProperty(r,o):typeof o!="number"||o===0||Ea.has(r)?r==="float"?n.cssFloat=o:n[r]=(""+o).trim():n[r]=o+"px"}function ii(n,r,o){if(r!=null&&typeof r!="object")throw Error(i(62));if(n=n.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?n.setProperty(c,""):c==="float"?n.cssFloat="":n[c]="");for(var f in r)c=r[f],r.hasOwnProperty(f)&&o[f]!==c&&zi(n,f,c)}else for(var m in r)r.hasOwnProperty(m)&&zi(n,m,r[m])}function ki(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Fi=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ur=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Tr(n){return Ur.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function $s(){}var Ws=null;function Ls(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var S=null,Q=null;function Ae(n){var r=os(n);if(r&&(n=r.stateNode)){var o=n[St]||null;e:switch(n=r.stateNode,r.type){case"input":if(Ms(n,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),r=o.name,o.type==="radio"&&r!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Qn(""+r)+'"][type="radio"]'),r=0;r<o.length;r++){var c=o[r];if(c!==n&&c.form===n.form){var f=c[St]||null;if(!f)throw Error(i(90));Ms(c,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(r=0;r<o.length;r++)c=o[r],c.form===n.form&&Rt(c)}break e;case"textarea":_i(n,o.value,o.defaultValue);break e;case"select":r=o.value,r!=null&&er(n,!!o.multiple,r,!1)}}}var R=!1;function F(n,r,o){if(R)return n(r,o);R=!0;try{var c=n(r);return c}finally{if(R=!1,(S!==null||Q!==null)&&(Ud(),S&&(r=S,n=Q,Q=S=null,Ae(r),n)))for(r=0;r<n.length;r++)Ae(n[r])}}function $(n,r){var o=n.stateNode;if(o===null)return null;var c=o[St]||null;if(c===null)return null;o=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(n=n.type,c=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!c;break e;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(i(231,r,typeof o));return o}var G=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),me=!1;if(G)try{var be={};Object.defineProperty(be,"passive",{get:function(){me=!0}}),window.addEventListener("test",be,be),window.removeEventListener("test",be,be)}catch{me=!1}var Ve=null,nt=null,st=null;function vt(){if(st)return st;var n,r=nt,o=r.length,c,f="value"in Ve?Ve.value:Ve.textContent,m=f.length;for(n=0;n<o&&r[n]===f[n];n++);var x=o-n;for(c=1;c<=x&&r[o-c]===f[m-c];c++);return st=f.slice(n,1<c?1-c:void 0)}function kt(n){var r=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&r===13&&(n=13)):n=r,n===10&&(n=13),32<=n||n===13?n:0}function Xt(){return!0}function Hn(){return!1}function tt(n){function r(o,c,f,m,x){this._reactName=o,this._targetInst=f,this.type=c,this.nativeEvent=m,this.target=x,this.currentTarget=null;for(var j in n)n.hasOwnProperty(j)&&(o=n[j],this[j]=o?o(m):m[j]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?Xt:Hn,this.isPropagationStopped=Hn,this}return k(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Xt)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Xt)},persist:function(){},isPersistent:Xt}),r}var mn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},an=tt(mn),mt=k({},mn,{view:0,detail:0}),gn=tt(mt),Xn,tr,Gs,As=k({},mt,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ta,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Gs&&(Gs&&n.type==="mousemove"?(Xn=n.screenX-Gs.screenX,tr=n.screenY-Gs.screenY):tr=Xn=0,Gs=n),Xn)},movementY:function(n){return"movementY"in n?n.movementY:tr}}),nr=tt(As),Sr=k({},As,{dataTransfer:0}),yo=tt(Sr),sl=k({},mt,{relatedTarget:0}),ai=tt(sl),hc=k({},mn,{animationName:0,elapsedTime:0,pseudoElement:0}),Yu=tt(hc),rl=k({},mn,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Qu=tt(rl),Xu=k({},mn,{data:0}),ji=tt(Xu),Ju={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Zu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ed={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function td(n){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(n):(n=ed[n])?!!r[n]:!1}function Ta(){return td}var sr=k({},mt,{key:function(n){if(n.key){var r=Ju[n.key]||n.key;if(r!=="Unidentified")return r}return n.type==="keypress"?(n=kt(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Zu[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ta,charCode:function(n){return n.type==="keypress"?kt(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?kt(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),nd=tt(sr),sd=k({},As,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Hi=tt(sd),h=k({},mt,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ta}),v=tt(h),_=k({},mn,{propertyName:0,elapsedTime:0,pseudoElement:0}),N=tt(_),se=k({},As,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),fe=tt(se),Be=k({},mn,{newState:0,oldState:0}),Vt=tt(Be),cs=[9,13,27,32],xn=G&&"CompositionEvent"in window,qn=null;G&&"documentMode"in document&&(qn=document.documentMode);var Br=G&&"TextEvent"in window&&!qn,Ei=G&&(!xn||qn&&8<qn&&11>=qn),oi=" ",li=!1;function vo(n,r){switch(n){case"keyup":return cs.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function il(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var al=!1;function tE(n,r){switch(n){case"compositionend":return il(r);case"keypress":return r.which!==32?null:(li=!0,oi);case"textInput":return n=r.data,n===oi&&li?null:n;default:return null}}function nE(n,r){if(al)return n==="compositionend"||!xn&&vo(n,r)?(n=vt(),st=nt=Ve=null,al=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return Ei&&r.locale!=="ko"?null:r.data;default:return null}}var sE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function j0(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r==="input"?!!sE[n.type]:r==="textarea"}function E0(n,r,o,c){S?Q?Q.push(c):Q=[c]:S=c,r=Wd(r,"onChange"),0<r.length&&(o=new an("onChange","change",null,o,c),n.push({event:o,listeners:r}))}var fc=null,mc=null;function rE(n){ob(n,0)}function rd(n){var r=ls(n);if(Rt(r))return n}function T0(n,r){if(n==="change")return r}var S0=!1;if(G){var Mf;if(G){var Df="oninput"in document;if(!Df){var C0=document.createElement("div");C0.setAttribute("oninput","return;"),Df=typeof C0.oninput=="function"}Mf=Df}else Mf=!1;S0=Mf&&(!document.documentMode||9<document.documentMode)}function N0(){fc&&(fc.detachEvent("onpropertychange",A0),mc=fc=null)}function A0(n){if(n.propertyName==="value"&&rd(mc)){var r=[];E0(r,mc,n,Ls(n)),F(rE,r)}}function iE(n,r,o){n==="focusin"?(N0(),fc=r,mc=o,fc.attachEvent("onpropertychange",A0)):n==="focusout"&&N0()}function aE(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return rd(mc)}function oE(n,r){if(n==="click")return rd(r)}function lE(n,r){if(n==="input"||n==="change")return rd(r)}function cE(n,r){return n===r&&(n!==0||1/n===1/r)||n!==n&&r!==r}var Cr=typeof Object.is=="function"?Object.is:cE;function gc(n,r){if(Cr(n,r))return!0;if(typeof n!="object"||n===null||typeof r!="object"||r===null)return!1;var o=Object.keys(n),c=Object.keys(r);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var f=o[c];if(!le.call(r,f)||!Cr(n[f],r[f]))return!1}return!0}function R0(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function I0(n,r){var o=R0(n);n=0;for(var c;o;){if(o.nodeType===3){if(c=n+o.textContent.length,n<=r&&c>=r)return{node:o,offset:r-n};n=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=R0(o)}}function M0(n,r){return n&&r?n===r?!0:n&&n.nodeType===3?!1:r&&r.nodeType===3?M0(n,r.parentNode):"contains"in n?n.contains(r):n.compareDocumentPosition?!!(n.compareDocumentPosition(r)&16):!1:!1}function D0(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var r=Nn(n.document);r instanceof n.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)n=r.contentWindow;else break;r=Nn(n.document)}return r}function Lf(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r&&(r==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||r==="textarea"||n.contentEditable==="true")}var uE=G&&"documentMode"in document&&11>=document.documentMode,ol=null,Pf=null,pc=null,Of=!1;function L0(n,r,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Of||ol==null||ol!==Nn(c)||(c=ol,"selectionStart"in c&&Lf(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),pc&&gc(pc,c)||(pc=c,c=Wd(Pf,"onSelect"),0<c.length&&(r=new an("onSelect","select",null,r,o),n.push({event:r,listeners:c}),r.target=ol)))}function bo(n,r){var o={};return o[n.toLowerCase()]=r.toLowerCase(),o["Webkit"+n]="webkit"+r,o["Moz"+n]="moz"+r,o}var ll={animationend:bo("Animation","AnimationEnd"),animationiteration:bo("Animation","AnimationIteration"),animationstart:bo("Animation","AnimationStart"),transitionrun:bo("Transition","TransitionRun"),transitionstart:bo("Transition","TransitionStart"),transitioncancel:bo("Transition","TransitionCancel"),transitionend:bo("Transition","TransitionEnd")},Vf={},P0={};G&&(P0=document.createElement("div").style,"AnimationEvent"in window||(delete ll.animationend.animation,delete ll.animationiteration.animation,delete ll.animationstart.animation),"TransitionEvent"in window||delete ll.transitionend.transition);function wo(n){if(Vf[n])return Vf[n];if(!ll[n])return n;var r=ll[n],o;for(o in r)if(r.hasOwnProperty(o)&&o in P0)return Vf[n]=r[o];return n}var O0=wo("animationend"),V0=wo("animationiteration"),U0=wo("animationstart"),dE=wo("transitionrun"),hE=wo("transitionstart"),fE=wo("transitioncancel"),B0=wo("transitionend"),z0=new Map,Uf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Uf.push("scrollEnd");function ci(n,r){z0.set(n,r),qs(r,[n])}var id=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},zr=[],cl=0,Bf=0;function ad(){for(var n=cl,r=Bf=cl=0;r<n;){var o=zr[r];zr[r++]=null;var c=zr[r];zr[r++]=null;var f=zr[r];zr[r++]=null;var m=zr[r];if(zr[r++]=null,c!==null&&f!==null){var x=c.pending;x===null?f.next=f:(f.next=x.next,x.next=f),c.pending=f}m!==0&&F0(o,f,m)}}function od(n,r,o,c){zr[cl++]=n,zr[cl++]=r,zr[cl++]=o,zr[cl++]=c,Bf|=c,n.lanes|=c,n=n.alternate,n!==null&&(n.lanes|=c)}function zf(n,r,o,c){return od(n,r,o,c),ld(n)}function xo(n,r){return od(n,null,null,r),ld(n)}function F0(n,r,o){n.lanes|=o;var c=n.alternate;c!==null&&(c.lanes|=o);for(var f=!1,m=n.return;m!==null;)m.childLanes|=o,c=m.alternate,c!==null&&(c.childLanes|=o),m.tag===22&&(n=m.stateNode,n===null||n._visibility&1||(f=!0)),n=m,m=m.return;return n.tag===3?(m=n.stateNode,f&&r!==null&&(f=31-Mt(o),n=m.hiddenUpdates,c=n[f],c===null?n[f]=[r]:c.push(r),r.lane=o|536870912),m):null}function ld(n){if(50<Vc)throw Vc=0,Qm=null,Error(i(185));for(var r=n.return;r!==null;)n=r,r=n.return;return n.tag===3?n.stateNode:null}var ul={};function mE(n,r,o,c){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nr(n,r,o,c){return new mE(n,r,o,c)}function Ff(n){return n=n.prototype,!(!n||!n.isReactComponent)}function qi(n,r){var o=n.alternate;return o===null?(o=Nr(n.tag,r,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=r,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&65011712,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,r=n.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o.refCleanup=n.refCleanup,o}function H0(n,r){n.flags&=65011714;var o=n.alternate;return o===null?(n.childLanes=0,n.lanes=r,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,r=o.dependencies,n.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),n}function cd(n,r,o,c,f,m){var x=0;if(c=n,typeof n=="function")Ff(n)&&(x=1);else if(typeof n=="string")x=bT(n,o,Ce.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case I:return n=Nr(31,o,r,f),n.elementType=I,n.lanes=m,n;case K:return _o(o.children,f,m,r);case B:x=8,f|=24;break;case Y:return n=Nr(12,o,r,f|2),n.elementType=Y,n.lanes=m,n;case ve:return n=Nr(13,o,r,f),n.elementType=ve,n.lanes=m,n;case he:return n=Nr(19,o,r,f),n.elementType=he,n.lanes=m,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case ae:x=10;break e;case ee:x=9;break e;case ye:x=11;break e;case D:x=14;break e;case T:x=16,c=null;break e}x=29,o=Error(i(130,n===null?"null":typeof n,"")),c=null}return r=Nr(x,o,r,f),r.elementType=n,r.type=c,r.lanes=m,r}function _o(n,r,o,c){return n=Nr(7,n,c,r),n.lanes=o,n}function Hf(n,r,o){return n=Nr(6,n,null,r),n.lanes=o,n}function q0(n){var r=Nr(18,null,null,0);return r.stateNode=n,r}function qf(n,r,o){return r=Nr(4,n.children!==null?n.children:[],n.key,r),r.lanes=o,r.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},r}var $0=new WeakMap;function Fr(n,r){if(typeof n=="object"&&n!==null){var o=$0.get(n);return o!==void 0?o:(r={value:n,source:r,stack:dt(r)},$0.set(n,r),r)}return{value:n,source:r,stack:dt(r)}}var dl=[],hl=0,ud=null,yc=0,Hr=[],qr=0,Sa=null,Ti=1,Si="";function $i(n,r){dl[hl++]=yc,dl[hl++]=ud,ud=n,yc=r}function W0(n,r,o){Hr[qr++]=Ti,Hr[qr++]=Si,Hr[qr++]=Sa,Sa=n;var c=Ti;n=Si;var f=32-Mt(c)-1;c&=~(1<<f),o+=1;var m=32-Mt(r)+f;if(30<m){var x=f-f%5;m=(c&(1<<x)-1).toString(32),c>>=x,f-=x,Ti=1<<32-Mt(r)+f|o<<f|c,Si=m+n}else Ti=1<<m|o<<f|c,Si=n}function $f(n){n.return!==null&&($i(n,1),W0(n,1,0))}function Wf(n){for(;n===ud;)ud=dl[--hl],dl[hl]=null,yc=dl[--hl],dl[hl]=null;for(;n===Sa;)Sa=Hr[--qr],Hr[qr]=null,Si=Hr[--qr],Hr[qr]=null,Ti=Hr[--qr],Hr[qr]=null}function G0(n,r){Hr[qr++]=Ti,Hr[qr++]=Si,Hr[qr++]=Sa,Ti=r.id,Si=r.overflow,Sa=n}var Ps=null,Un=null,on=!1,Ca=null,$r=!1,Gf=Error(i(519));function Na(n){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw vc(Fr(r,n)),Gf}function K0(n){var r=n.stateNode,o=n.type,c=n.memoizedProps;switch(r[At]=n,r[St]=c,o){case"dialog":Qt("cancel",r),Qt("close",r);break;case"iframe":case"object":case"embed":Qt("load",r);break;case"video":case"audio":for(o=0;o<Bc.length;o++)Qt(Bc[o],r);break;case"source":Qt("error",r);break;case"img":case"image":case"link":Qt("error",r),Qt("load",r);break;case"details":Qt("toggle",r);break;case"input":Qt("invalid",r),ri(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Qt("invalid",r);break;case"textarea":Qt("invalid",r),Er(r,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||r.textContent===""+o||c.suppressHydrationWarning===!0||db(r.textContent,o)?(c.popover!=null&&(Qt("beforetoggle",r),Qt("toggle",r)),c.onScroll!=null&&Qt("scroll",r),c.onScrollEnd!=null&&Qt("scrollend",r),c.onClick!=null&&(r.onclick=$s),r=!0):r=!1,r||Na(n,!0)}function Y0(n){for(Ps=n.return;Ps;)switch(Ps.tag){case 5:case 31:case 13:$r=!1;return;case 27:case 3:$r=!0;return;default:Ps=Ps.return}}function fl(n){if(n!==Ps)return!1;if(!on)return Y0(n),on=!0,!1;var r=n.tag,o;if((o=r!==3&&r!==27)&&((o=r===5)&&(o=n.type,o=!(o!=="form"&&o!=="button")||dg(n.type,n.memoizedProps)),o=!o),o&&Un&&Na(n),Y0(n),r===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Un=wb(n)}else if(r===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Un=wb(n)}else r===27?(r=Un,Ha(n.type)?(n=pg,pg=null,Un=n):Un=r):Un=Ps?Gr(n.stateNode.nextSibling):null;return!0}function ko(){Un=Ps=null,on=!1}function Kf(){var n=Ca;return n!==null&&(pr===null?pr=n:pr.push.apply(pr,n),Ca=null),n}function vc(n){Ca===null?Ca=[n]:Ca.push(n)}var Yf=V(null),jo=null,Wi=null;function Aa(n,r,o){je(Yf,r._currentValue),r._currentValue=o}function Gi(n){n._currentValue=Yf.current,ce(Yf)}function Qf(n,r,o){for(;n!==null;){var c=n.alternate;if((n.childLanes&r)!==r?(n.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),n===o)break;n=n.return}}function Xf(n,r,o,c){var f=n.child;for(f!==null&&(f.return=n);f!==null;){var m=f.dependencies;if(m!==null){var x=f.child;m=m.firstContext;e:for(;m!==null;){var j=m;m=f;for(var z=0;z<r.length;z++)if(j.context===r[z]){m.lanes|=o,j=m.alternate,j!==null&&(j.lanes|=o),Qf(m.return,o,n),c||(x=null);break e}m=j.next}}else if(f.tag===18){if(x=f.return,x===null)throw Error(i(341));x.lanes|=o,m=x.alternate,m!==null&&(m.lanes|=o),Qf(x,o,n),x=null}else x=f.child;if(x!==null)x.return=f;else for(x=f;x!==null;){if(x===n){x=null;break}if(f=x.sibling,f!==null){f.return=x.return,x=f;break}x=x.return}f=x}}function ml(n,r,o,c){n=null;for(var f=r,m=!1;f!==null;){if(!m){if((f.flags&524288)!==0)m=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var x=f.alternate;if(x===null)throw Error(i(387));if(x=x.memoizedProps,x!==null){var j=f.type;Cr(f.pendingProps.value,x.value)||(n!==null?n.push(j):n=[j])}}else if(f===$e.current){if(x=f.alternate,x===null)throw Error(i(387));x.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(n!==null?n.push($c):n=[$c])}f=f.return}n!==null&&Xf(r,n,o,c),r.flags|=262144}function dd(n){for(n=n.firstContext;n!==null;){if(!Cr(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function Eo(n){jo=n,Wi=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Os(n){return Q0(jo,n)}function hd(n,r){return jo===null&&Eo(n),Q0(n,r)}function Q0(n,r){var o=r._currentValue;if(r={context:r,memoizedValue:o,next:null},Wi===null){if(n===null)throw Error(i(308));Wi=r,n.dependencies={lanes:0,firstContext:r},n.flags|=524288}else Wi=Wi.next=r;return o}var gE=typeof AbortController<"u"?AbortController:function(){var n=[],r=this.signal={aborted:!1,addEventListener:function(o,c){n.push(c)}};this.abort=function(){r.aborted=!0,n.forEach(function(o){return o()})}},pE=s.unstable_scheduleCallback,yE=s.unstable_NormalPriority,gs={$$typeof:ae,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Jf(){return{controller:new gE,data:new Map,refCount:0}}function bc(n){n.refCount--,n.refCount===0&&pE(yE,function(){n.controller.abort()})}var wc=null,Zf=0,gl=0,pl=null;function vE(n,r){if(wc===null){var o=wc=[];Zf=0,gl=ng(),pl={status:"pending",value:void 0,then:function(c){o.push(c)}}}return Zf++,r.then(X0,X0),r}function X0(){if(--Zf===0&&wc!==null){pl!==null&&(pl.status="fulfilled");var n=wc;wc=null,gl=0,pl=null;for(var r=0;r<n.length;r++)(0,n[r])()}}function bE(n,r){var o=[],c={status:"pending",value:null,reason:null,then:function(f){o.push(f)}};return n.then(function(){c.status="fulfilled",c.value=r;for(var f=0;f<o.length;f++)(0,o[f])(r)},function(f){for(c.status="rejected",c.reason=f,f=0;f<o.length;f++)(0,o[f])(void 0)}),c}var J0=J.S;J.S=function(n,r){L1=gt(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&vE(n,r),J0!==null&&J0(n,r)};var To=V(null);function em(){var n=To.current;return n!==null?n:Mn.pooledCache}function fd(n,r){r===null?je(To,To.current):je(To,r.pool)}function Z0(){var n=em();return n===null?null:{parent:gs._currentValue,pool:n}}var yl=Error(i(460)),tm=Error(i(474)),md=Error(i(542)),gd={then:function(){}};function ev(n){return n=n.status,n==="fulfilled"||n==="rejected"}function tv(n,r,o){switch(o=n[o],o===void 0?n.push(r):o!==r&&(r.then($s,$s),r=o),r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,sv(n),n;default:if(typeof r.status=="string")r.then($s,$s);else{if(n=Mn,n!==null&&100<n.shellSuspendCounter)throw Error(i(482));n=r,n.status="pending",n.then(function(c){if(r.status==="pending"){var f=r;f.status="fulfilled",f.value=c}},function(c){if(r.status==="pending"){var f=r;f.status="rejected",f.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,sv(n),n}throw Co=r,yl}}function So(n){try{var r=n._init;return r(n._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Co=o,yl):o}}var Co=null;function nv(){if(Co===null)throw Error(i(459));var n=Co;return Co=null,n}function sv(n){if(n===yl||n===md)throw Error(i(483))}var vl=null,xc=0;function pd(n){var r=xc;return xc+=1,vl===null&&(vl=[]),tv(vl,n,r)}function _c(n,r){r=r.props.ref,n.ref=r!==void 0?r:null}function yd(n,r){throw r.$$typeof===E?Error(i(525)):(n=Object.prototype.toString.call(r),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":n)))}function rv(n){function r(X,W){if(n){var re=X.deletions;re===null?(X.deletions=[W],X.flags|=16):re.push(W)}}function o(X,W){if(!n)return null;for(;W!==null;)r(X,W),W=W.sibling;return null}function c(X){for(var W=new Map;X!==null;)X.key!==null?W.set(X.key,X):W.set(X.index,X),X=X.sibling;return W}function f(X,W){return X=qi(X,W),X.index=0,X.sibling=null,X}function m(X,W,re){return X.index=re,n?(re=X.alternate,re!==null?(re=re.index,re<W?(X.flags|=67108866,W):re):(X.flags|=67108866,W)):(X.flags|=1048576,W)}function x(X){return n&&X.alternate===null&&(X.flags|=67108866),X}function j(X,W,re,xe){return W===null||W.tag!==6?(W=Hf(re,X.mode,xe),W.return=X,W):(W=f(W,re),W.return=X,W)}function z(X,W,re,xe){var ht=re.type;return ht===K?we(X,W,re.props.children,xe,re.key):W!==null&&(W.elementType===ht||typeof ht=="object"&&ht!==null&&ht.$$typeof===T&&So(ht)===W.type)?(W=f(W,re.props),_c(W,re),W.return=X,W):(W=cd(re.type,re.key,re.props,null,X.mode,xe),_c(W,re),W.return=X,W)}function ie(X,W,re,xe){return W===null||W.tag!==4||W.stateNode.containerInfo!==re.containerInfo||W.stateNode.implementation!==re.implementation?(W=qf(re,X.mode,xe),W.return=X,W):(W=f(W,re.children||[]),W.return=X,W)}function we(X,W,re,xe,ht){return W===null||W.tag!==7?(W=_o(re,X.mode,xe,ht),W.return=X,W):(W=f(W,re),W.return=X,W)}function Ee(X,W,re){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return W=Hf(""+W,X.mode,re),W.return=X,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case M:return re=cd(W.type,W.key,W.props,null,X.mode,re),_c(re,W),re.return=X,re;case H:return W=qf(W,X.mode,re),W.return=X,W;case T:return W=So(W),Ee(X,W,re)}if(Ze(W)||P(W))return W=_o(W,X.mode,re,null),W.return=X,W;if(typeof W.then=="function")return Ee(X,pd(W),re);if(W.$$typeof===ae)return Ee(X,hd(X,W),re);yd(X,W)}return null}function de(X,W,re,xe){var ht=W!==null?W.key:null;if(typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint")return ht!==null?null:j(X,W,""+re,xe);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case M:return re.key===ht?z(X,W,re,xe):null;case H:return re.key===ht?ie(X,W,re,xe):null;case T:return re=So(re),de(X,W,re,xe)}if(Ze(re)||P(re))return ht!==null?null:we(X,W,re,xe,null);if(typeof re.then=="function")return de(X,W,pd(re),xe);if(re.$$typeof===ae)return de(X,W,hd(X,re),xe);yd(X,re)}return null}function ge(X,W,re,xe,ht){if(typeof xe=="string"&&xe!==""||typeof xe=="number"||typeof xe=="bigint")return X=X.get(re)||null,j(W,X,""+xe,ht);if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case M:return X=X.get(xe.key===null?re:xe.key)||null,z(W,X,xe,ht);case H:return X=X.get(xe.key===null?re:xe.key)||null,ie(W,X,xe,ht);case T:return xe=So(xe),ge(X,W,re,xe,ht)}if(Ze(xe)||P(xe))return X=X.get(re)||null,we(W,X,xe,ht,null);if(typeof xe.then=="function")return ge(X,W,re,pd(xe),ht);if(xe.$$typeof===ae)return ge(X,W,re,hd(W,xe),ht);yd(W,xe)}return null}function et(X,W,re,xe){for(var ht=null,yn=null,at=W,Ft=W=0,Zt=null;at!==null&&Ft<re.length;Ft++){at.index>Ft?(Zt=at,at=null):Zt=at.sibling;var vn=de(X,at,re[Ft],xe);if(vn===null){at===null&&(at=Zt);break}n&&at&&vn.alternate===null&&r(X,at),W=m(vn,W,Ft),yn===null?ht=vn:yn.sibling=vn,yn=vn,at=Zt}if(Ft===re.length)return o(X,at),on&&$i(X,Ft),ht;if(at===null){for(;Ft<re.length;Ft++)at=Ee(X,re[Ft],xe),at!==null&&(W=m(at,W,Ft),yn===null?ht=at:yn.sibling=at,yn=at);return on&&$i(X,Ft),ht}for(at=c(at);Ft<re.length;Ft++)Zt=ge(at,X,Ft,re[Ft],xe),Zt!==null&&(n&&Zt.alternate!==null&&at.delete(Zt.key===null?Ft:Zt.key),W=m(Zt,W,Ft),yn===null?ht=Zt:yn.sibling=Zt,yn=Zt);return n&&at.forEach(function(Ka){return r(X,Ka)}),on&&$i(X,Ft),ht}function wt(X,W,re,xe){if(re==null)throw Error(i(151));for(var ht=null,yn=null,at=W,Ft=W=0,Zt=null,vn=re.next();at!==null&&!vn.done;Ft++,vn=re.next()){at.index>Ft?(Zt=at,at=null):Zt=at.sibling;var Ka=de(X,at,vn.value,xe);if(Ka===null){at===null&&(at=Zt);break}n&&at&&Ka.alternate===null&&r(X,at),W=m(Ka,W,Ft),yn===null?ht=Ka:yn.sibling=Ka,yn=Ka,at=Zt}if(vn.done)return o(X,at),on&&$i(X,Ft),ht;if(at===null){for(;!vn.done;Ft++,vn=re.next())vn=Ee(X,vn.value,xe),vn!==null&&(W=m(vn,W,Ft),yn===null?ht=vn:yn.sibling=vn,yn=vn);return on&&$i(X,Ft),ht}for(at=c(at);!vn.done;Ft++,vn=re.next())vn=ge(at,X,Ft,vn.value,xe),vn!==null&&(n&&vn.alternate!==null&&at.delete(vn.key===null?Ft:vn.key),W=m(vn,W,Ft),yn===null?ht=vn:yn.sibling=vn,yn=vn);return n&&at.forEach(function(AT){return r(X,AT)}),on&&$i(X,Ft),ht}function In(X,W,re,xe){if(typeof re=="object"&&re!==null&&re.type===K&&re.key===null&&(re=re.props.children),typeof re=="object"&&re!==null){switch(re.$$typeof){case M:e:{for(var ht=re.key;W!==null;){if(W.key===ht){if(ht=re.type,ht===K){if(W.tag===7){o(X,W.sibling),xe=f(W,re.props.children),xe.return=X,X=xe;break e}}else if(W.elementType===ht||typeof ht=="object"&&ht!==null&&ht.$$typeof===T&&So(ht)===W.type){o(X,W.sibling),xe=f(W,re.props),_c(xe,re),xe.return=X,X=xe;break e}o(X,W);break}else r(X,W);W=W.sibling}re.type===K?(xe=_o(re.props.children,X.mode,xe,re.key),xe.return=X,X=xe):(xe=cd(re.type,re.key,re.props,null,X.mode,xe),_c(xe,re),xe.return=X,X=xe)}return x(X);case H:e:{for(ht=re.key;W!==null;){if(W.key===ht)if(W.tag===4&&W.stateNode.containerInfo===re.containerInfo&&W.stateNode.implementation===re.implementation){o(X,W.sibling),xe=f(W,re.children||[]),xe.return=X,X=xe;break e}else{o(X,W);break}else r(X,W);W=W.sibling}xe=qf(re,X.mode,xe),xe.return=X,X=xe}return x(X);case T:return re=So(re),In(X,W,re,xe)}if(Ze(re))return et(X,W,re,xe);if(P(re)){if(ht=P(re),typeof ht!="function")throw Error(i(150));return re=ht.call(re),wt(X,W,re,xe)}if(typeof re.then=="function")return In(X,W,pd(re),xe);if(re.$$typeof===ae)return In(X,W,hd(X,re),xe);yd(X,re)}return typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint"?(re=""+re,W!==null&&W.tag===6?(o(X,W.sibling),xe=f(W,re),xe.return=X,X=xe):(o(X,W),xe=Hf(re,X.mode,xe),xe.return=X,X=xe),x(X)):o(X,W)}return function(X,W,re,xe){try{xc=0;var ht=In(X,W,re,xe);return vl=null,ht}catch(at){if(at===yl||at===md)throw at;var yn=Nr(29,at,null,X.mode);return yn.lanes=xe,yn.return=X,yn}}}var No=rv(!0),iv=rv(!1),Ra=!1;function nm(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function sm(n,r){n=n.updateQueue,r.updateQueue===n&&(r.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Ia(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Ma(n,r,o){var c=n.updateQueue;if(c===null)return null;if(c=c.shared,(_n&2)!==0){var f=c.pending;return f===null?r.next=r:(r.next=f.next,f.next=r),c.pending=r,r=ld(n),F0(n,null,o),r}return od(n,c,r,o),ld(n)}function kc(n,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194048)!==0)){var c=r.lanes;c&=n.pendingLanes,o|=c,r.lanes=o,ue(n,o)}}function rm(n,r){var o=n.updateQueue,c=n.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var f=null,m=null;if(o=o.firstBaseUpdate,o!==null){do{var x={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};m===null?f=m=x:m=m.next=x,o=o.next}while(o!==null);m===null?f=m=r:m=m.next=r}else f=m=r;o={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:m,shared:c.shared,callbacks:c.callbacks},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=r:n.next=r,o.lastBaseUpdate=r}var im=!1;function jc(){if(im){var n=pl;if(n!==null)throw n}}function Ec(n,r,o,c){im=!1;var f=n.updateQueue;Ra=!1;var m=f.firstBaseUpdate,x=f.lastBaseUpdate,j=f.shared.pending;if(j!==null){f.shared.pending=null;var z=j,ie=z.next;z.next=null,x===null?m=ie:x.next=ie,x=z;var we=n.alternate;we!==null&&(we=we.updateQueue,j=we.lastBaseUpdate,j!==x&&(j===null?we.firstBaseUpdate=ie:j.next=ie,we.lastBaseUpdate=z))}if(m!==null){var Ee=f.baseState;x=0,we=ie=z=null,j=m;do{var de=j.lane&-536870913,ge=de!==j.lane;if(ge?(Jt&de)===de:(c&de)===de){de!==0&&de===gl&&(im=!0),we!==null&&(we=we.next={lane:0,tag:j.tag,payload:j.payload,callback:null,next:null});e:{var et=n,wt=j;de=r;var In=o;switch(wt.tag){case 1:if(et=wt.payload,typeof et=="function"){Ee=et.call(In,Ee,de);break e}Ee=et;break e;case 3:et.flags=et.flags&-65537|128;case 0:if(et=wt.payload,de=typeof et=="function"?et.call(In,Ee,de):et,de==null)break e;Ee=k({},Ee,de);break e;case 2:Ra=!0}}de=j.callback,de!==null&&(n.flags|=64,ge&&(n.flags|=8192),ge=f.callbacks,ge===null?f.callbacks=[de]:ge.push(de))}else ge={lane:de,tag:j.tag,payload:j.payload,callback:j.callback,next:null},we===null?(ie=we=ge,z=Ee):we=we.next=ge,x|=de;if(j=j.next,j===null){if(j=f.shared.pending,j===null)break;ge=j,j=ge.next,ge.next=null,f.lastBaseUpdate=ge,f.shared.pending=null}}while(!0);we===null&&(z=Ee),f.baseState=z,f.firstBaseUpdate=ie,f.lastBaseUpdate=we,m===null&&(f.shared.lanes=0),Va|=x,n.lanes=x,n.memoizedState=Ee}}function av(n,r){if(typeof n!="function")throw Error(i(191,n));n.call(r)}function ov(n,r){var o=n.callbacks;if(o!==null)for(n.callbacks=null,n=0;n<o.length;n++)av(o[n],r)}var bl=V(null),vd=V(0);function lv(n,r){n=na,je(vd,n),je(bl,r),na=n|r.baseLanes}function am(){je(vd,na),je(bl,bl.current)}function om(){na=vd.current,ce(bl),ce(vd)}var Ar=V(null),Wr=null;function Da(n){var r=n.alternate;je(us,us.current&1),je(Ar,n),Wr===null&&(r===null||bl.current!==null||r.memoizedState!==null)&&(Wr=n)}function lm(n){je(us,us.current),je(Ar,n),Wr===null&&(Wr=n)}function cv(n){n.tag===22?(je(us,us.current),je(Ar,n),Wr===null&&(Wr=n)):La()}function La(){je(us,us.current),je(Ar,Ar.current)}function Rr(n){ce(Ar),Wr===n&&(Wr=null),ce(us)}var us=V(0);function bd(n){for(var r=n;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||mg(o)||gg(o)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Ki=0,Ut=null,An=null,ps=null,wd=!1,wl=!1,Ao=!1,xd=0,Tc=0,xl=null,wE=0;function ns(){throw Error(i(321))}function cm(n,r){if(r===null)return!1;for(var o=0;o<r.length&&o<n.length;o++)if(!Cr(n[o],r[o]))return!1;return!0}function um(n,r,o,c,f,m){return Ki=m,Ut=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,J.H=n===null||n.memoizedState===null?Wv:Em,Ao=!1,m=o(c,f),Ao=!1,wl&&(m=dv(r,o,c,f)),uv(n),m}function uv(n){J.H=Nc;var r=An!==null&&An.next!==null;if(Ki=0,ps=An=Ut=null,wd=!1,Tc=0,xl=null,r)throw Error(i(300));n===null||ys||(n=n.dependencies,n!==null&&dd(n)&&(ys=!0))}function dv(n,r,o,c){Ut=n;var f=0;do{if(wl&&(xl=null),Tc=0,wl=!1,25<=f)throw Error(i(301));if(f+=1,ps=An=null,n.updateQueue!=null){var m=n.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}J.H=Gv,m=r(o,c)}while(wl);return m}function xE(){var n=J.H,r=n.useState()[0];return r=typeof r.then=="function"?Sc(r):r,n=n.useState()[0],(An!==null?An.memoizedState:null)!==n&&(Ut.flags|=1024),r}function dm(){var n=xd!==0;return xd=0,n}function hm(n,r,o){r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~o}function fm(n){if(wd){for(n=n.memoizedState;n!==null;){var r=n.queue;r!==null&&(r.pending=null),n=n.next}wd=!1}Ki=0,ps=An=Ut=null,wl=!1,Tc=xd=0,xl=null}function rr(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ps===null?Ut.memoizedState=ps=n:ps=ps.next=n,ps}function ds(){if(An===null){var n=Ut.alternate;n=n!==null?n.memoizedState:null}else n=An.next;var r=ps===null?Ut.memoizedState:ps.next;if(r!==null)ps=r,An=n;else{if(n===null)throw Ut.alternate===null?Error(i(467)):Error(i(310));An=n,n={memoizedState:An.memoizedState,baseState:An.baseState,baseQueue:An.baseQueue,queue:An.queue,next:null},ps===null?Ut.memoizedState=ps=n:ps=ps.next=n}return ps}function _d(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Sc(n){var r=Tc;return Tc+=1,xl===null&&(xl=[]),n=tv(xl,n,r),r=Ut,(ps===null?r.memoizedState:ps.next)===null&&(r=r.alternate,J.H=r===null||r.memoizedState===null?Wv:Em),n}function kd(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return Sc(n);if(n.$$typeof===ae)return Os(n)}throw Error(i(438,String(n)))}function mm(n){var r=null,o=Ut.updateQueue;if(o!==null&&(r=o.memoCache),r==null){var c=Ut.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(f){return f.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),o===null&&(o=_d(),Ut.updateQueue=o),o.memoCache=r,o=r.data[r.index],o===void 0)for(o=r.data[r.index]=Array(n),c=0;c<n;c++)o[c]=U;return r.index++,o}function Yi(n,r){return typeof r=="function"?r(n):r}function jd(n){var r=ds();return gm(r,An,n)}function gm(n,r,o){var c=n.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var f=n.baseQueue,m=c.pending;if(m!==null){if(f!==null){var x=f.next;f.next=m.next,m.next=x}r.baseQueue=f=m,c.pending=null}if(m=n.baseState,f===null)n.memoizedState=m;else{r=f.next;var j=x=null,z=null,ie=r,we=!1;do{var Ee=ie.lane&-536870913;if(Ee!==ie.lane?(Jt&Ee)===Ee:(Ki&Ee)===Ee){var de=ie.revertLane;if(de===0)z!==null&&(z=z.next={lane:0,revertLane:0,gesture:null,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null}),Ee===gl&&(we=!0);else if((Ki&de)===de){ie=ie.next,de===gl&&(we=!0);continue}else Ee={lane:0,revertLane:ie.revertLane,gesture:null,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},z===null?(j=z=Ee,x=m):z=z.next=Ee,Ut.lanes|=de,Va|=de;Ee=ie.action,Ao&&o(m,Ee),m=ie.hasEagerState?ie.eagerState:o(m,Ee)}else de={lane:Ee,revertLane:ie.revertLane,gesture:ie.gesture,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},z===null?(j=z=de,x=m):z=z.next=de,Ut.lanes|=Ee,Va|=Ee;ie=ie.next}while(ie!==null&&ie!==r);if(z===null?x=m:z.next=j,!Cr(m,n.memoizedState)&&(ys=!0,we&&(o=pl,o!==null)))throw o;n.memoizedState=m,n.baseState=x,n.baseQueue=z,c.lastRenderedState=m}return f===null&&(c.lanes=0),[n.memoizedState,c.dispatch]}function pm(n){var r=ds(),o=r.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=n;var c=o.dispatch,f=o.pending,m=r.memoizedState;if(f!==null){o.pending=null;var x=f=f.next;do m=n(m,x.action),x=x.next;while(x!==f);Cr(m,r.memoizedState)||(ys=!0),r.memoizedState=m,r.baseQueue===null&&(r.baseState=m),o.lastRenderedState=m}return[m,c]}function hv(n,r,o){var c=Ut,f=ds(),m=on;if(m){if(o===void 0)throw Error(i(407));o=o()}else o=r();var x=!Cr((An||f).memoizedState,o);if(x&&(f.memoizedState=o,ys=!0),f=f.queue,bm(gv.bind(null,c,f,n),[n]),f.getSnapshot!==r||x||ps!==null&&ps.memoizedState.tag&1){if(c.flags|=2048,_l(9,{destroy:void 0},mv.bind(null,c,f,o,r),null),Mn===null)throw Error(i(349));m||(Ki&127)!==0||fv(c,r,o)}return o}function fv(n,r,o){n.flags|=16384,n={getSnapshot:r,value:o},r=Ut.updateQueue,r===null?(r=_d(),Ut.updateQueue=r,r.stores=[n]):(o=r.stores,o===null?r.stores=[n]:o.push(n))}function mv(n,r,o,c){r.value=o,r.getSnapshot=c,pv(r)&&yv(n)}function gv(n,r,o){return o(function(){pv(r)&&yv(n)})}function pv(n){var r=n.getSnapshot;n=n.value;try{var o=r();return!Cr(n,o)}catch{return!0}}function yv(n){var r=xo(n,2);r!==null&&yr(r,n,2)}function ym(n){var r=rr();if(typeof n=="function"){var o=n;if(n=o(),Ao){Ct(!0);try{o()}finally{Ct(!1)}}}return r.memoizedState=r.baseState=n,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yi,lastRenderedState:n},r}function vv(n,r,o,c){return n.baseState=o,gm(n,An,typeof c=="function"?c:Yi)}function _E(n,r,o,c,f){if(Sd(n))throw Error(i(485));if(n=r.action,n!==null){var m={payload:f,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(x){m.listeners.push(x)}};J.T!==null?o(!0):m.isTransition=!1,c(m),o=r.pending,o===null?(m.next=r.pending=m,bv(r,m)):(m.next=o.next,r.pending=o.next=m)}}function bv(n,r){var o=r.action,c=r.payload,f=n.state;if(r.isTransition){var m=J.T,x={};J.T=x;try{var j=o(f,c),z=J.S;z!==null&&z(x,j),wv(n,r,j)}catch(ie){vm(n,r,ie)}finally{m!==null&&x.types!==null&&(m.types=x.types),J.T=m}}else try{m=o(f,c),wv(n,r,m)}catch(ie){vm(n,r,ie)}}function wv(n,r,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){xv(n,r,c)},function(c){return vm(n,r,c)}):xv(n,r,o)}function xv(n,r,o){r.status="fulfilled",r.value=o,_v(r),n.state=o,r=n.pending,r!==null&&(o=r.next,o===r?n.pending=null:(o=o.next,r.next=o,bv(n,o)))}function vm(n,r,o){var c=n.pending;if(n.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=o,_v(r),r=r.next;while(r!==c)}n.action=null}function _v(n){n=n.listeners;for(var r=0;r<n.length;r++)(0,n[r])()}function kv(n,r){return r}function jv(n,r){if(on){var o=Mn.formState;if(o!==null){e:{var c=Ut;if(on){if(Un){t:{for(var f=Un,m=$r;f.nodeType!==8;){if(!m){f=null;break t}if(f=Gr(f.nextSibling),f===null){f=null;break t}}m=f.data,f=m==="F!"||m==="F"?f:null}if(f){Un=Gr(f.nextSibling),c=f.data==="F!";break e}}Na(c)}c=!1}c&&(r=o[0])}}return o=rr(),o.memoizedState=o.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:kv,lastRenderedState:r},o.queue=c,o=Hv.bind(null,Ut,c),c.dispatch=o,c=ym(!1),m=jm.bind(null,Ut,!1,c.queue),c=rr(),f={state:r,dispatch:null,action:n,pending:null},c.queue=f,o=_E.bind(null,Ut,f,m,o),f.dispatch=o,c.memoizedState=n,[r,o,!1]}function Ev(n){var r=ds();return Tv(r,An,n)}function Tv(n,r,o){if(r=gm(n,r,kv)[0],n=jd(Yi)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=Sc(r)}catch(x){throw x===yl?md:x}else c=r;r=ds();var f=r.queue,m=f.dispatch;return o!==r.memoizedState&&(Ut.flags|=2048,_l(9,{destroy:void 0},kE.bind(null,f,o),null)),[c,m,n]}function kE(n,r){n.action=r}function Sv(n){var r=ds(),o=An;if(o!==null)return Tv(r,o,n);ds(),r=r.memoizedState,o=ds();var c=o.queue.dispatch;return o.memoizedState=n,[r,c,!1]}function _l(n,r,o,c){return n={tag:n,create:o,deps:c,inst:r,next:null},r=Ut.updateQueue,r===null&&(r=_d(),Ut.updateQueue=r),o=r.lastEffect,o===null?r.lastEffect=n.next=n:(c=o.next,o.next=n,n.next=c,r.lastEffect=n),n}function Cv(){return ds().memoizedState}function Ed(n,r,o,c){var f=rr();Ut.flags|=n,f.memoizedState=_l(1|r,{destroy:void 0},o,c===void 0?null:c)}function Td(n,r,o,c){var f=ds();c=c===void 0?null:c;var m=f.memoizedState.inst;An!==null&&c!==null&&cm(c,An.memoizedState.deps)?f.memoizedState=_l(r,m,o,c):(Ut.flags|=n,f.memoizedState=_l(1|r,m,o,c))}function Nv(n,r){Ed(8390656,8,n,r)}function bm(n,r){Td(2048,8,n,r)}function jE(n){Ut.flags|=4;var r=Ut.updateQueue;if(r===null)r=_d(),Ut.updateQueue=r,r.events=[n];else{var o=r.events;o===null?r.events=[n]:o.push(n)}}function Av(n){var r=ds().memoizedState;return jE({ref:r,nextImpl:n}),function(){if((_n&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function Rv(n,r){return Td(4,2,n,r)}function Iv(n,r){return Td(4,4,n,r)}function Mv(n,r){if(typeof r=="function"){n=n();var o=r(n);return function(){typeof o=="function"?o():r(null)}}if(r!=null)return n=n(),r.current=n,function(){r.current=null}}function Dv(n,r,o){o=o!=null?o.concat([n]):null,Td(4,4,Mv.bind(null,r,n),o)}function wm(){}function Lv(n,r){var o=ds();r=r===void 0?null:r;var c=o.memoizedState;return r!==null&&cm(r,c[1])?c[0]:(o.memoizedState=[n,r],n)}function Pv(n,r){var o=ds();r=r===void 0?null:r;var c=o.memoizedState;if(r!==null&&cm(r,c[1]))return c[0];if(c=n(),Ao){Ct(!0);try{n()}finally{Ct(!1)}}return o.memoizedState=[c,r],c}function xm(n,r,o){return o===void 0||(Ki&1073741824)!==0&&(Jt&261930)===0?n.memoizedState=r:(n.memoizedState=o,n=O1(),Ut.lanes|=n,Va|=n,o)}function Ov(n,r,o,c){return Cr(o,r)?o:bl.current!==null?(n=xm(n,o,c),Cr(n,r)||(ys=!0),n):(Ki&42)===0||(Ki&1073741824)!==0&&(Jt&261930)===0?(ys=!0,n.memoizedState=o):(n=O1(),Ut.lanes|=n,Va|=n,r)}function Vv(n,r,o,c,f){var m=Te.p;Te.p=m!==0&&8>m?m:8;var x=J.T,j={};J.T=j,jm(n,!1,r,o);try{var z=f(),ie=J.S;if(ie!==null&&ie(j,z),z!==null&&typeof z=="object"&&typeof z.then=="function"){var we=bE(z,c);Cc(n,r,we,Dr(n))}else Cc(n,r,c,Dr(n))}catch(Ee){Cc(n,r,{then:function(){},status:"rejected",reason:Ee},Dr())}finally{Te.p=m,x!==null&&j.types!==null&&(x.types=j.types),J.T=x}}function EE(){}function _m(n,r,o,c){if(n.tag!==5)throw Error(i(476));var f=Uv(n).queue;Vv(n,f,r,He,o===null?EE:function(){return Bv(n),o(c)})}function Uv(n){var r=n.memoizedState;if(r!==null)return r;r={memoizedState:He,baseState:He,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yi,lastRenderedState:He},next:null};var o={};return r.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yi,lastRenderedState:o},next:null},n.memoizedState=r,n=n.alternate,n!==null&&(n.memoizedState=r),r}function Bv(n){var r=Uv(n);r.next===null&&(r=n.alternate.memoizedState),Cc(n,r.next.queue,{},Dr())}function km(){return Os($c)}function zv(){return ds().memoizedState}function Fv(){return ds().memoizedState}function TE(n){for(var r=n.return;r!==null;){switch(r.tag){case 24:case 3:var o=Dr();n=Ia(o);var c=Ma(r,n,o);c!==null&&(yr(c,r,o),kc(c,r,o)),r={cache:Jf()},n.payload=r;return}r=r.return}}function SE(n,r,o){var c=Dr();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},Sd(n)?qv(r,o):(o=zf(n,r,o,c),o!==null&&(yr(o,n,c),$v(o,r,c)))}function Hv(n,r,o){var c=Dr();Cc(n,r,o,c)}function Cc(n,r,o,c){var f={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(Sd(n))qv(r,f);else{var m=n.alternate;if(n.lanes===0&&(m===null||m.lanes===0)&&(m=r.lastRenderedReducer,m!==null))try{var x=r.lastRenderedState,j=m(x,o);if(f.hasEagerState=!0,f.eagerState=j,Cr(j,x))return od(n,r,f,0),Mn===null&&ad(),!1}catch{}if(o=zf(n,r,f,c),o!==null)return yr(o,n,c),$v(o,r,c),!0}return!1}function jm(n,r,o,c){if(c={lane:2,revertLane:ng(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Sd(n)){if(r)throw Error(i(479))}else r=zf(n,o,c,2),r!==null&&yr(r,n,2)}function Sd(n){var r=n.alternate;return n===Ut||r!==null&&r===Ut}function qv(n,r){wl=wd=!0;var o=n.pending;o===null?r.next=r:(r.next=o.next,o.next=r),n.pending=r}function $v(n,r,o){if((o&4194048)!==0){var c=r.lanes;c&=n.pendingLanes,o|=c,r.lanes=o,ue(n,o)}}var Nc={readContext:Os,use:kd,useCallback:ns,useContext:ns,useEffect:ns,useImperativeHandle:ns,useLayoutEffect:ns,useInsertionEffect:ns,useMemo:ns,useReducer:ns,useRef:ns,useState:ns,useDebugValue:ns,useDeferredValue:ns,useTransition:ns,useSyncExternalStore:ns,useId:ns,useHostTransitionStatus:ns,useFormState:ns,useActionState:ns,useOptimistic:ns,useMemoCache:ns,useCacheRefresh:ns};Nc.useEffectEvent=ns;var Wv={readContext:Os,use:kd,useCallback:function(n,r){return rr().memoizedState=[n,r===void 0?null:r],n},useContext:Os,useEffect:Nv,useImperativeHandle:function(n,r,o){o=o!=null?o.concat([n]):null,Ed(4194308,4,Mv.bind(null,r,n),o)},useLayoutEffect:function(n,r){return Ed(4194308,4,n,r)},useInsertionEffect:function(n,r){Ed(4,2,n,r)},useMemo:function(n,r){var o=rr();r=r===void 0?null:r;var c=n();if(Ao){Ct(!0);try{n()}finally{Ct(!1)}}return o.memoizedState=[c,r],c},useReducer:function(n,r,o){var c=rr();if(o!==void 0){var f=o(r);if(Ao){Ct(!0);try{o(r)}finally{Ct(!1)}}}else f=r;return c.memoizedState=c.baseState=f,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:f},c.queue=n,n=n.dispatch=SE.bind(null,Ut,n),[c.memoizedState,n]},useRef:function(n){var r=rr();return n={current:n},r.memoizedState=n},useState:function(n){n=ym(n);var r=n.queue,o=Hv.bind(null,Ut,r);return r.dispatch=o,[n.memoizedState,o]},useDebugValue:wm,useDeferredValue:function(n,r){var o=rr();return xm(o,n,r)},useTransition:function(){var n=ym(!1);return n=Vv.bind(null,Ut,n.queue,!0,!1),rr().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,r,o){var c=Ut,f=rr();if(on){if(o===void 0)throw Error(i(407));o=o()}else{if(o=r(),Mn===null)throw Error(i(349));(Jt&127)!==0||fv(c,r,o)}f.memoizedState=o;var m={value:o,getSnapshot:r};return f.queue=m,Nv(gv.bind(null,c,m,n),[n]),c.flags|=2048,_l(9,{destroy:void 0},mv.bind(null,c,m,o,r),null),o},useId:function(){var n=rr(),r=Mn.identifierPrefix;if(on){var o=Si,c=Ti;o=(c&~(1<<32-Mt(c)-1)).toString(32)+o,r="_"+r+"R_"+o,o=xd++,0<o&&(r+="H"+o.toString(32)),r+="_"}else o=wE++,r="_"+r+"r_"+o.toString(32)+"_";return n.memoizedState=r},useHostTransitionStatus:km,useFormState:jv,useActionState:jv,useOptimistic:function(n){var r=rr();r.memoizedState=r.baseState=n;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=o,r=jm.bind(null,Ut,!0,o),o.dispatch=r,[n,r]},useMemoCache:mm,useCacheRefresh:function(){return rr().memoizedState=TE.bind(null,Ut)},useEffectEvent:function(n){var r=rr(),o={impl:n};return r.memoizedState=o,function(){if((_n&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},Em={readContext:Os,use:kd,useCallback:Lv,useContext:Os,useEffect:bm,useImperativeHandle:Dv,useInsertionEffect:Rv,useLayoutEffect:Iv,useMemo:Pv,useReducer:jd,useRef:Cv,useState:function(){return jd(Yi)},useDebugValue:wm,useDeferredValue:function(n,r){var o=ds();return Ov(o,An.memoizedState,n,r)},useTransition:function(){var n=jd(Yi)[0],r=ds().memoizedState;return[typeof n=="boolean"?n:Sc(n),r]},useSyncExternalStore:hv,useId:zv,useHostTransitionStatus:km,useFormState:Ev,useActionState:Ev,useOptimistic:function(n,r){var o=ds();return vv(o,An,n,r)},useMemoCache:mm,useCacheRefresh:Fv};Em.useEffectEvent=Av;var Gv={readContext:Os,use:kd,useCallback:Lv,useContext:Os,useEffect:bm,useImperativeHandle:Dv,useInsertionEffect:Rv,useLayoutEffect:Iv,useMemo:Pv,useReducer:pm,useRef:Cv,useState:function(){return pm(Yi)},useDebugValue:wm,useDeferredValue:function(n,r){var o=ds();return An===null?xm(o,n,r):Ov(o,An.memoizedState,n,r)},useTransition:function(){var n=pm(Yi)[0],r=ds().memoizedState;return[typeof n=="boolean"?n:Sc(n),r]},useSyncExternalStore:hv,useId:zv,useHostTransitionStatus:km,useFormState:Sv,useActionState:Sv,useOptimistic:function(n,r){var o=ds();return An!==null?vv(o,An,n,r):(o.baseState=n,[n,o.queue.dispatch])},useMemoCache:mm,useCacheRefresh:Fv};Gv.useEffectEvent=Av;function Tm(n,r,o,c){r=n.memoizedState,o=o(c,r),o=o==null?r:k({},r,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var Sm={enqueueSetState:function(n,r,o){n=n._reactInternals;var c=Dr(),f=Ia(c);f.payload=r,o!=null&&(f.callback=o),r=Ma(n,f,c),r!==null&&(yr(r,n,c),kc(r,n,c))},enqueueReplaceState:function(n,r,o){n=n._reactInternals;var c=Dr(),f=Ia(c);f.tag=1,f.payload=r,o!=null&&(f.callback=o),r=Ma(n,f,c),r!==null&&(yr(r,n,c),kc(r,n,c))},enqueueForceUpdate:function(n,r){n=n._reactInternals;var o=Dr(),c=Ia(o);c.tag=2,r!=null&&(c.callback=r),r=Ma(n,c,o),r!==null&&(yr(r,n,o),kc(r,n,o))}};function Kv(n,r,o,c,f,m,x){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(c,m,x):r.prototype&&r.prototype.isPureReactComponent?!gc(o,c)||!gc(f,m):!0}function Yv(n,r,o,c){n=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,c),r.state!==n&&Sm.enqueueReplaceState(r,r.state,null)}function Ro(n,r){var o=r;if("ref"in r){o={};for(var c in r)c!=="ref"&&(o[c]=r[c])}if(n=n.defaultProps){o===r&&(o=k({},o));for(var f in n)o[f]===void 0&&(o[f]=n[f])}return o}function Qv(n){id(n)}function Xv(n){console.error(n)}function Jv(n){id(n)}function Cd(n,r){try{var o=n.onUncaughtError;o(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function Zv(n,r,o){try{var c=n.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function Cm(n,r,o){return o=Ia(o),o.tag=3,o.payload={element:null},o.callback=function(){Cd(n,r)},o}function e1(n){return n=Ia(n),n.tag=3,n}function t1(n,r,o,c){var f=o.type.getDerivedStateFromError;if(typeof f=="function"){var m=c.value;n.payload=function(){return f(m)},n.callback=function(){Zv(r,o,c)}}var x=o.stateNode;x!==null&&typeof x.componentDidCatch=="function"&&(n.callback=function(){Zv(r,o,c),typeof f!="function"&&(Ua===null?Ua=new Set([this]):Ua.add(this));var j=c.stack;this.componentDidCatch(c.value,{componentStack:j!==null?j:""})})}function CE(n,r,o,c,f){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=o.alternate,r!==null&&ml(r,o,f,!0),o=Ar.current,o!==null){switch(o.tag){case 31:case 13:return Wr===null?Bd():o.alternate===null&&ss===0&&(ss=3),o.flags&=-257,o.flags|=65536,o.lanes=f,c===gd?o.flags|=16384:(r=o.updateQueue,r===null?o.updateQueue=new Set([c]):r.add(c),Zm(n,c,f)),!1;case 22:return o.flags|=65536,c===gd?o.flags|=16384:(r=o.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=r):(o=r.retryQueue,o===null?r.retryQueue=new Set([c]):o.add(c)),Zm(n,c,f)),!1}throw Error(i(435,o.tag))}return Zm(n,c,f),Bd(),!1}if(on)return r=Ar.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=f,c!==Gf&&(n=Error(i(422),{cause:c}),vc(Fr(n,o)))):(c!==Gf&&(r=Error(i(423),{cause:c}),vc(Fr(r,o))),n=n.current.alternate,n.flags|=65536,f&=-f,n.lanes|=f,c=Fr(c,o),f=Cm(n.stateNode,c,f),rm(n,f),ss!==4&&(ss=2)),!1;var m=Error(i(520),{cause:c});if(m=Fr(m,o),Oc===null?Oc=[m]:Oc.push(m),ss!==4&&(ss=2),r===null)return!0;c=Fr(c,o),o=r;do{switch(o.tag){case 3:return o.flags|=65536,n=f&-f,o.lanes|=n,n=Cm(o.stateNode,c,n),rm(o,n),!1;case 1:if(r=o.type,m=o.stateNode,(o.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Ua===null||!Ua.has(m))))return o.flags|=65536,f&=-f,o.lanes|=f,f=e1(f),t1(f,n,o,c),rm(o,f),!1}o=o.return}while(o!==null);return!1}var Nm=Error(i(461)),ys=!1;function Vs(n,r,o,c){r.child=n===null?iv(r,null,o,c):No(r,n.child,o,c)}function n1(n,r,o,c,f){o=o.render;var m=r.ref;if("ref"in c){var x={};for(var j in c)j!=="ref"&&(x[j]=c[j])}else x=c;return Eo(r),c=um(n,r,o,x,m,f),j=dm(),n!==null&&!ys?(hm(n,r,f),Qi(n,r,f)):(on&&j&&$f(r),r.flags|=1,Vs(n,r,c,f),r.child)}function s1(n,r,o,c,f){if(n===null){var m=o.type;return typeof m=="function"&&!Ff(m)&&m.defaultProps===void 0&&o.compare===null?(r.tag=15,r.type=m,r1(n,r,m,c,f)):(n=cd(o.type,null,c,r,r.mode,f),n.ref=r.ref,n.return=r,r.child=n)}if(m=n.child,!Om(n,f)){var x=m.memoizedProps;if(o=o.compare,o=o!==null?o:gc,o(x,c)&&n.ref===r.ref)return Qi(n,r,f)}return r.flags|=1,n=qi(m,c),n.ref=r.ref,n.return=r,r.child=n}function r1(n,r,o,c,f){if(n!==null){var m=n.memoizedProps;if(gc(m,c)&&n.ref===r.ref)if(ys=!1,r.pendingProps=c=m,Om(n,f))(n.flags&131072)!==0&&(ys=!0);else return r.lanes=n.lanes,Qi(n,r,f)}return Am(n,r,o,c,f)}function i1(n,r,o,c){var f=c.children,m=n!==null?n.memoizedState:null;if(n===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((r.flags&128)!==0){if(m=m!==null?m.baseLanes|o:o,n!==null){for(c=r.child=n.child,f=0;c!==null;)f=f|c.lanes|c.childLanes,c=c.sibling;c=f&~m}else c=0,r.child=null;return a1(n,r,m,o,c)}if((o&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},n!==null&&fd(r,m!==null?m.cachePool:null),m!==null?lv(r,m):am(),cv(r);else return c=r.lanes=536870912,a1(n,r,m!==null?m.baseLanes|o:o,o,c)}else m!==null?(fd(r,m.cachePool),lv(r,m),La(),r.memoizedState=null):(n!==null&&fd(r,null),am(),La());return Vs(n,r,f,o),r.child}function Ac(n,r){return n!==null&&n.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function a1(n,r,o,c,f){var m=em();return m=m===null?null:{parent:gs._currentValue,pool:m},r.memoizedState={baseLanes:o,cachePool:m},n!==null&&fd(r,null),am(),cv(r),n!==null&&ml(n,r,c,!0),r.childLanes=f,null}function Nd(n,r){return r=Rd({mode:r.mode,children:r.children},n.mode),r.ref=n.ref,n.child=r,r.return=n,r}function o1(n,r,o){return No(r,n.child,null,o),n=Nd(r,r.pendingProps),n.flags|=2,Rr(r),r.memoizedState=null,n}function NE(n,r,o){var c=r.pendingProps,f=(r.flags&128)!==0;if(r.flags&=-129,n===null){if(on){if(c.mode==="hidden")return n=Nd(r,c),r.lanes=536870912,Ac(null,n);if(lm(r),(n=Un)?(n=bb(n,$r),n=n!==null&&n.data==="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:Sa!==null?{id:Ti,overflow:Si}:null,retryLane:536870912,hydrationErrors:null},o=q0(n),o.return=r,r.child=o,Ps=r,Un=null)):n=null,n===null)throw Na(r);return r.lanes=536870912,null}return Nd(r,c)}var m=n.memoizedState;if(m!==null){var x=m.dehydrated;if(lm(r),f)if(r.flags&256)r.flags&=-257,r=o1(n,r,o);else if(r.memoizedState!==null)r.child=n.child,r.flags|=128,r=null;else throw Error(i(558));else if(ys||ml(n,r,o,!1),f=(o&n.childLanes)!==0,ys||f){if(c=Mn,c!==null&&(x=De(c,o),x!==0&&x!==m.retryLane))throw m.retryLane=x,xo(n,x),yr(c,n,x),Nm;Bd(),r=o1(n,r,o)}else n=m.treeContext,Un=Gr(x.nextSibling),Ps=r,on=!0,Ca=null,$r=!1,n!==null&&G0(r,n),r=Nd(r,c),r.flags|=4096;return r}return n=qi(n.child,{mode:c.mode,children:c.children}),n.ref=r.ref,r.child=n,n.return=r,n}function Ad(n,r){var o=r.ref;if(o===null)n!==null&&n.ref!==null&&(r.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(n===null||n.ref!==o)&&(r.flags|=4194816)}}function Am(n,r,o,c,f){return Eo(r),o=um(n,r,o,c,void 0,f),c=dm(),n!==null&&!ys?(hm(n,r,f),Qi(n,r,f)):(on&&c&&$f(r),r.flags|=1,Vs(n,r,o,f),r.child)}function l1(n,r,o,c,f,m){return Eo(r),r.updateQueue=null,o=dv(r,c,o,f),uv(n),c=dm(),n!==null&&!ys?(hm(n,r,m),Qi(n,r,m)):(on&&c&&$f(r),r.flags|=1,Vs(n,r,o,m),r.child)}function c1(n,r,o,c,f){if(Eo(r),r.stateNode===null){var m=ul,x=o.contextType;typeof x=="object"&&x!==null&&(m=Os(x)),m=new o(c,m),r.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=Sm,r.stateNode=m,m._reactInternals=r,m=r.stateNode,m.props=c,m.state=r.memoizedState,m.refs={},nm(r),x=o.contextType,m.context=typeof x=="object"&&x!==null?Os(x):ul,m.state=r.memoizedState,x=o.getDerivedStateFromProps,typeof x=="function"&&(Tm(r,o,x,c),m.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(x=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),x!==m.state&&Sm.enqueueReplaceState(m,m.state,null),Ec(r,c,m,f),jc(),m.state=r.memoizedState),typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(n===null){m=r.stateNode;var j=r.memoizedProps,z=Ro(o,j);m.props=z;var ie=m.context,we=o.contextType;x=ul,typeof we=="object"&&we!==null&&(x=Os(we));var Ee=o.getDerivedStateFromProps;we=typeof Ee=="function"||typeof m.getSnapshotBeforeUpdate=="function",j=r.pendingProps!==j,we||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(j||ie!==x)&&Yv(r,m,c,x),Ra=!1;var de=r.memoizedState;m.state=de,Ec(r,c,m,f),jc(),ie=r.memoizedState,j||de!==ie||Ra?(typeof Ee=="function"&&(Tm(r,o,Ee,c),ie=r.memoizedState),(z=Ra||Kv(r,o,z,c,de,ie,x))?(we||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(r.flags|=4194308)):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=ie),m.props=c,m.state=ie,m.context=x,c=z):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{m=r.stateNode,sm(n,r),x=r.memoizedProps,we=Ro(o,x),m.props=we,Ee=r.pendingProps,de=m.context,ie=o.contextType,z=ul,typeof ie=="object"&&ie!==null&&(z=Os(ie)),j=o.getDerivedStateFromProps,(ie=typeof j=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(x!==Ee||de!==z)&&Yv(r,m,c,z),Ra=!1,de=r.memoizedState,m.state=de,Ec(r,c,m,f),jc();var ge=r.memoizedState;x!==Ee||de!==ge||Ra||n!==null&&n.dependencies!==null&&dd(n.dependencies)?(typeof j=="function"&&(Tm(r,o,j,c),ge=r.memoizedState),(we=Ra||Kv(r,o,we,c,de,ge,z)||n!==null&&n.dependencies!==null&&dd(n.dependencies))?(ie||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(c,ge,z),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(c,ge,z)),typeof m.componentDidUpdate=="function"&&(r.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof m.componentDidUpdate!="function"||x===n.memoizedProps&&de===n.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||x===n.memoizedProps&&de===n.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=ge),m.props=c,m.state=ge,m.context=z,c=we):(typeof m.componentDidUpdate!="function"||x===n.memoizedProps&&de===n.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||x===n.memoizedProps&&de===n.memoizedState||(r.flags|=1024),c=!1)}return m=c,Ad(n,r),c=(r.flags&128)!==0,m||c?(m=r.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:m.render(),r.flags|=1,n!==null&&c?(r.child=No(r,n.child,null,f),r.child=No(r,null,o,f)):Vs(n,r,o,f),r.memoizedState=m.state,n=r.child):n=Qi(n,r,f),n}function u1(n,r,o,c){return ko(),r.flags|=256,Vs(n,r,o,c),r.child}var Rm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Im(n){return{baseLanes:n,cachePool:Z0()}}function Mm(n,r,o){return n=n!==null?n.childLanes&~o:0,r&&(n|=Mr),n}function d1(n,r,o){var c=r.pendingProps,f=!1,m=(r.flags&128)!==0,x;if((x=m)||(x=n!==null&&n.memoizedState===null?!1:(us.current&2)!==0),x&&(f=!0,r.flags&=-129),x=(r.flags&32)!==0,r.flags&=-33,n===null){if(on){if(f?Da(r):La(),(n=Un)?(n=bb(n,$r),n=n!==null&&n.data!=="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:Sa!==null?{id:Ti,overflow:Si}:null,retryLane:536870912,hydrationErrors:null},o=q0(n),o.return=r,r.child=o,Ps=r,Un=null)):n=null,n===null)throw Na(r);return gg(n)?r.lanes=32:r.lanes=536870912,null}var j=c.children;return c=c.fallback,f?(La(),f=r.mode,j=Rd({mode:"hidden",children:j},f),c=_o(c,f,o,null),j.return=r,c.return=r,j.sibling=c,r.child=j,c=r.child,c.memoizedState=Im(o),c.childLanes=Mm(n,x,o),r.memoizedState=Rm,Ac(null,c)):(Da(r),Dm(r,j))}var z=n.memoizedState;if(z!==null&&(j=z.dehydrated,j!==null)){if(m)r.flags&256?(Da(r),r.flags&=-257,r=Lm(n,r,o)):r.memoizedState!==null?(La(),r.child=n.child,r.flags|=128,r=null):(La(),j=c.fallback,f=r.mode,c=Rd({mode:"visible",children:c.children},f),j=_o(j,f,o,null),j.flags|=2,c.return=r,j.return=r,c.sibling=j,r.child=c,No(r,n.child,null,o),c=r.child,c.memoizedState=Im(o),c.childLanes=Mm(n,x,o),r.memoizedState=Rm,r=Ac(null,c));else if(Da(r),gg(j)){if(x=j.nextSibling&&j.nextSibling.dataset,x)var ie=x.dgst;x=ie,c=Error(i(419)),c.stack="",c.digest=x,vc({value:c,source:null,stack:null}),r=Lm(n,r,o)}else if(ys||ml(n,r,o,!1),x=(o&n.childLanes)!==0,ys||x){if(x=Mn,x!==null&&(c=De(x,o),c!==0&&c!==z.retryLane))throw z.retryLane=c,xo(n,c),yr(x,n,c),Nm;mg(j)||Bd(),r=Lm(n,r,o)}else mg(j)?(r.flags|=192,r.child=n.child,r=null):(n=z.treeContext,Un=Gr(j.nextSibling),Ps=r,on=!0,Ca=null,$r=!1,n!==null&&G0(r,n),r=Dm(r,c.children),r.flags|=4096);return r}return f?(La(),j=c.fallback,f=r.mode,z=n.child,ie=z.sibling,c=qi(z,{mode:"hidden",children:c.children}),c.subtreeFlags=z.subtreeFlags&65011712,ie!==null?j=qi(ie,j):(j=_o(j,f,o,null),j.flags|=2),j.return=r,c.return=r,c.sibling=j,r.child=c,Ac(null,c),c=r.child,j=n.child.memoizedState,j===null?j=Im(o):(f=j.cachePool,f!==null?(z=gs._currentValue,f=f.parent!==z?{parent:z,pool:z}:f):f=Z0(),j={baseLanes:j.baseLanes|o,cachePool:f}),c.memoizedState=j,c.childLanes=Mm(n,x,o),r.memoizedState=Rm,Ac(n.child,c)):(Da(r),o=n.child,n=o.sibling,o=qi(o,{mode:"visible",children:c.children}),o.return=r,o.sibling=null,n!==null&&(x=r.deletions,x===null?(r.deletions=[n],r.flags|=16):x.push(n)),r.child=o,r.memoizedState=null,o)}function Dm(n,r){return r=Rd({mode:"visible",children:r},n.mode),r.return=n,n.child=r}function Rd(n,r){return n=Nr(22,n,null,r),n.lanes=0,n}function Lm(n,r,o){return No(r,n.child,null,o),n=Dm(r,r.pendingProps.children),n.flags|=2,r.memoizedState=null,n}function h1(n,r,o){n.lanes|=r;var c=n.alternate;c!==null&&(c.lanes|=r),Qf(n.return,r,o)}function Pm(n,r,o,c,f,m){var x=n.memoizedState;x===null?n.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:f,treeForkCount:m}:(x.isBackwards=r,x.rendering=null,x.renderingStartTime=0,x.last=c,x.tail=o,x.tailMode=f,x.treeForkCount=m)}function f1(n,r,o){var c=r.pendingProps,f=c.revealOrder,m=c.tail;c=c.children;var x=us.current,j=(x&2)!==0;if(j?(x=x&1|2,r.flags|=128):x&=1,je(us,x),Vs(n,r,c,o),c=on?yc:0,!j&&n!==null&&(n.flags&128)!==0)e:for(n=r.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&h1(n,o,r);else if(n.tag===19)h1(n,o,r);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break e;for(;n.sibling===null;){if(n.return===null||n.return===r)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(f){case"forwards":for(o=r.child,f=null;o!==null;)n=o.alternate,n!==null&&bd(n)===null&&(f=o),o=o.sibling;o=f,o===null?(f=r.child,r.child=null):(f=o.sibling,o.sibling=null),Pm(r,!1,f,o,m,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,f=r.child,r.child=null;f!==null;){if(n=f.alternate,n!==null&&bd(n)===null){r.child=f;break}n=f.sibling,f.sibling=o,o=f,f=n}Pm(r,!0,o,null,m,c);break;case"together":Pm(r,!1,null,null,void 0,c);break;default:r.memoizedState=null}return r.child}function Qi(n,r,o){if(n!==null&&(r.dependencies=n.dependencies),Va|=r.lanes,(o&r.childLanes)===0)if(n!==null){if(ml(n,r,o,!1),(o&r.childLanes)===0)return null}else return null;if(n!==null&&r.child!==n.child)throw Error(i(153));if(r.child!==null){for(n=r.child,o=qi(n,n.pendingProps),r.child=o,o.return=r;n.sibling!==null;)n=n.sibling,o=o.sibling=qi(n,n.pendingProps),o.return=r;o.sibling=null}return r.child}function Om(n,r){return(n.lanes&r)!==0?!0:(n=n.dependencies,!!(n!==null&&dd(n)))}function AE(n,r,o){switch(r.tag){case 3:Qe(r,r.stateNode.containerInfo),Aa(r,gs,n.memoizedState.cache),ko();break;case 27:case 5:Wt(r);break;case 4:Qe(r,r.stateNode.containerInfo);break;case 10:Aa(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,lm(r),null;break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(Da(r),r.flags|=128,null):(o&r.child.childLanes)!==0?d1(n,r,o):(Da(r),n=Qi(n,r,o),n!==null?n.sibling:null);Da(r);break;case 19:var f=(n.flags&128)!==0;if(c=(o&r.childLanes)!==0,c||(ml(n,r,o,!1),c=(o&r.childLanes)!==0),f){if(c)return f1(n,r,o);r.flags|=128}if(f=r.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),je(us,us.current),c)break;return null;case 22:return r.lanes=0,i1(n,r,o,r.pendingProps);case 24:Aa(r,gs,n.memoizedState.cache)}return Qi(n,r,o)}function m1(n,r,o){if(n!==null)if(n.memoizedProps!==r.pendingProps)ys=!0;else{if(!Om(n,o)&&(r.flags&128)===0)return ys=!1,AE(n,r,o);ys=(n.flags&131072)!==0}else ys=!1,on&&(r.flags&1048576)!==0&&W0(r,yc,r.index);switch(r.lanes=0,r.tag){case 16:e:{var c=r.pendingProps;if(n=So(r.elementType),r.type=n,typeof n=="function")Ff(n)?(c=Ro(n,c),r.tag=1,r=c1(null,r,n,c,o)):(r.tag=0,r=Am(null,r,n,c,o));else{if(n!=null){var f=n.$$typeof;if(f===ye){r.tag=11,r=n1(null,r,n,c,o);break e}else if(f===D){r.tag=14,r=s1(null,r,n,c,o);break e}}throw r=Le(n)||n,Error(i(306,r,""))}}return r;case 0:return Am(n,r,r.type,r.pendingProps,o);case 1:return c=r.type,f=Ro(c,r.pendingProps),c1(n,r,c,f,o);case 3:e:{if(Qe(r,r.stateNode.containerInfo),n===null)throw Error(i(387));c=r.pendingProps;var m=r.memoizedState;f=m.element,sm(n,r),Ec(r,c,null,o);var x=r.memoizedState;if(c=x.cache,Aa(r,gs,c),c!==m.cache&&Xf(r,[gs],o,!0),jc(),c=x.element,m.isDehydrated)if(m={element:c,isDehydrated:!1,cache:x.cache},r.updateQueue.baseState=m,r.memoizedState=m,r.flags&256){r=u1(n,r,c,o);break e}else if(c!==f){f=Fr(Error(i(424)),r),vc(f),r=u1(n,r,c,o);break e}else for(n=r.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,Un=Gr(n.firstChild),Ps=r,on=!0,Ca=null,$r=!0,o=iv(r,null,c,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(ko(),c===f){r=Qi(n,r,o);break e}Vs(n,r,c,o)}r=r.child}return r;case 26:return Ad(n,r),n===null?(o=Eb(r.type,null,r.pendingProps,null))?r.memoizedState=o:on||(o=r.type,n=r.pendingProps,c=Gd(Ue.current).createElement(o),c[At]=r,c[St]=n,Us(c,o,n),wn(c),r.stateNode=c):r.memoizedState=Eb(r.type,n.memoizedProps,r.pendingProps,n.memoizedState),null;case 27:return Wt(r),n===null&&on&&(c=r.stateNode=_b(r.type,r.pendingProps,Ue.current),Ps=r,$r=!0,f=Un,Ha(r.type)?(pg=f,Un=Gr(c.firstChild)):Un=f),Vs(n,r,r.pendingProps.children,o),Ad(n,r),n===null&&(r.flags|=4194304),r.child;case 5:return n===null&&on&&((f=c=Un)&&(c=aT(c,r.type,r.pendingProps,$r),c!==null?(r.stateNode=c,Ps=r,Un=Gr(c.firstChild),$r=!1,f=!0):f=!1),f||Na(r)),Wt(r),f=r.type,m=r.pendingProps,x=n!==null?n.memoizedProps:null,c=m.children,dg(f,m)?c=null:x!==null&&dg(f,x)&&(r.flags|=32),r.memoizedState!==null&&(f=um(n,r,xE,null,null,o),$c._currentValue=f),Ad(n,r),Vs(n,r,c,o),r.child;case 6:return n===null&&on&&((n=o=Un)&&(o=oT(o,r.pendingProps,$r),o!==null?(r.stateNode=o,Ps=r,Un=null,n=!0):n=!1),n||Na(r)),null;case 13:return d1(n,r,o);case 4:return Qe(r,r.stateNode.containerInfo),c=r.pendingProps,n===null?r.child=No(r,null,c,o):Vs(n,r,c,o),r.child;case 11:return n1(n,r,r.type,r.pendingProps,o);case 7:return Vs(n,r,r.pendingProps,o),r.child;case 8:return Vs(n,r,r.pendingProps.children,o),r.child;case 12:return Vs(n,r,r.pendingProps.children,o),r.child;case 10:return c=r.pendingProps,Aa(r,r.type,c.value),Vs(n,r,c.children,o),r.child;case 9:return f=r.type._context,c=r.pendingProps.children,Eo(r),f=Os(f),c=c(f),r.flags|=1,Vs(n,r,c,o),r.child;case 14:return s1(n,r,r.type,r.pendingProps,o);case 15:return r1(n,r,r.type,r.pendingProps,o);case 19:return f1(n,r,o);case 31:return NE(n,r,o);case 22:return i1(n,r,o,r.pendingProps);case 24:return Eo(r),c=Os(gs),n===null?(f=em(),f===null&&(f=Mn,m=Jf(),f.pooledCache=m,m.refCount++,m!==null&&(f.pooledCacheLanes|=o),f=m),r.memoizedState={parent:c,cache:f},nm(r),Aa(r,gs,f)):((n.lanes&o)!==0&&(sm(n,r),Ec(r,null,null,o),jc()),f=n.memoizedState,m=r.memoizedState,f.parent!==c?(f={parent:c,cache:c},r.memoizedState=f,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=f),Aa(r,gs,c)):(c=m.cache,Aa(r,gs,c),c!==f.cache&&Xf(r,[gs],o,!0))),Vs(n,r,r.pendingProps.children,o),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function Xi(n){n.flags|=4}function Vm(n,r,o,c,f){if((r=(n.mode&32)!==0)&&(r=!1),r){if(n.flags|=16777216,(f&335544128)===f)if(n.stateNode.complete)n.flags|=8192;else if(z1())n.flags|=8192;else throw Co=gd,tm}else n.flags&=-16777217}function g1(n,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!Ab(r))if(z1())n.flags|=8192;else throw Co=gd,tm}function Id(n,r){r!==null&&(n.flags|=4),n.flags&16384&&(r=n.tag!==22?lt():536870912,n.lanes|=r,Tl|=r)}function Rc(n,r){if(!on)switch(n.tailMode){case"hidden":r=n.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?r||n.tail===null?n.tail=null:n.tail.sibling=null:c.sibling=null}}function Bn(n){var r=n.alternate!==null&&n.alternate.child===n.child,o=0,c=0;if(r)for(var f=n.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags&65011712,c|=f.flags&65011712,f.return=n,f=f.sibling;else for(f=n.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=n,f=f.sibling;return n.subtreeFlags|=c,n.childLanes=o,r}function RE(n,r,o){var c=r.pendingProps;switch(Wf(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bn(r),null;case 1:return Bn(r),null;case 3:return o=r.stateNode,c=null,n!==null&&(c=n.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),Gi(gs),Je(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(fl(r)?Xi(r):n===null||n.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Kf())),Bn(r),null;case 26:var f=r.type,m=r.memoizedState;return n===null?(Xi(r),m!==null?(Bn(r),g1(r,m)):(Bn(r),Vm(r,f,null,c,o))):m?m!==n.memoizedState?(Xi(r),Bn(r),g1(r,m)):(Bn(r),r.flags&=-16777217):(n=n.memoizedProps,n!==c&&Xi(r),Bn(r),Vm(r,f,n,c,o)),null;case 27:if(It(r),o=Ue.current,f=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==c&&Xi(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Bn(r),null}n=Ce.current,fl(r)?K0(r):(n=_b(f,c,o),r.stateNode=n,Xi(r))}return Bn(r),null;case 5:if(It(r),f=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==c&&Xi(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Bn(r),null}if(m=Ce.current,fl(r))K0(r);else{var x=Gd(Ue.current);switch(m){case 1:m=x.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:m=x.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":m=x.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":m=x.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":m=x.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof c.is=="string"?x.createElement("select",{is:c.is}):x.createElement("select"),c.multiple?m.multiple=!0:c.size&&(m.size=c.size);break;default:m=typeof c.is=="string"?x.createElement(f,{is:c.is}):x.createElement(f)}}m[At]=r,m[St]=c;e:for(x=r.child;x!==null;){if(x.tag===5||x.tag===6)m.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===r)break e;for(;x.sibling===null;){if(x.return===null||x.return===r)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}r.stateNode=m;e:switch(Us(m,f,c),f){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&Xi(r)}}return Bn(r),Vm(r,r.type,n===null?null:n.memoizedProps,r.pendingProps,o),null;case 6:if(n&&r.stateNode!=null)n.memoizedProps!==c&&Xi(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(i(166));if(n=Ue.current,fl(r)){if(n=r.stateNode,o=r.memoizedProps,c=null,f=Ps,f!==null)switch(f.tag){case 27:case 5:c=f.memoizedProps}n[At]=r,n=!!(n.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||db(n.nodeValue,o)),n||Na(r,!0)}else n=Gd(n).createTextNode(c),n[At]=r,r.stateNode=n}return Bn(r),null;case 31:if(o=r.memoizedState,n===null||n.memoizedState!==null){if(c=fl(r),o!==null){if(n===null){if(!c)throw Error(i(318));if(n=r.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(557));n[At]=r}else ko(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Bn(r),n=!1}else o=Kf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=o),n=!0;if(!n)return r.flags&256?(Rr(r),r):(Rr(r),null);if((r.flags&128)!==0)throw Error(i(558))}return Bn(r),null;case 13:if(c=r.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(f=fl(r),c!==null&&c.dehydrated!==null){if(n===null){if(!f)throw Error(i(318));if(f=r.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));f[At]=r}else ko(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Bn(r),f=!1}else f=Kf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=f),f=!0;if(!f)return r.flags&256?(Rr(r),r):(Rr(r),null)}return Rr(r),(r.flags&128)!==0?(r.lanes=o,r):(o=c!==null,n=n!==null&&n.memoizedState!==null,o&&(c=r.child,f=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(f=c.alternate.memoizedState.cachePool.pool),m=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(m=c.memoizedState.cachePool.pool),m!==f&&(c.flags|=2048)),o!==n&&o&&(r.child.flags|=8192),Id(r,r.updateQueue),Bn(r),null);case 4:return Je(),n===null&&ag(r.stateNode.containerInfo),Bn(r),null;case 10:return Gi(r.type),Bn(r),null;case 19:if(ce(us),c=r.memoizedState,c===null)return Bn(r),null;if(f=(r.flags&128)!==0,m=c.rendering,m===null)if(f)Rc(c,!1);else{if(ss!==0||n!==null&&(n.flags&128)!==0)for(n=r.child;n!==null;){if(m=bd(n),m!==null){for(r.flags|=128,Rc(c,!1),n=m.updateQueue,r.updateQueue=n,Id(r,n),r.subtreeFlags=0,n=o,o=r.child;o!==null;)H0(o,n),o=o.sibling;return je(us,us.current&1|2),on&&$i(r,c.treeForkCount),r.child}n=n.sibling}c.tail!==null&&gt()>Od&&(r.flags|=128,f=!0,Rc(c,!1),r.lanes=4194304)}else{if(!f)if(n=bd(m),n!==null){if(r.flags|=128,f=!0,n=n.updateQueue,r.updateQueue=n,Id(r,n),Rc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!m.alternate&&!on)return Bn(r),null}else 2*gt()-c.renderingStartTime>Od&&o!==536870912&&(r.flags|=128,f=!0,Rc(c,!1),r.lanes=4194304);c.isBackwards?(m.sibling=r.child,r.child=m):(n=c.last,n!==null?n.sibling=m:r.child=m,c.last=m)}return c.tail!==null?(n=c.tail,c.rendering=n,c.tail=n.sibling,c.renderingStartTime=gt(),n.sibling=null,o=us.current,je(us,f?o&1|2:o&1),on&&$i(r,c.treeForkCount),n):(Bn(r),null);case 22:case 23:return Rr(r),om(),c=r.memoizedState!==null,n!==null?n.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(o&536870912)!==0&&(r.flags&128)===0&&(Bn(r),r.subtreeFlags&6&&(r.flags|=8192)):Bn(r),o=r.updateQueue,o!==null&&Id(r,o.retryQueue),o=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==o&&(r.flags|=2048),n!==null&&ce(To),null;case 24:return o=null,n!==null&&(o=n.memoizedState.cache),r.memoizedState.cache!==o&&(r.flags|=2048),Gi(gs),Bn(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function IE(n,r){switch(Wf(r),r.tag){case 1:return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 3:return Gi(gs),Je(),n=r.flags,(n&65536)!==0&&(n&128)===0?(r.flags=n&-65537|128,r):null;case 26:case 27:case 5:return It(r),null;case 31:if(r.memoizedState!==null){if(Rr(r),r.alternate===null)throw Error(i(340));ko()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 13:if(Rr(r),n=r.memoizedState,n!==null&&n.dehydrated!==null){if(r.alternate===null)throw Error(i(340));ko()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 19:return ce(us),null;case 4:return Je(),null;case 10:return Gi(r.type),null;case 22:case 23:return Rr(r),om(),n!==null&&ce(To),n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 24:return Gi(gs),null;case 25:return null;default:return null}}function p1(n,r){switch(Wf(r),r.tag){case 3:Gi(gs),Je();break;case 26:case 27:case 5:It(r);break;case 4:Je();break;case 31:r.memoizedState!==null&&Rr(r);break;case 13:Rr(r);break;case 19:ce(us);break;case 10:Gi(r.type);break;case 22:case 23:Rr(r),om(),n!==null&&ce(To);break;case 24:Gi(gs)}}function Ic(n,r){try{var o=r.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var f=c.next;o=f;do{if((o.tag&n)===n){c=void 0;var m=o.create,x=o.inst;c=m(),x.destroy=c}o=o.next}while(o!==f)}}catch(j){Tn(r,r.return,j)}}function Pa(n,r,o){try{var c=r.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var m=f.next;c=m;do{if((c.tag&n)===n){var x=c.inst,j=x.destroy;if(j!==void 0){x.destroy=void 0,f=r;var z=o,ie=j;try{ie()}catch(we){Tn(f,z,we)}}}c=c.next}while(c!==m)}}catch(we){Tn(r,r.return,we)}}function y1(n){var r=n.updateQueue;if(r!==null){var o=n.stateNode;try{ov(r,o)}catch(c){Tn(n,n.return,c)}}}function v1(n,r,o){o.props=Ro(n.type,n.memoizedProps),o.state=n.memoizedState;try{o.componentWillUnmount()}catch(c){Tn(n,r,c)}}function Mc(n,r){try{var o=n.ref;if(o!==null){switch(n.tag){case 26:case 27:case 5:var c=n.stateNode;break;case 30:c=n.stateNode;break;default:c=n.stateNode}typeof o=="function"?n.refCleanup=o(c):o.current=c}}catch(f){Tn(n,r,f)}}function Ci(n,r){var o=n.ref,c=n.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(f){Tn(n,r,f)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(f){Tn(n,r,f)}else o.current=null}function b1(n){var r=n.type,o=n.memoizedProps,c=n.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(f){Tn(n,n.return,f)}}function Um(n,r,o){try{var c=n.stateNode;eT(c,n.type,o,r),c[St]=r}catch(f){Tn(n,n.return,f)}}function w1(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Ha(n.type)||n.tag===4}function Bm(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||w1(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Ha(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function zm(n,r,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(n,r):(r=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,r.appendChild(n),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=$s));else if(c!==4&&(c===27&&Ha(n.type)&&(o=n.stateNode,r=null),n=n.child,n!==null))for(zm(n,r,o),n=n.sibling;n!==null;)zm(n,r,o),n=n.sibling}function Md(n,r,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?o.insertBefore(n,r):o.appendChild(n);else if(c!==4&&(c===27&&Ha(n.type)&&(o=n.stateNode),n=n.child,n!==null))for(Md(n,r,o),n=n.sibling;n!==null;)Md(n,r,o),n=n.sibling}function x1(n){var r=n.stateNode,o=n.memoizedProps;try{for(var c=n.type,f=r.attributes;f.length;)r.removeAttributeNode(f[0]);Us(r,c,o),r[At]=n,r[St]=o}catch(m){Tn(n,n.return,m)}}var Ji=!1,vs=!1,Fm=!1,_1=typeof WeakSet=="function"?WeakSet:Set,Rs=null;function ME(n,r){if(n=n.containerInfo,cg=eh,n=D0(n),Lf(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else e:{o=(o=n.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var f=c.anchorOffset,m=c.focusNode;c=c.focusOffset;try{o.nodeType,m.nodeType}catch{o=null;break e}var x=0,j=-1,z=-1,ie=0,we=0,Ee=n,de=null;t:for(;;){for(var ge;Ee!==o||f!==0&&Ee.nodeType!==3||(j=x+f),Ee!==m||c!==0&&Ee.nodeType!==3||(z=x+c),Ee.nodeType===3&&(x+=Ee.nodeValue.length),(ge=Ee.firstChild)!==null;)de=Ee,Ee=ge;for(;;){if(Ee===n)break t;if(de===o&&++ie===f&&(j=x),de===m&&++we===c&&(z=x),(ge=Ee.nextSibling)!==null)break;Ee=de,de=Ee.parentNode}Ee=ge}o=j===-1||z===-1?null:{start:j,end:z}}else o=null}o=o||{start:0,end:0}}else o=null;for(ug={focusedElem:n,selectionRange:o},eh=!1,Rs=r;Rs!==null;)if(r=Rs,n=r.child,(r.subtreeFlags&1028)!==0&&n!==null)n.return=r,Rs=n;else for(;Rs!==null;){switch(r=Rs,m=r.alternate,n=r.flags,r.tag){case 0:if((n&4)!==0&&(n=r.updateQueue,n=n!==null?n.events:null,n!==null))for(o=0;o<n.length;o++)f=n[o],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&m!==null){n=void 0,o=r,f=m.memoizedProps,m=m.memoizedState,c=o.stateNode;try{var et=Ro(o.type,f);n=c.getSnapshotBeforeUpdate(et,m),c.__reactInternalSnapshotBeforeUpdate=n}catch(wt){Tn(o,o.return,wt)}}break;case 3:if((n&1024)!==0){if(n=r.stateNode.containerInfo,o=n.nodeType,o===9)fg(n);else if(o===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":fg(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(i(163))}if(n=r.sibling,n!==null){n.return=r.return,Rs=n;break}Rs=r.return}}function k1(n,r,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:ea(n,o),c&4&&Ic(5,o);break;case 1:if(ea(n,o),c&4)if(n=o.stateNode,r===null)try{n.componentDidMount()}catch(x){Tn(o,o.return,x)}else{var f=Ro(o.type,r.memoizedProps);r=r.memoizedState;try{n.componentDidUpdate(f,r,n.__reactInternalSnapshotBeforeUpdate)}catch(x){Tn(o,o.return,x)}}c&64&&y1(o),c&512&&Mc(o,o.return);break;case 3:if(ea(n,o),c&64&&(n=o.updateQueue,n!==null)){if(r=null,o.child!==null)switch(o.child.tag){case 27:case 5:r=o.child.stateNode;break;case 1:r=o.child.stateNode}try{ov(n,r)}catch(x){Tn(o,o.return,x)}}break;case 27:r===null&&c&4&&x1(o);case 26:case 5:ea(n,o),r===null&&c&4&&b1(o),c&512&&Mc(o,o.return);break;case 12:ea(n,o);break;case 31:ea(n,o),c&4&&T1(n,o);break;case 13:ea(n,o),c&4&&S1(n,o),c&64&&(n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(o=FE.bind(null,o),lT(n,o))));break;case 22:if(c=o.memoizedState!==null||Ji,!c){r=r!==null&&r.memoizedState!==null||vs,f=Ji;var m=vs;Ji=c,(vs=r)&&!m?ta(n,o,(o.subtreeFlags&8772)!==0):ea(n,o),Ji=f,vs=m}break;case 30:break;default:ea(n,o)}}function j1(n){var r=n.alternate;r!==null&&(n.alternate=null,j1(r)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(r=n.stateNode,r!==null&&hr(r)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var $n=null,fr=!1;function Zi(n,r,o){for(o=o.child;o!==null;)E1(n,r,o),o=o.sibling}function E1(n,r,o){if(Gt&&typeof Gt.onCommitFiberUnmount=="function")try{Gt.onCommitFiberUnmount(un,o)}catch{}switch(o.tag){case 26:vs||Ci(o,r),Zi(n,r,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:vs||Ci(o,r);var c=$n,f=fr;Ha(o.type)&&($n=o.stateNode,fr=!1),Zi(n,r,o),Fc(o.stateNode),$n=c,fr=f;break;case 5:vs||Ci(o,r);case 6:if(c=$n,f=fr,$n=null,Zi(n,r,o),$n=c,fr=f,$n!==null)if(fr)try{($n.nodeType===9?$n.body:$n.nodeName==="HTML"?$n.ownerDocument.body:$n).removeChild(o.stateNode)}catch(m){Tn(o,r,m)}else try{$n.removeChild(o.stateNode)}catch(m){Tn(o,r,m)}break;case 18:$n!==null&&(fr?(n=$n,yb(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,o.stateNode),Dl(n)):yb($n,o.stateNode));break;case 4:c=$n,f=fr,$n=o.stateNode.containerInfo,fr=!0,Zi(n,r,o),$n=c,fr=f;break;case 0:case 11:case 14:case 15:Pa(2,o,r),vs||Pa(4,o,r),Zi(n,r,o);break;case 1:vs||(Ci(o,r),c=o.stateNode,typeof c.componentWillUnmount=="function"&&v1(o,r,c)),Zi(n,r,o);break;case 21:Zi(n,r,o);break;case 22:vs=(c=vs)||o.memoizedState!==null,Zi(n,r,o),vs=c;break;default:Zi(n,r,o)}}function T1(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{Dl(n)}catch(o){Tn(r,r.return,o)}}}function S1(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Dl(n)}catch(o){Tn(r,r.return,o)}}function DE(n){switch(n.tag){case 31:case 13:case 19:var r=n.stateNode;return r===null&&(r=n.stateNode=new _1),r;case 22:return n=n.stateNode,r=n._retryCache,r===null&&(r=n._retryCache=new _1),r;default:throw Error(i(435,n.tag))}}function Dd(n,r){var o=DE(n);r.forEach(function(c){if(!o.has(c)){o.add(c);var f=HE.bind(null,n,c);c.then(f,f)}})}function mr(n,r){var o=r.deletions;if(o!==null)for(var c=0;c<o.length;c++){var f=o[c],m=n,x=r,j=x;e:for(;j!==null;){switch(j.tag){case 27:if(Ha(j.type)){$n=j.stateNode,fr=!1;break e}break;case 5:$n=j.stateNode,fr=!1;break e;case 3:case 4:$n=j.stateNode.containerInfo,fr=!0;break e}j=j.return}if($n===null)throw Error(i(160));E1(m,x,f),$n=null,fr=!1,m=f.alternate,m!==null&&(m.return=null),f.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)C1(r,n),r=r.sibling}var ui=null;function C1(n,r){var o=n.alternate,c=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:mr(r,n),gr(n),c&4&&(Pa(3,n,n.return),Ic(3,n),Pa(5,n,n.return));break;case 1:mr(r,n),gr(n),c&512&&(vs||o===null||Ci(o,o.return)),c&64&&Ji&&(n=n.updateQueue,n!==null&&(c=n.callbacks,c!==null&&(o=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var f=ui;if(mr(r,n),gr(n),c&512&&(vs||o===null||Ci(o,o.return)),c&4){var m=o!==null?o.memoizedState:null;if(c=n.memoizedState,o===null)if(c===null)if(n.stateNode===null){e:{c=n.type,o=n.memoizedProps,f=f.ownerDocument||f;t:switch(c){case"title":m=f.getElementsByTagName("title")[0],(!m||m[js]||m[At]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=f.createElement(c),f.head.insertBefore(m,f.querySelector("head > title"))),Us(m,c,o),m[At]=n,wn(m),c=m;break e;case"link":var x=Cb("link","href",f).get(c+(o.href||""));if(x){for(var j=0;j<x.length;j++)if(m=x[j],m.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&m.getAttribute("rel")===(o.rel==null?null:o.rel)&&m.getAttribute("title")===(o.title==null?null:o.title)&&m.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){x.splice(j,1);break t}}m=f.createElement(c),Us(m,c,o),f.head.appendChild(m);break;case"meta":if(x=Cb("meta","content",f).get(c+(o.content||""))){for(j=0;j<x.length;j++)if(m=x[j],m.getAttribute("content")===(o.content==null?null:""+o.content)&&m.getAttribute("name")===(o.name==null?null:o.name)&&m.getAttribute("property")===(o.property==null?null:o.property)&&m.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&m.getAttribute("charset")===(o.charSet==null?null:o.charSet)){x.splice(j,1);break t}}m=f.createElement(c),Us(m,c,o),f.head.appendChild(m);break;default:throw Error(i(468,c))}m[At]=n,wn(m),c=m}n.stateNode=c}else Nb(f,n.type,n.stateNode);else n.stateNode=Sb(f,c,n.memoizedProps);else m!==c?(m===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):m.count--,c===null?Nb(f,n.type,n.stateNode):Sb(f,c,n.memoizedProps)):c===null&&n.stateNode!==null&&Um(n,n.memoizedProps,o.memoizedProps)}break;case 27:mr(r,n),gr(n),c&512&&(vs||o===null||Ci(o,o.return)),o!==null&&c&4&&Um(n,n.memoizedProps,o.memoizedProps);break;case 5:if(mr(r,n),gr(n),c&512&&(vs||o===null||Ci(o,o.return)),n.flags&32){f=n.stateNode;try{Ns(f,"")}catch(et){Tn(n,n.return,et)}}c&4&&n.stateNode!=null&&(f=n.memoizedProps,Um(n,f,o!==null?o.memoizedProps:f)),c&1024&&(Fm=!0);break;case 6:if(mr(r,n),gr(n),c&4){if(n.stateNode===null)throw Error(i(162));c=n.memoizedProps,o=n.stateNode;try{o.nodeValue=c}catch(et){Tn(n,n.return,et)}}break;case 3:if(Qd=null,f=ui,ui=Kd(r.containerInfo),mr(r,n),ui=f,gr(n),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Dl(r.containerInfo)}catch(et){Tn(n,n.return,et)}Fm&&(Fm=!1,N1(n));break;case 4:c=ui,ui=Kd(n.stateNode.containerInfo),mr(r,n),gr(n),ui=c;break;case 12:mr(r,n),gr(n);break;case 31:mr(r,n),gr(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Dd(n,c)));break;case 13:mr(r,n),gr(n),n.child.flags&8192&&n.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Pd=gt()),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Dd(n,c)));break;case 22:f=n.memoizedState!==null;var z=o!==null&&o.memoizedState!==null,ie=Ji,we=vs;if(Ji=ie||f,vs=we||z,mr(r,n),vs=we,Ji=ie,gr(n),c&8192)e:for(r=n.stateNode,r._visibility=f?r._visibility&-2:r._visibility|1,f&&(o===null||z||Ji||vs||Io(n)),o=null,r=n;;){if(r.tag===5||r.tag===26){if(o===null){z=o=r;try{if(m=z.stateNode,f)x=m.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none";else{j=z.stateNode;var Ee=z.memoizedProps.style,de=Ee!=null&&Ee.hasOwnProperty("display")?Ee.display:null;j.style.display=de==null||typeof de=="boolean"?"":(""+de).trim()}}catch(et){Tn(z,z.return,et)}}}else if(r.tag===6){if(o===null){z=r;try{z.stateNode.nodeValue=f?"":z.memoizedProps}catch(et){Tn(z,z.return,et)}}}else if(r.tag===18){if(o===null){z=r;try{var ge=z.stateNode;f?vb(ge,!0):vb(z.stateNode,!1)}catch(et){Tn(z,z.return,et)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===n)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break e;for(;r.sibling===null;){if(r.return===null||r.return===n)break e;o===r&&(o=null),r=r.return}o===r&&(o=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=n.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,Dd(n,o))));break;case 19:mr(r,n),gr(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Dd(n,c)));break;case 30:break;case 21:break;default:mr(r,n),gr(n)}}function gr(n){var r=n.flags;if(r&2){try{for(var o,c=n.return;c!==null;){if(w1(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var f=o.stateNode,m=Bm(n);Md(n,m,f);break;case 5:var x=o.stateNode;o.flags&32&&(Ns(x,""),o.flags&=-33);var j=Bm(n);Md(n,j,x);break;case 3:case 4:var z=o.stateNode.containerInfo,ie=Bm(n);zm(n,ie,z);break;default:throw Error(i(161))}}catch(we){Tn(n,n.return,we)}n.flags&=-3}r&4096&&(n.flags&=-4097)}function N1(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var r=n;N1(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),n=n.sibling}}function ea(n,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)k1(n,r.alternate,r),r=r.sibling}function Io(n){for(n=n.child;n!==null;){var r=n;switch(r.tag){case 0:case 11:case 14:case 15:Pa(4,r,r.return),Io(r);break;case 1:Ci(r,r.return);var o=r.stateNode;typeof o.componentWillUnmount=="function"&&v1(r,r.return,o),Io(r);break;case 27:Fc(r.stateNode);case 26:case 5:Ci(r,r.return),Io(r);break;case 22:r.memoizedState===null&&Io(r);break;case 30:Io(r);break;default:Io(r)}n=n.sibling}}function ta(n,r,o){for(o=o&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,f=n,m=r,x=m.flags;switch(m.tag){case 0:case 11:case 15:ta(f,m,o),Ic(4,m);break;case 1:if(ta(f,m,o),c=m,f=c.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(ie){Tn(c,c.return,ie)}if(c=m,f=c.updateQueue,f!==null){var j=c.stateNode;try{var z=f.shared.hiddenCallbacks;if(z!==null)for(f.shared.hiddenCallbacks=null,f=0;f<z.length;f++)av(z[f],j)}catch(ie){Tn(c,c.return,ie)}}o&&x&64&&y1(m),Mc(m,m.return);break;case 27:x1(m);case 26:case 5:ta(f,m,o),o&&c===null&&x&4&&b1(m),Mc(m,m.return);break;case 12:ta(f,m,o);break;case 31:ta(f,m,o),o&&x&4&&T1(f,m);break;case 13:ta(f,m,o),o&&x&4&&S1(f,m);break;case 22:m.memoizedState===null&&ta(f,m,o),Mc(m,m.return);break;case 30:break;default:ta(f,m,o)}r=r.sibling}}function Hm(n,r){var o=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),n=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(n=r.memoizedState.cachePool.pool),n!==o&&(n!=null&&n.refCount++,o!=null&&bc(o))}function qm(n,r){n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&bc(n))}function di(n,r,o,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)A1(n,r,o,c),r=r.sibling}function A1(n,r,o,c){var f=r.flags;switch(r.tag){case 0:case 11:case 15:di(n,r,o,c),f&2048&&Ic(9,r);break;case 1:di(n,r,o,c);break;case 3:di(n,r,o,c),f&2048&&(n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&bc(n)));break;case 12:if(f&2048){di(n,r,o,c),n=r.stateNode;try{var m=r.memoizedProps,x=m.id,j=m.onPostCommit;typeof j=="function"&&j(x,r.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(z){Tn(r,r.return,z)}}else di(n,r,o,c);break;case 31:di(n,r,o,c);break;case 13:di(n,r,o,c);break;case 23:break;case 22:m=r.stateNode,x=r.alternate,r.memoizedState!==null?m._visibility&2?di(n,r,o,c):Dc(n,r):m._visibility&2?di(n,r,o,c):(m._visibility|=2,kl(n,r,o,c,(r.subtreeFlags&10256)!==0||!1)),f&2048&&Hm(x,r);break;case 24:di(n,r,o,c),f&2048&&qm(r.alternate,r);break;default:di(n,r,o,c)}}function kl(n,r,o,c,f){for(f=f&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var m=n,x=r,j=o,z=c,ie=x.flags;switch(x.tag){case 0:case 11:case 15:kl(m,x,j,z,f),Ic(8,x);break;case 23:break;case 22:var we=x.stateNode;x.memoizedState!==null?we._visibility&2?kl(m,x,j,z,f):Dc(m,x):(we._visibility|=2,kl(m,x,j,z,f)),f&&ie&2048&&Hm(x.alternate,x);break;case 24:kl(m,x,j,z,f),f&&ie&2048&&qm(x.alternate,x);break;default:kl(m,x,j,z,f)}r=r.sibling}}function Dc(n,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var o=n,c=r,f=c.flags;switch(c.tag){case 22:Dc(o,c),f&2048&&Hm(c.alternate,c);break;case 24:Dc(o,c),f&2048&&qm(c.alternate,c);break;default:Dc(o,c)}r=r.sibling}}var Lc=8192;function jl(n,r,o){if(n.subtreeFlags&Lc)for(n=n.child;n!==null;)R1(n,r,o),n=n.sibling}function R1(n,r,o){switch(n.tag){case 26:jl(n,r,o),n.flags&Lc&&n.memoizedState!==null&&wT(o,ui,n.memoizedState,n.memoizedProps);break;case 5:jl(n,r,o);break;case 3:case 4:var c=ui;ui=Kd(n.stateNode.containerInfo),jl(n,r,o),ui=c;break;case 22:n.memoizedState===null&&(c=n.alternate,c!==null&&c.memoizedState!==null?(c=Lc,Lc=16777216,jl(n,r,o),Lc=c):jl(n,r,o));break;default:jl(n,r,o)}}function I1(n){var r=n.alternate;if(r!==null&&(n=r.child,n!==null)){r.child=null;do r=n.sibling,n.sibling=null,n=r;while(n!==null)}}function Pc(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];Rs=c,D1(c,n)}I1(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)M1(n),n=n.sibling}function M1(n){switch(n.tag){case 0:case 11:case 15:Pc(n),n.flags&2048&&Pa(9,n,n.return);break;case 3:Pc(n);break;case 12:Pc(n);break;case 22:var r=n.stateNode;n.memoizedState!==null&&r._visibility&2&&(n.return===null||n.return.tag!==13)?(r._visibility&=-3,Ld(n)):Pc(n);break;default:Pc(n)}}function Ld(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];Rs=c,D1(c,n)}I1(n)}for(n=n.child;n!==null;){switch(r=n,r.tag){case 0:case 11:case 15:Pa(8,r,r.return),Ld(r);break;case 22:o=r.stateNode,o._visibility&2&&(o._visibility&=-3,Ld(r));break;default:Ld(r)}n=n.sibling}}function D1(n,r){for(;Rs!==null;){var o=Rs;switch(o.tag){case 0:case 11:case 15:Pa(8,o,r);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:bc(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,Rs=c;else e:for(o=n;Rs!==null;){c=Rs;var f=c.sibling,m=c.return;if(j1(c),c===o){Rs=null;break e}if(f!==null){f.return=m,Rs=f;break e}Rs=m}}}var LE={getCacheForType:function(n){var r=Os(gs),o=r.data.get(n);return o===void 0&&(o=n(),r.data.set(n,o)),o},cacheSignal:function(){return Os(gs).controller.signal}},PE=typeof WeakMap=="function"?WeakMap:Map,_n=0,Mn=null,Yt=null,Jt=0,En=0,Ir=null,Oa=!1,El=!1,$m=!1,na=0,ss=0,Va=0,Mo=0,Wm=0,Mr=0,Tl=0,Oc=null,pr=null,Gm=!1,Pd=0,L1=0,Od=1/0,Vd=null,Ua=null,Es=0,Ba=null,Sl=null,sa=0,Km=0,Ym=null,P1=null,Vc=0,Qm=null;function Dr(){return(_n&2)!==0&&Jt!==0?Jt&-Jt:J.T!==null?ng():rt()}function O1(){if(Mr===0)if((Jt&536870912)===0||on){var n=Ie;Ie<<=1,(Ie&3932160)===0&&(Ie=262144),Mr=n}else Mr=536870912;return n=Ar.current,n!==null&&(n.flags|=32),Mr}function yr(n,r,o){(n===Mn&&(En===2||En===9)||n.cancelPendingCommit!==null)&&(Cl(n,0),za(n,Jt,Mr,!1)),hn(n,o),((_n&2)===0||n!==Mn)&&(n===Mn&&((_n&2)===0&&(Mo|=o),ss===4&&za(n,Jt,Mr,!1)),Ni(n))}function V1(n,r,o){if((_n&6)!==0)throw Error(i(327));var c=!o&&(r&127)===0&&(r&n.expiredLanes)===0||Nt(n,r),f=c?UE(n,r):Jm(n,r,!0),m=c;do{if(f===0){El&&!c&&za(n,r,0,!1);break}else{if(o=n.current.alternate,m&&!OE(o)){f=Jm(n,r,!1),m=!1;continue}if(f===2){if(m=r,n.errorRecoveryDisabledLanes&m)var x=0;else x=n.pendingLanes&-536870913,x=x!==0?x:x&536870912?536870912:0;if(x!==0){r=x;e:{var j=n;f=Oc;var z=j.current.memoizedState.isDehydrated;if(z&&(Cl(j,x).flags|=256),x=Jm(j,x,!1),x!==2){if($m&&!z){j.errorRecoveryDisabledLanes|=m,Mo|=m,f=4;break e}m=pr,pr=f,m!==null&&(pr===null?pr=m:pr.push.apply(pr,m))}f=x}if(m=!1,f!==2)continue}}if(f===1){Cl(n,0),za(n,r,0,!0);break}e:{switch(c=n,m=f,m){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:za(c,r,Mr,!Oa);break e;case 2:pr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(f=Pd+300-gt(),10<f)){if(za(c,r,Mr,!Oa),Oe(c,0,!0)!==0)break e;sa=r,c.timeoutHandle=gb(U1.bind(null,c,o,pr,Vd,Gm,r,Mr,Mo,Tl,Oa,m,"Throttled",-0,0),f);break e}U1(c,o,pr,Vd,Gm,r,Mr,Mo,Tl,Oa,m,null,-0,0)}}break}while(!0);Ni(n)}function U1(n,r,o,c,f,m,x,j,z,ie,we,Ee,de,ge){if(n.timeoutHandle=-1,Ee=r.subtreeFlags,Ee&8192||(Ee&16785408)===16785408){Ee={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:$s},R1(r,m,Ee);var et=(m&62914560)===m?Pd-gt():(m&4194048)===m?L1-gt():0;if(et=xT(Ee,et),et!==null){sa=m,n.cancelPendingCommit=et(G1.bind(null,n,r,m,o,c,f,x,j,z,we,Ee,null,de,ge)),za(n,m,x,!ie);return}}G1(n,r,m,o,c,f,x,j,z)}function OE(n){for(var r=n;;){var o=r.tag;if((o===0||o===11||o===15)&&r.flags&16384&&(o=r.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var f=o[c],m=f.getSnapshot;f=f.value;try{if(!Cr(m(),f))return!1}catch{return!1}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function za(n,r,o,c){r&=~Wm,r&=~Mo,n.suspendedLanes|=r,n.pingedLanes&=~r,c&&(n.warmLanes|=r),c=n.expirationTimes;for(var f=r;0<f;){var m=31-Mt(f),x=1<<m;c[m]=-1,f&=~x}o!==0&&ms(n,o,r)}function Ud(){return(_n&6)===0?(Uc(0),!1):!0}function Xm(){if(Yt!==null){if(En===0)var n=Yt.return;else n=Yt,Wi=jo=null,fm(n),vl=null,xc=0,n=Yt;for(;n!==null;)p1(n.alternate,n),n=n.return;Yt=null}}function Cl(n,r){var o=n.timeoutHandle;o!==-1&&(n.timeoutHandle=-1,sT(o)),o=n.cancelPendingCommit,o!==null&&(n.cancelPendingCommit=null,o()),sa=0,Xm(),Mn=n,Yt=o=qi(n.current,null),Jt=r,En=0,Ir=null,Oa=!1,El=Nt(n,r),$m=!1,Tl=Mr=Wm=Mo=Va=ss=0,pr=Oc=null,Gm=!1,(r&8)!==0&&(r|=r&32);var c=n.entangledLanes;if(c!==0)for(n=n.entanglements,c&=r;0<c;){var f=31-Mt(c),m=1<<f;r|=n[f],c&=~m}return na=r,ad(),o}function B1(n,r){Ut=null,J.H=Nc,r===yl||r===md?(r=nv(),En=3):r===tm?(r=nv(),En=4):En=r===Nm?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Ir=r,Yt===null&&(ss=1,Cd(n,Fr(r,n.current)))}function z1(){var n=Ar.current;return n===null?!0:(Jt&4194048)===Jt?Wr===null:(Jt&62914560)===Jt||(Jt&536870912)!==0?n===Wr:!1}function F1(){var n=J.H;return J.H=Nc,n===null?Nc:n}function H1(){var n=J.A;return J.A=LE,n}function Bd(){ss=4,Oa||(Jt&4194048)!==Jt&&Ar.current!==null||(El=!0),(Va&134217727)===0&&(Mo&134217727)===0||Mn===null||za(Mn,Jt,Mr,!1)}function Jm(n,r,o){var c=_n;_n|=2;var f=F1(),m=H1();(Mn!==n||Jt!==r)&&(Vd=null,Cl(n,r)),r=!1;var x=ss;e:do try{if(En!==0&&Yt!==null){var j=Yt,z=Ir;switch(En){case 8:Xm(),x=6;break e;case 3:case 2:case 9:case 6:Ar.current===null&&(r=!0);var ie=En;if(En=0,Ir=null,Nl(n,j,z,ie),o&&El){x=0;break e}break;default:ie=En,En=0,Ir=null,Nl(n,j,z,ie)}}VE(),x=ss;break}catch(we){B1(n,we)}while(!0);return r&&n.shellSuspendCounter++,Wi=jo=null,_n=c,J.H=f,J.A=m,Yt===null&&(Mn=null,Jt=0,ad()),x}function VE(){for(;Yt!==null;)q1(Yt)}function UE(n,r){var o=_n;_n|=2;var c=F1(),f=H1();Mn!==n||Jt!==r?(Vd=null,Od=gt()+500,Cl(n,r)):El=Nt(n,r);e:do try{if(En!==0&&Yt!==null){r=Yt;var m=Ir;t:switch(En){case 1:En=0,Ir=null,Nl(n,r,m,1);break;case 2:case 9:if(ev(m)){En=0,Ir=null,$1(r);break}r=function(){En!==2&&En!==9||Mn!==n||(En=7),Ni(n)},m.then(r,r);break e;case 3:En=7;break e;case 4:En=5;break e;case 7:ev(m)?(En=0,Ir=null,$1(r)):(En=0,Ir=null,Nl(n,r,m,7));break;case 5:var x=null;switch(Yt.tag){case 26:x=Yt.memoizedState;case 5:case 27:var j=Yt;if(x?Ab(x):j.stateNode.complete){En=0,Ir=null;var z=j.sibling;if(z!==null)Yt=z;else{var ie=j.return;ie!==null?(Yt=ie,zd(ie)):Yt=null}break t}}En=0,Ir=null,Nl(n,r,m,5);break;case 6:En=0,Ir=null,Nl(n,r,m,6);break;case 8:Xm(),ss=6;break e;default:throw Error(i(462))}}BE();break}catch(we){B1(n,we)}while(!0);return Wi=jo=null,J.H=c,J.A=f,_n=o,Yt!==null?0:(Mn=null,Jt=0,ad(),ss)}function BE(){for(;Yt!==null&&!it();)q1(Yt)}function q1(n){var r=m1(n.alternate,n,na);n.memoizedProps=n.pendingProps,r===null?zd(n):Yt=r}function $1(n){var r=n,o=r.alternate;switch(r.tag){case 15:case 0:r=l1(o,r,r.pendingProps,r.type,void 0,Jt);break;case 11:r=l1(o,r,r.pendingProps,r.type.render,r.ref,Jt);break;case 5:fm(r);default:p1(o,r),r=Yt=H0(r,na),r=m1(o,r,na)}n.memoizedProps=n.pendingProps,r===null?zd(n):Yt=r}function Nl(n,r,o,c){Wi=jo=null,fm(r),vl=null,xc=0;var f=r.return;try{if(CE(n,f,r,o,Jt)){ss=1,Cd(n,Fr(o,n.current)),Yt=null;return}}catch(m){if(f!==null)throw Yt=f,m;ss=1,Cd(n,Fr(o,n.current)),Yt=null;return}r.flags&32768?(on||c===1?n=!0:El||(Jt&536870912)!==0?n=!1:(Oa=n=!0,(c===2||c===9||c===3||c===6)&&(c=Ar.current,c!==null&&c.tag===13&&(c.flags|=16384))),W1(r,n)):zd(r)}function zd(n){var r=n;do{if((r.flags&32768)!==0){W1(r,Oa);return}n=r.return;var o=RE(r.alternate,r,na);if(o!==null){Yt=o;return}if(r=r.sibling,r!==null){Yt=r;return}Yt=r=n}while(r!==null);ss===0&&(ss=5)}function W1(n,r){do{var o=IE(n.alternate,n);if(o!==null){o.flags&=32767,Yt=o;return}if(o=n.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!r&&(n=n.sibling,n!==null)){Yt=n;return}Yt=n=o}while(n!==null);ss=6,Yt=null}function G1(n,r,o,c,f,m,x,j,z){n.cancelPendingCommit=null;do Fd();while(Es!==0);if((_n&6)!==0)throw Error(i(327));if(r!==null){if(r===n.current)throw Error(i(177));if(m=r.lanes|r.childLanes,m|=Bf,On(n,o,m,x,j,z),n===Mn&&(Yt=Mn=null,Jt=0),Sl=r,Ba=n,sa=o,Km=m,Ym=f,P1=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,qE(rn,function(){return J1(),null})):(n.callbackNode=null,n.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=J.T,J.T=null,f=Te.p,Te.p=2,x=_n,_n|=4;try{ME(n,r,o)}finally{_n=x,Te.p=f,J.T=c}}Es=1,K1(),Y1(),Q1()}}function K1(){if(Es===1){Es=0;var n=Ba,r=Sl,o=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||o){o=J.T,J.T=null;var c=Te.p;Te.p=2;var f=_n;_n|=4;try{C1(r,n);var m=ug,x=D0(n.containerInfo),j=m.focusedElem,z=m.selectionRange;if(x!==j&&j&&j.ownerDocument&&M0(j.ownerDocument.documentElement,j)){if(z!==null&&Lf(j)){var ie=z.start,we=z.end;if(we===void 0&&(we=ie),"selectionStart"in j)j.selectionStart=ie,j.selectionEnd=Math.min(we,j.value.length);else{var Ee=j.ownerDocument||document,de=Ee&&Ee.defaultView||window;if(de.getSelection){var ge=de.getSelection(),et=j.textContent.length,wt=Math.min(z.start,et),In=z.end===void 0?wt:Math.min(z.end,et);!ge.extend&&wt>In&&(x=In,In=wt,wt=x);var X=I0(j,wt),W=I0(j,In);if(X&&W&&(ge.rangeCount!==1||ge.anchorNode!==X.node||ge.anchorOffset!==X.offset||ge.focusNode!==W.node||ge.focusOffset!==W.offset)){var re=Ee.createRange();re.setStart(X.node,X.offset),ge.removeAllRanges(),wt>In?(ge.addRange(re),ge.extend(W.node,W.offset)):(re.setEnd(W.node,W.offset),ge.addRange(re))}}}}for(Ee=[],ge=j;ge=ge.parentNode;)ge.nodeType===1&&Ee.push({element:ge,left:ge.scrollLeft,top:ge.scrollTop});for(typeof j.focus=="function"&&j.focus(),j=0;j<Ee.length;j++){var xe=Ee[j];xe.element.scrollLeft=xe.left,xe.element.scrollTop=xe.top}}eh=!!cg,ug=cg=null}finally{_n=f,Te.p=c,J.T=o}}n.current=r,Es=2}}function Y1(){if(Es===2){Es=0;var n=Ba,r=Sl,o=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||o){o=J.T,J.T=null;var c=Te.p;Te.p=2;var f=_n;_n|=4;try{k1(n,r.alternate,r)}finally{_n=f,Te.p=c,J.T=o}}Es=3}}function Q1(){if(Es===4||Es===3){Es=0,yt();var n=Ba,r=Sl,o=sa,c=P1;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Es=5:(Es=0,Sl=Ba=null,X1(n,n.pendingLanes));var f=n.pendingLanes;if(f===0&&(Ua=null),ct(o),r=r.stateNode,Gt&&typeof Gt.onCommitFiberRoot=="function")try{Gt.onCommitFiberRoot(un,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=J.T,f=Te.p,Te.p=2,J.T=null;try{for(var m=n.onRecoverableError,x=0;x<c.length;x++){var j=c[x];m(j.value,{componentStack:j.stack})}}finally{J.T=r,Te.p=f}}(sa&3)!==0&&Fd(),Ni(n),f=n.pendingLanes,(o&261930)!==0&&(f&42)!==0?n===Qm?Vc++:(Vc=0,Qm=n):Vc=0,Uc(0)}}function X1(n,r){(n.pooledCacheLanes&=r)===0&&(r=n.pooledCache,r!=null&&(n.pooledCache=null,bc(r)))}function Fd(){return K1(),Y1(),Q1(),J1()}function J1(){if(Es!==5)return!1;var n=Ba,r=Km;Km=0;var o=ct(sa),c=J.T,f=Te.p;try{Te.p=32>o?32:o,J.T=null,o=Ym,Ym=null;var m=Ba,x=sa;if(Es=0,Sl=Ba=null,sa=0,(_n&6)!==0)throw Error(i(331));var j=_n;if(_n|=4,M1(m.current),A1(m,m.current,x,o),_n=j,Uc(0,!1),Gt&&typeof Gt.onPostCommitFiberRoot=="function")try{Gt.onPostCommitFiberRoot(un,m)}catch{}return!0}finally{Te.p=f,J.T=c,X1(n,r)}}function Z1(n,r,o){r=Fr(o,r),r=Cm(n.stateNode,r,2),n=Ma(n,r,2),n!==null&&(hn(n,2),Ni(n))}function Tn(n,r,o){if(n.tag===3)Z1(n,n,o);else for(;r!==null;){if(r.tag===3){Z1(r,n,o);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Ua===null||!Ua.has(c))){n=Fr(o,n),o=e1(2),c=Ma(r,o,2),c!==null&&(t1(o,c,r,n),hn(c,2),Ni(c));break}}r=r.return}}function Zm(n,r,o){var c=n.pingCache;if(c===null){c=n.pingCache=new PE;var f=new Set;c.set(r,f)}else f=c.get(r),f===void 0&&(f=new Set,c.set(r,f));f.has(o)||($m=!0,f.add(o),n=zE.bind(null,n,r,o),r.then(n,n))}function zE(n,r,o){var c=n.pingCache;c!==null&&c.delete(r),n.pingedLanes|=n.suspendedLanes&o,n.warmLanes&=~o,Mn===n&&(Jt&o)===o&&(ss===4||ss===3&&(Jt&62914560)===Jt&&300>gt()-Pd?(_n&2)===0&&Cl(n,0):Wm|=o,Tl===Jt&&(Tl=0)),Ni(n)}function eb(n,r){r===0&&(r=lt()),n=xo(n,r),n!==null&&(hn(n,r),Ni(n))}function FE(n){var r=n.memoizedState,o=0;r!==null&&(o=r.retryLane),eb(n,o)}function HE(n,r){var o=0;switch(n.tag){case 31:case 13:var c=n.stateNode,f=n.memoizedState;f!==null&&(o=f.retryLane);break;case 19:c=n.stateNode;break;case 22:c=n.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(r),eb(n,o)}function qE(n,r){return pt(n,r)}var Hd=null,Al=null,eg=!1,qd=!1,tg=!1,Fa=0;function Ni(n){n!==Al&&n.next===null&&(Al===null?Hd=Al=n:Al=Al.next=n),qd=!0,eg||(eg=!0,WE())}function Uc(n,r){if(!tg&&qd){tg=!0;do for(var o=!1,c=Hd;c!==null;){if(n!==0){var f=c.pendingLanes;if(f===0)var m=0;else{var x=c.suspendedLanes,j=c.pingedLanes;m=(1<<31-Mt(42|n)+1)-1,m&=f&~(x&~j),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(o=!0,rb(c,m))}else m=Jt,m=Oe(c,c===Mn?m:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(m&3)===0||Nt(c,m)||(o=!0,rb(c,m));c=c.next}while(o);tg=!1}}function $E(){tb()}function tb(){qd=eg=!1;var n=0;Fa!==0&&nT()&&(n=Fa);for(var r=gt(),o=null,c=Hd;c!==null;){var f=c.next,m=nb(c,r);m===0?(c.next=null,o===null?Hd=f:o.next=f,f===null&&(Al=o)):(o=c,(n!==0||(m&3)!==0)&&(qd=!0)),c=f}Es!==0&&Es!==5||Uc(n),Fa!==0&&(Fa=0)}function nb(n,r){for(var o=n.suspendedLanes,c=n.pingedLanes,f=n.expirationTimes,m=n.pendingLanes&-62914561;0<m;){var x=31-Mt(m),j=1<<x,z=f[x];z===-1?((j&o)===0||(j&c)!==0)&&(f[x]=bt(j,r)):z<=r&&(n.expiredLanes|=j),m&=~j}if(r=Mn,o=Jt,o=Oe(n,n===r?o:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c=n.callbackNode,o===0||n===r&&(En===2||En===9)||n.cancelPendingCommit!==null)return c!==null&&c!==null&&Ht(c),n.callbackNode=null,n.callbackPriority=0;if((o&3)===0||Nt(n,o)){if(r=o&-o,r===n.callbackPriority)return r;switch(c!==null&&Ht(c),ct(o)){case 2:case 8:o=fs;break;case 32:o=rn;break;case 268435456:o=Fn;break;default:o=rn}return c=sb.bind(null,n),o=pt(o,c),n.callbackPriority=r,n.callbackNode=o,r}return c!==null&&c!==null&&Ht(c),n.callbackPriority=2,n.callbackNode=null,2}function sb(n,r){if(Es!==0&&Es!==5)return n.callbackNode=null,n.callbackPriority=0,null;var o=n.callbackNode;if(Fd()&&n.callbackNode!==o)return null;var c=Jt;return c=Oe(n,n===Mn?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c===0?null:(V1(n,c,r),nb(n,gt()),n.callbackNode!=null&&n.callbackNode===o?sb.bind(null,n):null)}function rb(n,r){if(Fd())return null;V1(n,r,!0)}function WE(){rT(function(){(_n&6)!==0?pt(zt,$E):tb()})}function ng(){if(Fa===0){var n=gl;n===0&&(n=Re,Re<<=1,(Re&261888)===0&&(Re=256)),Fa=n}return Fa}function ib(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Tr(""+n)}function ab(n,r){var o=r.ownerDocument.createElement("input");return o.name=r.name,o.value=r.value,n.id&&o.setAttribute("form",n.id),r.parentNode.insertBefore(o,r),n=new FormData(n),o.parentNode.removeChild(o),n}function GE(n,r,o,c,f){if(r==="submit"&&o&&o.stateNode===f){var m=ib((f[St]||null).action),x=c.submitter;x&&(r=(r=x[St]||null)?ib(r.formAction):x.getAttribute("formAction"),r!==null&&(m=r,x=null));var j=new an("action","action",null,c,f);n.push({event:j,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Fa!==0){var z=x?ab(f,x):new FormData(f);_m(o,{pending:!0,data:z,method:f.method,action:m},null,z)}}else typeof m=="function"&&(j.preventDefault(),z=x?ab(f,x):new FormData(f),_m(o,{pending:!0,data:z,method:f.method,action:m},m,z))},currentTarget:f}]})}}for(var sg=0;sg<Uf.length;sg++){var rg=Uf[sg],KE=rg.toLowerCase(),YE=rg[0].toUpperCase()+rg.slice(1);ci(KE,"on"+YE)}ci(O0,"onAnimationEnd"),ci(V0,"onAnimationIteration"),ci(U0,"onAnimationStart"),ci("dblclick","onDoubleClick"),ci("focusin","onFocus"),ci("focusout","onBlur"),ci(dE,"onTransitionRun"),ci(hE,"onTransitionStart"),ci(fE,"onTransitionCancel"),ci(B0,"onTransitionEnd"),Yn("onMouseEnter",["mouseout","mouseover"]),Yn("onMouseLeave",["mouseout","mouseover"]),Yn("onPointerEnter",["pointerout","pointerover"]),Yn("onPointerLeave",["pointerout","pointerover"]),qs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),qs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),qs("onBeforeInput",["compositionend","keypress","textInput","paste"]),qs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),qs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),qs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),QE=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Bc));function ob(n,r){r=(r&4)!==0;for(var o=0;o<n.length;o++){var c=n[o],f=c.event;c=c.listeners;e:{var m=void 0;if(r)for(var x=c.length-1;0<=x;x--){var j=c[x],z=j.instance,ie=j.currentTarget;if(j=j.listener,z!==m&&f.isPropagationStopped())break e;m=j,f.currentTarget=ie;try{m(f)}catch(we){id(we)}f.currentTarget=null,m=z}else for(x=0;x<c.length;x++){if(j=c[x],z=j.instance,ie=j.currentTarget,j=j.listener,z!==m&&f.isPropagationStopped())break e;m=j,f.currentTarget=ie;try{m(f)}catch(we){id(we)}f.currentTarget=null,m=z}}}}function Qt(n,r){var o=r[Ss];o===void 0&&(o=r[Ss]=new Set);var c=n+"__bubble";o.has(c)||(lb(r,n,2,!1),o.add(c))}function ig(n,r,o){var c=0;r&&(c|=4),lb(o,n,c,r)}var $d="_reactListening"+Math.random().toString(36).slice(2);function ag(n){if(!n[$d]){n[$d]=!0,es.forEach(function(o){o!=="selectionchange"&&(QE.has(o)||ig(o,!1,n),ig(o,!0,n))});var r=n.nodeType===9?n:n.ownerDocument;r===null||r[$d]||(r[$d]=!0,ig("selectionchange",!1,r))}}function lb(n,r,o,c){switch(Ob(r)){case 2:var f=jT;break;case 8:f=ET;break;default:f=xg}o=f.bind(null,r,o,n),f=void 0,!me||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(f=!0),c?f!==void 0?n.addEventListener(r,o,{capture:!0,passive:f}):n.addEventListener(r,o,!0):f!==void 0?n.addEventListener(r,o,{passive:f}):n.addEventListener(r,o,!1)}function og(n,r,o,c,f){var m=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var x=c.tag;if(x===3||x===4){var j=c.stateNode.containerInfo;if(j===f)break;if(x===4)for(x=c.return;x!==null;){var z=x.tag;if((z===3||z===4)&&x.stateNode.containerInfo===f)return;x=x.return}for(;j!==null;){if(x=Kn(j),x===null)return;if(z=x.tag,z===5||z===6||z===26||z===27){c=m=x;continue e}j=j.parentNode}}c=c.return}F(function(){var ie=m,we=Ls(o),Ee=[];e:{var de=z0.get(n);if(de!==void 0){var ge=an,et=n;switch(n){case"keypress":if(kt(o)===0)break e;case"keydown":case"keyup":ge=nd;break;case"focusin":et="focus",ge=ai;break;case"focusout":et="blur",ge=ai;break;case"beforeblur":case"afterblur":ge=ai;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ge=nr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ge=yo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ge=v;break;case O0:case V0:case U0:ge=Yu;break;case B0:ge=N;break;case"scroll":case"scrollend":ge=gn;break;case"wheel":ge=fe;break;case"copy":case"cut":case"paste":ge=Qu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ge=Hi;break;case"toggle":case"beforetoggle":ge=Vt}var wt=(r&4)!==0,In=!wt&&(n==="scroll"||n==="scrollend"),X=wt?de!==null?de+"Capture":null:de;wt=[];for(var W=ie,re;W!==null;){var xe=W;if(re=xe.stateNode,xe=xe.tag,xe!==5&&xe!==26&&xe!==27||re===null||X===null||(xe=$(W,X),xe!=null&&wt.push(zc(W,xe,re))),In)break;W=W.return}0<wt.length&&(de=new ge(de,et,null,o,we),Ee.push({event:de,listeners:wt}))}}if((r&7)===0){e:{if(de=n==="mouseover"||n==="pointerover",ge=n==="mouseout"||n==="pointerout",de&&o!==Ws&&(et=o.relatedTarget||o.fromElement)&&(Kn(et)||et[bn]))break e;if((ge||de)&&(de=we.window===we?we:(de=we.ownerDocument)?de.defaultView||de.parentWindow:window,ge?(et=o.relatedTarget||o.toElement,ge=ie,et=et?Kn(et):null,et!==null&&(In=u(et),wt=et.tag,et!==In||wt!==5&&wt!==27&&wt!==6)&&(et=null)):(ge=null,et=ie),ge!==et)){if(wt=nr,xe="onMouseLeave",X="onMouseEnter",W="mouse",(n==="pointerout"||n==="pointerover")&&(wt=Hi,xe="onPointerLeave",X="onPointerEnter",W="pointer"),In=ge==null?de:ls(ge),re=et==null?de:ls(et),de=new wt(xe,W+"leave",ge,o,we),de.target=In,de.relatedTarget=re,xe=null,Kn(we)===ie&&(wt=new wt(X,W+"enter",et,o,we),wt.target=re,wt.relatedTarget=In,xe=wt),In=xe,ge&&et)t:{for(wt=XE,X=ge,W=et,re=0,xe=X;xe;xe=wt(xe))re++;xe=0;for(var ht=W;ht;ht=wt(ht))xe++;for(;0<re-xe;)X=wt(X),re--;for(;0<xe-re;)W=wt(W),xe--;for(;re--;){if(X===W||W!==null&&X===W.alternate){wt=X;break t}X=wt(X),W=wt(W)}wt=null}else wt=null;ge!==null&&cb(Ee,de,ge,wt,!1),et!==null&&In!==null&&cb(Ee,In,et,wt,!0)}}e:{if(de=ie?ls(ie):window,ge=de.nodeName&&de.nodeName.toLowerCase(),ge==="select"||ge==="input"&&de.type==="file")var yn=T0;else if(j0(de))if(S0)yn=lE;else{yn=aE;var at=iE}else ge=de.nodeName,!ge||ge.toLowerCase()!=="input"||de.type!=="checkbox"&&de.type!=="radio"?ie&&ki(ie.elementType)&&(yn=T0):yn=oE;if(yn&&(yn=yn(n,ie))){E0(Ee,yn,o,we);break e}at&&at(n,de,ie),n==="focusout"&&ie&&de.type==="number"&&ie.memoizedProps.value!=null&&Ds(de,"number",de.value)}switch(at=ie?ls(ie):window,n){case"focusin":(j0(at)||at.contentEditable==="true")&&(ol=at,Pf=ie,pc=null);break;case"focusout":pc=Pf=ol=null;break;case"mousedown":Of=!0;break;case"contextmenu":case"mouseup":case"dragend":Of=!1,L0(Ee,o,we);break;case"selectionchange":if(uE)break;case"keydown":case"keyup":L0(Ee,o,we)}var Ft;if(xn)e:{switch(n){case"compositionstart":var Zt="onCompositionStart";break e;case"compositionend":Zt="onCompositionEnd";break e;case"compositionupdate":Zt="onCompositionUpdate";break e}Zt=void 0}else al?vo(n,o)&&(Zt="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&(Zt="onCompositionStart");Zt&&(Ei&&o.locale!=="ko"&&(al||Zt!=="onCompositionStart"?Zt==="onCompositionEnd"&&al&&(Ft=vt()):(Ve=we,nt="value"in Ve?Ve.value:Ve.textContent,al=!0)),at=Wd(ie,Zt),0<at.length&&(Zt=new ji(Zt,n,null,o,we),Ee.push({event:Zt,listeners:at}),Ft?Zt.data=Ft:(Ft=il(o),Ft!==null&&(Zt.data=Ft)))),(Ft=Br?tE(n,o):nE(n,o))&&(Zt=Wd(ie,"onBeforeInput"),0<Zt.length&&(at=new ji("onBeforeInput","beforeinput",null,o,we),Ee.push({event:at,listeners:Zt}),at.data=Ft)),GE(Ee,n,ie,o,we)}ob(Ee,r)})}function zc(n,r,o){return{instance:n,listener:r,currentTarget:o}}function Wd(n,r){for(var o=r+"Capture",c=[];n!==null;){var f=n,m=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||m===null||(f=$(n,o),f!=null&&c.unshift(zc(n,f,m)),f=$(n,r),f!=null&&c.push(zc(n,f,m))),n.tag===3)return c;n=n.return}return[]}function XE(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function cb(n,r,o,c,f){for(var m=r._reactName,x=[];o!==null&&o!==c;){var j=o,z=j.alternate,ie=j.stateNode;if(j=j.tag,z!==null&&z===c)break;j!==5&&j!==26&&j!==27||ie===null||(z=ie,f?(ie=$(o,m),ie!=null&&x.unshift(zc(o,ie,z))):f||(ie=$(o,m),ie!=null&&x.push(zc(o,ie,z)))),o=o.return}x.length!==0&&n.push({event:r,listeners:x})}var JE=/\r\n?/g,ZE=/\u0000|\uFFFD/g;function ub(n){return(typeof n=="string"?n:""+n).replace(JE,`
`).replace(ZE,"")}function db(n,r){return r=ub(r),ub(n)===r}function Rn(n,r,o,c,f,m){switch(o){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||Ns(n,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&Ns(n,""+c);break;case"className":oe(n,"class",c);break;case"tabIndex":oe(n,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":oe(n,o,c);break;case"style":ii(n,c,m);break;case"data":if(r!=="object"){oe(n,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||o!=="href")){n.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(o);break}c=Tr(""+c),n.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){n.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(o==="formAction"?(r!=="input"&&Rn(n,r,"name",f.name,f,null),Rn(n,r,"formEncType",f.formEncType,f,null),Rn(n,r,"formMethod",f.formMethod,f,null),Rn(n,r,"formTarget",f.formTarget,f,null)):(Rn(n,r,"encType",f.encType,f,null),Rn(n,r,"method",f.method,f,null),Rn(n,r,"target",f.target,f,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(o);break}c=Tr(""+c),n.setAttribute(o,c);break;case"onClick":c!=null&&(n.onclick=$s);break;case"onScroll":c!=null&&Qt("scroll",n);break;case"onScrollEnd":c!=null&&Qt("scrollend",n);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"multiple":n.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":n.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){n.removeAttribute("xlink:href");break}o=Tr(""+c),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,""+c):n.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,""):n.removeAttribute(o);break;case"capture":case"download":c===!0?n.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,c):n.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?n.setAttribute(o,c):n.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?n.removeAttribute(o):n.setAttribute(o,c);break;case"popover":Qt("beforetoggle",n),Qt("toggle",n),q(n,"popover",c);break;case"xlinkActuate":ne(n,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":ne(n,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":ne(n,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":ne(n,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":ne(n,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":ne(n,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":ne(n,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":ne(n,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":ne(n,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":q(n,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Fi.get(o)||o,q(n,o,c))}}function lg(n,r,o,c,f,m){switch(o){case"style":ii(n,c,m);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"children":typeof c=="string"?Ns(n,c):(typeof c=="number"||typeof c=="bigint")&&Ns(n,""+c);break;case"onScroll":c!=null&&Qt("scroll",n);break;case"onScrollEnd":c!=null&&Qt("scrollend",n);break;case"onClick":c!=null&&(n.onclick=$s);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!kr.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(f=o.endsWith("Capture"),r=o.slice(2,f?o.length-7:void 0),m=n[St]||null,m=m!=null?m[o]:null,typeof m=="function"&&n.removeEventListener(r,m,f),typeof c=="function")){typeof m!="function"&&m!==null&&(o in n?n[o]=null:n.hasAttribute(o)&&n.removeAttribute(o)),n.addEventListener(r,c,f);break e}o in n?n[o]=c:c===!0?n.setAttribute(o,""):q(n,o,c)}}}function Us(n,r,o){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Qt("error",n),Qt("load",n);var c=!1,f=!1,m;for(m in o)if(o.hasOwnProperty(m)){var x=o[m];if(x!=null)switch(m){case"src":c=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:Rn(n,r,m,x,o,null)}}f&&Rn(n,r,"srcSet",o.srcSet,o,null),c&&Rn(n,r,"src",o.src,o,null);return;case"input":Qt("invalid",n);var j=m=x=f=null,z=null,ie=null;for(c in o)if(o.hasOwnProperty(c)){var we=o[c];if(we!=null)switch(c){case"name":f=we;break;case"type":x=we;break;case"checked":z=we;break;case"defaultChecked":ie=we;break;case"value":m=we;break;case"defaultValue":j=we;break;case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(i(137,r));break;default:Rn(n,r,c,we,o,null)}}ri(n,m,j,z,ie,x,f,!1);return;case"select":Qt("invalid",n),c=x=m=null;for(f in o)if(o.hasOwnProperty(f)&&(j=o[f],j!=null))switch(f){case"value":m=j;break;case"defaultValue":x=j;break;case"multiple":c=j;default:Rn(n,r,f,j,o,null)}r=m,o=x,n.multiple=!!c,r!=null?er(n,!!c,r,!1):o!=null&&er(n,!!c,o,!0);return;case"textarea":Qt("invalid",n),m=f=c=null;for(x in o)if(o.hasOwnProperty(x)&&(j=o[x],j!=null))switch(x){case"value":c=j;break;case"defaultValue":f=j;break;case"children":m=j;break;case"dangerouslySetInnerHTML":if(j!=null)throw Error(i(91));break;default:Rn(n,r,x,j,o,null)}Er(n,c,f,m);return;case"option":for(z in o)o.hasOwnProperty(z)&&(c=o[z],c!=null)&&(z==="selected"?n.selected=c&&typeof c!="function"&&typeof c!="symbol":Rn(n,r,z,c,o,null));return;case"dialog":Qt("beforetoggle",n),Qt("toggle",n),Qt("cancel",n),Qt("close",n);break;case"iframe":case"object":Qt("load",n);break;case"video":case"audio":for(c=0;c<Bc.length;c++)Qt(Bc[c],n);break;case"image":Qt("error",n),Qt("load",n);break;case"details":Qt("toggle",n);break;case"embed":case"source":case"link":Qt("error",n),Qt("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ie in o)if(o.hasOwnProperty(ie)&&(c=o[ie],c!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:Rn(n,r,ie,c,o,null)}return;default:if(ki(r)){for(we in o)o.hasOwnProperty(we)&&(c=o[we],c!==void 0&&lg(n,r,we,c,o,void 0));return}}for(j in o)o.hasOwnProperty(j)&&(c=o[j],c!=null&&Rn(n,r,j,c,o,null))}function eT(n,r,o,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,m=null,x=null,j=null,z=null,ie=null,we=null;for(ge in o){var Ee=o[ge];if(o.hasOwnProperty(ge)&&Ee!=null)switch(ge){case"checked":break;case"value":break;case"defaultValue":z=Ee;default:c.hasOwnProperty(ge)||Rn(n,r,ge,null,c,Ee)}}for(var de in c){var ge=c[de];if(Ee=o[de],c.hasOwnProperty(de)&&(ge!=null||Ee!=null))switch(de){case"type":m=ge;break;case"name":f=ge;break;case"checked":ie=ge;break;case"defaultChecked":we=ge;break;case"value":x=ge;break;case"defaultValue":j=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(i(137,r));break;default:ge!==Ee&&Rn(n,r,de,ge,c,Ee)}}Ms(n,x,j,z,ie,we,m,f);return;case"select":ge=x=j=de=null;for(m in o)if(z=o[m],o.hasOwnProperty(m)&&z!=null)switch(m){case"value":break;case"multiple":ge=z;default:c.hasOwnProperty(m)||Rn(n,r,m,null,c,z)}for(f in c)if(m=c[f],z=o[f],c.hasOwnProperty(f)&&(m!=null||z!=null))switch(f){case"value":de=m;break;case"defaultValue":j=m;break;case"multiple":x=m;default:m!==z&&Rn(n,r,f,m,c,z)}r=j,o=x,c=ge,de!=null?er(n,!!o,de,!1):!!c!=!!o&&(r!=null?er(n,!!o,r,!0):er(n,!!o,o?[]:"",!1));return;case"textarea":ge=de=null;for(j in o)if(f=o[j],o.hasOwnProperty(j)&&f!=null&&!c.hasOwnProperty(j))switch(j){case"value":break;case"children":break;default:Rn(n,r,j,null,c,f)}for(x in c)if(f=c[x],m=o[x],c.hasOwnProperty(x)&&(f!=null||m!=null))switch(x){case"value":de=f;break;case"defaultValue":ge=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(i(91));break;default:f!==m&&Rn(n,r,x,f,c,m)}_i(n,de,ge);return;case"option":for(var et in o)de=o[et],o.hasOwnProperty(et)&&de!=null&&!c.hasOwnProperty(et)&&(et==="selected"?n.selected=!1:Rn(n,r,et,null,c,de));for(z in c)de=c[z],ge=o[z],c.hasOwnProperty(z)&&de!==ge&&(de!=null||ge!=null)&&(z==="selected"?n.selected=de&&typeof de!="function"&&typeof de!="symbol":Rn(n,r,z,de,c,ge));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var wt in o)de=o[wt],o.hasOwnProperty(wt)&&de!=null&&!c.hasOwnProperty(wt)&&Rn(n,r,wt,null,c,de);for(ie in c)if(de=c[ie],ge=o[ie],c.hasOwnProperty(ie)&&de!==ge&&(de!=null||ge!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(i(137,r));break;default:Rn(n,r,ie,de,c,ge)}return;default:if(ki(r)){for(var In in o)de=o[In],o.hasOwnProperty(In)&&de!==void 0&&!c.hasOwnProperty(In)&&lg(n,r,In,void 0,c,de);for(we in c)de=c[we],ge=o[we],!c.hasOwnProperty(we)||de===ge||de===void 0&&ge===void 0||lg(n,r,we,de,c,ge);return}}for(var X in o)de=o[X],o.hasOwnProperty(X)&&de!=null&&!c.hasOwnProperty(X)&&Rn(n,r,X,null,c,de);for(Ee in c)de=c[Ee],ge=o[Ee],!c.hasOwnProperty(Ee)||de===ge||de==null&&ge==null||Rn(n,r,Ee,de,c,ge)}function hb(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function tT(){if(typeof performance.getEntriesByType=="function"){for(var n=0,r=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var f=o[c],m=f.transferSize,x=f.initiatorType,j=f.duration;if(m&&j&&hb(x)){for(x=0,j=f.responseEnd,c+=1;c<o.length;c++){var z=o[c],ie=z.startTime;if(ie>j)break;var we=z.transferSize,Ee=z.initiatorType;we&&hb(Ee)&&(z=z.responseEnd,x+=we*(z<j?1:(j-ie)/(z-ie)))}if(--c,r+=8*(m+x)/(f.duration/1e3),n++,10<n)break}}if(0<n)return r/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var cg=null,ug=null;function Gd(n){return n.nodeType===9?n:n.ownerDocument}function fb(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function mb(n,r){if(n===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&r==="foreignObject"?0:n}function dg(n,r){return n==="textarea"||n==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var hg=null;function nT(){var n=window.event;return n&&n.type==="popstate"?n===hg?!1:(hg=n,!0):(hg=null,!1)}var gb=typeof setTimeout=="function"?setTimeout:void 0,sT=typeof clearTimeout=="function"?clearTimeout:void 0,pb=typeof Promise=="function"?Promise:void 0,rT=typeof queueMicrotask=="function"?queueMicrotask:typeof pb<"u"?function(n){return pb.resolve(null).then(n).catch(iT)}:gb;function iT(n){setTimeout(function(){throw n})}function Ha(n){return n==="head"}function yb(n,r){var o=r,c=0;do{var f=o.nextSibling;if(n.removeChild(o),f&&f.nodeType===8)if(o=f.data,o==="/$"||o==="/&"){if(c===0){n.removeChild(f),Dl(r);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")Fc(n.ownerDocument.documentElement);else if(o==="head"){o=n.ownerDocument.head,Fc(o);for(var m=o.firstChild;m;){var x=m.nextSibling,j=m.nodeName;m[js]||j==="SCRIPT"||j==="STYLE"||j==="LINK"&&m.rel.toLowerCase()==="stylesheet"||o.removeChild(m),m=x}}else o==="body"&&Fc(n.ownerDocument.body);o=f}while(o);Dl(r)}function vb(n,r){var o=n;n=0;do{var c=o.nextSibling;if(o.nodeType===1?r?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(r?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(n===0)break;n--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||n++;o=c}while(o)}function fg(n){var r=n.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var o=r;switch(r=r.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":fg(o),hr(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}n.removeChild(o)}}function aT(n,r,o,c){for(;n.nodeType===1;){var f=o;if(n.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(c){if(!n[js])switch(r){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(m=n.getAttribute("rel"),m==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(m!==f.rel||n.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||n.getAttribute("title")!==(f.title==null?null:f.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(m=n.getAttribute("src"),(m!==(f.src==null?null:f.src)||n.getAttribute("type")!==(f.type==null?null:f.type)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&m&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(r==="input"&&n.type==="hidden"){var m=f.name==null?null:""+f.name;if(f.type==="hidden"&&n.getAttribute("name")===m)return n}else return n;if(n=Gr(n.nextSibling),n===null)break}return null}function oT(n,r,o){if(r==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=Gr(n.nextSibling),n===null))return null;return n}function bb(n,r){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!r||(n=Gr(n.nextSibling),n===null))return null;return n}function mg(n){return n.data==="$?"||n.data==="$~"}function gg(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function lT(n,r){var o=n.ownerDocument;if(n.data==="$~")n._reactRetry=r;else if(n.data!=="$?"||o.readyState!=="loading")r();else{var c=function(){r(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),n._reactRetry=c}}function Gr(n){for(;n!=null;n=n.nextSibling){var r=n.nodeType;if(r===1||r===3)break;if(r===8){if(r=n.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return n}var pg=null;function wb(n){n=n.nextSibling;for(var r=0;n;){if(n.nodeType===8){var o=n.data;if(o==="/$"||o==="/&"){if(r===0)return Gr(n.nextSibling);r--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||r++}n=n.nextSibling}return null}function xb(n){n=n.previousSibling;for(var r=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(r===0)return n;r--}else o!=="/$"&&o!=="/&"||r++}n=n.previousSibling}return null}function _b(n,r,o){switch(r=Gd(o),n){case"html":if(n=r.documentElement,!n)throw Error(i(452));return n;case"head":if(n=r.head,!n)throw Error(i(453));return n;case"body":if(n=r.body,!n)throw Error(i(454));return n;default:throw Error(i(451))}}function Fc(n){for(var r=n.attributes;r.length;)n.removeAttributeNode(r[0]);hr(n)}var Kr=new Map,kb=new Set;function Kd(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var ra=Te.d;Te.d={f:cT,r:uT,D:dT,C:hT,L:fT,m:mT,X:pT,S:gT,M:yT};function cT(){var n=ra.f(),r=Ud();return n||r}function uT(n){var r=os(n);r!==null&&r.tag===5&&r.type==="form"?Bv(r):ra.r(n)}var Rl=typeof document>"u"?null:document;function jb(n,r,o){var c=Rl;if(c&&typeof r=="string"&&r){var f=Qn(r);f='link[rel="'+n+'"][href="'+f+'"]',typeof o=="string"&&(f+='[crossorigin="'+o+'"]'),kb.has(f)||(kb.add(f),n={rel:n,crossOrigin:o,href:r},c.querySelector(f)===null&&(r=c.createElement("link"),Us(r,"link",n),wn(r),c.head.appendChild(r)))}}function dT(n){ra.D(n),jb("dns-prefetch",n,null)}function hT(n,r){ra.C(n,r),jb("preconnect",n,r)}function fT(n,r,o){ra.L(n,r,o);var c=Rl;if(c&&n&&r){var f='link[rel="preload"][as="'+Qn(r)+'"]';r==="image"&&o&&o.imageSrcSet?(f+='[imagesrcset="'+Qn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(f+='[imagesizes="'+Qn(o.imageSizes)+'"]')):f+='[href="'+Qn(n)+'"]';var m=f;switch(r){case"style":m=Il(n);break;case"script":m=Ml(n)}Kr.has(m)||(n=k({rel:"preload",href:r==="image"&&o&&o.imageSrcSet?void 0:n,as:r},o),Kr.set(m,n),c.querySelector(f)!==null||r==="style"&&c.querySelector(Hc(m))||r==="script"&&c.querySelector(qc(m))||(r=c.createElement("link"),Us(r,"link",n),wn(r),c.head.appendChild(r)))}}function mT(n,r){ra.m(n,r);var o=Rl;if(o&&n){var c=r&&typeof r.as=="string"?r.as:"script",f='link[rel="modulepreload"][as="'+Qn(c)+'"][href="'+Qn(n)+'"]',m=f;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=Ml(n)}if(!Kr.has(m)&&(n=k({rel:"modulepreload",href:n},r),Kr.set(m,n),o.querySelector(f)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(qc(m)))return}c=o.createElement("link"),Us(c,"link",n),wn(c),o.head.appendChild(c)}}}function gT(n,r,o){ra.S(n,r,o);var c=Rl;if(c&&n){var f=Vn(c).hoistableStyles,m=Il(n);r=r||"default";var x=f.get(m);if(!x){var j={loading:0,preload:null};if(x=c.querySelector(Hc(m)))j.loading=5;else{n=k({rel:"stylesheet",href:n,"data-precedence":r},o),(o=Kr.get(m))&&yg(n,o);var z=x=c.createElement("link");wn(z),Us(z,"link",n),z._p=new Promise(function(ie,we){z.onload=ie,z.onerror=we}),z.addEventListener("load",function(){j.loading|=1}),z.addEventListener("error",function(){j.loading|=2}),j.loading|=4,Yd(x,r,c)}x={type:"stylesheet",instance:x,count:1,state:j},f.set(m,x)}}}function pT(n,r){ra.X(n,r);var o=Rl;if(o&&n){var c=Vn(o).hoistableScripts,f=Ml(n),m=c.get(f);m||(m=o.querySelector(qc(f)),m||(n=k({src:n,async:!0},r),(r=Kr.get(f))&&vg(n,r),m=o.createElement("script"),wn(m),Us(m,"link",n),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function yT(n,r){ra.M(n,r);var o=Rl;if(o&&n){var c=Vn(o).hoistableScripts,f=Ml(n),m=c.get(f);m||(m=o.querySelector(qc(f)),m||(n=k({src:n,async:!0,type:"module"},r),(r=Kr.get(f))&&vg(n,r),m=o.createElement("script"),wn(m),Us(m,"link",n),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function Eb(n,r,o,c){var f=(f=Ue.current)?Kd(f):null;if(!f)throw Error(i(446));switch(n){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(r=Il(o.href),o=Vn(f).hoistableStyles,c=o.get(r),c||(c={type:"style",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){n=Il(o.href);var m=Vn(f).hoistableStyles,x=m.get(n);if(x||(f=f.ownerDocument||f,x={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(n,x),(m=f.querySelector(Hc(n)))&&!m._p&&(x.instance=m,x.state.loading=5),Kr.has(n)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Kr.set(n,o),m||vT(f,n,o,x.state))),r&&c===null)throw Error(i(528,""));return x}if(r&&c!==null)throw Error(i(529,""));return null;case"script":return r=o.async,o=o.src,typeof o=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=Ml(o),o=Vn(f).hoistableScripts,c=o.get(r),c||(c={type:"script",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,n))}}function Il(n){return'href="'+Qn(n)+'"'}function Hc(n){return'link[rel="stylesheet"]['+n+"]"}function Tb(n){return k({},n,{"data-precedence":n.precedence,precedence:null})}function vT(n,r,o,c){n.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=n.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),Us(r,"link",o),wn(r),n.head.appendChild(r))}function Ml(n){return'[src="'+Qn(n)+'"]'}function qc(n){return"script[async]"+n}function Sb(n,r,o){if(r.count++,r.instance===null)switch(r.type){case"style":var c=n.querySelector('style[data-href~="'+Qn(o.href)+'"]');if(c)return r.instance=c,wn(c),c;var f=k({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(n.ownerDocument||n).createElement("style"),wn(c),Us(c,"style",f),Yd(c,o.precedence,n),r.instance=c;case"stylesheet":f=Il(o.href);var m=n.querySelector(Hc(f));if(m)return r.state.loading|=4,r.instance=m,wn(m),m;c=Tb(o),(f=Kr.get(f))&&yg(c,f),m=(n.ownerDocument||n).createElement("link"),wn(m);var x=m;return x._p=new Promise(function(j,z){x.onload=j,x.onerror=z}),Us(m,"link",c),r.state.loading|=4,Yd(m,o.precedence,n),r.instance=m;case"script":return m=Ml(o.src),(f=n.querySelector(qc(m)))?(r.instance=f,wn(f),f):(c=o,(f=Kr.get(m))&&(c=k({},o),vg(c,f)),n=n.ownerDocument||n,f=n.createElement("script"),wn(f),Us(f,"link",c),n.head.appendChild(f),r.instance=f);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,Yd(c,o.precedence,n));return r.instance}function Yd(n,r,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=c.length?c[c.length-1]:null,m=f,x=0;x<c.length;x++){var j=c[x];if(j.dataset.precedence===r)m=j;else if(m!==f)break}m?m.parentNode.insertBefore(n,m.nextSibling):(r=o.nodeType===9?o.head:o,r.insertBefore(n,r.firstChild))}function yg(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.title==null&&(n.title=r.title)}function vg(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.integrity==null&&(n.integrity=r.integrity)}var Qd=null;function Cb(n,r,o){if(Qd===null){var c=new Map,f=Qd=new Map;f.set(o,c)}else f=Qd,c=f.get(o),c||(c=new Map,f.set(o,c));if(c.has(n))return c;for(c.set(n,null),o=o.getElementsByTagName(n),f=0;f<o.length;f++){var m=o[f];if(!(m[js]||m[At]||n==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var x=m.getAttribute(r)||"";x=n+x;var j=c.get(x);j?j.push(m):c.set(x,[m])}}return c}function Nb(n,r,o){n=n.ownerDocument||n,n.head.insertBefore(o,r==="title"?n.querySelector("head > title"):null)}function bT(n,r,o){if(o===1||r.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;return r.rel==="stylesheet"?(n=r.disabled,typeof r.precedence=="string"&&n==null):!0;case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function Ab(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function wT(n,r,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var f=Il(c.href),m=r.querySelector(Hc(f));if(m){r=m._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(n.count++,n=Xd.bind(n),r.then(n,n)),o.state.loading|=4,o.instance=m,wn(m);return}m=r.ownerDocument||r,c=Tb(c),(f=Kr.get(f))&&yg(c,f),m=m.createElement("link"),wn(m);var x=m;x._p=new Promise(function(j,z){x.onload=j,x.onerror=z}),Us(m,"link",c),o.instance=m}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(o,r),(r=o.state.preload)&&(o.state.loading&3)===0&&(n.count++,o=Xd.bind(n),r.addEventListener("load",o),r.addEventListener("error",o))}}var bg=0;function xT(n,r){return n.stylesheets&&n.count===0&&Zd(n,n.stylesheets),0<n.count||0<n.imgCount?function(o){var c=setTimeout(function(){if(n.stylesheets&&Zd(n,n.stylesheets),n.unsuspend){var m=n.unsuspend;n.unsuspend=null,m()}},6e4+r);0<n.imgBytes&&bg===0&&(bg=62500*tT());var f=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&Zd(n,n.stylesheets),n.unsuspend)){var m=n.unsuspend;n.unsuspend=null,m()}},(n.imgBytes>bg?50:800)+r);return n.unsuspend=o,function(){n.unsuspend=null,clearTimeout(c),clearTimeout(f)}}:null}function Xd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Zd(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Jd=null;function Zd(n,r){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Jd=new Map,r.forEach(_T,n),Jd=null,Xd.call(n))}function _T(n,r){if(!(r.state.loading&4)){var o=Jd.get(n);if(o)var c=o.get(null);else{o=new Map,Jd.set(n,o);for(var f=n.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<f.length;m++){var x=f[m];(x.nodeName==="LINK"||x.getAttribute("media")!=="not all")&&(o.set(x.dataset.precedence,x),c=x)}c&&o.set(null,c)}f=r.instance,x=f.getAttribute("data-precedence"),m=o.get(x)||c,m===c&&o.set(null,f),o.set(x,f),this.count++,c=Xd.bind(this),f.addEventListener("load",c),f.addEventListener("error",c),m?m.parentNode.insertBefore(f,m.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(f,n.firstChild)),r.state.loading|=4}}var $c={$$typeof:ae,Provider:null,Consumer:null,_currentValue:He,_currentValue2:He,_threadCount:0};function kT(n,r,o,c,f,m,x,j,z){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=dn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=dn(0),this.hiddenUpdates=dn(null),this.identifierPrefix=c,this.onUncaughtError=f,this.onCaughtError=m,this.onRecoverableError=x,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=z,this.incompleteTransitions=new Map}function Rb(n,r,o,c,f,m,x,j,z,ie,we,Ee){return n=new kT(n,r,o,x,z,ie,we,Ee,j),r=1,m===!0&&(r|=24),m=Nr(3,null,null,r),n.current=m,m.stateNode=n,r=Jf(),r.refCount++,n.pooledCache=r,r.refCount++,m.memoizedState={element:c,isDehydrated:o,cache:r},nm(m),n}function Ib(n){return n?(n=ul,n):ul}function Mb(n,r,o,c,f,m){f=Ib(f),c.context===null?c.context=f:c.pendingContext=f,c=Ia(r),c.payload={element:o},m=m===void 0?null:m,m!==null&&(c.callback=m),o=Ma(n,c,r),o!==null&&(yr(o,n,r),kc(o,n,r))}function Db(n,r){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<r?o:r}}function wg(n,r){Db(n,r),(n=n.alternate)&&Db(n,r)}function Lb(n){if(n.tag===13||n.tag===31){var r=xo(n,67108864);r!==null&&yr(r,n,67108864),wg(n,67108864)}}function Pb(n){if(n.tag===13||n.tag===31){var r=Dr();r=Ke(r);var o=xo(n,r);o!==null&&yr(o,n,r),wg(n,r)}}var eh=!0;function jT(n,r,o,c){var f=J.T;J.T=null;var m=Te.p;try{Te.p=2,xg(n,r,o,c)}finally{Te.p=m,J.T=f}}function ET(n,r,o,c){var f=J.T;J.T=null;var m=Te.p;try{Te.p=8,xg(n,r,o,c)}finally{Te.p=m,J.T=f}}function xg(n,r,o,c){if(eh){var f=_g(c);if(f===null)og(n,r,c,th,o),Vb(n,c);else if(ST(f,n,r,o,c))c.stopPropagation();else if(Vb(n,c),r&4&&-1<TT.indexOf(n)){for(;f!==null;){var m=os(f);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var x=Fe(m.pendingLanes);if(x!==0){var j=m;for(j.pendingLanes|=2,j.entangledLanes|=2;x;){var z=1<<31-Mt(x);j.entanglements[1]|=z,x&=~z}Ni(m),(_n&6)===0&&(Od=gt()+500,Uc(0))}}break;case 31:case 13:j=xo(m,2),j!==null&&yr(j,m,2),Ud(),wg(m,2)}if(m=_g(c),m===null&&og(n,r,c,th,o),m===f)break;f=m}f!==null&&c.stopPropagation()}else og(n,r,c,null,o)}}function _g(n){return n=Ls(n),kg(n)}var th=null;function kg(n){if(th=null,n=Kn(n),n!==null){var r=u(n);if(r===null)n=null;else{var o=r.tag;if(o===13){if(n=d(r),n!==null)return n;n=null}else if(o===31){if(n=g(r),n!==null)return n;n=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null)}}return th=n,null}function Ob(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(_t()){case zt:return 2;case fs:return 8;case rn:case Zn:return 32;case Fn:return 268435456;default:return 32}default:return 32}}var jg=!1,qa=null,$a=null,Wa=null,Wc=new Map,Gc=new Map,Ga=[],TT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Vb(n,r){switch(n){case"focusin":case"focusout":qa=null;break;case"dragenter":case"dragleave":$a=null;break;case"mouseover":case"mouseout":Wa=null;break;case"pointerover":case"pointerout":Wc.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gc.delete(r.pointerId)}}function Kc(n,r,o,c,f,m){return n===null||n.nativeEvent!==m?(n={blockedOn:r,domEventName:o,eventSystemFlags:c,nativeEvent:m,targetContainers:[f]},r!==null&&(r=os(r),r!==null&&Lb(r)),n):(n.eventSystemFlags|=c,r=n.targetContainers,f!==null&&r.indexOf(f)===-1&&r.push(f),n)}function ST(n,r,o,c,f){switch(r){case"focusin":return qa=Kc(qa,n,r,o,c,f),!0;case"dragenter":return $a=Kc($a,n,r,o,c,f),!0;case"mouseover":return Wa=Kc(Wa,n,r,o,c,f),!0;case"pointerover":var m=f.pointerId;return Wc.set(m,Kc(Wc.get(m)||null,n,r,o,c,f)),!0;case"gotpointercapture":return m=f.pointerId,Gc.set(m,Kc(Gc.get(m)||null,n,r,o,c,f)),!0}return!1}function Ub(n){var r=Kn(n.target);if(r!==null){var o=u(r);if(o!==null){if(r=o.tag,r===13){if(r=d(o),r!==null){n.blockedOn=r,Kt(n.priority,function(){Pb(o)});return}}else if(r===31){if(r=g(o),r!==null){n.blockedOn=r,Kt(n.priority,function(){Pb(o)});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function nh(n){if(n.blockedOn!==null)return!1;for(var r=n.targetContainers;0<r.length;){var o=_g(n.nativeEvent);if(o===null){o=n.nativeEvent;var c=new o.constructor(o.type,o);Ws=c,o.target.dispatchEvent(c),Ws=null}else return r=os(o),r!==null&&Lb(r),n.blockedOn=o,!1;r.shift()}return!0}function Bb(n,r,o){nh(n)&&o.delete(r)}function CT(){jg=!1,qa!==null&&nh(qa)&&(qa=null),$a!==null&&nh($a)&&($a=null),Wa!==null&&nh(Wa)&&(Wa=null),Wc.forEach(Bb),Gc.forEach(Bb)}function sh(n,r){n.blockedOn===r&&(n.blockedOn=null,jg||(jg=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,CT)))}var rh=null;function zb(n){rh!==n&&(rh=n,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){rh===n&&(rh=null);for(var r=0;r<n.length;r+=3){var o=n[r],c=n[r+1],f=n[r+2];if(typeof c!="function"){if(kg(c||o)===null)continue;break}var m=os(o);m!==null&&(n.splice(r,3),r-=3,_m(m,{pending:!0,data:f,method:o.method,action:c},c,f))}}))}function Dl(n){function r(z){return sh(z,n)}qa!==null&&sh(qa,n),$a!==null&&sh($a,n),Wa!==null&&sh(Wa,n),Wc.forEach(r),Gc.forEach(r);for(var o=0;o<Ga.length;o++){var c=Ga[o];c.blockedOn===n&&(c.blockedOn=null)}for(;0<Ga.length&&(o=Ga[0],o.blockedOn===null);)Ub(o),o.blockedOn===null&&Ga.shift();if(o=(n.ownerDocument||n).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var f=o[c],m=o[c+1],x=f[St]||null;if(typeof m=="function")x||zb(o);else if(x){var j=null;if(m&&m.hasAttribute("formAction")){if(f=m,x=m[St]||null)j=x.formAction;else if(kg(f)!==null)continue}else j=x.action;typeof j=="function"?o[c+1]=j:(o.splice(c,3),c-=3),zb(o)}}}function Fb(){function n(m){m.canIntercept&&m.info==="react-transition"&&m.intercept({handler:function(){return new Promise(function(x){return f=x})},focusReset:"manual",scroll:"manual"})}function r(){f!==null&&(f(),f=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var m=navigation.currentEntry;m&&m.url!=null&&navigation.navigate(m.url,{state:m.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,f=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),f!==null&&(f(),f=null)}}}function Eg(n){this._internalRoot=n}ih.prototype.render=Eg.prototype.render=function(n){var r=this._internalRoot;if(r===null)throw Error(i(409));var o=r.current,c=Dr();Mb(o,c,n,r,null,null)},ih.prototype.unmount=Eg.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var r=n.containerInfo;Mb(n.current,2,null,n,null,null),Ud(),r[bn]=null}};function ih(n){this._internalRoot=n}ih.prototype.unstable_scheduleHydration=function(n){if(n){var r=rt();n={blockedOn:null,target:n,priority:r};for(var o=0;o<Ga.length&&r!==0&&r<Ga[o].priority;o++);Ga.splice(o,0,n),o===0&&Ub(n)}};var Hb=e.version;if(Hb!=="19.2.4")throw Error(i(527,Hb,"19.2.4"));Te.findDOMNode=function(n){var r=n._reactInternals;if(r===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=p(r),n=n!==null?b(n):null,n=n===null?null:n.stateNode,n};var NT={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:J,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ah=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ah.isDisabled&&ah.supportsFiber)try{un=ah.inject(NT),Gt=ah}catch{}}return Qc.createRoot=function(n,r){if(!l(n))throw Error(i(299));var o=!1,c="",f=Qv,m=Xv,x=Jv;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(f=r.onUncaughtError),r.onCaughtError!==void 0&&(m=r.onCaughtError),r.onRecoverableError!==void 0&&(x=r.onRecoverableError)),r=Rb(n,1,!1,null,null,o,c,null,f,m,x,Fb),n[bn]=r.current,ag(n),new Eg(r)},Qc.hydrateRoot=function(n,r,o){if(!l(n))throw Error(i(299));var c=!1,f="",m=Qv,x=Xv,j=Jv,z=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(m=o.onUncaughtError),o.onCaughtError!==void 0&&(x=o.onCaughtError),o.onRecoverableError!==void 0&&(j=o.onRecoverableError),o.formState!==void 0&&(z=o.formState)),r=Rb(n,1,!0,r,o??null,c,f,z,m,x,j,Fb),r.context=Ib(null),o=r.current,c=Dr(),c=Ke(c),f=Ia(c),f.callback=null,Ma(o,f,c),o=c,r.current.lanes=o,hn(r,o),Ni(r),n[bn]=r.current,ag(n),new ih(r)},Qc.version="19.2.4",Qc}var Zb;function UT(){if(Zb)return Cg.exports;Zb=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Cg.exports=VT(),Cg.exports}var BT=UT();const zT="modulepreload",FT=function(s){return"/login/"+s},e2={},Zs=function(e,t,i){let l=Promise.resolve();if(t&&t.length>0){let y=function(p){return Promise.all(p.map(b=>Promise.resolve(b).then(k=>({status:"fulfilled",value:k}),k=>({status:"rejected",reason:k}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),g=d?.nonce||d?.getAttribute("nonce");l=y(t.map(p=>{if(p=FT(p),p in e2)return;e2[p]=!0;const b=p.endsWith(".css"),k=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${k}`))return;const E=document.createElement("link");if(E.rel=b?"stylesheet":zT,b||(E.as="script"),E.crossOrigin="",E.href=p,g&&E.setAttribute("nonce",g),document.head.appendChild(E),b)return new Promise((M,H)=>{E.addEventListener("load",M),E.addEventListener("error",()=>H(new Error(`Unable to preload CSS for ${p}`)))})}))}function u(d){const g=new Event("vite:preloadError",{cancelable:!0});if(g.payload=d,window.dispatchEvent(g),!g.defaultPrevented)throw d}return l.then(d=>{for(const g of d||[])g.status==="rejected"&&u(g.reason);return e().catch(u)})};var t2="popstate";function HT(s={}){function e(i,l){let{pathname:u,search:d,hash:g}=i.location;return pp("",{pathname:u,search:d,hash:g},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function t(i,l){return typeof l=="string"?l:wu(l)}return $T(e,t,null,s)}function Gn(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function Zr(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function qT(){return Math.random().toString(36).substring(2,10)}function n2(s,e){return{usr:s.state,key:s.key,idx:e}}function pp(s,e,t=null,i){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?tc(e):e,state:t,key:e&&e.key||i||qT()}}function wu({pathname:s="/",search:e="",hash:t=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(s+=t.charAt(0)==="#"?t:"#"+t),s}function tc(s){let e={};if(s){let t=s.indexOf("#");t>=0&&(e.hash=s.substring(t),s=s.substring(0,t));let i=s.indexOf("?");i>=0&&(e.search=s.substring(i),s=s.substring(0,i)),s&&(e.pathname=s)}return e}function $T(s,e,t,i={}){let{window:l=document.defaultView,v5Compat:u=!1}=i,d=l.history,g="POP",y=null,p=b();p==null&&(p=0,d.replaceState({...d.state,idx:p},""));function b(){return(d.state||{idx:null}).idx}function k(){g="POP";let B=b(),Y=B==null?null:B-p;p=B,y&&y({action:g,location:K.location,delta:Y})}function E(B,Y){g="PUSH";let ee=pp(K.location,B,Y);p=b()+1;let ae=n2(ee,p),ye=K.createHref(ee);try{d.pushState(ae,"",ye)}catch(ve){if(ve instanceof DOMException&&ve.name==="DataCloneError")throw ve;l.location.assign(ye)}u&&y&&y({action:g,location:K.location,delta:1})}function M(B,Y){g="REPLACE";let ee=pp(K.location,B,Y);p=b();let ae=n2(ee,p),ye=K.createHref(ee);d.replaceState(ae,"",ye),u&&y&&y({action:g,location:K.location,delta:0})}function H(B){return WT(B)}let K={get action(){return g},get location(){return s(l,d)},listen(B){if(y)throw new Error("A history only accepts one active listener");return l.addEventListener(t2,k),y=B,()=>{l.removeEventListener(t2,k),y=null}},createHref(B){return e(l,B)},createURL:H,encodeLocation(B){let Y=H(B);return{pathname:Y.pathname,search:Y.search,hash:Y.hash}},push:E,replace:M,go(B){return d.go(B)}};return K}function WT(s,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Gn(t,"No window.location.(origin|href) available to create URL");let i=typeof s=="string"?s:wu(s);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function yx(s,e,t="/"){return GT(s,e,t,!1)}function GT(s,e,t,i){let l=typeof e=="string"?tc(e):e,u=ga(l.pathname||"/",t);if(u==null)return null;let d=vx(s);KT(d);let g=null;for(let y=0;g==null&&y<d.length;++y){let p=iS(u);g=sS(d[y],p,i)}return g}function vx(s,e=[],t=[],i="",l=!1){let u=(d,g,y=l,p)=>{let b={relativePath:p===void 0?d.path||"":p,caseSensitive:d.caseSensitive===!0,childrenIndex:g,route:d};if(b.relativePath.startsWith("/")){if(!b.relativePath.startsWith(i)&&y)return;Gn(b.relativePath.startsWith(i),`Absolute route path "${b.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),b.relativePath=b.relativePath.slice(i.length)}let k=da([i,b.relativePath]),E=t.concat(b);d.children&&d.children.length>0&&(Gn(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${k}".`),vx(d.children,e,E,k,y)),!(d.path==null&&!d.index)&&e.push({path:k,score:tS(k,d.index),routesMeta:E})};return s.forEach((d,g)=>{if(d.path===""||!d.path?.includes("?"))u(d,g);else for(let y of bx(d.path))u(d,g,!0,y)}),e}function bx(s){let e=s.split("/");if(e.length===0)return[];let[t,...i]=e,l=t.endsWith("?"),u=t.replace(/\?$/,"");if(i.length===0)return l?[u,""]:[u];let d=bx(i.join("/")),g=[];return g.push(...d.map(y=>y===""?u:[u,y].join("/"))),l&&g.push(...d),g.map(y=>s.startsWith("/")&&y===""?"/":y)}function KT(s){s.sort((e,t)=>e.score!==t.score?t.score-e.score:nS(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var YT=/^:[\w-]+$/,QT=3,XT=2,JT=1,ZT=10,eS=-2,s2=s=>s==="*";function tS(s,e){let t=s.split("/"),i=t.length;return t.some(s2)&&(i+=eS),e&&(i+=XT),t.filter(l=>!s2(l)).reduce((l,u)=>l+(YT.test(u)?QT:u===""?JT:ZT),i)}function nS(s,e){return s.length===e.length&&s.slice(0,-1).every((i,l)=>i===e[l])?s[s.length-1]-e[e.length-1]:0}function sS(s,e,t=!1){let{routesMeta:i}=s,l={},u="/",d=[];for(let g=0;g<i.length;++g){let y=i[g],p=g===i.length-1,b=u==="/"?e:e.slice(u.length)||"/",k=Dh({path:y.relativePath,caseSensitive:y.caseSensitive,end:p},b),E=y.route;if(!k&&p&&t&&!i[i.length-1].route.index&&(k=Dh({path:y.relativePath,caseSensitive:y.caseSensitive,end:!1},b)),!k)return null;Object.assign(l,k.params),d.push({params:l,pathname:da([u,k.pathname]),pathnameBase:cS(da([u,k.pathnameBase])),route:E}),k.pathnameBase!=="/"&&(u=da([u,k.pathnameBase]))}return d}function Dh(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[t,i]=rS(s.path,s.caseSensitive,s.end),l=e.match(t);if(!l)return null;let u=l[0],d=u.replace(/(.)\/+$/,"$1"),g=l.slice(1);return{params:i.reduce((p,{paramName:b,isOptional:k},E)=>{if(b==="*"){let H=g[E]||"";d=u.slice(0,u.length-H.length).replace(/(.)\/+$/,"$1")}const M=g[E];return k&&!M?p[b]=void 0:p[b]=(M||"").replace(/%2F/g,"/"),p},{}),pathname:u,pathnameBase:d,pattern:s}}function rS(s,e=!1,t=!0){Zr(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let i=[],l="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,g,y)=>(i.push({paramName:g,isOptional:y!=null}),y?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(i.push({paramName:"*"}),l+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?l+="\\/*$":s!==""&&s!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,e?void 0:"i"),i]}function iS(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Zr(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function ga(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=s.charAt(t);return i&&i!=="/"?null:s.slice(t)||"/"}var aS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function oS(s,e="/"){let{pathname:t,search:i="",hash:l=""}=typeof s=="string"?tc(s):s,u;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?u=r2(t.substring(1),"/"):u=r2(t,e)):u=e,{pathname:u,search:uS(i),hash:dS(l)}}function r2(s,e){let t=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(l=>{l===".."?t.length>1&&t.pop():l!=="."&&t.push(l)}),t.length>1?t.join("/"):"/"}function Ig(s,e,t,i){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function lS(s){return s.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Jp(s){let e=lS(s);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function Zp(s,e,t,i=!1){let l;typeof s=="string"?l=tc(s):(l={...s},Gn(!l.pathname||!l.pathname.includes("?"),Ig("?","pathname","search",l)),Gn(!l.pathname||!l.pathname.includes("#"),Ig("#","pathname","hash",l)),Gn(!l.search||!l.search.includes("#"),Ig("#","search","hash",l)));let u=s===""||l.pathname==="",d=u?"/":l.pathname,g;if(d==null)g=t;else{let k=e.length-1;if(!i&&d.startsWith("..")){let E=d.split("/");for(;E[0]==="..";)E.shift(),k-=1;l.pathname=E.join("/")}g=k>=0?e[k]:"/"}let y=oS(l,g),p=d&&d!=="/"&&d.endsWith("/"),b=(u||d===".")&&t.endsWith("/");return!y.pathname.endsWith("/")&&(p||b)&&(y.pathname+="/"),y}var da=s=>s.join("/").replace(/\/\/+/g,"/"),cS=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),uS=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,dS=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s,hS=class{constructor(s,e,t,i=!1){this.status=s,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function fS(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}function mS(s){return s.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var wx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function xx(s,e){let t=s;if(typeof t!="string"||!aS.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,l=!1;if(wx)try{let u=new URL(window.location.href),d=t.startsWith("//")?new URL(u.protocol+t):new URL(t),g=ga(d.pathname,e);d.origin===u.origin&&g!=null?t=g+d.search+d.hash:l=!0}catch{Zr(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:l,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var _x=["POST","PUT","PATCH","DELETE"];new Set(_x);var gS=["GET",..._x];new Set(gS);var nc=w.createContext(null);nc.displayName="DataRouter";var nf=w.createContext(null);nf.displayName="DataRouterState";var pS=w.createContext(!1),kx=w.createContext({isTransitioning:!1});kx.displayName="ViewTransition";var yS=w.createContext(new Map);yS.displayName="Fetchers";var vS=w.createContext(null);vS.displayName="Await";var Pr=w.createContext(null);Pr.displayName="Navigation";var Mu=w.createContext(null);Mu.displayName="Location";var bi=w.createContext({outlet:null,matches:[],isDataRoute:!1});bi.displayName="Route";var ey=w.createContext(null);ey.displayName="RouteError";var jx="REACT_ROUTER_ERROR",bS="REDIRECT",wS="ROUTE_ERROR_RESPONSE";function xS(s){if(s.startsWith(`${jx}:${bS}:{`))try{let e=JSON.parse(s.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function _S(s){if(s.startsWith(`${jx}:${wS}:{`))try{let e=JSON.parse(s.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new hS(e.status,e.statusText,e.data)}catch{}}function kS(s,{relative:e}={}){Gn(sc(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=w.useContext(Pr),{hash:l,pathname:u,search:d}=Du(s,{relative:e}),g=u;return t!=="/"&&(g=u==="/"?t:da([t,u])),i.createHref({pathname:g,search:d,hash:l})}function sc(){return w.useContext(Mu)!=null}function Ui(){return Gn(sc(),"useLocation() may be used only in the context of a <Router> component."),w.useContext(Mu).location}var Ex="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Tx(s){w.useContext(Pr).static||w.useLayoutEffect(s)}function Hs(){let{isDataRoute:s}=w.useContext(bi);return s?OS():jS()}function jS(){Gn(sc(),"useNavigate() may be used only in the context of a <Router> component.");let s=w.useContext(nc),{basename:e,navigator:t}=w.useContext(Pr),{matches:i}=w.useContext(bi),{pathname:l}=Ui(),u=JSON.stringify(Jp(i)),d=w.useRef(!1);return Tx(()=>{d.current=!0}),w.useCallback((y,p={})=>{if(Zr(d.current,Ex),!d.current)return;if(typeof y=="number"){t.go(y);return}let b=Zp(y,JSON.parse(u),l,p.relative==="path");s==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:da([e,b.pathname])),(p.replace?t.replace:t.push)(b,p.state,p)},[e,t,u,l,s])}w.createContext(null);function ES(){let{matches:s}=w.useContext(bi),e=s[s.length-1];return e?e.params:{}}function Du(s,{relative:e}={}){let{matches:t}=w.useContext(bi),{pathname:i}=Ui(),l=JSON.stringify(Jp(t));return w.useMemo(()=>Zp(s,JSON.parse(l),i,e==="path"),[s,l,i,e])}function TS(s,e){return Sx(s,e)}function Sx(s,e,t,i,l){Gn(sc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=w.useContext(Pr),{matches:d}=w.useContext(bi),g=d[d.length-1],y=g?g.params:{},p=g?g.pathname:"/",b=g?g.pathnameBase:"/",k=g&&g.route;{let ee=k&&k.path||"";Nx(p,!k||ee.endsWith("*")||ee.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${p}" (under <Route path="${ee}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${ee}"> to <Route path="${ee==="/"?"*":`${ee}/*`}">.`)}let E=Ui(),M;if(e){let ee=typeof e=="string"?tc(e):e;Gn(b==="/"||ee.pathname?.startsWith(b),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${b}" but pathname "${ee.pathname}" was given in the \`location\` prop.`),M=ee}else M=E;let H=M.pathname||"/",K=H;if(b!=="/"){let ee=b.replace(/^\//,"").split("/");K="/"+H.replace(/^\//,"").split("/").slice(ee.length).join("/")}let B=yx(s,{pathname:K});Zr(k||B!=null,`No routes matched location "${M.pathname}${M.search}${M.hash}" `),Zr(B==null||B[B.length-1].route.element!==void 0||B[B.length-1].route.Component!==void 0||B[B.length-1].route.lazy!==void 0,`Matched leaf route at location "${M.pathname}${M.search}${M.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let Y=RS(B&&B.map(ee=>Object.assign({},ee,{params:Object.assign({},y,ee.params),pathname:da([b,u.encodeLocation?u.encodeLocation(ee.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:ee.pathname]),pathnameBase:ee.pathnameBase==="/"?b:da([b,u.encodeLocation?u.encodeLocation(ee.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:ee.pathnameBase])})),d,t,i,l);return e&&Y?w.createElement(Mu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...M},navigationType:"POP"}},Y):Y}function SS(){let s=PS(),e=fS(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),t=s instanceof Error?s.stack:null,i="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},d=null;return console.error("Error handled by React Router default ErrorBoundary:",s),d=w.createElement(w.Fragment,null,w.createElement("p",null," Hey developer "),w.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",w.createElement("code",{style:u},"ErrorBoundary")," or"," ",w.createElement("code",{style:u},"errorElement")," prop on your route.")),w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},e),t?w.createElement("pre",{style:l},t):null,d)}var CS=w.createElement(SS,null),Cx=class extends w.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){this.props.onError?this.props.onError(s,e):console.error("React Router caught the following error during render",s)}render(){let s=this.state.error;if(this.context&&typeof s=="object"&&s&&"digest"in s&&typeof s.digest=="string"){const t=_S(s.digest);t&&(s=t)}let e=s!==void 0?w.createElement(bi.Provider,{value:this.props.routeContext},w.createElement(ey.Provider,{value:s,children:this.props.component})):this.props.children;return this.context?w.createElement(NS,{error:s},e):e}};Cx.contextType=pS;var Mg=new WeakMap;function NS({children:s,error:e}){let{basename:t}=w.useContext(Pr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=xS(e.digest);if(i){let l=Mg.get(e);if(l)throw l;let u=xx(i.location,t);if(wx&&!Mg.get(e))if(u.isExternal||i.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:i.replace}));throw Mg.set(e,d),d}return w.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return s}function AS({routeContext:s,match:e,children:t}){let i=w.useContext(nc);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),w.createElement(bi.Provider,{value:s},t)}function RS(s,e=[],t=null,i=null,l=null){if(s==null){if(!t)return null;if(t.errors)s=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)s=t.matches;else return null}let u=s,d=t?.errors;if(d!=null){let b=u.findIndex(k=>k.route.id&&d?.[k.route.id]!==void 0);Gn(b>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),u=u.slice(0,Math.min(u.length,b+1))}let g=!1,y=-1;if(t)for(let b=0;b<u.length;b++){let k=u[b];if((k.route.HydrateFallback||k.route.hydrateFallbackElement)&&(y=b),k.route.id){let{loaderData:E,errors:M}=t,H=k.route.loader&&!E.hasOwnProperty(k.route.id)&&(!M||M[k.route.id]===void 0);if(k.route.lazy||H){g=!0,y>=0?u=u.slice(0,y+1):u=[u[0]];break}}}let p=t&&i?(b,k)=>{i(b,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:mS(t.matches),errorInfo:k})}:void 0;return u.reduceRight((b,k,E)=>{let M,H=!1,K=null,B=null;t&&(M=d&&k.route.id?d[k.route.id]:void 0,K=k.route.errorElement||CS,g&&(y<0&&E===0?(Nx("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),H=!0,B=null):y===E&&(H=!0,B=k.route.hydrateFallbackElement||null)));let Y=e.concat(u.slice(0,E+1)),ee=()=>{let ae;return M?ae=K:H?ae=B:k.route.Component?ae=w.createElement(k.route.Component,null):k.route.element?ae=k.route.element:ae=b,w.createElement(AS,{match:k,routeContext:{outlet:b,matches:Y,isDataRoute:t!=null},children:ae})};return t&&(k.route.ErrorBoundary||k.route.errorElement||E===0)?w.createElement(Cx,{location:t.location,revalidation:t.revalidation,component:K,error:M,children:ee(),routeContext:{outlet:null,matches:Y,isDataRoute:!0},onError:p}):ee()},null)}function ty(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function IS(s){let e=w.useContext(nc);return Gn(e,ty(s)),e}function MS(s){let e=w.useContext(nf);return Gn(e,ty(s)),e}function DS(s){let e=w.useContext(bi);return Gn(e,ty(s)),e}function ny(s){let e=DS(s),t=e.matches[e.matches.length-1];return Gn(t.route.id,`${s} can only be used on routes that contain a unique "id"`),t.route.id}function LS(){return ny("useRouteId")}function PS(){let s=w.useContext(ey),e=MS("useRouteError"),t=ny("useRouteError");return s!==void 0?s:e.errors?.[t]}function OS(){let{router:s}=IS("useNavigate"),e=ny("useNavigate"),t=w.useRef(!1);return Tx(()=>{t.current=!0}),w.useCallback(async(l,u={})=>{Zr(t.current,Ex),t.current&&(typeof l=="number"?await s.navigate(l):await s.navigate(l,{fromRouteId:e,...u}))},[s,e])}var i2={};function Nx(s,e,t){!e&&!i2[s]&&(i2[s]=!0,Zr(!1,t))}w.memo(VS);function VS({routes:s,future:e,state:t,onError:i}){return Sx(s,void 0,t,i,e)}function Ax({to:s,replace:e,state:t,relative:i}){Gn(sc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=w.useContext(Pr);Zr(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=w.useContext(bi),{pathname:d}=Ui(),g=Hs(),y=Zp(s,Jp(u),d,i==="path"),p=JSON.stringify(y);return w.useEffect(()=>{g(JSON.parse(p),{replace:e,state:t,relative:i})},[g,p,i,e,t]),null}function Sn(s){Gn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function US({basename:s="/",children:e=null,location:t,navigationType:i="POP",navigator:l,static:u=!1,unstable_useTransitions:d}){Gn(!sc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let g=s.replace(/^\/*/,"/"),y=w.useMemo(()=>({basename:g,navigator:l,static:u,unstable_useTransitions:d,future:{}}),[g,l,u,d]);typeof t=="string"&&(t=tc(t));let{pathname:p="/",search:b="",hash:k="",state:E=null,key:M="default"}=t,H=w.useMemo(()=>{let K=ga(p,g);return K==null?null:{location:{pathname:K,search:b,hash:k,state:E,key:M},navigationType:i}},[g,p,b,k,E,M,i]);return Zr(H!=null,`<Router basename="${g}"> is not able to match the URL "${p}${b}${k}" because it does not start with the basename, so the <Router> won't render anything.`),H==null?null:w.createElement(Pr.Provider,{value:y},w.createElement(Mu.Provider,{children:e,value:H}))}function BS({children:s,location:e}){return TS(yp(s),e)}function yp(s,e=[]){let t=[];return w.Children.forEach(s,(i,l)=>{if(!w.isValidElement(i))return;let u=[...e,l];if(i.type===w.Fragment){t.push.apply(t,yp(i.props.children,u));return}Gn(i.type===Sn,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Gn(!i.props.index||!i.props.children,"An index route cannot have child routes.");let d={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=yp(i.props.children,u)),t.push(d)}),t}var _h="get",kh="application/x-www-form-urlencoded";function sf(s){return typeof HTMLElement<"u"&&s instanceof HTMLElement}function zS(s){return sf(s)&&s.tagName.toLowerCase()==="button"}function FS(s){return sf(s)&&s.tagName.toLowerCase()==="form"}function HS(s){return sf(s)&&s.tagName.toLowerCase()==="input"}function qS(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function $S(s,e){return s.button===0&&(!e||e==="_self")&&!qS(s)}function vp(s=""){return new URLSearchParams(typeof s=="string"||Array.isArray(s)||s instanceof URLSearchParams?s:Object.keys(s).reduce((e,t)=>{let i=s[t];return e.concat(Array.isArray(i)?i.map(l=>[t,l]):[[t,i]])},[]))}function WS(s,e){let t=vp(s);return e&&e.forEach((i,l)=>{t.has(l)||e.getAll(l).forEach(u=>{t.append(l,u)})}),t}var oh=null;function GS(){if(oh===null)try{new FormData(document.createElement("form"),0),oh=!1}catch{oh=!0}return oh}var KS=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Dg(s){return s!=null&&!KS.has(s)?(Zr(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${kh}"`),null):s}function YS(s,e){let t,i,l,u,d;if(FS(s)){let g=s.getAttribute("action");i=g?ga(g,e):null,t=s.getAttribute("method")||_h,l=Dg(s.getAttribute("enctype"))||kh,u=new FormData(s)}else if(zS(s)||HS(s)&&(s.type==="submit"||s.type==="image")){let g=s.form;if(g==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let y=s.getAttribute("formaction")||g.getAttribute("action");if(i=y?ga(y,e):null,t=s.getAttribute("formmethod")||g.getAttribute("method")||_h,l=Dg(s.getAttribute("formenctype"))||Dg(g.getAttribute("enctype"))||kh,u=new FormData(g,s),!GS()){let{name:p,type:b,value:k}=s;if(b==="image"){let E=p?`${p}.`:"";u.append(`${E}x`,"0"),u.append(`${E}y`,"0")}else p&&u.append(p,k)}}else{if(sf(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=_h,i=null,l=kh,d=s}return u&&l==="text/plain"&&(d=u,u=void 0),{action:i,method:t.toLowerCase(),encType:l,formData:u,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function sy(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function QS(s,e,t,i){let l=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return t?l.pathname.endsWith("/")?l.pathname=`${l.pathname}_.${i}`:l.pathname=`${l.pathname}.${i}`:l.pathname==="/"?l.pathname=`_root.${i}`:e&&ga(l.pathname,e)==="/"?l.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${i}`,l}async function XS(s,e){if(s.id in e)return e[s.id];try{let t=await import(s.module);return e[s.id]=t,t}catch(t){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function JS(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function ZS(s,e,t){let i=await Promise.all(s.map(async l=>{let u=e.routes[l.route.id];if(u){let d=await XS(u,t);return d.links?d.links():[]}return[]}));return sC(i.flat(1).filter(JS).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function a2(s,e,t,i,l,u){let d=(y,p)=>t[p]?y.route.id!==t[p].route.id:!0,g=(y,p)=>t[p].pathname!==y.pathname||t[p].route.path?.endsWith("*")&&t[p].params["*"]!==y.params["*"];return u==="assets"?e.filter((y,p)=>d(y,p)||g(y,p)):u==="data"?e.filter((y,p)=>{let b=i.routes[y.route.id];if(!b||!b.hasLoader)return!1;if(d(y,p)||g(y,p))return!0;if(y.route.shouldRevalidate){let k=y.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(s,window.origin),nextParams:y.params,defaultShouldRevalidate:!0});if(typeof k=="boolean")return k}return!0}):[]}function eC(s,e,{includeHydrateFallback:t}={}){return tC(s.map(i=>{let l=e.routes[i.route.id];if(!l)return[];let u=[l.module];return l.clientActionModule&&(u=u.concat(l.clientActionModule)),l.clientLoaderModule&&(u=u.concat(l.clientLoaderModule)),t&&l.hydrateFallbackModule&&(u=u.concat(l.hydrateFallbackModule)),l.imports&&(u=u.concat(l.imports)),u}).flat(1))}function tC(s){return[...new Set(s)]}function nC(s){let e={},t=Object.keys(s).sort();for(let i of t)e[i]=s[i];return e}function sC(s,e){let t=new Set;return new Set(e),s.reduce((i,l)=>{let u=JSON.stringify(nC(l));return t.has(u)||(t.add(u),i.push({key:u,link:l})),i},[])}function Rx(){let s=w.useContext(nc);return sy(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function rC(){let s=w.useContext(nf);return sy(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var ry=w.createContext(void 0);ry.displayName="FrameworkContext";function Ix(){let s=w.useContext(ry);return sy(s,"You must render this element inside a <HydratedRouter> element"),s}function iC(s,e){let t=w.useContext(ry),[i,l]=w.useState(!1),[u,d]=w.useState(!1),{onFocus:g,onBlur:y,onMouseEnter:p,onMouseLeave:b,onTouchStart:k}=e,E=w.useRef(null);w.useEffect(()=>{if(s==="render"&&d(!0),s==="viewport"){let K=Y=>{Y.forEach(ee=>{d(ee.isIntersecting)})},B=new IntersectionObserver(K,{threshold:.5});return E.current&&B.observe(E.current),()=>{B.disconnect()}}},[s]),w.useEffect(()=>{if(i){let K=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(K)}}},[i]);let M=()=>{l(!0)},H=()=>{l(!1),d(!1)};return t?s!=="intent"?[u,E,{}]:[u,E,{onFocus:Xc(g,M),onBlur:Xc(y,H),onMouseEnter:Xc(p,M),onMouseLeave:Xc(b,H),onTouchStart:Xc(k,M)}]:[!1,E,{}]}function Xc(s,e){return t=>{s&&s(t),t.defaultPrevented||e(t)}}function aC({page:s,...e}){let{router:t}=Rx(),i=w.useMemo(()=>yx(t.routes,s,t.basename),[t.routes,s,t.basename]);return i?w.createElement(lC,{page:s,matches:i,...e}):null}function oC(s){let{manifest:e,routeModules:t}=Ix(),[i,l]=w.useState([]);return w.useEffect(()=>{let u=!1;return ZS(s,e,t).then(d=>{u||l(d)}),()=>{u=!0}},[s,e,t]),i}function lC({page:s,matches:e,...t}){let i=Ui(),{future:l,manifest:u,routeModules:d}=Ix(),{basename:g}=Rx(),{loaderData:y,matches:p}=rC(),b=w.useMemo(()=>a2(s,e,p,u,i,"data"),[s,e,p,u,i]),k=w.useMemo(()=>a2(s,e,p,u,i,"assets"),[s,e,p,u,i]),E=w.useMemo(()=>{if(s===i.pathname+i.search+i.hash)return[];let K=new Set,B=!1;if(e.forEach(ee=>{let ae=u.routes[ee.route.id];!ae||!ae.hasLoader||(!b.some(ye=>ye.route.id===ee.route.id)&&ee.route.id in y&&d[ee.route.id]?.shouldRevalidate||ae.hasClientLoader?B=!0:K.add(ee.route.id))}),K.size===0)return[];let Y=QS(s,g,l.unstable_trailingSlashAwareDataRequests,"data");return B&&K.size>0&&Y.searchParams.set("_routes",e.filter(ee=>K.has(ee.route.id)).map(ee=>ee.route.id).join(",")),[Y.pathname+Y.search]},[g,l.unstable_trailingSlashAwareDataRequests,y,i,u,b,e,s,d]),M=w.useMemo(()=>eC(k,u),[k,u]),H=oC(k);return w.createElement(w.Fragment,null,E.map(K=>w.createElement("link",{key:K,rel:"prefetch",as:"fetch",href:K,...t})),M.map(K=>w.createElement("link",{key:K,rel:"modulepreload",href:K,...t})),H.map(({key:K,link:B})=>w.createElement("link",{key:K,nonce:t.nonce,...B,crossOrigin:B.crossOrigin??t.crossOrigin})))}function cC(...s){return e=>{s.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var uC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{uC&&(window.__reactRouterVersion="7.13.0")}catch{}function dC({basename:s,children:e,unstable_useTransitions:t,window:i}){let l=w.useRef();l.current==null&&(l.current=HT({window:i,v5Compat:!0}));let u=l.current,[d,g]=w.useState({action:u.action,location:u.location}),y=w.useCallback(p=>{t===!1?g(p):w.startTransition(()=>g(p))},[t]);return w.useLayoutEffect(()=>u.listen(y),[u,y]),w.createElement(US,{basename:s,children:e,location:d.location,navigationType:d.action,navigator:u,unstable_useTransitions:t})}var Mx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Dx=w.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:l,reloadDocument:u,replace:d,state:g,target:y,to:p,preventScrollReset:b,viewTransition:k,unstable_defaultShouldRevalidate:E,...M},H){let{basename:K,unstable_useTransitions:B}=w.useContext(Pr),Y=typeof p=="string"&&Mx.test(p),ee=xx(p,K);p=ee.to;let ae=kS(p,{relative:l}),[ye,ve,he]=iC(i,M),D=gC(p,{replace:d,state:g,target:y,preventScrollReset:b,relative:l,viewTransition:k,unstable_defaultShouldRevalidate:E,unstable_useTransitions:B});function T(U){e&&e(U),U.defaultPrevented||D(U)}let I=w.createElement("a",{...M,...he,href:ee.absoluteURL||ae,onClick:ee.isExternal||u?e:T,ref:cC(H,ve),target:y,"data-discover":!Y&&t==="render"?"true":void 0});return ye&&!Y?w.createElement(w.Fragment,null,I,w.createElement(aC,{page:ae})):I});Dx.displayName="Link";var hC=w.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:l=!1,style:u,to:d,viewTransition:g,children:y,...p},b){let k=Du(d,{relative:p.relative}),E=Ui(),M=w.useContext(nf),{navigator:H,basename:K}=w.useContext(Pr),B=M!=null&&xC(k)&&g===!0,Y=H.encodeLocation?H.encodeLocation(k).pathname:k.pathname,ee=E.pathname,ae=M&&M.navigation&&M.navigation.location?M.navigation.location.pathname:null;t||(ee=ee.toLowerCase(),ae=ae?ae.toLowerCase():null,Y=Y.toLowerCase()),ae&&K&&(ae=ga(ae,K)||ae);const ye=Y!=="/"&&Y.endsWith("/")?Y.length-1:Y.length;let ve=ee===Y||!l&&ee.startsWith(Y)&&ee.charAt(ye)==="/",he=ae!=null&&(ae===Y||!l&&ae.startsWith(Y)&&ae.charAt(Y.length)==="/"),D={isActive:ve,isPending:he,isTransitioning:B},T=ve?e:void 0,I;typeof i=="function"?I=i(D):I=[i,ve?"active":null,he?"pending":null,B?"transitioning":null].filter(Boolean).join(" ");let U=typeof u=="function"?u(D):u;return w.createElement(Dx,{...p,"aria-current":T,className:I,ref:b,style:U,to:d,viewTransition:g},typeof y=="function"?y(D):y)});hC.displayName="NavLink";var fC=w.forwardRef(({discover:s="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:l,state:u,method:d=_h,action:g,onSubmit:y,relative:p,preventScrollReset:b,viewTransition:k,unstable_defaultShouldRevalidate:E,...M},H)=>{let{unstable_useTransitions:K}=w.useContext(Pr),B=bC(),Y=wC(g,{relative:p}),ee=d.toLowerCase()==="get"?"get":"post",ae=typeof g=="string"&&Mx.test(g),ye=ve=>{if(y&&y(ve),ve.defaultPrevented)return;ve.preventDefault();let he=ve.nativeEvent.submitter,D=he?.getAttribute("formmethod")||d,T=()=>B(he||ve.currentTarget,{fetcherKey:e,method:D,navigate:t,replace:l,state:u,relative:p,preventScrollReset:b,viewTransition:k,unstable_defaultShouldRevalidate:E});K&&t!==!1?w.startTransition(()=>T()):T()};return w.createElement("form",{ref:H,method:ee,action:Y,onSubmit:i?y:ye,...M,"data-discover":!ae&&s==="render"?"true":void 0})});fC.displayName="Form";function mC(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Lx(s){let e=w.useContext(nc);return Gn(e,mC(s)),e}function gC(s,{target:e,replace:t,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:g,unstable_useTransitions:y}={}){let p=Hs(),b=Ui(),k=Du(s,{relative:u});return w.useCallback(E=>{if($S(E,e)){E.preventDefault();let M=t!==void 0?t:wu(b)===wu(k),H=()=>p(s,{replace:M,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:g});y?w.startTransition(()=>H()):H()}},[b,p,k,t,i,e,s,l,u,d,g,y])}function pC(s){Zr(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=w.useRef(vp(s)),t=w.useRef(!1),i=Ui(),l=w.useMemo(()=>WS(i.search,t.current?null:e.current),[i.search]),u=Hs(),d=w.useCallback((g,y)=>{const p=vp(typeof g=="function"?g(new URLSearchParams(l)):g);t.current=!0,u("?"+p,y)},[u,l]);return[l,d]}var yC=0,vC=()=>`__${String(++yC)}__`;function bC(){let{router:s}=Lx("useSubmit"),{basename:e}=w.useContext(Pr),t=LS(),i=s.fetch,l=s.navigate;return w.useCallback(async(u,d={})=>{let{action:g,method:y,encType:p,formData:b,body:k}=YS(u,e);if(d.navigate===!1){let E=d.fetcherKey||vC();await i(E,t,d.action||g,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:b,body:k,formMethod:d.method||y,formEncType:d.encType||p,flushSync:d.flushSync})}else await l(d.action||g,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:b,body:k,formMethod:d.method||y,formEncType:d.encType||p,replace:d.replace,state:d.state,fromRouteId:t,flushSync:d.flushSync,viewTransition:d.viewTransition})},[i,l,e,t])}function wC(s,{relative:e}={}){let{basename:t}=w.useContext(Pr),i=w.useContext(bi);Gn(i,"useFormAction must be used inside a RouteContext");let[l]=i.matches.slice(-1),u={...Du(s||".",{relative:e})},d=Ui();if(s==null){u.search=d.search;let g=new URLSearchParams(u.search),y=g.getAll("index");if(y.some(b=>b==="")){g.delete("index"),y.filter(k=>k).forEach(k=>g.append("index",k));let b=g.toString();u.search=b?`?${b}`:""}}return(!s||s===".")&&l.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(u.pathname=u.pathname==="/"?t:da([t,u.pathname])),wu(u)}function xC(s,{relative:e}={}){let t=w.useContext(kx);Gn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Lx("useViewTransitionState"),l=Du(s,{relative:e});if(!t.isTransitioning)return!1;let u=ga(t.currentLocation.pathname,i)||t.currentLocation.pathname,d=ga(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Dh(l.pathname,d)!=null||Dh(l.pathname,u)!=null}const _C=()=>{};var o2={};const Px=function(s){const e=[];let t=0;for(let i=0;i<s.length;i++){let l=s.charCodeAt(i);l<128?e[t++]=l:l<2048?(e[t++]=l>>6|192,e[t++]=l&63|128):(l&64512)===55296&&i+1<s.length&&(s.charCodeAt(i+1)&64512)===56320?(l=65536+((l&1023)<<10)+(s.charCodeAt(++i)&1023),e[t++]=l>>18|240,e[t++]=l>>12&63|128,e[t++]=l>>6&63|128,e[t++]=l&63|128):(e[t++]=l>>12|224,e[t++]=l>>6&63|128,e[t++]=l&63|128)}return e},kC=function(s){const e=[];let t=0,i=0;for(;t<s.length;){const l=s[t++];if(l<128)e[i++]=String.fromCharCode(l);else if(l>191&&l<224){const u=s[t++];e[i++]=String.fromCharCode((l&31)<<6|u&63)}else if(l>239&&l<365){const u=s[t++],d=s[t++],g=s[t++],y=((l&7)<<18|(u&63)<<12|(d&63)<<6|g&63)-65536;e[i++]=String.fromCharCode(55296+(y>>10)),e[i++]=String.fromCharCode(56320+(y&1023))}else{const u=s[t++],d=s[t++];e[i++]=String.fromCharCode((l&15)<<12|(u&63)<<6|d&63)}}return e.join("")},Ox={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let l=0;l<s.length;l+=3){const u=s[l],d=l+1<s.length,g=d?s[l+1]:0,y=l+2<s.length,p=y?s[l+2]:0,b=u>>2,k=(u&3)<<4|g>>4;let E=(g&15)<<2|p>>6,M=p&63;y||(M=64,d||(E=64)),i.push(t[b],t[k],t[E],t[M])}return i.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(Px(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):kC(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let l=0;l<s.length;){const u=t[s.charAt(l++)],g=l<s.length?t[s.charAt(l)]:0;++l;const p=l<s.length?t[s.charAt(l)]:64;++l;const k=l<s.length?t[s.charAt(l)]:64;if(++l,u==null||g==null||p==null||k==null)throw new jC;const E=u<<2|g>>4;if(i.push(E),p!==64){const M=g<<4&240|p>>2;if(i.push(M),k!==64){const H=p<<6&192|k;i.push(H)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class jC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const EC=function(s){const e=Px(s);return Ox.encodeByteArray(e,!0)},Lh=function(s){return EC(s).replace(/\./g,"")},Vx=function(s){try{return Ox.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function TC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const SC=()=>TC().__FIREBASE_DEFAULTS__,CC=()=>{if(typeof process>"u"||typeof o2>"u")return;const s=o2.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},NC=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&Vx(s[1]);return e&&JSON.parse(e)},rf=()=>{try{return _C()||SC()||CC()||NC()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},Ux=s=>rf()?.emulatorHosts?.[s],Bx=s=>{const e=Ux(s);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},zx=()=>rf()?.config,Fx=s=>rf()?.[`_${s}`];class AC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function fo(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function iy(s){return(await fetch(s,{credentials:"include"})).ok}function Hx(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",l=s.iat||0,u=s.sub||s.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${i}`,aud:i,iat:l,exp:l+3600,auth_time:l,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...s};return[Lh(JSON.stringify(t)),Lh(JSON.stringify(d)),""].join(".")}const du={};function RC(){const s={prod:[],emulator:[]};for(const e of Object.keys(du))du[e]?s.emulator.push(e):s.prod.push(e);return s}function IC(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let l2=!1;function ay(s,e){if(typeof window>"u"||typeof document>"u"||!fo(window.location.host)||du[s]===e||du[s]||l2)return;du[s]=e;function t(E){return`__firebase__banner__${E}`}const i="__firebase__banner",u=RC().prod.length>0;function d(){const E=document.getElementById(i);E&&E.remove()}function g(E){E.style.display="flex",E.style.background="#7faaf0",E.style.position="fixed",E.style.bottom="5px",E.style.left="5px",E.style.padding=".5em",E.style.borderRadius="5px",E.style.alignItems="center"}function y(E,M){E.setAttribute("width","24"),E.setAttribute("id",M),E.setAttribute("height","24"),E.setAttribute("viewBox","0 0 24 24"),E.setAttribute("fill","none"),E.style.marginLeft="-6px"}function p(){const E=document.createElement("span");return E.style.cursor="pointer",E.style.marginLeft="16px",E.style.fontSize="24px",E.innerHTML=" &times;",E.onclick=()=>{l2=!0,d()},E}function b(E,M){E.setAttribute("id",M),E.innerText="Learn more",E.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",E.setAttribute("target","__blank"),E.style.paddingLeft="5px",E.style.textDecoration="underline"}function k(){const E=IC(i),M=t("text"),H=document.getElementById(M)||document.createElement("span"),K=t("learnmore"),B=document.getElementById(K)||document.createElement("a"),Y=t("preprendIcon"),ee=document.getElementById(Y)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(E.created){const ae=E.element;g(ae),b(B,K);const ye=p();y(ee,Y),ae.append(ee,H,B,ye),document.body.appendChild(ae)}u?(H.innerText="Preview backend disconnected.",ee.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(ee.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,H.innerText="Preview backend running in this workspace."),H.setAttribute("id",M)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",k):k()}function Js(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function MC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Js())}function DC(){const s=rf()?.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function LC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function PC(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function OC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function VC(){const s=Js();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function UC(){return!DC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function qx(){try{return typeof indexedDB=="object"}catch{return!1}}function $x(){return new Promise((s,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(i);l.onsuccess=()=>{l.result.close(),t||self.indexedDB.deleteDatabase(i),s(!0)},l.onupgradeneeded=()=>{t=!1},l.onerror=()=>{e(l.error?.message||"")}}catch(t){e(t)}})}function BC(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}const zC="FirebaseError";class wi extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=zC,Object.setPrototypeOf(this,wi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Yo.prototype.create)}}class Yo{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},l=`${this.service}/${e}`,u=this.errors[e],d=u?FC(u,i):"Error",g=`${this.serviceName}: ${d} (${l}).`;return new wi(l,g,i)}}function FC(s,e){return s.replace(HC,(t,i)=>{const l=e[i];return l!=null?String(l):`<${i}?>`})}const HC=/\{\$([^}]+)}/g;function qC(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function pa(s,e){if(s===e)return!0;const t=Object.keys(s),i=Object.keys(e);for(const l of t){if(!i.includes(l))return!1;const u=s[l],d=e[l];if(c2(u)&&c2(d)){if(!pa(u,d))return!1}else if(u!==d)return!1}for(const l of i)if(!t.includes(l))return!1;return!0}function c2(s){return s!==null&&typeof s=="object"}function Lu(s){const e=[];for(const[t,i]of Object.entries(s))Array.isArray(i)?i.forEach(l=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function ru(s){const e={};return s.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[l,u]=i.split("=");e[decodeURIComponent(l)]=decodeURIComponent(u)}}),e}function iu(s){const e=s.indexOf("?");if(!e)return"";const t=s.indexOf("#",e);return s.substring(e,t>0?t:void 0)}function $C(s,e){const t=new WC(s,e);return t.subscribe.bind(t)}class WC{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let l;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");GC(e,["next","error","complete"])?l=e:l={next:e,error:t,complete:i},l.next===void 0&&(l.next=Lg),l.error===void 0&&(l.error=Lg),l.complete===void 0&&(l.complete=Lg);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch{}}),this.observers.push(l),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function GC(s,e){if(typeof s!="object"||s===null)return!1;for(const t of e)if(t in s&&typeof s[t]=="function")return!0;return!1}function Lg(){}function jn(s){return s&&s._delegate?s._delegate:s}class ei{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Lo="[DEFAULT]";class KC{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new AC;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:t});l&&i.resolve(l)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(l){if(i)return null;throw l}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(QC(e))try{this.getOrInitializeService({instanceIdentifier:Lo})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(t);try{const u=this.getOrInitializeService({instanceIdentifier:l});i.resolve(u)}catch{}}}}clearInstance(e=Lo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Lo){return this.instances.has(e)}getOptions(e=Lo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[u,d]of this.instancesDeferred.entries()){const g=this.normalizeInstanceIdentifier(u);i===g&&d.resolve(l)}return l}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),l=this.onInitCallbacks.get(i)??new Set;l.add(e),this.onInitCallbacks.set(i,l);const u=this.instances.get(i);return u&&e(u,i),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const l of i)try{l(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:YC(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Lo){return this.component?this.component.multipleInstances?e:Lo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function YC(s){return s===Lo?void 0:s}function QC(s){return s.instantiationMode==="EAGER"}class XC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new KC(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var en;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(en||(en={}));const JC={debug:en.DEBUG,verbose:en.VERBOSE,info:en.INFO,warn:en.WARN,error:en.ERROR,silent:en.SILENT},ZC=en.INFO,eN={[en.DEBUG]:"log",[en.VERBOSE]:"log",[en.INFO]:"info",[en.WARN]:"warn",[en.ERROR]:"error"},tN=(s,e,...t)=>{if(e<s.logLevel)return;const i=new Date().toISOString(),l=eN[e];if(l)console[l](`[${i}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class oy{constructor(e){this.name=e,this._logLevel=ZC,this._logHandler=tN,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in en))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?JC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,en.DEBUG,...e),this._logHandler(this,en.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,en.VERBOSE,...e),this._logHandler(this,en.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,en.INFO,...e),this._logHandler(this,en.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,en.WARN,...e),this._logHandler(this,en.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,en.ERROR,...e),this._logHandler(this,en.ERROR,...e)}}const nN=(s,e)=>e.some(t=>s instanceof t);let u2,d2;function sN(){return u2||(u2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function rN(){return d2||(d2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Wx=new WeakMap,bp=new WeakMap,Gx=new WeakMap,Pg=new WeakMap,ly=new WeakMap;function iN(s){const e=new Promise((t,i)=>{const l=()=>{s.removeEventListener("success",u),s.removeEventListener("error",d)},u=()=>{t(ha(s.result)),l()},d=()=>{i(s.error),l()};s.addEventListener("success",u),s.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&Wx.set(t,s)}).catch(()=>{}),ly.set(e,s),e}function aN(s){if(bp.has(s))return;const e=new Promise((t,i)=>{const l=()=>{s.removeEventListener("complete",u),s.removeEventListener("error",d),s.removeEventListener("abort",d)},u=()=>{t(),l()},d=()=>{i(s.error||new DOMException("AbortError","AbortError")),l()};s.addEventListener("complete",u),s.addEventListener("error",d),s.addEventListener("abort",d)});bp.set(s,e)}let wp={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return bp.get(s);if(e==="objectStoreNames")return s.objectStoreNames||Gx.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ha(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function oN(s){wp=s(wp)}function lN(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=s.call(Og(this),e,...t);return Gx.set(i,e.sort?e.sort():[e]),ha(i)}:rN().includes(s)?function(...e){return s.apply(Og(this),e),ha(Wx.get(this))}:function(...e){return ha(s.apply(Og(this),e))}}function cN(s){return typeof s=="function"?lN(s):(s instanceof IDBTransaction&&aN(s),nN(s,sN())?new Proxy(s,wp):s)}function ha(s){if(s instanceof IDBRequest)return iN(s);if(Pg.has(s))return Pg.get(s);const e=cN(s);return e!==s&&(Pg.set(s,e),ly.set(e,s)),e}const Og=s=>ly.get(s);function af(s,e,{blocked:t,upgrade:i,blocking:l,terminated:u}={}){const d=indexedDB.open(s,e),g=ha(d);return i&&d.addEventListener("upgradeneeded",y=>{i(ha(d.result),y.oldVersion,y.newVersion,ha(d.transaction),y)}),t&&d.addEventListener("blocked",y=>t(y.oldVersion,y.newVersion,y)),g.then(y=>{u&&y.addEventListener("close",()=>u()),l&&y.addEventListener("versionchange",p=>l(p.oldVersion,p.newVersion,p))}).catch(()=>{}),g}function Vg(s,{blocked:e}={}){const t=indexedDB.deleteDatabase(s);return e&&t.addEventListener("blocked",i=>e(i.oldVersion,i)),ha(t).then(()=>{})}const uN=["get","getKey","getAll","getAllKeys","count"],dN=["put","add","delete","clear"],Ug=new Map;function h2(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(Ug.get(e))return Ug.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,l=dN.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(l||uN.includes(t)))return;const u=async function(d,...g){const y=this.transaction(d,l?"readwrite":"readonly");let p=y.store;return i&&(p=p.index(g.shift())),(await Promise.all([p[t](...g),l&&y.done]))[0]};return Ug.set(e,u),u}oN(s=>({...s,get:(e,t,i)=>h2(e,t)||s.get(e,t,i),has:(e,t)=>!!h2(e,t)||s.has(e,t)}));class hN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(fN(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function fN(s){return s.getComponent()?.type==="VERSION"}const xp="@firebase/app",f2="0.14.7";const ya=new oy("@firebase/app"),mN="@firebase/app-compat",gN="@firebase/analytics-compat",pN="@firebase/analytics",yN="@firebase/app-check-compat",vN="@firebase/app-check",bN="@firebase/auth",wN="@firebase/auth-compat",xN="@firebase/database",_N="@firebase/data-connect",kN="@firebase/database-compat",jN="@firebase/functions",EN="@firebase/functions-compat",TN="@firebase/installations",SN="@firebase/installations-compat",CN="@firebase/messaging",NN="@firebase/messaging-compat",AN="@firebase/performance",RN="@firebase/performance-compat",IN="@firebase/remote-config",MN="@firebase/remote-config-compat",DN="@firebase/storage",LN="@firebase/storage-compat",PN="@firebase/firestore",ON="@firebase/ai",VN="@firebase/firestore-compat",UN="firebase",BN="12.8.0";const _p="[DEFAULT]",zN={[xp]:"fire-core",[mN]:"fire-core-compat",[pN]:"fire-analytics",[gN]:"fire-analytics-compat",[vN]:"fire-app-check",[yN]:"fire-app-check-compat",[bN]:"fire-auth",[wN]:"fire-auth-compat",[xN]:"fire-rtdb",[_N]:"fire-data-connect",[kN]:"fire-rtdb-compat",[jN]:"fire-fn",[EN]:"fire-fn-compat",[TN]:"fire-iid",[SN]:"fire-iid-compat",[CN]:"fire-fcm",[NN]:"fire-fcm-compat",[AN]:"fire-perf",[RN]:"fire-perf-compat",[IN]:"fire-rc",[MN]:"fire-rc-compat",[DN]:"fire-gcs",[LN]:"fire-gcs-compat",[PN]:"fire-fst",[VN]:"fire-fst-compat",[ON]:"fire-vertex","fire-js":"fire-js",[UN]:"fire-js-all"};const Ph=new Map,FN=new Map,kp=new Map;function m2(s,e){try{s.container.addComponent(e)}catch(t){ya.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function yi(s){const e=s.name;if(kp.has(e))return ya.debug(`There were multiple attempts to register component ${e}.`),!1;kp.set(e,s);for(const t of Ph.values())m2(t,s);for(const t of FN.values())m2(t,s);return!0}function Qo(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function br(s){return s==null?!1:s.settings!==void 0}const HN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},no=new Yo("app","Firebase",HN);class qN{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ei("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw no.create("app-deleted",{appName:this._name})}}const Xo=BN;function cy(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const i={name:_p,automaticDataCollectionEnabled:!0,...e},l=i.name;if(typeof l!="string"||!l)throw no.create("bad-app-name",{appName:String(l)});if(t||(t=zx()),!t)throw no.create("no-options");const u=Ph.get(l);if(u){if(pa(t,u.options)&&pa(i,u.config))return u;throw no.create("duplicate-app",{appName:l})}const d=new XC(l);for(const y of kp.values())d.addComponent(y);const g=new qN(t,i,d);return Ph.set(l,g),g}function Pu(s=_p){const e=Ph.get(s);if(!e&&s===_p&&zx())return cy();if(!e)throw no.create("no-app",{appName:s});return e}function xr(s,e,t){let i=zN[s]??s;t&&(i+=`-${t}`);const l=i.match(/\s|\//),u=e.match(/\s|\//);if(l||u){const d=[`Unable to register library "${i}" with version "${e}":`];l&&d.push(`library name "${i}" contains illegal characters (whitespace or "/")`),l&&u&&d.push("and"),u&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ya.warn(d.join(" "));return}yi(new ei(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const $N="firebase-heartbeat-database",WN=1,xu="firebase-heartbeat-store";let Bg=null;function Kx(){return Bg||(Bg=af($N,WN,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(xu)}catch(t){console.warn(t)}}}}).catch(s=>{throw no.create("idb-open",{originalErrorMessage:s.message})})),Bg}async function GN(s){try{const t=(await Kx()).transaction(xu),i=await t.objectStore(xu).get(Yx(s));return await t.done,i}catch(e){if(e instanceof wi)ya.warn(e.message);else{const t=no.create("idb-get",{originalErrorMessage:e?.message});ya.warn(t.message)}}}async function g2(s,e){try{const i=(await Kx()).transaction(xu,"readwrite");await i.objectStore(xu).put(e,Yx(s)),await i.done}catch(t){if(t instanceof wi)ya.warn(t.message);else{const i=no.create("idb-set",{originalErrorMessage:t?.message});ya.warn(i.message)}}}function Yx(s){return`${s.name}!${s.options.appId}`}const KN=1024,YN=30;class QN{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new JN(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=p2();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>YN){const l=ZN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){ya.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=p2(),{heartbeatsToSend:t,unsentEntries:i}=XN(this._heartbeatsCache.heartbeats),l=Lh(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(e){return ya.warn(e),""}}}function p2(){return new Date().toISOString().substring(0,10)}function XN(s,e=KN){const t=[];let i=s.slice();for(const l of s){const u=t.find(d=>d.agent===l.agent);if(u){if(u.dates.push(l.date),y2(t)>e){u.dates.pop();break}}else if(t.push({agent:l.agent,dates:[l.date]}),y2(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class JN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return qx()?$x().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await GN(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return g2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return g2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function y2(s){return Lh(JSON.stringify({version:2,heartbeats:s})).length}function ZN(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let i=1;i<s.length;i++)s[i].date<t&&(t=s[i].date,e=i);return e}function eA(s){yi(new ei("platform-logger",e=>new hN(e),"PRIVATE")),yi(new ei("heartbeat",e=>new QN(e),"PRIVATE")),xr(xp,f2,s),xr(xp,f2,"esm2020"),xr("fire-js","")}eA("");function Qx(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const tA=Qx,Xx=new Yo("auth","Firebase",Qx());const Oh=new oy("@firebase/auth");function nA(s,...e){Oh.logLevel<=en.WARN&&Oh.warn(`Auth (${Xo}): ${s}`,...e)}function jh(s,...e){Oh.logLevel<=en.ERROR&&Oh.error(`Auth (${Xo}): ${s}`,...e)}function ti(s,...e){throw dy(s,...e)}function gi(s,...e){return dy(s,...e)}function uy(s,e,t){const i={...tA(),[e]:t};return new Yo("auth","Firebase",i).create(e,{appName:s.name})}function fa(s){return uy(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function sA(s,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&ti(s,"argument-error"),uy(s,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function dy(s,...e){if(typeof s!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=s.name),s._errorFactory.create(t,...i)}return Xx.create(s,...e)}function xt(s,e,...t){if(!s)throw dy(e,...t)}function oa(s){const e="INTERNAL ASSERTION FAILED: "+s;throw jh(e),new Error(e)}function va(s,e){s||oa(e)}function jp(){return typeof self<"u"&&self.location?.href||""}function rA(){return v2()==="http:"||v2()==="https:"}function v2(){return typeof self<"u"&&self.location?.protocol||null}function iA(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(rA()||PC()||"connection"in navigator)?navigator.onLine:!0}function aA(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}class Ou{constructor(e,t){this.shortDelay=e,this.longDelay=t,va(t>e,"Short delay should be less than long delay!"),this.isMobile=MC()||OC()}get(){return iA()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function hy(s,e){va(s.emulator,"Emulator should always be set here");const{url:t}=s.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class Jx{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;oa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;oa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;oa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const oA={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const lA=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],cA=new Ou(3e4,6e4);function _a(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function ka(s,e,t,i,l={}){return Zx(s,l,async()=>{let u={},d={};i&&(e==="GET"?d=i:u={body:JSON.stringify(i)});const g=Lu({key:s.config.apiKey,...d}).slice(1),y=await s._getAdditionalHeaders();y["Content-Type"]="application/json",s.languageCode&&(y["X-Firebase-Locale"]=s.languageCode);const p={method:e,headers:y,...u};return LC()||(p.referrerPolicy="no-referrer"),s.emulatorConfig&&fo(s.emulatorConfig.host)&&(p.credentials="include"),Jx.fetch()(await e_(s,s.config.apiHost,t,g),p)})}async function Zx(s,e,t){s._canInitEmulator=!1;const i={...oA,...e};try{const l=new dA(s),u=await Promise.race([t(),l.promise]);l.clearNetworkTimeout();const d=await u.json();if("needConfirmation"in d)throw lh(s,"account-exists-with-different-credential",d);if(u.ok&&!("errorMessage"in d))return d;{const g=u.ok?d.errorMessage:d.error.message,[y,p]=g.split(" : ");if(y==="FEDERATED_USER_ID_ALREADY_LINKED")throw lh(s,"credential-already-in-use",d);if(y==="EMAIL_EXISTS")throw lh(s,"email-already-in-use",d);if(y==="USER_DISABLED")throw lh(s,"user-disabled",d);const b=i[y]||y.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw uy(s,b,p);ti(s,b)}}catch(l){if(l instanceof wi)throw l;ti(s,"network-request-failed",{message:String(l)})}}async function Vu(s,e,t,i,l={}){const u=await ka(s,e,t,i,l);return"mfaPendingCredential"in u&&ti(s,"multi-factor-auth-required",{_serverResponse:u}),u}async function e_(s,e,t,i){const l=`${e}${t}?${i}`,u=s,d=u.config.emulator?hy(s.config,l):`${s.config.apiScheme}://${l}`;return lA.includes(t)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(d).toString():d}function uA(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class dA{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(gi(this.auth,"network-request-failed")),cA.get())})}}function lh(s,e,t){const i={appName:s.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const l=gi(s,e,i);return l.customData._tokenResponse=t,l}function b2(s){return s!==void 0&&s.enterprise!==void 0}class hA{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return uA(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function fA(s,e){return ka(s,"GET","/v2/recaptchaConfig",_a(s,e))}async function mA(s,e){return ka(s,"POST","/v1/accounts:delete",e)}async function Vh(s,e){return ka(s,"POST","/v1/accounts:lookup",e)}function hu(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function gA(s,e=!1){const t=jn(s),i=await t.getIdToken(e),l=fy(i);xt(l&&l.exp&&l.auth_time&&l.iat,t.auth,"internal-error");const u=typeof l.firebase=="object"?l.firebase:void 0,d=u?.sign_in_provider;return{claims:l,token:i,authTime:hu(zg(l.auth_time)),issuedAtTime:hu(zg(l.iat)),expirationTime:hu(zg(l.exp)),signInProvider:d||null,signInSecondFactor:u?.sign_in_second_factor||null}}function zg(s){return Number(s)*1e3}function fy(s){const[e,t,i]=s.split(".");if(e===void 0||t===void 0||i===void 0)return jh("JWT malformed, contained fewer than 3 sections"),null;try{const l=Vx(t);return l?JSON.parse(l):(jh("Failed to decode base64 JWT payload"),null)}catch(l){return jh("Caught error parsing JWT payload as JSON",l?.toString()),null}}function w2(s){const e=fy(s);return xt(e,"internal-error"),xt(typeof e.exp<"u","internal-error"),xt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function _u(s,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof wi&&pA(i)&&s.auth.currentUser===s&&await s.auth.signOut(),i}}function pA({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}class yA{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Ep{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=hu(this.lastLoginAt),this.creationTime=hu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Uh(s){const e=s.auth,t=await s.getIdToken(),i=await _u(s,Vh(e,{idToken:t}));xt(i?.users.length,e,"internal-error");const l=i.users[0];s._notifyReloadListener(l);const u=l.providerUserInfo?.length?t_(l.providerUserInfo):[],d=bA(s.providerData,u),g=s.isAnonymous,y=!(s.email&&l.passwordHash)&&!d?.length,p=g?y:!1,b={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:d,metadata:new Ep(l.createdAt,l.lastLoginAt),isAnonymous:p};Object.assign(s,b)}async function vA(s){const e=jn(s);await Uh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function bA(s,e){return[...s.filter(i=>!e.some(l=>l.providerId===i.providerId)),...e]}function t_(s){return s.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function wA(s,e){const t=await Zx(s,{},async()=>{const i=Lu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:l,apiKey:u}=s.config,d=await e_(s,l,"/v1/token",`key=${u}`),g=await s._getAdditionalHeaders();g["Content-Type"]="application/x-www-form-urlencoded";const y={method:"POST",headers:g,body:i};return s.emulatorConfig&&fo(s.emulatorConfig.host)&&(y.credentials="include"),Jx.fetch()(d,y)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function xA(s,e){return ka(s,"POST","/v2/accounts:revokeToken",_a(s,e))}class zl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){xt(e.idToken,"internal-error"),xt(typeof e.idToken<"u","internal-error"),xt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):w2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){xt(e.length!==0,"internal-error");const t=w2(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(xt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:l,expiresIn:u}=await wA(e,t);this.updateTokensAndExpiration(i,l,Number(u))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:l,expirationTime:u}=t,d=new zl;return i&&(xt(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),l&&(xt(typeof l=="string","internal-error",{appName:e}),d.accessToken=l),u&&(xt(typeof u=="number","internal-error",{appName:e}),d.expirationTime=u),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new zl,this.toJSON())}_performRefresh(){return oa("not implemented")}}function Ya(s,e){xt(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class fi{constructor({uid:e,auth:t,stsTokenManager:i,...l}){this.providerId="firebase",this.proactiveRefresh=new yA(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new Ep(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await _u(this,this.stsTokenManager.getToken(this.auth,e));return xt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return gA(this,e)}reload(){return vA(this)}_assign(e){this!==e&&(xt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new fi({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){xt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Uh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(br(this.auth.app))return Promise.reject(fa(this.auth));const e=await this.getIdToken();return await _u(this,mA(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,l=t.email??void 0,u=t.phoneNumber??void 0,d=t.photoURL??void 0,g=t.tenantId??void 0,y=t._redirectEventId??void 0,p=t.createdAt??void 0,b=t.lastLoginAt??void 0,{uid:k,emailVerified:E,isAnonymous:M,providerData:H,stsTokenManager:K}=t;xt(k&&K,e,"internal-error");const B=zl.fromJSON(this.name,K);xt(typeof k=="string",e,"internal-error"),Ya(i,e.name),Ya(l,e.name),xt(typeof E=="boolean",e,"internal-error"),xt(typeof M=="boolean",e,"internal-error"),Ya(u,e.name),Ya(d,e.name),Ya(g,e.name),Ya(y,e.name),Ya(p,e.name),Ya(b,e.name);const Y=new fi({uid:k,auth:e,email:l,emailVerified:E,displayName:i,isAnonymous:M,photoURL:d,phoneNumber:u,tenantId:g,stsTokenManager:B,createdAt:p,lastLoginAt:b});return H&&Array.isArray(H)&&(Y.providerData=H.map(ee=>({...ee}))),y&&(Y._redirectEventId=y),Y}static async _fromIdTokenResponse(e,t,i=!1){const l=new zl;l.updateFromServerResponse(t);const u=new fi({uid:t.localId,auth:e,stsTokenManager:l,isAnonymous:i});return await Uh(u),u}static async _fromGetAccountInfoResponse(e,t,i){const l=t.users[0];xt(l.localId!==void 0,"internal-error");const u=l.providerUserInfo!==void 0?t_(l.providerUserInfo):[],d=!(l.email&&l.passwordHash)&&!u?.length,g=new zl;g.updateFromIdToken(i);const y=new fi({uid:l.localId,auth:e,stsTokenManager:g,isAnonymous:d}),p={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:u,metadata:new Ep(l.createdAt,l.lastLoginAt),isAnonymous:!(l.email&&l.passwordHash)&&!u?.length};return Object.assign(y,p),y}}const x2=new Map;function la(s){va(s instanceof Function,"Expected a class definition");let e=x2.get(s);return e?(va(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,x2.set(s,e),e)}class n_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}n_.type="NONE";const _2=n_;function Eh(s,e,t){return`firebase:${s}:${e}:${t}`}class Fl{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:l,name:u}=this.auth;this.fullUserKey=Eh(this.userKey,l.apiKey,u),this.fullPersistenceKey=Eh("persistence",l.apiKey,u),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Vh(this.auth,{idToken:e}).catch(()=>{});return t?fi._fromGetAccountInfoResponse(this.auth,t,e):null}return fi._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Fl(la(_2),e,i);const l=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let u=l[0]||la(_2);const d=Eh(i,e.config.apiKey,e.name);let g=null;for(const p of t)try{const b=await p._get(d);if(b){let k;if(typeof b=="string"){const E=await Vh(e,{idToken:b}).catch(()=>{});if(!E)break;k=await fi._fromGetAccountInfoResponse(e,E,b)}else k=fi._fromJSON(e,b);p!==u&&(g=k),u=p;break}}catch{}const y=l.filter(p=>p._shouldAllowMigration);return!u._shouldAllowMigration||!y.length?new Fl(u,e,i):(u=y[0],g&&await u._set(d,g.toJSON()),await Promise.all(t.map(async p=>{if(p!==u)try{await p._remove(d)}catch{}})),new Fl(u,e,i))}}function k2(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(a_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(s_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(l_(e))return"Blackberry";if(c_(e))return"Webos";if(r_(e))return"Safari";if((e.includes("chrome/")||i_(e))&&!e.includes("edge/"))return"Chrome";if(o_(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=s.match(t);if(i?.length===2)return i[1]}return"Other"}function s_(s=Js()){return/firefox\//i.test(s)}function r_(s=Js()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function i_(s=Js()){return/crios\//i.test(s)}function a_(s=Js()){return/iemobile/i.test(s)}function o_(s=Js()){return/android/i.test(s)}function l_(s=Js()){return/blackberry/i.test(s)}function c_(s=Js()){return/webos/i.test(s)}function my(s=Js()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function _A(s=Js()){return my(s)&&!!window.navigator?.standalone}function kA(){return VC()&&document.documentMode===10}function u_(s=Js()){return my(s)||o_(s)||c_(s)||l_(s)||/windows phone/i.test(s)||a_(s)}function d_(s,e=[]){let t;switch(s){case"Browser":t=k2(Js());break;case"Worker":t=`${k2(Js())}-${s}`;break;default:t=s}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Xo}/${i}`}class jA{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=u=>new Promise((d,g)=>{try{const y=e(u);d(y)}catch(y){g(y)}});i.onAbort=t,this.queue.push(i);const l=this.queue.length-1;return()=>{this.queue[l]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const l of t)try{l()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function EA(s,e={}){return ka(s,"GET","/v2/passwordPolicy",_a(s,e))}const TA=6;class SA{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??TA,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,l=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),l&&(t.meetsMaxPasswordLength=e.length<=l)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let l=0;l<e.length;l++)i=e.charAt(l),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,l,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=l)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}class CA{constructor(e,t,i,l){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new j2(this),this.idTokenSubscription=new j2(this),this.beforeStateQueue=new jA(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Xx,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=l.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=la(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Fl.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Vh(this,{idToken:e}),i=await fi._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(br(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,d=i?._redirectEventId,g=await this.tryRedirectSignIn(e);(!u||u===d)&&g?.user&&(i=g.user,l=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return xt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Uh(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=aA()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(br(this.app))return Promise.reject(fa(this));const t=e?jn(e):null;return t&&xt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&xt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return br(this.app)?Promise.reject(fa(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return br(this.app)?Promise.reject(fa(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(la(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await EA(this),t=new SA(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Yo("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await xA(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&la(e)||this._popupRedirectResolver;xt(t,this,"argument-error"),this.redirectPersistenceManager=await Fl.create(this,[la(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,l){if(this._deleted)return()=>{};const u=typeof t=="function"?t:t.next.bind(t);let d=!1;const g=this._isInitialized?Promise.resolve():this._initializationPromise;if(xt(g,this,"internal-error"),g.then(()=>{d||u(this.currentUser)}),typeof t=="function"){const y=e.addObserver(t,i,l);return()=>{d=!0,y()}}else{const y=e.addObserver(t);return()=>{d=!0,y()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return xt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=d_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(br(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&nA(`Error while retrieving App Check token: ${e.error}`),e?.token}}function ja(s){return jn(s)}class j2{constructor(e){this.auth=e,this.observer=null,this.addObserver=$C(t=>this.observer=t)}get next(){return xt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let of={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function NA(s){of=s}function h_(s){return of.loadJS(s)}function AA(){return of.recaptchaEnterpriseScript}function RA(){return of.gapiScript}function IA(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class MA{constructor(){this.enterprise=new DA}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class DA{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const LA="recaptcha-enterprise",f_="NO_RECAPTCHA";class PA{constructor(e){this.type=LA,this.auth=ja(e)}async verify(e="verify",t=!1){async function i(u){if(!t){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(d,g)=>{fA(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(y=>{if(y.recaptchaKey===void 0)g(new Error("recaptcha Enterprise site key undefined"));else{const p=new hA(y);return u.tenantId==null?u._agentRecaptchaConfig=p:u._tenantRecaptchaConfigs[u.tenantId]=p,d(p.siteKey)}}).catch(y=>{g(y)})})}function l(u,d,g){const y=window.grecaptcha;b2(y)?y.enterprise.ready(()=>{y.enterprise.execute(u,{action:e}).then(p=>{d(p)}).catch(()=>{d(f_)})}):g(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new MA().execute("siteKey",{action:"verify"}):new Promise((u,d)=>{i(this.auth).then(g=>{if(!t&&b2(window.grecaptcha))l(g,u,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let y=AA();y.length!==0&&(y+=g),h_(y).then(()=>{l(g,u,d)}).catch(p=>{d(p)})}}).catch(g=>{d(g)})})}}async function E2(s,e,t,i=!1,l=!1){const u=new PA(s);let d;if(l)d=f_;else try{d=await u.verify(t)}catch{d=await u.verify(t,!0)}const g={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in g){const y=g.phoneEnrollmentInfo.phoneNumber,p=g.phoneEnrollmentInfo.recaptchaToken;Object.assign(g,{phoneEnrollmentInfo:{phoneNumber:y,recaptchaToken:p,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in g){const y=g.phoneSignInInfo.recaptchaToken;Object.assign(g,{phoneSignInInfo:{recaptchaToken:y,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return g}return i?Object.assign(g,{captchaResp:d}):Object.assign(g,{captchaResponse:d}),Object.assign(g,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(g,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),g}async function Bh(s,e,t,i,l){if(s._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await E2(s,e,t,t==="getOobCode");return i(s,u)}else return i(s,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await E2(s,e,t,t==="getOobCode");return i(s,d)}else return Promise.reject(u)})}function OA(s,e){const t=Qo(s,"auth");if(t.isInitialized()){const l=t.getImmediate(),u=t.getOptions();if(pa(u,e??{}))return l;ti(l,"already-initialized")}return t.initialize({options:e})}function VA(s,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(la);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(i,e?.popupRedirectResolver)}function UA(s,e,t){const i=ja(s);xt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const l=!1,u=m_(e),{host:d,port:g}=BA(e),y=g===null?"":`:${g}`,p={url:`${u}//${d}${y}/`},b=Object.freeze({host:d,port:g,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!i._canInitEmulator){xt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),xt(pa(p,i.config.emulator)&&pa(b,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=p,i.emulatorConfig=b,i.settings.appVerificationDisabledForTesting=!0,fo(d)?(iy(`${u}//${d}${y}`),ay("Auth",!0)):zA()}function m_(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function BA(s){const e=m_(s),t=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",l=/^(\[[^\]]+\])(:|$)/.exec(i);if(l){const u=l[1];return{host:u,port:T2(i.substr(u.length+1))}}else{const[u,d]=i.split(":");return{host:u,port:T2(d)}}}function T2(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function zA(){function s(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}class gy{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return oa("not implemented")}_getIdTokenResponse(e){return oa("not implemented")}_linkToIdToken(e,t){return oa("not implemented")}_getReauthenticationResolver(e){return oa("not implemented")}}async function FA(s,e){return ka(s,"POST","/v1/accounts:signUp",e)}async function HA(s,e){return Vu(s,"POST","/v1/accounts:signInWithPassword",_a(s,e))}async function g_(s,e){return ka(s,"POST","/v1/accounts:sendOobCode",_a(s,e))}async function qA(s,e){return g_(s,e)}async function $A(s,e){return g_(s,e)}async function WA(s,e){return Vu(s,"POST","/v1/accounts:signInWithEmailLink",_a(s,e))}async function GA(s,e){return Vu(s,"POST","/v1/accounts:signInWithEmailLink",_a(s,e))}class ku extends gy{constructor(e,t,i,l=null){super("password",i),this._email=e,this._password=t,this._tenantId=l}static _fromEmailAndPassword(e,t){return new ku(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new ku(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Bh(e,t,"signInWithPassword",HA);case"emailLink":return WA(e,{email:this._email,oobCode:this._password});default:ti(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Bh(e,i,"signUpPassword",FA);case"emailLink":return GA(e,{idToken:t,email:this._email,oobCode:this._password});default:ti(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Hl(s,e){return Vu(s,"POST","/v1/accounts:signInWithIdp",_a(s,e))}const KA="http://localhost";class ba extends gy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ba(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ti("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:l,...u}=t;if(!i||!l)return null;const d=new ba(i,l);return d.idToken=u.idToken||void 0,d.accessToken=u.accessToken||void 0,d.secret=u.secret,d.nonce=u.nonce,d.pendingToken=u.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Hl(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Hl(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Hl(e,t)}buildRequest(){const e={requestUri:KA,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Lu(t)}return e}}function YA(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function QA(s){const e=ru(iu(s)).link,t=e?ru(iu(e)).deep_link_id:null,i=ru(iu(s)).deep_link_id;return(i?ru(iu(i)).link:null)||i||t||e||s}class py{constructor(e){const t=ru(iu(e)),i=t.apiKey??null,l=t.oobCode??null,u=YA(t.mode??null);xt(i&&l&&u,"argument-error"),this.apiKey=i,this.operation=u,this.code=l,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=QA(e);try{return new py(t)}catch{return null}}}class rc{constructor(){this.providerId=rc.PROVIDER_ID}static credential(e,t){return ku._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=py.parseLink(t);return xt(i,"argument-error"),ku._fromEmailAndCode(e,i.code,i.tenantId)}}rc.PROVIDER_ID="password";rc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";rc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class yy{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class ic extends yy{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class fu extends ic{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return xt("providerId"in t&&"signInMethod"in t,"argument-error"),ba._fromParams(t)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return xt(e.idToken||e.accessToken,"argument-error"),ba._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return fu.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return fu.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i,oauthTokenSecret:l,pendingToken:u,nonce:d,providerId:g}=e;if(!i&&!l&&!t&&!u||!g)return null;try{return new fu(g)._credential({idToken:t,accessToken:i,nonce:d,pendingToken:u})}catch{return null}}}class Xa extends ic{constructor(){super("facebook.com")}static credential(e){return ba._fromParams({providerId:Xa.PROVIDER_ID,signInMethod:Xa.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xa.credentialFromTaggedObject(e)}static credentialFromError(e){return Xa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Xa.credential(e.oauthAccessToken)}catch{return null}}}Xa.FACEBOOK_SIGN_IN_METHOD="facebook.com";Xa.PROVIDER_ID="facebook.com";class aa extends ic{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return ba._fromParams({providerId:aa.PROVIDER_ID,signInMethod:aa.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return aa.credentialFromTaggedObject(e)}static credentialFromError(e){return aa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return aa.credential(t,i)}catch{return null}}}aa.GOOGLE_SIGN_IN_METHOD="google.com";aa.PROVIDER_ID="google.com";class Ja extends ic{constructor(){super("github.com")}static credential(e){return ba._fromParams({providerId:Ja.PROVIDER_ID,signInMethod:Ja.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ja.credentialFromTaggedObject(e)}static credentialFromError(e){return Ja.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ja.credential(e.oauthAccessToken)}catch{return null}}}Ja.GITHUB_SIGN_IN_METHOD="github.com";Ja.PROVIDER_ID="github.com";class Za extends ic{constructor(){super("twitter.com")}static credential(e,t){return ba._fromParams({providerId:Za.PROVIDER_ID,signInMethod:Za.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Za.credentialFromTaggedObject(e)}static credentialFromError(e){return Za.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Za.credential(t,i)}catch{return null}}}Za.TWITTER_SIGN_IN_METHOD="twitter.com";Za.PROVIDER_ID="twitter.com";async function XA(s,e){return Vu(s,"POST","/v1/accounts:signUp",_a(s,e))}class Fo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,l=!1){const u=await fi._fromIdTokenResponse(e,i,l),d=S2(i);return new Fo({user:u,providerId:d,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const l=S2(i);return new Fo({user:e,providerId:l,_tokenResponse:i,operationType:t})}}function S2(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}class zh extends wi{constructor(e,t,i,l){super(t.code,t.message),this.operationType=i,this.user=l,Object.setPrototypeOf(this,zh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,l){return new zh(e,t,i,l)}}function p_(s,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(s):t._getIdTokenResponse(s)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?zh._fromErrorAndOperation(s,u,e,i):u})}async function JA(s,e,t=!1){const i=await _u(s,e._linkToIdToken(s.auth,await s.getIdToken()),t);return Fo._forOperation(s,"link",i)}async function ZA(s,e,t=!1){const{auth:i}=s;if(br(i.app))return Promise.reject(fa(i));const l="reauthenticate";try{const u=await _u(s,p_(i,l,e,s),t);xt(u.idToken,i,"internal-error");const d=fy(u.idToken);xt(d,i,"internal-error");const{sub:g}=d;return xt(s.uid===g,i,"user-mismatch"),Fo._forOperation(s,l,u)}catch(u){throw u?.code==="auth/user-not-found"&&ti(i,"user-mismatch"),u}}async function y_(s,e,t=!1){if(br(s.app))return Promise.reject(fa(s));const i="signIn",l=await p_(s,i,e),u=await Fo._fromIdTokenResponse(s,i,l);return t||await s._updateCurrentUser(u.user),u}async function e4(s,e){return y_(ja(s),e)}async function v_(s){const e=ja(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function t4(s,e,t){const i=ja(s);await Bh(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",$A)}async function n4(s,e,t){if(br(s.app))return Promise.reject(fa(s));const i=ja(s),d=await Bh(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",XA).catch(y=>{throw y.code==="auth/password-does-not-meet-requirements"&&v_(s),y}),g=await Fo._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(g.user),g}function s4(s,e,t){return br(s.app)?Promise.reject(fa(s)):e4(jn(s),rc.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&v_(s),i})}async function OP(s,e){const t=jn(s),l={requestType:"VERIFY_EMAIL",idToken:await s.getIdToken()},{email:u}=await qA(t.auth,l);u!==s.email&&await s.reload()}function ch(s,e){return jn(s).setPersistence(e)}function r4(s,e,t,i){return jn(s).onIdTokenChanged(e,t,i)}function i4(s,e,t){return jn(s).beforeAuthStateChanged(e,t)}function a4(s,e,t,i){return jn(s).onAuthStateChanged(e,t,i)}function o4(s){return jn(s).signOut()}const Fh="__sak";class b_{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Fh,"1"),this.storage.removeItem(Fh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const l4=1e3,c4=10;class w_ extends b_{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=u_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),l=this.localCache[t];i!==l&&e(t,l,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,g,y)=>{this.notifyListeners(d,y)});return}const i=e.key;t?this.detachListener():this.stopPolling();const l=()=>{const d=this.storage.getItem(i);!t&&this.localCache[i]===d||this.notifyListeners(i,d)},u=this.storage.getItem(i);kA()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(l,c4):l()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},l4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}w_.type="LOCAL";const au=w_;class x_ extends b_{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}x_.type="SESSION";const vy=x_;function u4(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class lf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(l=>l.isListeningto(e));if(t)return t;const i=new lf(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:l,data:u}=t.data,d=this.handlersMap[l];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:l});const g=Array.from(d).map(async p=>p(t.origin,u)),y=await u4(g);t.ports[0].postMessage({status:"done",eventId:i,eventType:l,response:y})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}lf.receivers=[];function by(s="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return s+t}class d4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const l=typeof MessageChannel<"u"?new MessageChannel:null;if(!l)throw new Error("connection_unavailable");let u,d;return new Promise((g,y)=>{const p=by("",20);l.port1.start();const b=setTimeout(()=>{y(new Error("unsupported_event"))},i);d={messageChannel:l,onMessage(k){const E=k;if(E.data.eventId===p)switch(E.data.status){case"ack":clearTimeout(b),u=setTimeout(()=>{y(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),g(E.data.response);break;default:clearTimeout(b),clearTimeout(u),y(new Error("invalid_response"));break}}},this.handlers.add(d),l.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[l.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}function Mi(){return window}function h4(s){Mi().location.href=s}function __(){return typeof Mi().WorkerGlobalScope<"u"&&typeof Mi().importScripts=="function"}async function f4(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function m4(){return navigator?.serviceWorker?.controller||null}function g4(){return __()?self:null}const k_="firebaseLocalStorageDb",p4=1,Hh="firebaseLocalStorage",j_="fbase_key";class Uu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function cf(s,e){return s.transaction([Hh],e?"readwrite":"readonly").objectStore(Hh)}function y4(){const s=indexedDB.deleteDatabase(k_);return new Uu(s).toPromise()}function Tp(){const s=indexedDB.open(k_,p4);return new Promise((e,t)=>{s.addEventListener("error",()=>{t(s.error)}),s.addEventListener("upgradeneeded",()=>{const i=s.result;try{i.createObjectStore(Hh,{keyPath:j_})}catch(l){t(l)}}),s.addEventListener("success",async()=>{const i=s.result;i.objectStoreNames.contains(Hh)?e(i):(i.close(),await y4(),e(await Tp()))})})}async function C2(s,e,t){const i=cf(s,!0).put({[j_]:e,value:t});return new Uu(i).toPromise()}async function v4(s,e){const t=cf(s,!1).get(e),i=await new Uu(t).toPromise();return i===void 0?null:i.value}function N2(s,e){const t=cf(s,!0).delete(e);return new Uu(t).toPromise()}const b4=800,w4=3;class E_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Tp(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>w4)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return __()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=lf._getInstance(g4()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await f4(),!this.activeServiceWorker)return;this.sender=new d4(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||m4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Tp();return await C2(e,Fh,"1"),await N2(e,Fh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>C2(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>v4(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>N2(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(l=>{const u=cf(l,!1).getAll();return new Uu(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:l,value:u}of e)i.add(l),JSON.stringify(this.localCache[l])!==JSON.stringify(u)&&(this.notifyListeners(l,u),t.push(l));for(const l of Object.keys(this.localCache))this.localCache[l]&&!i.has(l)&&(this.notifyListeners(l,null),t.push(l));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),b4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}E_.type="LOCAL";const x4=E_;new Ou(3e4,6e4);function T_(s,e){return e?la(e):(xt(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}class wy extends gy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Hl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Hl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Hl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function _4(s){return y_(s.auth,new wy(s),s.bypassAuthState)}function k4(s){const{auth:e,user:t}=s;return xt(t,e,"internal-error"),ZA(t,new wy(s),s.bypassAuthState)}async function j4(s){const{auth:e,user:t}=s;return xt(t,e,"internal-error"),JA(t,new wy(s),s.bypassAuthState)}class S_{constructor(e,t,i,l,u=!1){this.auth=e,this.resolver=i,this.user=l,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:l,tenantId:u,error:d,type:g}=e;if(d){this.reject(d);return}const y={auth:this.auth,requestUri:t,sessionId:i,tenantId:u||void 0,postBody:l||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(g)(y))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return _4;case"linkViaPopup":case"linkViaRedirect":return j4;case"reauthViaPopup":case"reauthViaRedirect":return k4;default:ti(this.auth,"internal-error")}}resolve(e){va(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){va(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const E4=new Ou(2e3,1e4);async function A2(s,e,t){if(br(s.app))return Promise.reject(gi(s,"operation-not-supported-in-this-environment"));const i=ja(s);sA(s,e,yy);const l=T_(i,t);return new Po(i,"signInViaPopup",e,l).executeNotNull()}class Po extends S_{constructor(e,t,i,l,u){super(e,t,l,u),this.provider=i,this.authWindow=null,this.pollId=null,Po.currentPopupAction&&Po.currentPopupAction.cancel(),Po.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return xt(e,this.auth,"internal-error"),e}async onExecution(){va(this.filter.length===1,"Popup operations only handle one event");const e=by();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(gi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(gi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Po.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(gi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,E4.get())};e()}}Po.currentPopupAction=null;const T4="pendingRedirect",Th=new Map;class S4 extends S_{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Th.get(this.auth._key());if(!e){try{const i=await C4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Th.set(this.auth._key(),e)}return this.bypassAuthState||Th.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function C4(s,e){const t=R4(e),i=A4(s);if(!await i._isAvailable())return!1;const l=await i._get(t)==="true";return await i._remove(t),l}function N4(s,e){Th.set(s._key(),e)}function A4(s){return la(s._redirectPersistence)}function R4(s){return Eh(T4,s.config.apiKey,s.name)}async function I4(s,e,t=!1){if(br(s.app))return Promise.reject(fa(s));const i=ja(s),l=T_(i,e),d=await new S4(i,l,t).execute();return d&&!t&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}const M4=600*1e3;class D4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!L4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!C_(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(gi(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=M4&&this.cachedEventUids.clear(),this.cachedEventUids.has(R2(e))}saveEventToCache(e){this.cachedEventUids.add(R2(e)),this.lastProcessedEventTime=Date.now()}}function R2(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function C_({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function L4(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return C_(s);default:return!1}}async function P4(s,e={}){return ka(s,"GET","/v1/projects",e)}const O4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,V4=/^https?/;async function U4(s){if(s.config.emulator)return;const{authorizedDomains:e}=await P4(s);for(const t of e)try{if(B4(t))return}catch{}ti(s,"unauthorized-domain")}function B4(s){const e=jp(),{protocol:t,hostname:i}=new URL(e);if(s.startsWith("chrome-extension://")){const d=new URL(s);return d.hostname===""&&i===""?t==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===i}if(!V4.test(t))return!1;if(O4.test(s))return i===s;const l=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(i)}const z4=new Ou(3e4,6e4);function I2(){const s=Mi().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let t=0;t<s.CP.length;t++)s.CP[t]=null}}function F4(s){return new Promise((e,t)=>{function i(){I2(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{I2(),t(gi(s,"network-request-failed"))},timeout:z4.get()})}if(Mi().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Mi().gapi?.load)i();else{const l=IA("iframefcb");return Mi()[l]=()=>{gapi.load?i():t(gi(s,"network-request-failed"))},h_(`${RA()}?onload=${l}`).catch(u=>t(u))}}).catch(e=>{throw Sh=null,e})}let Sh=null;function H4(s){return Sh=Sh||F4(s),Sh}const q4=new Ou(5e3,15e3),$4="__/auth/iframe",W4="emulator/auth/iframe",G4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},K4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Y4(s){const e=s.config;xt(e.authDomain,s,"auth-domain-config-required");const t=e.emulator?hy(e,W4):`https://${s.config.authDomain}/${$4}`,i={apiKey:e.apiKey,appName:s.name,v:Xo},l=K4.get(s.config.apiHost);l&&(i.eid=l);const u=s._getFrameworks();return u.length&&(i.fw=u.join(",")),`${t}?${Lu(i).slice(1)}`}async function Q4(s){const e=await H4(s),t=Mi().gapi;return xt(t,s,"internal-error"),e.open({where:document.body,url:Y4(s),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:G4,dontclear:!0},i=>new Promise(async(l,u)=>{await i.restyle({setHideOnLeave:!1});const d=gi(s,"network-request-failed"),g=Mi().setTimeout(()=>{u(d)},q4.get());function y(){Mi().clearTimeout(g),l(i)}i.ping(y).then(y,()=>{u(d)})}))}const X4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},J4=500,Z4=600,eR="_blank",tR="http://localhost";class M2{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function nR(s,e,t,i=J4,l=Z4){const u=Math.max((window.screen.availHeight-l)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let g="";const y={...X4,width:i.toString(),height:l.toString(),top:u,left:d},p=Js().toLowerCase();t&&(g=i_(p)?eR:t),s_(p)&&(e=e||tR,y.scrollbars="yes");const b=Object.entries(y).reduce((E,[M,H])=>`${E}${M}=${H},`,"");if(_A(p)&&g!=="_self")return sR(e||"",g),new M2(null);const k=window.open(e||"",g,b);xt(k,s,"popup-blocked");try{k.focus()}catch{}return new M2(k)}function sR(s,e){const t=document.createElement("a");t.href=s,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const rR="__/auth/handler",iR="emulator/auth/handler",aR=encodeURIComponent("fac");async function D2(s,e,t,i,l,u){xt(s.config.authDomain,s,"auth-domain-config-required"),xt(s.config.apiKey,s,"invalid-api-key");const d={apiKey:s.config.apiKey,appName:s.name,authType:t,redirectUrl:i,v:Xo,eventId:l};if(e instanceof yy){e.setDefaultLanguage(s.languageCode),d.providerId=e.providerId||"",qC(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[b,k]of Object.entries({}))d[b]=k}if(e instanceof ic){const b=e.getScopes().filter(k=>k!=="");b.length>0&&(d.scopes=b.join(","))}s.tenantId&&(d.tid=s.tenantId);const g=d;for(const b of Object.keys(g))g[b]===void 0&&delete g[b];const y=await s._getAppCheckToken(),p=y?`#${aR}=${encodeURIComponent(y)}`:"";return`${oR(s)}?${Lu(g).slice(1)}${p}`}function oR({config:s}){return s.emulator?hy(s,iR):`https://${s.authDomain}/${rR}`}const Fg="webStorageSupport";class lR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=vy,this._completeRedirectFn=I4,this._overrideRedirectResult=N4}async _openPopup(e,t,i,l){va(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await D2(e,t,i,jp(),l);return nR(e,u,by())}async _openRedirect(e,t,i,l){await this._originValidation(e);const u=await D2(e,t,i,jp(),l);return h4(u),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:l,promise:u}=this.eventManagers[t];return l?Promise.resolve(l):(va(u,"If manager is not set, promise should be"),u)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await Q4(e),i=new D4(e);return t.register("authEvent",l=>(xt(l?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(l.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Fg,{type:Fg},l=>{const u=l?.[0]?.[Fg];u!==void 0&&t(!!u),ti(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=U4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return u_()||r_()||my()}}const cR=lR;var L2="@firebase/auth",P2="1.12.0";class uR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){xt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function dR(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function hR(s){yi(new ei("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),l=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:d,authDomain:g}=i.options;xt(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const y={apiKey:d,authDomain:g,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:d_(s)},p=new CA(i,l,u,y);return VA(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),yi(new ei("auth-internal",e=>{const t=ja(e.getProvider("auth").getImmediate());return(i=>new uR(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),xr(L2,P2,dR(s)),xr(L2,P2,"esm2020")}const fR=300,mR=Fx("authIdTokenMaxAge")||fR;let O2=null;const gR=s=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>mR)return;const l=t?.token;O2!==l&&(O2=l,await fetch(s,{method:l?"POST":"DELETE",headers:l?{Authorization:`Bearer ${l}`}:{}}))};function N_(s=Pu()){const e=Qo(s,"auth");if(e.isInitialized())return e.getImmediate();const t=OA(s,{popupRedirectResolver:cR,persistence:[x4,au,vy]}),i=Fx("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(i,location.origin);if(location.origin===u.origin){const d=gR(u.toString());i4(t,d,()=>d(t.currentUser)),r4(t,g=>d(g))}}const l=Ux("auth");return l&&UA(t,`http://${l}`),t}function pR(){return document.getElementsByTagName("head")?.[0]??document}NA({loadJS(s){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",s),i.onload=e,i.onerror=l=>{const u=gi("internal-error");u.customData=l,t(u)},i.type="text/javascript",i.charset="UTF-8",pR().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});hR("Browser");var V2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var so,A_;(function(){var s;function e(D,T){function I(){}I.prototype=T.prototype,D.F=T.prototype,D.prototype=new I,D.prototype.constructor=D,D.D=function(U,L,P){for(var A=Array(arguments.length-2),Le=2;Le<arguments.length;Le++)A[Le-2]=arguments[Le];return T.prototype[L].apply(U,A)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function l(D,T,I){I||(I=0);const U=Array(16);if(typeof T=="string")for(var L=0;L<16;++L)U[L]=T.charCodeAt(I++)|T.charCodeAt(I++)<<8|T.charCodeAt(I++)<<16|T.charCodeAt(I++)<<24;else for(L=0;L<16;++L)U[L]=T[I++]|T[I++]<<8|T[I++]<<16|T[I++]<<24;T=D.g[0],I=D.g[1],L=D.g[2];let P=D.g[3],A;A=T+(P^I&(L^P))+U[0]+3614090360&4294967295,T=I+(A<<7&4294967295|A>>>25),A=P+(L^T&(I^L))+U[1]+3905402710&4294967295,P=T+(A<<12&4294967295|A>>>20),A=L+(I^P&(T^I))+U[2]+606105819&4294967295,L=P+(A<<17&4294967295|A>>>15),A=I+(T^L&(P^T))+U[3]+3250441966&4294967295,I=L+(A<<22&4294967295|A>>>10),A=T+(P^I&(L^P))+U[4]+4118548399&4294967295,T=I+(A<<7&4294967295|A>>>25),A=P+(L^T&(I^L))+U[5]+1200080426&4294967295,P=T+(A<<12&4294967295|A>>>20),A=L+(I^P&(T^I))+U[6]+2821735955&4294967295,L=P+(A<<17&4294967295|A>>>15),A=I+(T^L&(P^T))+U[7]+4249261313&4294967295,I=L+(A<<22&4294967295|A>>>10),A=T+(P^I&(L^P))+U[8]+1770035416&4294967295,T=I+(A<<7&4294967295|A>>>25),A=P+(L^T&(I^L))+U[9]+2336552879&4294967295,P=T+(A<<12&4294967295|A>>>20),A=L+(I^P&(T^I))+U[10]+4294925233&4294967295,L=P+(A<<17&4294967295|A>>>15),A=I+(T^L&(P^T))+U[11]+2304563134&4294967295,I=L+(A<<22&4294967295|A>>>10),A=T+(P^I&(L^P))+U[12]+1804603682&4294967295,T=I+(A<<7&4294967295|A>>>25),A=P+(L^T&(I^L))+U[13]+4254626195&4294967295,P=T+(A<<12&4294967295|A>>>20),A=L+(I^P&(T^I))+U[14]+2792965006&4294967295,L=P+(A<<17&4294967295|A>>>15),A=I+(T^L&(P^T))+U[15]+1236535329&4294967295,I=L+(A<<22&4294967295|A>>>10),A=T+(L^P&(I^L))+U[1]+4129170786&4294967295,T=I+(A<<5&4294967295|A>>>27),A=P+(I^L&(T^I))+U[6]+3225465664&4294967295,P=T+(A<<9&4294967295|A>>>23),A=L+(T^I&(P^T))+U[11]+643717713&4294967295,L=P+(A<<14&4294967295|A>>>18),A=I+(P^T&(L^P))+U[0]+3921069994&4294967295,I=L+(A<<20&4294967295|A>>>12),A=T+(L^P&(I^L))+U[5]+3593408605&4294967295,T=I+(A<<5&4294967295|A>>>27),A=P+(I^L&(T^I))+U[10]+38016083&4294967295,P=T+(A<<9&4294967295|A>>>23),A=L+(T^I&(P^T))+U[15]+3634488961&4294967295,L=P+(A<<14&4294967295|A>>>18),A=I+(P^T&(L^P))+U[4]+3889429448&4294967295,I=L+(A<<20&4294967295|A>>>12),A=T+(L^P&(I^L))+U[9]+568446438&4294967295,T=I+(A<<5&4294967295|A>>>27),A=P+(I^L&(T^I))+U[14]+3275163606&4294967295,P=T+(A<<9&4294967295|A>>>23),A=L+(T^I&(P^T))+U[3]+4107603335&4294967295,L=P+(A<<14&4294967295|A>>>18),A=I+(P^T&(L^P))+U[8]+1163531501&4294967295,I=L+(A<<20&4294967295|A>>>12),A=T+(L^P&(I^L))+U[13]+2850285829&4294967295,T=I+(A<<5&4294967295|A>>>27),A=P+(I^L&(T^I))+U[2]+4243563512&4294967295,P=T+(A<<9&4294967295|A>>>23),A=L+(T^I&(P^T))+U[7]+1735328473&4294967295,L=P+(A<<14&4294967295|A>>>18),A=I+(P^T&(L^P))+U[12]+2368359562&4294967295,I=L+(A<<20&4294967295|A>>>12),A=T+(I^L^P)+U[5]+4294588738&4294967295,T=I+(A<<4&4294967295|A>>>28),A=P+(T^I^L)+U[8]+2272392833&4294967295,P=T+(A<<11&4294967295|A>>>21),A=L+(P^T^I)+U[11]+1839030562&4294967295,L=P+(A<<16&4294967295|A>>>16),A=I+(L^P^T)+U[14]+4259657740&4294967295,I=L+(A<<23&4294967295|A>>>9),A=T+(I^L^P)+U[1]+2763975236&4294967295,T=I+(A<<4&4294967295|A>>>28),A=P+(T^I^L)+U[4]+1272893353&4294967295,P=T+(A<<11&4294967295|A>>>21),A=L+(P^T^I)+U[7]+4139469664&4294967295,L=P+(A<<16&4294967295|A>>>16),A=I+(L^P^T)+U[10]+3200236656&4294967295,I=L+(A<<23&4294967295|A>>>9),A=T+(I^L^P)+U[13]+681279174&4294967295,T=I+(A<<4&4294967295|A>>>28),A=P+(T^I^L)+U[0]+3936430074&4294967295,P=T+(A<<11&4294967295|A>>>21),A=L+(P^T^I)+U[3]+3572445317&4294967295,L=P+(A<<16&4294967295|A>>>16),A=I+(L^P^T)+U[6]+76029189&4294967295,I=L+(A<<23&4294967295|A>>>9),A=T+(I^L^P)+U[9]+3654602809&4294967295,T=I+(A<<4&4294967295|A>>>28),A=P+(T^I^L)+U[12]+3873151461&4294967295,P=T+(A<<11&4294967295|A>>>21),A=L+(P^T^I)+U[15]+530742520&4294967295,L=P+(A<<16&4294967295|A>>>16),A=I+(L^P^T)+U[2]+3299628645&4294967295,I=L+(A<<23&4294967295|A>>>9),A=T+(L^(I|~P))+U[0]+4096336452&4294967295,T=I+(A<<6&4294967295|A>>>26),A=P+(I^(T|~L))+U[7]+1126891415&4294967295,P=T+(A<<10&4294967295|A>>>22),A=L+(T^(P|~I))+U[14]+2878612391&4294967295,L=P+(A<<15&4294967295|A>>>17),A=I+(P^(L|~T))+U[5]+4237533241&4294967295,I=L+(A<<21&4294967295|A>>>11),A=T+(L^(I|~P))+U[12]+1700485571&4294967295,T=I+(A<<6&4294967295|A>>>26),A=P+(I^(T|~L))+U[3]+2399980690&4294967295,P=T+(A<<10&4294967295|A>>>22),A=L+(T^(P|~I))+U[10]+4293915773&4294967295,L=P+(A<<15&4294967295|A>>>17),A=I+(P^(L|~T))+U[1]+2240044497&4294967295,I=L+(A<<21&4294967295|A>>>11),A=T+(L^(I|~P))+U[8]+1873313359&4294967295,T=I+(A<<6&4294967295|A>>>26),A=P+(I^(T|~L))+U[15]+4264355552&4294967295,P=T+(A<<10&4294967295|A>>>22),A=L+(T^(P|~I))+U[6]+2734768916&4294967295,L=P+(A<<15&4294967295|A>>>17),A=I+(P^(L|~T))+U[13]+1309151649&4294967295,I=L+(A<<21&4294967295|A>>>11),A=T+(L^(I|~P))+U[4]+4149444226&4294967295,T=I+(A<<6&4294967295|A>>>26),A=P+(I^(T|~L))+U[11]+3174756917&4294967295,P=T+(A<<10&4294967295|A>>>22),A=L+(T^(P|~I))+U[2]+718787259&4294967295,L=P+(A<<15&4294967295|A>>>17),A=I+(P^(L|~T))+U[9]+3951481745&4294967295,D.g[0]=D.g[0]+T&4294967295,D.g[1]=D.g[1]+(L+(A<<21&4294967295|A>>>11))&4294967295,D.g[2]=D.g[2]+L&4294967295,D.g[3]=D.g[3]+P&4294967295}i.prototype.v=function(D,T){T===void 0&&(T=D.length);const I=T-this.blockSize,U=this.C;let L=this.h,P=0;for(;P<T;){if(L==0)for(;P<=I;)l(this,D,P),P+=this.blockSize;if(typeof D=="string"){for(;P<T;)if(U[L++]=D.charCodeAt(P++),L==this.blockSize){l(this,U),L=0;break}}else for(;P<T;)if(U[L++]=D[P++],L==this.blockSize){l(this,U),L=0;break}}this.h=L,this.o+=T},i.prototype.A=function(){var D=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);D[0]=128;for(var T=1;T<D.length-8;++T)D[T]=0;T=this.o*8;for(var I=D.length-8;I<D.length;++I)D[I]=T&255,T/=256;for(this.v(D),D=Array(16),T=0,I=0;I<4;++I)for(let U=0;U<32;U+=8)D[T++]=this.g[I]>>>U&255;return D};function u(D,T){var I=g;return Object.prototype.hasOwnProperty.call(I,D)?I[D]:I[D]=T(D)}function d(D,T){this.h=T;const I=[];let U=!0;for(let L=D.length-1;L>=0;L--){const P=D[L]|0;U&&P==T||(I[L]=P,U=!1)}this.g=I}var g={};function y(D){return-128<=D&&D<128?u(D,function(T){return new d([T|0],T<0?-1:0)}):new d([D|0],D<0?-1:0)}function p(D){if(isNaN(D)||!isFinite(D))return k;if(D<0)return B(p(-D));const T=[];let I=1;for(let U=0;D>=I;U++)T[U]=D/I|0,I*=4294967296;return new d(T,0)}function b(D,T){if(D.length==0)throw Error("number format error: empty string");if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(D.charAt(0)=="-")return B(b(D.substring(1),T));if(D.indexOf("-")>=0)throw Error('number format error: interior "-" character');const I=p(Math.pow(T,8));let U=k;for(let P=0;P<D.length;P+=8){var L=Math.min(8,D.length-P);const A=parseInt(D.substring(P,P+L),T);L<8?(L=p(Math.pow(T,L)),U=U.j(L).add(p(A))):(U=U.j(I),U=U.add(p(A)))}return U}var k=y(0),E=y(1),M=y(16777216);s=d.prototype,s.m=function(){if(K(this))return-B(this).m();let D=0,T=1;for(let I=0;I<this.g.length;I++){const U=this.i(I);D+=(U>=0?U:4294967296+U)*T,T*=4294967296}return D},s.toString=function(D){if(D=D||10,D<2||36<D)throw Error("radix out of range: "+D);if(H(this))return"0";if(K(this))return"-"+B(this).toString(D);const T=p(Math.pow(D,6));var I=this;let U="";for(;;){const L=ye(I,T).g;I=Y(I,L.j(T));let P=((I.g.length>0?I.g[0]:I.h)>>>0).toString(D);if(I=L,H(I))return P+U;for(;P.length<6;)P="0"+P;U=P+U}},s.i=function(D){return D<0?0:D<this.g.length?this.g[D]:this.h};function H(D){if(D.h!=0)return!1;for(let T=0;T<D.g.length;T++)if(D.g[T]!=0)return!1;return!0}function K(D){return D.h==-1}s.l=function(D){return D=Y(this,D),K(D)?-1:H(D)?0:1};function B(D){const T=D.g.length,I=[];for(let U=0;U<T;U++)I[U]=~D.g[U];return new d(I,~D.h).add(E)}s.abs=function(){return K(this)?B(this):this},s.add=function(D){const T=Math.max(this.g.length,D.g.length),I=[];let U=0;for(let L=0;L<=T;L++){let P=U+(this.i(L)&65535)+(D.i(L)&65535),A=(P>>>16)+(this.i(L)>>>16)+(D.i(L)>>>16);U=A>>>16,P&=65535,A&=65535,I[L]=A<<16|P}return new d(I,I[I.length-1]&-2147483648?-1:0)};function Y(D,T){return D.add(B(T))}s.j=function(D){if(H(this)||H(D))return k;if(K(this))return K(D)?B(this).j(B(D)):B(B(this).j(D));if(K(D))return B(this.j(B(D)));if(this.l(M)<0&&D.l(M)<0)return p(this.m()*D.m());const T=this.g.length+D.g.length,I=[];for(var U=0;U<2*T;U++)I[U]=0;for(U=0;U<this.g.length;U++)for(let L=0;L<D.g.length;L++){const P=this.i(U)>>>16,A=this.i(U)&65535,Le=D.i(L)>>>16,Ze=D.i(L)&65535;I[2*U+2*L]+=A*Ze,ee(I,2*U+2*L),I[2*U+2*L+1]+=P*Ze,ee(I,2*U+2*L+1),I[2*U+2*L+1]+=A*Le,ee(I,2*U+2*L+1),I[2*U+2*L+2]+=P*Le,ee(I,2*U+2*L+2)}for(D=0;D<T;D++)I[D]=I[2*D+1]<<16|I[2*D];for(D=T;D<2*T;D++)I[D]=0;return new d(I,0)};function ee(D,T){for(;(D[T]&65535)!=D[T];)D[T+1]+=D[T]>>>16,D[T]&=65535,T++}function ae(D,T){this.g=D,this.h=T}function ye(D,T){if(H(T))throw Error("division by zero");if(H(D))return new ae(k,k);if(K(D))return T=ye(B(D),T),new ae(B(T.g),B(T.h));if(K(T))return T=ye(D,B(T)),new ae(B(T.g),T.h);if(D.g.length>30){if(K(D)||K(T))throw Error("slowDivide_ only works with positive integers.");for(var I=E,U=T;U.l(D)<=0;)I=ve(I),U=ve(U);var L=he(I,1),P=he(U,1);for(U=he(U,2),I=he(I,2);!H(U);){var A=P.add(U);A.l(D)<=0&&(L=L.add(I),P=A),U=he(U,1),I=he(I,1)}return T=Y(D,L.j(T)),new ae(L,T)}for(L=k;D.l(T)>=0;){for(I=Math.max(1,Math.floor(D.m()/T.m())),U=Math.ceil(Math.log(I)/Math.LN2),U=U<=48?1:Math.pow(2,U-48),P=p(I),A=P.j(T);K(A)||A.l(D)>0;)I-=U,P=p(I),A=P.j(T);H(P)&&(P=E),L=L.add(P),D=Y(D,A)}return new ae(L,D)}s.B=function(D){return ye(this,D).h},s.and=function(D){const T=Math.max(this.g.length,D.g.length),I=[];for(let U=0;U<T;U++)I[U]=this.i(U)&D.i(U);return new d(I,this.h&D.h)},s.or=function(D){const T=Math.max(this.g.length,D.g.length),I=[];for(let U=0;U<T;U++)I[U]=this.i(U)|D.i(U);return new d(I,this.h|D.h)},s.xor=function(D){const T=Math.max(this.g.length,D.g.length),I=[];for(let U=0;U<T;U++)I[U]=this.i(U)^D.i(U);return new d(I,this.h^D.h)};function ve(D){const T=D.g.length+1,I=[];for(let U=0;U<T;U++)I[U]=D.i(U)<<1|D.i(U-1)>>>31;return new d(I,D.h)}function he(D,T){const I=T>>5;T%=32;const U=D.g.length-I,L=[];for(let P=0;P<U;P++)L[P]=T>0?D.i(P+I)>>>T|D.i(P+I+1)<<32-T:D.i(P+I);return new d(L,D.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,A_=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=p,d.fromString=b,so=d}).apply(typeof V2<"u"?V2:typeof self<"u"?self:typeof window<"u"?window:{});var uh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var R_,ou,I_,Ch,Sp,M_,D_,L_;(function(){var s,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof uh=="object"&&uh];for(var v=0;v<h.length;++v){var _=h[v];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var i=t(this);function l(h,v){if(v)e:{var _=i;h=h.split(".");for(var N=0;N<h.length-1;N++){var se=h[N];if(!(se in _))break e;_=_[se]}h=h[h.length-1],N=_[h],v=v(N),v!=N&&v!=null&&e(_,h,{configurable:!0,writable:!0,value:v})}}l("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),l("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),l("Object.entries",function(h){return h||function(v){var _=[],N;for(N in v)Object.prototype.hasOwnProperty.call(v,N)&&_.push([N,v[N]]);return _}});var u=u||{},d=this||self;function g(h){var v=typeof h;return v=="object"&&h!=null||v=="function"}function y(h,v,_){return h.call.apply(h.bind,arguments)}function p(h,v,_){return p=y,p.apply(null,arguments)}function b(h,v){var _=Array.prototype.slice.call(arguments,1);return function(){var N=_.slice();return N.push.apply(N,arguments),h.apply(this,N)}}function k(h,v){function _(){}_.prototype=v.prototype,h.Z=v.prototype,h.prototype=new _,h.prototype.constructor=h,h.Ob=function(N,se,fe){for(var Be=Array(arguments.length-2),Vt=2;Vt<arguments.length;Vt++)Be[Vt-2]=arguments[Vt];return v.prototype[se].apply(N,Be)}}var E=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function M(h){const v=h.length;if(v>0){const _=Array(v);for(let N=0;N<v;N++)_[N]=h[N];return _}return[]}function H(h,v){for(let N=1;N<arguments.length;N++){const se=arguments[N];var _=typeof se;if(_=_!="object"?_:se?Array.isArray(se)?"array":_:"null",_=="array"||_=="object"&&typeof se.length=="number"){_=h.length||0;const fe=se.length||0;h.length=_+fe;for(let Be=0;Be<fe;Be++)h[_+Be]=se[Be]}else h.push(se)}}class K{constructor(v,_){this.i=v,this.j=_,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function B(h){d.setTimeout(()=>{throw h},0)}function Y(){var h=D;let v=null;return h.g&&(v=h.g,h.g=h.g.next,h.g||(h.h=null),v.next=null),v}class ee{constructor(){this.h=this.g=null}add(v,_){const N=ae.get();N.set(v,_),this.h?this.h.next=N:this.g=N,this.h=N}}var ae=new K(()=>new ye,h=>h.reset());class ye{constructor(){this.next=this.g=this.h=null}set(v,_){this.h=v,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let ve,he=!1,D=new ee,T=()=>{const h=Promise.resolve(void 0);ve=()=>{h.then(I)}};function I(){for(var h;h=Y();){try{h.h.call(h.g)}catch(_){B(_)}var v=ae;v.j(h),v.h<100&&(v.h++,h.next=v.g,v.g=h)}he=!1}function U(){this.u=this.u,this.C=this.C}U.prototype.u=!1,U.prototype.dispose=function(){this.u||(this.u=!0,this.N())},U.prototype[Symbol.dispose]=function(){this.dispose()},U.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function L(h,v){this.type=h,this.g=this.target=v,this.defaultPrevented=!1}L.prototype.h=function(){this.defaultPrevented=!0};var P=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var h=!1,v=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const _=()=>{};d.addEventListener("test",_,v),d.removeEventListener("test",_,v)}catch{}return h})();function A(h){return/^[\s\xa0]*$/.test(h)}function Le(h,v){L.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,v)}k(Le,L),Le.prototype.init=function(h,v){const _=this.type=h.type,N=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=v,v=h.relatedTarget,v||(_=="mouseover"?v=h.fromElement:_=="mouseout"&&(v=h.toElement)),this.relatedTarget=v,N?(this.clientX=N.clientX!==void 0?N.clientX:N.pageX,this.clientY=N.clientY!==void 0?N.clientY:N.pageY,this.screenX=N.screenX||0,this.screenY=N.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&Le.Z.h.call(this)},Le.prototype.h=function(){Le.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var Ze="closure_listenable_"+(Math.random()*1e6|0),J=0;function Te(h,v,_,N,se){this.listener=h,this.proxy=null,this.src=v,this.type=_,this.capture=!!N,this.ha=se,this.key=++J,this.da=this.fa=!1}function He(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Se(h,v,_){for(const N in h)v.call(_,h[N],N,h)}function Pe(h,v){for(const _ in h)v.call(void 0,h[_],_,h)}function V(h){const v={};for(const _ in h)v[_]=h[_];return v}const ce="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function je(h,v){let _,N;for(let se=1;se<arguments.length;se++){N=arguments[se];for(_ in N)h[_]=N[_];for(let fe=0;fe<ce.length;fe++)_=ce[fe],Object.prototype.hasOwnProperty.call(N,_)&&(h[_]=N[_])}}function Ce(h){this.src=h,this.g={},this.h=0}Ce.prototype.add=function(h,v,_,N,se){const fe=h.toString();h=this.g[fe],h||(h=this.g[fe]=[],this.h++);const Be=Ue(h,v,N,se);return Be>-1?(v=h[Be],_||(v.fa=!1)):(v=new Te(v,this.src,fe,!!N,se),v.fa=_,h.push(v)),v};function ke(h,v){const _=v.type;if(_ in h.g){var N=h.g[_],se=Array.prototype.indexOf.call(N,v,void 0),fe;(fe=se>=0)&&Array.prototype.splice.call(N,se,1),fe&&(He(v),h.g[_].length==0&&(delete h.g[_],h.h--))}}function Ue(h,v,_,N){for(let se=0;se<h.length;++se){const fe=h[se];if(!fe.da&&fe.listener==v&&fe.capture==!!_&&fe.ha==N)return se}return-1}var $e="closure_lm_"+(Math.random()*1e6|0),Qe={};function Je(h,v,_,N,se){if(Array.isArray(v)){for(let fe=0;fe<v.length;fe++)Je(h,v[fe],_,N,se);return null}return _=dt(_),h&&h[Ze]?h.J(v,_,g(N)?!!N.capture:!1,se):Wt(h,v,_,!1,N,se)}function Wt(h,v,_,N,se,fe){if(!v)throw Error("Invalid event type");const Be=g(se)?!!se.capture:!!se;let Vt=pn(h);if(Vt||(h[$e]=Vt=new Ce(h)),_=Vt.add(v,_,N,Be,fe),_.proxy)return _;if(N=It(),_.proxy=N,N.src=h,N.listener=_,h.addEventListener)P||(se=Be),se===void 0&&(se=!1),h.addEventListener(v.toString(),N,se);else if(h.attachEvent)h.attachEvent(qt(v.toString()),N);else if(h.addListener&&h.removeListener)h.addListener(N);else throw Error("addEventListener and attachEvent are unavailable.");return _}function It(){function h(_){return v.call(h.src,h.listener,_)}const v=Et;return h}function Cn(h,v,_,N,se){if(Array.isArray(v))for(var fe=0;fe<v.length;fe++)Cn(h,v[fe],_,N,se);else N=g(N)?!!N.capture:!!N,_=dt(_),h&&h[Ze]?(h=h.i,fe=String(v).toString(),fe in h.g&&(v=h.g[fe],_=Ue(v,_,N,se),_>-1&&(He(v[_]),Array.prototype.splice.call(v,_,1),v.length==0&&(delete h.g[fe],h.h--)))):h&&(h=pn(h))&&(v=h.g[v.toString()],h=-1,v&&(h=Ue(v,_,N,se)),(_=h>-1?v[h]:null)&&ln(_))}function ln(h){if(typeof h!="number"&&h&&!h.da){var v=h.src;if(v&&v[Ze])ke(v.i,h);else{var _=h.type,N=h.proxy;v.removeEventListener?v.removeEventListener(_,N,h.capture):v.detachEvent?v.detachEvent(qt(_),N):v.addListener&&v.removeListener&&v.removeListener(N),(_=pn(v))?(ke(_,h),_.h==0&&(_.src=null,v[$e]=null)):He(h)}}}function qt(h){return h in Qe?Qe[h]:Qe[h]="on"+h}function Et(h,v){if(h.da)h=!0;else{v=new Le(v,this);const _=h.listener,N=h.ha||h.src;h.fa&&ln(h),h=_.call(N,v)}return h}function pn(h){return h=h[$e],h instanceof Ce?h:null}var Tt="__closure_events_fn_"+(Math.random()*1e9>>>0);function dt(h){return typeof h=="function"?h:(h[Tt]||(h[Tt]=function(v){return h.handleEvent(v)}),h[Tt])}function le(){U.call(this),this.i=new Ce(this),this.M=this,this.G=null}k(le,U),le.prototype[Ze]=!0,le.prototype.removeEventListener=function(h,v,_,N){Cn(this,h,v,_,N)};function pt(h,v){var _,N=h.G;if(N)for(_=[];N;N=N.G)_.push(N);if(h=h.M,N=v.type||v,typeof v=="string")v=new L(v,h);else if(v instanceof L)v.target=v.target||h;else{var se=v;v=new L(N,h),je(v,se)}se=!0;let fe,Be;if(_)for(Be=_.length-1;Be>=0;Be--)fe=v.g=_[Be],se=Ht(fe,N,!0,v)&&se;if(fe=v.g=h,se=Ht(fe,N,!0,v)&&se,se=Ht(fe,N,!1,v)&&se,_)for(Be=0;Be<_.length;Be++)fe=v.g=_[Be],se=Ht(fe,N,!1,v)&&se}le.prototype.N=function(){if(le.Z.N.call(this),this.i){var h=this.i;for(const v in h.g){const _=h.g[v];for(let N=0;N<_.length;N++)He(_[N]);delete h.g[v],h.h--}}this.G=null},le.prototype.J=function(h,v,_,N){return this.i.add(String(h),v,!1,_,N)},le.prototype.K=function(h,v,_,N){return this.i.add(String(h),v,!0,_,N)};function Ht(h,v,_,N){if(v=h.i.g[String(v)],!v)return!0;v=v.concat();let se=!0;for(let fe=0;fe<v.length;++fe){const Be=v[fe];if(Be&&!Be.da&&Be.capture==_){const Vt=Be.listener,cs=Be.ha||Be.src;Be.fa&&ke(h.i,Be),se=Vt.call(cs,N)!==!1&&se}}return se&&!N.defaultPrevented}function it(h,v){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=p(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:d.setTimeout(h,v||0)}function yt(h){h.g=it(()=>{h.g=null,h.i&&(h.i=!1,yt(h))},h.l);const v=h.h;h.h=null,h.m.apply(null,v)}class gt extends U{constructor(v,_){super(),this.m=v,this.l=_,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:yt(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function _t(h){U.call(this),this.h=h,this.g={}}k(_t,U);var zt=[];function fs(h){Se(h.g,function(v,_){this.g.hasOwnProperty(_)&&ln(v)},h),h.g={}}_t.prototype.N=function(){_t.Z.N.call(this),fs(this)},_t.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var rn=d.JSON.stringify,Zn=d.JSON.parse,Fn=class{stringify(h){return d.JSON.stringify(h,void 0)}parse(h){return d.JSON.parse(h,void 0)}};function Ln(){}function Pn(){}var un={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Gt(){L.call(this,"d")}k(Gt,L);function Ct(){L.call(this,"c")}k(Ct,L);var Mt={},Z=null;function C(){return Z=Z||new le}Mt.Ia="serverreachability";function te(h){L.call(this,Mt.Ia,h)}k(te,L);function Re(h){const v=C();pt(v,new te(v))}Mt.STAT_EVENT="statevent";function Ie(h,v){L.call(this,Mt.STAT_EVENT,h),this.stat=v}k(Ie,L);function Me(h){const v=C();pt(v,new Ie(v,h))}Mt.Ja="timingevent";function Fe(h,v){L.call(this,Mt.Ja,h),this.size=v}k(Fe,L);function Oe(h,v){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){h()},v)}function Nt(){this.g=!0}Nt.prototype.ua=function(){this.g=!1};function bt(h,v,_,N,se,fe){h.info(function(){if(h.g)if(fe){var Be="",Vt=fe.split("&");for(let xn=0;xn<Vt.length;xn++){var cs=Vt[xn].split("=");if(cs.length>1){const qn=cs[0];cs=cs[1];const Br=qn.split("_");Be=Br.length>=2&&Br[1]=="type"?Be+(qn+"="+cs+"&"):Be+(qn+"=redacted&")}}}else Be=null;else Be=fe;return"XMLHTTP REQ ("+N+") [attempt "+se+"]: "+v+`
`+_+`
`+Be})}function lt(h,v,_,N,se,fe,Be){h.info(function(){return"XMLHTTP RESP ("+N+") [ attempt "+se+"]: "+v+`
`+_+`
`+fe+" "+Be})}function dn(h,v,_,N){h.info(function(){return"XMLHTTP TEXT ("+v+"): "+On(h,_)+(N?" "+N:"")})}function hn(h,v){h.info(function(){return"TIMEOUT: "+v})}Nt.prototype.info=function(){};function On(h,v){if(!h.g)return v;if(!v)return null;try{const fe=JSON.parse(v);if(fe){for(h=0;h<fe.length;h++)if(Array.isArray(fe[h])){var _=fe[h];if(!(_.length<2)){var N=_[1];if(Array.isArray(N)&&!(N.length<1)){var se=N[0];if(se!="noop"&&se!="stop"&&se!="close")for(let Be=1;Be<N.length;Be++)N[Be]=""}}}}return rn(fe)}catch{return v}}var ms={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ue={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},De;function Ke(){}k(Ke,Ln),Ke.prototype.g=function(){return new XMLHttpRequest},De=new Ke;function ct(h){return encodeURIComponent(String(h))}function rt(h){var v=1;h=h.split(":");const _=[];for(;v>0&&h.length;)_.push(h.shift()),v--;return h.length&&_.push(h.join(":")),_}function Kt(h,v,_,N){this.j=h,this.i=v,this.l=_,this.S=N||1,this.V=new _t(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new fn}function fn(){this.i=null,this.g="",this.h=!1}var At={},St={};function bn(h,v,_){h.M=1,h.A=Rt(ne(v)),h.u=_,h.R=!0,Ss(h,null)}function Ss(h,v){h.F=Date.now(),js(h),h.B=ne(h.A);var _=h.B,N=h.S;Array.isArray(N)||(N=[String(N)]),ki(_.i,"t",N),h.C=0,_=h.j.L,h.h=new fn,h.g=ed(h.j,_?v:null,!h.u),h.P>0&&(h.O=new gt(p(h.Y,h,h.g),h.P)),v=h.V,_=h.g,N=h.ba;var se="readystatechange";Array.isArray(se)||(se&&(zt[0]=se.toString()),se=zt);for(let fe=0;fe<se.length;fe++){const Be=Je(_,se[fe],N||v.handleEvent,!1,v.h||v);if(!Be)break;v.g[Be.key]=Be}v=h.J?V(h.J):{},h.u?(h.v||(h.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,v)):(h.v="GET",h.g.ea(h.B,h.v,null,v)),Re(),bt(h.i,h.v,h.B,h.l,h.S,h.u)}Kt.prototype.ba=function(h){h=h.target;const v=this.O;v&&Hn(h)==3?v.j():this.Y(h)},Kt.prototype.Y=function(h){try{if(h==this.g)e:{const Vt=Hn(this.g),cs=this.g.ya(),xn=this.g.ca();if(!(Vt<3)&&(Vt!=3||this.g&&(this.h.h||this.g.la()||tt(this.g)))){this.K||Vt!=4||cs==7||(cs==8||xn<=0?Re(3):Re(2)),Kn(this);var v=this.g.ca();this.X=v;var _=si(this);if(this.o=v==200,lt(this.i,this.v,this.B,this.l,this.S,Vt,v),this.o){if(this.U&&!this.L){t:{if(this.g){var N,se=this.g;if((N=se.g?se.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(N)){var fe=N;break t}}fe=null}if(h=fe)dn(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Vn(this,h);else{this.o=!1,this.m=3,Me(12),ls(this),os(this);break e}}if(this.R){h=!0;let qn;for(;!this.K&&this.C<_.length;)if(qn=Or(this,_),qn==St){Vt==4&&(this.m=4,Me(14),h=!1),dn(this.i,this.l,null,"[Incomplete Response]");break}else if(qn==At){this.m=4,Me(15),dn(this.i,this.l,_,"[Invalid Chunk]"),h=!1;break}else dn(this.i,this.l,qn,null),Vn(this,qn);if(xi(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Vt!=4||_.length!=0||this.h.h||(this.m=1,Me(16),h=!1),this.o=this.o&&h,!h)dn(this.i,this.l,_,"[Invalid Chunked Response]"),ls(this),os(this);else if(_.length>0&&!this.W){this.W=!0;var Be=this.j;Be.g==this&&Be.aa&&!Be.P&&(Be.j.info("Great, no buffering proxy detected. Bytes received: "+_.length),hc(Be),Be.P=!0,Me(11))}}else dn(this.i,this.l,_,null),Vn(this,_);Vt==4&&ls(this),this.o&&!this.K&&(Vt==4?Qu(this.j,this):(this.o=!1,js(this)))}else mn(this.g),v==400&&_.indexOf("Unknown SID")>0?(this.m=3,Me(12)):(this.m=0,Me(13)),ls(this),os(this)}}}catch{}};function si(h){if(!xi(h))return h.g.la();const v=tt(h.g);if(v==="")return"";let _="";const N=v.length,se=Hn(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return ls(h),os(h),"";h.h.i=new d.TextDecoder}for(let fe=0;fe<N;fe++)h.h.h=!0,_+=h.h.i.decode(v[fe],{stream:!(se&&fe==N-1)});return v.length=0,h.h.g+=_,h.C=0,h.h.g}function xi(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function Or(h,v){var _=h.C,N=v.indexOf(`
`,_);return N==-1?St:(_=Number(v.substring(_,N)),isNaN(_)?At:(N+=1,N+_>v.length?St:(v=v.slice(N,N+_),h.C=N+_,v)))}Kt.prototype.cancel=function(){this.K=!0,ls(this)};function js(h){h.T=Date.now()+h.H,hr(h,h.H)}function hr(h,v){if(h.D!=null)throw Error("WatchDog timer not null");h.D=Oe(p(h.aa,h),v)}function Kn(h){h.D&&(d.clearTimeout(h.D),h.D=null)}Kt.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(hn(this.i,this.B),this.M!=2&&(Re(),Me(17)),ls(this),this.m=2,os(this)):hr(this,this.T-h)};function os(h){h.j.I==0||h.K||Qu(h.j,h)}function ls(h){Kn(h);var v=h.O;v&&typeof v.dispose=="function"&&v.dispose(),h.O=null,fs(h.V),h.g&&(v=h.g,h.g=null,v.abort(),v.dispose())}function Vn(h,v){try{var _=h.j;if(_.I!=0&&(_.g==h||Yn(_.h,h))){if(!h.L&&Yn(_.h,h)&&_.I==3){try{var N=_.Ba.g.parse(v)}catch{N=null}if(Array.isArray(N)&&N.length==3){var se=N;if(se[0]==0){e:if(!_.v){if(_.g)if(_.g.F+3e3<h.F)rl(_),Xn(_);else break e;ai(_),Me(18)}}else _.xa=se[1],0<_.xa-_.K&&se[2]<37500&&_.F&&_.A==0&&!_.C&&(_.C=Oe(p(_.Va,_),6e3));qs(_.h)<=1&&_.ta&&(_.ta=void 0)}else ji(_,11)}else if((h.L||_.g==h)&&rl(_),!A(v))for(se=_.Ba.g.parse(v),v=0;v<se.length;v++){let xn=se[v];const qn=xn[0];if(!(qn<=_.K))if(_.K=qn,xn=xn[1],_.I==2)if(xn[0]=="c"){_.M=xn[1],_.ba=xn[2];const Br=xn[3];Br!=null&&(_.ka=Br,_.j.info("VER="+_.ka));const Ei=xn[4];Ei!=null&&(_.za=Ei,_.j.info("SVER="+_.za));const oi=xn[5];oi!=null&&typeof oi=="number"&&oi>0&&(N=1.5*oi,_.O=N,_.j.info("backChannelRequestTimeoutMs_="+N)),N=_;const li=h.g;if(li){const vo=li.g?li.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(vo){var fe=N.h;fe.g||vo.indexOf("spdy")==-1&&vo.indexOf("quic")==-1&&vo.indexOf("h2")==-1||(fe.j=fe.l,fe.g=new Set,fe.h&&(jr(fe,fe.h),fe.h=null))}if(N.G){const il=li.g?li.g.getResponseHeader("X-HTTP-Session-Id"):null;il&&(N.wa=il,ot(N.J,N.G,il))}}_.I=3,_.l&&_.l.ra(),_.aa&&(_.T=Date.now()-h.F,_.j.info("Handshake RTT: "+_.T+"ms")),N=_;var Be=h;if(N.na=Zu(N,N.L?N.ba:null,N.W),Be.L){ts(N.h,Be);var Vt=Be,cs=N.O;cs&&(Vt.H=cs),Vt.D&&(Kn(Vt),js(Vt)),N.g=Be}else sl(N);_.i.length>0&&Gs(_)}else xn[0]!="stop"&&xn[0]!="close"||ji(_,7);else _.I==3&&(xn[0]=="stop"||xn[0]=="close"?xn[0]=="stop"?ji(_,7):gn(_):xn[0]!="noop"&&_.l&&_.l.qa(xn),_.A=0)}}Re(4)}catch{}}var wn=class{constructor(h,v){this.g=h,this.map=v}};function es(h){this.l=h||10,d.PerformanceNavigationTiming?(h=d.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function kr(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function qs(h){return h.h?1:h.g?h.g.size:0}function Yn(h,v){return h.h?h.h==v:h.g?h.g.has(v):!1}function jr(h,v){h.g?h.g.add(v):h.h=v}function ts(h,v){h.h&&h.h==v?h.h=null:h.g&&h.g.has(v)&&h.g.delete(v)}es.prototype.cancel=function(){if(this.i=Vr(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Vr(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let v=h.i;for(const _ of h.g.values())v=v.concat(_.G);return v}return M(h.i)}var O=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function q(h,v){if(h){h=h.split("&");for(let _=0;_<h.length;_++){const N=h[_].indexOf("=");let se,fe=null;N>=0?(se=h[_].substring(0,N),fe=h[_].substring(N+1)):se=h[_],v(se,fe?decodeURIComponent(fe.replace(/\+/g," ")):"")}}}function oe(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;h instanceof oe?(this.l=h.l,Ye(this,h.j),this.o=h.o,this.g=h.g,Ge(this,h.u),this.h=h.h,qe(this,Fi(h.i)),this.m=h.m):h&&(v=String(h).match(O))?(this.l=!1,Ye(this,v[1]||"",!0),this.o=Nn(v[2]||""),this.g=Nn(v[3]||"",!0),Ge(this,v[4]),this.h=Nn(v[5]||"",!0),qe(this,v[6]||"",!0),this.m=Nn(v[7]||"")):(this.l=!1,this.i=new Er(null,this.l))}oe.prototype.toString=function(){const h=[];var v=this.j;v&&h.push(Cs(v,Ms,!0),":");var _=this.g;return(_||v=="file")&&(h.push("//"),(v=this.o)&&h.push(Cs(v,Ms,!0),"@"),h.push(ct(_).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.u,_!=null&&h.push(":",String(_))),(_=this.h)&&(this.g&&_.charAt(0)!="/"&&h.push("/"),h.push(Cs(_,_.charAt(0)=="/"?Ds:ri,!0))),(_=this.i.toString())&&h.push("?",_),(_=this.m)&&h.push("#",Cs(_,_i)),h.join("")},oe.prototype.resolve=function(h){const v=ne(this);let _=!!h.j;_?Ye(v,h.j):_=!!h.o,_?v.o=h.o:_=!!h.g,_?v.g=h.g:_=h.u!=null;var N=h.h;if(_)Ge(v,h.u);else if(_=!!h.h){if(N.charAt(0)!="/")if(this.g&&!this.h)N="/"+N;else{var se=v.h.lastIndexOf("/");se!=-1&&(N=v.h.slice(0,se+1)+N)}if(se=N,se==".."||se==".")N="";else if(se.indexOf("./")!=-1||se.indexOf("/.")!=-1){N=se.lastIndexOf("/",0)==0,se=se.split("/");const fe=[];for(let Be=0;Be<se.length;){const Vt=se[Be++];Vt=="."?N&&Be==se.length&&fe.push(""):Vt==".."?((fe.length>1||fe.length==1&&fe[0]!="")&&fe.pop(),N&&Be==se.length&&fe.push("")):(fe.push(Vt),N=!0)}N=fe.join("/")}else N=se}return _?v.h=N:_=h.i.toString()!=="",_?qe(v,Fi(h.i)):_=!!h.m,_&&(v.m=h.m),v};function ne(h){return new oe(h)}function Ye(h,v,_){h.j=_?Nn(v,!0):v,h.j&&(h.j=h.j.replace(/:$/,""))}function Ge(h,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);h.u=v}else h.u=null}function qe(h,v,_){v instanceof Er?(h.i=v,Tr(h.i,h.l)):(_||(v=Cs(v,er)),h.i=new Er(v,h.l))}function ot(h,v,_){h.i.set(v,_)}function Rt(h){return ot(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function Nn(h,v){return h?v?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Cs(h,v,_){return typeof h=="string"?(h=encodeURI(h).replace(v,Qn),_&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Qn(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Ms=/[#\/\?@]/g,ri=/[#\?:]/g,Ds=/[#\?]/g,er=/[#\?@]/g,_i=/#/g;function Er(h,v){this.h=this.g=null,this.i=h||null,this.j=!!v}function Ns(h){h.g||(h.g=new Map,h.h=0,h.i&&q(h.i,function(v,_){h.add(decodeURIComponent(v.replace(/\+/g," ")),_)}))}s=Er.prototype,s.add=function(h,v){Ns(this),this.i=null,h=Ur(this,h);let _=this.g.get(h);return _||this.g.set(h,_=[]),_.push(v),this.h+=1,this};function Ea(h,v){Ns(h),v=Ur(h,v),h.g.has(v)&&(h.i=null,h.h-=h.g.get(v).length,h.g.delete(v))}function zi(h,v){return Ns(h),v=Ur(h,v),h.g.has(v)}s.forEach=function(h,v){Ns(this),this.g.forEach(function(_,N){_.forEach(function(se){h.call(v,se,N,this)},this)},this)};function ii(h,v){Ns(h);let _=[];if(typeof v=="string")zi(h,v)&&(_=_.concat(h.g.get(Ur(h,v))));else for(h=Array.from(h.g.values()),v=0;v<h.length;v++)_=_.concat(h[v]);return _}s.set=function(h,v){return Ns(this),this.i=null,h=Ur(this,h),zi(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[v]),this.h+=1,this},s.get=function(h,v){return h?(h=ii(this,h),h.length>0?String(h[0]):v):v};function ki(h,v,_){Ea(h,v),_.length>0&&(h.i=null,h.g.set(Ur(h,v),M(_)),h.h+=_.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],v=Array.from(this.g.keys());for(let N=0;N<v.length;N++){var _=v[N];const se=ct(_);_=ii(this,_);for(let fe=0;fe<_.length;fe++){let Be=se;_[fe]!==""&&(Be+="="+ct(_[fe])),h.push(Be)}}return this.i=h.join("&")};function Fi(h){const v=new Er;return v.i=h.i,h.g&&(v.g=new Map(h.g),v.h=h.h),v}function Ur(h,v){return v=String(v),h.j&&(v=v.toLowerCase()),v}function Tr(h,v){v&&!h.j&&(Ns(h),h.i=null,h.g.forEach(function(_,N){const se=N.toLowerCase();N!=se&&(Ea(this,N),ki(this,se,_))},h)),h.j=v}function $s(h,v){const _=new Nt;if(d.Image){const N=new Image;N.onload=b(Ls,_,"TestLoadImage: loaded",!0,v,N),N.onerror=b(Ls,_,"TestLoadImage: error",!1,v,N),N.onabort=b(Ls,_,"TestLoadImage: abort",!1,v,N),N.ontimeout=b(Ls,_,"TestLoadImage: timeout",!1,v,N),d.setTimeout(function(){N.ontimeout&&N.ontimeout()},1e4),N.src=h}else v(!1)}function Ws(h,v){const _=new Nt,N=new AbortController,se=setTimeout(()=>{N.abort(),Ls(_,"TestPingServer: timeout",!1,v)},1e4);fetch(h,{signal:N.signal}).then(fe=>{clearTimeout(se),fe.ok?Ls(_,"TestPingServer: ok",!0,v):Ls(_,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(se),Ls(_,"TestPingServer: error",!1,v)})}function Ls(h,v,_,N,se){try{se&&(se.onload=null,se.onerror=null,se.onabort=null,se.ontimeout=null),N(_)}catch{}}function S(){this.g=new Fn}function Q(h){this.i=h.Sb||null,this.h=h.ab||!1}k(Q,Ln),Q.prototype.g=function(){return new Ae(this.i,this.h)};function Ae(h,v){le.call(this),this.H=h,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}k(Ae,le),s=Ae.prototype,s.open=function(h,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=v,this.readyState=1,$(this)},s.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(v.body=h),(this.H||d).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,F(this)),this.readyState=0},s.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,$(this)),this.g&&(this.readyState=3,$(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;R(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function R(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}s.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var v=h.value?h.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!h.done}))&&(this.response=this.responseText+=v)}h.done?F(this):$(this),this.readyState==3&&R(this)}},s.Oa=function(h){this.g&&(this.response=this.responseText=h,F(this))},s.Na=function(h){this.g&&(this.response=h,F(this))},s.ga=function(){this.g&&F(this)};function F(h){h.readyState=4,h.l=null,h.j=null,h.B=null,$(h)}s.setRequestHeader=function(h,v){this.A.append(h,v)},s.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],v=this.h.entries();for(var _=v.next();!_.done;)_=_.value,h.push(_[0]+": "+_[1]),_=v.next();return h.join(`\r
`)};function $(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Ae.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function G(h){let v="";return Se(h,function(_,N){v+=N,v+=":",v+=_,v+=`\r
`}),v}function me(h,v,_){e:{for(N in _){var N=!1;break e}N=!0}N||(_=G(_),typeof h=="string"?_!=null&&ct(_):ot(h,v,_))}function be(h){le.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}k(be,le);var Ve=/^https?$/i,nt=["POST","PUT"];s=be.prototype,s.Fa=function(h){this.H=h},s.ea=function(h,v,_,N){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);v=v?v.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():De.g(),this.g.onreadystatechange=E(p(this.Ca,this));try{this.B=!0,this.g.open(v,String(h),!0),this.B=!1}catch(fe){st(this,fe);return}if(h=_||"",_=new Map(this.headers),N)if(Object.getPrototypeOf(N)===Object.prototype)for(var se in N)_.set(se,N[se]);else if(typeof N.keys=="function"&&typeof N.get=="function")for(const fe of N.keys())_.set(fe,N.get(fe));else throw Error("Unknown input type for opt_headers: "+String(N));N=Array.from(_.keys()).find(fe=>fe.toLowerCase()=="content-type"),se=d.FormData&&h instanceof d.FormData,!(Array.prototype.indexOf.call(nt,v,void 0)>=0)||N||se||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[fe,Be]of _)this.g.setRequestHeader(fe,Be);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(fe){st(this,fe)}};function st(h,v){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=v,h.o=5,vt(h),Xt(h)}function vt(h){h.A||(h.A=!0,pt(h,"complete"),pt(h,"error"))}s.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,pt(this,"complete"),pt(this,"abort"),Xt(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Xt(this,!0)),be.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?kt(this):this.Xa())},s.Xa=function(){kt(this)};function kt(h){if(h.h&&typeof u<"u"){if(h.v&&Hn(h)==4)setTimeout(h.Ca.bind(h),0);else if(pt(h,"readystatechange"),Hn(h)==4){h.h=!1;try{const fe=h.ca();e:switch(fe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var _;if(!(_=v)){var N;if(N=fe===0){let Be=String(h.D).match(O)[1]||null;!Be&&d.self&&d.self.location&&(Be=d.self.location.protocol.slice(0,-1)),N=!Ve.test(Be?Be.toLowerCase():"")}_=N}if(_)pt(h,"complete"),pt(h,"success");else{h.o=6;try{var se=Hn(h)>2?h.g.statusText:""}catch{se=""}h.l=se+" ["+h.ca()+"]",vt(h)}}finally{Xt(h)}}}}function Xt(h,v){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const _=h.g;h.g=null,v||pt(h,"ready");try{_.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function Hn(h){return h.g?h.g.readyState:0}s.ca=function(){try{return Hn(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(h){if(this.g){var v=this.g.responseText;return h&&v.indexOf(h)==0&&(v=v.substring(h.length)),Zn(v)}};function tt(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function mn(h){const v={};h=(h.g&&Hn(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let N=0;N<h.length;N++){if(A(h[N]))continue;var _=rt(h[N]);const se=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const fe=v[se]||[];v[se]=fe,fe.push(_)}Pe(v,function(N){return N.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function an(h,v,_){return _&&_.internalChannelParams&&_.internalChannelParams[h]||v}function mt(h){this.za=0,this.i=[],this.j=new Nt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=an("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=an("baseRetryDelayMs",5e3,h),this.Za=an("retryDelaySeedMs",1e4,h),this.Ta=an("forwardChannelMaxRetries",2,h),this.va=an("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new es(h&&h.concurrentRequestLimit),this.Ba=new S,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=mt.prototype,s.ka=8,s.I=1,s.connect=function(h,v,_,N){Me(0),this.W=h,this.H=v||{},_&&N!==void 0&&(this.H.OSID=_,this.H.OAID=N),this.F=this.X,this.J=Zu(this,null,this.W),Gs(this)};function gn(h){if(tr(h),h.I==3){var v=h.V++,_=ne(h.J);if(ot(_,"SID",h.M),ot(_,"RID",v),ot(_,"TYPE","terminate"),Sr(h,_),v=new Kt(h,h.j,v),v.M=2,v.A=Rt(ne(_)),_=!1,d.navigator&&d.navigator.sendBeacon)try{_=d.navigator.sendBeacon(v.A.toString(),"")}catch{}!_&&d.Image&&(new Image().src=v.A,_=!0),_||(v.g=ed(v.j,null),v.g.ea(v.A)),v.F=Date.now(),js(v)}Ju(h)}function Xn(h){h.g&&(hc(h),h.g.cancel(),h.g=null)}function tr(h){Xn(h),h.v&&(d.clearTimeout(h.v),h.v=null),rl(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&d.clearTimeout(h.m),h.m=null)}function Gs(h){if(!kr(h.h)&&!h.m){h.m=!0;var v=h.Ea;ve||T(),he||(ve(),he=!0),D.add(v,h),h.D=0}}function As(h,v){return qs(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=v.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=Oe(p(h.Ea,h,v),Xu(h,h.D)),h.D++,!0)}s.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const se=new Kt(this,this.j,h);let fe=this.o;if(this.U&&(fe?(fe=V(fe),je(fe,this.U)):fe=this.U),this.u!==null||this.R||(se.J=fe,fe=null),this.S)e:{for(var v=0,_=0;_<this.i.length;_++){t:{var N=this.i[_];if("__data__"in N.map&&(N=N.map.__data__,typeof N=="string")){N=N.length;break t}N=void 0}if(N===void 0)break;if(v+=N,v>4096){v=_;break e}if(v===4096||_===this.i.length-1){v=_+1;break e}}v=1e3}else v=1e3;v=yo(this,se,v),_=ne(this.J),ot(_,"RID",h),ot(_,"CVER",22),this.G&&ot(_,"X-HTTP-Session-Id",this.G),Sr(this,_),fe&&(this.R?v="headers="+ct(G(fe))+"&"+v:this.u&&me(_,this.u,fe)),jr(this.h,se),this.Ra&&ot(_,"TYPE","init"),this.S?(ot(_,"$req",v),ot(_,"SID","null"),se.U=!0,bn(se,_,null)):bn(se,_,v),this.I=2}}else this.I==3&&(h?nr(this,h):this.i.length==0||kr(this.h)||nr(this))};function nr(h,v){var _;v?_=v.l:_=h.V++;const N=ne(h.J);ot(N,"SID",h.M),ot(N,"RID",_),ot(N,"AID",h.K),Sr(h,N),h.u&&h.o&&me(N,h.u,h.o),_=new Kt(h,h.j,_,h.D+1),h.u===null&&(_.J=h.o),v&&(h.i=v.G.concat(h.i)),v=yo(h,_,1e3),_.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),jr(h.h,_),bn(_,N,v)}function Sr(h,v){h.H&&Se(h.H,function(_,N){ot(v,N,_)}),h.l&&Se({},function(_,N){ot(v,N,_)})}function yo(h,v,_){_=Math.min(h.i.length,_);const N=h.l?p(h.l.Ka,h.l,h):null;e:{var se=h.i;let Vt=-1;for(;;){const cs=["count="+_];Vt==-1?_>0?(Vt=se[0].g,cs.push("ofs="+Vt)):Vt=0:cs.push("ofs="+Vt);let xn=!0;for(let qn=0;qn<_;qn++){var fe=se[qn].g;const Br=se[qn].map;if(fe-=Vt,fe<0)Vt=Math.max(0,se[qn].g-100),xn=!1;else try{fe="req"+fe+"_"||"";try{var Be=Br instanceof Map?Br:Object.entries(Br);for(const[Ei,oi]of Be){let li=oi;g(oi)&&(li=rn(oi)),cs.push(fe+Ei+"="+encodeURIComponent(li))}}catch(Ei){throw cs.push(fe+"type="+encodeURIComponent("_badmap")),Ei}}catch{N&&N(Br)}}if(xn){Be=cs.join("&");break e}}Be=void 0}return h=h.i.splice(0,_),v.G=h,Be}function sl(h){if(!h.g&&!h.v){h.Y=1;var v=h.Da;ve||T(),he||(ve(),he=!0),D.add(v,h),h.A=0}}function ai(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=Oe(p(h.Da,h),Xu(h,h.A)),h.A++,!0)}s.Da=function(){if(this.v=null,Yu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=Oe(p(this.Wa,this),h)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Me(10),Xn(this),Yu(this))};function hc(h){h.B!=null&&(d.clearTimeout(h.B),h.B=null)}function Yu(h){h.g=new Kt(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var v=ne(h.na);ot(v,"RID","rpc"),ot(v,"SID",h.M),ot(v,"AID",h.K),ot(v,"CI",h.F?"0":"1"),!h.F&&h.ia&&ot(v,"TO",h.ia),ot(v,"TYPE","xmlhttp"),Sr(h,v),h.u&&h.o&&me(v,h.u,h.o),h.O&&(h.g.H=h.O);var _=h.g;h=h.ba,_.M=1,_.A=Rt(ne(v)),_.u=null,_.R=!0,Ss(_,h)}s.Va=function(){this.C!=null&&(this.C=null,Xn(this),ai(this),Me(19))};function rl(h){h.C!=null&&(d.clearTimeout(h.C),h.C=null)}function Qu(h,v){var _=null;if(h.g==v){rl(h),hc(h),h.g=null;var N=2}else if(Yn(h.h,v))_=v.G,ts(h.h,v),N=1;else return;if(h.I!=0){if(v.o)if(N==1){_=v.u?v.u.length:0,v=Date.now()-v.F;var se=h.D;N=C(),pt(N,new Fe(N,_)),Gs(h)}else sl(h);else if(se=v.m,se==3||se==0&&v.X>0||!(N==1&&As(h,v)||N==2&&ai(h)))switch(_&&_.length>0&&(v=h.h,v.i=v.i.concat(_)),se){case 1:ji(h,5);break;case 4:ji(h,10);break;case 3:ji(h,6);break;default:ji(h,2)}}}function Xu(h,v){let _=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(_*=2),_*v}function ji(h,v){if(h.j.info("Error code "+v),v==2){var _=p(h.bb,h),N=h.Ua;const se=!N;N=new oe(N||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||Ye(N,"https"),Rt(N),se?$s(N.toString(),_):Ws(N.toString(),_)}else Me(2);h.I=0,h.l&&h.l.pa(v),Ju(h),tr(h)}s.bb=function(h){h?(this.j.info("Successfully pinged google.com"),Me(2)):(this.j.info("Failed to ping google.com"),Me(1))};function Ju(h){if(h.I=0,h.ja=[],h.l){const v=Vr(h.h);(v.length!=0||h.i.length!=0)&&(H(h.ja,v),H(h.ja,h.i),h.h.i.length=0,M(h.i),h.i.length=0),h.l.oa()}}function Zu(h,v,_){var N=_ instanceof oe?ne(_):new oe(_);if(N.g!="")v&&(N.g=v+"."+N.g),Ge(N,N.u);else{var se=d.location;N=se.protocol,v=v?v+"."+se.hostname:se.hostname,se=+se.port;const fe=new oe(null);N&&Ye(fe,N),v&&(fe.g=v),se&&Ge(fe,se),_&&(fe.h=_),N=fe}return _=h.G,v=h.wa,_&&v&&ot(N,_,v),ot(N,"VER",h.ka),Sr(h,N),N}function ed(h,v,_){if(v&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=h.Aa&&!h.ma?new be(new Q({ab:_})):new be(h.ma),v.Fa(h.L),v}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function td(){}s=td.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function Ta(){}Ta.prototype.g=function(h,v){return new sr(h,v)};function sr(h,v){le.call(this),this.g=new mt(v),this.l=h,this.h=v&&v.messageUrlParams||null,h=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(h?h["X-WebChannel-Content-Type"]=v.messageContentType:h={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(h?h["X-WebChannel-Client-Profile"]=v.sa:h={"X-WebChannel-Client-Profile":v.sa}),this.g.U=h,(h=v&&v.Qb)&&!A(h)&&(this.g.u=h),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!A(v)&&(this.g.G=v,h=this.h,h!==null&&v in h&&(h=this.h,v in h&&delete h[v])),this.j=new Hi(this)}k(sr,le),sr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},sr.prototype.close=function(){gn(this.g)},sr.prototype.o=function(h){var v=this.g;if(typeof h=="string"){var _={};_.__data__=h,h=_}else this.v&&(_={},_.__data__=rn(h),h=_);v.i.push(new wn(v.Ya++,h)),v.I==3&&Gs(v)},sr.prototype.N=function(){this.g.l=null,delete this.j,gn(this.g),delete this.g,sr.Z.N.call(this)};function nd(h){Gt.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var v=h.__sm__;if(v){e:{for(const _ in v){h=_;break e}h=void 0}(this.i=h)&&(h=this.i,v=v!==null&&h in v?v[h]:void 0),this.data=v}else this.data=h}k(nd,Gt);function sd(){Ct.call(this),this.status=1}k(sd,Ct);function Hi(h){this.g=h}k(Hi,td),Hi.prototype.ra=function(){pt(this.g,"a")},Hi.prototype.qa=function(h){pt(this.g,new nd(h))},Hi.prototype.pa=function(h){pt(this.g,new sd)},Hi.prototype.oa=function(){pt(this.g,"b")},Ta.prototype.createWebChannel=Ta.prototype.g,sr.prototype.send=sr.prototype.o,sr.prototype.open=sr.prototype.m,sr.prototype.close=sr.prototype.close,L_=function(){return new Ta},D_=function(){return C()},M_=Mt,Sp={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ms.NO_ERROR=0,ms.TIMEOUT=8,ms.HTTP_ERROR=6,Ch=ms,ue.COMPLETE="complete",I_=ue,Pn.EventType=un,un.OPEN="a",un.CLOSE="b",un.ERROR="c",un.MESSAGE="d",le.prototype.listen=le.prototype.J,ou=Pn,be.prototype.listenOnce=be.prototype.K,be.prototype.getLastError=be.prototype.Ha,be.prototype.getLastErrorCode=be.prototype.ya,be.prototype.getStatus=be.prototype.ca,be.prototype.getResponseJson=be.prototype.La,be.prototype.getResponseText=be.prototype.la,be.prototype.send=be.prototype.ea,be.prototype.setWithCredentials=be.prototype.Fa,R_=be}).apply(typeof uh<"u"?uh:typeof self<"u"?self:typeof window<"u"?window:{});class Qs{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Qs.UNAUTHENTICATED=new Qs(null),Qs.GOOGLE_CREDENTIALS=new Qs("google-credentials-uid"),Qs.FIRST_PARTY=new Qs("first-party-uid"),Qs.MOCK_USER=new Qs("mock-user");let ac="12.8.0";function yR(s){ac=s}const Ho=new oy("@firebase/firestore");function Ol(){return Ho.logLevel}function Xe(s,...e){if(Ho.logLevel<=en.DEBUG){const t=e.map(xy);Ho.debug(`Firestore (${ac}): ${s}`,...t)}}function wa(s,...e){if(Ho.logLevel<=en.ERROR){const t=e.map(xy);Ho.error(`Firestore (${ac}): ${s}`,...t)}}function Gl(s,...e){if(Ho.logLevel<=en.WARN){const t=e.map(xy);Ho.warn(`Firestore (${ac}): ${s}`,...t)}}function xy(s){if(typeof s=="string")return s;try{return(function(t){return JSON.stringify(t)})(s)}catch{return s}}function jt(s,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,P_(s,i,t)}function P_(s,e,t){let i=`FIRESTORE (${ac}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw wa(i),new Error(i)}function kn(s,e,t,i){let l="Unexpected state";typeof t=="string"?l=t:i=t,s||P_(e,l,i)}function Pt(s,e){return s}const _e={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class We extends wi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ma{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class O_{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class vR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Qs.UNAUTHENTICATED)))}shutdown(){}}class bR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class wR{constructor(e){this.t=e,this.currentUser=Qs.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){kn(this.o===void 0,42304);let i=this.i;const l=y=>this.i!==i?(i=this.i,t(y)):Promise.resolve();let u=new ma;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new ma,e.enqueueRetryable((()=>l(this.currentUser)))};const d=()=>{const y=u;e.enqueueRetryable((async()=>{await y.promise,await l(this.currentUser)}))},g=y=>{Xe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=y,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((y=>g(y))),setTimeout((()=>{if(!this.auth){const y=this.t.getImmediate({optional:!0});y?g(y):(Xe("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new ma)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(Xe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(kn(typeof i.accessToken=="string",31837,{l:i}),new O_(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return kn(e===null||typeof e=="string",2055,{h:e}),new Qs(e)}}class xR{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Qs.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class _R{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new xR(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Qs.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class U2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class kR{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,br(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){kn(this.o===void 0,3512);const i=u=>{u.error!=null&&Xe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const d=u.token!==this.m;return this.m=u.token,Xe("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>i(u)))};const l=u=>{Xe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>l(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?l(u):Xe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new U2(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(kn(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new U2(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function jR(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<s;i++)t[i]=Math.floor(256*Math.random());return t}class _y{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const l=jR(40);for(let u=0;u<l.length;++u)i.length<20&&l[u]<t&&(i+=e.charAt(l[u]%62))}return i}}function nn(s,e){return s<e?-1:s>e?1:0}function Cp(s,e){const t=Math.min(s.length,e.length);for(let i=0;i<t;i++){const l=s.charAt(i),u=e.charAt(i);if(l!==u)return Hg(l)===Hg(u)?nn(l,u):Hg(l)?1:-1}return nn(s.length,e.length)}const ER=55296,TR=57343;function Hg(s){const e=s.charCodeAt(0);return e>=ER&&e<=TR}function Kl(s,e,t){return s.length===e.length&&s.every(((i,l)=>t(i,e[l])))}const B2="__name__";class Ri{constructor(e,t,i){t===void 0?t=0:t>e.length&&jt(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&jt(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Ri.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ri?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let l=0;l<i;l++){const u=Ri.compareSegments(e.get(l),t.get(l));if(u!==0)return u}return nn(e.length,t.length)}static compareSegments(e,t){const i=Ri.isNumericId(e),l=Ri.isNumericId(t);return i&&!l?-1:!i&&l?1:i&&l?Ri.extractNumericId(e).compare(Ri.extractNumericId(t)):Cp(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return so.fromString(e.substring(4,e.length-2))}}class Dn extends Ri{construct(e,t,i){return new Dn(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new We(_e.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((l=>l.length>0)))}return new Dn(t)}static emptyPath(){return new Dn([])}}const SR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class zs extends Ri{construct(e,t,i){return new zs(e,t,i)}static isValidIdentifier(e){return SR.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),zs.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===B2}static keyField(){return new zs([B2])}static fromServerFormat(e){const t=[];let i="",l=0;const u=()=>{if(i.length===0)throw new We(_e.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let d=!1;for(;l<e.length;){const g=e[l];if(g==="\\"){if(l+1===e.length)throw new We(_e.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const y=e[l+1];if(y!=="\\"&&y!=="."&&y!=="`")throw new We(_e.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=y,l+=2}else g==="`"?(d=!d,l++):g!=="."||d?(i+=g,l++):(u(),l++)}if(u(),d)throw new We(_e.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new zs(t)}static emptyPath(){return new zs([])}}class ft{constructor(e){this.path=e}static fromPath(e){return new ft(Dn.fromString(e))}static fromName(e){return new ft(Dn.fromString(e).popFirst(5))}static empty(){return new ft(Dn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Dn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Dn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ft(new Dn(e.slice()))}}function V_(s,e,t){if(!t)throw new We(_e.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function CR(s,e,t,i){if(e===!0&&i===!0)throw new We(_e.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function z2(s){if(!ft.isDocumentKey(s))throw new We(_e.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function F2(s){if(ft.isDocumentKey(s))throw new We(_e.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function U_(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function uf(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":jt(12329,{type:typeof s})}function cr(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new We(_e.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=uf(s);throw new We(_e.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}function ks(s,e){const t={typeString:s};return e&&(t.value=e),t}function Bu(s,e){if(!U_(s))throw new We(_e.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const l=e[i].typeString,u="value"in e[i]?{value:e[i].value}:void 0;if(!(i in s)){t=`JSON missing required field: '${i}'`;break}const d=s[i];if(l&&typeof d!==l){t=`JSON field '${i}' must be a ${l}.`;break}if(u!==void 0&&d!==u.value){t=`Expected '${i}' field to equal '${u.value}'`;break}}if(t)throw new We(_e.INVALID_ARGUMENT,t);return!0}const H2=-62135596800,q2=1e6;class Bt{static now(){return Bt.fromMillis(Date.now())}static fromDate(e){return Bt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*q2);return new Bt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new We(_e.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new We(_e.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<H2)throw new We(_e.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new We(_e.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/q2}_compareTo(e){return this.seconds===e.seconds?nn(this.nanoseconds,e.nanoseconds):nn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Bt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Bu(e,Bt._jsonSchema))return new Bt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-H2;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Bt._jsonSchemaVersion="firestore/timestamp/1.0",Bt._jsonSchema={type:ks("string",Bt._jsonSchemaVersion),seconds:ks("number"),nanoseconds:ks("number")};class Dt{static fromTimestamp(e){return new Dt(e)}static min(){return new Dt(new Bt(0,0))}static max(){return new Dt(new Bt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const ju=-1;function NR(s,e){const t=s.toTimestamp().seconds,i=s.toTimestamp().nanoseconds+1,l=Dt.fromTimestamp(i===1e9?new Bt(t+1,0):new Bt(t,i));return new ao(l,ft.empty(),e)}function AR(s){return new ao(s.readTime,s.key,ju)}class ao{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new ao(Dt.min(),ft.empty(),ju)}static max(){return new ao(Dt.max(),ft.empty(),ju)}}function RR(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=ft.comparator(s.documentKey,e.documentKey),t!==0?t:nn(s.largestBatchId,e.largestBatchId))}const IR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class MR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function oc(s){if(s.code!==_e.FAILED_PRECONDITION||s.message!==IR)throw s;Xe("LocalStore","Unexpectedly lost primary lease")}class Ne{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&jt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Ne(((i,l)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,l)},this.catchCallback=u=>{this.wrapFailure(t,u).next(i,l)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Ne?t:Ne.resolve(t)}catch(t){return Ne.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Ne.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Ne.reject(t)}static resolve(e){return new Ne(((t,i)=>{t(e)}))}static reject(e){return new Ne(((t,i)=>{i(e)}))}static waitFor(e){return new Ne(((t,i)=>{let l=0,u=0,d=!1;e.forEach((g=>{++l,g.next((()=>{++u,d&&u===l&&t()}),(y=>i(y)))})),d=!0,u===l&&t()}))}static or(e){let t=Ne.resolve(!1);for(const i of e)t=t.next((l=>l?Ne.resolve(l):i()));return t}static forEach(e,t){const i=[];return e.forEach(((l,u)=>{i.push(t.call(this,l,u))})),this.waitFor(i)}static mapArray(e,t){return new Ne(((i,l)=>{const u=e.length,d=new Array(u);let g=0;for(let y=0;y<u;y++){const p=y;t(e[p]).next((b=>{d[p]=b,++g,g===u&&i(d)}),(b=>l(b)))}}))}static doWhile(e,t){return new Ne(((i,l)=>{const u=()=>{e()===!0?t().next((()=>{u()}),l):i()};u()}))}}function DR(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function lc(s){return s.name==="IndexedDbTransactionError"}class df{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}df.ce=-1;const ky=-1;function hf(s){return s==null}function qh(s){return s===0&&1/s==-1/0}function LR(s){return typeof s=="number"&&Number.isInteger(s)&&!qh(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}const B_="";function PR(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=$2(e)),e=OR(s.get(t),e);return $2(e)}function OR(s,e){let t=e;const i=s.length;for(let l=0;l<i;l++){const u=s.charAt(l);switch(u){case"\0":t+="";break;case B_:t+="";break;default:t+=u}}return t}function $2(s){return s+B_+""}function W2(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function mo(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function z_(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}class Jn{constructor(e,t){this.comparator=e,this.root=t||Bs.EMPTY}insert(e,t){return new Jn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Bs.BLACK,null,null))}remove(e){return new Jn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Bs.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const l=this.comparator(e,i.key);if(l===0)return t+i.left.size;l<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new dh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new dh(this.root,e,this.comparator,!1)}getReverseIterator(){return new dh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new dh(this.root,e,this.comparator,!0)}}class dh{constructor(e,t,i,l){this.isReverse=l,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?i(e.key,t):1,t&&l&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Bs{constructor(e,t,i,l,u){this.key=e,this.value=t,this.color=i??Bs.RED,this.left=l??Bs.EMPTY,this.right=u??Bs.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,l,u){return new Bs(e??this.key,t??this.value,i??this.color,l??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let l=this;const u=i(e,l.key);return l=u<0?l.copy(null,null,null,l.left.insert(e,t,i),null):u===0?l.copy(null,t,null,null,null):l.copy(null,null,null,null,l.right.insert(e,t,i)),l.fixUp()}removeMin(){if(this.left.isEmpty())return Bs.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,l=this;if(t(e,l.key)<0)l.left.isEmpty()||l.left.isRed()||l.left.left.isRed()||(l=l.moveRedLeft()),l=l.copy(null,null,null,l.left.remove(e,t),null);else{if(l.left.isRed()&&(l=l.rotateRight()),l.right.isEmpty()||l.right.isRed()||l.right.left.isRed()||(l=l.moveRedRight()),t(e,l.key)===0){if(l.right.isEmpty())return Bs.EMPTY;i=l.right.min(),l=l.copy(i.key,i.value,null,null,l.right.removeMin())}l=l.copy(null,null,null,null,l.right.remove(e,t))}return l.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Bs.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Bs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw jt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw jt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw jt(27949);return e+(this.isRed()?0:1)}}Bs.EMPTY=null,Bs.RED=!0,Bs.BLACK=!1;Bs.EMPTY=new class{constructor(){this.size=0}get key(){throw jt(57766)}get value(){throw jt(16141)}get color(){throw jt(16727)}get left(){throw jt(29726)}get right(){throw jt(36894)}copy(e,t,i,l,u){return this}insert(e,t,i){return new Bs(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ts{constructor(e){this.comparator=e,this.data=new Jn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const l=i.getNext();if(this.comparator(l.key,e[1])>=0)return;t(l.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new G2(this.data.getIterator())}getIteratorFrom(e){return new G2(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Ts)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(this.comparator(l,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Ts(this.comparator);return t.data=e,t}}class G2{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Lr{constructor(e){this.fields=e,e.sort(zs.comparator)}static empty(){return new Lr([])}unionWith(e){let t=new Ts(zs.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Lr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Kl(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class F_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Fs{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(l){try{return atob(l)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new F_("Invalid base64 string: "+u):u}})(e);return new Fs(t)}static fromUint8Array(e){const t=(function(l){let u="";for(let d=0;d<l.length;++d)u+=String.fromCharCode(l[d]);return u})(e);return new Fs(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return nn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Fs.EMPTY_BYTE_STRING=new Fs("");const VR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function oo(s){if(kn(!!s,39018),typeof s=="string"){let e=0;const t=VR.exec(s);if(kn(!!t,46558,{timestamp:s}),t[1]){let l=t[1];l=(l+"000000000").substr(0,9),e=Number(l)}const i=new Date(s);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:hs(s.seconds),nanos:hs(s.nanos)}}function hs(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function lo(s){return typeof s=="string"?Fs.fromBase64String(s):Fs.fromUint8Array(s)}const H_="server_timestamp",q_="__type__",$_="__previous_value__",W_="__local_write_time__";function jy(s){return(s?.mapValue?.fields||{})[q_]?.stringValue===H_}function ff(s){const e=s.mapValue.fields[$_];return jy(e)?ff(e):e}function Eu(s){const e=oo(s.mapValue.fields[W_].timestampValue);return new Bt(e.seconds,e.nanos)}class UR{constructor(e,t,i,l,u,d,g,y,p,b,k){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=l,this.ssl=u,this.forceLongPolling=d,this.autoDetectLongPolling=g,this.longPollingOptions=y,this.useFetchStreams=p,this.isUsingEmulator=b,this.apiKey=k}}const $h="(default)";class Tu{constructor(e,t){this.projectId=e,this.database=t||$h}static empty(){return new Tu("","")}get isDefaultDatabase(){return this.database===$h}isEqual(e){return e instanceof Tu&&e.projectId===this.projectId&&e.database===this.database}}function BR(s,e){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new We(_e.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Tu(s.options.projectId,e)}const G_="__type__",zR="__max__",hh={mapValue:{}},K_="__vector__",Wh="value";function co(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?jy(s)?4:HR(s)?9007199254740991:FR(s)?10:11:jt(28295,{value:s})}function Oi(s,e){if(s===e)return!0;const t=co(s);if(t!==co(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return Eu(s).isEqual(Eu(e));case 3:return(function(l,u){if(typeof l.timestampValue=="string"&&typeof u.timestampValue=="string"&&l.timestampValue.length===u.timestampValue.length)return l.timestampValue===u.timestampValue;const d=oo(l.timestampValue),g=oo(u.timestampValue);return d.seconds===g.seconds&&d.nanos===g.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(l,u){return lo(l.bytesValue).isEqual(lo(u.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(l,u){return hs(l.geoPointValue.latitude)===hs(u.geoPointValue.latitude)&&hs(l.geoPointValue.longitude)===hs(u.geoPointValue.longitude)})(s,e);case 2:return(function(l,u){if("integerValue"in l&&"integerValue"in u)return hs(l.integerValue)===hs(u.integerValue);if("doubleValue"in l&&"doubleValue"in u){const d=hs(l.doubleValue),g=hs(u.doubleValue);return d===g?qh(d)===qh(g):isNaN(d)&&isNaN(g)}return!1})(s,e);case 9:return Kl(s.arrayValue.values||[],e.arrayValue.values||[],Oi);case 10:case 11:return(function(l,u){const d=l.mapValue.fields||{},g=u.mapValue.fields||{};if(W2(d)!==W2(g))return!1;for(const y in d)if(d.hasOwnProperty(y)&&(g[y]===void 0||!Oi(d[y],g[y])))return!1;return!0})(s,e);default:return jt(52216,{left:s})}}function Su(s,e){return(s.values||[]).find((t=>Oi(t,e)))!==void 0}function Yl(s,e){if(s===e)return 0;const t=co(s),i=co(e);if(t!==i)return nn(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return nn(s.booleanValue,e.booleanValue);case 2:return(function(u,d){const g=hs(u.integerValue||u.doubleValue),y=hs(d.integerValue||d.doubleValue);return g<y?-1:g>y?1:g===y?0:isNaN(g)?isNaN(y)?0:-1:1})(s,e);case 3:return K2(s.timestampValue,e.timestampValue);case 4:return K2(Eu(s),Eu(e));case 5:return Cp(s.stringValue,e.stringValue);case 6:return(function(u,d){const g=lo(u),y=lo(d);return g.compareTo(y)})(s.bytesValue,e.bytesValue);case 7:return(function(u,d){const g=u.split("/"),y=d.split("/");for(let p=0;p<g.length&&p<y.length;p++){const b=nn(g[p],y[p]);if(b!==0)return b}return nn(g.length,y.length)})(s.referenceValue,e.referenceValue);case 8:return(function(u,d){const g=nn(hs(u.latitude),hs(d.latitude));return g!==0?g:nn(hs(u.longitude),hs(d.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return Y2(s.arrayValue,e.arrayValue);case 10:return(function(u,d){const g=u.fields||{},y=d.fields||{},p=g[Wh]?.arrayValue,b=y[Wh]?.arrayValue,k=nn(p?.values?.length||0,b?.values?.length||0);return k!==0?k:Y2(p,b)})(s.mapValue,e.mapValue);case 11:return(function(u,d){if(u===hh.mapValue&&d===hh.mapValue)return 0;if(u===hh.mapValue)return 1;if(d===hh.mapValue)return-1;const g=u.fields||{},y=Object.keys(g),p=d.fields||{},b=Object.keys(p);y.sort(),b.sort();for(let k=0;k<y.length&&k<b.length;++k){const E=Cp(y[k],b[k]);if(E!==0)return E;const M=Yl(g[y[k]],p[b[k]]);if(M!==0)return M}return nn(y.length,b.length)})(s.mapValue,e.mapValue);default:throw jt(23264,{he:t})}}function K2(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return nn(s,e);const t=oo(s),i=oo(e),l=nn(t.seconds,i.seconds);return l!==0?l:nn(t.nanos,i.nanos)}function Y2(s,e){const t=s.values||[],i=e.values||[];for(let l=0;l<t.length&&l<i.length;++l){const u=Yl(t[l],i[l]);if(u)return u}return nn(t.length,i.length)}function Ql(s){return Np(s)}function Np(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(t){const i=oo(t);return`time(${i.seconds},${i.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(t){return lo(t).toBase64()})(s.bytesValue):"referenceValue"in s?(function(t){return ft.fromName(t).toString()})(s.referenceValue):"geoPointValue"in s?(function(t){return`geo(${t.latitude},${t.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(t){let i="[",l=!0;for(const u of t.values||[])l?l=!1:i+=",",i+=Np(u);return i+"]"})(s.arrayValue):"mapValue"in s?(function(t){const i=Object.keys(t.fields||{}).sort();let l="{",u=!0;for(const d of i)u?u=!1:l+=",",l+=`${d}:${Np(t.fields[d])}`;return l+"}"})(s.mapValue):jt(61005,{value:s})}function Nh(s){switch(co(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ff(s);return e?16+Nh(e):16;case 5:return 2*s.stringValue.length;case 6:return lo(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((l,u)=>l+Nh(u)),0)})(s.arrayValue);case 10:case 11:return(function(i){let l=0;return mo(i.fields,((u,d)=>{l+=u.length+Nh(d)})),l})(s.mapValue);default:throw jt(13486,{value:s})}}function Q2(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function Ap(s){return!!s&&"integerValue"in s}function Ey(s){return!!s&&"arrayValue"in s}function X2(s){return!!s&&"nullValue"in s}function J2(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function Ah(s){return!!s&&"mapValue"in s}function FR(s){return(s?.mapValue?.fields||{})[G_]?.stringValue===K_}function mu(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return mo(s.mapValue.fields,((t,i)=>e.mapValue.fields[t]=mu(i))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=mu(s.arrayValue.values[t]);return e}return{...s}}function HR(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===zR}class wr{constructor(e){this.value=e}static empty(){return new wr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Ah(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=mu(t)}setAll(e){let t=zs.emptyPath(),i={},l=[];e.forEach(((d,g)=>{if(!t.isImmediateParentOf(g)){const y=this.getFieldsMap(t);this.applyChanges(y,i,l),i={},l=[],t=g.popLast()}d?i[g.lastSegment()]=mu(d):l.push(g.lastSegment())}));const u=this.getFieldsMap(t);this.applyChanges(u,i,l)}delete(e){const t=this.field(e.popLast());Ah(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Oi(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let l=t.mapValue.fields[e.get(i)];Ah(l)&&l.mapValue.fields||(l={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=l),t=l}return t.mapValue.fields}applyChanges(e,t,i){mo(t,((l,u)=>e[l]=u));for(const l of i)delete e[l]}clone(){return new wr(mu(this.value))}}function Y_(s){const e=[];return mo(s.fields,((t,i)=>{const l=new zs([t]);if(Ah(i)){const u=Y_(i.mapValue).fields;if(u.length===0)e.push(l);else for(const d of u)e.push(l.child(d))}else e.push(l)})),new Lr(e)}class Xs{constructor(e,t,i,l,u,d,g){this.key=e,this.documentType=t,this.version=i,this.readTime=l,this.createTime=u,this.data=d,this.documentState=g}static newInvalidDocument(e){return new Xs(e,0,Dt.min(),Dt.min(),Dt.min(),wr.empty(),0)}static newFoundDocument(e,t,i,l){return new Xs(e,1,t,Dt.min(),i,l,0)}static newNoDocument(e,t){return new Xs(e,2,t,Dt.min(),Dt.min(),wr.empty(),0)}static newUnknownDocument(e,t){return new Xs(e,3,t,Dt.min(),Dt.min(),wr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Dt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=wr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=wr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Dt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Xs&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Xs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Gh{constructor(e,t){this.position=e,this.inclusive=t}}function Z2(s,e,t){let i=0;for(let l=0;l<s.position.length;l++){const u=e[l],d=s.position[l];if(u.field.isKeyField()?i=ft.comparator(ft.fromName(d.referenceValue),t.key):i=Yl(d,t.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function ew(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!Oi(s.position[t],e.position[t]))return!1;return!0}class Cu{constructor(e,t="asc"){this.field=e,this.dir=t}}function qR(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}class Q_{}class ws extends Q_{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new WR(e,t,i):t==="array-contains"?new YR(e,i):t==="in"?new QR(e,i):t==="not-in"?new XR(e,i):t==="array-contains-any"?new JR(e,i):new ws(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new GR(e,i):new KR(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Yl(t,this.value)):t!==null&&co(this.value)===co(t)&&this.matchesComparison(Yl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return jt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class vi extends Q_{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new vi(e,t)}matches(e){return X_(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function X_(s){return s.op==="and"}function J_(s){return $R(s)&&X_(s)}function $R(s){for(const e of s.filters)if(e instanceof vi)return!1;return!0}function Rp(s){if(s instanceof ws)return s.field.canonicalString()+s.op.toString()+Ql(s.value);if(J_(s))return s.filters.map((e=>Rp(e))).join(",");{const e=s.filters.map((t=>Rp(t))).join(",");return`${s.op}(${e})`}}function Z_(s,e){return s instanceof ws?(function(i,l){return l instanceof ws&&i.op===l.op&&i.field.isEqual(l.field)&&Oi(i.value,l.value)})(s,e):s instanceof vi?(function(i,l){return l instanceof vi&&i.op===l.op&&i.filters.length===l.filters.length?i.filters.reduce(((u,d,g)=>u&&Z_(d,l.filters[g])),!0):!1})(s,e):void jt(19439)}function ek(s){return s instanceof ws?(function(t){return`${t.field.canonicalString()} ${t.op} ${Ql(t.value)}`})(s):s instanceof vi?(function(t){return t.op.toString()+" {"+t.getFilters().map(ek).join(" ,")+"}"})(s):"Filter"}class WR extends ws{constructor(e,t,i){super(e,t,i),this.key=ft.fromName(i.referenceValue)}matches(e){const t=ft.comparator(e.key,this.key);return this.matchesComparison(t)}}class GR extends ws{constructor(e,t){super(e,"in",t),this.keys=tk("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class KR extends ws{constructor(e,t){super(e,"not-in",t),this.keys=tk("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function tk(s,e){return(e.arrayValue?.values||[]).map((t=>ft.fromName(t.referenceValue)))}class YR extends ws{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ey(t)&&Su(t.arrayValue,this.value)}}class QR extends ws{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Su(this.value.arrayValue,t)}}class XR extends ws{constructor(e,t){super(e,"not-in",t)}matches(e){if(Su(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Su(this.value.arrayValue,t)}}class JR extends ws{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ey(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Su(this.value.arrayValue,i)))}}class ZR{constructor(e,t=null,i=[],l=[],u=null,d=null,g=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=l,this.limit=u,this.startAt=d,this.endAt=g,this.Te=null}}function tw(s,e=null,t=[],i=[],l=null,u=null,d=null){return new ZR(s,e,t,i,l,u,d)}function Ty(s){const e=Pt(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>Rp(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(u){return u.field.canonicalString()+u.dir})(i))).join(","),hf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Ql(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Ql(i))).join(",")),e.Te=t}return e.Te}function Sy(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!qR(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!Z_(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!ew(s.startAt,e.startAt)&&ew(s.endAt,e.endAt)}function Ip(s){return ft.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}class cc{constructor(e,t=null,i=[],l=[],u=null,d="F",g=null,y=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=l,this.limit=u,this.limitType=d,this.startAt=g,this.endAt=y,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function eI(s,e,t,i,l,u,d,g){return new cc(s,e,t,i,l,u,d,g)}function mf(s){return new cc(s)}function nw(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function tI(s){return ft.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function nk(s){return s.collectionGroup!==null}function gu(s){const e=Pt(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),t.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let g=new Ts(zs.comparator);return d.filters.forEach((y=>{y.getFlattenedFilters().forEach((p=>{p.isInequality()&&(g=g.add(p.field))}))})),g})(e).forEach((u=>{t.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new Cu(u,i))})),t.has(zs.keyField().canonicalString())||e.Ie.push(new Cu(zs.keyField(),i))}return e.Ie}function Di(s){const e=Pt(s);return e.Ee||(e.Ee=nI(e,gu(s))),e.Ee}function nI(s,e){if(s.limitType==="F")return tw(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((l=>{const u=l.dir==="desc"?"asc":"desc";return new Cu(l.field,u)}));const t=s.endAt?new Gh(s.endAt.position,s.endAt.inclusive):null,i=s.startAt?new Gh(s.startAt.position,s.startAt.inclusive):null;return tw(s.path,s.collectionGroup,e,s.filters,s.limit,t,i)}}function Mp(s,e){const t=s.filters.concat([e]);return new cc(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function sI(s,e){const t=s.explicitOrderBy.concat([e]);return new cc(s.path,s.collectionGroup,t,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}function Dp(s,e,t){return new cc(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function gf(s,e){return Sy(Di(s),Di(e))&&s.limitType===e.limitType}function sk(s){return`${Ty(Di(s))}|lt:${s.limitType}`}function Vl(s){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((l=>ek(l))).join(", ")}]`),hf(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((l=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(l))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((l=>Ql(l))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((l=>Ql(l))).join(",")),`Target(${i})`})(Di(s))}; limitType=${s.limitType})`}function pf(s,e){return e.isFoundDocument()&&(function(i,l){const u=l.key.path;return i.collectionGroup!==null?l.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):ft.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)})(s,e)&&(function(i,l){for(const u of gu(i))if(!u.field.isKeyField()&&l.data.field(u.field)===null)return!1;return!0})(s,e)&&(function(i,l){for(const u of i.filters)if(!u.matches(l))return!1;return!0})(s,e)&&(function(i,l){return!(i.startAt&&!(function(d,g,y){const p=Z2(d,g,y);return d.inclusive?p<=0:p<0})(i.startAt,gu(i),l)||i.endAt&&!(function(d,g,y){const p=Z2(d,g,y);return d.inclusive?p>=0:p>0})(i.endAt,gu(i),l))})(s,e)}function rI(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function rk(s){return(e,t)=>{let i=!1;for(const l of gu(s)){const u=iI(l,e,t);if(u!==0)return u;i=i||l.field.isKeyField()}return 0}}function iI(s,e,t){const i=s.field.isKeyField()?ft.comparator(e.key,t.key):(function(u,d,g){const y=d.data.field(u),p=g.data.field(u);return y!==null&&p!==null?Yl(y,p):jt(42886)})(s.field,e,t);switch(s.dir){case"asc":return i;case"desc":return-1*i;default:return jt(19790,{direction:s.dir})}}class Jo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[l,u]of i)if(this.equalsFn(l,e))return u}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),l=this.inner[i];if(l===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let u=0;u<l.length;u++)if(this.equalsFn(l[u][0],e))return void(l[u]=[e,t]);l.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let l=0;l<i.length;l++)if(this.equalsFn(i[l][0],e))return i.length===1?delete this.inner[t]:i.splice(l,1),this.innerSize--,!0;return!1}forEach(e){mo(this.inner,((t,i)=>{for(const[l,u]of i)e(l,u)}))}isEmpty(){return z_(this.inner)}size(){return this.innerSize}}const aI=new Jn(ft.comparator);function xa(){return aI}const ik=new Jn(ft.comparator);function lu(...s){let e=ik;for(const t of s)e=e.insert(t.key,t);return e}function ak(s){let e=ik;return s.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Oo(){return pu()}function ok(){return pu()}function pu(){return new Jo((s=>s.toString()),((s,e)=>s.isEqual(e)))}const oI=new Jn(ft.comparator),lI=new Ts(ft.comparator);function sn(...s){let e=lI;for(const t of s)e=e.add(t);return e}const cI=new Ts(nn);function uI(){return cI}function Cy(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qh(e)?"-0":e}}function lk(s){return{integerValue:""+s}}function ck(s,e){return LR(e)?lk(e):Cy(s,e)}class yf{constructor(){this._=void 0}}function dI(s,e,t){return s instanceof Nu?(function(l,u){const d={fields:{[q_]:{stringValue:H_},[W_]:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}};return u&&jy(u)&&(u=ff(u)),u&&(d.fields[$_]=u),{mapValue:d}})(t,e):s instanceof Xl?dk(s,e):s instanceof Jl?hk(s,e):(function(l,u){const d=uk(l,u),g=sw(d)+sw(l.Ae);return Ap(d)&&Ap(l.Ae)?lk(g):Cy(l.serializer,g)})(s,e)}function hI(s,e,t){return s instanceof Xl?dk(s,e):s instanceof Jl?hk(s,e):t}function uk(s,e){return s instanceof Au?(function(i){return Ap(i)||(function(u){return!!u&&"doubleValue"in u})(i)})(e)?e:{integerValue:0}:null}class Nu extends yf{}class Xl extends yf{constructor(e){super(),this.elements=e}}function dk(s,e){const t=fk(e);for(const i of s.elements)t.some((l=>Oi(l,i)))||t.push(i);return{arrayValue:{values:t}}}class Jl extends yf{constructor(e){super(),this.elements=e}}function hk(s,e){let t=fk(e);for(const i of s.elements)t=t.filter((l=>!Oi(l,i)));return{arrayValue:{values:t}}}class Au extends yf{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function sw(s){return hs(s.integerValue||s.doubleValue)}function fk(s){return Ey(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}class vf{constructor(e,t){this.field=e,this.transform=t}}function fI(s,e){return s.field.isEqual(e.field)&&(function(i,l){return i instanceof Xl&&l instanceof Xl||i instanceof Jl&&l instanceof Jl?Kl(i.elements,l.elements,Oi):i instanceof Au&&l instanceof Au?Oi(i.Ae,l.Ae):i instanceof Nu&&l instanceof Nu})(s.transform,e.transform)}class mI{constructor(e,t){this.version=e,this.transformResults=t}}class ur{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ur}static exists(e){return new ur(void 0,e)}static updateTime(e){return new ur(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Rh(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class bf{}function mk(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new wf(s.key,ur.none()):new zu(s.key,s.data,ur.none());{const t=s.data,i=wr.empty();let l=new Ts(zs.comparator);for(let u of e.fields)if(!l.has(u)){let d=t.field(u);d===null&&u.length>1&&(u=u.popLast(),d=t.field(u)),d===null?i.delete(u):i.set(u,d),l=l.add(u)}return new go(s.key,i,new Lr(l.toArray()),ur.none())}}function gI(s,e,t){s instanceof zu?(function(l,u,d){const g=l.value.clone(),y=iw(l.fieldTransforms,u,d.transformResults);g.setAll(y),u.convertToFoundDocument(d.version,g).setHasCommittedMutations()})(s,e,t):s instanceof go?(function(l,u,d){if(!Rh(l.precondition,u))return void u.convertToUnknownDocument(d.version);const g=iw(l.fieldTransforms,u,d.transformResults),y=u.data;y.setAll(gk(l)),y.setAll(g),u.convertToFoundDocument(d.version,y).setHasCommittedMutations()})(s,e,t):(function(l,u,d){u.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function yu(s,e,t,i){return s instanceof zu?(function(u,d,g,y){if(!Rh(u.precondition,d))return g;const p=u.value.clone(),b=aw(u.fieldTransforms,y,d);return p.setAll(b),d.convertToFoundDocument(d.version,p).setHasLocalMutations(),null})(s,e,t,i):s instanceof go?(function(u,d,g,y){if(!Rh(u.precondition,d))return g;const p=aw(u.fieldTransforms,y,d),b=d.data;return b.setAll(gk(u)),b.setAll(p),d.convertToFoundDocument(d.version,b).setHasLocalMutations(),g===null?null:g.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((k=>k.field)))})(s,e,t,i):(function(u,d,g){return Rh(u.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):g})(s,e,t)}function pI(s,e){let t=null;for(const i of s.fieldTransforms){const l=e.data.field(i.field),u=uk(i.transform,l||null);u!=null&&(t===null&&(t=wr.empty()),t.set(i.field,u))}return t||null}function rw(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(i,l){return i===void 0&&l===void 0||!(!i||!l)&&Kl(i,l,((u,d)=>fI(u,d)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class zu extends bf{constructor(e,t,i,l=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=l,this.type=0}getFieldMask(){return null}}class go extends bf{constructor(e,t,i,l,u=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=l,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function gk(s){const e=new Map;return s.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=s.data.field(t);e.set(t,i)}})),e}function iw(s,e,t){const i=new Map;kn(s.length===t.length,32656,{Ve:t.length,de:s.length});for(let l=0;l<t.length;l++){const u=s[l],d=u.transform,g=e.data.field(u.field);i.set(u.field,hI(d,g,t[l]))}return i}function aw(s,e,t){const i=new Map;for(const l of s){const u=l.transform,d=t.data.field(l.field);i.set(l.field,dI(u,d,e))}return i}class wf extends bf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class yI extends bf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class vI{constructor(e,t,i,l){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=l}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let l=0;l<this.mutations.length;l++){const u=this.mutations[l];u.key.isEqual(e.key)&&gI(u,e,i[l])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=yu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=yu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=ok();return this.mutations.forEach((l=>{const u=e.get(l.key),d=u.overlayedDocument;let g=this.applyToLocalView(d,u.mutatedFields);g=t.has(l.key)?null:g;const y=mk(d,g);y!==null&&i.set(l.key,y),d.isValidDocument()||d.convertToNoDocument(Dt.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),sn())}isEqual(e){return this.batchId===e.batchId&&Kl(this.mutations,e.mutations,((t,i)=>rw(t,i)))&&Kl(this.baseMutations,e.baseMutations,((t,i)=>rw(t,i)))}}class Ny{constructor(e,t,i,l){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=l}static from(e,t,i){kn(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let l=(function(){return oI})();const u=e.mutations;for(let d=0;d<u.length;d++)l=l.insert(u[d].key,i[d].version);return new Ny(e,t,i,l)}}class bI{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class wI{constructor(e,t){this.count=e,this.unchangedNames=t}}var bs,cn;function xI(s){switch(s){case _e.OK:return jt(64938);case _e.CANCELLED:case _e.UNKNOWN:case _e.DEADLINE_EXCEEDED:case _e.RESOURCE_EXHAUSTED:case _e.INTERNAL:case _e.UNAVAILABLE:case _e.UNAUTHENTICATED:return!1;case _e.INVALID_ARGUMENT:case _e.NOT_FOUND:case _e.ALREADY_EXISTS:case _e.PERMISSION_DENIED:case _e.FAILED_PRECONDITION:case _e.ABORTED:case _e.OUT_OF_RANGE:case _e.UNIMPLEMENTED:case _e.DATA_LOSS:return!0;default:return jt(15467,{code:s})}}function pk(s){if(s===void 0)return wa("GRPC error has no .code"),_e.UNKNOWN;switch(s){case bs.OK:return _e.OK;case bs.CANCELLED:return _e.CANCELLED;case bs.UNKNOWN:return _e.UNKNOWN;case bs.DEADLINE_EXCEEDED:return _e.DEADLINE_EXCEEDED;case bs.RESOURCE_EXHAUSTED:return _e.RESOURCE_EXHAUSTED;case bs.INTERNAL:return _e.INTERNAL;case bs.UNAVAILABLE:return _e.UNAVAILABLE;case bs.UNAUTHENTICATED:return _e.UNAUTHENTICATED;case bs.INVALID_ARGUMENT:return _e.INVALID_ARGUMENT;case bs.NOT_FOUND:return _e.NOT_FOUND;case bs.ALREADY_EXISTS:return _e.ALREADY_EXISTS;case bs.PERMISSION_DENIED:return _e.PERMISSION_DENIED;case bs.FAILED_PRECONDITION:return _e.FAILED_PRECONDITION;case bs.ABORTED:return _e.ABORTED;case bs.OUT_OF_RANGE:return _e.OUT_OF_RANGE;case bs.UNIMPLEMENTED:return _e.UNIMPLEMENTED;case bs.DATA_LOSS:return _e.DATA_LOSS;default:return jt(39323,{code:s})}}(cn=bs||(bs={}))[cn.OK=0]="OK",cn[cn.CANCELLED=1]="CANCELLED",cn[cn.UNKNOWN=2]="UNKNOWN",cn[cn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",cn[cn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",cn[cn.NOT_FOUND=5]="NOT_FOUND",cn[cn.ALREADY_EXISTS=6]="ALREADY_EXISTS",cn[cn.PERMISSION_DENIED=7]="PERMISSION_DENIED",cn[cn.UNAUTHENTICATED=16]="UNAUTHENTICATED",cn[cn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",cn[cn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",cn[cn.ABORTED=10]="ABORTED",cn[cn.OUT_OF_RANGE=11]="OUT_OF_RANGE",cn[cn.UNIMPLEMENTED=12]="UNIMPLEMENTED",cn[cn.INTERNAL=13]="INTERNAL",cn[cn.UNAVAILABLE=14]="UNAVAILABLE",cn[cn.DATA_LOSS=15]="DATA_LOSS";function _I(){return new TextEncoder}const kI=new so([4294967295,4294967295],0);function ow(s){const e=_I().encode(s),t=new A_;return t.update(e),new Uint8Array(t.digest())}function lw(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),l=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new so([t,i],0),new so([l,u],0)]}class Ay{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new cu(`Invalid padding: ${t}`);if(i<0)throw new cu(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new cu(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new cu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=so.fromNumber(this.ge)}ye(e,t,i){let l=e.add(t.multiply(so.fromNumber(i)));return l.compare(kI)===1&&(l=new so([l.getBits(0),l.getBits(1)],0)),l.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=ow(e),[i,l]=lw(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);if(!this.we(d))return!1}return!0}static create(e,t,i){const l=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),d=new Ay(u,l,t);return i.forEach((g=>d.insert(g))),d}insert(e){if(this.ge===0)return;const t=ow(e),[i,l]=lw(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);this.be(d)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class cu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class xf{constructor(e,t,i,l,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=l,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const l=new Map;return l.set(e,Fu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new xf(Dt.min(),l,new Jn(nn),xa(),sn())}}class Fu{constructor(e,t,i,l,u){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=l,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Fu(i,t,sn(),sn(),sn())}}class Ih{constructor(e,t,i,l){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=l}}class yk{constructor(e,t){this.targetId=e,this.Ce=t}}class vk{constructor(e,t,i=Fs.EMPTY_BYTE_STRING,l=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=l}}class cw{constructor(){this.ve=0,this.Fe=uw(),this.Me=Fs.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=sn(),t=sn(),i=sn();return this.Fe.forEach(((l,u)=>{switch(u){case 0:e=e.add(l);break;case 2:t=t.add(l);break;case 1:i=i.add(l);break;default:jt(38017,{changeType:u})}})),new Fu(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=uw()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,kn(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class jI{constructor(e){this.Ge=e,this.ze=new Map,this.je=xa(),this.He=fh(),this.Je=fh(),this.Ze=new Jn(nn)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:jt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,l)=>{this.rt(l)&&t(l)}))}st(e){const t=e.targetId,i=e.Ce.count,l=this.ot(t);if(l){const u=l.target;if(Ip(u))if(i===0){const d=new ft(u.path);this.et(t,d,Xs.newNoDocument(d,Dt.min()))}else kn(i===1,20013,{expectedCount:i});else{const d=this._t(t);if(d!==i){const g=this.ut(e),y=g?this.ct(g,e,d):1;if(y!==0){this.it(t);const p=y===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,p)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:l=0},hashCount:u=0}=t;let d,g;try{d=lo(i).toUint8Array()}catch(y){if(y instanceof F_)return Gl("Decoding the base64 bloom filter in existence filter failed ("+y.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw y}try{g=new Ay(d,l,u)}catch(y){return Gl(y instanceof cu?"BloomFilter error: ":"Applying bloom filter failed: ",y),null}return g.ge===0?null:g}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let l=0;return i.forEach((u=>{const d=this.Ge.ht(),g=`projects/${d.projectId}/databases/${d.database}/documents/${u.path.canonicalString()}`;e.mightContain(g)||(this.et(t,u,null),l++)})),l}Tt(e){const t=new Map;this.ze.forEach(((u,d)=>{const g=this.ot(d);if(g){if(u.current&&Ip(g.target)){const y=new ft(g.target.path);this.It(y).has(d)||this.Et(d,y)||this.et(d,y,Xs.newNoDocument(y,e))}u.Be&&(t.set(d,u.ke()),u.Ke())}}));let i=sn();this.Je.forEach(((u,d)=>{let g=!0;d.forEachWhile((y=>{const p=this.ot(y);return!p||p.purpose==="TargetPurposeLimboResolution"||(g=!1,!1)})),g&&(i=i.add(u))})),this.je.forEach(((u,d)=>d.setReadTime(e)));const l=new xf(e,t,this.Ze,this.je,i);return this.je=xa(),this.He=fh(),this.Je=fh(),this.Ze=new Jn(nn),l}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const l=this.nt(e);this.Et(e,t)?l.qe(t,1):l.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new cw,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Ts(nn),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Ts(nn),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Xe("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new cw),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function fh(){return new Jn(ft.comparator)}function uw(){return new Jn(ft.comparator)}const EI={asc:"ASCENDING",desc:"DESCENDING"},TI={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},SI={and:"AND",or:"OR"};class CI{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Lp(s,e){return s.useProto3Json||hf(e)?e:{value:e}}function Kh(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function bk(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function NI(s,e){return Kh(s,e.toTimestamp())}function Li(s){return kn(!!s,49232),Dt.fromTimestamp((function(t){const i=oo(t);return new Bt(i.seconds,i.nanos)})(s))}function Ry(s,e){return Pp(s,e).canonicalString()}function Pp(s,e){const t=(function(l){return new Dn(["projects",l.projectId,"databases",l.database])})(s).child("documents");return e===void 0?t:t.child(e)}function wk(s){const e=Dn.fromString(s);return kn(Ek(e),10190,{key:e.toString()}),e}function Op(s,e){return Ry(s.databaseId,e.path)}function qg(s,e){const t=wk(e);if(t.get(1)!==s.databaseId.projectId)throw new We(_e.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new We(_e.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new ft(_k(t))}function xk(s,e){return Ry(s.databaseId,e)}function AI(s){const e=wk(s);return e.length===4?Dn.emptyPath():_k(e)}function Vp(s){return new Dn(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function _k(s){return kn(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function dw(s,e,t){return{name:Op(s,e),fields:t.value.mapValue.fields}}function RI(s,e){let t;if("targetChange"in e){e.targetChange;const i=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:jt(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),l=e.targetChange.targetIds||[],u=(function(p,b){return p.useProto3Json?(kn(b===void 0||typeof b=="string",58123),Fs.fromBase64String(b||"")):(kn(b===void 0||b instanceof Buffer||b instanceof Uint8Array,16193),Fs.fromUint8Array(b||new Uint8Array))})(s,e.targetChange.resumeToken),d=e.targetChange.cause,g=d&&(function(p){const b=p.code===void 0?_e.UNKNOWN:pk(p.code);return new We(b,p.message||"")})(d);t=new vk(i,l,u,g||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const l=qg(s,i.document.name),u=Li(i.document.updateTime),d=i.document.createTime?Li(i.document.createTime):Dt.min(),g=new wr({mapValue:{fields:i.document.fields}}),y=Xs.newFoundDocument(l,u,d,g),p=i.targetIds||[],b=i.removedTargetIds||[];t=new Ih(p,b,y.key,y)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const l=qg(s,i.document),u=i.readTime?Li(i.readTime):Dt.min(),d=Xs.newNoDocument(l,u),g=i.removedTargetIds||[];t=new Ih([],g,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const l=qg(s,i.document),u=i.removedTargetIds||[];t=new Ih([],u,l,null)}else{if(!("filter"in e))return jt(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:l=0,unchangedNames:u}=i,d=new wI(l,u),g=i.targetId;t=new yk(g,d)}}return t}function II(s,e){let t;if(e instanceof zu)t={update:dw(s,e.key,e.value)};else if(e instanceof wf)t={delete:Op(s,e.key)};else if(e instanceof go)t={update:dw(s,e.key,e.data),updateMask:zI(e.fieldMask)};else{if(!(e instanceof yI))return jt(16599,{dt:e.type});t={verify:Op(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(u,d){const g=d.transform;if(g instanceof Nu)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(g instanceof Xl)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:g.elements}};if(g instanceof Jl)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:g.elements}};if(g instanceof Au)return{fieldPath:d.field.canonicalString(),increment:g.Ae};throw jt(20930,{transform:d.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(l,u){return u.updateTime!==void 0?{updateTime:NI(l,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:jt(27497)})(s,e.precondition)),t}function MI(s,e){return s&&s.length>0?(kn(e!==void 0,14353),s.map((t=>(function(l,u){let d=l.updateTime?Li(l.updateTime):Li(u);return d.isEqual(Dt.min())&&(d=Li(u)),new mI(d,l.transformResults||[])})(t,e)))):[]}function DI(s,e){return{documents:[xk(s,e.path)]}}function LI(s,e){const t={structuredQuery:{}},i=e.path;let l;e.collectionGroup!==null?(l=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(l=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=xk(s,l);const u=(function(p){if(p.length!==0)return jk(vi.create(p,"and"))})(e.filters);u&&(t.structuredQuery.where=u);const d=(function(p){if(p.length!==0)return p.map((b=>(function(E){return{field:Ul(E.field),direction:VI(E.dir)}})(b)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const g=Lp(s,e.limit);return g!==null&&(t.structuredQuery.limit=g),e.startAt&&(t.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{ft:t,parent:l}}function PI(s){let e=AI(s.parent);const t=s.structuredQuery,i=t.from?t.from.length:0;let l=null;if(i>0){kn(i===1,65062);const b=t.from[0];b.allDescendants?l=b.collectionId:e=e.child(b.collectionId)}let u=[];t.where&&(u=(function(k){const E=kk(k);return E instanceof vi&&J_(E)?E.getFilters():[E]})(t.where));let d=[];t.orderBy&&(d=(function(k){return k.map((E=>(function(H){return new Cu(Bl(H.field),(function(B){switch(B){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(H.direction))})(E)))})(t.orderBy));let g=null;t.limit&&(g=(function(k){let E;return E=typeof k=="object"?k.value:k,hf(E)?null:E})(t.limit));let y=null;t.startAt&&(y=(function(k){const E=!!k.before,M=k.values||[];return new Gh(M,E)})(t.startAt));let p=null;return t.endAt&&(p=(function(k){const E=!k.before,M=k.values||[];return new Gh(M,E)})(t.endAt)),eI(e,l,d,u,g,"F",y,p)}function OI(s,e){const t=(function(l){switch(l){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return jt(28987,{purpose:l})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function kk(s){return s.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Bl(t.unaryFilter.field);return ws.create(i,"==",{doubleValue:NaN});case"IS_NULL":const l=Bl(t.unaryFilter.field);return ws.create(l,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=Bl(t.unaryFilter.field);return ws.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=Bl(t.unaryFilter.field);return ws.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return jt(61313);default:return jt(60726)}})(s):s.fieldFilter!==void 0?(function(t){return ws.create(Bl(t.fieldFilter.field),(function(l){switch(l){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return jt(58110);default:return jt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(t){return vi.create(t.compositeFilter.filters.map((i=>kk(i))),(function(l){switch(l){case"AND":return"and";case"OR":return"or";default:return jt(1026)}})(t.compositeFilter.op))})(s):jt(30097,{filter:s})}function VI(s){return EI[s]}function UI(s){return TI[s]}function BI(s){return SI[s]}function Ul(s){return{fieldPath:s.canonicalString()}}function Bl(s){return zs.fromServerFormat(s.fieldPath)}function jk(s){return s instanceof ws?(function(t){if(t.op==="=="){if(J2(t.value))return{unaryFilter:{field:Ul(t.field),op:"IS_NAN"}};if(X2(t.value))return{unaryFilter:{field:Ul(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(J2(t.value))return{unaryFilter:{field:Ul(t.field),op:"IS_NOT_NAN"}};if(X2(t.value))return{unaryFilter:{field:Ul(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ul(t.field),op:UI(t.op),value:t.value}}})(s):s instanceof vi?(function(t){const i=t.getFilters().map((l=>jk(l)));return i.length===1?i[0]:{compositeFilter:{op:BI(t.op),filters:i}}})(s):jt(54877,{filter:s})}function zI(s){const e=[];return s.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Ek(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}function Tk(s){return!!s&&typeof s._toProto=="function"&&s._protoValueType==="ProtoValue"}class to{constructor(e,t,i,l,u=Dt.min(),d=Dt.min(),g=Fs.EMPTY_BYTE_STRING,y=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=l,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=g,this.expectedCount=y}withSequenceNumber(e){return new to(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new to(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new to(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new to(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class FI{constructor(e){this.yt=e}}function HI(s){const e=PI({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?Dp(e,e.limit,"L"):e}class qI{constructor(){this.Sn=new $I}addToCollectionParentIndex(e,t){return this.Sn.add(t),Ne.resolve()}getCollectionParents(e,t){return Ne.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return Ne.resolve()}deleteFieldIndex(e,t){return Ne.resolve()}deleteAllFieldIndexes(e){return Ne.resolve()}createTargetIndexes(e,t){return Ne.resolve()}getDocumentsMatchingTarget(e,t){return Ne.resolve(null)}getIndexType(e,t){return Ne.resolve(0)}getFieldIndexes(e,t){return Ne.resolve([])}getNextCollectionGroupToUpdate(e){return Ne.resolve(null)}getMinOffset(e,t){return Ne.resolve(ao.min())}getMinOffsetFromCollectionGroup(e,t){return Ne.resolve(ao.min())}updateCollectionGroup(e,t,i){return Ne.resolve()}updateIndexEntries(e,t){return Ne.resolve()}}class $I{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t]||new Ts(Dn.comparator),u=!l.has(i);return this.index[t]=l.add(i),u}has(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t];return l&&l.has(i)}getEntries(e){return(this.index[e]||new Ts(Dn.comparator)).toArray()}}const hw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Sk=41943040;class vr{static withCacheSize(e){return new vr(e,vr.DEFAULT_COLLECTION_PERCENTILE,vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}vr.DEFAULT_COLLECTION_PERCENTILE=10,vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,vr.DEFAULT=new vr(Sk,vr.DEFAULT_COLLECTION_PERCENTILE,vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),vr.DISABLED=new vr(-1,0,0);class Zl{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Zl(0)}static ar(){return new Zl(-1)}}const fw="LruGarbageCollector",WI=1048576;function mw([s,e],[t,i]){const l=nn(s,t);return l===0?nn(e,i):l}class GI{constructor(e){this.Pr=e,this.buffer=new Ts(mw),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();mw(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class KI{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){Xe(fw,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){lc(t)?Xe(fw,"Ignoring IndexedDB error during garbage collection: ",t):await oc(t)}await this.Ar(3e5)}))}}class YI{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Ne.resolve(df.ce);const i=new GI(t);return this.Vr.forEachTarget(e,(l=>i.Er(l.sequenceNumber))).next((()=>this.Vr.mr(e,(l=>i.Er(l))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Xe("LruGarbageCollector","Garbage collection skipped; disabled"),Ne.resolve(hw)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Xe("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),hw):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,l,u,d,g,y,p;const b=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((k=>(k>this.params.maximumSequenceNumbersToCollect?(Xe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${k}`),l=this.params.maximumSequenceNumbersToCollect):l=k,d=Date.now(),this.nthSequenceNumber(e,l)))).next((k=>(i=k,g=Date.now(),this.removeTargets(e,i,t)))).next((k=>(u=k,y=Date.now(),this.removeOrphanedDocuments(e,i)))).next((k=>(p=Date.now(),Ol()<=en.DEBUG&&Xe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-b}ms
	Determined least recently used ${l} in `+(g-d)+`ms
	Removed ${u} targets in `+(y-g)+`ms
	Removed ${k} documents in `+(p-y)+`ms
Total Duration: ${p-b}ms`),Ne.resolve({didRun:!0,sequenceNumbersCollected:l,targetsRemoved:u,documentsRemoved:k}))))}}function QI(s,e){return new YI(s,e)}class XI{constructor(){this.changes=new Jo((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Xs.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Ne.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class JI{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class ZI{constructor(e,t,i,l){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=l}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((l=>(i=l,this.remoteDocumentCache.getEntry(e,t)))).next((l=>(i!==null&&yu(i.mutation,l,Lr.empty(),Bt.now()),l)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,sn()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=sn()){const l=Oo();return this.populateOverlays(e,l,t).next((()=>this.computeViews(e,t,l,i).next((u=>{let d=lu();return u.forEach(((g,y)=>{d=d.insert(g,y.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const i=Oo();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,sn())))}populateOverlays(e,t,i){const l=[];return i.forEach((u=>{t.has(u)||l.push(u)})),this.documentOverlayCache.getOverlays(e,l).next((u=>{u.forEach(((d,g)=>{t.set(d,g)}))}))}computeViews(e,t,i,l){let u=xa();const d=pu(),g=(function(){return pu()})();return t.forEach(((y,p)=>{const b=i.get(p.key);l.has(p.key)&&(b===void 0||b.mutation instanceof go)?u=u.insert(p.key,p):b!==void 0?(d.set(p.key,b.mutation.getFieldMask()),yu(b.mutation,p,b.mutation.getFieldMask(),Bt.now())):d.set(p.key,Lr.empty())})),this.recalculateAndSaveOverlays(e,u).next((y=>(y.forEach(((p,b)=>d.set(p,b))),t.forEach(((p,b)=>g.set(p,new JI(b,d.get(p)??null)))),g)))}recalculateAndSaveOverlays(e,t){const i=pu();let l=new Jn(((d,g)=>d-g)),u=sn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const g of d)g.keys().forEach((y=>{const p=t.get(y);if(p===null)return;let b=i.get(y)||Lr.empty();b=g.applyToLocalView(p,b),i.set(y,b);const k=(l.get(g.batchId)||sn()).add(y);l=l.insert(g.batchId,k)}))})).next((()=>{const d=[],g=l.getReverseIterator();for(;g.hasNext();){const y=g.getNext(),p=y.key,b=y.value,k=ok();b.forEach((E=>{if(!u.has(E)){const M=mk(t.get(E),i.get(E));M!==null&&k.set(E,M),u=u.add(E)}})),d.push(this.documentOverlayCache.saveOverlays(e,p,k))}return Ne.waitFor(d)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,l){return tI(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):nk(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,l):this.getDocumentsMatchingCollectionQuery(e,t,i,l)}getNextDocuments(e,t,i,l){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,l).next((u=>{const d=l-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,l-u.size):Ne.resolve(Oo());let g=ju,y=u;return d.next((p=>Ne.forEach(p,((b,k)=>(g<k.largestBatchId&&(g=k.largestBatchId),u.get(b)?Ne.resolve():this.remoteDocumentCache.getEntry(e,b).next((E=>{y=y.insert(b,E)}))))).next((()=>this.populateOverlays(e,p,u))).next((()=>this.computeViews(e,y,p,sn()))).next((b=>({batchId:g,changes:ak(b)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ft(t)).next((i=>{let l=lu();return i.isFoundDocument()&&(l=l.insert(i.key,i)),l}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,l){const u=t.collectionGroup;let d=lu();return this.indexManager.getCollectionParents(e,u).next((g=>Ne.forEach(g,(y=>{const p=(function(k,E){return new cc(E,null,k.explicitOrderBy.slice(),k.filters.slice(),k.limit,k.limitType,k.startAt,k.endAt)})(t,y.child(u));return this.getDocumentsMatchingCollectionQuery(e,p,i,l).next((b=>{b.forEach(((k,E)=>{d=d.insert(k,E)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,i,l){let u;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((d=>(u=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,u,l)))).next((d=>{u.forEach(((y,p)=>{const b=p.getKey();d.get(b)===null&&(d=d.insert(b,Xs.newInvalidDocument(b)))}));let g=lu();return d.forEach(((y,p)=>{const b=u.get(y);b!==void 0&&yu(b.mutation,p,Lr.empty(),Bt.now()),pf(t,p)&&(g=g.insert(y,p))})),g}))}}class e6{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return Ne.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(l){return{id:l.id,version:l.version,createTime:Li(l.createTime)}})(t)),Ne.resolve()}getNamedQuery(e,t){return Ne.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(l){return{name:l.name,query:HI(l.bundledQuery),readTime:Li(l.readTime)}})(t)),Ne.resolve()}}class t6{constructor(){this.overlays=new Jn(ft.comparator),this.Lr=new Map}getOverlay(e,t){return Ne.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Oo();return Ne.forEach(t,(l=>this.getOverlay(e,l).next((u=>{u!==null&&i.set(l,u)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((l,u)=>{this.bt(e,t,u)})),Ne.resolve()}removeOverlaysForBatchId(e,t,i){const l=this.Lr.get(i);return l!==void 0&&(l.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(i)),Ne.resolve()}getOverlaysForCollection(e,t,i){const l=Oo(),u=t.length+1,d=new ft(t.child("")),g=this.overlays.getIteratorFrom(d);for(;g.hasNext();){const y=g.getNext().value,p=y.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===u&&y.largestBatchId>i&&l.set(y.getKey(),y)}return Ne.resolve(l)}getOverlaysForCollectionGroup(e,t,i,l){let u=new Jn(((p,b)=>p-b));const d=this.overlays.getIterator();for(;d.hasNext();){const p=d.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>i){let b=u.get(p.largestBatchId);b===null&&(b=Oo(),u=u.insert(p.largestBatchId,b)),b.set(p.getKey(),p)}}const g=Oo(),y=u.getIterator();for(;y.hasNext()&&(y.getNext().value.forEach(((p,b)=>g.set(p,b))),!(g.size()>=l)););return Ne.resolve(g)}bt(e,t,i){const l=this.overlays.get(i.key);if(l!==null){const d=this.Lr.get(l.largestBatchId).delete(i.key);this.Lr.set(l.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new bI(t,i));let u=this.Lr.get(t);u===void 0&&(u=sn(),this.Lr.set(t,u)),this.Lr.set(t,u.add(i.key))}}class n6{constructor(){this.sessionToken=Fs.EMPTY_BYTE_STRING}getSessionToken(e){return Ne.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Ne.resolve()}}class Iy{constructor(){this.kr=new Ts(Is.Kr),this.qr=new Ts(Is.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Is(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Is(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new ft(new Dn([])),i=new Is(t,e),l=new Is(t,e+1),u=[];return this.qr.forEachInRange([i,l],(d=>{this.Wr(d),u.push(d.key)})),u}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new ft(new Dn([])),i=new Is(t,e),l=new Is(t,e+1);let u=sn();return this.qr.forEachInRange([i,l],(d=>{u=u.add(d.key)})),u}containsKey(e){const t=new Is(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Is{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return ft.comparator(e.key,t.key)||nn(e.Hr,t.Hr)}static Ur(e,t){return nn(e.Hr,t.Hr)||ft.comparator(e.key,t.key)}}class s6{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Ts(Is.Kr)}checkEmpty(e){return Ne.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,l){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new vI(u,t,i,l);this.mutationQueue.push(d);for(const g of l)this.Jr=this.Jr.add(new Is(g.key,u)),this.indexManager.addToCollectionParentIndex(e,g.key.path.popLast());return Ne.resolve(d)}lookupMutationBatch(e,t){return Ne.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,l=this.Xr(i),u=l<0?0:l;return Ne.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return Ne.resolve(this.mutationQueue.length===0?ky:this.Yn-1)}getAllMutationBatches(e){return Ne.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Is(t,0),l=new Is(t,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([i,l],(d=>{const g=this.Zr(d.Hr);u.push(g)})),Ne.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Ts(nn);return t.forEach((l=>{const u=new Is(l,0),d=new Is(l,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,d],(g=>{i=i.add(g.Hr)}))})),Ne.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,l=i.length+1;let u=i;ft.isDocumentKey(u)||(u=u.child(""));const d=new Is(new ft(u),0);let g=new Ts(nn);return this.Jr.forEachWhile((y=>{const p=y.key.path;return!!i.isPrefixOf(p)&&(p.length===l&&(g=g.add(y.Hr)),!0)}),d),Ne.resolve(this.Yr(g))}Yr(e){const t=[];return e.forEach((i=>{const l=this.Zr(i);l!==null&&t.push(l)})),t}removeMutationBatch(e,t){kn(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return Ne.forEach(t.mutations,(l=>{const u=new Is(l.key,t.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,l.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Is(t,0),l=this.Jr.firstAfterOrEqual(i);return Ne.resolve(t.isEqual(l&&l.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ne.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class r6{constructor(e){this.ti=e,this.docs=(function(){return new Jn(ft.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,l=this.docs.get(i),u=l?l.size:0,d=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:d}),this.size+=d-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Ne.resolve(i?i.document.mutableCopy():Xs.newInvalidDocument(t))}getEntries(e,t){let i=xa();return t.forEach((l=>{const u=this.docs.get(l);i=i.insert(l,u?u.document.mutableCopy():Xs.newInvalidDocument(l))})),Ne.resolve(i)}getDocumentsMatchingQuery(e,t,i,l){let u=xa();const d=t.path,g=new ft(d.child("__id-9223372036854775808__")),y=this.docs.getIteratorFrom(g);for(;y.hasNext();){const{key:p,value:{document:b}}=y.getNext();if(!d.isPrefixOf(p.path))break;p.path.length>d.length+1||RR(AR(b),i)<=0||(l.has(b.key)||pf(t,b))&&(u=u.insert(b.key,b.mutableCopy()))}return Ne.resolve(u)}getAllFromCollectionGroup(e,t,i,l){jt(9500)}ni(e,t){return Ne.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new i6(this)}getSize(e){return Ne.resolve(this.size)}}class i6 extends XI{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,l)=>{l.isValidDocument()?t.push(this.Mr.addEntry(e,l)):this.Mr.removeEntry(i)})),Ne.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class a6{constructor(e){this.persistence=e,this.ri=new Jo((t=>Ty(t)),Sy),this.lastRemoteSnapshotVersion=Dt.min(),this.highestTargetId=0,this.ii=0,this.si=new Iy,this.targetCount=0,this.oi=Zl._r()}forEachTarget(e,t){return this.ri.forEach(((i,l)=>t(l))),Ne.resolve()}getLastRemoteSnapshotVersion(e){return Ne.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ne.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),Ne.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),Ne.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Zl(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,Ne.resolve()}updateTargetData(e,t){return this.lr(t),Ne.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,Ne.resolve()}removeTargets(e,t,i){let l=0;const u=[];return this.ri.forEach(((d,g)=>{g.sequenceNumber<=t&&i.get(g.targetId)===null&&(this.ri.delete(d),u.push(this.removeMatchingKeysForTargetId(e,g.targetId)),l++)})),Ne.waitFor(u).next((()=>l))}getTargetCount(e){return Ne.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return Ne.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),Ne.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const l=this.persistence.referenceDelegate,u=[];return l&&t.forEach((d=>{u.push(l.markPotentiallyOrphaned(e,d))})),Ne.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),Ne.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return Ne.resolve(i)}containsKey(e,t){return Ne.resolve(this.si.containsKey(t))}}class Ck{constructor(e,t){this._i={},this.overlays={},this.ai=new df(0),this.ui=!1,this.ui=!0,this.ci=new n6,this.referenceDelegate=e(this),this.li=new a6(this),this.indexManager=new qI,this.remoteDocumentCache=(function(l){return new r6(l)})((i=>this.referenceDelegate.hi(i))),this.serializer=new FI(t),this.Pi=new e6(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new t6,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new s6(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){Xe("MemoryPersistence","Starting transaction:",e);const l=new o6(this.ai.next());return this.referenceDelegate.Ti(),i(l).next((u=>this.referenceDelegate.Ii(l).next((()=>u)))).toPromise().then((u=>(l.raiseOnCommittedEvent(),u)))}Ei(e,t){return Ne.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class o6 extends MR{constructor(e){super(),this.currentSequenceNumber=e}}class My{constructor(e){this.persistence=e,this.Ri=new Iy,this.Ai=null}static Vi(e){return new My(e)}get di(){if(this.Ai)return this.Ai;throw jt(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),Ne.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),Ne.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),Ne.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((l=>this.di.add(l.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((l=>{l.forEach((u=>this.di.add(u.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ne.forEach(this.di,(i=>{const l=ft.fromPath(i);return this.mi(e,l).next((u=>{u||t.removeEntry(l,Dt.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return Ne.or([()=>Ne.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Yh{constructor(e,t){this.persistence=e,this.fi=new Jo((i=>PR(i.path)),((i,l)=>i.isEqual(l))),this.garbageCollector=QI(this,t)}static Vi(e,t){return new Yh(e,t)}Ti(){}Ii(e){return Ne.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((l=>i+l))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return Ne.forEach(this.fi,((i,l)=>this.wr(e,i,l).next((u=>u?Ne.resolve():t(l)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const l=this.persistence.getRemoteDocumentCache(),u=l.newChangeBuffer();return l.ni(e,(d=>this.wr(e,d,t).next((g=>{g||(i++,u.removeEntry(d,Dt.min()))})))).next((()=>u.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),Ne.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Ne.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Ne.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),Ne.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Nh(e.data.value)),t}wr(e,t,i){return Ne.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const l=this.fi.get(t);return Ne.resolve(l!==void 0&&l>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Dy{constructor(e,t,i,l){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=l}static Es(e,t){let i=sn(),l=sn();for(const u of t.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:l=l.add(u.doc.key)}return new Dy(e,t.fromCache,i,l)}}class l6{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class c6{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return UC()?8:DR(Js())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,l){const u={result:null};return this.gs(e,t).next((d=>{u.result=d})).next((()=>{if(!u.result)return this.ps(e,t,l,i).next((d=>{u.result=d}))})).next((()=>{if(u.result)return;const d=new l6;return this.ys(e,t,d).next((g=>{if(u.result=g,this.As)return this.ws(e,t,d,g.size)}))})).next((()=>u.result))}ws(e,t,i,l){return i.documentReadCount<this.Vs?(Ol()<=en.DEBUG&&Xe("QueryEngine","SDK will not create cache indexes for query:",Vl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Ne.resolve()):(Ol()<=en.DEBUG&&Xe("QueryEngine","Query:",Vl(t),"scans",i.documentReadCount,"local documents and returns",l,"documents as results."),i.documentReadCount>this.ds*l?(Ol()<=en.DEBUG&&Xe("QueryEngine","The SDK decides to create cache indexes for query:",Vl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Di(t))):Ne.resolve())}gs(e,t){if(nw(t))return Ne.resolve(null);let i=Di(t);return this.indexManager.getIndexType(e,i).next((l=>l===0?null:(t.limit!==null&&l===1&&(t=Dp(t,null,"F"),i=Di(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((u=>{const d=sn(...u);return this.fs.getDocuments(e,d).next((g=>this.indexManager.getMinOffset(e,i).next((y=>{const p=this.bs(t,g);return this.Ss(t,p,d,y.readTime)?this.gs(e,Dp(t,null,"F")):this.Ds(e,p,t,y)}))))})))))}ps(e,t,i,l){return nw(t)||l.isEqual(Dt.min())?Ne.resolve(null):this.fs.getDocuments(e,i).next((u=>{const d=this.bs(t,u);return this.Ss(t,d,i,l)?Ne.resolve(null):(Ol()<=en.DEBUG&&Xe("QueryEngine","Re-using previous result from %s to execute query: %s",l.toString(),Vl(t)),this.Ds(e,d,t,NR(l,ju)).next((g=>g)))}))}bs(e,t){let i=new Ts(rk(e));return t.forEach(((l,u)=>{pf(e,u)&&(i=i.add(u))})),i}Ss(e,t,i,l){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const u=e.limitType==="F"?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(l)>0)}ys(e,t,i){return Ol()<=en.DEBUG&&Xe("QueryEngine","Using full collection scan to execute query:",Vl(t)),this.fs.getDocumentsMatchingQuery(e,t,ao.min(),i)}Ds(e,t,i,l){return this.fs.getDocumentsMatchingQuery(e,i,l).next((u=>(t.forEach((d=>{u=u.insert(d.key,d)})),u)))}}const Ly="LocalStore",u6=3e8;class d6{constructor(e,t,i,l){this.persistence=e,this.Cs=t,this.serializer=l,this.vs=new Jn(nn),this.Fs=new Jo((u=>Ty(u)),Sy),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ZI(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function h6(s,e,t,i){return new d6(s,e,t,i)}async function Nk(s,e){const t=Pt(s);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let l;return t.mutationQueue.getAllMutationBatches(i).next((u=>(l=u,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((u=>{const d=[],g=[];let y=sn();for(const p of l){d.push(p.batchId);for(const b of p.mutations)y=y.add(b.key)}for(const p of u){g.push(p.batchId);for(const b of p.mutations)y=y.add(b.key)}return t.localDocuments.getDocuments(i,y).next((p=>({Ns:p,removedBatchIds:d,addedBatchIds:g})))}))}))}function f6(s,e){const t=Pt(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const l=e.batch.keys(),u=t.xs.newChangeBuffer({trackRemovals:!0});return(function(g,y,p,b){const k=p.batch,E=k.keys();let M=Ne.resolve();return E.forEach((H=>{M=M.next((()=>b.getEntry(y,H))).next((K=>{const B=p.docVersions.get(H);kn(B!==null,48541),K.version.compareTo(B)<0&&(k.applyToRemoteDocument(K,p),K.isValidDocument()&&(K.setReadTime(p.commitVersion),b.addEntry(K)))}))})),M.next((()=>g.mutationQueue.removeMutationBatch(y,k)))})(t,i,e,u).next((()=>u.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,l,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(g){let y=sn();for(let p=0;p<g.mutationResults.length;++p)g.mutationResults[p].transformResults.length>0&&(y=y.add(g.batch.mutations[p].key));return y})(e)))).next((()=>t.localDocuments.getDocuments(i,l)))}))}function Ak(s){const e=Pt(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function m6(s,e){const t=Pt(s),i=e.snapshotVersion;let l=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const d=t.xs.newChangeBuffer({trackRemovals:!0});l=t.vs;const g=[];e.targetChanges.forEach(((b,k)=>{const E=l.get(k);if(!E)return;g.push(t.li.removeMatchingKeys(u,b.removedDocuments,k).next((()=>t.li.addMatchingKeys(u,b.addedDocuments,k))));let M=E.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(k)!==null?M=M.withResumeToken(Fs.EMPTY_BYTE_STRING,Dt.min()).withLastLimboFreeSnapshotVersion(Dt.min()):b.resumeToken.approximateByteSize()>0&&(M=M.withResumeToken(b.resumeToken,i)),l=l.insert(k,M),(function(K,B,Y){return K.resumeToken.approximateByteSize()===0||B.snapshotVersion.toMicroseconds()-K.snapshotVersion.toMicroseconds()>=u6?!0:Y.addedDocuments.size+Y.modifiedDocuments.size+Y.removedDocuments.size>0})(E,M,b)&&g.push(t.li.updateTargetData(u,M))}));let y=xa(),p=sn();if(e.documentUpdates.forEach((b=>{e.resolvedLimboDocuments.has(b)&&g.push(t.persistence.referenceDelegate.updateLimboDocument(u,b))})),g.push(g6(u,d,e.documentUpdates).next((b=>{y=b.Bs,p=b.Ls}))),!i.isEqual(Dt.min())){const b=t.li.getLastRemoteSnapshotVersion(u).next((k=>t.li.setTargetsMetadata(u,u.currentSequenceNumber,i)));g.push(b)}return Ne.waitFor(g).next((()=>d.apply(u))).next((()=>t.localDocuments.getLocalViewOfDocuments(u,y,p))).next((()=>y))})).then((u=>(t.vs=l,u)))}function g6(s,e,t){let i=sn(),l=sn();return t.forEach((u=>i=i.add(u))),e.getEntries(s,i).next((u=>{let d=xa();return t.forEach(((g,y)=>{const p=u.get(g);y.isFoundDocument()!==p.isFoundDocument()&&(l=l.add(g)),y.isNoDocument()&&y.version.isEqual(Dt.min())?(e.removeEntry(g,y.readTime),d=d.insert(g,y)):!p.isValidDocument()||y.version.compareTo(p.version)>0||y.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(y),d=d.insert(g,y)):Xe(Ly,"Ignoring outdated watch update for ",g,". Current version:",p.version," Watch version:",y.version)})),{Bs:d,Ls:l}}))}function p6(s,e){const t=Pt(s);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=ky),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function y6(s,e){const t=Pt(s);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let l;return t.li.getTargetData(i,e).next((u=>u?(l=u,Ne.resolve(l)):t.li.allocateTargetId(i).next((d=>(l=new to(e,d,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,l).next((()=>l)))))))})).then((i=>{const l=t.vs.get(i.targetId);return(l===null||i.snapshotVersion.compareTo(l.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function Up(s,e,t){const i=Pt(s),l=i.vs.get(e),u=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",u,(d=>i.persistence.referenceDelegate.removeTarget(d,l)))}catch(d){if(!lc(d))throw d;Xe(Ly,`Failed to update sequence numbers for target ${e}: ${d}`)}i.vs=i.vs.remove(e),i.Fs.delete(l.target)}function gw(s,e,t){const i=Pt(s);let l=Dt.min(),u=sn();return i.persistence.runTransaction("Execute query","readwrite",(d=>(function(y,p,b){const k=Pt(y),E=k.Fs.get(b);return E!==void 0?Ne.resolve(k.vs.get(E)):k.li.getTargetData(p,b)})(i,d,Di(e)).next((g=>{if(g)return l=g.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(d,g.targetId).next((y=>{u=y}))})).next((()=>i.Cs.getDocumentsMatchingQuery(d,e,t?l:Dt.min(),t?u:sn()))).next((g=>(v6(i,rI(e),g),{documents:g,ks:u})))))}function v6(s,e,t){let i=s.Ms.get(e)||Dt.min();t.forEach(((l,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)})),s.Ms.set(e,i)}class pw{constructor(){this.activeTargetIds=uI()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class b6{constructor(){this.vo=new pw,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new pw,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class w6{Mo(e){}shutdown(){}}const yw="ConnectivityMonitor";class vw{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){Xe(yw,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){Xe(yw,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let mh=null;function Bp(){return mh===null?mh=(function(){return 268435456+Math.round(2147483648*Math.random())})():mh++,"0x"+mh.toString(16)}const $g="RestConnection",x6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class _6{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${l}`,this.$o=this.databaseId.database===$h?`project_id=${i}`:`project_id=${i}&database_id=${l}`}Wo(e,t,i,l,u){const d=Bp(),g=this.Qo(e,t.toUriEncodedString());Xe($g,`Sending RPC '${e}' ${d}:`,g,i);const y={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(y,l,u);const{host:p}=new URL(g),b=fo(p);return this.zo(e,g,y,i,b).then((k=>(Xe($g,`Received RPC '${e}' ${d}: `,k),k)),(k=>{throw Gl($g,`RPC '${e}' ${d} failed with error: `,k,"url: ",g,"request:",i),k}))}jo(e,t,i,l,u,d){return this.Wo(e,t,i,l,u)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+ac})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((l,u)=>e[u]=l)),i&&i.headers.forEach(((l,u)=>e[u]=l))}Qo(e,t){const i=x6[e];let l=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(l=`${l}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),l}terminate(){}}class k6{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const Ys="WebChannelConnection",Jc=(s,e,t)=>{s.listen(e,(i=>{try{t(i)}catch(l){setTimeout((()=>{throw l}),0)}}))};class ql extends _6{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!ql.c_){const e=D_();Jc(e,M_.STAT_EVENT,(t=>{t.stat===Sp.PROXY?Xe(Ys,"STAT_EVENT: detected buffering proxy"):t.stat===Sp.NOPROXY&&Xe(Ys,"STAT_EVENT: detected no buffering proxy")})),ql.c_=!0}}zo(e,t,i,l,u){const d=Bp();return new Promise(((g,y)=>{const p=new R_;p.setWithCredentials(!0),p.listenOnce(I_.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case Ch.NO_ERROR:const k=p.getResponseJson();Xe(Ys,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(k)),g(k);break;case Ch.TIMEOUT:Xe(Ys,`RPC '${e}' ${d} timed out`),y(new We(_e.DEADLINE_EXCEEDED,"Request time out"));break;case Ch.HTTP_ERROR:const E=p.getStatus();if(Xe(Ys,`RPC '${e}' ${d} failed with status:`,E,"response text:",p.getResponseText()),E>0){let M=p.getResponseJson();Array.isArray(M)&&(M=M[0]);const H=M?.error;if(H&&H.status&&H.message){const K=(function(Y){const ee=Y.toLowerCase().replace(/_/g,"-");return Object.values(_e).indexOf(ee)>=0?ee:_e.UNKNOWN})(H.status);y(new We(K,H.message))}else y(new We(_e.UNKNOWN,"Server responded with status "+p.getStatus()))}else y(new We(_e.UNAVAILABLE,"Connection failed."));break;default:jt(9055,{l_:e,streamId:d,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{Xe(Ys,`RPC '${e}' ${d} completed.`)}}));const b=JSON.stringify(l);Xe(Ys,`RPC '${e}' ${d} sending request:`,l),p.send(t,"POST",b,i,15)}))}T_(e,t,i){const l=Bp(),u=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),g={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},y=this.longPollingOptions.timeoutSeconds;y!==void 0&&(g.longPollingTimeout=Math.round(1e3*y)),this.useFetchStreams&&(g.useFetchStreams=!0),this.Go(g.initMessageHeaders,t,i),g.encodeInitMessageHeaders=!0;const p=u.join("");Xe(Ys,`Creating RPC '${e}' stream ${l}: ${p}`,g);const b=d.createWebChannel(p,g);this.I_(b);let k=!1,E=!1;const M=new k6({Ho:H=>{E?Xe(Ys,`Not sending because RPC '${e}' stream ${l} is closed:`,H):(k||(Xe(Ys,`Opening RPC '${e}' stream ${l} transport.`),b.open(),k=!0),Xe(Ys,`RPC '${e}' stream ${l} sending:`,H),b.send(H))},Jo:()=>b.close()});return Jc(b,ou.EventType.OPEN,(()=>{E||(Xe(Ys,`RPC '${e}' stream ${l} transport opened.`),M.i_())})),Jc(b,ou.EventType.CLOSE,(()=>{E||(E=!0,Xe(Ys,`RPC '${e}' stream ${l} transport closed`),M.o_(),this.E_(b))})),Jc(b,ou.EventType.ERROR,(H=>{E||(E=!0,Gl(Ys,`RPC '${e}' stream ${l} transport errored. Name:`,H.name,"Message:",H.message),M.o_(new We(_e.UNAVAILABLE,"The operation could not be completed")))})),Jc(b,ou.EventType.MESSAGE,(H=>{if(!E){const K=H.data[0];kn(!!K,16349);const B=K,Y=B?.error||B[0]?.error;if(Y){Xe(Ys,`RPC '${e}' stream ${l} received error:`,Y);const ee=Y.status;let ae=(function(he){const D=bs[he];if(D!==void 0)return pk(D)})(ee),ye=Y.message;ae===void 0&&(ae=_e.INTERNAL,ye="Unknown error status: "+ee+" with message "+Y.message),E=!0,M.o_(new We(ae,ye)),b.close()}else Xe(Ys,`RPC '${e}' stream ${l} received:`,K),M.__(K)}})),ql.u_(),setTimeout((()=>{M.s_()}),0),M}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return L_()}}function j6(s){return new ql(s)}function Wg(){return typeof document<"u"?document:null}function _f(s){return new CI(s,!0)}ql.c_=!1;class Rk{constructor(e,t,i=1e3,l=1.5,u=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=l,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),l=Math.max(0,t-i);l>0&&Xe("ExponentialBackoff",`Backing off for ${l} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,l,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const bw="PersistentStream";class Ik{constructor(e,t,i,l,u,d,g,y){this.Ci=e,this.b_=i,this.S_=l,this.connection=u,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=g,this.listener=y,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Rk(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===_e.RESOURCE_EXHAUSTED?(wa(t.toString()),wa("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===_e.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,l])=>{this.D_===t&&this.G_(i,l)}),(i=>{e((()=>{const l=new We(_e.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(l)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((l=>{i((()=>this.z_(l)))})),this.stream.onMessage((l=>{i((()=>++this.F_==1?this.H_(l):this.onNext(l)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Xe(bw,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(Xe(bw,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class E6 extends Ik{constructor(e,t,i,l,u,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=RI(this.serializer,e),i=(function(u){if(!("targetChange"in u))return Dt.min();const d=u.targetChange;return d.targetIds&&d.targetIds.length?Dt.min():d.readTime?Li(d.readTime):Dt.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=Vp(this.serializer),t.addTarget=(function(u,d){let g;const y=d.target;if(g=Ip(y)?{documents:DI(u,y)}:{query:LI(u,y).ft},g.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){g.resumeToken=bk(u,d.resumeToken);const p=Lp(u,d.expectedCount);p!==null&&(g.expectedCount=p)}else if(d.snapshotVersion.compareTo(Dt.min())>0){g.readTime=Kh(u,d.snapshotVersion.toTimestamp());const p=Lp(u,d.expectedCount);p!==null&&(g.expectedCount=p)}return g})(this.serializer,e);const i=OI(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=Vp(this.serializer),t.removeTarget=e,this.K_(t)}}class T6 extends Ik{constructor(e,t,i,l,u,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return kn(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,kn(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){kn(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=MI(e.writeResults,e.commitTime),i=Li(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=Vp(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>II(this.serializer,i)))};this.K_(t)}}class S6{}class C6 extends S6{constructor(e,t,i,l){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=l,this.ia=!1}sa(){if(this.ia)throw new We(_e.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.Wo(e,Pp(t,i),l,u,d))).catch((u=>{throw u.name==="FirebaseError"?(u.code===_e.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new We(_e.UNKNOWN,u.toString())}))}jo(e,t,i,l,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,g])=>this.connection.jo(e,Pp(t,i),l,d,g,u))).catch((d=>{throw d.name==="FirebaseError"?(d.code===_e.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new We(_e.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function N6(s,e,t,i){return new C6(s,e,t,i)}class A6{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(wa(t),this.aa=!1):Xe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const qo="RemoteStore";class R6{constructor(e,t,i,l,u){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((d=>{i.enqueueAndForget((async()=>{Zo(this)&&(Xe(qo,"Restarting streams for network reachability change."),await(async function(y){const p=Pt(y);p.Ea.add(4),await Hu(p),p.Va.set("Unknown"),p.Ea.delete(4),await kf(p)})(this))}))})),this.Va=new A6(i,l)}}async function kf(s){if(Zo(s))for(const e of s.Ra)await e(!0)}async function Hu(s){for(const e of s.Ra)await e(!1)}function Mk(s,e){const t=Pt(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Uy(t)?Vy(t):uc(t).O_()&&Oy(t,e))}function Py(s,e){const t=Pt(s),i=uc(t);t.Ia.delete(e),i.O_()&&Dk(t,e),t.Ia.size===0&&(i.O_()?i.L_():Zo(t)&&t.Va.set("Unknown"))}function Oy(s,e){if(s.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Dt.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}uc(s).Z_(e)}function Dk(s,e){s.da.$e(e),uc(s).X_(e)}function Vy(s){s.da=new jI({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),uc(s).start(),s.Va.ua()}function Uy(s){return Zo(s)&&!uc(s).x_()&&s.Ia.size>0}function Zo(s){return Pt(s).Ea.size===0}function Lk(s){s.da=void 0}async function I6(s){s.Va.set("Online")}async function M6(s){s.Ia.forEach(((e,t)=>{Oy(s,e)}))}async function D6(s,e){Lk(s),Uy(s)?(s.Va.ha(e),Vy(s)):s.Va.set("Unknown")}async function L6(s,e,t){if(s.Va.set("Online"),e instanceof vk&&e.state===2&&e.cause)try{await(async function(l,u){const d=u.cause;for(const g of u.targetIds)l.Ia.has(g)&&(await l.remoteSyncer.rejectListen(g,d),l.Ia.delete(g),l.da.removeTarget(g))})(s,e)}catch(i){Xe(qo,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Qh(s,i)}else if(e instanceof Ih?s.da.Xe(e):e instanceof yk?s.da.st(e):s.da.tt(e),!t.isEqual(Dt.min()))try{const i=await Ak(s.localStore);t.compareTo(i)>=0&&await(function(u,d){const g=u.da.Tt(d);return g.targetChanges.forEach(((y,p)=>{if(y.resumeToken.approximateByteSize()>0){const b=u.Ia.get(p);b&&u.Ia.set(p,b.withResumeToken(y.resumeToken,d))}})),g.targetMismatches.forEach(((y,p)=>{const b=u.Ia.get(y);if(!b)return;u.Ia.set(y,b.withResumeToken(Fs.EMPTY_BYTE_STRING,b.snapshotVersion)),Dk(u,y);const k=new to(b.target,y,p,b.sequenceNumber);Oy(u,k)})),u.remoteSyncer.applyRemoteEvent(g)})(s,t)}catch(i){Xe(qo,"Failed to raise snapshot:",i),await Qh(s,i)}}async function Qh(s,e,t){if(!lc(e))throw e;s.Ea.add(1),await Hu(s),s.Va.set("Offline"),t||(t=()=>Ak(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{Xe(qo,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await kf(s)}))}function Pk(s,e){return e().catch((t=>Qh(s,t,e)))}async function jf(s){const e=Pt(s),t=uo(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ky;for(;P6(e);)try{const l=await p6(e.localStore,i);if(l===null){e.Ta.length===0&&t.L_();break}i=l.batchId,O6(e,l)}catch(l){await Qh(e,l)}Ok(e)&&Vk(e)}function P6(s){return Zo(s)&&s.Ta.length<10}function O6(s,e){s.Ta.push(e);const t=uo(s);t.O_()&&t.Y_&&t.ea(e.mutations)}function Ok(s){return Zo(s)&&!uo(s).x_()&&s.Ta.length>0}function Vk(s){uo(s).start()}async function V6(s){uo(s).ra()}async function U6(s){const e=uo(s);for(const t of s.Ta)e.ea(t.mutations)}async function B6(s,e,t){const i=s.Ta.shift(),l=Ny.from(i,e,t);await Pk(s,(()=>s.remoteSyncer.applySuccessfulWrite(l))),await jf(s)}async function z6(s,e){e&&uo(s).Y_&&await(async function(i,l){if((function(d){return xI(d)&&d!==_e.ABORTED})(l.code)){const u=i.Ta.shift();uo(i).B_(),await Pk(i,(()=>i.remoteSyncer.rejectFailedWrite(u.batchId,l))),await jf(i)}})(s,e),Ok(s)&&Vk(s)}async function ww(s,e){const t=Pt(s);t.asyncQueue.verifyOperationInProgress(),Xe(qo,"RemoteStore received new credentials");const i=Zo(t);t.Ea.add(3),await Hu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await kf(t)}async function F6(s,e){const t=Pt(s);e?(t.Ea.delete(2),await kf(t)):e||(t.Ea.add(2),await Hu(t),t.Va.set("Unknown"))}function uc(s){return s.ma||(s.ma=(function(t,i,l){const u=Pt(t);return u.sa(),new E6(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(s.datastore,s.asyncQueue,{Zo:I6.bind(null,s),Yo:M6.bind(null,s),t_:D6.bind(null,s),J_:L6.bind(null,s)}),s.Ra.push((async e=>{e?(s.ma.B_(),Uy(s)?Vy(s):s.Va.set("Unknown")):(await s.ma.stop(),Lk(s))}))),s.ma}function uo(s){return s.fa||(s.fa=(function(t,i,l){const u=Pt(t);return u.sa(),new T6(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(s.datastore,s.asyncQueue,{Zo:()=>Promise.resolve(),Yo:V6.bind(null,s),t_:z6.bind(null,s),ta:U6.bind(null,s),na:B6.bind(null,s)}),s.Ra.push((async e=>{e?(s.fa.B_(),await jf(s)):(await s.fa.stop(),s.Ta.length>0&&(Xe(qo,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}class By{constructor(e,t,i,l,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=l,this.removalCallback=u,this.deferred=new ma,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,l,u){const d=Date.now()+i,g=new By(e,t,d,l,u);return g.start(i),g}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new We(_e.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function zy(s,e){if(wa("AsyncQueue",`${e}: ${s}`),lc(s))return new We(_e.UNAVAILABLE,`${e}: ${s}`);throw s}class $l{static emptySet(e){return new $l(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||ft.comparator(t.key,i.key):(t,i)=>ft.comparator(t.key,i.key),this.keyedMap=lu(),this.sortedSet=new Jn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof $l)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(!l.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new $l;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class xw{constructor(){this.ga=new Jn(ft.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):jt(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class ec{constructor(e,t,i,l,u,d,g,y,p){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=l,this.mutatedKeys=u,this.fromCache=d,this.syncStateChanged=g,this.excludesMetadataChanges=y,this.hasCachedResults=p}static fromInitialDocuments(e,t,i,l,u){const d=[];return t.forEach((g=>{d.push({type:0,doc:g})})),new ec(e,t,$l.emptySet(t),d,i,l,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&gf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let l=0;l<t.length;l++)if(t[l].type!==i[l].type||!t[l].doc.isEqual(i[l].doc))return!1;return!0}}class H6{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class q6{constructor(){this.queries=_w(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const l=Pt(t),u=l.queries;l.queries=_w(),u.forEach(((d,g)=>{for(const y of g.ba)y.onError(i)}))})(this,new We(_e.ABORTED,"Firestore shutting down"))}}function _w(){return new Jo((s=>sk(s)),gf)}async function Fy(s,e){const t=Pt(s);let i=3;const l=e.query;let u=t.queries.get(l);u?!u.Sa()&&e.Da()&&(i=2):(u=new H6,i=e.Da()?0:1);try{switch(i){case 0:u.wa=await t.onListen(l,!0);break;case 1:u.wa=await t.onListen(l,!1);break;case 2:await t.onFirstRemoteStoreListen(l)}}catch(d){const g=zy(d,`Initialization of query '${Vl(e.query)}' failed`);return void e.onError(g)}t.queries.set(l,u),u.ba.push(e),e.va(t.onlineState),u.wa&&e.Fa(u.wa)&&qy(t)}async function Hy(s,e){const t=Pt(s),i=e.query;let l=3;const u=t.queries.get(i);if(u){const d=u.ba.indexOf(e);d>=0&&(u.ba.splice(d,1),u.ba.length===0?l=e.Da()?0:1:!u.Sa()&&e.Da()&&(l=2))}switch(l){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function $6(s,e){const t=Pt(s);let i=!1;for(const l of e){const u=l.query,d=t.queries.get(u);if(d){for(const g of d.ba)g.Fa(l)&&(i=!0);d.wa=l}}i&&qy(t)}function W6(s,e,t){const i=Pt(s),l=i.queries.get(e);if(l)for(const u of l.ba)u.onError(t);i.queries.delete(e)}function qy(s){s.Ca.forEach((e=>{e.next()}))}var zp,kw;(kw=zp||(zp={})).Ma="default",kw.Cache="cache";class $y{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const l of e.docChanges)l.type!==3&&i.push(l);e=new ec(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=ec.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==zp.Cache}}class Uk{constructor(e){this.key=e}}class Bk{constructor(e){this.key=e}}class G6{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=sn(),this.mutatedKeys=sn(),this.eu=rk(e),this.tu=new $l(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new xw,l=t?t.tu:this.tu;let u=t?t.mutatedKeys:this.mutatedKeys,d=l,g=!1;const y=this.query.limitType==="F"&&l.size===this.query.limit?l.last():null,p=this.query.limitType==="L"&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal(((b,k)=>{const E=l.get(b),M=pf(this.query,k)?k:null,H=!!E&&this.mutatedKeys.has(E.key),K=!!M&&(M.hasLocalMutations||this.mutatedKeys.has(M.key)&&M.hasCommittedMutations);let B=!1;E&&M?E.data.isEqual(M.data)?H!==K&&(i.track({type:3,doc:M}),B=!0):this.su(E,M)||(i.track({type:2,doc:M}),B=!0,(y&&this.eu(M,y)>0||p&&this.eu(M,p)<0)&&(g=!0)):!E&&M?(i.track({type:0,doc:M}),B=!0):E&&!M&&(i.track({type:1,doc:E}),B=!0,(y||p)&&(g=!0)),B&&(M?(d=d.add(M),u=K?u.add(b):u.delete(b)):(d=d.delete(b),u=u.delete(b)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const b=this.query.limitType==="F"?d.last():d.first();d=d.delete(b.key),u=u.delete(b.key),i.track({type:1,doc:b})}return{tu:d,iu:i,Ss:g,mutatedKeys:u}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,l){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((b,k)=>(function(M,H){const K=B=>{switch(B){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return jt(20277,{Vt:B})}};return K(M)-K(H)})(b.type,k.type)||this.eu(b.doc,k.doc))),this.ou(i),l=l??!1;const g=t&&!l?this._u():[],y=this.Ya.size===0&&this.current&&!l?1:0,p=y!==this.Xa;return this.Xa=y,d.length!==0||p?{snapshot:new ec(this.query,e.tu,u,d,e.mutatedKeys,y===0,p,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:g}:{au:g}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new xw,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=sn(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new Bk(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new Uk(i))})),t}cu(e){this.Za=e.ks,this.Ya=sn();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return ec.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Wy="SyncEngine";class K6{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class Y6{constructor(e){this.key=e,this.hu=!1}}class Q6{constructor(e,t,i,l,u,d){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=l,this.currentUser=u,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new Jo((g=>sk(g)),gf),this.Iu=new Map,this.Eu=new Set,this.Ru=new Jn(ft.comparator),this.Au=new Map,this.Vu=new Iy,this.du={},this.mu=new Map,this.fu=Zl.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function X6(s,e,t=!0){const i=Wk(s);let l;const u=i.Tu.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),l=u.view.lu()):l=await zk(i,e,t,!0),l}async function J6(s,e){const t=Wk(s);await zk(t,e,!0,!1)}async function zk(s,e,t,i){const l=await y6(s.localStore,Di(e)),u=l.targetId,d=s.sharedClientState.addLocalQueryTarget(u,t);let g;return i&&(g=await Z6(s,e,u,d==="current",l.resumeToken)),s.isPrimaryClient&&t&&Mk(s.remoteStore,l),g}async function Z6(s,e,t,i,l){s.pu=(k,E,M)=>(async function(K,B,Y,ee){let ae=B.view.ru(Y);ae.Ss&&(ae=await gw(K.localStore,B.query,!1).then((({documents:D})=>B.view.ru(D,ae))));const ye=ee&&ee.targetChanges.get(B.targetId),ve=ee&&ee.targetMismatches.get(B.targetId)!=null,he=B.view.applyChanges(ae,K.isPrimaryClient,ye,ve);return Ew(K,B.targetId,he.au),he.snapshot})(s,k,E,M);const u=await gw(s.localStore,e,!0),d=new G6(e,u.ks),g=d.ru(u.documents),y=Fu.createSynthesizedTargetChangeForCurrentChange(t,i&&s.onlineState!=="Offline",l),p=d.applyChanges(g,s.isPrimaryClient,y);Ew(s,t,p.au);const b=new K6(e,t,d);return s.Tu.set(e,b),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),p.snapshot}async function eM(s,e,t){const i=Pt(s),l=i.Tu.get(e),u=i.Iu.get(l.targetId);if(u.length>1)return i.Iu.set(l.targetId,u.filter((d=>!gf(d,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(l.targetId),i.sharedClientState.isActiveQueryTarget(l.targetId)||await Up(i.localStore,l.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(l.targetId),t&&Py(i.remoteStore,l.targetId),Fp(i,l.targetId)})).catch(oc)):(Fp(i,l.targetId),await Up(i.localStore,l.targetId,!0))}async function tM(s,e){const t=Pt(s),i=t.Tu.get(e),l=t.Iu.get(i.targetId);t.isPrimaryClient&&l.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Py(t.remoteStore,i.targetId))}async function nM(s,e,t){const i=cM(s);try{const l=await(function(d,g){const y=Pt(d),p=Bt.now(),b=g.reduce(((M,H)=>M.add(H.key)),sn());let k,E;return y.persistence.runTransaction("Locally write mutations","readwrite",(M=>{let H=xa(),K=sn();return y.xs.getEntries(M,b).next((B=>{H=B,H.forEach(((Y,ee)=>{ee.isValidDocument()||(K=K.add(Y))}))})).next((()=>y.localDocuments.getOverlayedDocuments(M,H))).next((B=>{k=B;const Y=[];for(const ee of g){const ae=pI(ee,k.get(ee.key).overlayedDocument);ae!=null&&Y.push(new go(ee.key,ae,Y_(ae.value.mapValue),ur.exists(!0)))}return y.mutationQueue.addMutationBatch(M,p,Y,g)})).next((B=>{E=B;const Y=B.applyToLocalDocumentSet(k,K);return y.documentOverlayCache.saveOverlays(M,B.batchId,Y)}))})).then((()=>({batchId:E.batchId,changes:ak(k)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(l.batchId),(function(d,g,y){let p=d.du[d.currentUser.toKey()];p||(p=new Jn(nn)),p=p.insert(g,y),d.du[d.currentUser.toKey()]=p})(i,l.batchId,t),await qu(i,l.changes),await jf(i.remoteStore)}catch(l){const u=zy(l,"Failed to persist write");t.reject(u)}}async function Fk(s,e){const t=Pt(s);try{const i=await m6(t.localStore,e);e.targetChanges.forEach(((l,u)=>{const d=t.Au.get(u);d&&(kn(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size<=1,22616),l.addedDocuments.size>0?d.hu=!0:l.modifiedDocuments.size>0?kn(d.hu,14607):l.removedDocuments.size>0&&(kn(d.hu,42227),d.hu=!1))})),await qu(t,i,e)}catch(i){await oc(i)}}function jw(s,e,t){const i=Pt(s);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const l=[];i.Tu.forEach(((u,d)=>{const g=d.view.va(e);g.snapshot&&l.push(g.snapshot)})),(function(d,g){const y=Pt(d);y.onlineState=g;let p=!1;y.queries.forEach(((b,k)=>{for(const E of k.ba)E.va(g)&&(p=!0)})),p&&qy(y)})(i.eventManager,e),l.length&&i.Pu.J_(l),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function sM(s,e,t){const i=Pt(s);i.sharedClientState.updateQueryState(e,"rejected",t);const l=i.Au.get(e),u=l&&l.key;if(u){let d=new Jn(ft.comparator);d=d.insert(u,Xs.newNoDocument(u,Dt.min()));const g=sn().add(u),y=new xf(Dt.min(),new Map,new Jn(nn),d,g);await Fk(i,y),i.Ru=i.Ru.remove(u),i.Au.delete(e),Gy(i)}else await Up(i.localStore,e,!1).then((()=>Fp(i,e,t))).catch(oc)}async function rM(s,e){const t=Pt(s),i=e.batch.batchId;try{const l=await f6(t.localStore,e);qk(t,i,null),Hk(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await qu(t,l)}catch(l){await oc(l)}}async function iM(s,e,t){const i=Pt(s);try{const l=await(function(d,g){const y=Pt(d);return y.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let b;return y.mutationQueue.lookupMutationBatch(p,g).next((k=>(kn(k!==null,37113),b=k.keys(),y.mutationQueue.removeMutationBatch(p,k)))).next((()=>y.mutationQueue.performConsistencyCheck(p))).next((()=>y.documentOverlayCache.removeOverlaysForBatchId(p,b,g))).next((()=>y.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,b))).next((()=>y.localDocuments.getDocuments(p,b)))}))})(i.localStore,e);qk(i,e,t),Hk(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await qu(i,l)}catch(l){await oc(l)}}function Hk(s,e){(s.mu.get(e)||[]).forEach((t=>{t.resolve()})),s.mu.delete(e)}function qk(s,e,t){const i=Pt(s);let l=i.du[i.currentUser.toKey()];if(l){const u=l.get(e);u&&(t?u.reject(t):u.resolve(),l=l.remove(e)),i.du[i.currentUser.toKey()]=l}}function Fp(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const i of s.Iu.get(e))s.Tu.delete(i),t&&s.Pu.yu(i,t);s.Iu.delete(e),s.isPrimaryClient&&s.Vu.Gr(e).forEach((i=>{s.Vu.containsKey(i)||$k(s,i)}))}function $k(s,e){s.Eu.delete(e.path.canonicalString());const t=s.Ru.get(e);t!==null&&(Py(s.remoteStore,t),s.Ru=s.Ru.remove(e),s.Au.delete(t),Gy(s))}function Ew(s,e,t){for(const i of t)i instanceof Uk?(s.Vu.addReference(i.key,e),aM(s,i)):i instanceof Bk?(Xe(Wy,"Document no longer in limbo: "+i.key),s.Vu.removeReference(i.key,e),s.Vu.containsKey(i.key)||$k(s,i.key)):jt(19791,{wu:i})}function aM(s,e){const t=e.key,i=t.path.canonicalString();s.Ru.get(t)||s.Eu.has(i)||(Xe(Wy,"New document in limbo: "+t),s.Eu.add(i),Gy(s))}function Gy(s){for(;s.Eu.size>0&&s.Ru.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new ft(Dn.fromString(e)),i=s.fu.next();s.Au.set(i,new Y6(t)),s.Ru=s.Ru.insert(t,i),Mk(s.remoteStore,new to(Di(mf(t.path)),i,"TargetPurposeLimboResolution",df.ce))}}async function qu(s,e,t){const i=Pt(s),l=[],u=[],d=[];i.Tu.isEmpty()||(i.Tu.forEach(((g,y)=>{d.push(i.pu(y,e,t).then((p=>{if((p||t)&&i.isPrimaryClient){const b=p?!p.fromCache:t?.targetChanges.get(y.targetId)?.current;i.sharedClientState.updateQueryState(y.targetId,b?"current":"not-current")}if(p){l.push(p);const b=Dy.Es(y.targetId,p);u.push(b)}})))})),await Promise.all(d),i.Pu.J_(l),await(async function(y,p){const b=Pt(y);try{await b.persistence.runTransaction("notifyLocalViewChanges","readwrite",(k=>Ne.forEach(p,(E=>Ne.forEach(E.Ts,(M=>b.persistence.referenceDelegate.addReference(k,E.targetId,M))).next((()=>Ne.forEach(E.Is,(M=>b.persistence.referenceDelegate.removeReference(k,E.targetId,M)))))))))}catch(k){if(!lc(k))throw k;Xe(Ly,"Failed to update sequence numbers: "+k)}for(const k of p){const E=k.targetId;if(!k.fromCache){const M=b.vs.get(E),H=M.snapshotVersion,K=M.withLastLimboFreeSnapshotVersion(H);b.vs=b.vs.insert(E,K)}}})(i.localStore,u))}async function oM(s,e){const t=Pt(s);if(!t.currentUser.isEqual(e)){Xe(Wy,"User change. New user:",e.toKey());const i=await Nk(t.localStore,e);t.currentUser=e,(function(u,d){u.mu.forEach((g=>{g.forEach((y=>{y.reject(new We(_e.CANCELLED,d))}))})),u.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await qu(t,i.Ns)}}function lM(s,e){const t=Pt(s),i=t.Au.get(e);if(i&&i.hu)return sn().add(i.key);{let l=sn();const u=t.Iu.get(e);if(!u)return l;for(const d of u){const g=t.Tu.get(d);l=l.unionWith(g.view.nu)}return l}}function Wk(s){const e=Pt(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=Fk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=lM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=sM.bind(null,e),e.Pu.J_=$6.bind(null,e.eventManager),e.Pu.yu=W6.bind(null,e.eventManager),e}function cM(s){const e=Pt(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=rM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=iM.bind(null,e),e}class Xh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=_f(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return h6(this.persistence,new c6,e.initialUser,this.serializer)}Cu(e){return new Ck(My.Vi,this.serializer)}Du(e){return new b6}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Xh.provider={build:()=>new Xh};class uM extends Xh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){kn(this.persistence.referenceDelegate instanceof Yh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new KI(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?vr.withCacheSize(this.cacheSizeBytes):vr.DEFAULT;return new Ck((i=>Yh.Vi(i,t)),this.serializer)}}class Hp{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>jw(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=oM.bind(null,this.syncEngine),await F6(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new q6})()}createDatastore(e){const t=_f(e.databaseInfo.databaseId),i=j6(e.databaseInfo);return N6(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,l,u,d,g){return new R6(i,l,u,d,g)})(this.localStore,this.datastore,e.asyncQueue,(t=>jw(this.syncEngine,t,0)),(function(){return vw.v()?new vw:new w6})())}createSyncEngine(e,t){return(function(l,u,d,g,y,p,b){const k=new Q6(l,u,d,g,y,p);return b&&(k.gu=!0),k})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=Pt(t);Xe(qo,"RemoteStore shutting down."),i.Ea.add(5),await Hu(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Hp.provider={build:()=>new Hp};class Ky{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):wa("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const ho="FirestoreClient";class dM{constructor(e,t,i,l,u){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=l,this.user=Qs.UNAUTHENTICATED,this.clientId=_y.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,(async d=>{Xe(ho,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(i,(d=>(Xe(ho,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ma;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=zy(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Gg(s,e){s.asyncQueue.verifyOperationInProgress(),Xe(ho,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let i=t.initialUser;s.setCredentialChangeListener((async l=>{i.isEqual(l)||(await Nk(e.localStore,l),i=l)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function Tw(s,e){s.asyncQueue.verifyOperationInProgress();const t=await hM(s);Xe(ho,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener((i=>ww(e.remoteStore,i))),s.setAppCheckTokenChangeListener(((i,l)=>ww(e.remoteStore,l))),s._onlineComponents=e}async function hM(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){Xe(ho,"Using user provided OfflineComponentProvider");try{await Gg(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(l){return l.name==="FirebaseError"?l.code===_e.FAILED_PRECONDITION||l.code===_e.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11})(t))throw t;Gl("Error using user provided cache. Falling back to memory cache: "+t),await Gg(s,new Xh)}}else Xe(ho,"Using default OfflineComponentProvider"),await Gg(s,new uM(void 0));return s._offlineComponents}async function Gk(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(Xe(ho,"Using user provided OnlineComponentProvider"),await Tw(s,s._uninitializedComponentsProvider._online)):(Xe(ho,"Using default OnlineComponentProvider"),await Tw(s,new Hp))),s._onlineComponents}function fM(s){return Gk(s).then((e=>e.syncEngine))}async function Jh(s){const e=await Gk(s),t=e.eventManager;return t.onListen=X6.bind(null,e.syncEngine),t.onUnlisten=eM.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=J6.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=tM.bind(null,e.syncEngine),t}function mM(s,e,t,i){const l=new Ky(i),u=new $y(e,l,t);return s.asyncQueue.enqueueAndForget((async()=>Fy(await Jh(s),u))),()=>{l.Nu(),s.asyncQueue.enqueueAndForget((async()=>Hy(await Jh(s),u)))}}function gM(s,e,t={}){const i=new ma;return s.asyncQueue.enqueueAndForget((async()=>(function(u,d,g,y,p){const b=new Ky({next:E=>{b.Nu(),d.enqueueAndForget((()=>Hy(u,k)));const M=E.docs.has(g);!M&&E.fromCache?p.reject(new We(_e.UNAVAILABLE,"Failed to get document because the client is offline.")):M&&E.fromCache&&y&&y.source==="server"?p.reject(new We(_e.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(E)},error:E=>p.reject(E)}),k=new $y(mf(g.path),b,{includeMetadataChanges:!0,Ka:!0});return Fy(u,k)})(await Jh(s),s.asyncQueue,e,t,i))),i.promise}function pM(s,e,t={}){const i=new ma;return s.asyncQueue.enqueueAndForget((async()=>(function(u,d,g,y,p){const b=new Ky({next:E=>{b.Nu(),d.enqueueAndForget((()=>Hy(u,k))),E.fromCache&&y.source==="server"?p.reject(new We(_e.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(E)},error:E=>p.reject(E)}),k=new $y(g,b,{includeMetadataChanges:!0,Ka:!0});return Fy(u,k)})(await Jh(s),s.asyncQueue,e,t,i))),i.promise}function yM(s,e){const t=new ma;return s.asyncQueue.enqueueAndForget((async()=>nM(await fM(s),e,t))),t.promise}function Kk(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}const vM="ComponentProvider",Sw=new Map;function bM(s,e,t,i,l){return new UR(s,e,t,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,Kk(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator,i)}const Yk="firestore.googleapis.com",Cw=!0;class Nw{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new We(_e.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Yk,this.ssl=Cw}else this.host=e.host,this.ssl=e.ssl??Cw;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Sk;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<WI)throw new We(_e.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}CR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Kk(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new We(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new We(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new We(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,l){return i.timeoutSeconds===l.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ef{constructor(e,t,i,l){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=l,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Nw({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new We(_e.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new We(_e.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Nw(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new vR;switch(i.type){case"firstParty":return new _R(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new We(_e.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=Sw.get(t);i&&(Xe(vM,"Removing Datastore"),Sw.delete(t),i.terminate())})(this),Promise.resolve()}}function wM(s,e,t,i={}){s=cr(s,Ef);const l=fo(e),u=s._getSettings(),d={...u,emulatorOptions:s._getEmulatorOptions()},g=`${e}:${t}`;l&&(iy(`https://${g}`),ay("Firestore",!0)),u.host!==Yk&&u.host!==g&&Gl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const y={...u,host:g,ssl:l,emulatorOptions:i};if(!pa(y,d)&&(s._setSettings(y),i.mockUserToken)){let p,b;if(typeof i.mockUserToken=="string")p=i.mockUserToken,b=Qs.MOCK_USER;else{p=Hx(i.mockUserToken,s._app?.options.projectId);const k=i.mockUserToken.sub||i.mockUserToken.user_id;if(!k)throw new We(_e.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new Qs(k)}s._authCredentials=new bR(new O_(p,b))}}class po{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new po(this.firestore,e,this._query)}}class rs{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ro(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new rs(this.firestore,e,this._key)}toJSON(){return{type:rs._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Bu(t,rs._jsonSchema))return new rs(e,i||null,new ft(Dn.fromString(t.referencePath)))}}rs._jsonSchemaVersion="firestore/documentReference/1.0",rs._jsonSchema={type:ks("string",rs._jsonSchemaVersion),referencePath:ks("string")};class ro extends po{constructor(e,t,i){super(e,t,mf(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new rs(this.firestore,null,new ft(e))}withConverter(e){return new ro(this.firestore,e,this._path)}}function ut(s,e,...t){if(s=jn(s),V_("collection","path",e),s instanceof Ef){const i=Dn.fromString(e,...t);return F2(i),new ro(s,null,i)}{if(!(s instanceof rs||s instanceof ro))throw new We(_e.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(Dn.fromString(e,...t));return F2(i),new ro(s.firestore,null,i)}}function ze(s,e,...t){if(s=jn(s),arguments.length===1&&(e=_y.newId()),V_("doc","path",e),s instanceof Ef){const i=Dn.fromString(e,...t);return z2(i),new rs(s,null,new ft(i))}{if(!(s instanceof rs||s instanceof ro))throw new We(_e.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(Dn.fromString(e,...t));return z2(i),new rs(s.firestore,s instanceof ro?s.converter:null,new ft(i))}}const Aw="AsyncQueue";class Rw{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Rk(this,"async_queue_retry"),this._c=()=>{const i=Wg();i&&Xe(Aw,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Wg();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Wg();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new ma;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!lc(e))throw e;Xe(Aw,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,wa("INTERNAL UNHANDLED ERROR: ",Iw(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const l=By.createAndSchedule(this,e,t,i,(u=>this.hc(u)));return this.tc.push(l),l}uc(){this.nc&&jt(47125,{Pc:Iw(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Iw(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}class Vi extends Ef{constructor(e,t,i,l){super(e,t,i,l),this.type="firestore",this._queue=new Rw,this._persistenceKey=l?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Rw(e),this._firestoreClient=void 0,await e}}}function xM(s,e){const t=typeof s=="object"?s:Pu(),i=typeof s=="string"?s:$h,l=Qo(t,"firestore").getImmediate({identifier:i});if(!l._initialized){const u=Bx("firestore");u&&wM(l,...u)}return l}function $u(s){if(s._terminated)throw new We(_e.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||_M(s),s._firestoreClient}function _M(s){const e=s._freezeSettings(),t=bM(s._databaseId,s._app?.options.appId||"",s._persistenceKey,s._app?.options.apiKey,e);s._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new dM(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&(function(l){const u=l?._online.build();return{_offline:l?._offline.build(u),_online:u}})(s._componentsProvider))}class Xr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Xr(Fs.fromBase64String(e))}catch(t){throw new We(_e.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Xr(Fs.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Xr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Bu(e,Xr._jsonSchema))return Xr.fromBase64String(e.bytes)}}Xr._jsonSchemaVersion="firestore/bytes/1.0",Xr._jsonSchema={type:ks("string",Xr._jsonSchemaVersion),bytes:ks("string")};class Tf{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new We(_e.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class el{constructor(e){this._methodName=e}}class Pi{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new We(_e.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new We(_e.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return nn(this._lat,e._lat)||nn(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Pi._jsonSchemaVersion}}static fromJSON(e){if(Bu(e,Pi._jsonSchema))return new Pi(e.latitude,e.longitude)}}Pi._jsonSchemaVersion="firestore/geoPoint/1.0",Pi._jsonSchema={type:ks("string",Pi._jsonSchemaVersion),latitude:ks("number"),longitude:ks("number")};class pi{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,l){if(i.length!==l.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==l[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:pi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Bu(e,pi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new pi(e.vectorValues);throw new We(_e.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}pi._jsonSchemaVersion="firestore/vectorValue/1.0",pi._jsonSchema={type:ks("string",pi._jsonSchemaVersion),vectorValues:ks("object")};const kM=/^__.*__$/;class jM{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new go(e,this.data,this.fieldMask,t,this.fieldTransforms):new zu(e,this.data,t,this.fieldTransforms)}}class Qk{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new go(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Xk(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw jt(40011,{dataSource:s})}}class Sf{constructor(e,t,i,l,u,d){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=l,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=d||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Sf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Zh(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(Xk(this.dataSource)&&kM.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class EM{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||_f(e)}createContext(e,t,i,l=!1){return new Sf({dataSource:e,methodName:t,targetDoc:i,path:zs.emptyPath(),arrayElement:!1,hasConverter:l},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Wu(s){const e=s._freezeSettings(),t=_f(s._databaseId);return new EM(s._databaseId,!!e.ignoreUndefinedProperties,t)}function Yy(s,e,t,i,l,u={}){const d=s.createContext(u.merge||u.mergeFields?2:0,e,t,l);e0("Data must be an object, but it was:",d,i);const g=tj(i,d);let y,p;if(u.merge)y=new Lr(d.fieldMask),p=d.fieldTransforms;else if(u.mergeFields){const b=[];for(const k of u.mergeFields){const E=$o(e,k,t);if(!d.contains(E))throw new We(_e.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);rj(b,E)||b.push(E)}y=new Lr(b),p=d.fieldTransforms.filter((k=>y.covers(k.field)))}else y=null,p=d.fieldTransforms;return new jM(new wr(g),y,p)}class Cf extends el{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Cf}}function Jk(s,e,t){return new Sf({dataSource:3,targetDoc:e.settings.targetDoc,methodName:s._methodName,arrayElement:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Qy extends el{_toFieldTransform(e){return new vf(e.path,new Nu)}isEqual(e){return e instanceof Qy}}class Xy extends el{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=Jk(this,e,!0),i=this.Ac.map((u=>tl(u,t))),l=new Xl(i);return new vf(e.path,l)}isEqual(e){return e instanceof Xy&&pa(this.Ac,e.Ac)}}class Jy extends el{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=Jk(this,e,!0),i=this.Ac.map((u=>tl(u,t))),l=new Jl(i);return new vf(e.path,l)}isEqual(e){return e instanceof Jy&&pa(this.Ac,e.Ac)}}class Zy extends el{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new Au(e.serializer,ck(e.serializer,this.Vc));return new vf(e.path,t)}isEqual(e){return e instanceof Zy&&this.Vc===e.Vc}}function Zk(s,e,t,i){const l=s.createContext(1,e,t);e0("Data must be an object, but it was:",l,i);const u=[],d=wr.empty();mo(i,((y,p)=>{const b=sj(e,y,t);p=jn(p);const k=l.childContextForFieldPath(b);if(p instanceof Cf)u.push(b);else{const E=tl(p,k);E!=null&&(u.push(b),d.set(b,E))}}));const g=new Lr(u);return new Qk(d,g,l.fieldTransforms)}function ej(s,e,t,i,l,u){const d=s.createContext(1,e,t),g=[$o(e,i,t)],y=[l];if(u.length%2!=0)throw new We(_e.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<u.length;E+=2)g.push($o(e,u[E])),y.push(u[E+1]);const p=[],b=wr.empty();for(let E=g.length-1;E>=0;--E)if(!rj(p,g[E])){const M=g[E];let H=y[E];H=jn(H);const K=d.childContextForFieldPath(M);if(H instanceof Cf)p.push(M);else{const B=tl(H,K);B!=null&&(p.push(M),b.set(M,B))}}const k=new Lr(p);return new Qk(b,k,d.fieldTransforms)}function TM(s,e,t,i=!1){return tl(t,s.createContext(i?4:3,e))}function tl(s,e){if(nj(s=jn(s)))return e0("Unsupported field value:",e,s),tj(s,e);if(s instanceof el)return(function(i,l){if(!Xk(l.dataSource))throw l.createError(`${i._methodName}() can only be used with update() and set()`);if(!l.path)throw l.createError(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(l);u&&l.fieldTransforms.push(u)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,l){const u=[];let d=0;for(const g of i){let y=tl(g,l.childContextForArray(d));y==null&&(y={nullValue:"NULL_VALUE"}),u.push(y),d++}return{arrayValue:{values:u}}})(s,e)}return(function(i,l){if((i=jn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return ck(l.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=Bt.fromDate(i);return{timestampValue:Kh(l.serializer,u)}}if(i instanceof Bt){const u=new Bt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Kh(l.serializer,u)}}if(i instanceof Pi)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Xr)return{bytesValue:bk(l.serializer,i._byteString)};if(i instanceof rs){const u=l.databaseId,d=i.firestore._databaseId;if(!d.isEqual(u))throw l.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:Ry(i.firestore._databaseId||l.databaseId,i._key.path)}}if(i instanceof pi)return(function(d,g){const y=d instanceof pi?d.toArray():d;return{mapValue:{fields:{[G_]:{stringValue:K_},[Wh]:{arrayValue:{values:y.map((b=>{if(typeof b!="number")throw g.createError("VectorValues must only contain numeric values.");return Cy(g.serializer,b)}))}}}}}})(i,l);if(Tk(i))return i._toProto(l.serializer);throw l.createError(`Unsupported field value: ${uf(i)}`)})(s,e)}function tj(s,e){const t={};return z_(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):mo(s,((i,l)=>{const u=tl(l,e.childContextForField(i));u!=null&&(t[i]=u)})),{mapValue:{fields:t}}}function nj(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof Bt||s instanceof Pi||s instanceof Xr||s instanceof rs||s instanceof el||s instanceof pi||Tk(s))}function e0(s,e,t){if(!nj(t)||!U_(t)){const i=uf(t);throw i==="an object"?e.createError(s+" a custom object"):e.createError(s+" "+i)}}function $o(s,e,t){if((e=jn(e))instanceof Tf)return e._internalPath;if(typeof e=="string")return sj(s,e);throw Zh("Field path arguments must be of type string or ",s,!1,void 0,t)}const SM=new RegExp("[~\\*/\\[\\]]");function sj(s,e,t){if(e.search(SM)>=0)throw Zh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new Tf(...e.split("."))._internalPath}catch{throw Zh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function Zh(s,e,t,i,l){const u=i&&!i.isEmpty(),d=l!==void 0;let g=`Function ${e}() called with invalid data`;t&&(g+=" (via `toFirestore()`)"),g+=". ";let y="";return(u||d)&&(y+=" (found",u&&(y+=` in field ${i}`),d&&(y+=` in document ${l}`),y+=")"),new We(_e.INVALID_ARGUMENT,g+s+y)}function rj(s,e){return s.some((t=>t.isEqual(e)))}class CM{convertValue(e,t="none"){switch(co(e)){case 0:return null;case 1:return e.booleanValue;case 2:return hs(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(lo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw jt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return mo(e,((l,u)=>{i[l]=this.convertValue(u,t)})),i}convertVectorValue(e){const t=e.fields?.[Wh].arrayValue?.values?.map((i=>hs(i.doubleValue)));return new pi(t)}convertGeoPoint(e){return new Pi(hs(e.latitude),hs(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=ff(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Eu(e));default:return null}}convertTimestamp(e){const t=oo(e);return new Bt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Dn.fromString(e);kn(Ek(i),9688,{name:e});const l=new Tu(i.get(1),i.get(3)),u=new ft(i.popFirst(5));return l.isEqual(t)||wa(`Document ${u} contains a document reference within a different database (${l.projectId}/${l.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}class t0 extends CM{constructor(e){super(),this.firestore=e}convertBytes(e){return new Xr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new rs(this.firestore,null,t)}}function xs(){return new Qy("serverTimestamp")}function NM(...s){return new Xy("arrayUnion",s)}function AM(...s){return new Jy("arrayRemove",s)}function mi(s){return new Zy("increment",s)}const Mw="@firebase/firestore",Dw="4.10.0";function Lw(s){return(function(t,i){if(typeof t!="object"||t===null)return!1;const l=t;for(const u of i)if(u in l&&typeof l[u]=="function")return!0;return!1})(s,["next","error","complete"])}class ij{constructor(e,t,i,l,u){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=l,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new rs(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new RM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field($o("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class RM extends ij{data(){return super.data()}}function aj(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new We(_e.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class n0{}class oj extends n0{}function tn(s,e,...t){let i=[];e instanceof n0&&i.push(e),i=i.concat(t),(function(u){const d=u.filter((y=>y instanceof s0)).length,g=u.filter((y=>y instanceof Nf)).length;if(d>1||d>0&&g>0)throw new We(_e.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const l of i)s=l._apply(s);return s}class Nf extends oj{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Nf(e,t,i)}_apply(e){const t=this._parse(e);return lj(e._query,t),new po(e.firestore,e.converter,Mp(e._query,t))}_parse(e){const t=Wu(e.firestore);return(function(u,d,g,y,p,b,k){let E;if(p.isKeyField()){if(b==="array-contains"||b==="array-contains-any")throw new We(_e.INVALID_ARGUMENT,`Invalid Query. You can't perform '${b}' queries on documentId().`);if(b==="in"||b==="not-in"){Ow(k,b);const H=[];for(const K of k)H.push(Pw(y,u,K));E={arrayValue:{values:H}}}else E=Pw(y,u,k)}else b!=="in"&&b!=="not-in"&&b!=="array-contains-any"||Ow(k,b),E=TM(g,d,k,b==="in"||b==="not-in");return ws.create(p,b,E)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Ot(s,e,t){const i=e,l=$o("where",s);return Nf._create(l,i,t)}class s0 extends n0{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new s0(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:vi.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(l,u){let d=l;const g=u.getFlattenedFilters();for(const y of g)lj(d,y),d=Mp(d,y)})(e._query,t),new po(e.firestore,e.converter,Mp(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class r0 extends oj{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new r0(e,t)}_apply(e){const t=(function(l,u,d){if(l.startAt!==null)throw new We(_e.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(l.endAt!==null)throw new We(_e.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Cu(u,d)})(e._query,this._field,this._direction);return new po(e.firestore,e.converter,sI(e._query,t))}}function UP(s,e="asc"){const t=e,i=$o("orderBy",s);return r0._create(i,t)}function Pw(s,e,t){if(typeof(t=jn(t))=="string"){if(t==="")throw new We(_e.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!nk(e)&&t.indexOf("/")!==-1)throw new We(_e.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Dn.fromString(t));if(!ft.isDocumentKey(i))throw new We(_e.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Q2(s,new ft(i))}if(t instanceof rs)return Q2(s,t._key);throw new We(_e.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${uf(t)}.`)}function Ow(s,e){if(!Array.isArray(s)||s.length===0)throw new We(_e.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function lj(s,e){const t=(function(l,u){for(const d of l)for(const g of d.getFlattenedFilters())if(u.indexOf(g.op)>=0)return g.op;return null})(s.filters,(function(l){switch(l){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new We(_e.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new We(_e.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function i0(s,e,t){let i;return i=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,i}class uu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Uo extends ij{constructor(e,t,i,l,u,d){super(e,t,i,l,d),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Mh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field($o("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new We(_e.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Uo._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Uo._jsonSchemaVersion="firestore/documentSnapshot/1.0",Uo._jsonSchema={type:ks("string",Uo._jsonSchemaVersion),bundleSource:ks("string","DocumentSnapshot"),bundleName:ks("string"),bundle:ks("string")};class Mh extends Uo{data(e={}){return super.data(e)}}class Bo{constructor(e,t,i,l){this._firestore=e,this._userDataWriter=t,this._snapshot=l,this.metadata=new uu(l.hasPendingWrites,l.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Mh(this._firestore,this._userDataWriter,i.key,i,new uu(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new We(_e.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(l,u){if(l._snapshot.oldDocs.isEmpty()){let d=0;return l._snapshot.docChanges.map((g=>{const y=new Mh(l._firestore,l._userDataWriter,g.doc.key,g.doc,new uu(l._snapshot.mutatedKeys.has(g.doc.key),l._snapshot.fromCache),l.query.converter);return g.doc,{type:"added",doc:y,oldIndex:-1,newIndex:d++}}))}{let d=l._snapshot.oldDocs;return l._snapshot.docChanges.filter((g=>u||g.type!==3)).map((g=>{const y=new Mh(l._firestore,l._userDataWriter,g.doc.key,g.doc,new uu(l._snapshot.mutatedKeys.has(g.doc.key),l._snapshot.fromCache),l.query.converter);let p=-1,b=-1;return g.type!==0&&(p=d.indexOf(g.doc.key),d=d.delete(g.doc.key)),g.type!==1&&(d=d.add(g.doc),b=d.indexOf(g.doc.key)),{type:IM(g.type),doc:y,oldIndex:p,newIndex:b}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new We(_e.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Bo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=_y.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],l=[];return this.docs.forEach((u=>{u._document!==null&&(t.push(u._document),i.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),l.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function IM(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return jt(61501,{type:s})}}Bo._jsonSchemaVersion="firestore/querySnapshot/1.0",Bo._jsonSchema={type:ks("string",Bo._jsonSchemaVersion),bundleSource:ks("string","QuerySnapshot"),bundleName:ks("string"),bundle:ks("string")};class MM{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Wu(e)}set(e,t,i){this._verifyNotCommitted();const l=Kg(e,this._firestore),u=i0(l.converter,t,i),d=Yy(this._dataReader,"WriteBatch.set",l._key,u,l.converter!==null,i);return this._mutations.push(d.toMutation(l._key,ur.none())),this}update(e,t,i,...l){this._verifyNotCommitted();const u=Kg(e,this._firestore);let d;return d=typeof(t=jn(t))=="string"||t instanceof Tf?ej(this._dataReader,"WriteBatch.update",u._key,t,i,l):Zk(this._dataReader,"WriteBatch.update",u._key,t),this._mutations.push(d.toMutation(u._key,ur.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Kg(e,this._firestore);return this._mutations=this._mutations.concat(new wf(t._key,ur.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new We(_e.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Kg(s,e){if((s=jn(s)).firestore!==e)throw new We(_e.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}function _s(s){s=cr(s,rs);const e=cr(s.firestore,Vi),t=$u(e);return gM(t,s._key).then((i=>uj(e,s,i)))}function $t(s){s=cr(s,po);const e=cr(s.firestore,Vi),t=$u(e),i=new t0(e);return aj(s._query),pM(t,s._query).then((l=>new Bo(e,i,s,l)))}function Wn(s,e,t){s=cr(s,rs);const i=cr(s.firestore,Vi),l=i0(s.converter,e,t),u=Wu(i);return Gu(i,[Yy(u,"setDoc",s._key,l,s.converter!==null,t).toMutation(s._key,ur.none())])}function zn(s,e,t,...i){s=cr(s,rs);const l=cr(s.firestore,Vi),u=Wu(l);let d;return d=typeof(e=jn(e))=="string"||e instanceof Tf?ej(u,"updateDoc",s._key,e,t,i):Zk(u,"updateDoc",s._key,e),Gu(l,[d.toMutation(s._key,ur.exists(!0))])}function ar(s){return Gu(cr(s.firestore,Vi),[new wf(s._key,ur.none())])}function or(s,e){const t=cr(s.firestore,Vi),i=ze(s),l=i0(s.converter,e),u=Wu(s.firestore);return Gu(t,[Yy(u,"addDoc",i._key,l,s.converter!==null,{}).toMutation(i._key,ur.exists(!1))]).then((()=>i))}function cj(s,...e){s=jn(s);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||Lw(e[i])||(t=e[i++]);const l={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Lw(e[i])){const p=e[i];e[i]=p.next?.bind(p),e[i+1]=p.error?.bind(p),e[i+2]=p.complete?.bind(p)}let u,d,g;if(s instanceof rs)d=cr(s.firestore,Vi),g=mf(s._key.path),u={next:p=>{e[i]&&e[i](uj(d,s,p))},error:e[i+1],complete:e[i+2]};else{const p=cr(s,po);d=cr(p.firestore,Vi),g=p._query;const b=new t0(d);u={next:k=>{e[i]&&e[i](new Bo(d,b,p,k))},error:e[i+1],complete:e[i+2]},aj(s._query)}const y=$u(d);return mM(y,g,l,u)}function Gu(s,e){const t=$u(s);return yM(t,e)}function uj(s,e,t){const i=t.docs.get(e._key),l=new t0(s);return new Uo(s,l,e._key,i,new uu(t.hasPendingWrites,t.fromCache),e.converter)}function Vw(s){return s=cr(s,Vi),$u(s),new MM(s,(e=>Gu(s,e)))}(function(e,t=!0){yR(Xo),yi(new ei("firestore",((i,{instanceIdentifier:l,options:u})=>{const d=i.getProvider("app").getImmediate(),g=new Vi(new wR(i.getProvider("auth-internal")),new kR(d,i.getProvider("app-check-internal")),BR(d,l),d);return u={useFetchStreams:t,...u},g._setSettings(u),g}),"PUBLIC").setMultipleInstances(!0)),xr(Mw,Dw,e),xr(Mw,Dw,"esm2020")})();var DM="firebase",LM="12.8.0";xr(DM,LM,"app");const dj="firebasestorage.googleapis.com",hj="storageBucket",PM=120*1e3,OM=600*1e3;class as extends wi{constructor(e,t,i=0){super(Yg(e),`Firebase Storage: ${t} (${Yg(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,as.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Yg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var is;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(is||(is={}));function Yg(s){return"storage/"+s}function a0(){const s="An unknown error occurred, please check the error payload for server response.";return new as(is.UNKNOWN,s)}function VM(s){return new as(is.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")}function UM(s){return new as(is.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function BM(){const s="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new as(is.UNAUTHENTICATED,s)}function zM(){return new as(is.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function FM(s){return new as(is.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")}function HM(){return new as(is.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function qM(){return new as(is.CANCELED,"User canceled the upload/download.")}function $M(s){return new as(is.INVALID_URL,"Invalid URL '"+s+"'.")}function WM(s){return new as(is.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function GM(){return new as(is.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+hj+"' property when initializing the app?")}function KM(){return new as(is.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function YM(){return new as(is.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function QM(s){return new as(is.UNSUPPORTED_ENVIRONMENT,`${s} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function qp(s){return new as(is.INVALID_ARGUMENT,s)}function fj(){return new as(is.APP_DELETED,"The Firebase app was deleted.")}function XM(s){return new as(is.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function vu(s,e){return new as(is.INVALID_FORMAT,"String does not match format '"+s+"': "+e)}function Zc(s){throw new as(is.INTERNAL_ERROR,"Internal error: "+s)}class lr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=lr.makeFromUrl(e,t)}catch{return new lr(e,"")}if(i.path==="")return i;throw WM(e)}static makeFromUrl(e,t){let i=null;const l="([A-Za-z0-9.\\-_]+)";function u(ye){ye.path.charAt(ye.path.length-1)==="/"&&(ye.path_=ye.path_.slice(0,-1))}const d="(/(.*))?$",g=new RegExp("^gs://"+l+d,"i"),y={bucket:1,path:3};function p(ye){ye.path_=decodeURIComponent(ye.path)}const b="v[A-Za-z0-9_]+",k=t.replace(/[.]/g,"\\."),E="(/([^?#]*).*)?$",M=new RegExp(`^https?://${k}/${b}/b/${l}/o${E}`,"i"),H={bucket:1,path:3},K=t===dj?"(?:storage.googleapis.com|storage.cloud.google.com)":t,B="([^?#]*)",Y=new RegExp(`^https?://${K}/${l}/${B}`,"i"),ae=[{regex:g,indices:y,postModify:u},{regex:M,indices:H,postModify:p},{regex:Y,indices:{bucket:1,path:2},postModify:p}];for(let ye=0;ye<ae.length;ye++){const ve=ae[ye],he=ve.regex.exec(e);if(he){const D=he[ve.indices.bucket];let T=he[ve.indices.path];T||(T=""),i=new lr(D,T),ve.postModify(i);break}}if(i==null)throw $M(e);return i}}class JM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function ZM(s,e,t){let i=1,l=null,u=null,d=!1,g=0;function y(){return g===2}let p=!1;function b(...B){p||(p=!0,e.apply(null,B))}function k(B){l=setTimeout(()=>{l=null,s(M,y())},B)}function E(){u&&clearTimeout(u)}function M(B,...Y){if(p){E();return}if(B){E(),b.call(null,B,...Y);return}if(y()||d){E(),b.call(null,B,...Y);return}i<64&&(i*=2);let ae;g===1?(g=2,ae=0):ae=(i+Math.random())*1e3,k(ae)}let H=!1;function K(B){H||(H=!0,E(),!p&&(l!==null?(B||(g=2),clearTimeout(l),k(0)):B||(g=1)))}return k(0),u=setTimeout(()=>{d=!0,K(!0)},t),K}function eD(s){s(!1)}function tD(s){return s!==void 0}function nD(s){return typeof s=="object"&&!Array.isArray(s)}function o0(s){return typeof s=="string"||s instanceof String}function Uw(s){return l0()&&s instanceof Blob}function l0(){return typeof Blob<"u"}function $p(s,e,t,i){if(i<e)throw qp(`Invalid value for '${s}'. Expected ${e} or greater.`);if(i>t)throw qp(`Invalid value for '${s}'. Expected ${t} or less.`)}function Af(s,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${s}`}function mj(s){const e=encodeURIComponent;let t="?";for(const i in s)if(s.hasOwnProperty(i)){const l=e(i)+"="+e(s[i]);t=t+l+"&"}return t=t.slice(0,-1),t}var zo;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(zo||(zo={}));function sD(s,e){const t=s>=500&&s<600,l=[408,429].indexOf(s)!==-1,u=e.indexOf(s)!==-1;return t||l||u}class rD{constructor(e,t,i,l,u,d,g,y,p,b,k,E=!0,M=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=l,this.successCodes_=u,this.additionalRetryCodes_=d,this.callback_=g,this.errorCallback_=y,this.timeout_=p,this.progressCallback_=b,this.connectionFactory_=k,this.retry=E,this.isUsingEmulator=M,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((H,K)=>{this.resolve_=H,this.reject_=K,this.start_()})}start_(){const e=(i,l)=>{if(l){i(!1,new gh(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const d=g=>{const y=g.loaded,p=g.lengthComputable?g.total:-1;this.progressCallback_!==null&&this.progressCallback_(y,p)};this.progressCallback_!==null&&u.addUploadProgressListener(d),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(d),this.pendingConnection_=null;const g=u.getErrorCode()===zo.NO_ERROR,y=u.getStatus();if(!g||sD(y,this.additionalRetryCodes_)&&this.retry){const b=u.getErrorCode()===zo.ABORT;i(!1,new gh(!1,null,b));return}const p=this.successCodes_.indexOf(y)!==-1;i(!0,new gh(p,u))})},t=(i,l)=>{const u=this.resolve_,d=this.reject_,g=l.connection;if(l.wasSuccessCode)try{const y=this.callback_(g,g.getResponse());tD(y)?u(y):u()}catch(y){d(y)}else if(g!==null){const y=a0();y.serverResponse=g.getErrorText(),this.errorCallback_?d(this.errorCallback_(g,y)):d(y)}else if(l.canceled){const y=this.appDelete_?fj():qM();d(y)}else{const y=HM();d(y)}};this.canceled_?t(!1,new gh(!1,null,!0)):this.backoffId_=ZM(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&eD(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class gh{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function iD(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function aD(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function oD(s,e){e&&(s["X-Firebase-GMPID"]=e)}function lD(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function cD(s,e,t,i,l,u,d=!0,g=!1){const y=mj(s.urlParams),p=s.url+y,b=Object.assign({},s.headers);return oD(b,e),iD(b,t),aD(b,u),lD(b,i),new rD(p,s.method,b,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,l,d,g)}function uD(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function dD(...s){const e=uD();if(e!==void 0){const t=new e;for(let i=0;i<s.length;i++)t.append(s[i]);return t.getBlob()}else{if(l0())return new Blob(s);throw new as(is.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function hD(s,e,t){return s.webkitSlice?s.webkitSlice(e,t):s.mozSlice?s.mozSlice(e,t):s.slice?s.slice(e,t):null}function fD(s){if(typeof atob>"u")throw QM("base-64");return atob(s)}const Ii={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Qg{constructor(e,t){this.data=e,this.contentType=t||null}}function mD(s,e){switch(s){case Ii.RAW:return new Qg(gj(e));case Ii.BASE64:case Ii.BASE64URL:return new Qg(pj(s,e));case Ii.DATA_URL:return new Qg(pD(e),yD(e))}throw a0()}function gj(s){const e=[];for(let t=0;t<s.length;t++){let i=s.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<s.length-1&&(s.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const u=i,d=s.charCodeAt(++t);i=65536|(u&1023)<<10|d&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function gD(s){let e;try{e=decodeURIComponent(s)}catch{throw vu(Ii.DATA_URL,"Malformed data URL.")}return gj(e)}function pj(s,e){switch(s){case Ii.BASE64:{const l=e.indexOf("-")!==-1,u=e.indexOf("_")!==-1;if(l||u)throw vu(s,"Invalid character '"+(l?"-":"_")+"' found: is it base64url encoded?");break}case Ii.BASE64URL:{const l=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(l||u)throw vu(s,"Invalid character '"+(l?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=fD(e)}catch(l){throw l.message.includes("polyfill")?l:vu(s,"Invalid character found")}const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i}class yj{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw vu(Ii.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=vD(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function pD(s){const e=new yj(s);return e.base64?pj(Ii.BASE64,e.rest):gD(e.rest)}function yD(s){return new yj(s).contentType}function vD(s,e){return s.length>=e.length?s.substring(s.length-e.length)===e:!1}class eo{constructor(e,t){let i=0,l="";Uw(e)?(this.data_=e,i=e.size,l=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=l}size(){return this.size_}type(){return this.type_}slice(e,t){if(Uw(this.data_)){const i=this.data_,l=hD(i,e,t);return l===null?null:new eo(l)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new eo(i,!0)}}static getBlob(...e){if(l0()){const t=e.map(i=>i instanceof eo?i.data_:i);return new eo(dD.apply(null,t))}else{const t=e.map(d=>o0(d)?mD(Ii.RAW,d).data:d.data_);let i=0;t.forEach(d=>{i+=d.byteLength});const l=new Uint8Array(i);let u=0;return t.forEach(d=>{for(let g=0;g<d.length;g++)l[u++]=d[g]}),new eo(l,!0)}}uploadData(){return this.data_}}function c0(s){let e;try{e=JSON.parse(s)}catch{return null}return nD(e)?e:null}function bD(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function wD(s,e){const t=e.split("/").filter(i=>i.length>0).join("/");return s.length===0?t:s+"/"+t}function vj(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}function xD(s,e){return e}class ir{constructor(e,t,i,l){this.server=e,this.local=t||e,this.writable=!!i,this.xform=l||xD}}let ph=null;function _D(s){return!o0(s)||s.length<2?s:vj(s)}function bj(){if(ph)return ph;const s=[];s.push(new ir("bucket")),s.push(new ir("generation")),s.push(new ir("metageneration")),s.push(new ir("name","fullPath",!0));function e(u,d){return _D(d)}const t=new ir("name");t.xform=e,s.push(t);function i(u,d){return d!==void 0?Number(d):d}const l=new ir("size");return l.xform=i,s.push(l),s.push(new ir("timeCreated")),s.push(new ir("updated")),s.push(new ir("md5Hash",null,!0)),s.push(new ir("cacheControl",null,!0)),s.push(new ir("contentDisposition",null,!0)),s.push(new ir("contentEncoding",null,!0)),s.push(new ir("contentLanguage",null,!0)),s.push(new ir("contentType",null,!0)),s.push(new ir("metadata","customMetadata",!0)),ph=s,ph}function kD(s,e){function t(){const i=s.bucket,l=s.fullPath,u=new lr(i,l);return e._makeStorageReference(u)}Object.defineProperty(s,"ref",{get:t})}function jD(s,e,t){const i={};i.type="file";const l=t.length;for(let u=0;u<l;u++){const d=t[u];i[d.local]=d.xform(i,e[d.server])}return kD(i,s),i}function wj(s,e,t){const i=c0(e);return i===null?null:jD(s,i,t)}function ED(s,e,t,i){const l=c0(e);if(l===null||!o0(l.downloadTokens))return null;const u=l.downloadTokens;if(u.length===0)return null;const d=encodeURIComponent;return u.split(",").map(p=>{const b=s.bucket,k=s.fullPath,E="/b/"+d(b)+"/o/"+d(k),M=Af(E,t,i),H=mj({alt:"media",token:p});return M+H})[0]}function TD(s,e){const t={},i=e.length;for(let l=0;l<i;l++){const u=e[l];u.writable&&(t[u.server]=s[u.local])}return JSON.stringify(t)}const Bw="prefixes",zw="items";function SD(s,e,t){const i={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[Bw])for(const l of t[Bw]){const u=l.replace(/\/$/,""),d=s._makeStorageReference(new lr(e,u));i.prefixes.push(d)}if(t[zw])for(const l of t[zw]){const u=s._makeStorageReference(new lr(e,l.name));i.items.push(u)}return i}function CD(s,e,t){const i=c0(t);return i===null?null:SD(s,e,i)}class u0{constructor(e,t,i,l){this.url=e,this.method=t,this.handler=i,this.timeout=l,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function d0(s){if(!s)throw a0()}function ND(s,e){function t(i,l){const u=wj(s,l,e);return d0(u!==null),u}return t}function AD(s,e){function t(i,l){const u=CD(s,e,l);return d0(u!==null),u}return t}function RD(s,e){function t(i,l){const u=wj(s,l,e);return d0(u!==null),ED(u,l,s.host,s._protocol)}return t}function h0(s){function e(t,i){let l;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?l=zM():l=BM():t.getStatus()===402?l=UM(s.bucket):t.getStatus()===403?l=FM(s.path):l=i,l.status=t.getStatus(),l.serverResponse=i.serverResponse,l}return e}function ID(s){const e=h0(s);function t(i,l){let u=e(i,l);return i.getStatus()===404&&(u=VM(s.path)),u.serverResponse=l.serverResponse,u}return t}function MD(s,e,t,i,l){const u={};e.isRoot?u.prefix="":u.prefix=e.path+"/",t.length>0&&(u.delimiter=t),i&&(u.pageToken=i),l&&(u.maxResults=l);const d=e.bucketOnlyServerUrl(),g=Af(d,s.host,s._protocol),y="GET",p=s.maxOperationRetryTime,b=new u0(g,y,AD(s,e.bucket),p);return b.urlParams=u,b.errorHandler=h0(e),b}function DD(s,e,t){const i=e.fullServerUrl(),l=Af(i,s.host,s._protocol),u="GET",d=s.maxOperationRetryTime,g=new u0(l,u,RD(s,t),d);return g.errorHandler=ID(e),g}function LD(s,e){return s&&s.contentType||e&&e.type()||"application/octet-stream"}function PD(s,e,t){const i=Object.assign({},t);return i.fullPath=s.path,i.size=e.size(),i.contentType||(i.contentType=LD(null,e)),i}function OD(s,e,t,i,l){const u=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function g(){let ae="";for(let ye=0;ye<2;ye++)ae=ae+Math.random().toString().slice(2);return ae}const y=g();d["Content-Type"]="multipart/related; boundary="+y;const p=PD(e,i,l),b=TD(p,t),k="--"+y+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+b+`\r
--`+y+`\r
Content-Type: `+p.contentType+`\r
\r
`,E=`\r
--`+y+"--",M=eo.getBlob(k,i,E);if(M===null)throw KM();const H={name:p.fullPath},K=Af(u,s.host,s._protocol),B="POST",Y=s.maxUploadRetryTime,ee=new u0(K,B,ND(s,t),Y);return ee.urlParams=H,ee.headers=d,ee.body=M.uploadData(),ee.errorHandler=h0(e),ee}class VD{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=zo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=zo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=zo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,l,u){if(this.sent_)throw Zc("cannot .send() more than once");if(fo(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),u!==void 0)for(const d in u)u.hasOwnProperty(d)&&this.xhr_.setRequestHeader(d,u[d].toString());return l!==void 0?this.xhr_.send(l):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Zc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Zc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Zc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Zc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class UD extends VD{initXhr(){this.xhr_.responseType="text"}}function f0(){return new UD}class Wo{constructor(e,t){this._service=e,t instanceof lr?this._location=t:this._location=lr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Wo(e,t)}get root(){const e=new lr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return vj(this._location.path)}get storage(){return this._service}get parent(){const e=bD(this._location.path);if(e===null)return null;const t=new lr(this._location.bucket,e);return new Wo(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw XM(e)}}function BD(s,e,t){s._throwIfRoot("uploadBytes");const i=OD(s.storage,s._location,bj(),new eo(e,!0),t);return s.storage.makeRequestWithTokens(i,f0).then(l=>({metadata:l,ref:s}))}function zD(s){const e={prefixes:[],items:[]};return xj(s,e).then(()=>e)}async function xj(s,e,t){const l=await FD(s,{pageToken:t});e.prefixes.push(...l.prefixes),e.items.push(...l.items),l.nextPageToken!=null&&await xj(s,e,l.nextPageToken)}function FD(s,e){e!=null&&typeof e.maxResults=="number"&&$p("options.maxResults",1,1e3,e.maxResults);const t=e||{},i=MD(s.storage,s._location,"/",t.pageToken,t.maxResults);return s.storage.makeRequestWithTokens(i,f0)}function HD(s){s._throwIfRoot("getDownloadURL");const e=DD(s.storage,s._location,bj());return s.storage.makeRequestWithTokens(e,f0).then(t=>{if(t===null)throw YM();return t})}function qD(s,e){const t=wD(s._location.path,e),i=new lr(s._location.bucket,t);return new Wo(s.storage,i)}function $D(s){return/^[A-Za-z]+:\/\//.test(s)}function WD(s,e){return new Wo(s,e)}function _j(s,e){if(s instanceof m0){const t=s;if(t._bucket==null)throw GM();const i=new Wo(t,t._bucket);return e!=null?_j(i,e):i}else return e!==void 0?qD(s,e):s}function GD(s,e){if(e&&$D(e)){if(s instanceof m0)return WD(s,e);throw qp("To use ref(service, url), the first argument must be a Storage instance.")}else return _j(s,e)}function Fw(s,e){const t=e?.[hj];return t==null?null:lr.makeFromBucketSpec(t,s)}function KD(s,e,t,i={}){s.host=`${e}:${t}`;const l=fo(e);l&&(iy(`https://${s.host}/b`),ay("Storage",!0)),s._isUsingEmulator=!0,s._protocol=l?"https":"http";const{mockUserToken:u}=i;u&&(s._overrideAuthToken=typeof u=="string"?u:Hx(u,s.app.options.projectId))}class m0{constructor(e,t,i,l,u,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=l,this._firebaseVersion=u,this._isUsingEmulator=d,this._bucket=null,this._host=dj,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=PM,this._maxUploadRetryTime=OM,this._requests=new Set,l!=null?this._bucket=lr.makeFromBucketSpec(l,this._host):this._bucket=Fw(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=lr.makeFromBucketSpec(this._url,e):this._bucket=Fw(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){$p("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){$p("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(br(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Wo(this,e)}_makeRequest(e,t,i,l,u=!0){if(this._deleted)return new JM(fj());{const d=cD(e,this._appId,i,l,t,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[i,l]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,l).getPromise()}}const Hw="@firebase/storage",qw="0.14.0";const kj="storage";function bu(s,e,t){return s=jn(s),BD(s,e,t)}function $w(s){return s=jn(s),zD(s)}function io(s){return s=jn(s),HD(s)}function ca(s,e){return s=jn(s),GD(s,e)}function YD(s=Pu(),e){s=jn(s);const i=Qo(s,kj).getImmediate({identifier:e}),l=Bx("storage");return l&&QD(i,...l),i}function QD(s,e,t,i={}){KD(s,e,t,i)}function XD(s,{instanceIdentifier:e}){const t=s.getProvider("app").getImmediate(),i=s.getProvider("auth-internal"),l=s.getProvider("app-check-internal");return new m0(t,i,l,e,Xo)}function JD(){yi(new ei(kj,XD,"PUBLIC").setMultipleInstances(!0)),xr(Hw,qw,""),xr(Hw,qw,"esm2020")}JD();const jj={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},g0=cy(jj),hi=N_(g0),pe=xM(g0),ua=YD(g0),ZD=new aa,p0=new fu("apple.com");p0.addScope("email");p0.addScope("name");const e3=cy(jj,"secondary"),BP=N_(e3),t3="EYdciKDOi3UYBLk1u8hHams5tmO2",Ej=w.createContext();function _r(){return w.useContext(Ej)}function n3({children:s}){const[e,t]=w.useState(null),[i,l]=w.useState(!1),[u,d]=w.useState(!1),[g,y]=w.useState(null),[p,b]=w.useState(!0);w.useEffect(()=>{let ye=null;const ve=a4(hi,he=>{if(t(he),ye&&(ye(),ye=null),he)if(he.uid===t3)l(!0),d(!1),y(null),b(!1);else{l(!1);const D=tn(ut(pe,"clients"),Ot("uid","==",he.uid)),T=async()=>{const I=localStorage.getItem("mcf_clientId");if(I)try{const U=await _s(ze(pe,"clients",I));U.exists()&&(d(!0),y({id:U.id,...U.data()}))}catch(U){console.error("Direct client read failed:",U)}};ye=cj(D,async I=>{if(I.empty)await T();else{const U=I.docs[0];d(!0),y({id:U.id,...U.data()});try{localStorage.setItem("mcf_clientId",U.id)}catch{}}b(!1)},async I=>{console.error("Error listening to client data:",I),await T(),b(!1)})}else l(!1),d(!1),y(null),b(!1)});return()=>{ve(),ye&&ye()}},[]);const ae={currentUser:e,isAdmin:i,isClient:u,clientData:g,updateClientData:ye=>{y(ve=>ve?{...ve,...ye}:ye)},resolveClient:async()=>{if(g)return g;const ye=localStorage.getItem("mcf_clientId");if(ye)try{const ve=await _s(ze(pe,"clients",ye));if(ve.exists()){const he={id:ve.id,...ve.data()};return d(!0),y(he),he}}catch(ve){console.error("resolveClient direct read failed:",ve)}if(e){const ve=tn(ut(pe,"clients"),Ot("uid","==",e.uid)),he=await $t(ve);if(!he.empty){const D={id:he.docs[0].id,...he.docs[0].data()};return d(!0),y(D),D}}return null},login:async(ye,ve,he=!0)=>(await ch(hi,he?au:vy),await s4(hi,ye,ve)),loginWithGoogle:async()=>{await ch(hi,au);const ye=await A2(hi,ZD),ve=ye.user,he=tn(ut(pe,"clients"),Ot("uid","==",ve.uid));if((await $t(he)).empty){const T=ze(ut(pe,"clients")),I={uid:ve.uid,name:ve.displayName||"",email:ve.email.toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"google",createdAt:Bt.now()};await Wn(T,I),d(!0),y({id:T.id,...I});try{localStorage.setItem("mcf_clientId",T.id)}catch{}}return ye},loginWithApple:async()=>{await ch(hi,au);const ye=await A2(hi,p0),ve=ye.user,he=tn(ut(pe,"clients"),Ot("uid","==",ve.uid));if((await $t(he)).empty){const T=ze(ut(pe,"clients")),I={uid:ve.uid,name:ve.displayName||"",email:(ve.email||"").toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"apple",createdAt:Bt.now()};await Wn(T,I),d(!0),y({id:T.id,...I});try{localStorage.setItem("mcf_clientId",T.id)}catch{}}return ye},signup:async(ye,ve,he)=>{await ch(hi,au);const D=await n4(hi,ve.trim().toLowerCase(),he),T=D.user,I=ze(ut(pe,"clients")),U={uid:T.uid,name:ye.trim(),email:ve.trim().toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"self_signup",createdAt:Bt.now()};await Wn(I,U),d(!0),y({id:I.id,...U});try{localStorage.setItem("mcf_clientId",I.id)}catch{}return D},logout:()=>{try{localStorage.removeItem("mcf_clientId")}catch{}return o4(hi)},resetPassword:ye=>t4(hi,ye),loading:p};return a.jsx(Ej.Provider,{value:ae,children:s})}const Tj=w.createContext();function Bi(){return w.useContext(Tj)}function s3({children:s}){const[e,t]=w.useState(()=>{const k=localStorage.getItem("theme");return k?k==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),[i,l]=w.useState(()=>localStorage.getItem("accent")||"red"),[u,d]=w.useState(()=>localStorage.getItem("mono")==="true");w.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light")},[e]),w.useEffect(()=>{document.documentElement.setAttribute("data-accent",i),localStorage.setItem("accent",i)},[i]),w.useEffect(()=>{document.documentElement.setAttribute("data-mono",u?"true":"false"),localStorage.setItem("mono",u?"true":"false")},[u]);const b={isDark:e,toggleTheme:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),t(!e),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)},accent:i,setAccent:k=>l(k),isMono:u,toggleMono:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),d(!u),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)}};return a.jsx(Tj.Provider,{value:b,children:s})}const Sj=w.createContext();function dc(){return w.useContext(Sj)}const r3=["nutrition","buddies"],i3=[5,10],a3=2,o3=1;function l3({children:s}){const{clientData:e,loading:t}=_r(),i=w.useMemo(()=>{const l=e?.tier||"free",u=e?.subscriptionStatus||null,g=e&&!["self_signup","google","apple"].includes(e.signupSource),y=l==="premium"||!!g;function p(b){return y?!0:!r3.includes(b)}return{tier:l,subscriptionStatus:u,isPremium:y,canAccess:p,loading:t,FREE_RANDOMISER_DURATIONS:i3,FREE_RANDOMISER_WEEKLY_LIMIT:a3,FREE_HABIT_LIMIT:o3}},[e?.tier,e?.subscriptionStatus,e?.signupSource,t]);return a.jsx(Sj.Provider,{value:i,children:s})}function Cj(s){if(["self_signup","google","apple"].includes(s?.signupSource)&&!s?.onboardingComplete)return"/onboarding";const e=s?.clientType;return e==="core_buddy"?"/client/core-buddy":e==="circuit_vip"||e==="circuit_dropin"?"/client/circuit":"/client"}function Nj({className:s=""}){const{isDark:e,toggleTheme:t}=Bi();return a.jsx("button",{className:s||"theme-toggle",onClick:t,"aria-label":e?"Switch to light mode":"Switch to dark mode",children:e?a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})})}const c3={admin:"Admin Login",block:"1-2-1 Client Login",circuit:"Circuit Login",core_buddy:"Core Buddy Login"};function u3(){const[s,e]=w.useState(""),[t,i]=w.useState(""),[l,u]=w.useState(!0),[d,g]=w.useState(""),[y,p]=w.useState(!1),[b,k]=w.useState(!1),[E,M]=w.useState(!1),[H,K]=w.useState(!1),[B,Y]=w.useState(!1),{login:ee,loginWithGoogle:ae,loginWithApple:ye,resetPassword:ve,currentUser:he,isAdmin:D,isClient:T,clientData:I,loading:U}=_r(),L=Hs(),[P]=pC(),A=P.get("type")||"",Le=c3[A]||"Sign In",Ze=!A||A==="core_buddy";if(w.useEffect(()=>{if(!U&&he){if(!he.emailVerified&&I?.signupSource==="self_signup"){L("/signup");return}D?L("/dashboard"):T?L(Cj(I)):(p(!1),g("No account found. Please sign up or contact your trainer."))}},[U,he,D,T,I,L]),U||he)return a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",background:"var(--bg-body)"},children:a.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})});const J=async Pe=>{Pe.preventDefault(),g(""),p(!0);try{await ee(s,t,l)}catch(V){g(V.message||"Failed to log in"),p(!1)}},Te=async()=>{g(""),K(!0);try{await ae()}catch(Pe){Pe.code!=="auth/popup-closed-by-user"&&g(Pe.message||"Failed to sign in with Google"),K(!1)}},He=async()=>{g(""),Y(!0);try{await ye()}catch(Pe){Pe.code!=="auth/popup-closed-by-user"&&g(Pe.message||"Failed to sign in with Apple"),Y(!1)}},Se=async Pe=>{if(Pe.preventDefault(),g(""),!s.trim()){g("Please enter your email address");return}p(!0);try{await ve(s.trim()),M(!0)}catch(V){V.code==="auth/user-not-found"?g("No account found with this email"):g(V.message||"Failed to send reset email")}p(!1)};return a.jsxs("div",{className:"login-container",children:[a.jsx(Nj,{className:"login-theme-toggle"}),a.jsxs("div",{className:"login-card",children:[!b&&a.jsxs("button",{className:"login-back-btn",onClick:()=>L("/"),children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})}),"Back"]}),a.jsxs("div",{className:"login-header",children:[a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),a.jsx("p",{children:a.jsx("strong",{children:b?"Reset Password":"Mind Core Fitness"})}),!b&&a.jsx("span",{className:"login-type-label",children:Le})]}),d&&a.jsx("div",{className:"error-message",children:d}),E?a.jsxs("div",{className:"reset-sent",children:[a.jsx("div",{className:"reset-sent-icon",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),a.jsx("p",{children:"Reset email sent!"}),a.jsx("span",{children:"Check your inbox for a password reset link"}),a.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{k(!1),M(!1),g("")},children:"Back to Log In"})]}):b?a.jsxs("form",{onSubmit:Se,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:s,onChange:Pe=>e(Pe.target.value),placeholder:"Enter your email",required:!0})]}),a.jsx("button",{type:"submit",className:"login-btn",disabled:y,children:y?"Sending...":"Send Reset Link"}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{k(!1),g("")},children:"Back to Log In"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("form",{onSubmit:J,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:s,onChange:Pe=>e(Pe.target.value),required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"password",children:"Password"}),a.jsx("input",{type:"password",id:"password",value:t,onChange:Pe=>i(Pe.target.value),required:!0})]}),a.jsx("div",{className:"remember-me",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:l,onChange:Pe=>u(Pe.target.checked)}),a.jsx("span",{children:"Remember me"})]})}),a.jsx("button",{type:"submit",className:"login-btn",disabled:y,children:y?"Logging in...":"Log In"})]}),Ze&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"login-divider",children:a.jsx("span",{children:"or"})}),a.jsxs("button",{type:"button",className:"google-btn",onClick:Te,disabled:H,children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 48 48",children:[a.jsx("path",{fill:"#4285F4",d:"M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"}),a.jsx("path",{fill:"#34A853",d:"M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"}),a.jsx("path",{fill:"#FBBC05",d:"M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"}),a.jsx("path",{fill:"#EA4335",d:"M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.18 1.48-4.96 2.35-8.16 2.35-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"})]}),H?"Signing in...":"Continue with Google"]}),a.jsxs("button",{type:"button",className:"apple-btn",onClick:He,disabled:B,children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M17.05 20.28c-.98.95-2.05.88-3.08.4-1.09-.5-2.08-.48-3.24 0-1.44.62-2.2.44-3.06-.4C2.79 15.25 3.51 7.59 9.05 7.31c1.35.07 2.29.74 3.08.8 1.18-.24 2.31-.93 3.57-.84 1.51.12 2.65.72 3.4 1.8-3.12 1.87-2.38 5.98.48 7.13-.57 1.5-1.31 2.99-2.54 4.09zM12.03 7.25c-.15-2.23 1.66-4.07 3.74-4.25.29 2.58-2.34 4.5-3.74 4.25z"})}),B?"Signing in...":"Continue with Apple"]})]}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{k(!0),g("")},children:"Forgot password?"}),Ze&&a.jsx("button",{type:"button",className:"login-btn login-btn-outline",onClick:()=>L("/signup"),children:"Don't have an account? Create one free"})]}),a.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})]})}const d3=[{type:"block",label:"1-2-1 Training",description:"View sessions & your schedule",icon:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M6.5 6.5h11M6.5 17.5h11M4 9.5v5M20 9.5v5M2 11v2M22 11v2"})})},{type:"circuit",label:"Circuit Training",description:"Book & manage circuit sessions",icon:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})})},{type:"core_buddy",label:"Core Buddy",description:"Workouts, nutrition & habits",icon:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})}];function h3(){const s=Hs(),{currentUser:e,isAdmin:t,isClient:i,clientData:l,loading:u}=_r();return w.useEffect(()=>{!u&&e&&(t?s("/dashboard",{replace:!0}):i&&s(Cj(l),{replace:!0}))},[u,e,t,i,l,s]),u||e?a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",background:"var(--bg-body)"},children:a.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})}):a.jsxs("div",{className:"login-container",children:[a.jsx(Nj,{className:"login-theme-toggle"}),a.jsxs("div",{className:"portal-card",children:[a.jsxs("div",{className:"login-header",children:[a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),a.jsx("p",{children:a.jsx("strong",{children:"Welcome back"})}),a.jsx("p",{className:"portal-subtitle",children:"Select how you're logging in"})]}),a.jsx("div",{className:"portal-grid",children:d3.map(({type:d,label:g,description:y,icon:p})=>a.jsxs("button",{className:"portal-option",onClick:()=>s(`/login?type=${d}`),children:[a.jsx("div",{className:"portal-option-icon",children:p}),a.jsx("div",{className:"portal-option-label",children:g}),a.jsx("div",{className:"portal-option-desc",children:y})]},d))}),a.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})]})}function yh({feature:s,children:e}){const{canAccess:t,loading:i}=dc();return i||t(s)?e:a.jsx(Ax,{to:"/upgrade",replace:!0})}function ni({active:s}){const e=Hs(),{clientData:t}=_r(),{isPremium:i}=dc(),l=t?.clientType==="block"&&t?.coreBuddyAccess;return a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:`block-nav-tab${s==="home"?" active":""}`,onClick:()=>e("/client/core-buddy"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),a.jsx("span",{children:"Profile"})]}),a.jsxs("button",{className:`block-nav-tab${s==="workouts"?" active":""}`,onClick:()=>e("/client/core-buddy/workouts"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:a.jsx("path",{d:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"})}),a.jsx("span",{children:"Workout"})]}),i&&a.jsxs("button",{className:`block-nav-tab${s==="nutrition"?" active":""}`,onClick:()=>e("/client/core-buddy/nutrition"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"})}),a.jsx("span",{children:"Nutrition"})]}),i&&a.jsxs("button",{className:`block-nav-tab${s==="buddies"?" active":""}`,onClick:()=>e("/client/core-buddy/buddies"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"Buddies"})]}),l&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>e("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),a.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),a.jsx("span",{children:"Block"})]})]})}function nl({children:s,onRefresh:e}){const[t,i]=w.useState(0),[l,u]=w.useState(!1),d=w.useRef(null),g=w.useRef(0),y=w.useRef(!1),p=w.useCallback(E=>{window.scrollY<=0&&(g.current=E.touches[0].clientY,y.current=!0)},[]),b=w.useCallback(E=>{if(!y.current||l)return;const M=E.touches[0].clientY-g.current;M>20&&window.scrollY<=0&&(E.preventDefault(),i(Math.min((M-20)*.35,80)))},[l]),k=w.useCallback(async()=>{t>55&&!l&&(u(!0),e?await e():window.location.reload(),u(!1)),i(0),y.current=!1},[t,l,e]);return a.jsxs("div",{ref:d,onTouchStart:p,onTouchMove:b,onTouchEnd:k,children:[a.jsxs("div",{className:`pull-refresh-indicator ${t>0?"visible":""} ${l?"refreshing":""}`,style:{height:t},children:[a.jsx("div",{className:`refresh-spinner ${l?"spinning":""}`,children:a.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:a.jsx("path",{fill:"currentColor",d:"M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})})}),a.jsx("span",{className:"refresh-text",children:l?"Refreshing...":"Pull to refresh"})]}),s]})}function Ku(s,e,t,i,l){const u=[];for(let d=0;d<s;d++){const g=(d*(360/s)-90)*(Math.PI/180);u.push({x1:e+i*Math.cos(g),y1:t+i*Math.sin(g),x2:e+l*Math.cos(g),y2:t+l*Math.sin(g),thick:d%5===0})}return u}const Aj=Ku(60,100,100,85,96),f3=Ku(60,100,100,78,94),m3=Ku(60,100,100,82,94);Ku(60,50,50,38,46);const zP=Ku(60,40,40,30,37);function g3({steps:s,onFinish:e,active:t}){const[i,l]=w.useState(0),[u,d]=w.useState(null),[g,y]=w.useState("below"),[p,b]=w.useState(!1),k=w.useRef(null),E=w.useRef(t);E.current=t,w.useEffect(()=>{t||l(0)},[t]),w.useEffect(()=>{if(!t)return;const ve=he=>he.preventDefault();return document.addEventListener("touchmove",ve,{passive:!1}),document.addEventListener("wheel",ve,{passive:!1}),document.body.style.overflow="hidden",()=>{document.removeEventListener("touchmove",ve),document.removeEventListener("wheel",ve),document.body.style.overflow=""}},[t]);const M=w.useMemo(()=>t?s.filter(ve=>document.querySelector(ve.selector)):[],[t]),H=M[i],K=i===M.length-1,B=H?.selector,Y=w.useCallback(()=>{if(!B)return;const ve=document.querySelector(B);if(!ve){d(null);return}const he=ve.getBoundingClientRect(),D=8;d({top:he.top-D,left:he.left-D,width:he.width+D*2,height:he.height+D*2});const T=window.innerHeight-he.bottom;y(T<260?"above":"below")},[B]);if(w.useEffect(()=>{if(!t||!B)return;b(!0);const ve=document.querySelector(B);if(ve){document.body.style.overflow="",ve.scrollIntoView({behavior:"smooth",block:"center"});let he=null,D=0,T=0;const I=60,U=()=>{T++;const A=ve.getBoundingClientRect(),Le=Math.round(A.top);if(he!==null&&Le===he?D++:D=0,he=Le,D>=3||T>=I){E.current&&(document.body.style.overflow="hidden"),Y(),b(!1);return}L=requestAnimationFrame(U)};let L;const P=setTimeout(()=>{L=requestAnimationFrame(U)},120);return()=>{clearTimeout(P),L&&cancelAnimationFrame(L),E.current&&(document.body.style.overflow="hidden")}}},[t,i,B,Y]),w.useEffect(()=>{if(!t)return;const ve=()=>{k.current&&cancelAnimationFrame(k.current),k.current=requestAnimationFrame(Y)};return window.addEventListener("scroll",ve,!0),window.addEventListener("resize",ve),()=>{window.removeEventListener("scroll",ve,!0),window.removeEventListener("resize",ve),k.current&&cancelAnimationFrame(k.current)}},[t,Y]),!t||!H||M.length===0)return null;const ee=()=>{K?e():l(i+1)},ae=()=>{i>0&&l(i-1)},ye=()=>e();return a.jsxs("div",{className:"st-overlay",onClick:ve=>{ve.stopPropagation()},children:[a.jsx("div",{className:"st-backdrop",onClick:ee}),u&&a.jsx("div",{className:`st-spotlight${p?" st-transitioning":""}`,style:{top:u.top,left:u.left,width:u.width,height:u.height}}),u&&a.jsxs("div",{className:`st-tooltip st-tooltip-${g}${p?" st-transitioning":""}`,style:{top:g==="below"?Math.min(Math.max(u.top+u.height+16,16),window.innerHeight-200):void 0,bottom:g==="above"?Math.min(Math.max(window.innerHeight-u.top+16,16),window.innerHeight-60):void 0,left:Math.max(16,Math.min(u.left,window.innerWidth-320))},children:[a.jsx("div",{className:"st-dots",children:M.map((ve,he)=>a.jsx("span",{className:`st-dot${he===i?" active":""}${he<i?" done":""}`},he))}),a.jsx("h3",{className:"st-title",children:H.title}),a.jsx("p",{className:"st-body",children:H.body}),a.jsxs("div",{className:"st-actions",children:[i>0&&a.jsx("button",{className:"st-btn st-btn-back",onClick:ae,children:"Back"}),a.jsx("button",{className:"st-btn st-btn-next",onClick:ee,children:H.cta||(K?"Let's Go!":"Next")})]}),a.jsx("button",{className:"st-skip",onClick:ye,children:"Skip tour"})]})]})}const p3="/login/assets/first_workout-B8SFkzJX.PNG",y3="/login/assets/workouts_10-Z5R3u0xH.PNG",v3="/login/assets/workouts_25-CzxSlcAj.PNG",b3="/login/assets/workouts_50-BpzWup3V.PNG",w3="/login/assets/workouts_100-D7_r6tn1.PNG",x3="/login/assets/streak_2-CsRr-XA9.PNG",_3="/login/assets/streak_4-BHO09tbw.PNG",k3="/login/assets/streak_8-DX2UWMko.PNG",j3="/login/assets/nutrition_7-CHVV11fj.PNG",E3="/login/assets/leaderboard_join-BLoId4Hz.PNG",T3="/login/assets/habits_7-Dvki70KO.PNG",S3="/login/assets/starter_streak-CCltAfrC.PNG",C3="/login/assets/consistency_king-Cho2jxBt.PNG",N3="/login/assets/thirty_in_thirty-B0BVHafW.PNG",A3="/login/assets/minute_master-hA2RLkIL.PNG",R3="/login/assets/habit_machine--nFXaIUW.PNG",I3="/login/assets/iron_will-Dh2dTaie.PNG",Jr=[{id:"first_workout",img:p3,name:"First Rep",desc:"Complete your first workout",category:"workouts",threshold:1},{id:"workouts_10",img:y3,name:"On Fire",desc:"Complete 10 workouts",category:"workouts",threshold:10},{id:"workouts_25",img:v3,name:"Dedicated",desc:"Complete 25 workouts",category:"workouts",threshold:25},{id:"workouts_50",img:b3,name:"Unstoppable",desc:"Complete 50 workouts",category:"workouts",threshold:50},{id:"workouts_100",img:w3,name:"Century",desc:"Complete 100 workouts",category:"workouts",threshold:100},{id:"streak_2",img:x3,name:"2 Week Streak",desc:"Work out for 2 weeks in a row",category:"streaks",threshold:2},{id:"streak_4",img:_3,name:"Month Strong",desc:"Work out for 4 weeks in a row",category:"streaks",threshold:4},{id:"streak_8",img:k3,name:"8 Week Warrior",desc:"Work out for 8 weeks in a row",category:"streaks",threshold:8},{id:"nutrition_7",img:j3,name:"Macro Master",desc:"Hit your macro targets 7 days in a row",category:"nutrition",threshold:7},{id:"leaderboard_join",img:E3,name:"Competitor",desc:"Join the leaderboard",category:"leaderboard",threshold:1},{id:"habits_7",img:T3,name:"Habit Streak",desc:"Complete your daily habits 7 days in a row",category:"habits",threshold:7},{id:"starter_streak",img:S3,name:"Starter Streak",desc:"Complete 5 workouts in 7 days",category:"challenges",threshold:1},{id:"consistency_king",img:C3,name:"Consistency King",desc:"Complete 12 workouts in 30 days",category:"challenges",threshold:1},{id:"thirty_in_thirty",img:N3,name:"30 in 30",desc:"Complete 30 workouts in 30 days",category:"challenges",threshold:1},{id:"minute_master",img:A3,name:"Minute Master",desc:"Train for 300 total minutes in 30 days",category:"challenges",threshold:1},{id:"habit_machine",img:R3,name:"Habit Machine",desc:"Hit all daily habits for 7 days straight",category:"challenges",threshold:1},{id:"iron_will",img:I3,name:"Iron Will",desc:"Work out every day for 14 days straight",category:"challenges",threshold:1}],Ww=3,Gw=5,M3=["trained","protein","steps","sleep","water"];function Xg(s){return s.toISOString().split("T")[0]}const Jg=[{text:"You have 24 hours a day...",bold:"make it count"},{text:"Discipline beats motivation...",bold:"every single time"},{text:"Rest when you're done,",bold:"not when you're tired"},{text:"Small daily gains...",bold:"create massive results"},{text:"Your body keeps score,",bold:"train it well"},{text:"Consistency over intensity...",bold:"always wins"},{text:"The only bad workout...",bold:"is the one you skipped"}],eu={morning:[{main:"Rise and grind,",sub:"let's get after it!"},{main:"New day, new gains,",sub:"let's build something!"},{main:"The early bird gets the gains,",sub:"let's go!"},{main:"Winners wake up ready,",sub:"you showed up!"}],afternoon:[{main:"Oye",sub:"crack on and make it count!"},{main:"Halfway through the day,",sub:"don't ease off now!"},{main:"Afternoon push,",sub:"this is where champions are made!"},{main:"Still time to make today count,",sub:"let's go!"}],evening:[{main:"Evening session?",sub:"Let's finish strong!"},{main:"End the day on a high,",sub:"you earned it!"},{main:"Night owls lift heavier,",sub:"prove it!"},{main:"One more session today?",sub:"Close it out!"}],night:[{main:"Burning the midnight oil,",sub:"Respect the hustle!"},{main:"Late night dedication,",sub:"that's what sets you apart!"},{main:"While they sleep,",sub:"you grind!"}],allDone:[{main:"Smashed it today,",sub:"Rest up and go again tomorrow."},{main:"All tasks crushed,",sub:"Absolute machine!"},{main:"Nothing left undone,",sub:"That's elite-level discipline."}]};function Zg(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function tu(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function D3(s,e=800){return new Promise(t=>{const i=new Image;i.onload=()=>{const l=document.createElement("canvas");let u=i.width,d=i.height;u>d?u>e&&(d=Math.round(d*e/u),u=e):d>e&&(u=Math.round(u*e/d),d=e),l.width=u,l.height=d,l.getContext("2d").drawImage(i,0,0,u,d),l.toBlob(g=>t(g),"image/jpeg",.8)},i.src=URL.createObjectURL(s)})}function L3(){const{currentUser:s,isClient:e,clientData:t,logout:i,updateClientData:l,loading:u}=_r(),{isDark:d,toggleTheme:g}=Bi(),{isPremium:y,FREE_HABIT_LIMIT:p}=dc(),b=Hs(),[k,E]=w.useState(y?Gw:p),M=k,[H,K]=w.useState({hours:0,minutes:0,seconds:0}),[B,Y]=w.useState(0),[ee,ae]=w.useState(0),[ye,ve]=w.useState(0),[he,D]=w.useState(!1),[T,I]=w.useState({protein:0,carbs:0,fats:0,calories:0}),[U,L]=w.useState(null),[P,A]=w.useState(0),[Le,Ze]=w.useState(0),[J,Te]=w.useState(Ww),[He,Se]=w.useState(!1),[Pe,V]=w.useState(!1),[ce,je]=w.useState([]),[Ce,ke]=w.useState(null),[Ue,$e]=w.useState(!1),Qe=w.useRef(null),[Je,Wt]=w.useState(0),[It,Cn]=w.useState(0),[ln,qt]=w.useState(null),Et=w.useCallback((S,Q="info")=>{qt({message:S,type:Q}),setTimeout(()=>qt(null),4e3)},[]),[pn,Tt]=w.useState([]),[dt,le]=w.useState(!1),[pt,Ht]=w.useState(""),[it,yt]=w.useState(null),[gt,_t]=w.useState(null),[zt,fs]=w.useState(!1),[rn,Zn]=w.useState(new Set),[Fn,Ln]=w.useState(new Set),[Pn,un]=w.useState({}),[Gt,Ct]=w.useState({}),[Mt,Z]=w.useState({}),[C,te]=w.useState({}),[Re,Ie]=w.useState({}),[Me,Fe]=w.useState({}),Oe=w.useRef(null),Nt=w.useRef(null),bt=w.useRef({}),[lt,dn]=w.useState([]),[hn,On]=w.useState(!1),ms=w.useRef(null),[ue,De]=w.useState([]),[Ke,ct]=w.useState(""),[rt,Kt]=w.useState(!1),[fn,At]=w.useState(null),[St,bn]=w.useState([]),[Ss,si]=w.useState(null),[xi,Or]=w.useState(!1),js=w.useRef(!1),[hr,Kn]=w.useState(null),[os,ls]=w.useState(!1),Vn=w.useRef(!1),wn=(()=>{const S=[{selector:".cb-ring-container",title:"Your 24-Hour Countdown",body:"Every day resets. This ring tracks the time you have left  tap your photo to personalise your profile.",cta:"Next"},{selector:".cb-stats-row",title:"Progress at a Glance",body:"Your workout streak, sessions this week, and daily habits  all in one row. These fill up as you go."},{selector:".cb-nudge-card",title:"Smart Suggestions",body:"We'll highlight what needs your attention  your next session, unfinished habits, or a meal to log."},{selector:".cb-card-workouts-hero",title:"Workout",body:"Randomiser workouts  pick your focus, level and time. Save and replay your favourites.",cta:"Next"}];return y&&S.push({selector:".cb-card-nutrition",title:"Nutrition Tracking",body:"Set your macro targets, scan barcodes, and log meals to hit your daily goals."},{selector:".cb-card-consistency",title:"Daily Habits",body:"5 simple habits each day  train, hit protein, 10k steps, sleep, and hydrate. Build your streak."},{selector:".cb-card-buddies",title:"Buddies & Social",body:"Connect with other members, share your journey, and keep each other accountable."},{selector:".cb-journey-section",title:"Share Your Journey",body:"Post photos, updates, and milestones  your fitness journey in one place. Like and comment on each other's posts."}),S.push({selector:".block-bottom-nav",title:"You're All Set!",body:"Use the nav bar to jump between your profile, workouts, nutrition, and buddies. Time to get after it.",cta:"Let's Go!"}),S})();w.useEffect(()=>{!u&&!s&&b("/")},[u,s,b]),w.useEffect(()=>{!u&&t&&t.signupSource==="self_signup"&&!t.onboardingComplete&&b("/onboarding")},[u,t,b]),w.useEffect(()=>{let S=t?.tourComplete||Vn.current;if(!S&&t?.id)try{S=!!localStorage.getItem(`tourDone_${t.id}`)}catch{}if(he&&t&&!S){const Q=setTimeout(()=>ls(!0),600);return()=>clearTimeout(Q)}},[he,t]),w.useEffect(()=>{if(!(!he||!t?.id)){try{if(localStorage.getItem(`targetHint_${t.id}`))return}catch{}if(!t?.weeklyWorkoutTarget){const S=setTimeout(()=>V(!0),1500);return()=>clearTimeout(S)}}},[he,t]),w.useEffect(()=>{if(t)try{const S=sessionStorage.getItem(`cbDash_${t.id}`);if(S){const Q=JSON.parse(S);ae(Q.totalWorkouts??0),ve(Q.habitWeekPct??0),I(Q.nutritionTotals??{protein:0,carbs:0,fats:0,calories:0}),L(Q.nutritionTargetData??null),A(Q.todayHabitsCount??0),Q.realHabitCount&&E(Q.realHabitCount),Ze(Q.weeklyWorkouts??0),Te(Q.weeklyWorkoutTarget??Ww),je(Q.leaderboardTop3??[]),Wt(Q.streakWeeks??0),D(!0)}}catch{}},[t]),w.useEffect(()=>{t?.photoURL&&ke(t.photoURL),t?.weeklyWorkoutTarget&&Te(t.weeklyWorkoutTarget)},[t]),w.useEffect(()=>{if(!t)return;const S=tn(ut(pe,"notifications"),Ot("toId","==",t.id)),Q=cj(S,Ae=>{const R=Ae.docs.map(F=>({id:F.id,...F.data()}));R.sort((F,$)=>{const G=F.createdAt?.toMillis?.()||0;return($.createdAt?.toMillis?.()||0)-G}),dn(R.slice(0,50))},Ae=>{console.error("Notification listener error:",Ae),Ae.code==="permission-denied"&&console.warn("Firestore rules may be missing for the notifications collection. Please update your Firestore rules in the Firebase Console.")});return()=>Q()},[t]),w.useEffect(()=>{const S=Q=>{ms.current&&!ms.current.contains(Q.target)&&On(!1)};return document.addEventListener("mousedown",S),()=>document.removeEventListener("mousedown",S)},[]),w.useEffect(()=>{if(!t)return;const S=t.id;(async()=>{try{const[Q,Ae,R]=await Promise.all([$t(tn(ut(pe,"buddies"),Ot("user1","==",S))),$t(tn(ut(pe,"buddies"),Ot("user2","==",S))),$t(ut(pe,"clients"))]),F=new Set;[...Q.docs,...Ae.docs].forEach(G=>{const me=G.data();F.add(me.user1===S?me.user2:me.user1)});const $={};R.docs.forEach(G=>{$[G.id]=G.data()}),De(Array.from(F).filter(G=>$[G]).map(G=>({id:G,name:$[G].name,photoURL:$[G].photoURL||null})))}catch(Q){console.error("Error loading buddies for mentions:",Q)}})()},[t]);const es=lt.filter(S=>!S.read).length,kr=async()=>{const S=lt.filter(Ae=>!Ae.read);if(!S.length)return;const Q=Vw(pe);S.forEach(Ae=>Q.update(ze(pe,"notifications",Ae.id),{read:!0})),await Q.commit()},qs=async()=>{if(!lt.length)return;const S=Vw(pe);lt.forEach(Q=>S.delete(ze(pe,"notifications",Q.id))),await S.commit()},Yn=async(S,Q,Ae={})=>{if(!(!t||S===t.id))try{await or(ut(pe,"notifications"),{toId:S,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:Q,read:!1,createdAt:xs(),...Ae})}catch(R){console.error("Notification create error:",R),R.code==="permission-denied"&&Et("Notifications blocked  check Firestore rules","error")}},jr=(S,Q)=>{const Ae=Q==="compose"?Oe.current?.selectionStart:null,F=(Ae!=null?S.slice(0,Ae):S).match(/@(\w*)$/);if(F){Kt(!0),At(Q),ct(F[1].toLowerCase());const $=ue.filter(G=>G.name&&G.name.toLowerCase().includes(F[1].toLowerCase())).slice(0,5);bn($)}else Kt(!1),bn([])},ts=(S,Q)=>{if(Q==="compose"){const Ae=Oe.current,R=pt,F=Ae?.selectionStart??R.length,$=R.slice(0,F),G=R.slice(F),me=$.replace(/@\w*$/,`@${S.name} `);Ht(me+G),setTimeout(()=>{Ae?.focus(),Ae.selectionStart=Ae.selectionEnd=me.length},0)}else{const R=(Gt[Q]||"").replace(/@\w*$/,`@${S.name} `);Ct(F=>({...F,[Q]:R}))}Kt(!1),bn([])},Vr=S=>S&&S.split(/(@\w[\w\s]*?\s)/g).map((Ae,R)=>Ae.startsWith("@")&&ue.some(F=>Ae.trim()===`@${F.name}`)?a.jsx("span",{className:"mention-highlight",children:Ae.trim()},R):Ae),O=async S=>{const Q=S.target.files?.[0];if(!(!Q||!t)){if(!Q.type.startsWith("image/")){Et("Please select an image file","error");return}if(Q.size>5*1024*1024){Et("Image must be under 5MB","error");return}$e(!0);try{const Ae=await new Promise($=>{const G=new Image;G.onload=()=>{const me=document.createElement("canvas"),be=400;let Ve=G.width,nt=G.height;Ve>nt?(nt=nt/Ve*be,Ve=be):(Ve=Ve/nt*be,nt=be),me.width=Ve,me.height=nt,me.getContext("2d").drawImage(G,0,0,Ve,nt),me.toBlob(st=>$(st),"image/jpeg",.75)},G.src=URL.createObjectURL(Q)}),R=ca(ua,`profilePhotos/${t.id}`);await bu(R,Ae);const F=await io(R);await zn(ze(pe,"clients",t.id),{photoURL:F}),ke(F),l({photoURL:F}),Et("Profile photo updated!","success")}catch(Ae){console.error("Photo upload error:",Ae),Et("Failed to upload photo","error")}$e(!1),Qe.current&&(Qe.current.value="")}};w.useEffect(()=>{const S=()=>{const Ae=new Date,R=new Date(Ae);R.setHours(23,59,59,999);const F=R-Ae,$=Math.floor(F/(1e3*60*60)),G=Math.floor(F%(1e3*60*60)/(1e3*60)),me=Math.floor(F%(1e3*60)/1e3);K({hours:$,minutes:G,seconds:me}),Y(60-me)};S();const Q=setInterval(S,1e3);return()=>clearInterval(Q)},[]),w.useEffect(()=>{const S=setInterval(()=>{Cn(Q=>(Q+1)%Jg.length)},8e3);return()=>clearInterval(S)},[]),w.useEffect(()=>{if(!s||!t)return;(async()=>{let Q=null,Ae=null;try{const R=Xg(new Date),F=ut(pe,"workoutLogs"),$=tn(F,Ot("clientId","==",t.id));Q=await $t($),ae(Q.docs.length);const G=new Date,me=G.getDay(),be=me===0?6:me-1,Ve=new Date(G);Ve.setDate(G.getDate()-be),Ve.setHours(0,0,0,0);const nt=Ve.getTime(),st=Q.docs.filter(an=>{const mt=an.data().completedAt;return mt?(mt.toDate?mt.toDate().getTime():new Date(mt).getTime())>=nt:!1}).length;Ze(st);const[vt,kt]=await Promise.all([$t(tn(ut(pe,"habitLogs"),Ot("clientId","==",t.id),Ot("date","==",R))),_s(ze(pe,"customHabits",t.id))]);let Xt=Gw;if(kt.exists()){const an=kt.data(),mt=an.habits||[],gn=an.hiddenDefaults||[];Xt=M3.filter(tr=>!gn.includes(tr)).length+mt.length}y||(Xt=Math.min(Xt,p)),E(Xt);let Hn=0;if(!vt.empty){const an=vt.docs[0].data().habits||{};Hn=Object.values(an).filter(Boolean).length}ve(Math.round(Hn/Xt*100)),A(Hn);const tt=await _s(ze(pe,"nutritionTargets",t.id));tt.exists()&&(L(tt.data()),Ae=tt.data());const mn=await _s(ze(pe,"nutritionLogs",`${t.id}_${R}`));if(mn.exists()){const mt=(mn.data().entries||[]).reduce((gn,Xn)=>({protein:gn.protein+(Xn.protein||0),carbs:gn.carbs+(Xn.carbs||0),fats:gn.fats+(Xn.fats||0),calories:gn.calories+(Xn.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});I(mt)}}catch(R){console.error("Error loading dashboard stats:",R)}try{const R=ut(pe,"clients"),F=tn(R,Ot("leaderboardOptIn","==",!0)),G=(await $t(F)).docs.map(me=>({id:me.id,name:me.data().name,photoURL:me.data().photoURL||null}));if(je(G.slice(0,3)),t?.id){const me=G.findIndex(Ve=>Ve.id===t.id),be=me>=0?me+1:null;try{const Ve=`lbRank_${t.id}`,nt=sessionStorage.getItem(Ve);nt&&Kn(parseInt(nt,10)),be&&sessionStorage.setItem(Ve,String(be))}catch{}}}catch(R){console.error("Leaderboard preview error:",R)}try{let R=0;if(Q){const F=Q.docs.map($=>$.data().date).filter(Boolean).sort().reverse();if(F.length>0){const $=new Date;let G=new Date($);e:for(let me=0;me<52;me++){const be=new Date(G),Ve=be.getDay(),nt=Ve===0?6:Ve-1;be.setDate(be.getDate()-nt),be.setHours(0,0,0,0);const st=new Date(be);st.setDate(st.getDate()+7);const vt=Xg(be),kt=Xg(st);if(F.some(Hn=>Hn>=vt&&Hn<kt))R++;else{if(me>0)break e;break}G.setDate(G.getDate()-7)}}}Wt(R)}catch(R){console.error("Streak computation error:",R)}D(!0)})()},[s,t,M]),w.useEffect(()=>{if(!(!he||!t))try{sessionStorage.setItem(`cbDash_${t.id}`,JSON.stringify({totalWorkouts:ee,habitWeekPct:ye,nutritionTotals:T,nutritionTargetData:U,todayHabitsCount:P,realHabitCount:k,weeklyWorkouts:Le,weeklyWorkoutTarget:J,leaderboardTop3:ce,streakWeeks:Je}))}catch{}},[he,ee,ye,T,U,P,Le,J,ce,Je,t]),w.useEffect(()=>{if(!(!he||js.current)&&Le>=J&&J>0){const S=`weekCeleb_${t?.id}_${new Date().toISOString().slice(0,10).replace(/-\d{2}$/,"")}`;try{if(sessionStorage.getItem(S))return;sessionStorage.setItem(S,"1")}catch{}js.current=!0,Or(!0),setTimeout(()=>Or(!1),3500)}},[he,Le,J,t]);const q=w.useCallback(async()=>{if(Vn.current=!0,ls(!1),l({tourComplete:!0}),t?.id){try{localStorage.setItem(`tourDone_${t.id}`,"1")}catch{}try{await zn(ze(pe,"clients",t.id),{tourComplete:!0})}catch(S){console.error("Failed to save tour completion:",S)}}},[t,l]),oe=w.useCallback(async S=>{if(Te(S),Se(!1),V(!1),t?.id){try{localStorage.setItem(`targetHint_${t.id}`,"1")}catch{}try{await zn(ze(pe,"clients",t.id),{weeklyWorkoutTarget:S})}catch(Q){console.error("Failed to save weekly target:",Q)}}},[t]),ne=S=>{const Q=S.currentTarget,Ae=Q.querySelector(".ripple");Ae&&Ae.remove();const R=Q.getBoundingClientRect(),F=Math.max(R.width,R.height),$=S.clientX-R.left-F/2,G=S.clientY-R.top-F/2,me=document.createElement("span");me.className="ripple",me.style.cssText=`width:${F}px;height:${F}px;left:${$}px;top:${G}px;`,Q.appendChild(me),setTimeout(()=>me.remove(),600)},Ye=t?.name?.split(" ")[0]||"there",Ge=Math.min(Math.round(Le/J*100),100),qe=Je>0?Math.min(Math.round(Je/12*100),100):0,ot=[{label:"Wk Streak",value:`${Je}`,pct:qe,color:"var(--color-primary)",size:"normal"},{label:"Workouts",value:`${Le}/${J}`,pct:Ge,color:"var(--color-primary)",size:"large",editable:!0},{label:"Habits Today",value:`${ye}%`,pct:ye,color:"var(--color-primary)",size:"normal"}],Rt=T.calories>0&&U?.calories&&T.calories>=U.calories*.8,Nn=Le>=J&&J>0,Cs=P>=M,Qn=(()=>{if(!he)return null;const S=J-Le;return S===1?"1 more workout to hit your weekly goal":S===2?"2 more workouts to hit your weekly goal":M-P===1?"1 habit left to complete today":null})(),Ms=S=>!U||!U[S]?0:Math.min(Math.round(T[S]/U[S]*100),100),ri=(()=>{const S=new Date().getHours(),Q=he&&P>=M&&T.calories>0,Ae=R=>R[Math.floor(Date.now()/6e4%R.length)];return Q?Ae(eu.allDone):S>=5&&S<12?Ae(eu.morning):S>=12&&S<17?Ae(eu.afternoon):S>=17&&S<21?Ae(eu.evening):Ae(eu.night)})(),Ds=he?Le===0?{label:"WORKOUT",message:"No workouts this week yet",cta:"Start One",action:()=>b("/client/core-buddy/workouts"),pct:0,ringLabel:"0"}:P<M?{label:"DAILY HABITS",message:`${P}/${M} completed`,cta:"Open Habits",action:()=>b("/client/core-buddy/consistency"),pct:ye,ringLabel:`${P}/${M}`}:y&&T.calories===0?{label:"NUTRITION",message:"No meals logged today",cta:"Log Meal",action:()=>b("/client/core-buddy/nutrition"),pct:0,ringLabel:"0"}:{label:"TODAY",message:"You're crushing it!",cta:null,action:null,pct:100,ringLabel:""}:null,er=w.useCallback(async()=>{if(t){le(!0);try{const Q=(await $t(tn(ut(pe,"posts"),Ot("authorId","==",t.id)))).docs.map(R=>({id:R.id,...R.data()})).sort((R,F)=>{const $=R.createdAt?.toDate?.()||new Date(0);return(F.createdAt?.toDate?.()||new Date(0))-$}).slice(0,30);Tt(Q);const Ae=await $t(tn(ut(pe,"postLikes"),Ot("userId","==",t.id)));Zn(new Set(Ae.docs.map(R=>R.data().postId)))}catch(S){console.error("Error loading journey:",S)}finally{le(!1)}}},[t]);w.useEffect(()=>{he&&t&&er()},[he,t,er]);const _i=S=>{const Q=S.target.files?.[0];if(Q){if(!Q.type.startsWith("image/")){Et("Please select an image file","error");return}if(Q.size>10*1024*1024){Et("Image must be under 10MB","error");return}yt(Q),_t(URL.createObjectURL(Q))}},Er=()=>{yt(null),gt&&URL.revokeObjectURL(gt),_t(null),Nt.current&&(Nt.current.value="")},Ns=async()=>{if(!(!pt.trim()&&!it||zt||!t)){fs(!0);try{let S=null;if(it){const F=await D3(it),$=`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,G=ca(ua,`postImages/${t.id}/${$}`);await bu(G,F),S=await io(G)}await or(ut(pe,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:pt.trim(),type:S?"image":"text",imageURL:S||null,createdAt:xs(),likeCount:0,commentCount:0});const Ae=pt.trim().match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Ae){const F=new Set;Ae.forEach($=>{const G=$.slice(1).trim(),me=ue.find(be=>be.name&&be.name.toLowerCase()===G.toLowerCase());me&&!F.has(me.id)&&(F.add(me.id),Yn(me.id,"mention",{}))})}Ht(""),Er(),Oe.current&&(Oe.current.style.height="auto"),await er();const R=ue.length;Et(R>0?`Shared with ${R} ${R===1?"buddy":"buddies"}`:"Posted to your journey!","success")}catch(S){console.error("Error posting:",S),Et(S?.message||"Failed to post","error")}finally{fs(!1)}}},Ea=async S=>{if(window.confirm("Delete this post?"))try{await ar(ze(pe,"posts",S)),Tt(Q=>Q.filter(Ae=>Ae.id!==S)),Et("Post deleted","info")}catch(Q){console.error("Delete error:",Q),Et("Failed to delete","error")}},zi=async S=>{if(!t)return;const Q=t.id,Ae=`${S}_${Q}`,R=rn.has(S),F=new Set(rn);R?F.delete(S):F.add(S),Zn(F),Tt($=>$.map(G=>G.id===S?{...G,likeCount:Math.max(0,(G.likeCount||0)+(R?-1:1))}:G));try{if(R)await ar(ze(pe,"postLikes",Ae)),await zn(ze(pe,"posts",S),{likeCount:mi(-1)});else{await Wn(ze(pe,"postLikes",Ae),{postId:S,userId:Q,createdAt:xs()}),await zn(ze(pe,"posts",S),{likeCount:mi(1)});const $=pn.find(G=>G.id===S);$&&Yn($.authorId,"like",{postId:S})}}catch($){console.error("Like error:",$),er()}},ii=async S=>{try{const Ae=(await $t(tn(ut(pe,"postComments"),Ot("postId","==",S)))).docs.map(R=>({id:R.id,...R.data()})).sort((R,F)=>{const $=R.createdAt?.toDate?.()||new Date(0),G=F.createdAt?.toDate?.()||new Date(0);return $-G}).slice(0,50);un(R=>({...R,[S]:Ae}))}catch(Q){console.error("Error loading comments:",Q)}},ki=S=>{const Q=new Set(Fn);Q.has(S)?Q.delete(S):(Q.add(S),Pn[S]||ii(S)),Ln(Q)},Fi=async S=>{const Q=(Gt[S]||"").trim(),Ae=Re[S];if(!(!Q&&!Ae||!t)){Z(R=>({...R,[S]:!0}));try{let R=null;if(Ae){const be=ca(ua,`comment-images/${Date.now()}_${Ae.name}`);await bu(be,Ae),R=await io(be)}const F={postId:S,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Q||"",createdAt:xs()};R&&(F.imageURL=R);const $=C[S];$&&(F.replyToId=$.id,F.replyToName=$.authorName),await or(ut(pe,"postComments"),F),await zn(ze(pe,"posts",S),{commentCount:mi(1)});const G=pn.find(be=>be.id===S);G&&Yn(G.authorId,"comment",{postId:S});const me=Q.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(me){const be=new Set;me.forEach(Ve=>{const nt=Ve.slice(1).trim(),st=ue.find(vt=>vt.name&&vt.name.toLowerCase()===nt.toLowerCase());st&&!be.has(st.id)&&(be.add(st.id),Yn(st.id,"mention",{postId:S}))})}Ct(be=>({...be,[S]:""})),Ie(be=>({...be,[S]:null})),Fe(be=>({...be,[S]:null})),te(be=>({...be,[S]:null})),bt.current[S]&&(bt.current[S].value=""),Tt(be=>be.map(Ve=>Ve.id===S?{...Ve,commentCount:(Ve.commentCount||0)+1}:Ve)),await ii(S)}catch(R){console.error("Comment error:",R),Et("Failed to comment","error")}finally{Z(R=>({...R,[S]:!1}))}}},Ur=async(S,Q)=>{try{await ar(ze(pe,"postComments",Q)),await zn(ze(pe,"posts",S),{commentCount:mi(-1)}),un(Ae=>({...Ae,[S]:(Ae[S]||[]).filter(R=>R.id!==Q)})),Tt(Ae=>Ae.map(R=>R.id===S?{...R,commentCount:Math.max((R.commentCount||1)-1,0)}:R))}catch(Ae){console.error("Delete comment error:",Ae),Et("Failed to delete comment","error")}},Tr=(S,Q)=>{const Ae=Q.target.files?.[0];if(!Ae)return;if(Ae.size>5*1024*1024){Et("Image must be under 5MB","error");return}Ie(F=>({...F,[S]:Ae}));const R=new FileReader;R.onload=F=>Fe($=>({...$,[S]:F.target.result})),R.readAsDataURL(Ae)},$s=S=>{Ie(Q=>({...Q,[S]:null})),Fe(Q=>({...Q,[S]:null})),bt.current[S]&&(bt.current[S].value="")},Ws=S=>{Ht(S.target.value),S.target.style.height="auto",S.target.style.height=Math.min(S.target.scrollHeight,120)+"px",jr(S.target.value,"compose")},Ls=(S,Q)=>{Ct(Ae=>({...Ae,[S]:Q})),jr(Q,S)};return a.jsx(nl,{children:a.jsxs("div",{className:"cb-dashboard",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsxs("div",{className:"header-left-group",children:[a.jsxs("div",{className:"header-notif-wrap",ref:ms,children:[a.jsxs("button",{className:"header-notif-btn",onClick:()=>{On(!hn),hn||kr()},"aria-label":"Notifications",children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),a.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),es>0&&a.jsx("span",{className:"header-notif-badge",children:es>9?"9+":es})]}),hn&&a.jsxs("div",{className:"notif-panel",children:[a.jsxs("div",{className:"notif-panel-header",children:[a.jsx("span",{className:"notif-panel-title",children:"Notifications"}),lt.length>0&&a.jsx("button",{className:"notif-clear-btn",onClick:qs,children:"Clear all"})]}),a.jsx("div",{className:"notif-panel-list",children:lt.length===0?a.jsx("div",{className:"notif-empty",children:"No notifications yet"}):lt.map(S=>a.jsxs("div",{className:`notif-item${S.read?"":" unread"}`,onClick:()=>{if(On(!1),S.type==="buddy_request"||S.type==="buddy_accept")b(y?"/client/core-buddy/buddies":"/upgrade");else if((S.type==="like"||S.type==="comment")&&S.postId){if(!Fn.has(S.postId)){const Q=new Set(Fn);Q.add(S.postId),Ln(Q),Pn[S.postId]||ii(S.postId)}setTimeout(()=>{const Q=document.getElementById(`post-${S.postId}`);Q&&Q.scrollIntoView({behavior:"smooth",block:"center"})},150)}else S.type==="like"||S.type==="comment"?document.querySelector(".cb-journey-section")?.scrollIntoView({behavior:"smooth"}):S.type==="mention"&&b(`/client/core-buddy/profile/${S.fromId}`)},children:[a.jsx("div",{className:"notif-item-avatar",children:S.fromPhotoURL?a.jsx("img",{src:S.fromPhotoURL,alt:""}):a.jsx("span",{children:(S.fromName||"?")[0]})}),a.jsxs("div",{className:"notif-item-body",children:[a.jsxs("p",{className:"notif-item-text",children:[a.jsx("strong",{children:S.fromName})," ",S.type==="buddy_request"&&"sent you a buddy request",S.type==="buddy_accept"&&"accepted your buddy request",S.type==="like"&&"liked your post",S.type==="comment"&&"commented on your post",S.type==="mention"&&"mentioned you"]}),a.jsx("span",{className:"notif-item-time",children:Zg(S.createdAt)})]})]},S.id))})]})]}),a.jsx("button",{className:"header-icon-btn",onClick:()=>b("/client/core-buddy/settings"),"aria-label":"Settings",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})})]}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{className:"header-icon-btn",onClick:g,"aria-label":d?"Switch to light mode":"Switch to dark mode",children:d?a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})}),a.jsx("button",{className:"header-icon-btn",onClick:i,"aria-label":"Log out",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),a.jsxs("main",{className:"cb-main",children:[a.jsxs("div",{className:"cb-ring-container",children:[a.jsxs("div",{className:"cb-ring",children:[a.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:Aj.map((S,Q)=>{const Ae=Q<B;return a.jsx("line",{x1:S.x1,y1:S.y1,x2:S.x2,y2:S.y2,className:`ring-tick ${Ae?"elapsed":"remaining"}`,strokeWidth:S.thick?"3":"2"},Q)})}),a.jsxs("div",{className:"cb-ring-center",children:[a.jsxs("div",{className:"cb-ring-logo",onClick:()=>Qe.current?.click(),role:"button",tabIndex:0,"aria-label":"Change profile photo",children:[a.jsx("img",{src:Ce||"/Logo.webp",alt:Ce?"Profile":"Mind Core Fitness"}),a.jsx("div",{className:`cb-photo-overlay${Ue?" uploading":""}`,children:Ue?a.jsx("div",{className:"cb-photo-spinner"}):a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),a.jsx("input",{ref:Qe,type:"file",accept:"image/*",onChange:O,style:{display:"none"}})]}),!Ce&&!Ue&&a.jsx("div",{className:"cb-photo-badge",onClick:()=>Qe.current?.click(),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),a.jsxs("div",{className:"cb-ring-countdown",children:[a.jsx("span",{className:"cb-timer-digit",children:String(H.hours).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit",children:String(H.minutes).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(H.seconds).padStart(2,"0")})]}),a.jsx("span",{className:"cb-ring-label",children:"remaining today"}),a.jsxs("p",{className:"cb-ring-tagline",children:[Jg[It].text," ",a.jsx("strong",{children:Jg[It].bold})]},It)]}),a.jsx("div",{className:"cb-stats-row",children:ot.map(S=>{const Q=(S.size==="large",38),Ae=2*Math.PI*Q,R=Ae-S.pct/100*Ae,F=S.editable,$=S.pct>=75&&S.pct<100,G=S.pct>=100;return a.jsxs("div",{className:`cb-stat-item${S.size==="large"?" cb-stat-large":""}`,children:[a.jsxs("div",{className:`cb-stat-ring${F?" cb-stat-tappable":""}${F&&Pe?" cb-stat-hint":""}${$?" cb-stat-near":""}${G?" cb-stat-complete":""}`,onClick:F?()=>{Se(!0),V(!1)}:void 0,children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-stat-track",cx:"50",cy:"50",r:Q}),a.jsx("circle",{className:`cb-stat-fill${$?" cb-fill-near":""}${G?" cb-fill-complete":""}`,cx:"50",cy:"50",r:Q,strokeDasharray:Ae,strokeDashoffset:R})]}),a.jsx("span",{className:`cb-stat-value${G?" cb-val-complete":""}`,children:S.value})]}),a.jsxs("span",{className:"cb-stat-label",children:[S.label==="Wk Streak"&&Je>0&&a.jsx("svg",{className:"cb-streak-flame",width:"12",height:"12",viewBox:"0 0 24 24",fill:"var(--color-primary)",stroke:"none",children:a.jsx("path",{d:"M12 12c2-2.96 0-7-1-8 0 3.038-1.773 4.741-3 6-1.226 1.26-2 3.24-2 5a6 6 0 1 0 12 0c0-1.532-1.056-3.94-2-5-1.786 3-2.791 3-4 2z"})}),S.label]})]},S.label)})}),He&&a.jsx("div",{className:"cb-target-overlay",onClick:()=>Se(!1),children:a.jsxs("div",{className:"cb-target-picker",onClick:S=>S.stopPropagation(),children:[a.jsx("h4",{children:"Weekly workout goal"}),a.jsx("p",{children:"How many sessions per week?"}),a.jsx("div",{className:"cb-target-options",children:[1,2,3,4,5,6,7].map(S=>a.jsx("button",{className:`cb-target-option${S===J?" active":""}`,onClick:()=>oe(S),children:S},S))})]})}),a.jsxs("p",{className:"cb-coach-msg",children:[ri.main," ",a.jsx("strong",{children:Ye}),"  ",ri.sub]}),Qn&&a.jsxs("div",{className:"cb-milestone-hint",children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),a.jsx("span",{children:Qn})]}),Ds&&a.jsxs("button",{className:"cb-nudge-card",onClick:Ds.action||void 0,style:Ds.action?void 0:{cursor:"default"},children:[a.jsxs("div",{className:"cb-nudge-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-nudge-ring-track",cx:"50",cy:"50",r:"38"}),a.jsx("circle",{className:"cb-nudge-ring-fill",cx:"50",cy:"50",r:"38",strokeDasharray:2*Math.PI*38,strokeDashoffset:2*Math.PI*38-Ds.pct/100*2*Math.PI*38})]}),a.jsx("span",{className:"cb-nudge-ring-val",children:Ds.ringLabel})]}),a.jsxs("div",{className:"cb-nudge-info",children:[a.jsx("span",{className:"cb-nudge-label",children:Ds.label}),a.jsx("span",{className:"cb-nudge-title",children:Ds.message}),Ds.cta&&a.jsxs("span",{className:"cb-nudge-cta",children:[Ds.cta," "]})]})]}),a.jsxs("div",{className:"cb-features",children:[y&&a.jsxs("button",{className:`cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn${Rt?" cb-card-done":""}`,onClick:S=>{ne(S),b("/client/core-buddy/nutrition")},children:[a.jsxs("div",{className:"cb-card-top-row",children:[a.jsx("div",{className:"cb-card-content",children:a.jsx("h3",{children:"Today's Nutrition"})}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsx("div",{className:"cb-card-preview-row",children:a.jsx("div",{className:"cb-mini-rings",children:[{label:"P",pct:Ms("protein"),color:"var(--color-primary)"},{label:"C",pct:Ms("carbs"),color:"var(--color-primary)"},{label:"F",pct:Ms("fats"),color:"var(--color-primary)"},{label:"Cal",pct:Ms("calories"),color:"var(--color-primary)"}].map(S=>{const Ae=2*Math.PI*38,R=Ae-S.pct/100*Ae;return a.jsxs("div",{className:"cb-mini-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-mini-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"cb-mini-fill",cx:"50",cy:"50",r:38,style:{stroke:S.color},strokeDasharray:Ae,strokeDashoffset:R})]}),a.jsx("span",{style:{color:S.color},children:S.label})]},S.label)})})}),a.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),a.jsxs("button",{className:`cb-feature-card cb-card-workouts-hero ripple-btn${Nn?" cb-card-done":""}`,onClick:S=>{ne(S),b("/client/core-buddy/workouts")},children:[a.jsx("h3",{className:"cb-hero-title",children:"Workout"}),a.jsxs("div",{className:"cb-hero-stats",children:[a.jsxs("span",{children:[Le," this week"]}),a.jsx("span",{className:"cb-hero-dot",children:""}),a.jsxs("span",{children:[ee," total"]})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:`cb-feature-card cb-card-consistency ripple-btn${Cs?" cb-card-done":""}`,onClick:S=>{ne(S),b("/client/core-buddy/consistency")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Habits"}),a.jsx("div",{className:`cb-habit-dots${P>=M?" cb-habits-all-done":""}`,children:Array.from({length:M},(S,Q)=>a.jsx("span",{className:`cb-habit-dot${Q<P?" done":""}${!Q&&P>0&&Q>=P?" cb-dot-warming":""}`,style:Q>=P&&P>0?{"--glow-intensity":Math.min(P/M,.9)}:void 0},Q))}),a.jsxs("span",{className:"cb-habit-dots-label",children:[P,"/",M," today"]})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"cb-feature-card cb-card-leaderboard ripple-btn",onClick:S=>{ne(S),b("/client/leaderboard")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Leaderboard"}),ce.length>0?a.jsx("div",{className:"cb-lb-preview",children:ce.map((S,Q)=>{const Ae=["#FFD700","#A8B4C0","#CD7F32"][Q],R=S.name?S.name.split(" ").map(me=>me[0]).join("").slice(0,2).toUpperCase():"?",F=S.id===t?.id,$=Q+1,G=F&&hr?hr-$:0;return a.jsxs("div",{className:`cb-lb-entry${F?" cb-lb-me":""}`,children:[a.jsx("div",{className:"cb-lb-avatar",style:{borderColor:Ae},children:S.photoURL?a.jsx("img",{src:S.photoURL,alt:"",className:"cb-lb-avatar-img"}):a.jsx("span",{children:R})}),a.jsxs("span",{className:"cb-lb-rank",style:{color:Ae},children:["#",$,F&&G>0&&a.jsxs("span",{className:"cb-lb-movement cb-lb-up",children:["+",G]}),F&&G<0&&a.jsx("span",{className:"cb-lb-movement cb-lb-down",children:G})]})]},S.id)})}):a.jsx("p",{children:"Opt in to compete with your Core Buddies"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),y&&a.jsxs("div",{className:"cb-grid-row",children:[a.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-challenge ripple-btn",onClick:S=>{ne(S),b("/client/core-buddy/challenges")},children:[a.jsx("div",{className:"cb-card-icon-wrap cb-card-icon-challenge",children:a.jsx("img",{src:Jr.find(S=>S.id==="iron_will")?.img,alt:"",className:"cb-card-badge-img",loading:"lazy"})}),a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Challenges"}),a.jsx("p",{children:"Push yourself with timed fitness challenges"})]}),a.jsx("svg",{className:"cb-grid-arrow",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-badges ripple-btn",onClick:S=>{ne(S),b("/client/core-buddy/badges")},children:[a.jsx("div",{className:"cb-card-icon-wrap cb-card-icon-badges",children:a.jsx("img",{src:Jr.find(S=>S.id==="first_workout")?.img,alt:"",className:"cb-card-badge-img",loading:"lazy"})}),a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Badges"}),a.jsx("p",{children:"Collect badges as you hit milestones"})]}),a.jsx("svg",{className:"cb-grid-arrow",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),y&&a.jsxs("button",{className:"cb-feature-card cb-card-buddies ripple-btn",onClick:S=>{ne(S),b("/client/core-buddy/buddies")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Buddies"}),a.jsx("p",{children:"Connect with other members and track each other's progress"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),y&&a.jsxs("div",{className:"cb-journey-section",children:[a.jsx("h3",{className:"cb-journey-title",children:"My Journey"}),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"journey-compose",children:[a.jsx("div",{className:"journey-compose-avatar",children:Ce?a.jsx("img",{src:Ce,alt:""}):a.jsx("span",{children:tu(t?.name)})}),a.jsxs("div",{className:"journey-compose-body",style:{position:"relative"},children:[a.jsx("textarea",{ref:Oe,placeholder:"Share your progress... (use @ to mention)",value:pt,onChange:Ws,rows:1,maxLength:500}),rt&&fn==="compose"&&St.length>0&&a.jsx("div",{className:"mention-dropdown",children:St.map(S=>a.jsxs("button",{className:"mention-option",onClick:()=>ts(S,"compose"),children:[a.jsx("div",{className:"mention-option-avatar",children:S.photoURL?a.jsx("img",{src:S.photoURL,alt:""}):a.jsx("span",{children:tu(S.name)})}),a.jsx("span",{children:S.name})]},S.id))}),gt&&a.jsxs("div",{className:"journey-image-preview",children:[a.jsx("img",{src:gt,alt:"Preview"}),a.jsx("button",{className:"journey-image-remove",onClick:Er,"aria-label":"Remove image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-compose-actions",children:[a.jsx("button",{className:"journey-image-btn",onClick:()=>Nt.current?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:Nt,type:"file",accept:"image/*",onChange:_i,hidden:!0}),(pt.trim()||it)&&a.jsx("button",{className:"journey-post-btn",onClick:Ns,disabled:zt,children:zt?a.jsx("div",{className:"journey-btn-spinner"}):"Post"})]})]})]}),dt?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"cb-spinner"})}):pn.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"Start sharing your fitness journey!"})]}):a.jsx("div",{className:"journey-list",children:pn.map(S=>a.jsxs("div",{id:`post-${S.id}`,className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:S.authorPhotoURL?a.jsx("img",{src:S.authorPhotoURL,alt:""}):a.jsx("span",{children:tu(S.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:S.authorName}),a.jsx("span",{className:"journey-post-time",children:Zg(S.createdAt)})]}),a.jsx("button",{className:"journey-delete-btn",onClick:()=>Ea(S.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),S.type==="workout_summary"&&S.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:S.metadata.title}),S.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:S.metadata.stats.map(Q=>`${Q.value} ${Q.label}`).join("    ")}),!S.metadata.stats?.length&&S.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:S.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed a workout using Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):S.type==="badge_earned"&&S.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame journey-card-logo-badge",children:(()=>{const Q=Jr.find(Ae=>Ae.id===S.metadata.badgeId);return Q?.img?a.jsx("img",{src:Q.img,alt:S.metadata.title,className:"journey-card-logo-img",loading:"lazy"}):a.jsx("img",{src:"/Logo.webp",alt:S.metadata.title,className:"journey-card-logo-img"})})()}),a.jsx("h3",{className:"journey-card-title",children:S.metadata.title}),S.metadata.badgeDesc&&a.jsx("p",{className:"journey-card-stats-line",children:S.metadata.badgeDesc}),a.jsx("p",{className:"journey-card-cta",children:"I just earned a badge on Core Buddy"}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):S.type==="habits_summary"&&S.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:S.metadata.title}),S.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:S.metadata.stats.map(Q=>`${Q.value} ${Q.label}`).join("    ")}),S.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:S.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed my daily habits with Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):a.jsxs(a.Fragment,{children:[S.content&&a.jsx("p",{className:"journey-post-content",children:Vr(S.content)}),S.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:S.imageURL,alt:"Post",loading:"lazy"})})]}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${rn.has(S.id)?" liked":""}`,onClick:()=>zi(S.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:rn.has(S.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:S.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${Fn.has(S.id)?" active":""}`,onClick:()=>ki(S.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:S.commentCount||0})]})]}),Fn.has(S.id)&&a.jsxs("div",{className:"journey-comments",children:[Pn[S.id]?.length>0?Pn[S.id].map(Q=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",children:Q.authorPhotoURL?a.jsx("img",{src:Q.authorPhotoURL,alt:""}):a.jsx("span",{children:tu(Q.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:Q.authorName}),Q.replyToName&&a.jsxs("span",{className:"journey-comment-reply-tag",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"9 14 4 9 9 4"}),a.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),Q.replyToName]}),Q.content&&a.jsx("span",{className:"journey-comment-text",children:Vr(Q.content)}),Q.imageURL&&a.jsx("img",{className:"journey-comment-image",src:Q.imageURL,alt:"Comment",loading:"lazy"})]}),a.jsxs("div",{className:"journey-comment-actions-row",children:[a.jsx("span",{className:"journey-comment-time",children:Zg(Q.createdAt)}),a.jsx("button",{className:"journey-comment-reply-btn",onClick:()=>te(Ae=>({...Ae,[S.id]:{id:Q.id,authorName:Q.authorName}})),children:"Reply"}),a.jsx("button",{className:"journey-comment-delete-btn",onClick:()=>Ur(S.id,Q.id),"aria-label":"Delete comment",children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},Q.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),C[S.id]&&a.jsxs("div",{className:"journey-comment-replying",children:[a.jsxs("span",{children:["Replying to ",a.jsx("strong",{children:C[S.id].authorName})]}),a.jsx("button",{onClick:()=>te(Q=>({...Q,[S.id]:null})),"aria-label":"Cancel reply",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),Me[S.id]&&a.jsxs("div",{className:"journey-comment-img-preview",children:[a.jsx("img",{src:Me[S.id],alt:"Preview"}),a.jsx("button",{onClick:()=>$s(S.id),"aria-label":"Remove image",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("button",{className:"journey-comment-img-btn",onClick:()=>bt.current[S.id]?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:Q=>{bt.current[S.id]=Q},type:"file",accept:"image/*",onChange:Q=>Tr(S.id,Q),hidden:!0}),a.jsx("input",{type:"text",placeholder:"Comment",value:Gt[S.id]||"",onChange:Q=>Ls(S.id,Q.target.value),onKeyDown:Q=>{Q.key==="Enter"&&Fi(S.id)},maxLength:300}),rt&&fn===S.id&&St.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:St.map(Q=>a.jsxs("button",{className:"mention-option",onClick:()=>ts(Q,S.id),children:[a.jsx("div",{className:"mention-option-avatar",children:Q.photoURL?a.jsx("img",{src:Q.photoURL,alt:""}):a.jsx("span",{children:tu(Q.name)})}),a.jsx("span",{children:Q.name})]},Q.id))}),a.jsx("button",{onClick:()=>Fi(S.id),disabled:!(Gt[S.id]||"").trim()&&!Re[S.id]||Mt[S.id],children:Mt[S.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},S.id))})]})]}),!y&&a.jsxs("button",{className:"cb-upgrade-cta",onClick:()=>b("/upgrade"),children:[a.jsx("span",{className:"cb-upgrade-cta-text",children:"Unlock the full experience"}),a.jsx("span",{className:"cb-upgrade-cta-sub",children:"Unlimited workout times, nutrition, buddies & more"}),a.jsxs("svg",{className:"cb-upgrade-cta-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]})]})]}),a.jsx(ni,{active:"home"}),xi&&a.jsx("div",{className:"cb-weekly-celebration",children:a.jsxs("div",{className:"cb-weekly-celebration-card",children:[a.jsx("span",{className:"cb-weekly-celebration-icon",children:a.jsx("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsx("h4",{children:"Weekly Goal Smashed!"}),a.jsxs("p",{children:[Le,"/",J," sessions complete"]})]})}),ln&&a.jsxs("div",{className:`toast-notification ${ln.type}`,children:[ln.type==="info"&&a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),ln.type==="success"&&a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),ln.message]}),a.jsx(g3,{steps:wn,active:os,onFinish:q})]})})}async function ef(s,e){const t=Jr.find(i=>i.id===s);if(!t||!e?.id)return null;try{const i=ze(pe,"coreBuddyBadges",e.id),l=await _s(i),u=l.exists()?l.data().earned||[]:[];if(u.some(g=>g.id===t.id))return null;const d={id:t.id,earnedAt:new Date().toISOString()};return l.exists()?await zn(i,{earned:[...u,d]}):await Wn(i,{earned:[d]}),await or(ut(pe,"posts"),{authorId:e.id,authorName:e.name||"Anonymous",authorPhotoURL:e.photoURL||null,type:"badge_earned",metadata:{title:t.name,badgeDesc:t.desc,badgeId:t.id},createdAt:xs(),likeCount:0,commentCount:0}),t}catch(i){return console.error("Badge award failed:",i),null}}function Wl({badge:s,onDismiss:e}){if(!s)return null;const t=Array.from({length:60}).map((i,l)=>({x:5+Math.random()*90,delay:Math.random()*.5,color:["#A12F3A","#ffffff","#000000"][l%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.6+Math.random()*1.8,width:4+Math.random()*6,height:4+Math.random()*8,shape:l%3}));return a.jsxs("div",{className:"bc-overlay",onClick:e,children:[a.jsx("div",{className:"bc-confetti","aria-hidden":"true",children:t.map((i,l)=>a.jsx("span",{className:`bc-confetti-piece bc-shape-${i.shape}`,style:{"--x":`${i.x}%`,"--delay":`${i.delay}s`,"--color":i.color,"--drift":`${i.drift}px`,"--spin":`${i.spin}deg`,"--duration":`${i.duration}s`,width:`${i.width}px`,height:`${i.height}px`}},l))}),a.jsxs("div",{className:"bc-content",onClick:i=>i.stopPropagation(),children:[a.jsx("div",{className:"bc-glow"}),s.img&&a.jsx("img",{src:s.img,alt:s.name,className:"bc-badge-img"}),a.jsx("h2",{className:"bc-title",children:"Badge Unlocked!"}),a.jsx("p",{className:"bc-name",children:s.name}),a.jsx("p",{className:"bc-desc",children:s.desc}),a.jsx("button",{className:"bc-dismiss",onClick:e,children:"Tap to dismiss"})]})]})}const ep=new Map;function Yr(){return new Date().toISOString().split("T")[0]}const Kw=[{key:"breakfast",label:"Breakfast"},{key:"lunch",label:"Lunch"},{key:"dinner",label:"Dinner"},{key:"snacks",label:"Snacks"}],P3={breakfast:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),a.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),a.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),a.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),a.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),lunch:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),dinner:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),snacks:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})};function O3(){const s=new Date().getHours();return s<11?"breakfast":s<14?"lunch":s<17?"snacks":"dinner"}function V3(){const{currentUser:s,isClient:e,clientData:t,loading:i}=_r(),{isDark:l,toggleTheme:u}=Bi(),d=Hs(),[g,y]=w.useState("loading"),[p,b]=w.useState(null),[k,E]=w.useState(null),[M,H]=w.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",dailyActivity:"sedentary",trainingFrequency:"moderate",goal:"maintain",deficitLevel:"moderate"}),[K,B]=w.useState(null),[Y,ee]=w.useState(Yr()),[ae,ye]=w.useState({entries:[]}),[ve,he]=w.useState({protein:0,carbs:0,fats:0,calories:0}),[D,T]=w.useState(!1),[I,U]=w.useState(()=>{const O=new Date;return{year:O.getFullYear(),month:O.getMonth()}}),[L,P]=w.useState(!1),[A,Le]=w.useState(()=>{const O=new Date;return{year:O.getFullYear(),month:O.getMonth()}}),[Ze,J]=w.useState(!1),[Te,He]=w.useState(O3),[Se,Pe]=w.useState(null),[V,ce]=w.useState(null),[je,Ce]=w.useState(!1),[ke,Ue]=w.useState(null),[$e,Qe]=w.useState(""),[Je,Wt]=w.useState(!1),[It,Cn]=w.useState(""),[ln,qt]=w.useState([]),[Et,pn]=w.useState(!1),[Tt,dt]=w.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[le,pt]=w.useState(null),[Ht,it]=w.useState("100"),[yt,gt]=w.useState(0),[_t,zt]=w.useState("weight"),[fs,rn]=w.useState(0),[Zn,Fn]=w.useState(null);w.useRef(null);const Ln=w.useRef(!1),Pn=w.useRef(null),un=w.useRef(null),Gt=w.useRef(null),Ct=w.useCallback((O,q="info")=>{Fn({message:O,type:q}),setTimeout(()=>Fn(null),3e3)},[]);w.useEffect(()=>{!i&&(!s||!e)&&d("/")},[s,e,i,d]),w.useEffect(()=>{if(!t?.id)return;(async()=>{try{const q=await _s(ze(pe,"nutritionTargets",t.id));q.exists()?(b(q.data()),y("dashboard")):y("setup")}catch(q){console.error("Error loading nutrition data:",q),y("setup")}})()},[t?.id]),w.useEffect(()=>{if(!t?.id)return;(async()=>{try{const q=await _s(ze(pe,"nutritionLogs",`${t.id}_${Y}`));if(q.exists()){const oe=q.data();ye({entries:oe.entries||[]})}else ye({entries:[]})}catch(q){console.error("Error loading log:",q),ye({entries:[]})}})()},[t?.id,Y]),w.useEffect(()=>{const O=ae.entries.reduce((q,oe)=>({protein:q.protein+(oe.protein||0),carbs:q.carbs+(oe.carbs||0),fats:q.fats+(oe.fats||0),calories:q.calories+(oe.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});he(O)},[ae.entries]);const Mt=async O=>{try{if(await Wn(ze(pe,"nutritionLogs",`${t.id}_${Y}`),{clientId:t.id,date:Y,entries:O.entries,updatedAt:Bt.now()}),p?.protein&&Y===Yr()&&O.entries.reduce((oe,ne)=>oe+(ne.protein||0),0)>=p.protein){let oe=1;for(let ne=1;ne<7;ne++){const Ye=new Date;Ye.setDate(Ye.getDate()-ne);const Ge=Ye.toISOString().split("T")[0];try{const qe=await _s(ze(pe,"nutritionLogs",`${t.id}_${Ge}`));if(qe.exists())if((qe.data().entries||[]).reduce((Rt,Nn)=>Rt+(Nn.protein||0),0)>=p.protein)oe++;else break;else break}catch{break}}if(oe>=7){const ne=await ef("nutrition_7",t);ne&&E(ne)}}}catch(q){console.error("Error saving nutrition log:",q)}},Z=Y===Yr(),C=(O,q)=>new Date(O,q+1,0).getDate(),te=(O,q)=>new Date(O,q,1).getDay(),Re=O=>{if(O===Yr())return"Today";const q=new Date(O+"T12:00:00"),oe=new Date;return oe.setDate(oe.getDate()-1),O===oe.toISOString().split("T")[0]?"Yesterday":q.toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short"})},Ie=["January","February","March","April","May","June","July","August","September","October","November","December"],Me=["Su","Mo","Tu","We","Th","Fr","Sa"],Fe=()=>{let O=parseFloat(M.weight);M.weightUnit==="lbs"&&(O*=.453592);let q;M.heightUnit==="cm"?q=parseFloat(M.height):q=(parseFloat(M.heightFeet)||0)*30.48+(parseFloat(M.heightInches)||0)*2.54;const oe=parseInt(M.age);let ne=M.gender==="male"?10*O+6.25*q-5*oe+5:10*O+6.25*q-5*oe-161;const Ge=ne*{sedentary:1.2,light:1.3,moderate:1.4,active:1.5}[M.dailyActivity],qe={low:100,moderate:200,high:300,daily:400},ot=Math.round(Ge+qe[M.trainingFrequency]);let Rt=ot,Nn,Cs;switch(M.goal){case"lose":Rt=ot*(1-{light:.15,moderate:.2,harsh:.25}[M.deficitLevel]),Nn=2.2,Cs=.3;break;case"build":Rt=ot*1.1,Nn=2,Cs=.22;break;default:Nn=1.8,Cs=.25}Rt=Math.max(Rt,M.gender==="male"?1400:1100);const Qn=Math.round(O*Nn),Ms=Math.round(Rt*Cs/9),ri=Math.max(0,Math.round((Rt-Qn*4-Ms*9)/4));B({calories:Math.round(Rt),protein:Qn,carbs:ri,fats:Ms,bmr:Math.round(ne),neat:Math.round(Ge),exerciseAdd:qe[M.trainingFrequency],tdee:Math.round(ot)}),setTimeout(()=>{document.querySelector(".nut-calc-results")?.scrollIntoView({behavior:"smooth",block:"start"})},100)},Oe=async()=>{if(K)try{const O={clientId:t.id,calories:K.calories,protein:K.protein,carbs:K.carbs,fats:K.fats,goal:M.goal,updatedAt:Bt.now()};await Wn(ze(pe,"nutritionTargets",t.id),O),b(O),y("dashboard"),Ct("Macro targets saved!","success")}catch(O){console.error("Error saving targets:",O),Ct("Failed to save targets. Please try again.","error")}},Nt=()=>{const O=M.weight&&parseFloat(M.weight)>0,q=M.age&&parseInt(M.age)>0,oe=M.heightUnit==="cm"?M.height&&parseFloat(M.height)>0:M.heightFeet&&parseFloat(M.heightFeet)>0||M.heightInches&&parseFloat(M.heightInches)>0;return O&&q&&oe},bt="nut_favourite_foods",lt=()=>{try{return JSON.parse(localStorage.getItem(bt)||"[]")}catch{return[]}};w.useEffect(()=>{if(!t?.id)return;(async()=>{try{const q=await _s(ze(pe,"favouriteFoods",t.id));if(q.exists()){const oe=q.data().items||[];localStorage.setItem(bt,JSON.stringify(oe)),rn(ne=>ne+1)}else{const oe=lt();oe.length>0&&await Wn(ze(pe,"favouriteFoods",t.id),{items:oe,updatedAt:Bt.now()})}}catch(q){console.error("Error loading favourites:",q)}})()},[t?.id]);const dn=O=>lt().some(q=>q.name.toLowerCase()===(O||"").toLowerCase()),hn=O=>{const q=lt(),oe=q.findIndex(ne=>ne.name.toLowerCase()===O.name.toLowerCase());oe>=0?q.splice(oe,1):q.unshift({name:O.name,protein:O.protein,carbs:O.carbs,fats:O.fats,calories:O.calories,serving:O.serving,per100g:O.per100g||null,servingUnit:O.servingUnit||"g",portion:O.portion||null}),localStorage.setItem(bt,JSON.stringify(q)),t?.id&&Wn(ze(pe,"favouriteFoods",t.id),{items:q,updatedAt:Bt.now()}).catch(ne=>console.error("Error saving favourites:",ne)),rn(ne=>ne+1)},On=O=>{const q=[...ae.entries,{...O,meal:Te,id:Date.now(),addedAt:new Date().toISOString()}],oe={...ae,entries:q};ye(oe),Mt(oe),ce(null),pt(null),it("100"),gt(0),zt("weight"),dt({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),Ct("Food added!","success")},ms=O=>{const q=ae.entries.filter(ne=>ne.id!==O),oe={...ae,entries:q};ye(oe),Mt(oe)},ue=async O=>{if(!(!t?.id||O===Y)){J(!0);try{const q=await _s(ze(pe,"nutritionLogs",`${t.id}_${O}`));if(!q.exists()||!q.data().entries?.length){Ct("No food logged on that day","error");return}const oe=q.data().entries.map(Ge=>({...Ge,id:Date.now()+Math.random(),addedAt:new Date().toISOString()})),ne=[...ae.entries,...oe],Ye={...ae,entries:ne};ye(Ye),Mt(Ye),P(!1),Ct(`Copied ${oe.length} items from ${Re(O)}`,"success")}catch(q){console.error("Error copying day:",q),Ct("Failed to copy day","error")}finally{J(!1)}}},De=w.useRef(null),Ke=w.useRef([]),ct=3,rt=5,Kt=async()=>{Ce(!0);const O=document.querySelector("#barcode-reader");if(!O){Ce(!1),Ct("Scanner container not found.","error");return}if(!De.current)try{const oe=await Zs(()=>import("./quagga.min-BbicSfvA.js").then(ne=>ne.q),[]);De.current=oe.default}catch(oe){console.error("Failed to load barcode scanner:",oe),Ce(!1),Ct("Could not load scanner.","error");return}const q=De.current;q.init({inputStream:{type:"LiveStream",target:O,constraints:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader","ean_8_reader","upc_reader","upc_e_reader","code_128_reader","code_39_reader"]},locate:!0},oe=>{if(oe){console.error("Quagga init error:",oe),Ce(!1),Ct("Could not access camera. Check permissions.","error");return}q.start(),Ln.current=!0}),Ke.current=[],q.onDetected(oe=>{const ne=oe.codeResult.decodedCodes?.filter(Ge=>Ge.error!==void 0)?.map(Ge=>Ge.error)||[];if((ne.length>0?ne.reduce((Ge,qe)=>Ge+qe,0)/ne.length:1)<.15){const Ge=oe.codeResult.code,qe=Ke.current;qe.push(Ge),qe.length>rt&&qe.shift(),qe.filter(Rt=>Rt===Ge).length>=ct&&(q.offDetected(),Ke.current=[],Ue(Ge))}})},fn=()=>{const O=De.current;Ln.current&&O&&(O.stop(),O.offDetected(),Ln.current=!1),Ce(!1)},At=/\b(milk|semi.skimmed|skimmed|whole milk|oat milk|almond milk|soy milk|juice|smoothie|water|squash|cordial|cola|pepsi|fanta|lemonade|soda|beer|wine|cider|lager|spirit|whisky|vodka|rum|gin|brandy|cream|yoghurt drink|milkshake|coffee|tea|broth|stock|soup|sauce|ketchup|vinegar|oil|syrup|honey|custard|coconut water|kombucha|energy drink|protein shake)\b/i,St=O=>/ml|cl|\dl(?!b)|litre|liter|fl\s?oz/i.test((O||"").replace(/\s/g,"")),bn=O=>{if(!O)return{value:100,unit:"g"};const q=O.toLowerCase().replace(/\s/g,""),oe=q.match(/([\d.]+)/),ne=oe?parseFloat(oe[1]):100;return St(O)?/cl/.test(q)?{value:ne*10,unit:"ml"}:/(?:^|\d)l(?!i)/.test(q)&&!/ml/.test(q)?{value:ne*1e3,unit:"ml"}:{value:ne,unit:"ml"}:{value:ne,unit:"g"}},Ss=O=>{if(St(O.serving_size)||St(O.quantity))return"ml";const q=O.product_name||O.product_name_en||"";return At.test(q)?"ml":"g"},si=[{pattern:/\b(toast|bread|loaf|brioche|bagel|pitta|wrap|tortilla|crumpet|muffin|waffle|pancake)\b/i,label:"slice",weight:36},{pattern:/\begg\b/i,label:"egg",weight:60},{pattern:/\b(biscuit|cookie|digestive|hobnob|rich tea|oreo)\b/i,label:"biscuit",weight:13},{pattern:/\b(sausage|banger)\b/i,label:"sausage",weight:57},{pattern:/\b(rasher|bacon)\b/i,label:"rasher",weight:25},{pattern:/\b(rice cake)\b/i,label:"cake",weight:9},{pattern:/\b(cracker|ryvita)\b/i,label:"cracker",weight:10}],xi=(O,q)=>{const oe=O||"",ne=oe.match(/\((\d+\.?\d*)\s*g\)/i),Ye=oe.match(/(?:^|per\s+)(\d*\s*[a-z][a-z\s]*?)(?:\s*\(|\s*-\s*|\s*$)/i);if(ne&&Ye){const ot=parseFloat(ne[1]);let Rt=Ye[1].replace(/^\d+\s*/,"").trim();if(Rt&&ot>0)return{label:Rt,weight:ot}}const Ge=oe.match(/(\d+\.?\d*)\s*g\s*[\/=]\s*(\d*\s*[a-z][a-z\s]*)/i);if(Ge){const ot=parseFloat(Ge[1]);let Rt=Ge[2].replace(/^\d+\s*/,"").trim();if(Rt&&ot>0)return{label:Rt,weight:ot}}const qe=q||"";for(const{pattern:ot,label:Rt,weight:Nn}of si)if(ot.test(qe))return{label:Rt,weight:Nn};return null},Or=O=>{const q=O.nutriments||{},oe=Ss(O),ne=bn(O.serving_size),Ye=oe==="ml"?ne.unit==="ml"?ne.value:100:ne.value,Ge=O.product_name||O.product_name_en||"Unknown Product",qe=xi(O.serving_size,Ge);return{name:Ge,brand:O.brands||"",image:O.image_small_url||O.image_url||null,servingSize:O.serving_size||"100g",servingValue:Ye,servingUnit:oe,portion:qe,protein:Math.round(q.proteins_100g||q.proteins||0),carbs:Math.round(q.carbohydrates_100g||q.carbohydrates||0),fats:Math.round(q.fat_100g||q.fat||0),calories:Math.round(q["energy-kcal_100g"]||q["energy-kcal"]||(q.energy_100g?q.energy_100g/4.184:0)),per100g:!0}},js=async O=>{Wt(!0);try{const q=new AbortController,oe=setTimeout(()=>q.abort(),1e4),ne=`https://world.openfoodfacts.org/api/v2/product/${O}?fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,Ye=await fetch(ne,{signal:q.signal});if(clearTimeout(oe),Ye.status===404){Ct("Product not found. Try search or manual entry.","error"),Wt(!1);return}if(!Ye.ok)throw new Error(`HTTP ${Ye.status}`);const Ge=await Ye.json();if(Ge.status==="success"||Ge.status===1||Ge.product){const qe=Or(Ge.product);qe.calories===0&&qe.protein===0&&qe.carbs===0?Ct("Product found but no nutrition data available.","error"):(pt(qe),qe.portion?(gt(1),it(String(qe.portion.weight)),zt("portion")):(gt(0),it(String(qe.servingValue||100)),zt("weight")),Qe(""))}else Ct("Product not found. Try search or manual entry.","error")}catch(q){console.error("Barcode lookup error:",q),q.name==="AbortError"?Ct("Lookup timed out. Check your connection and try again.","error"):Ct("Failed to look up product. Check your connection.","error")}Wt(!1)},hr=(O,q,oe)=>{const ne=O.toLowerCase().trim(),Ye=q.toLowerCase().trim(),Ge=oe.toLowerCase().trim();let qe=0;return(ne===Ge||ne===Ge+"s"||ne+"s"===Ge)&&(qe+=100),(ne.endsWith(" "+Ge)||ne.endsWith(" "+Ge+"s"))&&(qe+=40),(ne.startsWith(Ge+" ")||ne.startsWith(Ge+"s "))&&(qe+=15),Ge.split(/\s+/).some(Rt=>Ye===Rt||Ye.startsWith(Rt))&&(qe+=30),qe+=Math.max(0,30-ne.length),qe},Kn=async()=>{if(!It.trim())return;Pn.current&&Pn.current.abort();const O=new AbortController;Pn.current=O;const q=It.trim().toLowerCase(),oe=q.split(/\s+/).filter(Boolean);if(ep.has(q)){qt(ep.get(q));return}pn(!0);try{const Ye=`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(It.trim())}&search_simple=1&action=process&json=1&page_size=10&lc=en&sort_by=unique_scans_n&fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,Ge=await fetch(Ye,{signal:O.signal});if(!Ge.ok)throw new Error(`HTTP ${Ge.status}`);const ot=((await Ge.json()).products||[]).map(Rt=>Or(Rt)).filter(Rt=>Rt.name!=="Unknown Product"&&(Rt.calories>0||Rt.protein>0)).filter(Rt=>{const Nn=(Rt.name+" "+Rt.brand).toLowerCase();return oe.every(Cs=>Nn.includes(Cs))}).sort((Rt,Nn)=>hr(Nn.name,Nn.brand,q)-hr(Rt.name,Rt.brand,q)).slice(0,10);ep.set(q,ot),qt(ot),ot.length===0&&Ct("No results found. Try a different search.","info")}catch(ne){if(ne.name==="AbortError")return;console.error("Search error:",ne),Ct("Search failed. Check your connection.","error")}pn(!1)};w.useEffect(()=>{if(un.current&&clearTimeout(un.current),!(!It.trim()||V!=="search"||le))return un.current=setTimeout(()=>{Kn()},700),()=>clearTimeout(un.current)},[It]);const os=l,ls={"ring-protein":os?"#2dd4bf":"#14b8a6","ring-carbs":os?"#fbbf24":"#f59e0b","ring-fats":os?"#a78bfa":"#8b5cf6","ring-cals":"var(--color-primary)"},Vn=80,wn=2*Math.PI*Vn,es=(O,q,oe,ne,Ye)=>{const Ge=ne>0?Math.min(100,Math.round(oe/ne*100)):0,qe=wn-Ge/100*wn,ot=ls[Ye]||"#14b8a6";return a.jsxs("div",{className:"nut-ring-wrap",children:[a.jsxs("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"nut-arc-track",cx:"100",cy:"100",r:Vn}),a.jsx("circle",{className:"nut-arc-fill",cx:"100",cy:"100",r:Vn,style:{stroke:ot},strokeDasharray:wn,strokeDashoffset:qe})]}),a.jsxs("div",{className:"nut-ring-center",children:[a.jsx("span",{className:"nut-ring-value",style:{color:ot},children:Math.round(oe)}),a.jsxs("span",{className:"nut-ring-target",children:["/ ",ne,O==="Calories"?"":"g"]}),a.jsx("span",{className:"nut-ring-label",style:{color:ot},children:q})]}),a.jsxs("span",{className:"nut-ring-pct",style:{color:ot},children:[Ge,"%"]})]})};if(w.useEffect(()=>{if(!ke)return;const O=setTimeout(()=>{const q=ke;fn(),Ue(null),js(q)},1500);return()=>clearTimeout(O)},[ke]),w.useEffect(()=>()=>{const O=De.current;if(Ln.current&&O){try{O.stop(),O.offDetected()}catch{}Ln.current=!1}},[]),i||g==="loading")return a.jsxs("div",{className:"nut-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"nut-loading-inline",children:a.jsx("div",{className:"cb-loading-spinner"})})]});if(g==="setup")return a.jsxs("div",{className:"nut-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"nut-main",children:[a.jsxs("div",{className:"nut-setup-intro",children:[a.jsx("h2",{children:"Set Your Daily Targets"}),a.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),a.jsxs("div",{className:"nut-calc-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Gender"}),a.jsxs("div",{className:"nut-toggle-group",children:[a.jsx("button",{className:M.gender==="male"?"active":"",onClick:()=>{H(O=>({...O,gender:"male"})),B(null)},children:"Male"}),a.jsx("button",{className:M.gender==="female"?"active":"",onClick:()=>{H(O=>({...O,gender:"female"})),B(null)},children:"Female"})]})]}),a.jsxs("div",{className:"nut-form-row",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Age"}),a.jsx("input",{type:"number",value:M.age,onChange:O=>{H(q=>({...q,age:O.target.value})),B(null)},placeholder:"Years",min:"15",max:"100"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Weight"}),a.jsxs("div",{className:"nut-input-unit",children:[a.jsx("input",{type:"number",value:M.weight,onChange:O=>{H(q=>({...q,weight:O.target.value})),B(null)},placeholder:M.weightUnit,min:"30",max:"300"}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:M.weightUnit==="kg"?"active":"",onClick:()=>{H(O=>({...O,weightUnit:"kg"})),B(null)},children:"kg"}),a.jsx("button",{className:M.weightUnit==="lbs"?"active":"",onClick:()=>{H(O=>({...O,weightUnit:"lbs"})),B(null)},children:"lbs"})]})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Height"}),a.jsxs("div",{className:"nut-input-unit",children:[M.heightUnit==="cm"?a.jsx("input",{type:"number",value:M.height,onChange:O=>{H(q=>({...q,height:O.target.value})),B(null)},placeholder:"cm",min:"100",max:"250"}):a.jsxs("div",{className:"nut-height-imperial",children:[a.jsx("input",{type:"number",value:M.heightFeet,onChange:O=>{H(q=>({...q,heightFeet:O.target.value})),B(null)},placeholder:"ft",min:"4",max:"7"}),a.jsx("input",{type:"number",value:M.heightInches,onChange:O=>{H(q=>({...q,heightInches:O.target.value})),B(null)},placeholder:"in",min:"0",max:"11"})]}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:M.heightUnit==="cm"?"active":"",onClick:()=>{H(O=>({...O,heightUnit:"cm"})),B(null)},children:"cm"}),a.jsx("button",{className:M.heightUnit==="ft"?"active":"",onClick:()=>{H(O=>({...O,heightUnit:"ft"})),B(null)},children:"ft/in"})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Daily Activity (outside of training)"}),a.jsxs("select",{value:M.dailyActivity,onChange:O=>{H(q=>({...q,dailyActivity:O.target.value})),B(null)},children:[a.jsx("option",{value:"sedentary",children:"Sedentary  desk job, under 5k steps"}),a.jsx("option",{value:"light",children:"Lightly Active  office + walking, 5-8k steps"}),a.jsx("option",{value:"moderate",children:"Moderately Active  on feet often, 8-12k steps"}),a.jsx("option",{value:"active",children:"Very Active  physical job, 12k+ steps"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Training Sessions per Week"}),a.jsxs("select",{value:M.trainingFrequency,onChange:O=>{H(q=>({...q,trainingFrequency:O.target.value})),B(null)},children:[a.jsx("option",{value:"low",children:"1-2 sessions"}),a.jsx("option",{value:"moderate",children:"3-4 sessions"}),a.jsx("option",{value:"high",children:"5-6 sessions"}),a.jsx("option",{value:"daily",children:"7+ sessions"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fitness Goal"}),a.jsxs("div",{className:"nut-goal-options",children:[a.jsxs("button",{className:M.goal==="lose"?"active":"",onClick:()=>{H(O=>({...O,goal:"lose"})),B(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"-"}),a.jsx("span",{children:"Lose Weight"})]}),a.jsxs("button",{className:M.goal==="maintain"?"active":"",onClick:()=>{H(O=>({...O,goal:"maintain"})),B(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"="}),a.jsx("span",{children:"Maintain"})]}),a.jsxs("button",{className:M.goal==="build"?"active":"",onClick:()=>{H(O=>({...O,goal:"build"})),B(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"+"}),a.jsx("span",{children:"Build Muscle"})]})]})]}),M.goal==="lose"&&a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Deficit Level"}),a.jsxs("div",{className:"nut-deficit-options",children:[a.jsxs("button",{className:M.deficitLevel==="light"?"active":"",onClick:()=>{H(O=>({...O,deficitLevel:"light"})),B(null)},children:[a.jsx("strong",{children:"Mild"}),a.jsx("span",{children:"15% below TDEE"})]}),a.jsxs("button",{className:M.deficitLevel==="moderate"?"active":"",onClick:()=>{H(O=>({...O,deficitLevel:"moderate"})),B(null)},children:[a.jsx("strong",{children:"Moderate"}),a.jsx("span",{children:"20% below TDEE"})]}),a.jsxs("button",{className:M.deficitLevel==="harsh"?"active":"",onClick:()=>{H(O=>({...O,deficitLevel:"harsh"})),B(null)},children:[a.jsx("strong",{children:"Aggressive"}),a.jsx("span",{children:"25% below TDEE"})]})]})]}),a.jsx("button",{className:"nut-calc-btn",onClick:Fe,disabled:!Nt(),children:"Calculate Macros"})]}),K&&a.jsxs("div",{className:"nut-calc-results",children:[a.jsx("h3",{children:"Your Daily Targets"}),a.jsxs("div",{className:"nut-calc-rings",children:[es("Protein","Protein",K.protein,K.protein,"ring-protein"),es("Carbs","Carbs",K.carbs,K.carbs,"ring-carbs"),es("Fats","Fats",K.fats,K.fats,"ring-fats"),es("Calories","Calories",K.calories,K.calories,"ring-cals")]}),a.jsxs("div",{className:"nut-calc-info",children:[a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"BMR (body at rest)"}),a.jsxs("span",{children:[K.bmr," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Daily activity (NEAT)"}),a.jsxs("span",{children:[K.neat," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Training sessions"}),a.jsxs("span",{children:["+",K.exerciseAdd," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",style:{fontWeight:600},children:[a.jsx("span",{children:"TDEE (total burn)"}),a.jsxs("span",{children:[K.tdee," cal"]})]})]}),a.jsx("button",{className:"nut-save-targets-btn",onClick:Oe,children:"Set as My Daily Targets"})]})]}),Zn&&a.jsx("div",{className:`toast-notification ${Zn.type}`,children:Zn.message})]});const kr=O=>{const q=new Date(O+"T12:00:00"),oe=q.getDay(),ne=new Date(q);ne.setDate(q.getDate()-(oe+6)%7);const Ye=[];for(let Ge=0;Ge<7;Ge++){const qe=new Date(ne);qe.setDate(ne.getDate()+Ge),Ye.push(qe.toISOString().split("T")[0])}return Ye},qs=["M","T","W","T","F","S","S"],Yn=(O,q="search")=>{He(O),q==="scan"?(ce("scan"),pt(null)):q==="manual"?(ce("manual"),dt({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})):q==="favourites"?ce("favourites"):(ce("search"),qt([]),Cn(""))},jr=kr(Y),ts=new Date(Y+"T12:00:00"),Vr=`${Ie[ts.getMonth()]} ${ts.getFullYear()}`;return a.jsx(nl,{children:a.jsxs("div",{className:"nut-page",children:[a.jsxs("div",{className:"nut-dark-zone",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:()=>{y("setup"),B(null)},"aria-label":"Recalculate macros",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]})}),a.jsxs("div",{className:"nut-dark-content",children:[a.jsxs("div",{className:"nut-week-strip anim-fade-up",children:[a.jsxs("div",{className:"nut-week-header",children:[a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const O=new Date(Y+"T12:00:00");O.setDate(O.getDate()-7);const q=O.toISOString().split("T")[0];ee(q)},"aria-label":"Previous week",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsx("button",{className:"nut-week-month-label",onClick:()=>{T(!D),U({year:ts.getFullYear(),month:ts.getMonth()})},children:Vr}),a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const O=new Date(Y+"T12:00:00");O.setDate(O.getDate()+7);const q=O.toISOString().split("T")[0];q<=Yr()&&ee(q)},"aria-label":"Next week",disabled:jr[6]>=Yr(),children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-week-days",children:jr.map((O,q)=>{const oe=new Date(O+"T12:00:00").getDate(),ne=O===Y,Ye=O>Yr(),Ge=O===Yr();return a.jsxs("button",{className:`nut-week-day${ne?" selected":""}${Ge?" today":""}${Ye?" future":""}`,disabled:Ye,onClick:()=>ee(O),children:[a.jsx("span",{className:"nut-week-day-letter",children:qs[q]}),a.jsx("span",{className:"nut-week-day-num",children:oe})]},O)})})]}),D&&a.jsxs("div",{className:"nut-calendar",children:[a.jsxs("div",{className:"nut-cal-header",children:[a.jsx("button",{onClick:()=>U(O=>{let q=O.month-1,oe=O.year;return q<0&&(q=11,oe--),{year:oe,month:q}}),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsxs("span",{children:[Ie[I.month]," ",I.year]}),a.jsx("button",{onClick:()=>U(O=>{let q=O.month+1,oe=O.year;return q>11&&(q=0,oe++),{year:oe,month:q}}),disabled:I.year===new Date().getFullYear()&&I.month>=new Date().getMonth(),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-cal-days-header",children:Me.map(O=>a.jsx("span",{children:O},O))}),a.jsxs("div",{className:"nut-cal-grid",children:[[...Array(te(I.year,I.month))].map((O,q)=>a.jsx("span",{},`e${q}`)),[...Array(C(I.year,I.month))].map((O,q)=>{const oe=q+1,ne=`${I.year}-${String(I.month+1).padStart(2,"0")}-${String(oe).padStart(2,"0")}`,Ye=ne>Yr(),Ge=ne===Y,qe=ne===Yr();return a.jsx("button",{className:`nut-cal-day${Ge?" selected":""}${qe?" today":""}${Ye?" future":""}`,disabled:Ye,onClick:()=>{ee(ne),T(!1)},children:oe},oe)})]})]}),a.jsxs("div",{className:"nut-rings-row anim-fade-up-d2",children:[es("Protein","Protein",ve.protein,p.protein,"ring-protein"),es("Carbs","Carbs",ve.carbs,p.carbs,"ring-carbs"),es("Fats","Fats",ve.fats,p.fats,"ring-fats"),es("Calories","kCal",ve.calories,p.calories,"ring-cals")]})]})]}),a.jsx("div",{className:"nut-light-zone anim-fade-up-d4",children:a.jsxs("div",{className:"nut-light-content",children:[Z&&a.jsx("div",{className:"nut-quick-row",children:a.jsxs("button",{className:"nut-copy-day-btn",onClick:()=>{P(!0),Le({year:new Date().getFullYear(),month:new Date().getMonth()})},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",width:"18",height:"18",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),a.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),a.jsx("span",{children:"Copy day"})]})}),a.jsx("div",{className:"nut-log-section",children:a.jsx("div",{className:"nut-meals-list",children:Kw.map(O=>{const q=ae.entries.filter(ne=>(ne.meal||"snacks")===O.key),oe=q.reduce((ne,Ye)=>({protein:ne.protein+(Ye.protein||0),carbs:ne.carbs+(Ye.carbs||0),fats:ne.fats+(Ye.fats||0),calories:ne.calories+(Ye.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});return a.jsxs("div",{className:"nut-meal-card",children:[a.jsxs("div",{className:"nut-meal-card-header",children:[a.jsx("span",{className:`nut-meal-card-icon nut-meal-icon-${O.key}`,children:P3[O.key]}),a.jsx("span",{className:"nut-meal-card-title",children:O.label}),q.length>0&&a.jsxs("span",{className:"nut-meal-card-cal",children:[oe.calories," cal"]}),Z&&a.jsx("button",{className:"nut-meal-add-btn",onClick:()=>Pe(Se===O.key?null:O.key),"aria-label":`Add to ${O.label}`,children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),q.length>0&&a.jsxs("div",{className:"nut-meal-bars",children:[a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-p",children:"P"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-protein",style:{width:`${Math.min(100,p.protein>0?oe.protein/p.protein*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[oe.protein,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-c",children:"C"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-carbs",style:{width:`${Math.min(100,p.carbs>0?oe.carbs/p.carbs*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[oe.carbs,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-f",children:"F"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-fats",style:{width:`${Math.min(100,p.fats>0?oe.fats/p.fats*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[oe.fats,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-cal",children:"K"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-cals",style:{width:`${Math.min(100,p.calories>0?oe.calories/p.calories*100:0)}%`}})}),a.jsx("span",{className:"nut-meal-bar-val",children:oe.calories})]})]}),q.length>0&&a.jsx("div",{className:"nut-log-list",children:q.map(ne=>a.jsxs("div",{className:"nut-log-item",children:[a.jsx("button",{className:`nut-fav-star log${dn(ne.name)?" active":""}`,onClick:()=>hn(ne),"aria-label":dn(ne.name)?"Remove from favourites":"Add to favourites",children:a.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:dn(ne.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("div",{className:"nut-log-item-info",children:[a.jsx("span",{className:"nut-log-item-name",children:ne.name}),ne.serving&&a.jsx("span",{className:"nut-log-item-serving",children:ne.serving})]}),a.jsxs("div",{className:"nut-log-item-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[ne.protein,"p"]}),a.jsxs("span",{className:"nut-macro-c",children:[ne.carbs,"c"]}),a.jsxs("span",{className:"nut-macro-f",children:[ne.fats,"f"]}),a.jsx("span",{className:"nut-macro-cal",children:ne.calories})]}),Z&&a.jsx("button",{className:"nut-log-delete",onClick:()=>ms(ne.id),"aria-label":"Remove",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},ne.id))}),q.length===0&&a.jsx("div",{className:"nut-meal-empty",children:a.jsx("p",{children:Z?"Tap + to add food":"No entries"})})]},O.key)})})})]})}),Se&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"nut-add-picker-backdrop",onClick:()=>Pe(null)}),a.jsxs("div",{className:"nut-add-picker",children:[a.jsx("div",{className:"nut-add-picker-handle"}),a.jsxs("h3",{className:"nut-add-picker-title",children:["Add to ",Kw.find(O=>O.key===Se)?.label]}),a.jsxs("div",{className:"nut-add-picker-options",children:[a.jsxs("button",{onClick:()=>{const O=Se;Pe(null),Yn(O,"scan")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),a.jsx("span",{children:"Scan Barcode"})]}),a.jsxs("button",{onClick:()=>{const O=Se;Pe(null),Yn(O,"search")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Search Food"})]}),a.jsxs("button",{onClick:()=>{const O=Se;Pe(null),Yn(O,"manual")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),a.jsx("span",{children:"Manual Entry"})]}),a.jsxs("button",{onClick:()=>{const O=Se;Pe(null),Yn(O,"favourites")},children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),a.jsx("span",{children:"Favourites"})]})]})]})]}),L&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>P(!1),children:a.jsxs("div",{className:"nut-copy-from-popup",onClick:O=>O.stopPropagation(),children:[a.jsxs("div",{className:"nut-copy-from-header",children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",width:"20",height:"20",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),a.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),a.jsx("span",{children:"Copy from..."}),a.jsx("button",{className:"nut-modal-close",onClick:()=>P(!1),children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsx("p",{className:"nut-copy-from-hint",children:"Pick a day to copy its food log into today"}),a.jsxs("div",{className:"nut-cal-header",children:[a.jsx("button",{onClick:()=>Le(O=>{let q=O.month-1,oe=O.year;return q<0&&(q=11,oe--),{year:oe,month:q}}),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsxs("span",{children:[Ie[A.month]," ",A.year]}),a.jsx("button",{onClick:()=>Le(O=>{let q=O.month+1,oe=O.year;return q>11&&(q=0,oe++),{year:oe,month:q}}),disabled:A.year===new Date().getFullYear()&&A.month>=new Date().getMonth(),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-cal-days-header",children:Me.map(O=>a.jsx("span",{children:O},O))}),a.jsxs("div",{className:"nut-cal-grid",children:[[...Array(te(A.year,A.month))].map((O,q)=>a.jsx("span",{},`e${q}`)),[...Array(C(A.year,A.month))].map((O,q)=>{const oe=q+1,ne=`${A.year}-${String(A.month+1).padStart(2,"0")}-${String(oe).padStart(2,"0")}`,Ye=ne>Yr(),Ge=ne===Y,qe=ne===Yr(),ot=Ye||Ge;return a.jsx("button",{className:`nut-cal-day${Ge?" selected":""}${qe?" today":""}${Ye?" future":""}`,disabled:ot,onClick:()=>ue(ne),children:oe},oe)})]}),Ze&&a.jsxs("div",{className:"nut-copy-from-loading",children:[a.jsx("div",{className:"wk-loading-spinner"}),a.jsx("span",{children:"Copying..."})]})]})}),V&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>{fn(),Ue(null),ce(null),pt(null)},children:a.jsxs("div",{className:"nut-modal",onClick:O=>O.stopPropagation(),children:[a.jsxs("div",{className:"nut-modal-header",children:[a.jsx("h3",{children:V==="scan"?"Scan Barcode":V==="search"?"Search Food":V==="favourites"?"Favourites":"Manual Entry"}),a.jsx("button",{className:"nut-modal-close",onClick:()=>{fn(),Ue(null),ce(null),pt(null)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),V==="scan"&&!le&&a.jsxs("div",{className:"nut-scan-area",children:[a.jsxs("div",{className:"nut-scanner-wrapper",children:[a.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),je&&!ke&&a.jsx("div",{className:"nut-scan-line"}),ke&&a.jsxs("div",{className:"nut-scan-detected-overlay",children:[a.jsx("svg",{className:"nut-scan-detected-tick",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),a.jsx("p",{className:"nut-scan-detected-label",children:"Barcode found!"}),a.jsx("p",{className:"nut-scan-detected-code",children:ke})]})]}),!je&&a.jsxs("button",{className:"nut-scan-start-btn",onClick:Kt,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),je&&!ke&&a.jsx("p",{className:"nut-scan-hint",children:"Align barcode within the frame"}),a.jsx("div",{className:"nut-barcode-divider",children:a.jsx("span",{children:"or enter barcode manually"})}),a.jsxs("div",{className:"nut-barcode-manual",children:[a.jsx("input",{type:"text",inputMode:"numeric",value:$e,onChange:O=>Qe(O.target.value),onKeyDown:O=>O.key==="Enter"&&$e.trim()&&js($e.trim()),placeholder:"Enter barcode number"}),a.jsx("button",{onClick:()=>$e.trim()&&js($e.trim()),disabled:!$e.trim()||Je,children:Je?"...":"Look Up"})]}),a.jsxs("p",{className:"nut-off-credit",children:["Food data powered by ",a.jsx("a",{href:"https://openfoodfacts.org",target:"_blank",rel:"noopener noreferrer",children:"Open Food Facts"})]})]}),V==="scan"&&le&&(()=>{const O=le.servingUnit||"g",q=le.portion,oe=_t==="portion"&&q?yt*q.weight:parseFloat(Ht)||0,ne=oe/100,Ye=O==="ml"?[100,200,250,500]:[50,100,150,200],Ge=_t==="portion"&&q?`${yt} ${q.label}${yt!==1?"s":""} (${Math.round(oe)}${O})`:`${Math.round(oe)}${O}`;return a.jsxs("div",{className:"nut-product-result",children:[le.image&&a.jsx("img",{src:le.image,alt:le.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:le.name}),a.jsx("button",{className:`nut-fav-star confirm${dn(le.name)?" active":""}`,onClick:()=>hn({name:le.name,protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories,serving:le.servingSize,per100g:{protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories},servingUnit:le.servingUnit||"g",portion:le.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:dn(le.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),le.brand&&a.jsx("p",{className:"nut-product-brand",children:le.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",O,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[le.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[le.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[le.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[le.calories," cal"]})]}),q&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:_t==="portion"?"active":"",onClick:()=>{zt("portion"),yt<1&&gt(1)},children:"Portions"}),a.jsxs("button",{className:_t==="weight"?"active":"",onClick:()=>{zt("weight"),it(String(Math.round(oe)||100))},children:["Custom (",O,")"]})]}),_t==="portion"&&q?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>gt(Math.max(1,yt-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:yt}),a.jsxs("span",{className:"nut-stepper-label",children:[q.label,yt!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(oe),O]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>gt(yt+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",O,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:Ht,onChange:qe=>it(qe.target.value),onFocus:qe=>qe.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Ye.map(qe=>a.jsxs("button",{className:`nut-quick-btn${Ht===String(qe)?" active":""}`,onClick:()=>it(String(qe)),children:[qe,O]},qe))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(le.protein*ne),"p / ",Math.round(le.carbs*ne),"c / ",Math.round(le.fats*ne),"f / ",Math.round(le.calories*ne)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>{pt(null),ce("scan")},children:"Scan Again"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>On({name:le.name,protein:Math.round(le.protein*ne),carbs:Math.round(le.carbs*ne),fats:Math.round(le.fats*ne),calories:Math.round(le.calories*ne),serving:Ge}),children:"Add"})]})]})})(),V==="search"&&!le&&a.jsxs("div",{className:"nut-search-area",children:[a.jsxs("div",{className:"nut-search-bar",children:[a.jsx("input",{type:"text",ref:Gt,value:It,onChange:O=>Cn(O.target.value),onKeyDown:O=>{O.key==="Enter"&&(clearTimeout(un.current),Kn())},onFocus:()=>setTimeout(()=>Gt.current?.scrollIntoView({behavior:"smooth",block:"center"}),350),placeholder:"Search food or product...",autoFocus:!0}),a.jsx("button",{onClick:Kn,disabled:Et,children:Et?"...":"Search"})]}),a.jsxs("div",{className:"nut-search-results",children:[ln.map((O,q)=>a.jsxs("button",{className:"nut-search-item",onClick:()=>{pt(O),O.portion?(gt(1),it(String(O.portion.weight)),zt("portion")):(gt(0),it(String(O.servingValue||100)),zt("weight"))},children:[O.image&&a.jsx("img",{src:O.image,alt:O.name||"Product",loading:"lazy"}),a.jsxs("div",{className:"nut-search-item-info",children:[a.jsx("span",{className:"nut-search-item-name",children:O.name}),O.brand&&a.jsx("span",{className:"nut-search-item-brand",children:O.brand}),a.jsxs("span",{className:"nut-search-item-macros",children:[O.calories," cal  ",O.protein,"p  ",O.carbs,"c  ",O.fats,"f per 100",O.servingUnit||"g"]})]})]},q)),ln.length===0&&It&&!Et&&a.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]}),a.jsxs("p",{className:"nut-off-credit",children:["Food data powered by ",a.jsx("a",{href:"https://openfoodfacts.org",target:"_blank",rel:"noopener noreferrer",children:"Open Food Facts"})]})]}),V==="search"&&le&&(()=>{const O=le.servingUnit||"g",q=le.portion,oe=_t==="portion"&&q?yt*q.weight:parseFloat(Ht)||0,ne=oe/100,Ye=O==="ml"?[100,200,250,500]:[50,100,150,200],Ge=_t==="portion"&&q?`${yt} ${q.label}${yt!==1?"s":""} (${Math.round(oe)}${O})`:`${Math.round(oe)}${O}`;return a.jsxs("div",{className:"nut-product-result",children:[le.image&&a.jsx("img",{src:le.image,alt:le.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:le.name}),a.jsx("button",{className:`nut-fav-star confirm${dn(le.name)?" active":""}`,onClick:()=>hn({name:le.name,protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories,serving:le.servingSize,per100g:{protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories},servingUnit:le.servingUnit||"g",portion:le.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:dn(le.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),le.brand&&a.jsx("p",{className:"nut-product-brand",children:le.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",O,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[le.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[le.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[le.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[le.calories," cal"]})]}),q&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:_t==="portion"?"active":"",onClick:()=>{zt("portion"),yt<1&&gt(1)},children:"Portions"}),a.jsxs("button",{className:_t==="weight"?"active":"",onClick:()=>{zt("weight"),it(String(Math.round(oe)||100))},children:["Custom (",O,")"]})]}),_t==="portion"&&q?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>gt(Math.max(1,yt-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:yt}),a.jsxs("span",{className:"nut-stepper-label",children:[q.label,yt!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(oe),O]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>gt(yt+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",O,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:Ht,onChange:qe=>it(qe.target.value),onFocus:qe=>qe.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Ye.map(qe=>a.jsxs("button",{className:`nut-quick-btn${Ht===String(qe)?" active":""}`,onClick:()=>it(String(qe)),children:[qe,O]},qe))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(le.protein*ne),"p / ",Math.round(le.carbs*ne),"c / ",Math.round(le.fats*ne),"f / ",Math.round(le.calories*ne)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>pt(null),children:"Back to Search"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>On({name:le.name,protein:Math.round(le.protein*ne),carbs:Math.round(le.carbs*ne),fats:Math.round(le.fats*ne),calories:Math.round(le.calories*ne),serving:Ge}),children:"Add"})]})]})})(),V==="manual"&&a.jsxs("div",{className:"nut-manual-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Food Name"}),a.jsx("input",{type:"text",value:Tt.name,onChange:O=>dt(q=>({...q,name:O.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Serving Size (optional)"}),a.jsx("input",{type:"text",value:Tt.serving,onChange:O=>dt(q=>({...q,serving:O.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),a.jsxs("div",{className:"nut-manual-macros",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Protein (g)"}),a.jsx("input",{type:"number",value:Tt.protein,onChange:O=>dt(q=>({...q,protein:O.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Carbs (g)"}),a.jsx("input",{type:"number",value:Tt.carbs,onChange:O=>dt(q=>({...q,carbs:O.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fats (g)"}),a.jsx("input",{type:"number",value:Tt.fats,onChange:O=>dt(q=>({...q,fats:O.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Calories"}),a.jsx("input",{type:"number",value:Tt.calories,onChange:O=>dt(q=>({...q,calories:O.target.value})),min:"0"})]})]}),a.jsx("button",{className:"nut-btn-primary",disabled:!Tt.name.trim(),onClick:()=>On({name:Tt.name,protein:parseFloat(Tt.protein)||0,carbs:parseFloat(Tt.carbs)||0,fats:parseFloat(Tt.fats)||0,calories:parseFloat(Tt.calories)||0,serving:Tt.serving||""}),children:"Add Food"})]}),V==="favourites"&&!le&&(()=>{const O=lt(),q=oe=>{if(oe.per100g){const ne=oe.per100g;pt({name:oe.name,brand:"",image:null,servingSize:oe.serving||"100g",servingValue:100,servingUnit:oe.servingUnit||"g",portion:oe.portion||null,protein:ne.protein,carbs:ne.carbs,fats:ne.fats,calories:ne.calories,per100g:!0}),oe.portion?(gt(1),it(String(oe.portion.weight)),zt("portion")):(gt(0),it("100"),zt("weight"))}else On({name:oe.name,protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories,serving:oe.serving||""})};return a.jsx("div",{className:"nut-recent-area",children:O.length===0?a.jsx("p",{className:"nut-search-empty",children:"No favourites yet. Tap the star on any food to save it here."}):a.jsx("div",{className:"nut-recent-list",children:O.map((oe,ne)=>a.jsxs("div",{className:"nut-recent-item-row",children:[a.jsx("button",{className:"nut-fav-star active",onClick:Ye=>{Ye.stopPropagation(),hn(oe)},children:a.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("button",{className:"nut-recent-item",onClick:()=>q(oe),children:[a.jsxs("div",{className:"nut-recent-item-info",children:[a.jsx("span",{className:"nut-recent-item-name",children:oe.name}),a.jsx("span",{className:"nut-recent-item-serving",children:oe.serving||""})]}),a.jsxs("span",{className:"nut-recent-item-macros",children:[oe.calories," cal"]})]})]},ne))})})})(),V==="favourites"&&le&&(()=>{const O=le.servingUnit||"g",q=le.portion,oe=_t==="portion"&&q?yt*q.weight:parseFloat(Ht)||0,ne=oe/100,Ye=O==="ml"?[100,200,250,500]:[50,100,150,200],Ge=_t==="portion"&&q?`${yt} ${q.label}${yt!==1?"s":""} (${Math.round(oe)}${O})`:`${Math.round(oe)}${O}`;return a.jsxs("div",{className:"nut-product-result",children:[a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:le.name}),a.jsx("button",{className:`nut-fav-star confirm${dn(le.name)?" active":""}`,onClick:()=>hn({name:le.name,protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories,serving:le.servingSize,per100g:{protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories},servingUnit:le.servingUnit||"g",portion:le.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:dn(le.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",O,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[le.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[le.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[le.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[le.calories," cal"]})]}),q&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:_t==="portion"?"active":"",onClick:()=>{zt("portion"),yt<1&&gt(1)},children:"Portions"}),a.jsxs("button",{className:_t==="weight"?"active":"",onClick:()=>{zt("weight"),it(String(Math.round(oe)||100))},children:["Custom (",O,")"]})]}),_t==="portion"&&q?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>gt(Math.max(1,yt-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:yt}),a.jsxs("span",{className:"nut-stepper-label",children:[q.label,yt!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(oe),O]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>gt(yt+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",O,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:Ht,onChange:qe=>it(qe.target.value),onFocus:qe=>qe.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Ye.map(qe=>a.jsxs("button",{className:`nut-quick-btn${Ht===String(qe)?" active":""}`,onClick:()=>it(String(qe)),children:[qe,O]},qe))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(le.protein*ne),"p / ",Math.round(le.carbs*ne),"c / ",Math.round(le.fats*ne),"f / ",Math.round(le.calories*ne)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>pt(null),children:"Back to Favourites"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>On({name:le.name,protein:Math.round(le.protein*ne),carbs:Math.round(le.carbs*ne),fats:Math.round(le.fats*ne),calories:Math.round(le.calories*ne),serving:Ge}),children:"Add"})]})]})})()]})}),a.jsx(ni,{active:"nutrition"}),Zn&&a.jsx("div",{className:`toast-notification ${Zn.type}`,children:Zn.message}),a.jsx(Wl,{badge:k,onDismiss:()=>E(null)})]})})}async function U3(s){const{type:e="workout",title:t="Workout Complete!",stats:i=[],badges:l=[],badgeImage:u,badgeDesc:d}=s,g=1080,y=1920,p=document.createElement("canvas");p.width=g,p.height=y;const b=p.getContext("2d"),k="#2a2a28",E="#ffffff",M="#A12F3A",H="#1a1a1a",K="#555555";b.fillStyle=k,b.fillRect(0,0,g,y);const B=Math.round(g*.82),Y=Math.round(y*.75),ee=Math.round((g-B)/2),ae=Math.round((y-Y)/2),ye=28,ve=5;b.save(),b.shadowColor="rgba(0, 0, 0, 0.45)",b.shadowBlur=40,b.shadowOffsetY=10,Yw(b,ee,ae,B,Y,ye),b.fillStyle=E,b.fill(),b.restore(),b.save(),Yw(b,ee,ae,B,Y,ye),b.strokeStyle=M,b.lineWidth=ve,b.stroke(),b.restore();const he=220,D=50,T=52,I=68,U=10,L=36,P=48,A=30,Le=34,Ze=46,J=30,Te=28;b.font=`bold ${T}px 'Orbitron', sans-serif`;const He=nu(b,t.toUpperCase(),B-100);b.font=`500 ${L}px 'Montserrat', sans-serif`;let Se=[];e==="badge"&&d?Se=nu(b,d,B-120):e==="badge"&&l.length>0?Se=nu(b,l.join("    "),B-120):i.length>0&&(Se=nu(b,i.map(Et=>`${Et.value} ${Et.label}`).join("    "),B-120));const Pe=e==="badge"?"I just earned a badge on Core Buddy ":e==="habits"?"I just completed my daily habits with Core Buddy ":"I just completed a workout using Core Buddy ";b.font=`bold ${Le}px 'Montserrat', sans-serif`;const V=nu(b,Pe,B-80);let ce=He.length*I;Se.length>0&&(ce+=U+Se.length*P),ce+=A+V.length*Ze,ce+=J+Te;const Ce=ae+Y-60-ce,Ue=ae+40,$e=Ce-D,Qe=g/2,Je=(Ue+$e)/2,Wt=e==="badge"&&u?u:"/Logo.webp";b.save();const It=e==="badge"?"rgba(255, 193, 7, 0.15)":"rgba(161, 47, 58, 0.12)",Cn=b.createRadialGradient(Qe,Je,he*.6,Qe,Je,he*1.5);Cn.addColorStop(0,It),Cn.addColorStop(1,"rgba(0, 0, 0, 0)"),b.fillStyle=Cn,b.fillRect(Qe-he*1.5,Je-he*1.5,he*3,he*3),b.restore(),b.beginPath(),b.arc(Qe,Je,he+6,0,Math.PI*2),b.fillStyle=E,b.fill();const ln=e==="badge"?"#ffc107":M;b.beginPath(),b.arc(Qe,Je,he,0,Math.PI*2),b.strokeStyle=ln,b.lineWidth=5,b.stroke();try{const Et=await B3(Wt);b.save(),b.beginPath(),b.arc(Qe,Je,he-6,0,Math.PI*2),b.clip();const pn=(he-6)*2;b.drawImage(Et,Qe-he+6,Je-he+6,pn,pn),b.restore()}catch{b.textAlign="center",b.textBaseline="middle",b.fillStyle=M,b.font="bold 80px 'Orbitron', sans-serif",b.fillText(e==="badge"?"":"MCF",Qe,Je)}let qt=Ce;b.textAlign="center",b.textBaseline="alphabetic",b.fillStyle=H,b.font=`bold ${T}px 'Orbitron', sans-serif`;for(const Et of He)b.fillText(Et,g/2,qt),qt+=I;if(Se.length>0){qt+=U,b.fillStyle=K,b.font=`500 ${L}px 'Montserrat', sans-serif`;for(const Et of Se)b.fillText(Et,g/2,qt),qt+=P}qt+=A,b.fillStyle=H,b.font=`bold ${Le}px 'Montserrat', sans-serif`;for(const Et of V)b.fillText(Et,g/2,qt),qt+=Ze;return qt+=J,b.fillStyle=M,b.font=`600 ${Te}px 'Montserrat', sans-serif`,b.fillText("Make It Count with Core Buddy",g/2,qt),new Promise(Et=>{p.toBlob(pn=>Et(pn),"image/png")})}function Yw(s,e,t,i,l,u){s.beginPath(),s.moveTo(e+u,t),s.lineTo(e+i-u,t),s.quadraticCurveTo(e+i,t,e+i,t+u),s.lineTo(e+i,t+l-u),s.quadraticCurveTo(e+i,t+l,e+i-u,t+l),s.lineTo(e+u,t+l),s.quadraticCurveTo(e,t+l,e,t+l-u),s.lineTo(e,t+u),s.quadraticCurveTo(e,t,e+u,t),s.closePath()}function B3(s){return new Promise((e,t)=>{const i=new Image;i.crossOrigin="anonymous",i.onload=()=>e(i),i.onerror=t,i.src=s})}function nu(s,e,t){if(s.measureText(e).width<=t)return[e];const i=e.split(" "),l=[];let u="";for(const d of i){const g=u?`${u} ${d}`:d;s.measureText(g).width>t&&u?(l.push(u),u=d):u=g}return u&&l.push(u),l}function z3(){const s=w.useRef(null),e=w.useCallback(()=>{if(!s.current)try{s.current=new(window.AudioContext||window.webkitAudioContext)}catch{}const u=s.current;return u?.state==="suspended"&&u.resume(),u},[]),t=w.useCallback(()=>{navigator.vibrate&&navigator.vibrate([40,60,30]);const u=e();if(!u)return;const d=u.currentTime,g=u.createBiquadFilter();g.type="lowpass",g.frequency.value=500,g.Q.value=.7,g.connect(u.destination);const y=u.createOscillator(),p=u.createGain();y.type="sine",y.frequency.value=50,p.gain.value=.3,p.gain.setTargetAtTime(0,d+.08,.04),y.connect(p).connect(g),y.start(d),y.stop(d+.2);const b=u.createOscillator(),k=u.createGain();b.type="sine",b.frequency.value=70,k.gain.value=.2,k.gain.setTargetAtTime(0,d+.22,.04),b.connect(k).connect(g),b.start(d+.15),b.stop(d+.35)},[e]),i=w.useCallback(()=>{navigator.vibrate&&navigator.vibrate(30);const u=e();if(!u)return;const d=u.currentTime,g=u.createBiquadFilter();g.type="lowpass",g.frequency.value=500,g.Q.value=.7,g.connect(u.destination);const y=u.createOscillator(),p=u.createGain();y.type="sine",y.frequency.value=55,p.gain.value=.35,p.gain.setTargetAtTime(0,d+.08,.04),y.connect(p).connect(g),y.start(d),y.stop(d+.2)},[e]),l=w.useCallback(()=>{navigator.vibrate&&navigator.vibrate([50,80,100]);const u=e();u&&[0,.12].forEach((d,g)=>{const y=u.createOscillator(),p=u.createGain();y.type="sine",y.frequency.value=g===0?523:784,p.gain.value=.12,p.gain.setTargetAtTime(0,u.currentTime+d+.15,.02),y.connect(p).connect(u.destination),y.start(u.currentTime+d),y.stop(u.currentTime+d+.2)})},[e]);return w.useEffect(()=>()=>{s.current?.close()},[]),{tap:i,tick:t,complete:l}}const F3=2e3,Wp=42,Ll=2*Math.PI*Wp,H3=1200,Qw=["Another one in the bank!","Consistency beats everything.","You showed up  that's what counts.","Stronger every session."];function Gp({title:s,subtitle:e,stats:t,onDone:i,onDismissStart:l,onShareJourney:u,userName:d,buttonLabel:g="Done",holdLabel:y="Hold To Complete Session",shareType:p="workout",hideShare:b=!1}){const[k,E]=w.useState("hold"),[M,H]=w.useState(!1),[K,B]=w.useState(0),[Y,ee]=w.useState(!1),[ae,ye]=w.useState(!1),[ve,he]=w.useState(null),D=z3(),T=w.useRef(null),I=w.useRef(null),U=w.useRef(null),L=w.useRef(null),P=w.useRef(!1),A=w.useRef(!1),Le=w.useRef(0),Ze=w.useRef(Qw[Math.floor(Math.random()*Qw.length)]),J=w.useRef([...Array(80)].map((ke,Ue)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#ffffff","#000000"][Ue%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:Ue%3}))),Te=w.useCallback(()=>{if(P.current)return;P.current=!0,A.current=!1,Le.current=0,H(!0),B(0),L.current=performance.now(),D.tap(),T.current&&(T.current.style.strokeDashoffset=Ll);const ke=Ue=>{const $e=Ue-L.current,Qe=Math.min($e/F3,1);if(T.current&&(T.current.style.strokeDashoffset=Ll-Qe*Ll),I.current){const Je=8*(1-Qe),Wt=1-Qe,It=1+Qe*.15;I.current.style.filter=`blur(${Je}px) grayscale(${Wt})`,I.current.style.transform=`scale(${It})`}B(Qe),$e-Le.current>=H3&&(Le.current=$e,D.tick()),Qe<1?U.current=requestAnimationFrame(ke):(P.current=!1,A.current=!0,U.current=null,H(!1),B(1),D.complete(),E("celebrate"))};U.current=requestAnimationFrame(ke)},[D]),He=w.useCallback(()=>{P.current&&(P.current=!1,U.current&&(cancelAnimationFrame(U.current),U.current=null),T.current&&(T.current.style.strokeDashoffset=Ll),I.current&&(I.current.style.filter="",I.current.style.transform=""),H(!1),B(0))},[]),Se=w.useCallback(()=>{ee(!0),l?.(),setTimeout(()=>{i?.()},300)},[i,l]),Pe=w.useCallback(()=>{const ke=[s||"Workout Complete!"];return e&&ke.push(e),t?.length&&ke.push(t.map(Ue=>`${Ue.value} ${Ue.label}`).join(" | ")),ke.push("#MindCoreFitness"),ke.join(`
`)},[s,e,t]),V=w.useCallback(async()=>{if(!(ae||!u))try{await u({type:p==="habits"?"habits_summary":"workout_summary",title:s||"Workout Complete!",subtitle:e,stats:t||[],quote:Ze.current}),ye(!0),he("Posted to Journey!"),setTimeout(()=>he(null),2500)}catch(ke){console.error("Journey post failed:",ke),he(ke?.message||"Failed to post"),setTimeout(()=>he(null),3500)}},[ae,u,s,e,t]),[ce,je]=w.useState(!1),Ce=w.useCallback(async()=>{je(!0);try{const ke=await U3({type:p||"workout",title:s||"Workout Complete!",subtitle:e,stats:t||[],quote:Ze.current,userName:d}),Ue=Pe();if(navigator.share&&navigator.canShare?.({files:[new File([ke],"workout.png",{type:"image/png"})]})){const $e=new File([ke],"workout.png",{type:"image/png"});await navigator.share({title:"Mind Core Fitness",text:Ue,files:[$e]})}else navigator.share?await navigator.share({title:"Mind Core Fitness",text:Ue}):(await navigator.clipboard.writeText(Ue),he("Copied to clipboard!"),setTimeout(()=>he(null),2500))}catch{try{await navigator.clipboard.writeText(Pe()),he("Copied to clipboard!"),setTimeout(()=>he(null),2500)}catch{}}finally{je(!1)}},[s,e,t,d,Pe]);return k==="hold"?a.jsxs("div",{className:"wc-hold-page",children:[a.jsx("div",{className:"wc-hold-glow","aria-hidden":"true"}),a.jsx("p",{className:"wc-hold-label",children:y}),a.jsxs("div",{className:`wc-hold-ring-touch ${M?"wc-holding":""}`,onPointerDown:ke=>{ke.preventDefault(),Te()},onPointerUp:He,onPointerLeave:He,onPointerCancel:He,onClick:ke=>{ke.stopPropagation(),A.current&&(A.current=!1)},role:"button",tabIndex:0,"aria-label":"Press and hold to finish workout",onKeyDown:ke=>{(ke.key==="Enter"||ke.key===" ")&&(ke.preventDefault(),D.complete(),E("celebrate"))},children:[a.jsx("div",{className:"wc-hold-ring-glow","aria-hidden":"true"}),a.jsxs("svg",{className:"wc-hold-ring-svg",viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"wc-hold-ring-track",cx:"50",cy:"50",r:Wp}),a.jsx("circle",{className:"wc-hold-ring-fill",ref:T,cx:"50",cy:"50",r:Wp,style:{strokeDasharray:Ll,strokeDashoffset:Ll}})]}),a.jsx("img",{ref:I,src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-hold-logo",draggable:!1})]})]}):a.jsxs("div",{className:`wc-celeb-overlay ${Y?"wc-celeb-dismissing":""}`,children:[a.jsx("div",{className:"wc-celeb-confetti","aria-hidden":"true",children:J.current.map((ke,Ue)=>a.jsx("span",{className:`wc-celeb-confetti-piece wc-confetti-shape-${ke.shape}`,style:{"--x":`${ke.x}%`,"--delay":`${ke.delay}s`,"--color":ke.color,"--drift":`${ke.drift}px`,"--spin":`${ke.spin}deg`,"--duration":`${ke.duration}s`,width:`${ke.width}px`,height:`${ke.height}px`}},Ue))}),a.jsxs("div",{className:"wc-celeb-content",children:[a.jsx("div",{className:"wc-celeb-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-celeb-logo-img"})}),a.jsx("h2",{className:"wc-celeb-heading",children:s||"Congratulations!"}),e&&a.jsx("p",{className:"wc-celeb-subtext",children:e}),a.jsx("p",{className:"wc-celeb-quote",children:Ze.current}),t&&t.length>0&&a.jsx("div",{className:"wc-celeb-stats-row",children:t.map((ke,Ue)=>a.jsxs("div",{className:"wc-celeb-stat",children:[a.jsx("span",{className:"wc-celeb-stat-val",children:ke.value}),a.jsx("span",{className:"wc-celeb-stat-label",children:ke.label})]},Ue))}),!b&&a.jsxs("div",{className:"wc-share-row",children:[u&&a.jsxs("button",{className:`wc-share-btn wc-share-journey ${ae?"wc-share-done":""}`,onClick:V,disabled:ae,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 20h9"}),a.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),ae?"Posted!":"Post to Journey"]}),a.jsxs("button",{className:"wc-share-btn wc-share-external",onClick:Ce,disabled:ce,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"18",cy:"5",r:"3"}),a.jsx("circle",{cx:"6",cy:"12",r:"3"}),a.jsx("circle",{cx:"18",cy:"19",r:"3"}),a.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),a.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),ce?"Generating...":"Share"]})]}),a.jsx("button",{className:"wc-celeb-btn",onClick:Se,children:g}),ve&&a.jsx("div",{className:"wc-share-toast",children:ve})]})]})}const Xw="/login/assets/randomiser-glq9YJkL.jpg",Jw="/login/assets/programme-card-workout-CnNzTYkz.webp",q3="/login/assets/prog-fullbody-4wk-r6m9HJys.jpg",$3="/login/assets/muscle-group-arms-C9AdZL4-.png",W3="/login/assets/arms-bicep-BUrmT1o-.png",G3="/login/assets/arms-tricep-D9tAnFnS.png",K3="/login/assets/arms-full-arms-BY3TvpJm.png",Y3="/login/assets/muscle-group-chest-Cxfuc7XI.png",Q3="/login/assets/chest-strength-BR4BAFTH.png",X3="/login/assets/chest-hypertrophy-B8yNrvjB.png",J3="/login/assets/chest-endurance-e-OSWtWO.png",Z3="/login/assets/muscle-group-shoulders-DibNtCLF.png",e5="/login/assets/shoulders-strength-CKlZBF5A.png",t5="/login/assets/shoulders-hypertrophy-BUd76jiS.png",n5="/login/assets/shoulders-endurance-HuqNG5rD.png",s5="/login/assets/muscle-group-core-CPR-bdRg.png",r5="/login/assets/core-lower-abs-TVcqGMFJ.png",i5="/login/assets/core-obliques-rotation-Djb7Qlbk.png",a5="/login/assets/core-weighted-core-4Kwh9mTv.png",o5="/login/assets/muscle-group-back-8JPV-YUo.png",l5="/login/assets/back-strength-BmSRxnwo.png",c5="/login/assets/back-hypertrophy-CXHmsnCz.png",u5="/login/assets/back-endurance-C8qJ8l5I.png",d5="/login/assets/muscle-group-legs-B8jcbdov.png",h5="/login/assets/legs-quads-DbnfsebI.png",f5="/login/assets/legs-hamstrings-glutes-BrfsvvzX.png",m5="/login/assets/legs-power-plyo-D2qBXeUR.png",g5=60,tp=5,p5={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},y5={fullbody:"linear-gradient(160deg, rgba(153,49,60,0.15) 0%, rgba(153,49,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",upper:"linear-gradient(160deg, rgba(100,60,140,0.2) 0%, rgba(100,60,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",lower:"linear-gradient(160deg, rgba(40,120,80,0.2) 0%, rgba(40,120,80,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)"},np={arms:"linear-gradient(160deg, rgba(180,60,60,0.2) 0%, rgba(180,60,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",chest:"linear-gradient(160deg, rgba(50,100,160,0.2) 0%, rgba(50,100,160,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",back:"linear-gradient(160deg, rgba(80,130,60,0.2) 0%, rgba(80,130,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",shoulders:"linear-gradient(160deg, rgba(160,100,40,0.2) 0%, rgba(160,100,40,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",legs:"linear-gradient(160deg, rgba(100,50,140,0.2) 0%, rgba(100,50,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)"},sp=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,level:"All Levels",daysPerWeek:3,image:q3},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,level:"Intermediate",daysPerWeek:3},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,level:"Advanced",daysPerWeek:3},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,level:"Beginner",daysPerWeek:3},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,level:"Intermediate",daysPerWeek:3},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,level:"Advanced",daysPerWeek:3},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,level:"Intermediate",daysPerWeek:3},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,level:"Intermediate",daysPerWeek:3}],su=[{key:"arms",label:"Arms",icon:"M7 5h2v14H7V5zm8 0h2v14h-2V5zm-5 4h4v6h-4V9z",image:$3},{key:"chest",label:"Chest",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-2h2v2zm4 0h-2v-2h2v2zm3-6c0 1.1-.36 2.12-.97 2.95l-.87-.87C16.7 12.53 17 11.8 17 11c0-2.76-2.24-5-5-5S7 8.24 7 11c0 .8.3 1.53.84 2.08l-.87.87A4.977 4.977 0 0 1 6 11c0-3.31 2.69-6 6-6s6 2.69 6 6z",image:Y3},{key:"back",label:"Back",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm4 18H8v-6l-4-4 1.41-1.41L8 11.17V8h8v3.17l2.59-2.58L20 10l-4 4v6z",image:o5},{key:"shoulders",label:"Shoulders",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",image:Z3},{key:"legs",label:"Legs",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z",image:d5},{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",image:s5}],Zw={chest:[{id:"chest_strength",name:"Chest Strength",desc:"Heavy pressing for max strength",image:Q3,level:"Intermediate",overview:"A heavy pressing session designed to build raw chest strength. Focus on controlled negatives and powerful pressing movements.",tips:["Go heavy  pick a weight where the last 2 reps are a real challenge","Control the negative (lowering phase) for 2-3 seconds","Keep your shoulder blades squeezed together throughout all pressing movements","Rest 90-120 seconds between sets to allow full recovery"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Squeeze Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"chest_hypertrophy",name:"Chest Hypertrophy",desc:"Volume training for muscle growth",image:X3,level:"Intermediate",overview:"A high-volume chest session focused on time under tension and muscle growth. Lighter weights, more reps, and slow controlled movements.",tips:["Use moderate weight  you should feel the burn by rep 10","Squeeze your chest at the top of every rep for 1 second","Keep rest periods short at 60-90 seconds to keep the pump going","On press ups, go to failure on the final set"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Press Up",type:"reps",sets:3,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"}]},{id:"chest_endurance",name:"Chest Endurance",desc:"Bodyweight pushing to failure",image:J3,level:"All Levels",overview:"No weights needed. This bodyweight-only session builds chest endurance and muscular stamina through high-rep push up variations.",tips:["Focus on full range of motion  chest to floor on every rep","Keep your core tight and body in a straight line throughout","Scale down to knee press ups if you can't maintain form","Push through the burn  the last 5 reps are where the growth happens"],exercises:[{name:"Press Up",type:"reps",sets:4,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null},{name:"Decline Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Press Up Hold",type:"timed",sets:3,time:30,storagePath:null}]}],back:[{id:"back_strength",name:"Back Strength",desc:"Heavy rows for a thick back",image:l5,level:"Intermediate",overview:"Build a thick, powerful back with heavy rowing movements. This session targets your lats, rhomboids, and traps for overall back development.",tips:["Go heavy on rows  use a weight that challenges you by rep 6-8","Drive your elbows back and squeeze your shoulder blades together at the top","Keep a slight bend in your knees and hinge at the hips for bent over movements","Rest 90-120 seconds between sets for full recovery"],exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"back_hypertrophy",name:"Back Hypertrophy",desc:"Width and thickness volume work",image:c5,level:"Intermediate",overview:"A volume-focused back session combining rows and isolation moves to build width and thickness. Focus on the mind-muscle connection.",tips:["Use moderate weight  feel the stretch and squeeze on every rep","On renegade rows, keep your hips square to the floor and avoid rotating","For reverse flys, use lighter weight and focus on squeezing your rear delts","Keep rest to 60-90 seconds to maintain intensity"],exercises:[{name:"Renegade Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Reverse Fly",type:"weighted",sets:3,reps:15,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null}]},{id:"back_endurance",name:"Back Endurance",desc:"Bodyweight back conditioning",image:u5,level:"All Levels",overview:"A bodyweight session to strengthen your posterior chain and improve posture. Great for back health, mobility, and muscular endurance.",tips:["On superman holds, lift your arms and legs simultaneously and hold tight","Focus on slow, controlled movements  quality over speed","Breathe steadily throughout timed holds  don't hold your breath","Engage your glutes and lower back together on every movement"],exercises:[{name:"Superman Hold",type:"timed",sets:4,time:30,storagePath:"exercises/bodyweight/upper/Superman Hold.mp4"},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:12,storagePath:null},{name:"Reverse Snow Angel",type:"reps",sets:3,reps:12,storagePath:null},{name:"Bird Dog",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Back Extension Hold",type:"timed",sets:3,time:30,storagePath:null}]}],shoulders:[{id:"shoulders_strength",name:"Shoulder Strength",desc:"Heavy pressing for boulder shoulders",image:e5,level:"Intermediate",overview:"A heavy overhead pressing session to build strong, powerful shoulders. Compound movements first, followed by isolation work for all three delt heads.",tips:["Go heavy on presses  pick a weight where you struggle on the last 2 reps","Brace your core and avoid arching your back during overhead movements","Press straight up and control the weight down slowly","Rest 90-120 seconds between pressing sets, 60 seconds for isolation moves"],exercises:[{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"shoulders_hypertrophy",name:"Shoulder Hypertrophy",desc:"Volume and isolation for 3D delts",image:t5,level:"Intermediate",overview:"A high-volume session targeting all three heads of the deltoid for that 3D capped shoulder look. Moderate weight, high reps, constant tension.",tips:["Use lighter weight than you think  shoulders respond best to high reps","On lateral raises, lead with your elbows and don't swing the weight","Pause at the top of each raise for a 1-second squeeze","Keep rest periods at 60 seconds to maximise the pump"],exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Y-Raise",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"shoulders_endurance",name:"Shoulder Endurance",desc:"Bodyweight and high-rep work",image:n5,level:"All Levels",overview:"A shoulder endurance session combining bodyweight movements with high-rep dumbbell work. Builds stamina, stability, and shoulder resilience.",tips:["On pike push ups, walk your feet close to your hands to increase the angle","For high-rep lateral raises, use a very light weight and focus on form","Wall walks are advanced  scale to pike push ups if needed","Keep your core braced throughout to protect your lower back"],exercises:[{name:"Pike Push Ups",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/upper/pike push ups.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,reps:20,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Wall Walks",type:"reps",sets:3,reps:6,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null},{name:"Shoulder Tap Hold",type:"timed",sets:3,time:30,storagePath:null}]}],arms:[{id:"arms_bicep",name:"Bicep Focus",desc:"Curl variations for peak biceps",image:W3,level:"All Levels",overview:"An arm session dedicated entirely to biceps. Multiple curl variations target different parts of the bicep for maximum peak and thickness.",tips:["Keep your elbows pinned to your sides  no swinging","Control the negative (lowering) for 2-3 seconds on every rep","Start with your heaviest weight and decrease as you fatigue","Squeeze hard at the top of each curl for a full contraction"],exercises:[{name:"Bicep Curl",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Concentration Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Isometric Bicep Hold",type:"timed",sets:3,time:20,storagePath:null}]},{id:"arms_tricep",name:"Tricep Focus",desc:"Extensions and dips for horseshoe triceps",image:G3,level:"All Levels",overview:"All-out tricep training with extensions, dips, and pressing movements. The triceps make up two-thirds of your arm  this session builds serious size.",tips:["On overhead extensions, keep your elbows close to your head","For skullcrushers, lower the weight slowly to just above your forehead","On dips, lean slightly forward to reduce shoulder strain","Full lockout at the top of every extension for maximum tricep contraction"],exercises:[{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Tricep Dips",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null}]},{id:"arms_full",name:"Full Arms",desc:"Superset biceps and triceps",image:K3,level:"All Levels",overview:"A balanced arm session alternating between biceps and triceps. Superset style keeps the intensity high and maximises the pump.",tips:["Superset each pair  do biceps then immediately hit triceps","Use moderate weight that lets you maintain strict form for all reps","Rest 60 seconds after each superset pair","Focus on the squeeze at the peak contraction of every rep"],exercises:[{name:"Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Wrist Curl",type:"weighted",sets:3,reps:15,storagePath:null}]}],legs:[{id:"legs_quad",name:"Quad Dominant",desc:"Squats and lunges for quad power",image:h5,level:"All Levels",overview:"A quad-focused leg session built around squats and lunges. Heavy compound movements to build strong, powerful quads and overall leg strength.",tips:["On goblet squats, hold the dumbbell close to your chest and sit deep","Keep your knees tracking over your toes  don't let them cave inward","Drive through your heels on all squatting movements","Rest 90-120 seconds between heavy sets, 60 seconds on bodyweight moves"],exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/lower/bulgarian split squats.mp4"},{name:"Squat And Hold",type:"timed",sets:3,time:30,storagePath:"exercises/bodyweight/lower/squat and hold.mp4"}]},{id:"legs_ham_glute",name:"Hamstring & Glute",desc:"Posterior chain focus",image:f5,level:"Intermediate",overview:"Target the back of your legs with deadlift and hip hinge variations. This session builds a strong posterior chain  hamstrings, glutes, and lower back.",tips:["On RDLs, push your hips back and feel the stretch in your hamstrings","Keep a slight bend in your knees throughout hip hinge movements","Squeeze your glutes hard at the top of every rep","For single leg work, start with your weaker side first"],exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/romanian deadlifts.mp4"},{name:"1 Legged RDL",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.mp4"},{name:"Hip Thrusts",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/hip thrusts.mp4"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.mp4"},{name:"Donkey Kicks",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.mp4"}]},{id:"legs_power",name:"Power & Plyo",desc:"Explosive leg training",image:m5,level:"Intermediate",overview:"An explosive leg session combining plyometrics with weighted movements. Build power, speed, and athletic performance.",tips:["On jump squats, land softly with bent knees to absorb the impact","Explode up on every rep  power comes from speed, not just weight","Keep rest periods at 60-90 seconds to maintain intensity","Focus on landing mechanics  knees out, chest up, soft landing"],exercises:[{name:"Jump Squats",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/lower/jump squats.mp4"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Skater Jumps",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/skater jumps.mp4"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.mp4"}]}],core:[{id:"core_lower_abs",name:"Lower Abs Blast",desc:"40s work / 20s rest  3 rounds",image:r5,level:"Intermediate",overview:"An interval-based core burner targeting the lower abdominals. 40 seconds of work followed by 20 seconds of rest  keep the intensity high and your lower back pressed into the floor throughout.",tips:["Press your lower back firmly into the floor on every rep","Exhale hard as you contract your abs  don't hold your breath","If your lower back lifts off the ground, reduce the range of motion","Focus on slow, controlled movements rather than speed"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Leg Raises",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Reverse Crunch To Leg Raise",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Flutter Kicks",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Dead Bug Single Leg Drop",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Hollow Hold Flutter Kicks",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"}]},{id:"core_obliques",name:"Obliques & Rotation",desc:"35s work / 25s rest  3 rounds",image:i5,level:"Intermediate",overview:"Target the obliques and rotational core muscles with this interval session. 35 seconds of work with 25 seconds rest  every exercise involves twisting, rotating, or side-bracing movements.",tips:["Rotate from your ribcage, not just your arms","Keep your hips as still as possible during twisting exercises","Brace your core before each movement  think about squeezing a belt","On side planks, stack your hips and push the floor away"],interval:!0,rounds:3,work:35,rest:25,exercises:[{name:"Russian Twist",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank Rotation",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Cross Body Mountain Climbers",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Hip Dips Plank",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Bicycle Crunch",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank",storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{id:"core_weighted",name:"Weighted Core",desc:"40s work / 20s rest  3 rounds",image:a5,level:"Advanced",overview:"Add resistance to your core training with dumbbells and kettlebells. 40 seconds of weighted work followed by 20 seconds rest  this session builds serious core strength and stability.",tips:["Start with a moderate weight  form is more important than load","Brace your entire core before picking up the weight each round","Keep movements controlled  no swinging or using momentum","If grip fails before core does, go slightly lighter next time"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Russian Twists Dumbbell",storagePath:"exercises/dumbbells/core/russian twists dumbbell.mp4"},{name:"Kettlebell Russian Twist",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Dumbbell Plank Pull Through",storagePath:null}]}]},rp=[{key:"bodyweight",label:"Bodyweight",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"},{key:"dumbbells",label:"Dumbbells",icon:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"},{key:"kettlebells",label:"Kettlebells",icon:"M12 2C9.24 2 7 4.24 7 7c0 1.1.36 2.12.97 2.95C6.76 11.08 6 12.96 6 15c0 3.87 2.69 7 6 7s6-3.13 6-7c0-2.04-.76-3.92-1.97-5.05.61-.83.97-1.85.97-2.95 0-2.76-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}],Qr=[{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"},{key:"upper",label:"Upper",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"lower",label:"Lower",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"fullbody",label:"Full Body",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z"},{key:"mix",label:"Mix It Up",icon:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm-.83 9.41l-1.42 1.42L17.96 20.54l1.42-1.42-5.71-5.71z"}],Ai=[{key:"beginner",label:"Beginner",work:30,rest:30,desc:"30s work / 30s rest"},{key:"intermediate",label:"Intermediate",work:40,rest:20,desc:"40s work / 20s rest"},{key:"advanced",label:"Advanced",work:40,rest:15,desc:"40s work / 15s rest"}],ip=[5,10,15,20,30],v5=new Set(["single leg v-up","hollow hold to v-sit","reverse crunch to leg raise","side plank rotation","hip dips plank","alternating cross body v-up","alternating cross body v up","bent hollow hold","heels elevated glute bridge","hollow body hold","hollow body rock","star side plank","straddle leg lift","leg raise to hip lift","scorpion kicks","seated v hold"]),vh={core:"#e85d04",upper:"#2196f3",lower:"#4caf50",fullbody:"#9c27b0",mix:"#ff9800"},ex=["Mix up your focus areas to build balanced strength.","Consistency beats intensity  show up and press play.","Try a new difficulty level to keep your body guessing.","Short on time? A 5-minute blast still counts.","Save your favourite combos so you can replay them anytime.","Your body adapts  switch equipment for fresh stimulus.","Rest days are growth days. Listen to your body.","Challenge yourself: go one level higher this week."];function b5(s){return s.replace(/\b\w/g,e=>e.toUpperCase())}function w5(s){const e=[...s];for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}function x5({src:s,...e}){const t=w.useRef(null),[i,l]=w.useState(!1);return w.useEffect(()=>{const u=t.current;if(!u)return;const d=new IntersectionObserver(([g])=>{g.isIntersecting&&(l(!0),d.disconnect())},{rootMargin:"200px"});return d.observe(u),()=>d.disconnect()},[]),a.jsx("video",{ref:t,src:i?s:void 0,...e})}function _5(){const{currentUser:s,isClient:e,clientData:t,loading:i}=_r(),{isDark:l,toggleTheme:u}=Bi(),{isPremium:d,FREE_RANDOMISER_DURATIONS:g,FREE_RANDOMISER_WEEKLY_LIMIT:y}=dc(),p=Hs(),[b,k]=w.useState("randomiser_hub"),[E,M]=w.useState(["bodyweight"]),[H,K]=w.useState("core"),[B,Y]=w.useState("intermediate"),[ee,ae]=w.useState(d?15:5),[ye,ve]=w.useState([]),[he,D]=w.useState(!1),T=w.useRef(!1),I=w.useRef([]),U=w.useRef(""),[L,P]=w.useState([]),[A,Le]=w.useState(2),[Ze,J]=w.useState(Ai[1]),[Te,He]=w.useState(1),[Se,Pe]=w.useState(0),[V,ce]=w.useState("work"),[je,Ce]=w.useState(0),[ke,Ue]=w.useState(!1),[$e,Qe]=w.useState(0),[Je,Wt]=w.useState(!1),[It,Cn]=w.useState(!1),[ln,qt]=w.useState(null),Et=w.useRef(null);w.useRef(null),w.useRef(null);const[pn,Tt]=w.useState(null),dt=w.useCallback((R,F="info")=>{Tt({message:R,type:F}),setTimeout(()=>Tt(null),3e3)},[]),le=w.useCallback(async R=>{if(!t)throw new Error("Not signed in");const F=R&&typeof R=="object"&&R.type;await or(ut(pe,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:F?"":R,type:F?R.type:"text",imageURL:null,createdAt:xs(),likeCount:0,commentCount:0,...F?{metadata:{title:R.title||"",subtitle:R.subtitle||"",stats:R.stats||[],quote:R.quote||"",badges:R.badges||[]}}:{}})},[t]),[pt,Ht]=w.useState(null),[it,yt]=w.useState(null),[gt,_t]=w.useState(0),[zt,fs]=w.useState(0),[rn,Zn]=w.useState([]),[Fn,Ln]=w.useState(""),[Pn,un]=w.useState(""),[Gt,Ct]=w.useState(!1),[Mt,Z]=w.useState(0),[C,te]=w.useState(!1),[Re,Ie]=w.useState({}),Me=w.useRef(null),Fe=w.useRef(null),[Oe,Nt]=w.useState(0),[bt,lt]=w.useState(0),[dn,hn]=w.useState(0),[On,ms]=w.useState(0),[ue,De]=w.useState(0),[Ke,ct]=w.useState(0),[rt,Kt]=w.useState(null),[fn,At]=w.useState({beginner:0,intermediate:0,advanced:0}),St=d?ip:ip.filter(R=>g.includes(R)),bn=!d&&Oe>=y,[Ss,si]=w.useState([]),[xi,Or]=w.useState(!1),[js,hr]=w.useState({}),[Kn,os]=w.useState(!1),[ls,Vn]=w.useState(!1),[wn,es]=w.useState(""),[kr,qs]=w.useState(null),[Yn,jr]=w.useState([]),[ts,Vr]=w.useState({total:0,favouriteFocus:null,streak:0}),[O,q]=w.useState(null),[oe,ne]=w.useState(""),[Ye,Ge]=w.useState(!1);w.useEffect(()=>{!i&&(!s||!e)&&p("/")},[s,e,i,p]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const F=ut(pe,"workoutLogs"),$=tn(F,Ot("clientId","==",t.id)),me=(await $t($)).docs.map(mt=>mt.data()),be=me.filter(mt=>mt.type!=="programme");ms(be.length);const Ve=be.reduce((mt,gn)=>mt+(gn.duration||0),0);De(Ve);const nt={beginner:0,intermediate:0,advanced:0};be.forEach(mt=>{mt.level&&nt[mt.level]!==void 0&&nt[mt.level]++}),At(nt);const st=new Date,vt=st.getDay(),kt=vt===0?-6:1-vt,Xt=new Date(st);Xt.setDate(st.getDate()+kt),Xt.setHours(0,0,0,0);const Hn=Xt.getTime(),tt=me.filter(mt=>{const gn=mt.completedAt;return gn?(gn.toDate?gn.toDate().getTime():new Date(gn).getTime())>=Hn:!1});Nt(tt.filter(mt=>mt.type!=="programme").length);let mn=0;if(t)try{const mt=await _s(ze(pe,"clientProgrammes",t.id));if(mt.exists()){const gn=mt.data(),Xn=gn.templateId;mn=tt.filter(As=>As.type==="programme"&&As.programmeId===Xn).length,q(Xn);const tr=sp.find(As=>As.id===Xn);tr&&ne(tr.name);const Gs=p5[Xn];if(Gs){const As=Object.keys(gn.completedSessions||{}).length,nr=Gs.duration*Gs.daysPerWeek;hn(nr>0?Math.round(As/nr*100):0)}}else q(null),ne(""),hn(0)}catch{}lt(mn);const an=be.map(mt=>mt.completedAt).filter(Boolean).map(mt=>mt.toDate?mt.toDate().getTime():new Date(mt).getTime()).sort((mt,gn)=>gn-mt);if(an.length===0)ct(0);else{const mt=new Set;an.forEach(nr=>{const Sr=new Date(nr),yo=Sr.getDay(),sl=yo===0?-6:1-yo,ai=new Date(Sr);ai.setDate(Sr.getDate()+sl),ai.setHours(0,0,0,0),mt.add(ai.getTime())});const gn=[...mt].sort((nr,Sr)=>Sr-nr);let Xn=0;const tr=new Date(st),Gs=st.getDay()===0?-6:1-st.getDay();tr.setDate(st.getDate()+Gs),tr.setHours(0,0,0,0);let As=tr.getTime();gn.includes(As)||(As-=10080*60*1e3);for(let nr=0;nr<200&&gn.includes(As);nr++)Xn++,As-=10080*60*1e3;ct(Xn)}}catch(F){console.error("Error loading workout stats:",F)}finally{Ge(!0)}})()},[s,t,b]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const F=tn(ut(pe,"savedWorkouts"),Ot("clientId","==",t.id)),G=(await $t(F)).docs.map(me=>({id:me.id,...me.data()}));G.sort((me,be)=>{const Ve=me.savedAt?.toMillis?.()||me.savedAt?.seconds*1e3||0;return(be.savedAt?.toMillis?.()||be.savedAt?.seconds*1e3||0)-Ve}),si(G)}catch(F){console.error("Error loading saved workouts:",F)}finally{Or(!0)}})()},[s,t]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const F=tn(ut(pe,"workoutLogs"),Ot("clientId","==",t.id)),me=(await $t(F)).docs.map(tt=>tt.data()).sort((tt,mn)=>{const an=tt.completedAt?.toDate?.()||new Date(0);return(mn.completedAt?.toDate?.()||new Date(0))-an}).slice(0,20).filter(tt=>tt.type!=="programme"&&tt.type!=="muscle_group");jr(me.slice(0,3));const be=me.length,Ve={};me.forEach(tt=>{tt.focus&&(Ve[tt.focus]=(Ve[tt.focus]||0)+1)});const nt=Object.keys(Ve).sort((tt,mn)=>Ve[mn]-Ve[tt])[0]||null;let st=0;if(me.length>0){const tt=new Set;me.forEach(mt=>{const gn=mt.completedAt?.toDate?mt.completedAt.toDate():mt.completedAt?new Date(mt.completedAt):null;gn&&tt.add(new Date(gn.getFullYear(),gn.getMonth(),gn.getDate()).toDateString())});const mn=new Date;mn.setHours(0,0,0,0);let an=new Date(mn);for(tt.has(an.toDateString())||an.setDate(an.getDate()-1);tt.has(an.toDateString());)st++,an.setDate(an.getDate()-1)}Vr({total:be,favouriteFocus:nt,streak:st});const vt={core:null,upper:null,lower:null,fullbody:null};me.forEach(tt=>{if(tt.focus&&vt[tt.focus]===null&&tt.completedAt){const mn=tt.completedAt.toDate?tt.completedAt.toDate():new Date(tt.completedAt);vt[tt.focus]=mn}});let kt=null,Xt=new Date;const Hn=["core","upper","lower","fullbody"];for(const tt of Hn){if(vt[tt]===null){const mn=Qr.find(an=>an.key===tt)?.label||tt;kt={focus:tt,label:mn,daysAgo:null,message:`You haven't tried ${mn} yet`};break}if(vt[tt]<Xt){Xt=vt[tt];const mn=Math.floor((Date.now()-vt[tt].getTime())/864e5);if(mn>=5){const an=Qr.find(mt=>mt.key===tt)?.label||tt;kt={focus:tt,label:an,daysAgo:mn,message:`${an}  ${mn} days ago`}}}}qs(kt)}catch(F){console.error("Error loading recent workouts:",F)}})()},[s,t,b]);const qe=async R=>{if(!(!s||!t||L.length===0)){os(!0);try{const F=Qr.find(me=>me.key===H)?.label||H,$=R||`${F} ${ee}min`,G=await or(ut(pe,"savedWorkouts"),{clientId:t.id,name:$,equipment:E,focus:H,level:B,duration:ee,exercises:L.map(me=>({name:me.name,videoUrl:me.videoUrl,isGif:me.isGif||!1})),rounds:A,savedAt:Bt.now()});si(me=>[{id:G.id,clientId:t.id,name:$,equipment:E,focus:H,level:B,duration:ee,exercises:L.map(be=>({name:be.name,videoUrl:be.videoUrl,isGif:be.isGif||!1})),rounds:A,savedAt:Bt.now()},...me]),dt("Workout saved!","success")}catch(F){console.error("Error saving workout:",F),dt("Failed to save workout","error")}finally{os(!1),Vn(!1),es("")}}},ot=async R=>{try{await ar(ze(pe,"savedWorkouts",R)),si(F=>F.filter($=>$.id!==R)),dt("Workout removed","info")}catch(F){console.error("Error deleting saved workout:",F),dt("Failed to remove workout","error")}},Rt=R=>{M(R.equipment||["bodyweight"]),K(R.focus||"core"),Y(R.level||"intermediate"),ae(R.duration||15);const F=Ai.find($=>$.key===(R.level||"intermediate"));J(F),P(R.exercises||[]),Le(R.rounds||2),k("preview")},Nn=async()=>{const R=JSON.parse(localStorage.getItem("mcf_last_randomiser")||"null");M(R?.equipment||["bodyweight"]),K(R?.focus||"core"),Y(R?.level||"intermediate"),ae(R?.duration||15),setTimeout(()=>_i(),50)},Cs=()=>{localStorage.setItem("mcf_last_randomiser",JSON.stringify({equipment:E,focus:H,level:B,duration:ee}))};localStorage.getItem("mcf_last_randomiser");const Qn=()=>{const R=[];let F;H==="mix"?F=["core","upper","lower"]:H==="fullbody"?F=["upper","lower"]:F=[H];for(const $ of E)for(const G of F)R.push(`exercises/${$}/${G}`);return R},Ms="mcf_exercise_urls",ri=()=>{try{return JSON.parse(sessionStorage.getItem(Ms)||"{}")}catch{return{}}},Ds=R=>{try{sessionStorage.setItem(Ms,JSON.stringify(R))}catch{}},er=async()=>{if(T.current){for(;T.current;)await new Promise(F=>setTimeout(F,200));return I.current}const R=Qn().sort().join("|");if(I.current.length>0&&U.current===R)return I.current;T.current=!0,D(!0);try{const F=Qn(),$=[];for(const nt of F)try{const st=ca(ua,nt),vt=await $w(st);$.push(...vt.items)}catch{console.warn(`Folder ${nt} not found, skipping.`)}if($.length===0&&E.includes("bodyweight")&&H==="core")try{const nt=ca(ua,"core"),st=await $w(nt);$.push(...st.items)}catch{console.warn("Legacy core/ folder not found either.")}if($.length===0){const nt=E.map(vt=>rp.find(kt=>kt.key===vt)?.label).join(" + "),st=Qr.find(vt=>vt.key===H)?.label;return dt(`No exercises found for ${nt} / ${st}. Upload videos to Firebase Storage.`,"error"),T.current=!1,D(!1),[]}const G=new Set,me=$.filter(nt=>{const st=nt.name.replace(/\.(mp4|gif)$/i,"");return G.has(st)?!1:(G.add(st),!0)}),be=ri(),Ve=await Promise.all(me.map(async nt=>{const st=nt.fullPath;let vt=be[st];vt||(vt=await io(nt),be[st]=vt);const kt=b5(nt.name.replace(/\.(mp4|gif)$/i,"")),Xt=/\.gif$/i.test(nt.name);return{name:kt,videoUrl:vt,isGif:Xt}}));return Ds(be),I.current=Ve,U.current=R,ve(Ve),T.current=!1,D(!1),Ve}catch(F){console.error("Error loading exercises:",F);const $=F.code==="storage/unauthorized"?"Storage access denied. Check Firebase Storage rules allow read access.":`Failed to load exercises: ${F.message||F.code||"Unknown error"}`;return dt($,"error"),T.current=!1,D(!1),[]}},_i=async()=>{if(bn)return;Cs(),k("spinning");const R=await er();if(R.length===0){k("setup");return}const F=Ai.find(kt=>kt.key===B);J(F);const $=F.work+F.rest,G=ee*60,me=Math.floor(G/$);let be,Ve;me<=6?(be=Math.max(3,Math.floor(me/2)),Ve=Math.floor(me/be)):me<=12?(be=Math.min(6,Math.floor(me/2)),Ve=Math.floor(me/be)):(be=Math.min(10,Math.floor(me/2)),Ve=Math.floor(me/be)),Ve=Math.max(2,Ve);const nt=B==="beginner"?R.filter(kt=>!v5.has(kt.name.toLowerCase())):R,st=w5(nt),vt=st.slice(0,Math.min(be,st.length));P(vt),Le(Ve),setTimeout(()=>k("preview"),2e3)},Er=()=>{k("countdown"),Qe(3)};w.useEffect(()=>{if(b!=="countdown")return;if($e<=0){k("workout"),He(1),Pe(0),ce("work"),Ce(Ze.work),Ue(!1),Ls();return}Ws();const R=setTimeout(()=>Qe(F=>F-1),1e3);return()=>clearTimeout(R)},[$e,b]),w.useEffect(()=>{if(b!=="workout"||ke)return;if(je<=0){Ns();return}je<=3&&Ws();const R=setTimeout(()=>Ce(F=>F-1),1e3);return()=>clearTimeout(R)},[je,b,ke]);const Ns=()=>{if(V==="work")ce("rest"),Ce(Ze.rest);else{const R=Se+1;if(R>=L.length){const F=Te+1;if(F>A){Wt(!0),Ea();return}He(F),Pe(0)}else Pe(R);ce("work"),Ce(Ze.work),Ls()}},Ea=async()=>{if(s)try{await or(ut(pe,"workoutLogs"),{clientId:t.id,level:B,duration:ee,equipment:E,focus:H,exerciseCount:L.length,rounds:A,exercises:L.map(G=>G.name),completedAt:Bt.now()}),typeof fbq=="function"&&fbq("trackCustom","WorkoutCompleted",{duration:ee,level:B,focus_area:H,exercise_count:L.length}),Nt(G=>G+1);const R=On+1;ms(R),De(G=>G+ee),At(G=>({...G,[B]:(G[B]||0)+1}));let F=null;const $=[{count:1,id:"first_workout"},{count:10,id:"workouts_10"},{count:25,id:"workouts_25"},{count:50,id:"workouts_50"},{count:100,id:"workouts_100"}];for(const G of $)if(R>=G.count){const me=await ef(G.id,t);if(me){F=me;break}}if(!F){const G=Ke+(Oe===0?1:0),me=[{weeks:8,id:"streak_8"},{weeks:4,id:"streak_4"},{weeks:2,id:"streak_2"}];for(const be of me)if(G>=be.weeks){const Ve=await ef(be.id,t);if(Ve){F=Ve;break}}}F&&Kt(F)}catch(R){console.error("Error saving workout log:",R)}},zi=async(R,F,$)=>{if(!(!t||!F))try{const G=t.id,me=await _s(ze(pe,"coreBuddyPBs",G)),Ve=(me.exists()?me.data():null)?.exercises||{},nt=Ve[R];let st=!1;if(nt?(F>(nt.weight||0)||F===(nt.weight||0)&&$>(nt.reps||0))&&(st=!0):st=!0,st){const vt={...Ve,[R]:{weight:F,reps:$,achievedAt:Bt.now()}};await Wn(ze(pe,"coreBuddyPBs",G),{clientId:t.id,exercises:vt,updatedAt:Bt.now()}),dt(`New PB! ${F}kg  ${$} reps`,"success"),Ws()}}catch(G){console.error("Error checking PB:",G)}},ii=async R=>{if(yt(R),R.interval){const G=[];for(const me of R.exercises){let be=null,Ve=!1;if(me.storagePath)try{const nt=ca(ua,me.storagePath);be=await io(nt),Ve=/\.gif$/i.test(me.storagePath)}catch{}G.push({name:me.name,videoUrl:be,isGif:Ve})}P(G),Le(R.rounds),J({work:R.work,rest:R.rest}),k("preview");return}const F={};for(const G of R.exercises)if(G.storagePath)try{const me=ca(ua,G.storagePath);F[G.name]={url:await io(me),isGif:/\.gif$/i.test(G.storagePath)}}catch{}Ie(F);const $=R.exercises.map(G=>({name:G.name,type:G.type,targetSets:G.sets,targetReps:G.reps||0,targetTime:G.time||0,sets:[]}));Zn($),_t(0),fs(0),Ln(""),un(""),te(!1),Ct(!1),Z(0),setMgSessionBadges([]),setMgBadgeCelebration(null),k("muscle_workout")},ki=()=>{const R=Me.current;R&&(R.paused?(R.play(),te(!0)):(R.pause(),te(!1)))};w.useEffect(()=>{if(b!=="muscle_workout"||!Gt||Mt<=0){b==="muscle_workout"&&Gt&&Mt<=0&&(Ct(!1),Ws());return}return Fe.current=setTimeout(()=>Z(R=>R-1),1e3),()=>clearTimeout(Fe.current)},[b,Gt,Mt]);const Fi=async()=>{const R=rn[gt];let F={};if(R.type==="weighted"){const me=parseFloat(Fn)||0,be=parseInt(Pn)||0;if(be===0){dt("Enter your reps","error");return}F={weight:me,reps:be}}else if(R.type==="reps"){const me=parseInt(Pn)||0;if(me===0){dt("Enter your reps","error");return}F={reps:me}}else if(R.type==="timed"){const me=R.targetTime-Mt;F={time:Math.max(me,1)}}const $=[...rn];$[gt]={...R,sets:[...R.sets,F]},Zn($),R.type==="weighted"&&F.weight>0&&await zi(R.name,F.weight,F.reps);const G=R.sets.length+1;if(G<R.targetSets)fs(G),un(""),Ct(!1),Z(0);else if(gt+1<rn.length){const me=gt+1;_t(me),fs(0),Ln(""),un(""),te(!1),Ct(!1),Z(0)}else await Ur($),Cn(!0)},Ur=async R=>{if(!(!s||!t))try{const F=R.reduce(($,G)=>$+G.sets.length,0);await or(ut(pe,"workoutLogs"),{clientId:t.id,type:"muscle_group",muscleGroup:pt,sessionId:it?.id,sessionName:it?.name,exerciseCount:R.length,totalSets:F,duration:Math.round(F*1.5),exercises:R.map($=>({name:$.name,type:$.type,sets:$.sets})),completedAt:Bt.now()})}catch(F){console.error("Error saving muscle group workout log:",F)}},Tr=w.useRef(null),$s=()=>{(!Tr.current||Tr.current.state==="closed")&&(Tr.current=new(window.AudioContext||window.webkitAudioContext));const R=Tr.current;return R.state==="suspended"&&R.resume(),R},Ws=()=>{try{const R=$s(),F=R.createOscillator(),$=R.createGain();F.connect($),$.connect(R.destination),F.frequency.value=880,$.gain.value=.3,F.start(R.currentTime),F.stop(R.currentTime+.15)}catch{}},Ls=()=>{try{const R=$s(),F=R.createOscillator(),$=R.createGain();F.connect($),$.connect(R.destination),F.frequency.value=1200,$.gain.value=.4,F.start(R.currentTime),F.stop(R.currentTime+.3)}catch{}};w.useEffect(()=>{if(b!=="workout"||V!=="work"||!L[Se]?.isGif)return;const F=setInterval(()=>{const $=Et.current;if(!$)return;const G=$.getAttribute("src");$.removeAttribute("src"),setTimeout(()=>{Et.current&&Et.current.setAttribute("src",G)},0)},4e3);return()=>clearInterval(F)},[b,V,Se,Te,L]);const S=(R,F,$)=>{const G=Math.round(R/F*g5);return a.jsx("svg",{className:"wk-ring-svg",viewBox:"0 0 200 200",children:m3.map((me,be)=>a.jsx("line",{x1:me.x1,y1:me.y1,x2:me.x2,y2:me.y2,className:be<G?`wk-tick-filled ${$}`:"wk-tick-empty",strokeWidth:me.thick?"3":"2"},be))})},Q=()=>{const R=L.length*A;return((Te-1)*L.length+Se+(V==="rest"?.5:0))/R},Ae=pn&&a.jsx("div",{className:`toast-notification ${pn.type}`,children:pn.message});if(i)return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"wk-loading-inline",children:a.jsx("div",{className:"wk-loading-spinner"})})]});if(b==="menu")return a.jsx(nl,{children:a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"wk-menu-heading",children:[a.jsx("h2",{children:"Choose Your Workout"}),a.jsx("p",{children:"No excuses. Just results."})]}),a.jsx("button",{className:"wk-hero-card",onClick:()=>k("randomiser_hub"),children:a.jsx("img",{src:Xw,alt:"Randomise Workout",className:"wk-hero-bg"})}),!d&&a.jsxs("button",{className:"wk-hero-card wk-free-card-premium",onClick:()=>p("/upgrade"),children:[a.jsx("img",{src:Jw,alt:"Programmes",className:"wk-hero-bg"}),a.jsx("div",{className:"wk-free-card-overlay"}),a.jsxs("div",{className:"wk-free-card-content",children:[a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{className:"wk-free-card-label",children:"Unlock Full Access"})]})]}),d&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"wk-section-header",children:[a.jsx("h2",{children:"Programmes"}),a.jsxs("span",{className:"wk-section-count",children:[sp.length," available"]})]}),a.jsx("div",{className:"wk-prog-scroll-wrap",children:a.jsx("div",{className:"wk-prog-scroll",children:sp.map((R,F)=>R.image?a.jsxs("button",{className:"wk-prog-img-card",onClick:()=>p("/client/core-buddy/programmes",{state:{templateId:R.id}}),style:{animationDelay:`${F*.06}s`},children:[a.jsx("img",{src:R.image,alt:R.name,className:"wk-prog-img"}),F===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},R.id):a.jsxs("button",{className:"wk-prog-hero-card",onClick:()=>p("/client/core-buddy/programmes",{state:{templateId:R.id}}),style:{animationDelay:`${F*.06}s`},children:[a.jsx("img",{src:Jw,alt:"Programme",className:"wk-prog-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-prog-hero-overlay",style:{background:y5[R.focus]}}),a.jsxs("div",{className:"wk-prog-hero-content",children:[a.jsxs("div",{className:"wk-prog-hero-top",children:[a.jsxs("span",{className:"wk-prog-hero-badge",children:[R.duration," WEEKS"]}),a.jsx("span",{className:"wk-prog-hero-level",children:R.level})]}),a.jsxs("div",{className:"wk-prog-hero-bottom",children:[a.jsx("h3",{children:R.name.toUpperCase()}),a.jsxs("p",{children:[R.daysPerWeek,"x per week  ",R.focus==="fullbody"?"Full Body":R.focus.charAt(0).toUpperCase()+R.focus.slice(1)," Focus"]}),a.jsx("span",{className:"wk-prog-hero-go",children:"VIEW PROGRAMME "})]})]}),F===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},R.id))})})]}),d&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"wk-section-header",children:[a.jsx("h2",{children:"Muscle Groups"}),a.jsxs("span",{className:"wk-section-count",children:[su.length," groups"]})]}),a.jsx("div",{className:"wk-muscle-grid",children:su.map((R,F)=>a.jsx("button",{className:`wk-muscle-hero-card${R.image?" wk-muscle-thumb":""}`,onClick:()=>{Ht(R.key),k("muscle_sessions")},style:{animationDelay:`${F*.05}s`},children:R.image?a.jsx("img",{src:R.image,alt:R.label,className:"wk-muscle-thumb-img"}):a.jsxs(a.Fragment,{children:[a.jsx("img",{src:Xw,alt:"Muscle group",className:"wk-muscle-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-muscle-hero-overlay",style:{background:np[R.key]}}),a.jsxs("div",{className:"wk-muscle-hero-content",children:[a.jsx("div",{className:"wk-muscle-hero-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:R.icon})})}),a.jsxs("div",{className:"wk-muscle-hero-text",children:[a.jsx("span",{className:"wk-muscle-hero-name",children:R.label}),a.jsxs("span",{className:"wk-muscle-hero-count",children:[Zw[R.key]?.length||0," sessions"]})]})]})]})},R.key))})]})]}),a.jsx(ni,{active:"workouts"}),Ae,a.jsx(Wl,{badge:rt,onDismiss:()=>Kt(null)})]})});if(b==="randomiser_hub"){const R=JSON.parse(localStorage.getItem("mcf_last_randomiser")||"null")||{focus:"core",level:"intermediate",duration:15},F=Qr.find(G=>G.key===R.focus)?.label||R.focus,$=Ai.find(G=>G.key===R.level)?.label||R.level;return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"wk-hub-heading wk-hub-heading-hero",children:[a.jsx("div",{className:"wk-hub-circle-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-hub-circle-logo"})}),a.jsx("h2",{children:"Randomiser"}),a.jsx("p",{children:"Generate, save & replay workouts"})]}),a.jsxs("div",{className:"wk-hub-launch-zone",children:[ts.total>0&&a.jsxs("div",{className:"wk-hub-stats",children:[a.jsxs("div",{className:"wk-hub-stat",children:[a.jsx("span",{className:"wk-hub-stat-value",children:ts.total}),a.jsx("span",{className:"wk-hub-stat-label",children:"Workouts"})]}),ts.streak>0&&a.jsxs("div",{className:"wk-hub-stat",children:[a.jsxs("span",{className:"wk-hub-stat-value",children:[ts.streak,a.jsx("small",{children:"d"})]}),a.jsx("span",{className:"wk-hub-stat-label",children:"Streak"})]}),ts.favouriteFocus&&a.jsxs("div",{className:"wk-hub-stat",children:[a.jsx("span",{className:"wk-hub-stat-value wk-hub-stat-focus",style:{color:vh[ts.favouriteFocus]||"var(--color-primary)"},children:Qr.find(G=>G.key===ts.favouriteFocus)?.label||ts.favouriteFocus}),a.jsx("span",{className:"wk-hub-stat-label",children:"Top Focus"})]})]}),a.jsxs("div",{className:"wk-hub-actions",children:[a.jsxs("button",{className:"wk-hub-action-btn wk-hub-new wk-hub-new-glow",onClick:()=>k("setup"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"New Workout"]}),a.jsxs("button",{className:"wk-hub-action-btn wk-hub-quick",onClick:Nn,disabled:bn,children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})}),"Quick Start",a.jsxs("span",{className:"wk-hub-quick-meta",children:[F,"  ",$,"  ",R.duration,"min"]})]})]}),kr&&a.jsxs("button",{className:"wk-hub-suggestion",onClick:()=>{K(kr.focus),k("setup")},children:[a.jsx("svg",{className:"wk-hub-suggestion-bulb",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),a.jsxs("div",{className:"wk-hub-suggestion-info",children:[a.jsx("span",{className:"wk-hub-suggestion-label",children:kr.message}),a.jsx("span",{className:"wk-hub-suggestion-cta",children:"Tap to set up "})]}),a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"wk-hub-tip",children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),ex[Math.floor(Date.now()/864e5)%ex.length]]})]}),d&&a.jsxs("div",{className:"wk-hub-section wk-hub-section--saved",children:[a.jsxs("h3",{className:"wk-hub-section-title",children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Saved Workouts",Ss.length>0&&a.jsx("span",{className:"wk-hub-count",children:Ss.length})]}),xi?Ss.length===0?a.jsxs("div",{className:"wk-hub-empty wk-hub-empty-enhanced",children:[a.jsx("svg",{className:"wk-hub-empty-icon",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),a.jsx("p",{children:a.jsx("strong",{children:"No saved workouts yet"})}),a.jsx("p",{className:"wk-hub-empty-sub",children:"Generate a workout and hit save to stash it here for quick replay."})]}):a.jsx("div",{className:"wk-hub-saved-categories",children:Qr.map(G=>{const me=Ss.filter(Ve=>Ve.focus===G.key);if(me.length===0)return null;const be=js[G.key]||!1;return a.jsxs("div",{className:"wk-hub-saved-cat",children:[a.jsxs("button",{className:`wk-hub-saved-cat-header${be?" wk-hub-saved-cat-open":""}`,style:{"--cat-color":vh[G.key]||"var(--color-primary)"},onClick:()=>hr(Ve=>({...Ve,[G.key]:!Ve[G.key]})),children:[a.jsxs("span",{className:"wk-hub-saved-cat-label",children:[a.jsx("span",{className:"wk-hub-focus-pill",style:{"--pill-color":vh[G.key]||"var(--color-primary)"},children:G.label}),a.jsx("span",{className:"wk-hub-saved-cat-count",children:me.length})]}),a.jsx("svg",{className:`wk-hub-saved-cat-chevron${be?" wk-hub-saved-cat-chevron-open":""}`,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),be&&a.jsx("div",{className:"wk-hub-saved-list",children:me.map((Ve,nt)=>{const st=(Ve.equipment||[]).map(kt=>rp.find(Xt=>Xt.key===kt)?.label||kt).join(", "),vt=Ai.find(kt=>kt.key===Ve.level)?.label||Ve.level;return a.jsxs("div",{className:"wk-hub-saved-card",style:{animationDelay:`${nt*.05}s`},children:[a.jsxs("button",{className:"wk-hub-saved-main",onClick:()=>Rt(Ve),children:[a.jsxs("div",{className:"wk-hub-saved-info",children:[a.jsx("span",{className:"wk-hub-saved-name",children:Ve.name}),a.jsx("span",{className:"wk-hub-saved-tags",children:a.jsxs("span",{className:"wk-hub-saved-meta",children:[vt,"  ",Ve.duration,"min  ",(Ve.exercises||[]).length," ex"]})}),st&&a.jsx("span",{className:"wk-hub-saved-equip",children:st})]}),a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]}),a.jsx("button",{className:"wk-hub-saved-delete",onClick:()=>ot(Ve.id),"aria-label":"Remove saved workout",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("polyline",{points:"3 6 5 6 21 6"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]},Ve.id)})})]},G.key)})}):a.jsx("div",{className:"wk-hub-empty",children:a.jsx("div",{className:"wk-loading-spinner"})})]}),a.jsxs("div",{className:"wk-hub-section wk-hub-section--recent",children:[a.jsxs("h3",{className:"wk-hub-section-title",children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("polyline",{points:"12 6 12 12 16 14"})]}),"Recent"]}),Yn.length===0?a.jsxs("div",{className:"wk-hub-empty wk-hub-empty-enhanced",children:[a.jsxs("svg",{className:"wk-hub-empty-icon",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("polyline",{points:"12 6 12 12 16 14"})]}),a.jsx("p",{children:a.jsx("strong",{children:"No workouts yet"})}),a.jsx("p",{className:"wk-hub-empty-sub",children:"Complete your first workout to see your history here."})]}):a.jsx("div",{className:"wk-hub-recent-list",children:Yn.map((G,me)=>{const be=Qr.find(vt=>vt.key===G.focus)?.label||G.focus||"",Ve=Ai.find(vt=>vt.key===G.level)?.label||G.level||"",nt=G.completedAt?.toDate?G.completedAt.toDate():G.completedAt?new Date(G.completedAt):null,st=nt?(()=>{const vt=Math.floor((Date.now()-nt.getTime())/1e3);return vt<3600?`${Math.floor(vt/60)}m ago`:vt<86400?`${Math.floor(vt/3600)}h ago`:`${Math.floor(vt/86400)}d ago`})():"";return a.jsxs("button",{className:"wk-hub-recent-card",style:{animationDelay:`${me*.05}s`},onClick:()=>{K(G.focus||"core"),Y(G.level||"intermediate"),ae(G.duration||15),G.equipment&&M(G.equipment),k("setup")},children:[a.jsx("div",{className:"wk-hub-recent-info",children:a.jsxs("span",{className:"wk-hub-recent-tags",children:[a.jsx("span",{className:"wk-hub-focus-pill",style:{"--pill-color":vh[G.focus]||"var(--color-primary)"},children:be}),a.jsxs("span",{className:"wk-hub-recent-meta",children:[Ve,"  ",G.duration||"?","min  ",G.exerciseCount||"?"," ex"]})]})}),a.jsxs("div",{className:"wk-hub-recent-action",children:[a.jsx("span",{className:"wk-hub-recent-time",children:st}),a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]})]},me)})})]})]}),a.jsx(ni,{active:"workouts"}),Ae,a.jsx(Wl,{badge:rt,onDismiss:()=>Kt(null)})]})}if(b==="setup"){const R=Qr.find($=>$.key===H)?.label||H,F=Ai.find($=>$.key===B)?.label||B;return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>k("randomiser_hub"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main wk-setup-main",children:[a.jsx("div",{className:"wk-stats-row",children:[{label:"Total",value:`${On}`,pct:On>0?Math.min(Math.round(On/100*100),100):0,color:"#14b8a6",size:"normal"},{label:"This Week",value:`${Oe}/${tp}`,pct:Math.round(Math.min(Oe,tp)/tp*100),color:"var(--color-primary)",size:"large"},{label:"Wk Streak",value:`${Ke}`,pct:Ke>0?Math.min(Math.round(Ke/12*100),100):0,color:"#38B6FF",size:"normal"}].map($=>{const me=2*Math.PI*38,be=me-$.pct/100*me;return a.jsxs("div",{className:`wk-stat-item${$.size==="large"?" wk-stat-large":""}`,children:[a.jsxs("div",{className:"wk-stat-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"wk-stat-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"wk-stat-fill",cx:"50",cy:"50",r:38,style:{stroke:$.color},strokeDasharray:me,strokeDashoffset:be})]}),a.jsx("span",{className:"wk-stat-value",style:{color:$.color},children:$.value})]}),a.jsx("span",{className:"wk-stat-label",children:$.label})]},$.label)})}),a.jsxs("div",{className:"wk-setup-flow",children:[a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Focus Area"}),a.jsx("div",{className:"wk-focus-grid",children:Qr.map($=>a.jsxs("button",{className:`wk-equip-btn${H===$.key?" active":""}${$.key==="mix"?" wk-mix-btn":""}`,onClick:()=>{Ws(),K($.key)},children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:$.icon})}),a.jsx("span",{children:$.label})]},$.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Level"}),a.jsx("div",{className:"wk-level-cards",children:Ai.map($=>a.jsxs("button",{className:`wk-level-card wk-level-${$.key}${B===$.key?" active":""}`,onClick:()=>{Ws(),Y($.key)},children:[a.jsx("span",{className:"wk-level-name",children:$.label}),a.jsx("span",{className:"wk-level-desc",children:$.desc})]},$.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Time"}),a.jsx("div",{className:"wk-time-options",children:ip.map($=>{const G=!St.includes($);return a.jsxs("button",{className:`wk-time-btn${ee===$?" active":""}${G?" locked":""}`,onClick:()=>{G||(Ws(),ae($))},disabled:G,children:[a.jsx("span",{className:"wk-time-num",children:$}),a.jsx("span",{className:"wk-time-unit",children:G?a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}):"min"})]},$)})})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Equipment"}),a.jsx("div",{className:"wk-equip-options",children:rp.map($=>{const G=E.includes($.key);return a.jsxs("button",{className:`wk-equip-btn${G?" active":""}`,onClick:()=>{G&&E.length===1||(Ws(),M(me=>G&&me.length===1?me:G?me.filter(be=>be!==$.key):[...me,$.key]))},children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:$.icon})}),a.jsx("span",{children:$.label})]},$.key)})})]}),a.jsx("div",{className:"wk-setup-summary",children:a.jsxs("span",{children:[R,"  ",F,"  ",ee," min"]})})]})]}),a.jsxs("div",{className:"wk-go-sticky",children:[bn&&a.jsx("p",{className:"wk-free-limit-msg",children:"You've used your free workout this week. Upgrade for unlimited access."}),a.jsx("button",{className:"wk-randomise-btn",onClick:_i,disabled:he||bn,children:he?"Loading exercises...":bn?"Limit Reached":"Randomise Workout"})]}),Ae]})}if(b==="spinning")return a.jsxs("div",{className:"wk-page wk-page-center",children:[a.jsxs("div",{className:"wk-spin-container",children:[a.jsxs("div",{className:"wk-spin-ring",children:[a.jsx("svg",{className:"wk-spin-svg",viewBox:"0 0 200 200",children:f3.map((R,F)=>a.jsx("line",{x1:R.x1,y1:R.y1,x2:R.x2,y2:R.y2,className:"wk-spin-tick",strokeWidth:R.thick?"3.5":"2",style:{animationDelay:`${F*.03}s`}},F))}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-spin-logo",width:"50",height:"50"})]}),a.jsx("p",{className:"wk-spin-text",children:"Generating workout..."})]}),Ae]});if(b==="preview"){const R=it?.interval?{work:it.work,rest:it.rest}:Ai.find($=>$.key===B),F=L.length*A*(R.work+R.rest);return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>k(it?.interval?"muscle_sessions":"setup"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[it?.interval&&a.jsx("h2",{className:"mg-preview-title",children:it.name}),a.jsxs("div",{className:"wk-preview-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:L.length}),a.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:A}),a.jsx("span",{className:"wk-stat-label",children:"Rounds"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.ceil(F/60)}),a.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsxs("span",{className:"wk-stat-val",children:[R.work,"/",R.rest]}),a.jsx("span",{className:"wk-stat-label",children:"Work/Rest"})]})]}),a.jsx("div",{className:"wk-preview-list",children:L.map(($,G)=>a.jsxs("div",{className:"wk-preview-item",style:{animationDelay:`${G*.06}s`},onClick:()=>qt($),children:[a.jsx("span",{className:"wk-preview-num",children:G+1}),a.jsx("div",{className:"wk-preview-thumb",children:$.isGif?a.jsx("img",{src:$.videoUrl,alt:$.name,loading:"lazy"}):a.jsx(x5,{src:`${$.videoUrl}#t=0.1`,muted:!0,playsInline:!0,preload:"metadata"})}),a.jsx("span",{className:"wk-preview-name",children:$.name}),a.jsx("svg",{className:"wk-preview-play",width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]},G))}),ln&&a.jsx("div",{className:"wk-preview-modal-backdrop",onClick:()=>qt(null),children:a.jsxs("div",{className:"wk-preview-modal",onClick:$=>$.stopPropagation(),children:[a.jsx("button",{className:"wk-preview-modal-close",onClick:()=>qt(null),"aria-label":"Close preview",children:a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),a.jsx("div",{className:"wk-preview-modal-video",children:ln.isGif?a.jsx("img",{src:ln.videoUrl,alt:ln.name}):a.jsx("video",{src:ln.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}),a.jsx("h3",{className:"wk-preview-modal-title",children:ln.name})]})}),a.jsxs("div",{className:"wk-preview-actions",children:[!it?.interval&&a.jsxs("div",{className:"wk-preview-actions-row",children:[a.jsxs("button",{className:"wk-btn-secondary wk-btn-half",onClick:()=>_i(),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"1 4 1 10 7 10"}),a.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),"Reshuffle"]}),d&&a.jsxs("button",{className:"wk-btn-secondary wk-btn-half",onClick:()=>Vn(!0),disabled:Kn,children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Save"]})]}),a.jsx("button",{className:"wk-btn-primary wk-btn-full",onClick:Er,children:"Start Workout"})]}),ls&&a.jsx("div",{className:"wk-save-modal-backdrop",onClick:()=>Vn(!1),children:a.jsxs("div",{className:"wk-save-modal",onClick:$=>$.stopPropagation(),children:[a.jsx("h3",{children:"Save Workout"}),a.jsx("p",{children:"Give this workout a name (or leave blank for auto-name)"}),a.jsx("input",{type:"text",className:"wk-save-input",value:wn,onChange:$=>es($.target.value),placeholder:`${Qr.find($=>$.key===H)?.label||H} ${ee}min`,maxLength:40,autoFocus:!0}),a.jsxs("div",{className:"wk-save-modal-actions",children:[a.jsx("button",{className:"wk-btn-secondary",onClick:()=>Vn(!1),children:"Cancel"}),a.jsx("button",{className:"wk-btn-primary",onClick:()=>qe(wn),disabled:Kn,children:Kn?"Saving...":"Save"})]})]})})]})]})}if(b==="countdown")return a.jsx("div",{className:"wk-page wk-page-center wk-page-dark",children:a.jsxs("div",{className:"wk-countdown-big",children:[a.jsx("span",{className:"wk-countdown-num",children:$e}),a.jsx("span",{className:"wk-countdown-label",children:"GET READY"})]})});if(b==="workout"){const R=L[Se],F=V==="work"?Ze.work:Ze.rest,$=V==="rest"?Se+1<L.length?L[Se+1]:Te<A?L[0]:null:null;return a.jsxs("div",{className:"wk-page wk-page-workout",children:[a.jsx("div",{className:"wk-video-container",children:V==="work"?R.isGif?a.jsx("img",{ref:Et,className:"wk-video",src:R.videoUrl,alt:R.name},R.videoUrl):a.jsx("video",{className:"wk-video",src:R.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0},R.videoUrl):a.jsxs("div",{className:"wk-rest-screen",children:[$&&($.isGif?a.jsx("img",{className:"wk-rest-preview",src:$.videoUrl,alt:$.name}):a.jsx("video",{className:"wk-rest-preview",src:$.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})),a.jsx("div",{className:"wk-rest-overlay"}),a.jsxs("div",{className:"wk-rest-text",children:[a.jsx("span",{className:"wk-rest-label",children:"REST"}),$&&a.jsxs("div",{className:"wk-rest-next",children:[a.jsx("span",{className:"wk-rest-next-tag",children:"UP NEXT"}),a.jsx("span",{className:"wk-rest-next-name",children:$.name})]})]})]})}),a.jsx("div",{className:"wk-back-row",children:a.jsxs("button",{className:"wk-back-btn",onClick:()=>{confirm("Leave workout?")&&k("randomiser_hub")},children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]})}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"wk-exercise-info",children:[a.jsxs("span",{className:"wk-exercise-counter",children:[Se+1," / ",L.length]}),a.jsx("h2",{className:"wk-exercise-name",children:R.name}),a.jsxs("span",{className:"wk-round-label",children:["Round ",Te," of ",A]})]}),a.jsx("div",{className:"wk-timer-section",children:a.jsxs("div",{className:"wk-timer-ring-wrap",children:[S(je,F,V==="work"?"wk-tick-work":"wk-tick-rest"),a.jsxs("div",{className:"wk-timer-center",children:[a.jsx("span",{className:"wk-timer-time",children:je}),a.jsx("span",{className:`wk-timer-phase ${V}`,children:V==="work"?"WORK":"REST"})]})]})}),a.jsxs("div",{className:"wk-controls",children:[a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-stop",onClick:()=>{confirm("End workout early?")&&k("randomiser_hub")},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-pause",onClick:()=>Ue(!ke),children:ke?a.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}):a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),a.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-skip",onClick:()=>{Ce(0)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("polygon",{points:"5 4 15 12 5 20 5 4"}),a.jsx("rect",{x:"15",y:"4",width:"4",height:"16"})]})})]}),a.jsx("div",{className:"wk-progress-bar",children:a.jsx("div",{className:"wk-progress-fill",style:{width:`${Q()*100}%`}})}),Je&&(()=>{const G=Ai.find(be=>be.key===B),me=L.length*A*(G.work+G.rest);return a.jsxs(a.Fragment,{children:[a.jsx(Gp,{title:"Workout Complete!",stats:[{value:Math.ceil(me/60),label:"Minutes"},{value:L.length*A,label:"Intervals"},{value:A,label:"Rounds"}],hideShare:!d,onShareJourney:t?le:null,userName:t?.name,onDismissStart:()=>k("randomiser_hub"),onDone:()=>{Wt(!1),yt(null),Ht(null)}}),!it?.interval&&a.jsxs("button",{className:"wk-complete-save-btn",onClick:()=>Vn(!0),disabled:Kn,children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Save This Workout"]}),ls&&a.jsx("div",{className:"wk-save-modal-backdrop",onClick:()=>Vn(!1),style:{zIndex:10001},children:a.jsxs("div",{className:"wk-save-modal",onClick:be=>be.stopPropagation(),children:[a.jsx("h3",{children:"Save Workout"}),a.jsx("p",{children:"Give this workout a name (or leave blank for auto-name)"}),a.jsx("input",{type:"text",className:"wk-save-input",value:wn,onChange:be=>es(be.target.value),placeholder:`${Qr.find(be=>be.key===H)?.label||H} ${ee}min`,maxLength:40,autoFocus:!0}),a.jsxs("div",{className:"wk-save-modal-actions",children:[a.jsx("button",{className:"wk-btn-secondary",onClick:()=>Vn(!1),children:"Cancel"}),a.jsx("button",{className:"wk-btn-primary",onClick:()=>qe(wn),disabled:Kn,children:Kn?"Saving...":"Save"})]})]})})]})})()]})}if(b==="muscle_sessions"){const R=su.find($=>$.key===pt),F=Zw[pt]||[];return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>k("randomiser_hub"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"mg-sessions-header",children:[a.jsx("div",{className:"mg-sessions-icon",style:{background:np[pt]},children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:R?.icon})})}),a.jsxs("h2",{children:[R?.label," Workouts"]}),a.jsxs("p",{children:[F.length," sessions available"]})]}),a.jsx("div",{className:"mg-sessions-list",children:F.map(($,G)=>a.jsxs("button",{className:"mg-session-card",onClick:()=>{yt($),k("muscle_overview")},style:{animationDelay:`${G*.08}s`},children:[a.jsxs("div",{className:"mg-session-info",children:[a.jsx("h3",{children:$.name}),a.jsx("p",{children:$.desc}),a.jsx("div",{className:"mg-session-meta",children:$.interval?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-interval",children:"Interval"}),a.jsxs("span",{className:"mg-session-tag",children:[$.exercises.length," exercises"]}),a.jsxs("span",{className:"mg-session-tag",children:[$.rounds," rounds"]})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-strength",children:"Strength"}),a.jsxs("span",{className:"mg-session-tag",children:[$.exercises.length," exercises"]}),a.jsx("span",{className:"mg-session-tag",children:(()=>{const me=$.exercises.map(nt=>nt.sets||0),be=Math.min(...me),Ve=Math.max(...me);return be===Ve?`${be} sets each`:`${be}-${Ve} sets each`})()})]})})]}),a.jsx("div",{className:"mg-session-arrow",children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},$.id))})]}),Ae]})}if(b==="muscle_overview"){const R=it;if(!R)return null;const F=su.find($=>$.key===pt);return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>k("muscle_sessions"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main mg-overview-main",children:[a.jsx("div",{className:"mg-overview-hero",style:R.image?void 0:{background:np[pt]},children:R.image?a.jsx("img",{src:R.image,alt:R.name,className:"mg-overview-hero-img"}):a.jsx("div",{className:"mg-overview-hero-content",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"mg-overview-hero-icon",children:a.jsx("path",{d:F?.icon})})})}),a.jsxs("div",{className:"mg-overview-header",children:[a.jsxs("div",{className:"mg-overview-title-row",children:[a.jsx("h2",{children:R.name}),R.level&&a.jsx("span",{className:"mg-overview-level",children:R.level})]}),a.jsx("p",{className:"mg-overview-desc",children:R.desc})]}),R.overview&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"About This Workout"]}),a.jsx("p",{children:R.overview})]}),R.tips&&R.tips.length>0&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Tips & Form"]}),a.jsx("ul",{className:"mg-overview-tips",children:R.tips.map(($,G)=>a.jsx("li",{children:$},G))})]}),a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"}),a.jsx("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),a.jsx("path",{d:"M9 14l2 2 4-4"})]}),"Exercises (",R.exercises.length,")"]}),a.jsx("div",{className:"mg-overview-exercises",children:R.exercises.map(($,G)=>a.jsxs("div",{className:"mg-overview-exercise",children:[a.jsx("span",{className:"mg-overview-ex-num",children:G+1}),a.jsxs("div",{className:"mg-overview-ex-info",children:[a.jsx("span",{className:"mg-overview-ex-name",children:$.name}),R.interval?a.jsxs("span",{className:"mg-overview-ex-detail",children:[R.work,"s work / ",R.rest,"s rest"]}):a.jsxs("span",{className:"mg-overview-ex-detail",children:[$.sets," sets  ",$.reps?`${$.reps} reps`:`${$.time}s`,$.type==="weighted"&&"  weighted"]})]})]},G))})]}),a.jsxs("button",{className:"mg-overview-start-btn",onClick:()=>ii(R),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Workout"]})]}),Ae]})}if(b==="muscle_workout"){const R=it;if(!R)return null;const F=R.exercises[gt],$=rn[gt];if(!F||!$)return null;const G=$.sets.length,me=R.exercises.length,be=R.exercises.reduce((kt,Xt)=>kt+(Xt.sets||0),0),nt=rn.reduce((kt,Xt)=>kt+Xt.sets.length,0)/be*100,st=Re[F.name];F.type==="timed"&&Mt===0&&!Gt&&G===zt&&setTimeout(()=>Z(F.time),0);const vt=G+1<F.sets?"Log Set":gt+1<me?"Log Set  Next Exercise":"Log Set  Complete";return a.jsxs("div",{className:"wk-page",children:[a.jsx("div",{className:"mg-session-progress",children:a.jsx("div",{className:"mg-session-progress-fill",style:{width:`${nt}%`}})}),a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>{confirm("End workout early?")&&k("muscle_overview")},"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsxs("span",{className:"mg-header-info",children:["Exercise ",gt+1,"/",me]}),a.jsx("div",{style:{width:22}})]})}),a.jsxs("main",{className:"wk-main",children:[st?a.jsxs("div",{className:"mg-video-container",onClick:ki,children:[st.isGif?a.jsx("img",{className:"mg-video",src:st.url,alt:F.name}):a.jsx("video",{ref:Me,className:"mg-video",src:st.url,loop:!0,muted:!0,playsInline:!0},F.name),!C&&!st.isGif&&a.jsxs("div",{className:"mg-video-overlay",children:[a.jsx("svg",{className:"mg-play-icon",width:"48",height:"48",viewBox:"0 0 24 24",fill:"rgba(255,255,255,0.9)",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),a.jsx("span",{className:"mg-video-hint",children:"Tap for demo"})]})]}):a.jsxs("div",{className:"mg-video-placeholder",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.4",children:[a.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),a.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),a.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),a.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),a.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),a.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),a.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),a.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"})]}),a.jsx("span",{children:"Video coming soon"})]}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"mg-exercise-card",children:[a.jsx("h2",{className:"mg-ex-name",children:F.name}),a.jsx("span",{className:`mg-ex-type-badge ${F.type}`,children:F.type==="weighted"?"Weight + Reps":F.type==="reps"?"Reps Only":"Timed"}),a.jsxs("div",{className:"mg-ex-set-info",children:[a.jsxs("span",{className:"mg-ex-set-num",children:["Set ",G+1," of ",F.sets]}),F.type!=="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",F.reps," reps"]}),F.type==="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",F.time,"s"]})]}),F.type==="weighted"&&a.jsxs("div",{className:"mg-input-area",children:[a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",className:"mg-input",value:Fn,onChange:kt=>Ln(kt.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Pn,onChange:kt=>un(kt.target.value),placeholder:"0"})]})]}),F.type==="reps"&&a.jsx("div",{className:"mg-input-area",children:a.jsxs("div",{className:"mg-input-group mg-input-single",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Pn,onChange:kt=>un(kt.target.value),placeholder:"0"})]})}),F.type==="timed"&&a.jsxs("div",{className:"mg-timer-area",children:[a.jsx("div",{className:"mg-timer-display",children:a.jsxs("span",{className:"mg-timer-value",children:[Mt,"s"]})}),Gt?a.jsx("button",{className:"mg-timer-btn mg-timer-stop",onClick:()=>Ct(!1),children:"Stop"}):a.jsx("button",{className:"mg-timer-btn",onClick:()=>{Mt===0&&Z(F.time),Ct(!0)},children:Mt<F.time&&Mt>0?"Resume":"Start Timer"})]}),a.jsx("button",{className:"mg-log-set-btn",onClick:Fi,children:vt}),$.sets.length>0&&a.jsx("div",{className:"mg-completed-sets",children:$.sets.map((kt,Xt)=>a.jsxs("div",{className:"mg-completed-set",children:[a.jsx("span",{className:"mg-completed-set-check",children:""}),a.jsxs("span",{children:["Set ",Xt+1,": ",kt.weight!=null?`${kt.weight}kg  ${kt.reps}`:kt.reps!=null?`${kt.reps} reps`:`${kt.time}s`]})]},Xt))})]})]}),Ae,It&&(()=>{const kt=rn.reduce((tt,mn)=>tt+mn.sets.length,0),Xt=su.find(tt=>tt.key===pt)?.label||"",Hn=[{value:rn.length,label:"Exercises"},{value:kt,label:"Sets"}];return a.jsx(Gp,{title:`${Xt} Complete!`,subtitle:it?.name,stats:Hn,hideShare:!d,onShareJourney:t?le:null,userName:t?.name,onDismissStart:()=>k("randomiser_hub"),onDone:()=>{Cn(!1),yt(null),Ht(null)}})})()]})}return a.jsx(Wl,{badge:rt,onDismiss:()=>Kt(null)})}const k5=[{key:"trained",label:"Trained",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4",color:"#A12F3A",darkColor:"#E8475A"},{key:"protein",label:"Hit Protein",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z",color:"#4caf50",darkColor:"#5CDB61"},{key:"steps",label:"10k Steps",icon:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20M4 12.5A2.5 2.5 0 0 1 6.5 10H20M4 5.5A2.5 2.5 0 0 1 6.5 3H20",color:"#ff9800",darkColor:"#FFB020"},{key:"sleep",label:"8hrs Sleep",icon:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",color:"#7c3aed",darkColor:"#9B5AF2"},{key:"water",label:"2L Water",icon:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z",color:"#2196f3",darkColor:"#42A5F5"}],j5="M12 2l2.4 7.2L22 12l-7.6 2.8L12 22l-2.4-7.2L2 12l7.6-2.8z",tx=[{color:"#e91e63",darkColor:"#FF4D88"},{color:"#00bcd4",darkColor:"#26D9EC"},{color:"#ff5722",darkColor:"#FF7A50"},{color:"#009688",darkColor:"#26B8A8"},{color:"#ffc107",darkColor:"#FFD54F"},{color:"#673ab7",darkColor:"#9575CD"},{color:"#8bc34a",darkColor:"#AED581"},{color:"#f44336",darkColor:"#EF5350"},{color:"#3f51b5",darkColor:"#7986CB"},{color:"#795548",darkColor:"#A1887F"}],E5=700,Kp=42,Pl=2*Math.PI*Kp,bh=["Every day counts. See you tomorrow!","Consistency is your superpower.","Perfect day  keep the streak alive!","You showed up for yourself today."];function T5(s){const e=new Date(s),t=e.getDay(),i=t===0?-6:1-t;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function Qa(s){return s.toISOString().split("T")[0]}function S5(s){return Array.from({length:7},(e,t)=>{const i=new Date(s);return i.setDate(s.getDate()+t),i})}function C5(){const{currentUser:s,isClient:e,clientData:t,loading:i}=_r(),{isDark:l,toggleTheme:u}=Bi(),{isPremium:d,FREE_HABIT_LIMIT:g}=dc(),y=Hs(),[p,b]=w.useState({}),[k,E]=w.useState([]),[M,H]=w.useState(!0),[K,B]=w.useState(!1),[Y,ee]=w.useState(0),[ae,ye]=w.useState(null),[ve,he]=w.useState(null),[D,T]=w.useState(!1),[I,U]=w.useState(null),[L,P]=w.useState(!1),[A,Le]=w.useState(!1),[Ze,J]=w.useState(!1),[Te,He]=w.useState(""),[Se,Pe]=w.useState(null),[V,ce]=w.useState([]),[je,Ce]=w.useState([]),[ke,Ue]=w.useState(null),$e=w.useRef(null),Qe=w.useRef(null),Je=w.useRef(null),Wt=w.useRef(null),It=w.useRef(!1),Cn=w.useRef({}),ln=w.useRef([]),qt=w.useRef([]),Et=w.useRef(null),pn=w.useRef(bh[Math.floor(Math.random()*bh.length)]),Tt=w.useCallback((ue,De="info")=>{ye({message:ue,type:De}),setTimeout(()=>ye(null),3e3)},[]),dt=new Date,le=Qa(dt),pt=T5(dt),Ht=S5(pt),it=["M","T","W","T","F","S","S"],yt=(ue,De)=>l&&De?De:ue,gt=[...k5.filter(ue=>!V.includes(ue.key)).map(ue=>({...ue,color:yt(ue.color,ue.darkColor)})),...k.map((ue,De)=>{const Ke=tx[De%tx.length];return{key:`custom_${ue.id}`,label:ue.label,icon:j5,color:yt(Ke.color,Ke.darkColor),isCustom:!0,id:ue.id}})],_t=d?gt:gt.slice(0,g);w.useEffect(()=>{!i&&(!s||!e)&&y("/")},[s,e,i,y]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const De=ut(pe,"habitLogs"),Ke=tn(De,Ot("clientId","==",t.id)),ct=await $t(Ke),rt={};ct.docs.forEach(St=>{const bn=St.data();rt[bn.date]={...bn,_id:St.id}}),b(rt);const Kt=await _s(ze(pe,"customHabits",t.id));if(Kt.exists()){const St=Kt.data();E(St.habits||[]),ce(St.hiddenDefaults||[]),Ce(St.savedHabits||[])}let fn=0;const At=new Date(dt);for(;;){const St=Qa(At),bn=rt[St];if(bn)if(Object.values(bn.habits||{}).filter(Boolean).length>=3)fn++,At.setDate(At.getDate()-1);else break;else if(St===le)At.setDate(At.getDate()-1);else break}ee(fn)}catch(De){console.error("Error loading habit logs:",De)}finally{H(!1)}})()},[s,t]);const zt=p[le]||{habits:{}};w.useEffect(()=>{Object.values(zt.habits||{}).filter(Boolean).length<_t.length&&A&&Le(!1)},[_t.length,zt.habits]);const fs=async ue=>{if(!(!s||K||zt.habits?.[ue])){ln.current=[...Array(10)].map((Ke,ct)=>{const rt=ct/10*2*Math.PI,Kt=18+Math.random()*20;return{tx:Math.cos(rt)*Kt,ty:Math.sin(rt)*Kt,size:3+Math.random()*4,duration:.4+Math.random()*.3}}),he(ue),setTimeout(()=>he(null),700),navigator.vibrate&&navigator.vibrate(50),B(!0);try{const ct={...zt.habits||{},[ue]:!0},rt=zt._id||`${t.id}_${le}`;if(b(fn=>({...fn,[le]:{clientId:t.id,date:le,habits:ct,_id:rt}})),await Wn(ze(pe,"habitLogs",rt),{clientId:t.id,date:le,habits:ct}),Object.values(ct).filter(Boolean).length===_t.length&&!A){pn.current=bh[Math.floor(Math.random()*bh.length)],qt.current=[...Array(80)].map((At,St)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#ffffff","#000000"][St%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:St%3})),setTimeout(()=>{T(!0),Le(!0),setTimeout(()=>Et.current?.focus(),1100)},400);let fn=1;for(let At=1;At<7;At++){const St=new Date;St.setDate(St.getDate()-At);const bn=Qa(St),Ss=p[bn];if(Ss)if(Object.values(Ss.habits||{}).filter(Boolean).length>=_t.length)fn++;else break;else break}fn>=7&&ef("habits_7",t).then(At=>{At&&U(At)})}}catch(Ke){console.error("Error saving habit:",Ke),Tt("Failed to save. Try again.","error"),b(ct=>({...ct,[le]:{...ct[le],habits:{...ct[le]?.habits||{},[ue]:!1}}}))}finally{B(!1)}}},rn=async ue=>{if(!(!s||K)){B(!0);try{const Ke={...zt.habits||{},[ue]:!1},ct=zt._id||`${t.id}_${le}`;await Wn(ze(pe,"habitLogs",ct),{clientId:t.id,date:le,habits:Ke}),b(rt=>({...rt,[le]:{clientId:t.id,date:le,habits:Ke,_id:ct}}))}catch(De){console.error("Error undoing habit:",De),Tt("Failed to undo. Try again.","error")}finally{B(!1)}}},Zn=ue=>{if(zt.habits?.[ue]||!1||K||Wt.current)return;Wt.current=ue,Ue(ue),Qe.current=performance.now();const Ke=Cn.current[ue];Ke&&(Ke.style.strokeDashoffset=Pl);const ct=rt=>{const Kt=rt-Qe.current,fn=Math.min(Kt/E5,1),At=Cn.current[ue];At&&(At.style.strokeDashoffset=Pl-fn*Pl),fn<1?Je.current=requestAnimationFrame(ct):(Wt.current=null,It.current=!0,Je.current=null,Ue(null),fs(ue))};Je.current=requestAnimationFrame(ct)},Fn=()=>{if(!Wt.current)return;const ue=Wt.current;Wt.current=null,Je.current&&(cancelAnimationFrame(Je.current),Je.current=null),$e.current&&(clearTimeout($e.current),$e.current=null),Cn.current[ue]&&(Cn.current[ue].style.strokeDashoffset=Pl),Ue(null),Qe.current=null};w.useEffect(()=>()=>{Je.current&&cancelAnimationFrame(Je.current),$e.current&&clearTimeout($e.current)},[]);const Ln=w.useCallback(async ue=>{if(!t)throw new Error("Not signed in");const De=ue&&typeof ue=="object"&&ue.type;await or(ut(pe,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:De?"":ue,type:De?ue.type:"text",imageURL:null,createdAt:xs(),likeCount:0,commentCount:0,...De?{metadata:{title:ue.title||"",subtitle:ue.subtitle||"",stats:ue.stats||[],quote:ue.quote||"",badges:ue.badges||[]}}:{}})},[t]),Pn=async()=>{const ue=Te.trim();if(!ue)return;if(!t?.id){Tt("Still loading, try again","error");return}const De=Date.now().toString(36),Ke=[...k,{id:De,label:ue}];try{await Wn(ze(pe,"customHabits",t.id),{clientId:t.id,habits:Ke,hiddenDefaults:V,savedHabits:je},{merge:!0}),E(Ke),He(""),J(!1),Tt(`Added "${ue}"`,"success")}catch(ct){console.error("Error adding custom habit:",ct),Tt(ct?.code==="permission-denied"?"Permission denied  check Firestore rules for customHabits":`Failed to add habit: ${ct?.message||"Unknown error"}`,"error")}},un=async ue=>{if(!t?.id)return;const De=k.find(rt=>rt.id===ue),Ke=k.filter(rt=>rt.id!==ue),ct=De&&!je.includes(De.label)?[...je,De.label]:je;try{await Wn(ze(pe,"customHabits",t.id),{clientId:t.id,habits:Ke,hiddenDefaults:V,savedHabits:ct},{merge:!0}),E(Ke),Ce(ct),Pe(null),Tt("Habit saved for later","success")}catch(rt){console.error("Error deleting habit:",rt),Tt("Failed to remove","error")}},Gt=async ue=>{if(!t?.id)return;const De=Date.now().toString(36),Ke=[...k,{id:De,label:ue}],ct=je.filter(rt=>rt!==ue);try{await Wn(ze(pe,"customHabits",t.id),{clientId:t.id,habits:Ke,hiddenDefaults:V,savedHabits:ct},{merge:!0}),E(Ke),Ce(ct),J(!1),Tt(`Added "${ue}"`,"success")}catch(rt){console.error("Error re-adding habit:",rt),Tt("Failed to add","error")}},Ct=async ue=>{if(!t?.id)return;const De=je.filter(Ke=>Ke!==ue);try{await Wn(ze(pe,"customHabits",t.id),{clientId:t.id,habits:k,hiddenDefaults:V,savedHabits:De},{merge:!0}),Ce(De)}catch(Ke){console.error("Error removing saved habit:",Ke)}},Mt=async ue=>{if(!t?.id)return;const De=[...V,ue];try{await Wn(ze(pe,"customHabits",t.id),{clientId:t.id,habits:k,hiddenDefaults:De,savedHabits:je},{merge:!0}),ce(De),Pe(null),Tt("Habit removed","success")}catch(Ke){console.error("Error hiding default habit:",Ke),Tt("Failed to remove","error")}},Z=Ht.map(ue=>{const De=Qa(ue),Ke=p[De],ct=Ke?Object.values(Ke.habits||{}).filter(Boolean).length:0;return{date:ue,dateStr:De,completed:ct,total:_t.length}}),C=Z.reduce((ue,De)=>ue+De.completed,0),te=Z.reduce((ue,De)=>ue+De.total,0),Re=te>0?Math.round(C/te*100):0,Ie=Object.values(zt.habits||{}).filter(Boolean).length,Me=_t.length>0?Math.round(Ie/_t.length*100):0,Fe=Ie===_t.length&&_t.length>0,Oe=(()=>{const ue=Object.keys(p).sort();let De=0,Ke=0,ct=null;for(const rt of ue){const Kt=p[rt];if(Object.values(Kt.habits||{}).filter(Boolean).length>=3){if(ct){const At=new Date(ct);Ke=(new Date(rt)-At)/(1e3*60*60*24)===1?Ke+1:1}else Ke=1;Ke>De&&(De=Ke),ct=rt}else Ke=0,ct=null}return Math.max(De,Y)})(),Nt=new Date(dt.getFullYear(),dt.getMonth(),1),bt=Nt.toLocaleString("default",{month:"long"}),lt=new Date(dt.getFullYear(),dt.getMonth()+1,0).getDate(),dn=(Nt.getDay()+6)%7,hn=Array.from({length:lt},(ue,De)=>{const Ke=new Date(dt.getFullYear(),dt.getMonth(),De+1),ct=Qa(Ke),rt=p[ct],Kt=rt?Object.values(rt.habits||{}).filter(Boolean).length:0,fn=Ke>dt;return{day:De+1,dateStr:ct,completed:Kt,total:_t.length,isFuture:fn,isToday:ct===le}}),On=_t.map(ue=>({...ue,days:Ht.map(De=>{const Ke=Qa(De);return p[Ke]?.habits?.[ue.key]||!1})})),ms=Z.filter(ue=>ue.completed===ue.total&&ue.total>0).length;return a.jsx(nl,{children:a.jsxs("div",{className:"cbc-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>y("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),i||M?a.jsx("div",{className:"cbc-loading-inline",children:a.jsx("div",{className:"cbc-loading-spinner"})}):a.jsxs("main",{className:"cbc-main",children:[a.jsxs("div",{className:"cbc-hero anim-fade-up",children:[a.jsxs("div",{className:`cbc-progress-ring${Fe?" cbc-ring-complete":""}`,children:[a.jsxs("svg",{viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"cbc-arc-track",cx:"100",cy:"100",r:"80"}),a.jsx("circle",{className:"cbc-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-Me/100*2*Math.PI*80})]}),a.jsxs("div",{className:"cbc-ring-center",children:[a.jsxs("span",{className:"cbc-ring-count",children:[Ie,a.jsx("span",{className:"cbc-ring-divider",children:"/"}),_t.length]}),a.jsx("span",{className:"cbc-ring-label",children:Fe?"complete":"today"})]})]}),a.jsx("p",{className:"cbc-hero-tagline",children:Fe?"You showed up for yourself today.":Ie===0?"Start your day strong.":`${_t.length-Ie} to go  keep pushing.`})]}),a.jsxs("div",{className:"cbc-streak-card anim-fade-up-d1",children:[a.jsx("div",{className:"cbc-streak-icon",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})})}),a.jsxs("div",{className:"cbc-streak-info",children:[a.jsx("span",{className:"cbc-streak-count",children:Y}),a.jsx("span",{className:"cbc-streak-label",children:"day streak"})]}),a.jsxs("div",{className:"cbc-streak-best",children:[a.jsx("span",{className:"cbc-streak-best-val",children:Oe}),a.jsx("span",{className:"cbc-streak-best-label",children:"best"})]})]}),a.jsxs("div",{className:"cbc-section anim-fade-up-d2",children:[a.jsx("h2",{className:"cbc-section-title",children:"Today's Habits"}),a.jsxs("div",{className:"cbc-habits-grid",children:[_t.map(ue=>{const De=zt.habits?.[ue.key]||!1,Ke=ve===ue.key,ct=ke===ue.key;return a.jsxs("div",{className:`cbc-habit-tile ${De?"cbc-habit-done":""} ${Ke?"cbc-habit-just-checked":""}`,style:{"--habit-color":ue.color},children:[d&&a.jsx("button",{className:"cbc-habit-delete",onClick:rt=>{rt.stopPropagation(),Pe(ue.isCustom?{type:"custom",id:ue.id,label:ue.label}:{type:"default",key:ue.key,label:ue.label})},"aria-label":`Remove ${ue.label}`,children:a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),a.jsxs("div",{className:`cbc-habit-ring-touch ${ct?"cbc-holding":""} ${De?"cbc-ring-completed":""}`,onPointerDown:rt=>{De||(rt.preventDefault(),Zn(ue.key))},onPointerUp:Fn,onPointerLeave:Fn,onPointerCancel:Fn,onClick:rt=>{if(rt.stopPropagation(),It.current){It.current=!1;return}De&&rn(ue.key)},role:"button",tabIndex:0,"aria-label":De?`Undo ${ue.label}`:`Press and hold to complete ${ue.label}`,onKeyDown:rt=>{(rt.key==="Enter"||rt.key===" ")&&(rt.preventDefault(),De?rn(ue.key):fs(ue.key))},children:[a.jsxs("svg",{className:"cbc-habit-ring-svg",viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cbc-habit-ring-track",cx:"50",cy:"50",r:Kp}),a.jsx("circle",{className:"cbc-habit-ring-fill",ref:rt=>{rt&&(Cn.current[ue.key]=rt)},cx:"50",cy:"50",r:Kp,style:{stroke:ue.color,strokeDasharray:Pl,strokeDashoffset:De?0:Pl}})]}),De&&a.jsx("div",{className:"cbc-habit-glow-orb",style:{"--habit-color":ue.color}}),a.jsx("div",{className:"cbc-habit-ring-icon",style:{color:ue.color},children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:ue.icon})})}),Ke&&a.jsx("div",{className:"cbc-particles",children:ln.current.map((rt,Kt)=>a.jsx("span",{className:"cbc-particle",style:{"--tx":`${rt.tx}px`,"--ty":`${rt.ty}px`,"--size":`${rt.size}px`,"--particle-color":ue.color,animationDuration:`${rt.duration}s`}},Kt))})]}),a.jsx("span",{className:"cbc-habit-label",children:ue.label}),De?a.jsx("span",{className:"cbc-habit-done-tag",children:"Done"}):a.jsx("span",{className:"cbc-habit-hold-hint",children:"Hold to complete"})]},ue.key)}),d?a.jsxs("div",{className:"cbc-habit-tile cbc-add-tile",onClick:()=>J(!0),role:"button",tabIndex:0,children:[a.jsx("div",{className:"cbc-add-ring",children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),a.jsx("span",{className:"cbc-habit-label",children:"Add Habit"}),a.jsx("span",{className:"cbc-habit-hold-hint",children:"Your own"})]}):a.jsxs("div",{className:"cbc-habit-tile cbc-unlock-tile",onClick:()=>y("/upgrade"),role:"button",tabIndex:0,children:[a.jsx("div",{className:"cbc-unlock-ring",children:a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),a.jsx("span",{className:"cbc-habit-label",children:"More Habits"}),a.jsx("span",{className:"cbc-habit-hold-hint",children:"Custom & editable"})]})]})]}),a.jsxs("div",{className:"cbc-section anim-fade-up-d3",children:[a.jsxs("div",{className:"cbc-section-header",children:[a.jsx("h2",{className:"cbc-section-title",children:"This Week"}),a.jsxs("span",{className:"cbc-section-badge",children:[ms,"/7 perfect"]})]}),a.jsxs("div",{className:"cbc-weekly-card",children:[a.jsxs("div",{className:"cbc-weekly-header",children:[a.jsx("span",{className:"cbc-weekly-habit-name"}),it.map((ue,De)=>a.jsx("span",{className:`cbc-weekly-day-label${Ht[De]&&Qa(Ht[De])===le?" cbc-today-label":""}`,children:ue},De))]}),On.map(ue=>(ue.days.filter(Boolean).length,a.jsxs("div",{className:"cbc-weekly-row",children:[a.jsx("span",{className:"cbc-weekly-habit-name",style:{color:ue.color},children:ue.label}),ue.days.map((De,Ke)=>a.jsx("span",{className:`cbc-weekly-dot${De?" cbc-dot-done":""}${Ht[Ke]&&Qa(Ht[Ke])===le?" cbc-dot-today":""}`,style:De?{background:ue.color,borderColor:ue.color,boxShadow:`0 0 6px ${ue.color}40`}:void 0},Ke))]},ue.key))),a.jsxs("div",{className:"cbc-week-summary",children:[a.jsx("div",{className:"cbc-week-summary-bar",children:a.jsx("div",{className:"cbc-week-summary-fill",style:{width:`${Re}%`}})}),a.jsxs("span",{className:"cbc-week-summary-text",children:[C,"/",te," completed (",Re,"%)"]})]})]})]}),a.jsxs("div",{className:"cbc-section anim-fade-up-d4",children:[a.jsx("h2",{className:"cbc-section-title",children:bt}),a.jsxs("div",{className:"cbc-calendar-card",children:[a.jsx("div",{className:"cbc-cal-header",children:["M","T","W","T","F","S","S"].map((ue,De)=>a.jsx("span",{className:"cbc-cal-day-label",children:ue},De))}),a.jsxs("div",{className:"cbc-cal-grid",children:[Array.from({length:dn},(ue,De)=>a.jsx("span",{className:"cbc-cal-cell cbc-cal-empty"},`e${De}`)),hn.map(ue=>{const De=ue.total>0?ue.completed/ue.total:0,Ke=ue.isFuture?-1:De===0?0:De<.4?1:De<.75?2:De<1?3:4;return a.jsx("span",{className:`cbc-cal-cell${ue.isToday?" cbc-cal-today":""}${Ke===4?" cbc-cal-perfect":""} cbc-cal-heat-${Ke<0?"future":Ke}`,children:ue.day},ue.day)})]}),a.jsxs("div",{className:"cbc-cal-legend",children:[a.jsx("span",{className:"cbc-cal-legend-label",children:"Less"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-0"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-1"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-2"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-3"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-4"}),a.jsx("span",{className:"cbc-cal-legend-label",children:"More"})]})]})]})]}),a.jsx(ni,{active:"home"}),Ze&&a.jsx("div",{className:"cbc-modal-overlay",onClick:()=>J(!1),children:a.jsxs("div",{className:"cbc-modal",onClick:ue=>ue.stopPropagation(),children:[a.jsx("h3",{className:"cbc-modal-title",children:"Add Habit"}),a.jsx("p",{className:"cbc-modal-desc",children:"Track something personal to your routine."}),je.length>0&&a.jsxs("div",{className:"cbc-saved-habits",children:[a.jsx("span",{className:"cbc-saved-label",children:"Quick add"}),a.jsx("div",{className:"cbc-saved-chips",children:je.map(ue=>a.jsxs("div",{className:"cbc-saved-chip",children:[a.jsx("button",{className:"cbc-saved-chip-add",onClick:()=>Gt(ue),children:ue}),a.jsx("button",{className:"cbc-saved-chip-remove",onClick:()=>Ct(ue),"aria-label":`Remove ${ue}`,children:""})]},ue))})]}),a.jsx("input",{className:"cbc-modal-input",type:"text",placeholder:"e.g. Meditate, Stretch, Read...",value:Te,onChange:ue=>He(ue.target.value),maxLength:30,autoFocus:!0,onKeyDown:ue=>ue.key==="Enter"&&Pn()}),a.jsxs("div",{className:"cbc-modal-actions",children:[a.jsx("button",{className:"cbc-modal-cancel",onClick:()=>{J(!1),He("")},children:"Cancel"}),a.jsx("button",{className:"cbc-modal-save",onClick:Pn,disabled:!Te.trim(),children:"Add"})]})]})}),Se&&a.jsx("div",{className:"cbc-modal-overlay",onClick:()=>Pe(null),children:a.jsxs("div",{className:"cbc-modal",onClick:ue=>ue.stopPropagation(),children:[a.jsxs("h3",{className:"cbc-modal-title",children:['Remove "',Se.label,'"?']}),a.jsx("p",{className:"cbc-modal-desc",children:"This will remove the habit from your daily tracker. Past logs won't be affected."}),a.jsxs("div",{className:"cbc-modal-actions",children:[a.jsx("button",{className:"cbc-modal-cancel",onClick:()=>Pe(null),children:"Keep"}),a.jsx("button",{className:"cbc-modal-delete",onClick:()=>Se.type==="custom"?un(Se.id):Mt(Se.key),children:"Remove"})]})]})}),D&&a.jsx(Gp,{title:"All Habits Complete!",subtitle:pn.current,stats:[{value:`${Ie}/${_t.length}`,label:"Habits"},{value:Y||1,label:"Day Streak"}],buttonLabel:"Keep Going",holdLabel:"Hold To Complete Today's Habits",shareType:"habits",hideShare:!d,onShareJourney:t?Ln:null,userName:t?.name,onDone:()=>{T(!1),P(!1)}}),ae&&a.jsx("div",{className:`toast-notification ${ae.type}`,children:ae.message}),a.jsx(Wl,{badge:I,onDismiss:()=>U(null)})]})})}function Do(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function N5(s,e){return[s,e].sort().join("_")}function nx(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function A5(){const{currentUser:s,isClient:e,clientData:t,loading:i}=_r(),{isDark:l,toggleTheme:u}=Bi(),d=Hs(),[g,y]=w.useState("feed"),[p,b]=w.useState([]),[k,E]=w.useState([]),[M,H]=w.useState([]),[K,B]=w.useState(""),[Y,ee]=w.useState([]),[ae,ye]=w.useState([]),[ve,he]=w.useState(!0),[D,T]=w.useState(null),[I,U]=w.useState(null),[L,P]=w.useState([]),[A,Le]=w.useState(!1),[Ze,J]=w.useState(new Set),[Te,He]=w.useState(new Set),[Se,Pe]=w.useState({}),[V,ce]=w.useState({}),[je,Ce]=w.useState({}),[ke,Ue]=w.useState({}),[$e,Qe]=w.useState({}),[Je,Wt]=w.useState({}),It=w.useRef({}),[Cn,ln]=w.useState(!1),[qt,Et]=w.useState(null),[pn,Tt]=w.useState([]),dt=w.useCallback((C,te="info")=>{U({message:C,type:te}),setTimeout(()=>U(null),3500)},[]),le=(C,te)=>{const Re=C.match(/@(\w*)$/);if(Re){ln(!0),Et(te);const Ie=p.filter(Me=>Me.name&&Me.name.toLowerCase().includes(Re[1].toLowerCase())).slice(0,5);Tt(Ie)}else ln(!1),Tt([])},pt=(C,te)=>{const Ie=(V[te]||"").replace(/@\w*$/,`@${C.name} `);ce(Me=>({...Me,[te]:Ie})),ln(!1),Tt([])},Ht=C=>C&&C.split(/(@\w[\w\s]*?\s)/g).map((Re,Ie)=>Re.startsWith("@")&&p.some(Me=>Re.trim()===`@${Me.name}`)?a.jsx("span",{className:"mention-highlight",children:Re.trim()},Ie):Re);w.useEffect(()=>{!i&&(!s||!e)&&d("/")},[s,e,i,d]);const it=w.useCallback(async()=>{if(t){he(!0);try{const C=t.id,Re=(await $t(ut(pe,"clients"))).docs.map(lt=>({id:lt.id,...lt.data()}));ye(Re);const Ie=Object.fromEntries(Re.map(lt=>[lt.id,lt])),Me=await $t(tn(ut(pe,"buddies"),Ot("user1","==",C))),Fe=await $t(tn(ut(pe,"buddies"),Ot("user2","==",C))),Oe=new Set;[...Me.docs,...Fe.docs].forEach(lt=>{const dn=lt.data(),hn=dn.user1===C?dn.user2:dn.user1;Oe.add(hn)}),b(Array.from(Oe).map(lt=>Ie[lt]).filter(Boolean));const Nt=await $t(tn(ut(pe,"buddyRequests"),Ot("toId","==",C),Ot("status","==","pending")));E(Nt.docs.map(lt=>({reqId:lt.id,...lt.data(),fromClient:Ie[lt.data().fromId]})).filter(lt=>lt.fromClient));const bt=await $t(tn(ut(pe,"buddyRequests"),Ot("fromId","==",C),Ot("status","==","pending")));H(bt.docs.map(lt=>({reqId:lt.id,...lt.data(),toClient:Ie[lt.data().toId]})).filter(lt=>lt.toClient))}catch(C){console.error("Error fetching buddy data:",C),dt("Failed to load buddies","error")}finally{he(!1)}}},[t,dt]);w.useEffect(()=>{it()},[it]),w.useEffect(()=>{if(!K.trim()||!t){ee([]);return}const C=K.toLowerCase(),te=t.id,Re=new Set(p.map(Oe=>Oe.id)),Ie=new Set(M.map(Oe=>Oe.toId)),Me=new Set(k.map(Oe=>Oe.fromId)),Fe=ae.filter(Oe=>{if(Oe.id===te||!Oe.name||!Oe.coreBuddyAccess&&Oe.clientType!=="core_buddy")return!1;const Nt=["self_signup","google","apple"];return Oe.tier==="premium"||!Nt.includes(Oe.signupSource)?Oe.name.toLowerCase().includes(C):!1}).map(Oe=>({...Oe,isBuddy:Re.has(Oe.id),isPendingOut:Ie.has(Oe.id),isPendingIn:Me.has(Oe.id)})).slice(0,20);ee(Fe)},[K,ae,p,M,k,t]);const yt=async(C,te)=>{if(!(!t||C===t.id))try{await or(ut(pe,"notifications"),{toId:C,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:te,read:!1,createdAt:xs()})}catch(Re){console.error("Notification error:",Re),Re.code==="permission-denied"&&dt("Notifications blocked  check Firestore rules","error")}},gt=async C=>{T(C);try{const te=`${t.id}_${C}`;await Wn(ze(pe,"buddyRequests",te),{fromId:t.id,toId:C,status:"pending",createdAt:xs()}),await yt(C,"buddy_request"),dt("Buddy request sent!","success"),await it()}catch(te){console.error("Error sending request:",te),dt("Failed to send request","error")}finally{T(null)}},_t=async C=>{T(C.reqId);try{const te=N5(C.fromId,t.id);await Wn(ze(pe,"buddies",te),{user1:[C.fromId,t.id].sort()[0],user2:[C.fromId,t.id].sort()[1],connectedAt:xs()}),await ar(ze(pe,"buddyRequests",C.reqId)),await yt(C.fromId,"buddy_accept"),dt("Buddy added!","success"),await it()}catch(te){console.error("Error accepting request:",te),dt("Failed to accept","error")}finally{T(null)}},zt=async C=>{T(C.reqId);try{await ar(ze(pe,"buddyRequests",C.reqId)),dt("Request declined","info"),await it()}catch(te){console.error("Error declining:",te),dt("Failed to decline","error")}finally{T(null)}},fs=async C=>{T(C.reqId);try{await ar(ze(pe,"buddyRequests",C.reqId)),dt("Request cancelled","info"),await it()}catch(te){console.error("Error cancelling:",te),dt("Failed to cancel","error")}finally{T(null)}},rn=w.useCallback(async()=>{if(!t||p.length===0){P([]);return}Le(!0);try{const C=[t.id,...p.map(Me=>Me.id)],te=[];for(let Me=0;Me<C.length;Me+=30)te.push(C.slice(Me,Me+30));let Re=[];for(const Me of te){const Fe=await $t(tn(ut(pe,"posts"),Ot("authorId","in",Me)));Re.push(...Fe.docs.map(Oe=>({id:Oe.id,...Oe.data()})))}Re.sort((Me,Fe)=>{const Oe=Me.createdAt?.toDate?.()||new Date(0);return(Fe.createdAt?.toDate?.()||new Date(0))-Oe}),P(Re.slice(0,50));const Ie=await $t(tn(ut(pe,"postLikes"),Ot("userId","==",t.id)));J(new Set(Ie.docs.map(Me=>Me.data().postId)))}catch(C){console.error("Error loading feed:",C)}finally{Le(!1)}},[t,p]);w.useEffect(()=>{p.length>0&&g==="feed"&&rn()},[p,g,rn]);const Zn=async C=>{if(!t)return;const te=t.id,Re=`${C}_${te}`,Ie=Ze.has(C),Me=new Set(Ze);Ie?Me.delete(C):Me.add(C),J(Me),P(Fe=>Fe.map(Oe=>Oe.id===C?{...Oe,likeCount:Math.max(0,(Oe.likeCount||0)+(Ie?-1:1))}:Oe));try{if(Ie)await ar(ze(pe,"postLikes",Re)),await zn(ze(pe,"posts",C),{likeCount:mi(-1)});else{await Wn(ze(pe,"postLikes",Re),{postId:C,userId:te,createdAt:xs()}),await zn(ze(pe,"posts",C),{likeCount:mi(1)});const Fe=L.find(Oe=>Oe.id===C);Fe&&yt(Fe.authorId,"like")}}catch(Fe){console.error("Like error:",Fe),rn()}},Fn=async C=>{if(window.confirm("Delete this post?"))try{await ar(ze(pe,"posts",C)),P(te=>te.filter(Re=>Re.id!==C)),dt("Post deleted","info")}catch(te){console.error("Delete error:",te),dt("Failed to delete","error")}},Ln=async C=>{try{const Re=(await $t(tn(ut(pe,"postComments"),Ot("postId","==",C)))).docs.map(Ie=>({id:Ie.id,...Ie.data()})).sort((Ie,Me)=>{const Fe=Ie.createdAt?.toDate?.()||new Date(0),Oe=Me.createdAt?.toDate?.()||new Date(0);return Fe-Oe}).slice(0,50);Pe(Ie=>({...Ie,[C]:Re}))}catch(te){console.error("Error loading comments:",te)}},Pn=C=>{const te=new Set(Te);te.has(C)?te.delete(C):(te.add(C),Se[C]||Ln(C)),He(te)},un=async C=>{const te=(V[C]||"").trim(),Re=$e[C];if(!(!te&&!Re||!t)){Ce(Ie=>({...Ie,[C]:!0}));try{let Ie=null;if(Re){const bt=ca(ua,`comment-images/${Date.now()}_${Re.name}`);await bu(bt,Re),Ie=await io(bt)}const Me={postId:C,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:te||"",createdAt:xs()};Ie&&(Me.imageURL=Ie);const Fe=ke[C];Fe&&(Me.replyToId=Fe.id,Me.replyToName=Fe.authorName),await or(ut(pe,"postComments"),Me),await zn(ze(pe,"posts",C),{commentCount:mi(1)});const Oe=L.find(bt=>bt.id===C);Oe&&yt(Oe.authorId,"comment");const Nt=te.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Nt){const bt=new Set;Nt.forEach(lt=>{const dn=lt.slice(1).trim(),hn=p.find(On=>On.name&&On.name.toLowerCase()===dn.toLowerCase());hn&&!bt.has(hn.id)&&(bt.add(hn.id),yt(hn.id,"mention"))})}ce(bt=>({...bt,[C]:""})),Qe(bt=>({...bt,[C]:null})),Wt(bt=>({...bt,[C]:null})),Ue(bt=>({...bt,[C]:null})),It.current[C]&&(It.current[C].value=""),P(bt=>bt.map(lt=>lt.id===C?{...lt,commentCount:(lt.commentCount||0)+1}:lt)),await Ln(C)}catch(Ie){console.error("Comment error:",Ie),dt("Failed to comment","error")}finally{Ce(Ie=>({...Ie,[C]:!1}))}}},Gt=async(C,te)=>{try{await ar(ze(pe,"postComments",te)),await zn(ze(pe,"posts",C),{commentCount:mi(-1)}),Pe(Re=>({...Re,[C]:(Re[C]||[]).filter(Ie=>Ie.id!==te)})),P(Re=>Re.map(Ie=>Ie.id===C?{...Ie,commentCount:Math.max((Ie.commentCount||1)-1,0)}:Ie))}catch(Re){console.error("Delete comment error:",Re),dt("Failed to delete comment","error")}},Ct=(C,te)=>{const Re=te.target.files?.[0];if(!Re)return;if(Re.size>5*1024*1024){dt("Image must be under 5MB","error");return}Qe(Me=>({...Me,[C]:Re}));const Ie=new FileReader;Ie.onload=Me=>Wt(Fe=>({...Fe,[C]:Me.target.result})),Ie.readAsDataURL(Re)},Mt=C=>{Qe(te=>({...te,[C]:null})),Wt(te=>({...te,[C]:null})),It.current[C]&&(It.current[C].value="")},Z=k.length;return i?a.jsx("div",{className:"bdy-loading",children:a.jsx("div",{className:"bdy-spinner"})}):!s||!e||!t?null:a.jsx(nl,{children:a.jsxs("div",{className:"bdy-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"bdy-main",children:[a.jsx("h1",{className:"bdy-title",children:"Buddies"}),a.jsxs("button",{className:"bdy-leaderboard-link",onClick:()=>d("/client/leaderboard"),children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),a.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),a.jsx("rect",{x:"6",y:"9",width:"12",height:"13",rx:"2"}),a.jsx("path",{d:"M12 9v13"}),a.jsx("path",{d:"M2 22h20"})]}),a.jsx("span",{children:"Leaderboard"}),a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"bdy-tabs",children:[a.jsxs("button",{className:`bdy-tab${g==="feed"?" active":""}`,onClick:()=>y("feed"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M4 11a9 9 0 0 1 9 9"}),a.jsx("path",{d:"M4 4a16 16 0 0 1 16 16"}),a.jsx("circle",{cx:"5",cy:"19",r:"1"})]}),a.jsx("span",{children:"Feed"})]}),a.jsxs("button",{className:`bdy-tab${g==="buddies"?" active":""}`,onClick:()=>y("buddies"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"Buddies"})]}),a.jsxs("button",{className:`bdy-tab${g==="requests"?" active":""}`,onClick:()=>y("requests"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),a.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),a.jsx("span",{children:"Requests"}),Z>0&&a.jsx("span",{className:"bdy-tab-badge",children:Z})]}),a.jsxs("button",{className:`bdy-tab${g==="search"?" active":""}`,onClick:()=>y("search"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Find"})]})]}),ve?a.jsx("div",{className:"bdy-content-loading",children:a.jsx("div",{className:"bdy-spinner"})}):a.jsxs(a.Fragment,{children:[g==="feed"&&a.jsx("div",{className:"bdy-section",children:p.length===0?a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M4 11a9 9 0 0 1 9 9"}),a.jsx("path",{d:"M4 4a16 16 0 0 1 16 16"}),a.jsx("circle",{cx:"5",cy:"19",r:"1"})]}),a.jsx("h3",{children:"No buddies yet"}),a.jsx("p",{children:"Add buddies to see their posts here!"}),a.jsx("button",{className:"bdy-empty-btn",onClick:()=>y("search"),children:"Find Buddies"})]}):A?a.jsx("div",{className:"bdy-content-loading",children:a.jsx("div",{className:"bdy-spinner"})}):L.length===0?a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("h3",{children:"No posts yet"}),a.jsx("p",{children:"Your buddies haven't posted anything yet"})]}):a.jsx("div",{className:"bdy-feed-list",children:L.map(C=>a.jsxs("div",{className:"bdy-feed-post",children:[a.jsxs("div",{className:"bdy-feed-post-header",children:[a.jsx("div",{className:"bdy-feed-avatar",onClick:()=>d(`/client/core-buddy/profile/${C.authorId}`),children:C.authorPhotoURL?a.jsx("img",{src:C.authorPhotoURL,alt:""}):a.jsx("span",{children:Do(C.authorName)})}),a.jsxs("div",{className:"bdy-feed-meta",onClick:()=>d(`/client/core-buddy/profile/${C.authorId}`),children:[a.jsx("span",{className:"bdy-feed-name",children:C.authorName}),a.jsx("span",{className:"bdy-feed-time",children:nx(C.createdAt)})]}),C.authorId===t?.id&&a.jsx("button",{className:"bdy-feed-delete-btn",onClick:()=>Fn(C.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),C.type==="workout_summary"&&C.metadata?a.jsxs("div",{className:"bdy-feed-card",children:[a.jsx("div",{className:"bdy-feed-card-logo",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF"})}),a.jsx("h3",{className:"bdy-feed-card-title",children:C.metadata.title}),C.metadata.stats?.length>0&&a.jsx("p",{className:"bdy-feed-card-stats",children:C.metadata.stats.map(te=>`${te.value} ${te.label}`).join("    ")}),!C.metadata.stats?.length&&C.metadata.subtitle&&a.jsx("p",{className:"bdy-feed-card-stats",children:C.metadata.subtitle}),a.jsx("p",{className:"bdy-feed-card-cta",children:"Completed a workout using Core Buddy"})]}):C.type==="badge_earned"&&C.metadata?a.jsxs("div",{className:"bdy-feed-card",children:[a.jsx("div",{className:"bdy-feed-card-logo bdy-feed-card-badge",children:(()=>{const te=Jr.find(Re=>Re.id===C.metadata.badgeId);return te?.img?a.jsx("img",{src:te.img,alt:C.metadata.title,loading:"lazy"}):a.jsx("img",{src:"/Logo.webp",alt:C.metadata.title})})()}),a.jsx("h3",{className:"bdy-feed-card-title",children:C.metadata.title}),C.metadata.badgeDesc&&a.jsx("p",{className:"bdy-feed-card-stats",children:C.metadata.badgeDesc}),a.jsx("p",{className:"bdy-feed-card-cta",children:"Earned a badge on Core Buddy"})]}):C.type==="habits_summary"&&C.metadata?a.jsxs("div",{className:"bdy-feed-card",children:[a.jsx("div",{className:"bdy-feed-card-logo",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF"})}),a.jsx("h3",{className:"bdy-feed-card-title",children:C.metadata.title}),C.metadata.stats?.length>0&&a.jsx("p",{className:"bdy-feed-card-stats",children:C.metadata.stats.map(te=>`${te.value} ${te.label}`).join("    ")}),C.metadata.subtitle&&a.jsx("p",{className:"bdy-feed-card-stats",children:C.metadata.subtitle}),a.jsx("p",{className:"bdy-feed-card-cta",children:"Completed daily habits with Core Buddy"})]}):a.jsxs(a.Fragment,{children:[C.content&&a.jsx("p",{className:"bdy-feed-content",children:Ht(C.content)}),C.imageURL&&a.jsx("div",{className:"bdy-feed-image",children:a.jsx("img",{src:C.imageURL,alt:"Post",loading:"lazy"})})]}),a.jsxs("div",{className:"bdy-feed-actions",children:[a.jsxs("button",{className:`bdy-feed-action-btn${Ze.has(C.id)?" liked":""}`,onClick:()=>Zn(C.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:Ze.has(C.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:C.likeCount||0})]}),a.jsxs("button",{className:`bdy-feed-action-btn${Te.has(C.id)?" active":""}`,onClick:()=>Pn(C.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:C.commentCount||0})]})]}),Te.has(C.id)&&a.jsxs("div",{className:"bdy-feed-comments",children:[Se[C.id]?.length>0?Se[C.id].map(te=>a.jsxs("div",{className:"bdy-feed-comment",children:[a.jsx("div",{className:"bdy-feed-comment-avatar",children:te.authorPhotoURL?a.jsx("img",{src:te.authorPhotoURL,alt:""}):a.jsx("span",{children:Do(te.authorName)})}),a.jsxs("div",{className:"bdy-feed-comment-body",children:[a.jsxs("div",{className:"bdy-feed-comment-bubble",children:[a.jsx("span",{className:"bdy-feed-comment-name",children:te.authorName}),te.replyToName&&a.jsxs("span",{className:"bdy-feed-comment-reply-tag",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"9 14 4 9 9 4"}),a.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),te.replyToName]}),te.content&&a.jsx("span",{className:"bdy-feed-comment-text",children:Ht(te.content)}),te.imageURL&&a.jsx("img",{className:"bdy-feed-comment-img",src:te.imageURL,alt:"Comment",loading:"lazy"})]}),a.jsxs("div",{className:"bdy-feed-comment-row",children:[a.jsx("span",{className:"bdy-feed-comment-time",children:nx(te.createdAt)}),a.jsx("button",{className:"bdy-feed-comment-reply-btn",onClick:()=>Ue(Re=>({...Re,[C.id]:{id:te.id,authorName:te.authorName}})),children:"Reply"}),te.authorId===t?.id&&a.jsx("button",{className:"bdy-feed-comment-del-btn",onClick:()=>Gt(C.id,te.id),"aria-label":"Delete comment",children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},te.id)):a.jsx("p",{className:"bdy-feed-no-comments",children:"No comments yet"}),ke[C.id]&&a.jsxs("div",{className:"bdy-feed-replying",children:[a.jsxs("span",{children:["Replying to ",a.jsx("strong",{children:ke[C.id].authorName})]}),a.jsx("button",{onClick:()=>Ue(te=>({...te,[C.id]:null})),"aria-label":"Cancel reply",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),Je[C.id]&&a.jsxs("div",{className:"bdy-feed-comment-img-preview",children:[a.jsx("img",{src:Je[C.id],alt:"Preview"}),a.jsx("button",{onClick:()=>Mt(C.id),"aria-label":"Remove image",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"bdy-feed-comment-input",style:{position:"relative"},children:[a.jsx("button",{className:"bdy-feed-comment-img-btn",onClick:()=>It.current[C.id]?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:te=>{It.current[C.id]=te},type:"file",accept:"image/*",onChange:te=>Ct(C.id,te),hidden:!0}),a.jsx("input",{type:"text",placeholder:"Comment",value:V[C.id]||"",onChange:te=>{ce(Re=>({...Re,[C.id]:te.target.value})),le(te.target.value,C.id)},onKeyDown:te=>{te.key==="Enter"&&un(C.id)},maxLength:300}),Cn&&qt===C.id&&pn.length>0&&a.jsx("div",{className:"bdy-feed-mention-dropdown",children:pn.map(te=>a.jsxs("button",{className:"bdy-feed-mention-option",onClick:()=>pt(te,C.id),children:[a.jsx("div",{className:"bdy-feed-mention-avatar",children:te.photoURL?a.jsx("img",{src:te.photoURL,alt:""}):a.jsx("span",{children:Do(te.name)})}),a.jsx("span",{children:te.name})]},te.id))}),a.jsx("button",{onClick:()=>un(C.id),disabled:!(V[C.id]||"").trim()&&!$e[C.id]||je[C.id],children:je[C.id]?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"var(--color-primary)",stroke:"none",children:a.jsx("path",{d:"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"})})})]})]})]},C.id))})}),g==="buddies"&&a.jsx("div",{className:"bdy-section",children:p.length===0?a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("h3",{children:"No buddies yet"}),a.jsx("p",{children:"Find members and send buddy requests to connect!"}),a.jsx("button",{className:"bdy-empty-btn",onClick:()=>y("search"),children:"Find Buddies"})]}):a.jsx("div",{className:"bdy-list",children:p.map(C=>a.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${C.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:C.photoURL?a.jsx("img",{src:C.photoURL,alt:C.name}):a.jsx("span",{children:Do(C.name)})}),a.jsx("div",{className:"bdy-card-info",children:a.jsx("span",{className:"bdy-card-name",children:C.name})}),a.jsx("button",{className:"bdy-view-btn",onClick:te=>{te.stopPropagation(),d(`/client/core-buddy/profile/${C.id}`)},"aria-label":"View profile",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]})})]},C.id))})}),g==="requests"&&a.jsxs("div",{className:"bdy-section",children:[k.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Incoming"}),a.jsx("div",{className:"bdy-list",children:k.map(C=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:C.fromClient.photoURL?a.jsx("img",{src:C.fromClient.photoURL,alt:C.fromClient.name}):a.jsx("span",{children:Do(C.fromClient.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:C.fromClient.name}),a.jsx("span",{className:"bdy-card-sub",children:"wants to be your buddy"})]}),a.jsxs("div",{className:"bdy-action-pair",children:[a.jsx("button",{className:"bdy-accept-btn",onClick:()=>_t(C),disabled:D===C.reqId,children:D===C.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}),a.jsx("button",{className:"bdy-decline-btn",onClick:()=>zt(C),disabled:D===C.reqId,children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},C.reqId))})]}),M.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Sent"}),a.jsx("div",{className:"bdy-list",children:M.map(C=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:C.toClient?.photoURL?a.jsx("img",{src:C.toClient.photoURL,alt:C.toClient.name}):a.jsx("span",{children:Do(C.toClient?.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:C.toClient?.name}),a.jsx("span",{className:"bdy-card-sub",children:"pending"})]}),a.jsx("button",{className:"bdy-cancel-btn",onClick:()=>fs(C),disabled:D===C.reqId,children:D===C.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):"Cancel"})]},C.reqId))})]}),k.length===0&&M.length===0&&a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),a.jsx("h3",{children:"No pending requests"}),a.jsx("p",{children:"All caught up!"})]})]}),g==="search"&&a.jsxs("div",{className:"bdy-section",children:[a.jsxs("div",{className:"bdy-search-bar",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("input",{type:"text",placeholder:"Search by name...",value:K,onChange:C=>B(C.target.value),autoFocus:!0}),K&&a.jsx("button",{className:"bdy-search-clear",onClick:()=>B(""),children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),K.trim()&&Y.length===0&&a.jsx("div",{className:"bdy-empty bdy-empty-sm",children:a.jsxs("p",{children:['No members found for "',K,'"']})}),Y.length>0&&a.jsx("div",{className:"bdy-list",children:Y.map(C=>a.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${C.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:C.photoURL?a.jsx("img",{src:C.photoURL,alt:C.name}):a.jsx("span",{children:Do(C.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:C.name}),C.isBuddy&&a.jsx("span",{className:"bdy-card-badge",children:"Buddy"})]}),C.isBuddy?a.jsx("span",{className:"bdy-status-icon",children:a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-success)",strokeWidth:"2.5",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):C.isPendingOut?a.jsx("span",{className:"bdy-pending-label",children:"Pending"}):C.isPendingIn?a.jsx("button",{className:"bdy-accept-btn",onClick:te=>{te.stopPropagation();const Re=k.find(Ie=>Ie.fromId===C.id);Re&&_t(Re)},disabled:!!D,children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):a.jsx("button",{className:"bdy-add-btn",onClick:te=>{te.stopPropagation(),gt(C.id)},disabled:D===C.id,children:D===C.id?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]},C.id))})]})]})]}),a.jsx(ni,{active:"buddies"}),I&&a.jsxs("div",{className:`toast-notification ${I.type}`,children:[a.jsx("span",{className:"toast-icon",children:I.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):I.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:I.message})]})]})})}function wh(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function ap(s,e){return[s,e].sort().join("_")}const R5=5;function op(s){return s.toISOString().split("T")[0]}function sx(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function I5(){const{userId:s}=ES(),{currentUser:e,isClient:t,clientData:i,loading:l}=_r(),{isDark:u,toggleTheme:d}=Bi(),g=Hs(),[y,p]=w.useState(null),[b,k]=w.useState("none"),[E,M]=w.useState(null),[H,K]=w.useState(!0),[B,Y]=w.useState(!1),[ee,ae]=w.useState(null),[ye,ve]=w.useState([]),[he,D]=w.useState(!1),[T,I]=w.useState(new Set),[U,L]=w.useState(new Set),[P,A]=w.useState({}),[Le,Ze]=w.useState({}),[J,Te]=w.useState({}),[He,Se]=w.useState(!0),[Pe,V]=w.useState(0),[ce,je]=w.useState(0),[Ce,ke]=w.useState(0),[Ue,$e]=w.useState(new Set),[Qe,Je]=w.useState(null),[Wt,It]=w.useState(!1),[Cn,ln]=w.useState(!1),[qt,Et]=w.useState([]),[pn,Tt]=w.useState(!1),[dt,le]=w.useState(null),[pt,Ht]=w.useState([]),it=w.useCallback((Z,C="info")=>{ae({message:Z,type:C}),setTimeout(()=>ae(null),3500)},[]);w.useEffect(()=>{!l&&(!e||!t)&&g("/")},[e,t,l,g]),w.useEffect(()=>{i&&s&&i.id===s&&g("/client/core-buddy",{replace:!0})},[i,s,g]),w.useEffect(()=>{if(!i||!s||i.id===s)return;let Z=!1;return(async()=>{K(!0);try{const Re=(await $t(ut(pe,"clients"))).docs.map(Oe=>({id:Oe.id,...Oe.data()})).find(Oe=>Oe.id===s);if(!Re){Z||K(!1);return}Z||p(Re);const Ie=i.id,Me=ap(Ie,s);if((await _s(ze(pe,"buddies",Me))).exists())Z||k("buddy");else{const Oe=`${Ie}_${s}`,Nt=await _s(ze(pe,"buddyRequests",Oe));if(Nt.exists()&&Nt.data().status==="pending")Z||(k("pending_out"),M(Oe));else{const bt=`${s}_${Ie}`,lt=await _s(ze(pe,"buddyRequests",bt));lt.exists()&&lt.data().status==="pending"?Z||(k("pending_in"),M(bt)):Z||k("none")}}}catch(C){console.error("Error loading profile:",C)}finally{Z||K(!1)}})(),()=>{Z=!0}},[i,s]),w.useEffect(()=>{if(!s||!y)return;let Z=!1;return(async()=>{Se(!0);try{const C=await $t(tn(ut(pe,"workoutLogs"),Ot("clientId","==",s)));if(Z)return;const te=C.docs.length;V(te);let Re=0;const Ie=C.docs.map(Fe=>Fe.data().date).filter(Boolean).sort().reverse();if(Ie.length>0){const Fe=new Date;let Oe=new Date(Fe);for(let Nt=0;Nt<52;Nt++){const bt=new Date(Oe),lt=bt.getDay(),dn=lt===0?6:lt-1;bt.setDate(bt.getDate()-dn),bt.setHours(0,0,0,0);const hn=new Date(bt);hn.setDate(hn.getDate()+7);const On=op(bt),ms=op(hn);if(Ie.some(De=>De>=On&&De<ms))Re++;else{if(Nt>0)break;break}Oe.setDate(Oe.getDate()-7)}}Z||je(Re);let Me=0;for(let Fe=0;Fe<30;Fe++){const Oe=new Date;Oe.setDate(Oe.getDate()-Fe);const Nt=op(Oe);try{const bt=await $t(tn(ut(pe,"habitLogs"),Ot("clientId","==",s),Ot("date","==",Nt)));if(bt.empty)break;{const lt=bt.docs[0].data().habits||{};if(Object.values(lt).filter(Boolean).length>=R5)Me++;else break}}catch{break}}Z||ke(Me);try{const Fe=await _s(ze(pe,"coreBuddyBadges",s));if(!Z&&Fe.exists()){const Oe=Fe.data().earned||[];$e(new Set(Oe.map(Nt=>Nt.id)))}}catch(Fe){console.error("Error loading buddy badges:",Fe)}}catch(C){console.error("Error loading buddy stats:",C)}finally{Z||Se(!1)}})(),()=>{Z=!0}},[s,y]),w.useEffect(()=>{if(!i)return;const Z=i.id;(async()=>{try{const[C,te,Re]=await Promise.all([$t(tn(ut(pe,"buddies"),Ot("user1","==",Z))),$t(tn(ut(pe,"buddies"),Ot("user2","==",Z))),$t(ut(pe,"clients"))]),Ie=new Set;[...C.docs,...te.docs].forEach(Fe=>{const Oe=Fe.data();Ie.add(Oe.user1===Z?Oe.user2:Oe.user1)});const Me={};Re.docs.forEach(Fe=>{Me[Fe.id]=Fe.data()}),Et(Array.from(Ie).filter(Fe=>Me[Fe]).map(Fe=>({id:Fe,name:Me[Fe].name,photoURL:Me[Fe].photoURL||null})))}catch(C){console.error("Error loading buddies for mentions:",C)}})()},[i]);const yt=async(Z,C,te={})=>{if(!(!i||Z===i.id))try{await or(ut(pe,"notifications"),{toId:Z,fromId:i.id,fromName:i.name||"Someone",fromPhotoURL:i.photoURL||null,type:C,read:!1,createdAt:xs(),...te})}catch(Re){console.error("Notification error:",Re),Re.code==="permission-denied"&&it("Notifications blocked  check Firestore rules","error")}},gt=async()=>{Y(!0);try{const Z=`${i.id}_${s}`;await Wn(ze(pe,"buddyRequests",Z),{fromId:i.id,toId:s,status:"pending",createdAt:xs()}),await yt(s,"buddy_request"),k("pending_out"),M(Z),it("Buddy request sent!","success")}catch(Z){console.error(Z),it("Failed to send request","error")}finally{Y(!1)}},_t=async()=>{if(E){Y(!0);try{const Z=ap(i.id,s);await Wn(ze(pe,"buddies",Z),{user1:[i.id,s].sort()[0],user2:[i.id,s].sort()[1],connectedAt:xs()}),await ar(ze(pe,"buddyRequests",E)),await yt(s,"buddy_accept"),k("buddy"),it("Buddy added!","success")}catch(Z){console.error(Z),it("Failed to accept","error")}finally{Y(!1)}}},zt=async()=>{if(E){Y(!0);try{await ar(ze(pe,"buddyRequests",E)),k("none"),it(b==="pending_out"?"Request cancelled":"Request declined","info")}catch(Z){console.error(Z),it("Failed","error")}finally{Y(!1)}}},fs=async()=>{Y(!0);try{const Z=ap(i.id,s);await ar(ze(pe,"buddies",Z)),k("none"),It(!1),it("Buddy removed","info")}catch(Z){console.error(Z),it("Failed to remove","error")}finally{Y(!1)}},rn=w.useCallback(async()=>{if(s){D(!0);try{const C=(await $t(tn(ut(pe,"posts"),Ot("authorId","==",s)))).docs.map(te=>({id:te.id,...te.data()})).sort((te,Re)=>{const Ie=te.createdAt?.toDate?.()||new Date(0);return(Re.createdAt?.toDate?.()||new Date(0))-Ie}).slice(0,30);if(ve(C),i){const te=await $t(tn(ut(pe,"postLikes"),Ot("userId","==",i.id)));I(new Set(te.docs.map(Re=>Re.data().postId)))}}catch(Z){console.error("Error loading journey:",Z)}finally{D(!1)}}},[s,i]);w.useEffect(()=>{!H&&y&&rn()},[H,y,rn]);const Zn=async Z=>{if(window.confirm("Delete this post?"))try{await ar(ze(pe,"posts",Z)),ve(C=>C.filter(te=>te.id!==Z)),it("Post deleted","info")}catch(C){console.error("Delete error:",C),it("Failed to delete","error")}},Fn=async Z=>{if(!i)return;const C=i.id,te=`${Z}_${C}`,Re=T.has(Z),Ie=new Set(T);Re?Ie.delete(Z):Ie.add(Z),I(Ie),ve(Me=>Me.map(Fe=>Fe.id===Z?{...Fe,likeCount:Math.max(0,(Fe.likeCount||0)+(Re?-1:1))}:Fe));try{if(Re)await ar(ze(pe,"postLikes",te)),await zn(ze(pe,"posts",Z),{likeCount:mi(-1)});else{await Wn(ze(pe,"postLikes",te),{postId:Z,userId:C,createdAt:xs()}),await zn(ze(pe,"posts",Z),{likeCount:mi(1)});const Me=ye.find(Fe=>Fe.id===Z);Me&&yt(Me.authorId,"like",{postId:Z})}}catch(Me){console.error("Like error:",Me),rn()}},Ln=async Z=>{try{const te=(await $t(tn(ut(pe,"postComments"),Ot("postId","==",Z)))).docs.map(Re=>({id:Re.id,...Re.data()})).sort((Re,Ie)=>{const Me=Re.createdAt?.toDate?.()||new Date(0),Fe=Ie.createdAt?.toDate?.()||new Date(0);return Me-Fe}).slice(0,50);A(Re=>({...Re,[Z]:te}))}catch(C){console.error("Error loading comments:",C)}},Pn=Z=>{const C=new Set(U);C.has(Z)?C.delete(Z):(C.add(Z),P[Z]||Ln(Z)),L(C)},un=(Z,C)=>{const te=Z.match(/@(\w*)$/);if(te){Tt(!0),le(C);const Re=qt.filter(Ie=>Ie.name&&Ie.name.toLowerCase().includes(te[1].toLowerCase())).slice(0,5);Ht(Re)}else Tt(!1),Ht([])},Gt=(Z,C)=>{const Re=(Le[C]||"").replace(/@\w*$/,`@${Z.name} `);Ze(Ie=>({...Ie,[C]:Re})),Tt(!1),Ht([])},Ct=(Z,C)=>{Ze(te=>({...te,[Z]:C})),un(C,Z)},Mt=async Z=>{const C=(Le[Z]||"").trim();if(!(!C||!i)){Te(te=>({...te,[Z]:!0}));try{await or(ut(pe,"postComments"),{postId:Z,authorId:i.id,authorName:i.name||"Unknown",authorPhotoURL:i.photoURL||null,content:C,createdAt:xs()}),await zn(ze(pe,"posts",Z),{commentCount:mi(1)});const te=ye.find(Ie=>Ie.id===Z);te&&yt(te.authorId,"comment",{postId:Z});const Re=C.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Re){const Ie=new Set;Re.forEach(Me=>{const Fe=Me.slice(1).trim(),Oe=qt.find(Nt=>Nt.name&&Nt.name.toLowerCase()===Fe.toLowerCase());Oe&&!Ie.has(Oe.id)&&(Ie.add(Oe.id),yt(Oe.id,"mention",{postId:Z}))})}Ze(Ie=>({...Ie,[Z]:""})),ve(Ie=>Ie.map(Me=>Me.id===Z?{...Me,commentCount:(Me.commentCount||0)+1}:Me)),await Ln(Z)}catch(te){console.error("Comment error:",te),it("Failed to comment","error")}finally{Te(te=>({...te,[Z]:!1}))}}};return l||H||!i?a.jsx("div",{className:"prf-loading",children:a.jsx("div",{className:"prf-spinner"})}):!e||!t?null:y?a.jsx(nl,{children:a.jsxs("div",{className:"prf-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>g(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"prf-main",children:[a.jsxs("div",{className:"prf-hero",children:[b==="buddy"&&a.jsx("div",{className:"prf-manage-wrap",children:a.jsx("button",{className:"prf-manage-btn",onClick:()=>It(!0),"aria-label":"Manage buddy",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("circle",{cx:"12",cy:"5",r:"2"}),a.jsx("circle",{cx:"12",cy:"12",r:"2"}),a.jsx("circle",{cx:"12",cy:"19",r:"2"})]})})}),a.jsx("div",{className:`prf-avatar-lg${y.photoURL?" tappable":""}`,onClick:()=>y.photoURL&&ln(!0),children:y.photoURL?a.jsx("img",{src:y.photoURL,alt:y.name}):a.jsx("span",{children:wh(y.name)})}),a.jsx("h1",{className:"prf-name",children:y.name}),a.jsxs("div",{className:"prf-buddy-action",children:[b==="none"&&a.jsx("button",{className:"prf-btn prf-btn-primary",onClick:gt,disabled:B,children:B?a.jsx("div",{className:"prf-btn-spinner"}):a.jsxs(a.Fragment,{children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Buddy"]})}),b==="pending_out"&&a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:zt,disabled:B,children:B?a.jsx("div",{className:"prf-btn-spinner dark"}):"Cancel Request"}),b==="pending_in"&&a.jsxs("div",{className:"prf-btn-pair",children:[a.jsx("button",{className:"prf-btn prf-btn-success",onClick:_t,disabled:B,children:B?a.jsx("div",{className:"prf-btn-spinner"}):"Accept"}),a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:zt,disabled:B,children:"Decline"})]}),b==="buddy"&&a.jsxs("span",{className:"prf-buddy-label",children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),"Buddies"]})]})]}),He?a.jsx("div",{className:"prf-stats-loading",children:a.jsx("div",{className:"prf-spinner"})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"prf-stats",children:[a.jsxs("div",{className:"prf-stat",children:[a.jsx("span",{className:"prf-stat-value",children:Pe}),a.jsx("span",{className:"prf-stat-label",children:"Workouts"})]}),a.jsxs("div",{className:"prf-stat",children:[a.jsxs("span",{className:"prf-stat-value",children:[ce,a.jsx("span",{className:"prf-stat-unit",children:"wk"})]}),a.jsx("span",{className:"prf-stat-label",children:"Streak"})]})]}),Ce>0&&a.jsx("div",{className:"prf-info-row",children:a.jsxs("div",{className:"prf-info-card info-habit",children:[a.jsx("div",{className:"prf-info-icon",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]})}),a.jsxs("div",{className:"prf-info-text",children:[a.jsxs("span",{className:"prf-info-value",children:[Ce," day",Ce!==1?"s":""]}),a.jsx("span",{className:"prf-info-sub",children:"Habit Streak"})]})]})}),(()=>{const Z=Jr.filter(C=>Ue.has(C.id));return Z.length>0?a.jsxs("div",{className:"prf-section prf-badges-section",children:[a.jsxs("h2",{className:"prf-section-title",children:[`${y.name?.split(" ")[0]}'s Badges`," ",a.jsxs("span",{className:"prf-badges-tally",children:[Z.length,"/",Jr.length]})]}),a.jsx("div",{className:"prf-badges-carousel",children:Z.map(C=>a.jsxs("button",{className:"prf-carousel-badge",onClick:()=>Je(C),children:[a.jsx("img",{src:C.img,alt:C.name,className:"prf-carousel-badge-img",loading:"lazy"}),a.jsx("span",{className:"prf-carousel-badge-name",children:C.name})]},C.id))})]}):null})()]}),a.jsxs("div",{className:"prf-section",children:[a.jsx("h2",{className:"prf-section-title",children:`${y.name?.split(" ")[0]}'s Journey`}),he?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"prf-spinner"})}):ye.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"No posts yet"})]}):a.jsx("div",{className:"journey-list",children:ye.map(Z=>a.jsxs("div",{className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:Z.authorPhotoURL?a.jsx("img",{src:Z.authorPhotoURL,alt:""}):a.jsx("span",{children:wh(Z.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:Z.authorName}),a.jsx("span",{className:"journey-post-time",children:sx(Z.createdAt)})]}),Z.authorId===i.id&&a.jsx("button",{className:"journey-delete-btn",onClick:()=>Zn(Z.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),Z.type==="workout_summary"&&Z.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:Z.metadata.title}),Z.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:Z.metadata.stats.map(C=>`${C.value} ${C.label}`).join("    ")}),!Z.metadata.stats?.length&&Z.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:Z.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed a workout using Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):Z.type==="badge_earned"&&Z.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame journey-card-logo-badge",children:(()=>{const C=Jr.find(te=>te.id===Z.metadata.badgeId);return C?.img?a.jsx("img",{src:C.img,alt:Z.metadata.title,className:"journey-card-logo-img",loading:"lazy"}):a.jsx("img",{src:"/Logo.webp",alt:Z.metadata.title,className:"journey-card-logo-img"})})()}),a.jsx("h3",{className:"journey-card-title",children:Z.metadata.title}),Z.metadata.badgeDesc&&a.jsx("p",{className:"journey-card-stats-line",children:Z.metadata.badgeDesc}),a.jsx("p",{className:"journey-card-cta",children:"I just earned a badge on Core Buddy"}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):Z.type==="habits_summary"&&Z.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:Z.metadata.title}),Z.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:Z.metadata.stats.map(C=>`${C.value} ${C.label}`).join("    ")}),Z.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:Z.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed my daily habits with Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):a.jsxs(a.Fragment,{children:[Z.content&&a.jsx("p",{className:"journey-post-content",children:Z.content}),Z.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:Z.imageURL,alt:"Post",loading:"lazy"})})]}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${T.has(Z.id)?" liked":""}`,onClick:()=>Fn(Z.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:T.has(Z.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:Z.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${U.has(Z.id)?" active":""}`,onClick:()=>Pn(Z.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:Z.commentCount||0})]})]}),U.has(Z.id)&&a.jsxs("div",{className:"journey-comments",children:[P[Z.id]?.length>0?P[Z.id].map(C=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",onClick:()=>g(`/client/core-buddy/profile/${C.authorId}`),children:C.authorPhotoURL?a.jsx("img",{src:C.authorPhotoURL,alt:""}):a.jsx("span",{children:wh(C.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:C.authorName}),a.jsx("span",{className:"journey-comment-text",children:C.content})]}),a.jsx("span",{className:"journey-comment-time",children:sx(C.createdAt)})]})]},C.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("input",{type:"text",placeholder:"Comment... (@ to mention)",value:Le[Z.id]||"",onChange:C=>Ct(Z.id,C.target.value),onKeyDown:C=>{C.key==="Enter"&&Mt(Z.id)},maxLength:300}),pn&&dt===Z.id&&pt.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:pt.map(C=>a.jsxs("button",{className:"mention-option",onClick:()=>Gt(C,Z.id),children:[a.jsx("div",{className:"mention-option-avatar",children:C.photoURL?a.jsx("img",{src:C.photoURL,alt:""}):a.jsx("span",{children:wh(C.name)})}),a.jsx("span",{children:C.name})]},C.id))}),a.jsx("button",{onClick:()=>Mt(Z.id),disabled:!(Le[Z.id]||"").trim()||J[Z.id],children:J[Z.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},Z.id))})]})]}),a.jsx(ni,{active:"buddies"}),Cn&&y.photoURL&&a.jsx("div",{className:"prf-photo-overlay",onClick:()=>ln(!1),children:a.jsx("img",{src:y.photoURL,alt:y.name,className:"prf-photo-overlay-img"})}),Qe&&a.jsx("div",{className:"prf-badge-overlay",onClick:()=>Je(null),children:a.jsxs("div",{className:"prf-badge-overlay-content",onClick:Z=>Z.stopPropagation(),children:[a.jsx("img",{src:Qe.img,alt:Qe.name,className:"prf-badge-overlay-img"}),a.jsx("h3",{className:"prf-badge-overlay-name",children:Qe.name}),a.jsx("p",{className:"prf-badge-overlay-desc",children:Qe.desc}),a.jsx("button",{className:"prf-badge-overlay-close",onClick:()=>Je(null),children:"Close"})]})}),Wt&&a.jsx("div",{className:"prf-confirm-overlay",onClick:()=>It(!1),children:a.jsxs("div",{className:"prf-confirm-card",onClick:Z=>Z.stopPropagation(),children:[a.jsx("div",{className:"prf-confirm-icon",children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("line",{x1:"18",y1:"11",x2:"23",y2:"11"})]})}),a.jsx("h3",{className:"prf-confirm-title",children:"Remove Buddy"}),a.jsxs("p",{className:"prf-confirm-text",children:["Are you sure you want to remove ",y.name?.split(" ")[0]," as a buddy?"]}),a.jsxs("div",{className:"prf-confirm-actions",children:[a.jsx("button",{className:"prf-confirm-btn prf-confirm-cancel",onClick:()=>It(!1),children:"Cancel"}),a.jsx("button",{className:"prf-confirm-btn prf-confirm-remove",onClick:fs,disabled:B,children:B?a.jsx("div",{className:"prf-btn-spinner dark"}):"Remove"})]})]})}),ee&&a.jsxs("div",{className:`toast-notification ${ee.type}`,children:[a.jsx("span",{className:"toast-icon",children:ee.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):ee.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:ee.message})]})]})}):a.jsxs("div",{className:"prf-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>g(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions"})]})}),a.jsx("main",{className:"prf-main",children:a.jsx("p",{style:{textAlign:"center",color:"var(--text-tertiary)",padding:"40px 0"},children:"User not found"})}),a.jsx(ni,{active:"buddies"})]})}const lp=[{text:"Build your dashboard...",bold:"your way"},{text:"Pick what matters to you...",bold:"nothing else"},{text:"Your goals, your layout...",bold:"your rules"}],rx=[{id:"stats",label:"Stats Rings",desc:"Programme %, workouts this week, habits today",icon:"rings",defaultOn:!0},{id:"workouts",label:"Workouts",desc:"Sessions this week and total count",icon:"dumbbell",defaultOn:!0},{id:"habits",label:"Habits",desc:"Daily habit tracker dots",icon:"check",defaultOn:!0},{id:"pbs",label:"Personal Bests",desc:"Your top lifts at a glance",icon:"trophy"},{id:"nutrition",label:"Nutrition",desc:"Macro rings  protein, carbs, fats, cals",icon:"apple"},{id:"leaderboard",label:"Leaderboard",desc:"See where you rank among buddies",icon:"podium"},{id:"journey",label:"Journey",desc:"Your posts, likes and comments feed",icon:"feed"},{id:"coach",label:"Coach Message",desc:"Motivational nudge from Buddy",icon:"message",defaultOn:!0},{id:"nudge",label:"Smart Nudge",desc:"Contextual reminder of what to do next",icon:"lightbulb"}];function M5(s){switch(s){case"rings":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("circle",{cx:"12",cy:"12",r:"6"}),a.jsx("circle",{cx:"12",cy:"12",r:"2"})]});case"dumbbell":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M6.5 6.5h11v11h-11z",strokeLinejoin:"round"}),a.jsx("line",{x1:"2",y1:"12",x2:"6.5",y2:"12"}),a.jsx("line",{x1:"17.5",y1:"12",x2:"22",y2:"12"})]});case"check":return a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})});case"trophy":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M6 9H3V6a1 1 0 0 1 1-1h2M18 9h3V6a1 1 0 0 0-1-1h-2"}),a.jsx("path",{d:"M6 5h12v7a6 6 0 0 1-12 0V5z"}),a.jsx("path",{d:"M9 21h6"}),a.jsx("path",{d:"M12 17v4"})]});case"apple":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M12 3c-1.5 0-3 1-3 1s-3-.5-4.5 1.5S3 9 3 12s1.5 6 3 8 3 3 6 3 4.5-1 6-3 3-5 3-8-1.5-4-3-6.5S13.5 3 12 3z"}),a.jsx("path",{d:"M12 3c0 0 1-2 3-2"})]});case"podium":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"2",y:"14",width:"6",height:"8",rx:"1"}),a.jsx("rect",{x:"9",y:"8",width:"6",height:"14",rx:"1"}),a.jsx("rect",{x:"16",y:"11",width:"6",height:"11",rx:"1"})]});case"medal":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"15",r:"6"}),a.jsx("path",{d:"M8.21 13.89L7 2h10l-1.21 11.89"})]});case"feed":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"3"}),a.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),a.jsx("line",{x1:"3",y1:"15",x2:"21",y2:"15"})]});case"message":return a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})});case"lightbulb":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 18h6"}),a.jsx("path",{d:"M10 22h4"}),a.jsx("path",{d:"M12 2a7 7 0 0 0-4 12.7V17h8v-2.3A7 7 0 0 0 12 2z"})]});default:return null}}function D5(){const s=Hs(),{clientData:e,currentUser:t,updateClientData:i,resolveClient:l}=_r(),[u,d]=w.useState({hours:0,minutes:0,seconds:0}),[g,y]=w.useState(0),[p,b]=w.useState(0),[k,E]=w.useState(null),[M,H]=w.useState(!1),K=w.useRef(null),[B,Y]=w.useState(()=>{const P=e?.dashboardWidgets;return P&&Array.isArray(P)?P:rx.filter(A=>A.defaultOn).map(A=>A.id)}),[ee,ae]=w.useState(!1),[ye,ve]=w.useState(!1),[he,D]=w.useState(null);w.useEffect(()=>{e?.photoURL&&E(e.photoURL)},[e?.photoURL]),w.useEffect(()=>{const P=()=>{const Le=new Date,Ze=new Date(Le);Ze.setHours(23,59,59,999);const J=Ze-Le;d({hours:Math.floor(J/36e5),minutes:Math.floor(J%36e5/6e4),seconds:Math.floor(J%6e4/1e3)}),y(60-Math.floor(J%6e4/1e3))};P();const A=setInterval(P,1e3);return()=>clearInterval(A)},[]),w.useEffect(()=>{const P=setInterval(()=>b(A=>(A+1)%lp.length),8e3);return()=>clearInterval(P)},[]);const T=async P=>{const A=P.target.files?.[0];if(!(!A||!e?.id)){H(!0);try{const Le=ca(ua,`profilePhotos/${e.id}`);await bu(Le,A);const Ze=await io(Le);await zn(ze(pe,"clients",e.id),{photoURL:Ze}),E(Ze),i({photoURL:Ze})}catch(Le){console.error("Photo upload error:",Le)}finally{H(!1)}}},I=P=>{ve(!1),Y(A=>A.includes(P)?A.filter(Le=>Le!==P):[...A,P])},U=(P,A)=>{ve(!1),Y(Le=>{const Ze=Le.indexOf(P);if(Ze<0)return Le;const J=Ze+A;if(J<0||J>=Le.length)return Le;const Te=[...Le];return[Te[Ze],Te[J]]=[Te[J],Te[Ze]],Te})},L=async()=>{ae(!0),D(null);try{const P=e||await l();if(!P?.id){D("Could not find your profile. Try refreshing."),ae(!1);return}await zn(ze(pe,"clients",P.id),{dashboardWidgets:B}),i({dashboardWidgets:B}),ve(!0)}catch(P){console.error("Save config error:",P),D("Save failed  please try again.")}finally{ae(!1)}};return a.jsx(nl,{children:a.jsxs("div",{className:"bldr-page",children:[a.jsxs("div",{className:"bldr-container",children:[a.jsxs("div",{className:"bldr-header",children:[a.jsx("button",{className:"bldr-back",onClick:()=>s("/client/core-buddy"),children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("h1",{className:"bldr-title",children:"Build Your Dashboard"})]}),a.jsxs("div",{className:"bldr-ring-container",children:[a.jsxs("div",{className:"bldr-ring",children:[a.jsx("svg",{className:"bldr-ring-svg",viewBox:"0 0 200 200",children:Aj.map((P,A)=>a.jsx("line",{x1:P.x1,y1:P.y1,x2:P.x2,y2:P.y2,className:`bldr-tick ${A<g?"elapsed":"remaining"}`,strokeWidth:P.thick?"3":"2"},A))}),a.jsxs("div",{className:"bldr-ring-center",children:[a.jsxs("div",{className:"bldr-ring-photo",onClick:()=>K.current?.click(),children:[a.jsx("img",{src:k||"/Logo.webp",alt:k?"Profile":"Mind Core Fitness"}),a.jsx("div",{className:`bldr-photo-overlay${M?" uploading":""}`,children:M?a.jsx("div",{className:"bldr-photo-spinner"}):a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),a.jsx("input",{ref:K,type:"file",accept:"image/*",onChange:T,style:{display:"none"}})]}),!k&&!M&&a.jsx("div",{className:"bldr-photo-badge",onClick:()=>K.current?.click(),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),a.jsxs("div",{className:"bldr-countdown",children:[a.jsx("span",{className:"bldr-timer-digit",children:String(u.hours).padStart(2,"0")}),a.jsx("span",{className:"bldr-timer-colon",children:":"}),a.jsx("span",{className:"bldr-timer-digit",children:String(u.minutes).padStart(2,"0")}),a.jsx("span",{className:"bldr-timer-colon",children:":"}),a.jsx("span",{className:"bldr-timer-digit bldr-timer-sec",children:String(u.seconds).padStart(2,"0")})]}),a.jsx("span",{className:"bldr-ring-label",children:"remaining today"}),a.jsxs("p",{className:"bldr-tagline",children:[lp[p].text," ",a.jsx("strong",{children:lp[p].bold})]})]}),a.jsxs("div",{className:"bldr-section",children:[a.jsx("h2",{className:"bldr-section-title",children:"Choose Your Widgets"}),a.jsx("p",{className:"bldr-section-desc",children:"The countdown ring and your profile always stay at the top. Pick what goes below."}),a.jsx("div",{className:"bldr-widgets-list",children:rx.map(P=>{const A=B.includes(P.id),Le=B.indexOf(P.id);return a.jsxs("div",{className:`bldr-widget-card${A?" active":""}`,children:[a.jsx("div",{className:"bldr-widget-icon",children:M5(P.icon)}),a.jsxs("div",{className:"bldr-widget-info",children:[a.jsx("div",{className:"bldr-widget-label",children:P.label}),a.jsx("div",{className:"bldr-widget-desc",children:P.desc})]}),a.jsxs("div",{className:"bldr-widget-actions",children:[A&&a.jsxs("div",{className:"bldr-widget-order",children:[a.jsx("button",{className:"bldr-order-btn",onClick:()=>U(P.id,-1),disabled:Le===0,"aria-label":"Move up",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M18 15l-6-6-6 6"})})}),a.jsx("span",{className:"bldr-order-num",children:Le+1}),a.jsx("button",{className:"bldr-order-btn",onClick:()=>U(P.id,1),disabled:Le===B.length-1,"aria-label":"Move down",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M6 9l6 6 6-6"})})})]}),a.jsx("button",{className:`bldr-toggle${A?" on":""}`,onClick:()=>I(P.id),"aria-label":A?`Remove ${P.label}`:`Add ${P.label}`,children:a.jsx("div",{className:"bldr-toggle-thumb"})})]})]},P.id)})})]}),a.jsxs("div",{className:"bldr-save-wrap",children:[a.jsx("button",{className:`bldr-save-btn${ye?" saved":""}`,onClick:L,disabled:ee||ye,children:ee?"Saving...":ye?"Saved":"Save Dashboard"}),he&&a.jsx("p",{className:"bldr-save-error",children:he}),ye&&a.jsx("button",{className:"bldr-view-btn",onClick:()=>s("/client/core-buddy"),children:"View Dashboard"})]})]}),a.jsx(ni,{active:"home"})]})})}const Rj="@firebase/installations",y0="0.6.19";const Ij=1e4,Mj=`w:${y0}`,Dj="FIS_v2",L5="https://firebaseinstallations.googleapis.com/v1",P5=3600*1e3,O5="installations",V5="Installations";const U5={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Go=new Yo(O5,V5,U5);function Lj(s){return s instanceof wi&&s.code.includes("request-failed")}function Pj({projectId:s}){return`${L5}/projects/${s}/installations`}function Oj(s){return{token:s.token,requestStatus:2,expiresIn:z5(s.expiresIn),creationTime:Date.now()}}async function Vj(s,e){const i=(await e.json()).error;return Go.create("request-failed",{requestName:s,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function Uj({apiKey:s}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s})}function B5(s,{refreshToken:e}){const t=Uj(s);return t.append("Authorization",F5(e)),t}async function Bj(s){const e=await s();return e.status>=500&&e.status<600?s():e}function z5(s){return Number(s.replace("s","000"))}function F5(s){return`${Dj} ${s}`}async function H5({appConfig:s,heartbeatServiceProvider:e},{fid:t}){const i=Pj(s),l=Uj(s),u=e.getImmediate({optional:!0});if(u){const p=await u.getHeartbeatsHeader();p&&l.append("x-firebase-client",p)}const d={fid:t,authVersion:Dj,appId:s.appId,sdkVersion:Mj},g={method:"POST",headers:l,body:JSON.stringify(d)},y=await Bj(()=>fetch(i,g));if(y.ok){const p=await y.json();return{fid:p.fid||t,registrationStatus:2,refreshToken:p.refreshToken,authToken:Oj(p.authToken)}}else throw await Vj("Create Installation",y)}function zj(s){return new Promise(e=>{setTimeout(e,s)})}function q5(s){return btoa(String.fromCharCode(...s)).replace(/\+/g,"-").replace(/\//g,"_")}const $5=/^[cdef][\w-]{21}$/,Yp="";function W5(){try{const s=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(s),s[0]=112+s[0]%16;const t=G5(s);return $5.test(t)?t:Yp}catch{return Yp}}function G5(s){return q5(s).substr(0,22)}function Rf(s){return`${s.appName}!${s.appId}`}const Fj=new Map;function Hj(s,e){const t=Rf(s);qj(t,e),K5(t,e)}function qj(s,e){const t=Fj.get(s);if(t)for(const i of t)i(e)}function K5(s,e){const t=Y5();t&&t.postMessage({key:s,fid:e}),Q5()}let Vo=null;function Y5(){return!Vo&&"BroadcastChannel"in self&&(Vo=new BroadcastChannel("[Firebase] FID Change"),Vo.onmessage=s=>{qj(s.data.key,s.data.fid)}),Vo}function Q5(){Fj.size===0&&Vo&&(Vo.close(),Vo=null)}const X5="firebase-installations-database",J5=1,Ko="firebase-installations-store";let cp=null;function v0(){return cp||(cp=af(X5,J5,{upgrade:(s,e)=>{e===0&&s.createObjectStore(Ko)}})),cp}async function tf(s,e){const t=Rf(s),l=(await v0()).transaction(Ko,"readwrite"),u=l.objectStore(Ko),d=await u.get(t);return await u.put(e,t),await l.done,(!d||d.fid!==e.fid)&&Hj(s,e.fid),e}async function $j(s){const e=Rf(s),i=(await v0()).transaction(Ko,"readwrite");await i.objectStore(Ko).delete(e),await i.done}async function If(s,e){const t=Rf(s),l=(await v0()).transaction(Ko,"readwrite"),u=l.objectStore(Ko),d=await u.get(t),g=e(d);return g===void 0?await u.delete(t):await u.put(g,t),await l.done,g&&(!d||d.fid!==g.fid)&&Hj(s,g.fid),g}async function b0(s){let e;const t=await If(s.appConfig,i=>{const l=Z5(i),u=eL(s,l);return e=u.registrationPromise,u.installationEntry});return t.fid===Yp?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function Z5(s){const e=s||{fid:W5(),registrationStatus:0};return Wj(e)}function eL(s,e){if(e.registrationStatus===0){if(!navigator.onLine){const l=Promise.reject(Go.create("app-offline"));return{installationEntry:e,registrationPromise:l}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=tL(s,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:nL(s)}:{installationEntry:e}}async function tL(s,e){try{const t=await H5(s,e);return tf(s.appConfig,t)}catch(t){throw Lj(t)&&t.customData.serverCode===409?await $j(s.appConfig):await tf(s.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function nL(s){let e=await ix(s.appConfig);for(;e.registrationStatus===1;)await zj(100),e=await ix(s.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:i}=await b0(s);return i||t}return e}function ix(s){return If(s,e=>{if(!e)throw Go.create("installation-not-found");return Wj(e)})}function Wj(s){return sL(s)?{fid:s.fid,registrationStatus:0}:s}function sL(s){return s.registrationStatus===1&&s.registrationTime+Ij<Date.now()}async function rL({appConfig:s,heartbeatServiceProvider:e},t){const i=iL(s,t),l=B5(s,t),u=e.getImmediate({optional:!0});if(u){const p=await u.getHeartbeatsHeader();p&&l.append("x-firebase-client",p)}const d={installation:{sdkVersion:Mj,appId:s.appId}},g={method:"POST",headers:l,body:JSON.stringify(d)},y=await Bj(()=>fetch(i,g));if(y.ok){const p=await y.json();return Oj(p)}else throw await Vj("Generate Auth Token",y)}function iL(s,{fid:e}){return`${Pj(s)}/${e}/authTokens:generate`}async function w0(s,e=!1){let t;const i=await If(s.appConfig,u=>{if(!Gj(u))throw Go.create("not-registered");const d=u.authToken;if(!e&&lL(d))return u;if(d.requestStatus===1)return t=aL(s,e),u;{if(!navigator.onLine)throw Go.create("app-offline");const g=uL(u);return t=oL(s,g),g}});return t?await t:i.authToken}async function aL(s,e){let t=await ax(s.appConfig);for(;t.authToken.requestStatus===1;)await zj(100),t=await ax(s.appConfig);const i=t.authToken;return i.requestStatus===0?w0(s,e):i}function ax(s){return If(s,e=>{if(!Gj(e))throw Go.create("not-registered");const t=e.authToken;return dL(t)?{...e,authToken:{requestStatus:0}}:e})}async function oL(s,e){try{const t=await rL(s,e),i={...e,authToken:t};return await tf(s.appConfig,i),t}catch(t){if(Lj(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await $j(s.appConfig);else{const i={...e,authToken:{requestStatus:0}};await tf(s.appConfig,i)}throw t}}function Gj(s){return s!==void 0&&s.registrationStatus===2}function lL(s){return s.requestStatus===2&&!cL(s)}function cL(s){const e=Date.now();return e<s.creationTime||s.creationTime+s.expiresIn<e+P5}function uL(s){const e={requestStatus:1,requestTime:Date.now()};return{...s,authToken:e}}function dL(s){return s.requestStatus===1&&s.requestTime+Ij<Date.now()}async function hL(s){const e=s,{installationEntry:t,registrationPromise:i}=await b0(e);return i?i.catch(console.error):w0(e).catch(console.error),t.fid}async function fL(s,e=!1){const t=s;return await mL(t),(await w0(t,e)).token}async function mL(s){const{registrationPromise:e}=await b0(s);e&&await e}function gL(s){if(!s||!s.options)throw up("App Configuration");if(!s.name)throw up("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!s.options[t])throw up(t);return{appName:s.name,projectId:s.options.projectId,apiKey:s.options.apiKey,appId:s.options.appId}}function up(s){return Go.create("missing-app-config-values",{valueName:s})}const Kj="installations",pL="installations-internal",yL=s=>{const e=s.getProvider("app").getImmediate(),t=gL(e),i=Qo(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},vL=s=>{const e=s.getProvider("app").getImmediate(),t=Qo(e,Kj).getImmediate();return{getId:()=>hL(t),getToken:l=>fL(t,l)}};function bL(){yi(new ei(Kj,yL,"PUBLIC")),yi(new ei(pL,vL,"PRIVATE"))}bL();xr(Rj,y0);xr(Rj,y0,"esm2020");const wL="/firebase-messaging-sw.js",xL="/firebase-cloud-messaging-push-scope",Yj="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",_L="https://fcmregistrations.googleapis.com/v1",Qj="google.c.a.c_id",kL="google.c.a.c_l",jL="google.c.a.ts",EL="google.c.a.e",ox=1e4;var lx;(function(s){s[s.DATA_MESSAGE=1]="DATA_MESSAGE",s[s.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(lx||(lx={}));var Ru;(function(s){s.PUSH_RECEIVED="push-received",s.NOTIFICATION_CLICKED="notification-clicked"})(Ru||(Ru={}));function ia(s){const e=new Uint8Array(s);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function TL(s){const e="=".repeat((4-s.length%4)%4),t=(s+e).replace(/\-/g,"+").replace(/_/g,"/"),i=atob(t),l=new Uint8Array(i.length);for(let u=0;u<i.length;++u)l[u]=i.charCodeAt(u);return l}const dp="fcm_token_details_db",SL=5,cx="fcm_token_object_Store";async function CL(s){if("databases"in indexedDB&&!(await indexedDB.databases()).map(u=>u.name).includes(dp))return null;let e=null;return(await af(dp,SL,{upgrade:async(i,l,u,d)=>{if(l<2||!i.objectStoreNames.contains(cx))return;const g=d.objectStore(cx),y=await g.index("fcmSenderId").get(s);if(await g.clear(),!!y){if(l===2){const p=y;if(!p.auth||!p.p256dh||!p.endpoint)return;e={token:p.fcmToken,createTime:p.createTime??Date.now(),subscriptionOptions:{auth:p.auth,p256dh:p.p256dh,endpoint:p.endpoint,swScope:p.swScope,vapidKey:typeof p.vapidKey=="string"?p.vapidKey:ia(p.vapidKey)}}}else if(l===3){const p=y;e={token:p.fcmToken,createTime:p.createTime,subscriptionOptions:{auth:ia(p.auth),p256dh:ia(p.p256dh),endpoint:p.endpoint,swScope:p.swScope,vapidKey:ia(p.vapidKey)}}}else if(l===4){const p=y;e={token:p.fcmToken,createTime:p.createTime,subscriptionOptions:{auth:ia(p.auth),p256dh:ia(p.p256dh),endpoint:p.endpoint,swScope:p.swScope,vapidKey:ia(p.vapidKey)}}}}}})).close(),await Vg(dp),await Vg("fcm_vapid_details_db"),await Vg("undefined"),NL(e)?e:null}function NL(s){if(!s||!s.subscriptionOptions)return!1;const{subscriptionOptions:e}=s;return typeof s.createTime=="number"&&s.createTime>0&&typeof s.token=="string"&&s.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}const AL="firebase-messaging-database",RL=1,Iu="firebase-messaging-store";let hp=null;function Xj(){return hp||(hp=af(AL,RL,{upgrade:(s,e)=>{e===0&&s.createObjectStore(Iu)}})),hp}async function IL(s){const e=Jj(s),i=await(await Xj()).transaction(Iu).objectStore(Iu).get(e);if(i)return i;{const l=await CL(s.appConfig.senderId);if(l)return await x0(s,l),l}}async function x0(s,e){const t=Jj(s),l=(await Xj()).transaction(Iu,"readwrite");return await l.objectStore(Iu).put(e,t),await l.done,e}function Jj({appConfig:s}){return s.appId}const ML={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},dr=new Yo("messaging","Messaging",ML);async function DL(s,e){const t=await k0(s),i=Zj(e),l={method:"POST",headers:t,body:JSON.stringify(i)};let u;try{u=await(await fetch(_0(s.appConfig),l)).json()}catch(d){throw dr.create("token-subscribe-failed",{errorInfo:d?.toString()})}if(u.error){const d=u.error.message;throw dr.create("token-subscribe-failed",{errorInfo:d})}if(!u.token)throw dr.create("token-subscribe-no-token");return u.token}async function LL(s,e){const t=await k0(s),i=Zj(e.subscriptionOptions),l={method:"PATCH",headers:t,body:JSON.stringify(i)};let u;try{u=await(await fetch(`${_0(s.appConfig)}/${e.token}`,l)).json()}catch(d){throw dr.create("token-update-failed",{errorInfo:d?.toString()})}if(u.error){const d=u.error.message;throw dr.create("token-update-failed",{errorInfo:d})}if(!u.token)throw dr.create("token-update-no-token");return u.token}async function PL(s,e){const i={method:"DELETE",headers:await k0(s)};try{const u=await(await fetch(`${_0(s.appConfig)}/${e}`,i)).json();if(u.error){const d=u.error.message;throw dr.create("token-unsubscribe-failed",{errorInfo:d})}}catch(l){throw dr.create("token-unsubscribe-failed",{errorInfo:l?.toString()})}}function _0({projectId:s}){return`${_L}/projects/${s}/registrations`}async function k0({appConfig:s,installations:e}){const t=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}function Zj({p256dh:s,auth:e,endpoint:t,vapidKey:i}){const l={web:{endpoint:t,auth:e,p256dh:s}};return i!==Yj&&(l.web.applicationPubKey=i),l}const OL=10080*60*1e3;async function VL(s){const e=await BL(s.swRegistration,s.vapidKey),t={vapidKey:s.vapidKey,swScope:s.swRegistration.scope,endpoint:e.endpoint,auth:ia(e.getKey("auth")),p256dh:ia(e.getKey("p256dh"))},i=await IL(s.firebaseDependencies);if(i){if(zL(i.subscriptionOptions,t))return Date.now()>=i.createTime+OL?UL(s,{token:i.token,createTime:Date.now(),subscriptionOptions:t}):i.token;try{await PL(s.firebaseDependencies,i.token)}catch(l){console.warn(l)}return ux(s.firebaseDependencies,t)}else return ux(s.firebaseDependencies,t)}async function UL(s,e){try{const t=await LL(s.firebaseDependencies,e),i={...e,token:t,createTime:Date.now()};return await x0(s.firebaseDependencies,i),t}catch(t){throw t}}async function ux(s,e){const i={token:await DL(s,e),createTime:Date.now(),subscriptionOptions:e};return await x0(s,i),i.token}async function BL(s,e){const t=await s.pushManager.getSubscription();return t||s.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:TL(e)})}function zL(s,e){const t=e.vapidKey===s.vapidKey,i=e.endpoint===s.endpoint,l=e.auth===s.auth,u=e.p256dh===s.p256dh;return t&&i&&l&&u}function dx(s){const e={from:s.from,collapseKey:s.collapse_key,messageId:s.fcmMessageId};return FL(e,s),HL(e,s),qL(e,s),e}function FL(s,e){if(!e.notification)return;s.notification={};const t=e.notification.title;t&&(s.notification.title=t);const i=e.notification.body;i&&(s.notification.body=i);const l=e.notification.image;l&&(s.notification.image=l);const u=e.notification.icon;u&&(s.notification.icon=u)}function HL(s,e){e.data&&(s.data=e.data)}function qL(s,e){if(!e.fcmOptions&&!e.notification?.click_action)return;s.fcmOptions={};const t=e.fcmOptions?.link??e.notification?.click_action;t&&(s.fcmOptions.link=t);const i=e.fcmOptions?.analytics_label;i&&(s.fcmOptions.analyticsLabel=i)}function $L(s){return typeof s=="object"&&!!s&&Qj in s}function WL(s){if(!s||!s.options)throw fp("App Configuration Object");if(!s.name)throw fp("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=s;for(const i of e)if(!t[i])throw fp(i);return{appName:s.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function fp(s){return dr.create("missing-app-config-values",{valueName:s})}class GL{constructor(e,t,i){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const l=WL(e);this.firebaseDependencies={app:e,appConfig:l,installations:t,analyticsProvider:i}}_delete(){return Promise.resolve()}}async function KL(s){try{s.swRegistration=await navigator.serviceWorker.register(wL,{scope:xL}),s.swRegistration.update().catch(()=>{}),await YL(s.swRegistration)}catch(e){throw dr.create("failed-service-worker-registration",{browserErrorMessage:e?.message})}}async function YL(s){return new Promise((e,t)=>{const i=setTimeout(()=>t(new Error(`Service worker not registered after ${ox} ms`)),ox),l=s.installing||s.waiting;s.active?(clearTimeout(i),e()):l?l.onstatechange=u=>{u.target?.state==="activated"&&(l.onstatechange=null,clearTimeout(i),e())}:(clearTimeout(i),t(new Error("No incoming service worker found.")))})}async function QL(s,e){if(!e&&!s.swRegistration&&await KL(s),!(!e&&s.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw dr.create("invalid-sw-registration");s.swRegistration=e}}async function XL(s,e){e?s.vapidKey=e:s.vapidKey||(s.vapidKey=Yj)}async function eE(s,e){if(!navigator)throw dr.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw dr.create("permission-blocked");return await XL(s,e?.vapidKey),await QL(s,e?.serviceWorkerRegistration),VL(s)}async function JL(s,e,t){const i=ZL(e);(await s.firebaseDependencies.analyticsProvider.get()).logEvent(i,{message_id:t[Qj],message_name:t[kL],message_time:t[jL],message_device_time:Math.floor(Date.now()/1e3)})}function ZL(s){switch(s){case Ru.NOTIFICATION_CLICKED:return"notification_open";case Ru.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}async function eP(s,e){const t=e.data;if(!t.isFirebaseMessaging)return;s.onMessageHandler&&t.messageType===Ru.PUSH_RECEIVED&&(typeof s.onMessageHandler=="function"?s.onMessageHandler(dx(t)):s.onMessageHandler.next(dx(t)));const i=t.data;$L(i)&&i[EL]==="1"&&await JL(s,t.messageType,i)}const hx="@firebase/messaging",fx="0.12.23";const tP=s=>{const e=new GL(s.getProvider("app").getImmediate(),s.getProvider("installations-internal").getImmediate(),s.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>eP(e,t)),e},nP=s=>{const e=s.getProvider("messaging").getImmediate();return{getToken:i=>eE(e,i)}};function sP(){yi(new ei("messaging",tP,"PUBLIC")),yi(new ei("messaging-internal",nP,"PRIVATE")),xr(hx,fx),xr(hx,fx,"esm2020")}async function rP(){try{await $x()}catch{return!1}return typeof window<"u"&&qx()&&BC()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function iP(s=Pu()){return rP().then(e=>{if(!e)throw dr.create("unsupported-browser")},e=>{throw dr.create("indexed-db-unsupported")}),Qo(jn(s),"messaging").getImmediate()}async function aP(s,e){return s=jn(s),eE(s,e)}sP();const oP="BNVNdqAPfJYhKBjF9qd-YPEMYIbecZLWiOGUF5tOBfNuv6P1iXgJS6IoS9dHLM5gp-WMrExfir0pCpkMzOdTWKY";let mp=null;function lP(){if(!mp)try{mp=iP(Pu())}catch{return null}return mp}function Qp(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window}function mx(){return"Notification"in window?Notification.permission:"denied"}function cP(s){const e=Object.getOwnPropertyDescriptor(Notification,"permission");Object.defineProperty(Notification,"permission",{get:()=>"granted",configurable:!0});const t=()=>{e?Object.defineProperty(Notification,"permission",e):delete Notification.permission};try{const i=s();return i&&typeof i.then=="function"?i.then(l=>(t(),l),l=>{throw t(),l}):(t(),i)}catch(i){throw t(),i}}async function uP(s){if(!Qp())return null;try{const e=await Notification.requestPermission(),t=lP();if(!t)return console.error("Push: could not initialise Firebase Messaging"),null;const i=await navigator.serviceWorker.ready,l=e!=="granted";let u=null;const d=3;for(let g=1;g<=d;g++){try{const y=()=>aP(t,{vapidKey:oP,serviceWorkerRegistration:i});if(u=l?await cP(y):await y(),u)break}catch(y){console.warn(`Push getToken attempt ${g}/${d} failed:`,y)}g<d&&await new Promise(y=>setTimeout(y,1500*g))}return u&&s&&await zn(ze(pe,"clients",s),{fcmTokens:NM(u)}),u}catch(e){return console.error("Push permission request failed:",e),null}}async function dP(s,e){if(!(!e||!s))try{await zn(ze(pe,"clients",s),{fcmTokens:AM(e)})}catch(t){console.error("Token revoke failed:",t)}}const hP=[{key:"daily_morning",label:"Morning motivation",desc:"Daily 6 AM motivational nudge to start your day"},{key:"daily_evening",label:"Evening check-in",desc:"Daily 6 PM reminder to log your habits"},{key:"buddy_request",label:"Buddy requests",desc:"When someone sends you a buddy request"},{key:"buddy_accept",label:"Buddy accepted",desc:"When your buddy request is accepted"},{key:"like",label:"Likes",desc:"When someone likes your post"},{key:"comment",label:"Comments",desc:"When someone comments on your post"},{key:"mention",label:"Mentions",desc:"When someone @mentions you"}];function fP(){const{currentUser:s,clientData:e,updateClientData:t,logout:i,loading:l}=_r(),{isDark:u,toggleTheme:d,accent:g,setAccent:y,isMono:p,toggleMono:b}=Bi(),k=Hs(),[E,M]=w.useState(!1),[H,K]=w.useState(null),[B,Y]=w.useState(!1),[ee,ae]=w.useState("default"),[ye,ve]=w.useState({daily_morning:!0,daily_evening:!0,buddy_request:!0,buddy_accept:!0,like:!0,comment:!0,mention:!0}),[he,D]=w.useState(null),T=w.useCallback((L,P="info")=>{D({message:L,type:P}),setTimeout(()=>D(null),4e3)},[]);w.useEffect(()=>{!l&&!s&&k("/")},[l,s,k]),w.useEffect(()=>{if(!e)return;const L=e.notificationPrefs;L&&ve(A=>({...A,...L}));const P=e.fcmTokens||[];P.length>0&&(M(!0),K(P[P.length-1])),ae(mx())},[e]);const I=async()=>{if(e){Y(!0);try{if(E)H&&await dP(e.id,H),M(!1),K(null),t({fcmTokens:[]}),T("Push notifications disabled","info");else{if(!Qp()){T("Push notifications are not supported on this device","error");return}const L=await uP(e.id),P=mx();ae(P),L?(M(!0),K(L),t({fcmTokens:[...e.fcmTokens||[],L]}),T("Push notifications enabled!","success")):T(P==="denied"?"Notifications blocked  enable them in your device settings, remove the app from your home screen and re-add it":P==="granted"?"Permission granted but setup failed  try closing and reopening the app, then toggle again":"Could not enable notifications  please try again","error")}}catch(L){console.error("Push toggle failed:",L),T("Something went wrong  please try again","error")}finally{Y(!1)}}},U=async L=>{if(!e)return;const P={...ye,[L]:!ye[L]};ve(P);try{await zn(ze(pe,"clients",e.id),{notificationPrefs:P}),t({notificationPrefs:P})}catch(A){console.error("Failed to save pref:",A),ve(Le=>({...Le,[L]:!Le[L]})),T("Failed to save preference","error")}};return l||!e?a.jsx("div",{className:"cb-loading",children:a.jsx("div",{className:"cb-loading-spinner"})}):a.jsxs("div",{className:"cb-settings",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>k("/client/core-buddy"),"aria-label":"Back",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M19 12H5"}),a.jsx("path",{d:"M12 19l-7-7 7-7"})]})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),a.jsx("button",{onClick:i,"aria-label":"Log out",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),a.jsxs("main",{className:"settings-main",children:[a.jsx("h1",{className:"settings-title",children:"Settings"}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"13.5",cy:"6.5",r:"2.5"}),a.jsx("circle",{cx:"19",cy:"13.5",r:"2.5"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"2.5"}),a.jsx("circle",{cx:"5",cy:"15.5",r:"2.5"}),a.jsx("circle",{cx:"11",cy:"19.5",r:"2.5"}),a.jsx("path",{d:"M12 2a10 10 0 0 0 0 20 2 2 0 0 0 2-2v-1a2 2 0 0 1 2-2h1a2 2 0 0 0 2-2 10 10 0 0 0-7-13z"})]}),"Accent Colour"]}),a.jsx("div",{className:"settings-accent-row",children:[{key:"red",color:"#B8313D",label:"Red"},{key:"orange",color:"#FF8533",label:"Orange"},{key:"blue",color:"#1AADFF",label:"Blue"},{key:"green",color:"#C1FF72",label:"Green"},{key:"purple",color:"#CB6CE6",label:"Purple"}].map(L=>a.jsxs("button",{className:`settings-accent-option${g===L.key?" active":""}`,onClick:()=>y(L.key),"aria-label":`${L.label} accent`,children:[a.jsx("span",{className:"settings-accent-dot",style:{background:L.color}}),a.jsx("span",{className:"settings-accent-label",children:L.label})]},L.key))}),a.jsxs("div",{className:"settings-row settings-mono-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Mono"}),a.jsx("span",{className:"settings-row-desc",children:"Black & white with frosted glass"})]}),a.jsx("button",{className:`settings-toggle${p?" on":""}`,onClick:b,"aria-label":"Toggle mono theme",children:a.jsx("span",{className:"settings-toggle-knob"})})]})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),a.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),"Notifications"]}),Qp()?a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Push notifications"}),a.jsx("span",{className:"settings-row-desc",children:"Receive notifications even when the app is closed"})]}),a.jsx("button",{className:`settings-toggle${E?" on":""}${B?" loading":""}`,onClick:I,disabled:B,"aria-label":"Toggle push notifications",children:a.jsx("span",{className:"settings-toggle-knob"})})]}):a.jsx("p",{className:"settings-hint",children:"Add the app to your home screen for background push notifications. In-app notifications still work below."}),a.jsxs("div",{className:"settings-sub-section",children:[a.jsx("span",{className:"settings-sub-title",children:"Notify me about"}),hP.map(L=>a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:L.label}),a.jsx("span",{className:"settings-row-desc",children:L.desc})]}),a.jsx("button",{className:`settings-toggle${ye[L.key]?" on":""}`,onClick:()=>U(L.key),"aria-label":`Toggle ${L.label}`,children:a.jsx("span",{className:"settings-toggle-knob"})})]},L.key))]})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),"Account"]}),a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Dark mode"}),a.jsx("span",{className:"settings-row-desc",children:"Switch between light and dark themes"})]}),a.jsx("button",{className:`settings-toggle${u?" on":""}`,onClick:d,"aria-label":"Toggle dark mode",children:a.jsx("span",{className:"settings-toggle-knob"})})]}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Email"}),a.jsx("span",{className:"settings-row-desc",children:e?.email||""})]})}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Plan"}),a.jsx("span",{className:"settings-row-desc",style:{textTransform:"capitalize"},children:e?.tier||"free"})]})})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),"Support & Feedback"]}),a.jsxs("a",{href:"mailto:ross@mindcorefitness.com?subject=Core%20Buddy%20Bug%20Report",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Report a Bug"}),a.jsx("span",{className:"settings-row-desc",children:"Found something not working? Let us know"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]}),a.jsxs("a",{href:"mailto:ross@mindcorefitness.com?subject=Core%20Buddy%20Feature%20Request",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Request a Feature"}),a.jsx("span",{className:"settings-row-desc",children:"Have an idea to improve Core Buddy?"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]}),a.jsxs("a",{href:"mailto:ross@mindcorefitness.com?subject=Core%20Buddy%20Feedback",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"General Feedback"}),a.jsx("span",{className:"settings-row-desc",children:"We'd love to hear from you"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Contact Email"}),a.jsx("span",{className:"settings-row-desc",children:"ross@mindcorefitness.com"})]})})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),a.jsx("polyline",{points:"10 9 9 9 8 9"})]}),"Legal"]}),a.jsxs("a",{href:"/privacy-policy",target:"_blank",rel:"noopener noreferrer",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Privacy Policy"}),a.jsx("span",{className:"settings-row-desc",children:"How we collect, use, and protect your data"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a.jsx("polyline",{points:"15 3 21 3 21 9"}),a.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]}),a.jsxs("a",{href:"/terms",target:"_blank",rel:"noopener noreferrer",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Terms & Conditions"}),a.jsx("span",{className:"settings-row-desc",children:"Terms of use for Core Buddy"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a.jsx("polyline",{points:"15 3 21 3 21 9"}),a.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),"About"]}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Core Buddy"}),a.jsx("span",{className:"settings-row-desc",children:"Food. Habits. Move."})]})}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Version"}),a.jsx("span",{className:"settings-row-desc",children:"1.0.0"})]})}),a.jsxs("a",{href:"/core-buddy",target:"_blank",rel:"noopener noreferrer",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Visit Our Website"}),a.jsx("span",{className:"settings-row-desc",children:"mindcorefitness.com"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a.jsx("polyline",{points:"15 3 21 3 21 9"}),a.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]})]})]}),he&&a.jsx("div",{className:`settings-toast ${he.type}`,children:he.message}),a.jsx(ni,{active:"home"})]})}const xh=[{id:"starter_streak",name:"Starter Streak",description:"Complete 5 workouts in 7 days",goal:5,duration:7,type:"workouts",difficulty:"easy",icon:"flame",premium:!0},{id:"consistency_king",name:"Consistency King",description:"Complete 12 workouts in 30 days",goal:12,duration:30,type:"workouts",difficulty:"medium",icon:"crown",premium:!0},{id:"thirty_in_thirty",name:"30 in 30",description:"Complete 30 workouts in 30 days",goal:30,duration:30,type:"workouts",difficulty:"hard",icon:"fire",premium:!0},{id:"minute_master",name:"Minute Master",description:"Train for 300 total minutes in 30 days",goal:300,duration:30,type:"minutes",difficulty:"medium",icon:"clock",premium:!0},{id:"habit_machine",name:"Habit Machine",description:"Hit all daily habits for 7 days straight",goal:7,duration:7,type:"habits_perfect",difficulty:"medium",icon:"check",premium:!0},{id:"iron_will",name:"Iron Will",description:"Work out every day for 14 days straight",goal:14,duration:14,type:"streak",difficulty:"hard",icon:"shield",premium:!0}];function gp({icon:s,size:e=28}){const t={width:e,height:e};switch(s){case"flame":return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 12c2-2.96 0-7-1-8 0 3.038-1.773 4.741-3 6-1.226 1.26-2 3.24-2 5a6 6 0 1 0 12 0c0-1.532-1.056-3.94-2-5-1.786 3-2.791 3-4 2z"})});case"crown":return a.jsxs("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M2 4l3 12h14l3-12-6 7-4-7-4 7-6-7z"}),a.jsx("path",{d:"M3 20h18"})]});case"fire":return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 12c2-2.96 0-7-1-8 0 3.038-1.773 4.741-3 6-1.226 1.26-2 3.24-2 5a6 6 0 1 0 12 0c0-1.532-1.056-3.94-2-5-1.786 3-2.791 3-4 2z"})});case"clock":return a.jsxs("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 6v6l4 2"})]});case"check":return a.jsxs("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]});case"shield":return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})});default:return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("circle",{cx:"12",cy:"12",r:"10"})})}}function gx({progress:s,goal:e,size:t=160,stroke:i=10,label:l}){const u=Math.min(s/e,1),d=(t-i)/2,g=2*Math.PI*d,y=g*(1-u);return a.jsxs("div",{className:"ch-ring-wrap",children:[a.jsxs("svg",{width:t,height:t,className:"ch-ring-svg",children:[a.jsx("circle",{cx:t/2,cy:t/2,r:d,fill:"none",stroke:"var(--ch-ring-bg)",strokeWidth:i}),a.jsx("circle",{cx:t/2,cy:t/2,r:d,fill:"none",stroke:"var(--color-primary)",strokeWidth:i,strokeDasharray:g,strokeDashoffset:y,strokeLinecap:"round",style:{transition:"stroke-dashoffset 0.6s ease",transform:"rotate(-90deg)",transformOrigin:"50% 50%"}})]}),a.jsxs("div",{className:"ch-ring-centre",children:[a.jsxs("span",{className:"ch-ring-num",children:[s,a.jsxs("span",{className:"ch-ring-slash",children:[" / ",e]})]}),l&&a.jsx("span",{className:"ch-ring-label",children:l})]})]})}const px={easy:"#34C759",medium:"#FF9500",hard:"#FF3B30"};async function mP(s,e,t){const i=t instanceof Bt?t:Bt.fromDate(new Date(t)),l=i.toDate().getTime(),u=Date.now(),d=async()=>{const g=tn(ut(pe,"workoutLogs"),Ot("clientId","==",e));return(await $t(g)).docs.filter(p=>{const b=p.data().completedAt;if(!b)return!1;const k=b.toDate?b.toDate().getTime():new Date(b).getTime();return k>=l&&k<=u})};switch(s.type){case"workouts":return(await d()).length;case"minutes":return(await d()).reduce((y,p)=>y+(p.data().duration||0),0);case"habits_perfect":{const g=i.toDate().toISOString().slice(0,10),y=new Date().toISOString().slice(0,10),p=tn(ut(pe,"habitLogs"),Ot("clientId","==",e));return(await $t(p)).docs.filter(k=>{const E=k.data().date;if(E<g||E>y)return!1;const M=k.data().habits||{};return Object.values(M).length>0&&Object.values(M).every(H=>H===!0)}).length}case"streak":{const g=await d(),y=new Set(g.map(E=>E.data().completedAt.toDate().toISOString().slice(0,10)));let p=0;const b=new Date(i.toDate()),k=new Date;for(;y.has(b.toISOString().slice(0,10))&&b<=k;)p++,b.setDate(b.getDate()+1);return p}default:return 0}}function gP(){const{currentUser:s,clientData:e,loading:t}=_r(),{isDark:i,toggleTheme:l}=Bi(),{isPremium:u}=dc(),d=Hs(),[g,y]=w.useState(null),[p,b]=w.useState(null),[k,E]=w.useState(0),[M,H]=w.useState(0),[K,B]=w.useState(!0),[Y,ee]=w.useState(!1),[ae,ye]=w.useState(null),[ve,he]=w.useState(null),[D,T]=w.useState(!1),[I,U]=w.useState(null),L=w.useCallback((Se,Pe="info")=>{he({message:Se,type:Pe}),setTimeout(()=>he(null),4e3)},[]);w.useEffect(()=>{!t&&!s&&d("/")},[t,s,d]);const P=w.useCallback(async()=>{if(e){B(!0);try{const Se=tn(ut(pe,"userChallenges"),Ot("clientId","==",e.id),Ot("status","==","active")),Pe=await $t(Se);if(Pe.empty)y(null),b(null);else{const je=Pe.docs[0],Ce={id:je.id,...je.data()},ke=xh.find(Ue=>Ue.id===Ce.challengeId);if(Ce.endDate.toDate()<new Date)await zn(ze(pe,"userChallenges",je.id),{status:"failed"}),y(null),b(null),L("Challenge expired  time ran out","error");else if(y(Ce),b(ke),ke){const Ue=await mP(ke,e.id,Ce.startDate);if(E(Ue),Ue>=ke.goal&&Ce.status==="active"){if(await zn(ze(pe,"userChallenges",je.id),{status:"completed",completedAt:xs()}),T(!0),y($e=>$e?{...$e,status:"completed"}:null),!Ce.badgeAwarded){const $e=Jr.find(Qe=>Qe.id===ke.id);if($e)try{const Qe=ze(pe,"coreBuddyBadges",e.id),Je=await _s(Qe),Wt=Je.exists()?Je.data().earned||[]:[];if(!Wt.some(It=>It.id===$e.id)){const It={id:$e.id,earnedAt:new Date().toISOString()};Je.exists()?await zn(Qe,{earned:[...Wt,It]}):await Wn(Qe,{earned:[It]})}await zn(ze(pe,"userChallenges",je.id),{badgeAwarded:!0}),await or(ut(pe,"posts"),{authorId:e.id,authorName:e.name||"Anonymous",authorPhotoURL:e.photoURL||null,type:"badge_earned",metadata:{title:$e.name,badgeDesc:$e.desc,badgeId:$e.id},createdAt:xs(),likeCount:0,commentCount:0}),U($e)}catch(Qe){console.error("Badge award failed:",Qe)}}typeof fbq=="function"&&fbq("trackCustom","ChallengeCompleted",{challenge_name:ke.name,challenge_type:ke.type,duration_days:ke.duration})}}}const V=tn(ut(pe,"userChallenges"),Ot("clientId","==",e.id),Ot("status","==","completed")),ce=await $t(V);H(ce.size)}catch(Se){console.error("Failed to load challenges:",Se)}finally{B(!1)}}},[e,L]);w.useEffect(()=>{P()},[P]);const A=async Se=>{if(!(!e||Y)){ee(!0);try{const Pe=xh.find(ke=>ke.id===Se);if(!Pe)return;const V=tn(ut(pe,"userChallenges"),Ot("clientId","==",e.id),Ot("status","==","active"));if(!(await $t(V)).empty){ye(null),L("You already have an active challenge","info"),await P();return}const je=Bt.now(),Ce=Bt.fromDate(new Date(Date.now()+Pe.duration*864e5));await or(ut(pe,"userChallenges"),{clientId:e.id,challengeId:Se,startDate:je,endDate:Ce,status:"active",completedAt:null,badgeAwarded:!1,createdAt:xs()}),ye(null),L(`${Pe.name} started  let's go!`,"success"),await P()}catch(Pe){console.error("Start challenge failed:",Pe),Pe?.code==="permission-denied"?L("Permission denied  please re-login and try again","error"):L("Something went wrong  try again","error")}finally{ee(!1)}}},Le=async()=>{if(!(!g||Y)){ee(!0);try{await zn(ze(pe,"userChallenges",g.id),{status:"failed"}),y(null),b(null),E(0),ye(null),L("Challenge abandoned","info"),await P()}catch(Se){console.error("Give up failed:",Se),L("Something went wrong","error")}finally{ee(!1)}}},Ze=g?.endDate?Math.max(0,Math.ceil((g.endDate.toDate()-new Date)/864e5)):0,J=()=>{if(!p||!g)return"";const Se=Math.max(1,Math.ceil((Date.now()-g.startDate.toDate())/864e5)),Pe=p.goal/p.duration*Se;return k>=Pe*1.15?"Ahead":k>=Pe*.85?"On Track":"Behind"};if(t||!e)return a.jsx("div",{className:"ch-loading",children:a.jsx("div",{className:"ch-spinner"})});const Te=g&&g.status==="active"&&p,He=D||g&&g.status==="completed";return a.jsxs("div",{className:"ch-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Back",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M19 12H5"}),a.jsx("path",{d:"M12 19l-7-7 7-7"})]})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:l,"aria-label":"Toggle theme",children:i?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"ch-main",children:[a.jsx("h1",{className:"ch-title",children:"Challenges"}),a.jsx("p",{className:"ch-subtitle",children:"Push yourself with timed fitness challenges"}),K?a.jsx("div",{className:"ch-loading",children:a.jsx("div",{className:"ch-spinner"})}):He?a.jsxs("div",{className:"ch-completed-section",children:[a.jsx(gx,{progress:p?.goal||1,goal:p?.goal||1,label:"Complete"}),a.jsx("div",{className:"ch-completed-pulse"}),a.jsx("h2",{className:"ch-completed-heading",children:"Challenge Complete!"}),a.jsx("p",{className:"ch-completed-name",children:p?.name}),a.jsxs("p",{className:"ch-completed-count",children:[M+(D?1:0)," challenge",M!==0?"s":""," completed"]}),a.jsx("button",{className:"ch-btn ch-btn-primary",onClick:()=>{T(!1),y(null),b(null),P()},children:"Choose Next Challenge"})]}):Te?a.jsxs("div",{className:"ch-active-section",children:[a.jsx(gx,{progress:k,goal:p.goal,label:p.type==="minutes"?"minutes":p.type==="streak"?"day streak":p.type==="habits_perfect"?"perfect days":"workouts"}),a.jsxs("div",{className:"ch-active-info",children:[a.jsxs("div",{className:"ch-info-row",children:[a.jsxs("div",{className:"ch-info-item",children:[a.jsx("span",{className:"ch-info-val",children:Ze}),a.jsx("span",{className:"ch-info-key",children:"days left"})]}),a.jsx("div",{className:`ch-pace ch-pace-${J().toLowerCase().replace(" ","")}`,children:J()})]}),a.jsx("h2",{className:"ch-active-name",children:p.name}),a.jsx("p",{className:"ch-active-desc",children:p.description})]}),a.jsx("button",{className:"ch-give-up",onClick:()=>ye("giveup"),children:"Give Up"}),a.jsxs("div",{className:"ch-browse-locked",children:[a.jsx("p",{className:"ch-browse-locked-note",children:"Complete your current challenge to start a new one"}),a.jsx("div",{className:"ch-grid ch-grid-dimmed",children:xh.filter(Se=>Se.id!==p.id).map(Se=>a.jsxs("div",{className:"ch-card ch-card-locked",children:[a.jsx("div",{className:"ch-card-icon",children:a.jsx(gp,{icon:Se.icon,size:24})}),a.jsxs("div",{className:"ch-card-body",children:[a.jsx("h3",{children:Se.name}),a.jsx("p",{children:Se.description})]})]},Se.id))})]})]}):a.jsxs("div",{className:"ch-browse-section",children:[!u&&a.jsxs("div",{className:"ch-premium-banner",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{children:"Challenges are a premium feature"}),a.jsx("button",{className:"ch-upgrade-link",onClick:()=>d("/upgrade"),children:"Upgrade"})]}),a.jsx("div",{className:"ch-grid",children:xh.map(Se=>a.jsxs("button",{className:`ch-card${u?"":" ch-card-gated"}`,onClick:()=>u?ye(Se):d("/upgrade"),children:[!u&&a.jsx("div",{className:"ch-lock-overlay",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),a.jsx("div",{className:"ch-card-icon",children:a.jsx(gp,{icon:Se.icon})}),a.jsxs("div",{className:"ch-card-body",children:[a.jsx("h3",{children:Se.name}),a.jsx("p",{children:Se.description}),a.jsxs("div",{className:"ch-card-tags",children:[a.jsxs("span",{className:"ch-tag ch-tag-dur",children:[Se.duration," days"]}),a.jsx("span",{className:"ch-tag ch-tag-diff",style:{color:px[Se.difficulty]},children:Se.difficulty})]})]}),a.jsx("svg",{className:"ch-card-arrow",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]},Se.id))})]})]}),ae&&ae!=="giveup"&&a.jsx("div",{className:"ch-modal-backdrop",onClick:()=>!Y&&ye(null),children:a.jsxs("div",{className:"ch-modal",onClick:Se=>Se.stopPropagation(),children:[a.jsx("div",{className:"ch-modal-icon",children:a.jsx(gp,{icon:ae.icon,size:36})}),a.jsx("h2",{children:ae.name}),a.jsx("p",{children:ae.description}),a.jsxs("div",{className:"ch-modal-details",children:[a.jsxs("span",{children:[ae.duration," days"]}),a.jsx("span",{style:{color:px[ae.difficulty]},children:ae.difficulty})]}),a.jsx("button",{className:"ch-btn ch-btn-primary",onClick:()=>A(ae.id),disabled:Y,children:Y?"Starting...":"Start Challenge"}),a.jsx("button",{className:"ch-btn ch-btn-secondary",onClick:()=>ye(null),disabled:Y,children:"Cancel"})]})}),ae==="giveup"&&a.jsx("div",{className:"ch-modal-backdrop",onClick:()=>!Y&&ye(null),children:a.jsxs("div",{className:"ch-modal",onClick:Se=>Se.stopPropagation(),children:[a.jsx("h2",{children:"Give Up?"}),a.jsx("p",{children:"Your progress will be lost and this challenge will be marked as failed."}),a.jsx("button",{className:"ch-btn ch-btn-danger",onClick:Le,disabled:Y,children:Y?"Abandoning...":"Yes, Give Up"}),a.jsx("button",{className:"ch-btn ch-btn-secondary",onClick:()=>ye(null),disabled:Y,children:"Keep Going"})]})}),a.jsx(Wl,{badge:I,onDismiss:()=>U(null)}),ve&&a.jsx("div",{className:`ch-toast ch-toast-${ve.type}`,children:ve.message}),a.jsx(ni,{})]})}const pP={workouts:"Workouts",streaks:"Streaks",nutrition:"Nutrition",leaderboard:"Leaderboard",habits:"Habits",challenges:"Challenges"},yP=["workouts","streaks","nutrition","leaderboard","habits","challenges"];function vP(){const{currentUser:s,isClient:e,clientData:t,loading:i}=_r(),{isDark:l,toggleTheme:u}=Bi(),d=Hs(),[g,y]=w.useState(new Set),[p,b]=w.useState({}),[k,E]=w.useState(!0),[M,H]=w.useState(null);w.useEffect(()=>{!i&&(!s||!e)&&d("/")},[s,e,i,d]),w.useEffect(()=>{t&&(async()=>{E(!0);try{const Y=await _s(ze(pe,"coreBuddyBadges",t.id));if(Y.exists()){const ee=Y.data().earned||[];y(new Set(ee.map(ye=>ye.id)));const ae={};ee.forEach(ye=>{ae[ye.id]=ye}),b(ae)}}catch(Y){console.error("Failed to load badges:",Y)}finally{E(!1)}})()},[t]);const K=yP.map(Y=>({key:Y,label:pP[Y],badges:Jr.filter(ee=>ee.category===Y)})).filter(Y=>Y.badges.length>0),B=Jr.filter(Y=>g.has(Y.id)).length;return i||!t?a.jsx("div",{className:"bdg-loading",children:a.jsx("div",{className:"bdg-spinner"})}):a.jsxs("div",{className:"bdg-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Back",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M19 12H5"}),a.jsx("path",{d:"M12 19l-7-7 7-7"})]})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"bdg-main",children:[a.jsx("h1",{className:"bdg-title",children:"Badges"}),a.jsxs("p",{className:"bdg-subtitle",children:[B," / ",Jr.length," earned"]}),k?a.jsx("div",{className:"bdg-loading-inline",children:a.jsx("div",{className:"bdg-spinner"})}):K.map(Y=>a.jsxs("div",{className:"bdg-category",children:[a.jsx("h2",{className:"bdg-category-title",children:Y.label}),a.jsx("div",{className:"bdg-grid",children:Y.badges.map(ee=>{const ae=g.has(ee.id);return a.jsxs("button",{className:`bdg-item${ae?" earned":" locked"}`,onClick:()=>H(ee),children:[a.jsxs("div",{className:"bdg-img-wrap",children:[ee.img?a.jsx("img",{src:ee.img,alt:ee.name,className:"bdg-img",loading:"lazy"}):a.jsx("div",{className:"bdg-img-placeholder",children:a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("circle",{cx:"12",cy:"8",r:"6"}),a.jsx("path",{d:"M9 14l-4 8h14l-4-8"})]})}),!ae&&a.jsx("div",{className:"bdg-lock-overlay",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})})]}),a.jsx("span",{className:"bdg-name",children:ee.name})]},ee.id)})})]},Y.key))]}),M&&a.jsx("div",{className:"bdg-modal-backdrop",onClick:()=>H(null),children:a.jsxs("div",{className:"bdg-modal",onClick:Y=>Y.stopPropagation(),children:[a.jsx("div",{className:`bdg-modal-img-wrap${g.has(M.id)?" earned":" locked"}`,children:M.img?a.jsx("img",{src:M.img,alt:M.name,className:"bdg-modal-img"}):a.jsx("div",{className:"bdg-modal-placeholder",children:a.jsxs("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("circle",{cx:"12",cy:"8",r:"6"}),a.jsx("path",{d:"M9 14l-4 8h14l-4-8"})]})})}),a.jsx("h2",{className:"bdg-modal-name",children:M.name}),a.jsx("p",{className:"bdg-modal-desc",children:M.desc}),g.has(M.id)?a.jsxs("span",{className:"bdg-modal-status earned",children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})}),"Earned",p[M.id]?.earnedAt?`  ${new Date(p[M.id].earnedAt).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}`:""]}):a.jsxs("span",{className:"bdg-modal-status locked",children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),"Locked"]}),a.jsx("button",{className:"bdg-modal-close",onClick:()=>H(null),children:"Close"})]})}),a.jsx(ni,{active:"badges"})]})}const bP=w.lazy(()=>Zs(()=>import("./Dashboard-BlKUnihI.js"),__vite__mapDeps([0,1,2]))),wP=w.lazy(()=>Zs(()=>import("./AddClient-nj7LQUz6.js"),__vite__mapDeps([3,4]))),xP=w.lazy(()=>Zs(()=>import("./ClientDashboard-CUl34LSt.js"),__vite__mapDeps([5,1,6]))),_P=w.lazy(()=>Zs(()=>import("./ClientForms-CAY9CmWU.js"),__vite__mapDeps([7,8,6]))),kP=w.lazy(()=>Zs(()=>import("./ClientTools-C_EP5TXd.js"),__vite__mapDeps([9,10,6]))),jP=w.lazy(()=>Zs(()=>import("./MacroCalculator-DBelHl22.js"),__vite__mapDeps([11,10,6]))),EP=w.lazy(()=>Zs(()=>import("./ProteinSnacks-DtoUdsEK.js"),__vite__mapDeps([12,10,6]))),TP=w.lazy(()=>Zs(()=>import("./DailyMotivation-zgkCwfUE.js"),__vite__mapDeps([13,10,6]))),SP=w.lazy(()=>Zs(()=>import("./CircuitDashboard-CXEFpiuj.js"),__vite__mapDeps([14,15]))),CP=w.lazy(()=>Zs(()=>import("./CircuitBooking-UZHzgBsQ.js"),__vite__mapDeps([16,17,15]))),NP=w.lazy(()=>Zs(()=>import("./PersonalBests-trzGCfTU.js"),__vite__mapDeps([18,19,6]))),AP=w.lazy(()=>Zs(()=>import("./Leaderboard-Cz_McCrw.js"),__vite__mapDeps([20,21]))),RP=w.lazy(()=>Zs(()=>import("./UpgradePage-CmxCGVE9.js"),__vite__mapDeps([22,23,24]))),IP=w.lazy(()=>Zs(()=>import("./SignUp-DXpz2Rtm.js"),[])),MP=w.lazy(()=>Zs(()=>import("./Onboarding-D3J1_eqY.js"),__vite__mapDeps([25,23,26])));function DP({children:s}){const{pathname:e}=Ui();return w.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),w.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),s}function LP(){const s=Hs();return w.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const t=e.replace("/login","")||"/";s(t,{replace:!0})}},[s]),null}function PP(){return a.jsx(s3,{children:a.jsx(n3,{children:a.jsx(l3,{children:a.jsxs(dC,{basename:"/login",children:[a.jsx(LP,{}),a.jsx(DP,{children:a.jsx(w.Suspense,{fallback:a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"60vh"},children:a.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})}),children:a.jsxs(BS,{children:[a.jsx(Sn,{path:"/",element:a.jsx(h3,{})}),a.jsx(Sn,{path:"/login",element:a.jsx(u3,{})}),a.jsx(Sn,{path:"/dashboard",element:a.jsx(bP,{})}),a.jsx(Sn,{path:"/add-client",element:a.jsx(wP,{})}),a.jsx(Sn,{path:"/client",element:a.jsx(xP,{})}),a.jsx(Sn,{path:"/client/forms",element:a.jsx(_P,{})}),a.jsx(Sn,{path:"/client/tools",element:a.jsx(kP,{})}),a.jsx(Sn,{path:"/client/tools/macros",element:a.jsx(jP,{})}),a.jsx(Sn,{path:"/client/tools/snacks",element:a.jsx(EP,{})}),a.jsx(Sn,{path:"/client/tools/motivation",element:a.jsx(TP,{})}),a.jsx(Sn,{path:"/client/personal-bests",element:a.jsx(NP,{})}),a.jsx(Sn,{path:"/client/circuit",element:a.jsx(SP,{})}),a.jsx(Sn,{path:"/client/circuit/booking",element:a.jsx(CP,{})}),a.jsx(Sn,{path:"/client/core-buddy",element:a.jsx(L3,{})}),a.jsx(Sn,{path:"/client/core-buddy/nutrition",element:a.jsx(yh,{feature:"nutrition",children:a.jsx(V3,{})})}),a.jsx(Sn,{path:"/client/core-buddy/workouts",element:a.jsx(_5,{})}),a.jsx(Sn,{path:"/client/core-buddy/consistency",element:a.jsx(yh,{feature:"consistency",children:a.jsx(C5,{})})}),a.jsx(Sn,{path:"/client/core-buddy/buddies",element:a.jsx(yh,{feature:"buddies",children:a.jsx(A5,{})})}),a.jsx(Sn,{path:"/client/core-buddy/builder",element:a.jsx(D5,{})}),a.jsx(Sn,{path:"/client/core-buddy/profile/:userId",element:a.jsx(I5,{})}),a.jsx(Sn,{path:"/client/core-buddy/settings",element:a.jsx(fP,{})}),a.jsx(Sn,{path:"/client/core-buddy/challenges",element:a.jsx(gP,{})}),a.jsx(Sn,{path:"/client/core-buddy/badges",element:a.jsx(vP,{})}),a.jsx(Sn,{path:"/client/leaderboard",element:a.jsx(yh,{feature:"leaderboard",children:a.jsx(AP,{})})}),a.jsx(Sn,{path:"/signup",element:a.jsx(IP,{})}),a.jsx(Sn,{path:"/onboarding",element:a.jsx(MP,{})}),a.jsx(Sn,{path:"/upgrade",element:a.jsx(RP,{})}),a.jsx(Sn,{path:"*",element:a.jsx(Ax,{to:"/",replace:!0})})]})})})]})})})})}BT.createRoot(document.getElementById("root")).render(a.jsx(w.StrictMode,{children:a.jsx(PP,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/login/sw.js").then(s=>{setInterval(()=>s.update(),3600*1e3)}).catch(s=>console.warn("SW registration failed:",s))});export{Cj as A,Wl as B,ni as C,OP as D,xs as E,nl as P,Bt as T,or as a,ar as b,ut as c,pe as d,ze as e,n4 as f,$t as g,o4 as h,Wn as i,a as j,_s as k,_r as l,Bi as m,Hs as n,UP as o,Aj as p,tn as q,w as r,BP as s,pC as t,zn as u,zP as v,Ot as w,ef as x,dc as y,Nj as z};
