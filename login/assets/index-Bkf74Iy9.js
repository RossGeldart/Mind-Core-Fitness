const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-Didbj82H.js","assets/scheduleUtils-a2tn0x12.js","assets/Dashboard-BvdLF0uv.css","assets/AddClient-CEURoo_P.js","assets/AddClient-DH1OFzHo.css","assets/ClientDashboard-BtpjbWY3.js","assets/ClientDashboard-BI8UXFpK.css","assets/ClientForms-oTMOD_Kq.js","assets/ClientForms-GDNtnrAx.css","assets/ClientTools-DqdrkZjN.js","assets/ClientTools-DQRPoST3.css","assets/MacroCalculator-BMs9SNTG.js","assets/ProteinSnacks-B9LW55bJ.js","assets/DailyMotivation-D8l-5pfD.js","assets/CircuitDashboard-B4AmunNQ.js","assets/CircuitDashboard-C8T0uect.css","assets/CircuitBooking-CnZghVFB.js","assets/CircuitBooking-ruk9Q4Wj.css","assets/PersonalBests-Bz2lGqLf.js","assets/PersonalBests-BkG3fixu.css","assets/Leaderboard-wZmPc9si.js","assets/Leaderboard-Dq-r5svP.css","assets/UpgradePage-B0DQ7ZRk.js","assets/stripe-Da7IPrZW.js","assets/UpgradePage-Chom0F_j.css","assets/Onboarding-B8Lxhvqw.js","assets/Onboarding-DvZF-mkH.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const h of u.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function t(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(l){if(l.ep)return;l.ep=!0;const u=t(l);fetch(l.href,u)}})();var _p={exports:{}},Fc={};var Vb;function vS(){if(Vb)return Fc;Vb=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,l,u){var h=null;if(u!==void 0&&(h=""+u),l.key!==void 0&&(h=""+l.key),"key"in l){u={};for(var p in l)p!=="key"&&(u[p]=l[p])}else u=l;return l=u.ref,{$$typeof:s,type:i,key:h,ref:l!==void 0?l:null,props:u}}return Fc.Fragment=e,Fc.jsx=t,Fc.jsxs=t,Fc}var Ub;function bS(){return Ub||(Ub=1,_p.exports=vS()),_p.exports}var a=bS(),xp={exports:{}},Ct={};var Bb;function wS(){if(Bb)return Ct;Bb=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),h=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),E=Symbol.for("react.activity"),T=Symbol.iterator;function O(L){return L===null||typeof L!="object"?null:(L=T&&L[T]||L["@@iterator"],typeof L=="function"?L:null)}var H={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},q=Object.assign,B={};function X(L,ie,we){this.props=L,this.context=ie,this.refs=B,this.updater=we||H}X.prototype.isReactComponent={},X.prototype.setState=function(L,ie){if(typeof L!="object"&&typeof L!="function"&&L!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,L,ie,"setState")},X.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,"forceUpdate")};function W(){}W.prototype=X.prototype;function Y(L,ie,we){this.props=L,this.context=ie,this.refs=B,this.updater=we||H}var de=Y.prototype=new W;de.constructor=Y,q(de,X.prototype),de.isPureReactComponent=!0;var xe=Array.isArray;function ve(){}var j={H:null,A:null,T:null,S:null},S=Object.prototype.hasOwnProperty;function I(L,ie,we){var ke=we.ref;return{$$typeof:s,type:L,key:ie,ref:ke!==void 0?ke:null,props:we}}function V(L,ie){return I(L.type,ie,L.props)}function D(L){return typeof L=="object"&&L!==null&&L.$$typeof===s}function M(L){var ie={"=":"=0",":":"=2"};return"$"+L.replace(/[=:]/g,function(we){return ie[we]})}var A=/\/+/g;function Be(L,ie){return typeof L=="object"&&L!==null&&L.key!=null?M(""+L.key):ie.toString(36)}function Ze(L){switch(L.status){case"fulfilled":return L.value;case"rejected":throw L.reason;default:switch(typeof L.status=="string"?L.then(ve,ve):(L.status="pending",L.then(function(ie){L.status==="pending"&&(L.status="fulfilled",L.value=ie)},function(ie){L.status==="pending"&&(L.status="rejected",L.reason=ie)})),L.status){case"fulfilled":return L.value;case"rejected":throw L.reason}}throw L}function te(L,ie,we,ke,Te){var Ee=typeof L;(Ee==="undefined"||Ee==="boolean")&&(L=null);var Ke=!1;if(L===null)Ke=!0;else switch(Ee){case"bigint":case"string":case"number":Ke=!0;break;case"object":switch(L.$$typeof){case s:case e:Ke=!0;break;case b:return Ke=L._init,te(Ke(L._payload),ie,we,ke,Te)}}if(Ke)return Te=Te(L),Ke=ke===""?"."+Be(L,0):ke,xe(Te)?(we="",Ke!=null&&(we=Ke.replace(A,"$&/")+"/"),te(Te,ie,we,"",function(tn){return tn})):Te!=null&&(D(Te)&&(Te=V(Te,we+(Te.key==null||L&&L.key===Te.key?"":(""+Te.key).replace(A,"$&/")+"/")+Ke)),ie.push(Te)),1;Ke=0;var ct=ke===""?".":ke+":";if(xe(L))for(var Ve=0;Ve<L.length;Ve++)ke=L[Ve],Ee=ct+Be(ke,Ve),Ke+=te(ke,ie,we,Ee,Te);else if(Ve=O(L),typeof Ve=="function")for(L=Ve.call(L),Ve=0;!(ke=L.next()).done;)ke=ke.value,Ee=ct+Be(ke,Ve++),Ke+=te(ke,ie,we,Ee,Te);else if(Ee==="object"){if(typeof L.then=="function")return te(Ze(L),ie,we,ke,Te);throw ie=String(L),Error("Objects are not valid as a React child (found: "+(ie==="[object Object]"?"object with keys {"+Object.keys(L).join(", ")+"}":ie)+"). If you meant to render a collection of children, use an array instead.")}return Ke}function _e(L,ie,we){if(L==null)return L;var ke=[],Te=0;return te(L,ke,"","",function(Ee){return ie.call(we,Ee,Te++)}),ke}function Ie(L){if(L._status===-1){var ie=L._result;ie=ie(),ie.then(function(we){(L._status===0||L._status===-1)&&(L._status=1,L._result=we)},function(we){(L._status===0||L._status===-1)&&(L._status=2,L._result=we)}),L._status===-1&&(L._status=0,L._result=ie)}if(L._status===1)return L._result.default;throw L._result}var ze=typeof reportError=="function"?reportError:function(L){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ie=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof L=="object"&&L!==null&&typeof L.message=="string"?String(L.message):String(L),error:L});if(!window.dispatchEvent(ie))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",L);return}console.error(L)},re={map:_e,forEach:function(L,ie,we){_e(L,function(){ie.apply(this,arguments)},we)},count:function(L){var ie=0;return _e(L,function(){ie++}),ie},toArray:function(L){return _e(L,function(ie){return ie})||[]},only:function(L){if(!D(L))throw Error("React.Children.only expected to receive a single React element child.");return L}};return Ct.Activity=E,Ct.Children=re,Ct.Component=X,Ct.Fragment=t,Ct.Profiler=l,Ct.PureComponent=Y,Ct.StrictMode=i,Ct.Suspense=g,Ct.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=j,Ct.__COMPILER_RUNTIME={__proto__:null,c:function(L){return j.H.useMemoCache(L)}},Ct.cache=function(L){return function(){return L.apply(null,arguments)}},Ct.cacheSignal=function(){return null},Ct.cloneElement=function(L,ie,we){if(L==null)throw Error("The argument must be a React element, but you passed "+L+".");var ke=q({},L.props),Te=L.key;if(ie!=null)for(Ee in ie.key!==void 0&&(Te=""+ie.key),ie)!S.call(ie,Ee)||Ee==="key"||Ee==="__self"||Ee==="__source"||Ee==="ref"&&ie.ref===void 0||(ke[Ee]=ie[Ee]);var Ee=arguments.length-2;if(Ee===1)ke.children=we;else if(1<Ee){for(var Ke=Array(Ee),ct=0;ct<Ee;ct++)Ke[ct]=arguments[ct+2];ke.children=Ke}return I(L.type,Te,ke)},Ct.createContext=function(L){return L={$$typeof:h,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null},L.Provider=L,L.Consumer={$$typeof:u,_context:L},L},Ct.createElement=function(L,ie,we){var ke,Te={},Ee=null;if(ie!=null)for(ke in ie.key!==void 0&&(Ee=""+ie.key),ie)S.call(ie,ke)&&ke!=="key"&&ke!=="__self"&&ke!=="__source"&&(Te[ke]=ie[ke]);var Ke=arguments.length-2;if(Ke===1)Te.children=we;else if(1<Ke){for(var ct=Array(Ke),Ve=0;Ve<Ke;Ve++)ct[Ve]=arguments[Ve+2];Te.children=ct}if(L&&L.defaultProps)for(ke in Ke=L.defaultProps,Ke)Te[ke]===void 0&&(Te[ke]=Ke[ke]);return I(L,Ee,Te)},Ct.createRef=function(){return{current:null}},Ct.forwardRef=function(L){return{$$typeof:p,render:L}},Ct.isValidElement=D,Ct.lazy=function(L){return{$$typeof:b,_payload:{_status:-1,_result:L},_init:Ie}},Ct.memo=function(L,ie){return{$$typeof:y,type:L,compare:ie===void 0?null:ie}},Ct.startTransition=function(L){var ie=j.T,we={};j.T=we;try{var ke=L(),Te=j.S;Te!==null&&Te(we,ke),typeof ke=="object"&&ke!==null&&typeof ke.then=="function"&&ke.then(ve,ze)}catch(Ee){ze(Ee)}finally{ie!==null&&we.types!==null&&(ie.types=we.types),j.T=ie}},Ct.unstable_useCacheRefresh=function(){return j.H.useCacheRefresh()},Ct.use=function(L){return j.H.use(L)},Ct.useActionState=function(L,ie,we){return j.H.useActionState(L,ie,we)},Ct.useCallback=function(L,ie){return j.H.useCallback(L,ie)},Ct.useContext=function(L){return j.H.useContext(L)},Ct.useDebugValue=function(){},Ct.useDeferredValue=function(L,ie){return j.H.useDeferredValue(L,ie)},Ct.useEffect=function(L,ie){return j.H.useEffect(L,ie)},Ct.useEffectEvent=function(L){return j.H.useEffectEvent(L)},Ct.useId=function(){return j.H.useId()},Ct.useImperativeHandle=function(L,ie,we){return j.H.useImperativeHandle(L,ie,we)},Ct.useInsertionEffect=function(L,ie){return j.H.useInsertionEffect(L,ie)},Ct.useLayoutEffect=function(L,ie){return j.H.useLayoutEffect(L,ie)},Ct.useMemo=function(L,ie){return j.H.useMemo(L,ie)},Ct.useOptimistic=function(L,ie){return j.H.useOptimistic(L,ie)},Ct.useReducer=function(L,ie,we){return j.H.useReducer(L,ie,we)},Ct.useRef=function(L){return j.H.useRef(L)},Ct.useState=function(L){return j.H.useState(L)},Ct.useSyncExternalStore=function(L,ie,we){return j.H.useSyncExternalStore(L,ie,we)},Ct.useTransition=function(){return j.H.useTransition()},Ct.version="19.2.4",Ct}var zb;function Wg(){return zb||(zb=1,xp.exports=wS()),xp.exports}var _=Wg(),Ep={exports:{}},qc={},Tp={exports:{}},kp={};var Fb;function _S(){return Fb||(Fb=1,(function(s){function e(te,_e){var Ie=te.length;te.push(_e);e:for(;0<Ie;){var ze=Ie-1>>>1,re=te[ze];if(0<l(re,_e))te[ze]=_e,te[Ie]=re,Ie=ze;else break e}}function t(te){return te.length===0?null:te[0]}function i(te){if(te.length===0)return null;var _e=te[0],Ie=te.pop();if(Ie!==_e){te[0]=Ie;e:for(var ze=0,re=te.length,L=re>>>1;ze<L;){var ie=2*(ze+1)-1,we=te[ie],ke=ie+1,Te=te[ke];if(0>l(we,Ie))ke<re&&0>l(Te,we)?(te[ze]=Te,te[ke]=Ie,ze=ke):(te[ze]=we,te[ie]=Ie,ze=ie);else if(ke<re&&0>l(Te,Ie))te[ze]=Te,te[ke]=Ie,ze=ke;else break e}}return _e}function l(te,_e){var Ie=te.sortIndex-_e.sortIndex;return Ie!==0?Ie:te.id-_e.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;s.unstable_now=function(){return u.now()}}else{var h=Date,p=h.now();s.unstable_now=function(){return h.now()-p}}var g=[],y=[],b=1,E=null,T=3,O=!1,H=!1,q=!1,B=!1,X=typeof setTimeout=="function"?setTimeout:null,W=typeof clearTimeout=="function"?clearTimeout:null,Y=typeof setImmediate<"u"?setImmediate:null;function de(te){for(var _e=t(y);_e!==null;){if(_e.callback===null)i(y);else if(_e.startTime<=te)i(y),_e.sortIndex=_e.expirationTime,e(g,_e);else break;_e=t(y)}}function xe(te){if(q=!1,de(te),!H)if(t(g)!==null)H=!0,ve||(ve=!0,M());else{var _e=t(y);_e!==null&&Ze(xe,_e.startTime-te)}}var ve=!1,j=-1,S=5,I=-1;function V(){return B?!0:!(s.unstable_now()-I<S)}function D(){if(B=!1,ve){var te=s.unstable_now();I=te;var _e=!0;try{e:{H=!1,q&&(q=!1,W(j),j=-1),O=!0;var Ie=T;try{t:{for(de(te),E=t(g);E!==null&&!(E.expirationTime>te&&V());){var ze=E.callback;if(typeof ze=="function"){E.callback=null,T=E.priorityLevel;var re=ze(E.expirationTime<=te);if(te=s.unstable_now(),typeof re=="function"){E.callback=re,de(te),_e=!0;break t}E===t(g)&&i(g),de(te)}else i(g);E=t(g)}if(E!==null)_e=!0;else{var L=t(y);L!==null&&Ze(xe,L.startTime-te),_e=!1}}break e}finally{E=null,T=Ie,O=!1}_e=void 0}}finally{_e?M():ve=!1}}}var M;if(typeof Y=="function")M=function(){Y(D)};else if(typeof MessageChannel<"u"){var A=new MessageChannel,Be=A.port2;A.port1.onmessage=D,M=function(){Be.postMessage(null)}}else M=function(){X(D,0)};function Ze(te,_e){j=X(function(){te(s.unstable_now())},_e)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(te){te.callback=null},s.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<te?Math.floor(1e3/te):5},s.unstable_getCurrentPriorityLevel=function(){return T},s.unstable_next=function(te){switch(T){case 1:case 2:case 3:var _e=3;break;default:_e=T}var Ie=T;T=_e;try{return te()}finally{T=Ie}},s.unstable_requestPaint=function(){B=!0},s.unstable_runWithPriority=function(te,_e){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var Ie=T;T=te;try{return _e()}finally{T=Ie}},s.unstable_scheduleCallback=function(te,_e,Ie){var ze=s.unstable_now();switch(typeof Ie=="object"&&Ie!==null?(Ie=Ie.delay,Ie=typeof Ie=="number"&&0<Ie?ze+Ie:ze):Ie=ze,te){case 1:var re=-1;break;case 2:re=250;break;case 5:re=1073741823;break;case 4:re=1e4;break;default:re=5e3}return re=Ie+re,te={id:b++,callback:_e,priorityLevel:te,startTime:Ie,expirationTime:re,sortIndex:-1},Ie>ze?(te.sortIndex=Ie,e(y,te),t(g)===null&&te===t(y)&&(q?(W(j),j=-1):q=!0,Ze(xe,Ie-ze))):(te.sortIndex=re,e(g,te),H||O||(H=!0,ve||(ve=!0,M()))),te},s.unstable_shouldYield=V,s.unstable_wrapCallback=function(te){var _e=T;return function(){var Ie=T;T=_e;try{return te.apply(this,arguments)}finally{T=Ie}}}})(kp)),kp}var qb;function xS(){return qb||(qb=1,Tp.exports=_S()),Tp.exports}var Sp={exports:{}},Fs={};var Hb;function ES(){if(Hb)return Fs;Hb=1;var s=Wg();function e(g){var y="https://react.dev/errors/"+g;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)y+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+g+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(g,y,b){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:E==null?null:""+E,children:g,containerInfo:y,implementation:b}}var h=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(g,y){if(g==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return Fs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Fs.createPortal=function(g,y){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return u(g,y,null,b)},Fs.flushSync=function(g){var y=h.T,b=i.p;try{if(h.T=null,i.p=2,g)return g()}finally{h.T=y,i.p=b,i.d.f()}},Fs.preconnect=function(g,y){typeof g=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,i.d.C(g,y))},Fs.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},Fs.preinit=function(g,y){if(typeof g=="string"&&y&&typeof y.as=="string"){var b=y.as,E=p(b,y.crossOrigin),T=typeof y.integrity=="string"?y.integrity:void 0,O=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;b==="style"?i.d.S(g,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:E,integrity:T,fetchPriority:O}):b==="script"&&i.d.X(g,{crossOrigin:E,integrity:T,fetchPriority:O,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},Fs.preinitModule=function(g,y){if(typeof g=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var b=p(y.as,y.crossOrigin);i.d.M(g,{crossOrigin:b,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&i.d.M(g)},Fs.preload=function(g,y){if(typeof g=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var b=y.as,E=p(b,y.crossOrigin);i.d.L(g,b,{crossOrigin:E,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},Fs.preloadModule=function(g,y){if(typeof g=="string")if(y){var b=p(y.as,y.crossOrigin);i.d.m(g,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:b,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else i.d.m(g)},Fs.requestFormReset=function(g){i.d.r(g)},Fs.unstable_batchedUpdates=function(g,y){return g(y)},Fs.useFormState=function(g,y,b){return h.H.useFormState(g,y,b)},Fs.useFormStatus=function(){return h.H.useHostTransitionStatus()},Fs.version="19.2.4",Fs}var $b;function TS(){if($b)return Sp.exports;$b=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Sp.exports=ES(),Sp.exports}var Wb;function kS(){if(Wb)return qc;Wb=1;var s=xS(),e=Wg(),t=TS();function i(n){var r="https://react.dev/errors/"+n;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+n+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function u(n){var r=n,o=n;if(n.alternate)for(;r.return;)r=r.return;else{n=r;do r=n,(r.flags&4098)!==0&&(o=r.return),n=r.return;while(n)}return r.tag===3?o:null}function h(n){if(n.tag===13){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function p(n){if(n.tag===31){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function g(n){if(u(n)!==n)throw Error(i(188))}function y(n){var r=n.alternate;if(!r){if(r=u(n),r===null)throw Error(i(188));return r!==n?null:n}for(var o=n,c=r;;){var f=o.return;if(f===null)break;var m=f.alternate;if(m===null){if(c=f.return,c!==null){o=c;continue}break}if(f.child===m.child){for(m=f.child;m;){if(m===o)return g(f),n;if(m===c)return g(f),r;m=m.sibling}throw Error(i(188))}if(o.return!==c.return)o=f,c=m;else{for(var w=!1,k=f.child;k;){if(k===o){w=!0,o=f,c=m;break}if(k===c){w=!0,c=f,o=m;break}k=k.sibling}if(!w){for(k=m.child;k;){if(k===o){w=!0,o=m,c=f;break}if(k===c){w=!0,c=m,o=f;break}k=k.sibling}if(!w)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?n:r}function b(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n;for(n=n.child;n!==null;){if(r=b(n),r!==null)return r;n=n.sibling}return null}var E=Object.assign,T=Symbol.for("react.element"),O=Symbol.for("react.transitional.element"),H=Symbol.for("react.portal"),q=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),X=Symbol.for("react.profiler"),W=Symbol.for("react.consumer"),Y=Symbol.for("react.context"),de=Symbol.for("react.forward_ref"),xe=Symbol.for("react.suspense"),ve=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),V=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function M(n){return n===null||typeof n!="object"?null:(n=D&&n[D]||n["@@iterator"],typeof n=="function"?n:null)}var A=Symbol.for("react.client.reference");function Be(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===A?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case q:return"Fragment";case X:return"Profiler";case B:return"StrictMode";case xe:return"Suspense";case ve:return"SuspenseList";case I:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case H:return"Portal";case Y:return n.displayName||"Context";case W:return(n._context.displayName||"Context")+".Consumer";case de:var r=n.render;return n=n.displayName,n||(n=r.displayName||r.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case j:return r=n.displayName||null,r!==null?r:Be(n.type)||"Memo";case S:r=n._payload,n=n._init;try{return Be(n(r))}catch{}}return null}var Ze=Array.isArray,te=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,_e=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ie={pending:!1,data:null,method:null,action:null},ze=[],re=-1;function L(n){return{current:n}}function ie(n){0>re||(n.current=ze[re],ze[re]=null,re--)}function we(n,r){re++,ze[re]=n.current,n.current=r}var ke=L(null),Te=L(null),Ee=L(null),Ke=L(null);function ct(n,r){switch(we(Ee,r),we(Te,n),we(ke,null),r.nodeType){case 9:case 11:n=(n=r.documentElement)&&(n=n.namespaceURI)?ob(n):0;break;default:if(n=r.tagName,r=r.namespaceURI)r=ob(r),n=lb(r,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}ie(ke),we(ke,n)}function Ve(){ie(ke),ie(Te),ie(Ee)}function tn(n){n.memoizedState!==null&&we(Ke,n);var r=ke.current,o=lb(r,n.type);r!==o&&(we(Te,n),we(ke,o))}function jn(n){Te.current===n&&(ie(ke),ie(Te)),Ke.current===n&&(ie(Ke),Vc._currentValue=Ie)}var Un,Lt;function rt(n){if(Un===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);Un=r&&r[1]||"",Lt=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Un+n+Lt}var gt=!1;function ut(n,r){if(!n||gt)return"";gt=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var ye=function(){throw Error()};if(Object.defineProperty(ye.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ye,[])}catch(he){var se=he}Reflect.construct(n,[],ye)}else{try{ye.call()}catch(he){se=he}n.call(ye.prototype)}}else{try{throw Error()}catch(he){se=he}(ye=n())&&typeof ye.catch=="function"&&ye.catch(function(){})}}catch(he){if(he&&se&&typeof he.stack=="string")return[he.stack,se.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=c.DetermineComponentFrameRoot(),w=m[0],k=m[1];if(w&&k){var U=w.split(`
`),ee=k.split(`
`);for(f=c=0;c<U.length&&!U[c].includes("DetermineComponentFrameRoot");)c++;for(;f<ee.length&&!ee[f].includes("DetermineComponentFrameRoot");)f++;if(c===U.length||f===ee.length)for(c=U.length-1,f=ee.length-1;1<=c&&0<=f&&U[c]!==ee[f];)f--;for(;1<=c&&0<=f;c--,f--)if(U[c]!==ee[f]){if(c!==1||f!==1)do if(c--,f--,0>f||U[c]!==ee[f]){var fe=`
`+U[c].replace(" at new "," at ");return n.displayName&&fe.includes("<anonymous>")&&(fe=fe.replace("<anonymous>",n.displayName)),fe}while(1<=c&&0<=f);break}}}finally{gt=!1,Error.prepareStackTrace=o}return(o=n?n.displayName||n.name:"")?rt(o):""}function Bn(n,r){switch(n.tag){case 26:case 27:case 5:return rt(n.type);case 16:return rt("Lazy");case 13:return n.child!==r&&r!==null?rt("Suspense Fallback"):rt("Suspense");case 19:return rt("SuspenseList");case 0:case 15:return ut(n.type,!1);case 11:return ut(n.type.render,!1);case 1:return ut(n.type,!0);case 31:return rt("Activity");default:return""}}function ue(n){try{var r="",o=null;do r+=Bn(n,o),o=n,n=n.return;while(n);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Rt=Object.prototype.hasOwnProperty,yt=s.unstable_scheduleCallback,Vt=s.unstable_cancelCallback,Je=s.unstable_shouldYield,At=s.unstable_requestPaint,vt=s.unstable_now,nn=s.unstable_getCurrentPriorityLevel,js=s.unstable_ImmediatePriority,rs=s.unstable_UserBlockingPriority,Xt=s.unstable_NormalPriority,ne=s.unstable_LowPriority,Ne=s.unstable_IdlePriority,xt=s.log,bt=s.unstable_setDisableYieldValue,it=null,$e=null;function st(n){if(typeof xt=="function"&&bt(n),$e&&typeof $e.setStrictMode=="function")try{$e.setStrictMode(it,n)}catch{}}var Fe=Math.clz32?Math.clz32:Ln,sn=Math.log,on=Math.LN2;function Ln(n){return n>>>=0,n===0?32:31-(sn(n)/on|0)|0}var zn=256,Xn=262144,Yt=4194304;function Fn(n){var r=n&42;if(r!==0)return r;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Cn(n,r,o){var c=n.pendingLanes;if(c===0)return 0;var f=0,m=n.suspendedLanes,w=n.pingedLanes;n=n.warmLanes;var k=c&134217727;return k!==0?(c=k&~m,c!==0?f=Fn(c):(w&=k,w!==0?f=Fn(w):o||(o=k&~n,o!==0&&(f=Fn(o))))):(k=c&~m,k!==0?f=Fn(k):w!==0?f=Fn(w):o||(o=c&~n,o!==0&&(f=Fn(o)))),f===0?0:r!==0&&r!==f&&(r&m)===0&&(m=f&-f,o=r&-r,m>=o||m===32&&(o&4194048)!==0)?r:f}function ln(n,r){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&r)===0}function yr(n,r){switch(n){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function oe(){var n=Yt;return Yt<<=1,(Yt&62914560)===0&&(Yt=4194304),n}function Ae(n){for(var r=[],o=0;31>o;o++)r.push(n);return r}function Ge(n,r){n.pendingLanes|=r,r!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function mt(n,r,o,c,f,m){var w=n.pendingLanes;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=o,n.entangledLanes&=o,n.errorRecoveryDisabledLanes&=o,n.shellSuspendCounter=0;var k=n.entanglements,U=n.expirationTimes,ee=n.hiddenUpdates;for(o=w&~o;0<o;){var fe=31-Fe(o),ye=1<<fe;k[fe]=0,U[fe]=-1;var se=ee[fe];if(se!==null)for(ee[fe]=null,fe=0;fe<se.length;fe++){var he=se[fe];he!==null&&(he.lane&=-536870913)}o&=~ye}c!==0&&lt(n,c,0),m!==0&&f===0&&n.tag!==0&&(n.suspendedLanes|=m&~(w&~r))}function lt(n,r,o){n.pendingLanes|=r,n.suspendedLanes&=~r;var c=31-Fe(r);n.entangledLanes|=r,n.entanglements[c]=n.entanglements[c]|1073741824|o&261930}function vn(n,r){var o=n.entangledLanes|=r;for(n=n.entanglements;o;){var c=31-Fe(o),f=1<<c;f&r|n[c]&r&&(n[c]|=r),o&=~f}}function Nn(n,r){var o=r&-r;return o=(o&42)!==0?1:dn(o),(o&(n.suspendedLanes|r))!==0?0:o}function dn(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function bn(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function Cs(){var n=_e.p;return n!==0?n:(n=window.event,n===void 0?32:Rb(n.type))}function is(n,r){var o=_e.p;try{return _e.p=n,r()}finally{_e.p=o}}var ds=Math.random().toString(36).slice(2),Jt="__reactFiber$"+ds,An="__reactProps$"+ds,Ns="__reactContainer$"+ds,Ar="__reactEvents$"+ds,di="__reactListeners$"+ds,Rr="__reactHandles$"+ds,Ir="__reactResources$"+ds,qn="__reactMarker$"+ds;function Ks(n){delete n[Jt],delete n[An],delete n[Ar],delete n[di],delete n[Rr]}function _s(n){var r=n[Jt];if(r)return r;for(var o=n.parentNode;o;){if(r=o[Ns]||o[Jt]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(n=pb(n);n!==null;){if(o=n[Jt])return o;n=pb(n)}return r}n=o,o=n.parentNode}return null}function kn(n){if(n=n[Jt]||n[Ns]){var r=n.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return n}return null}function On(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n.stateNode;throw Error(i(33))}function as(n){var r=n[Ir];return r||(r=n[Ir]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function zt(n){n[qn]=!0}var Qr=new Set,Dr={};function xs(n,r){wn(n,r),wn(n+"Capture",r)}function wn(n,r){for(Dr[n]=r,n=0;n<r.length;n++)Qr.add(r[n])}var rr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),fi={},R={};function z(n){return Rt.call(R,n)?!0:Rt.call(fi,n)?!1:rr.test(n)?R[n]=!0:(fi[n]=!0,!1)}function ae(n,r,o){if(z(r))if(o===null)n.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":n.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){n.removeAttribute(r);return}}n.setAttribute(r,""+o)}}function le(n,r,o){if(o===null)n.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(r);return}n.setAttribute(r,""+o)}}function Me(n,r,o,c){if(c===null)n.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttributeNS(r,o,""+c)}}function Le(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function He(n){var r=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function Ft(n,r,o){var c=Object.getOwnPropertyDescriptor(n.constructor.prototype,r);if(!n.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var f=c.get,m=c.set;return Object.defineProperty(n,r,{configurable:!0,get:function(){return f.call(this)},set:function(w){o=""+w,m.call(this,w)}}),Object.defineProperty(n,r,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(w){o=""+w},stopTracking:function(){n._valueTracker=null,delete n[r]}}}}function Ye(n){if(!n._valueTracker){var r=He(n)?"checked":"value";n._valueTracker=Ft(n,r,""+n[r])}}function Kn(n){if(!n)return!1;var r=n._valueTracker;if(!r)return!0;var o=r.getValue(),c="";return n&&(c=He(n)?n.checked?"true":"false":n.value),n=c,n!==o?(r.setValue(n),!0):!1}function os(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var Vs=/[\n"\\]/g;function Yn(n){return n.replace(Vs,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function vr(n,r,o,c,f,m,w,k){n.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?n.type=w:n.removeAttribute("type"),r!=null?w==="number"?(r===0&&n.value===""||n.value!=r)&&(n.value=""+Le(r)):n.value!==""+Le(r)&&(n.value=""+Le(r)):w!=="submit"&&w!=="reset"||n.removeAttribute("value"),r!=null?Di(n,w,Le(r)):o!=null?Di(n,w,Le(o)):c!=null&&n.removeAttribute("value"),f==null&&m!=null&&(n.defaultChecked=!!m),f!=null&&(n.checked=f&&typeof f!="function"&&typeof f!="symbol"),k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?n.name=""+Le(k):n.removeAttribute("name")}function fa(n,r,o,c,f,m,w,k){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(n.type=m),r!=null||o!=null){if(!(m!=="submit"&&m!=="reset"||r!=null)){Ye(n);return}o=o!=null?""+Le(o):"",r=r!=null?""+Le(r):o,k||r===n.value||(n.value=r),n.defaultValue=r}c=c??f,c=typeof c!="function"&&typeof c!="symbol"&&!!c,n.checked=k?n.checked:!!c,n.defaultChecked=!!c,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(n.name=w),Ye(n)}function Di(n,r,o){r==="number"&&os(n.ownerDocument)===n||n.defaultValue===""+o||(n.defaultValue=""+o)}function Mr(n,r,o,c){if(n=n.options,r){r={};for(var f=0;f<o.length;f++)r["$"+o[f]]=!0;for(o=0;o<n.length;o++)f=r.hasOwnProperty("$"+n[o].value),n[o].selected!==f&&(n[o].selected=f),f&&c&&(n[o].defaultSelected=!0)}else{for(o=""+Le(o),r=null,f=0;f<n.length;f++){if(n[f].value===o){n[f].selected=!0,c&&(n[f].defaultSelected=!0);return}r!==null||n[f].disabled||(r=n[f])}r!==null&&(r.selected=!0)}}function ma(n,r,o){if(r!=null&&(r=""+Le(r),r!==n.value&&(n.value=r),o==null)){n.defaultValue!==r&&(n.defaultValue=r);return}n.defaultValue=o!=null?""+Le(o):""}function Lr(n,r,o,c){if(r==null){if(c!=null){if(o!=null)throw Error(i(92));if(Ze(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),r=o}o=Le(r),n.defaultValue=o,c=n.textContent,c===o&&c!==""&&c!==null&&(n.value=c),Ye(n)}function C(n,r){if(r){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=r;return}}n.textContent=r}var G=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ce(n,r,o){var c=r.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?n.setProperty(r,""):r==="float"?n.cssFloat="":n[r]="":c?n.setProperty(r,o):typeof o!="number"||o===0||G.has(r)?r==="float"?n.cssFloat=o:n[r]=(""+o).trim():n[r]=o+"px"}function Re(n,r,o){if(r!=null&&typeof r!="object")throw Error(i(62));if(n=n.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?n.setProperty(c,""):c==="float"?n.cssFloat="":n[c]="");for(var f in r)c=r[f],r.hasOwnProperty(f)&&o[f]!==c&&Ce(n,f,c)}else for(var m in r)r.hasOwnProperty(m)&&Ce(n,m,r[m])}function Pe(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ht=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),et=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function kt(n){return et.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function dt(){}var P=null;function Q(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Z=null,pe=null;function je(n){var r=kn(n);if(r&&(n=r.stateNode)){var o=n[An]||null;e:switch(n=r.stateNode,r.type){case"input":if(vr(n,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),r=o.name,o.type==="radio"&&r!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Yn(""+r)+'"][type="radio"]'),r=0;r<o.length;r++){var c=o[r];if(c!==n&&c.form===n.form){var f=c[An]||null;if(!f)throw Error(i(90));vr(c,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(r=0;r<o.length;r++)c=o[r],c.form===n.form&&Kn(c)}break e;case"textarea":ma(n,o.value,o.defaultValue);break e;case"select":r=o.value,r!=null&&Mr(n,!!o.multiple,r,!1)}}}var Oe=!1;function qe(n,r,o){if(Oe)return n(r,o);Oe=!0;try{var c=n(r);return c}finally{if(Oe=!1,(Z!==null||pe!==null)&&(Mh(),Z&&(r=Z,n=pe,pe=Z=null,je(r),n)))for(r=0;r<n.length;r++)je(n[r])}}function pt(n,r){var o=n.stateNode;if(o===null)return null;var c=o[An]||null;if(c===null)return null;o=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(n=n.type,c=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!c;break e;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(i(231,r,typeof o));return o}var Et=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Pt=!1;if(Et)try{var Qe={};Object.defineProperty(Qe,"passive",{get:function(){Pt=!0}}),window.addEventListener("test",Qe,Qe),window.removeEventListener("test",Qe,Qe)}catch{Pt=!1}var Zt=null,Us=null,Tt=null;function Hn(){if(Tt)return Tt;var n,r=Us,o=r.length,c,f="value"in Zt?Zt.value:Zt.textContent,m=f.length;for(n=0;n<o&&r[n]===f[n];n++);var w=o-n;for(c=1;c<=w&&r[o-c]===f[m-c];c++);return Tt=f.slice(n,1<c?1-c:void 0)}function Jn(n){var r=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&r===13&&(n=13)):n=r,n===10&&(n=13),32<=n||n===13?n:0}function St(){return!0}function cn(){return!1}function Rn(n){function r(o,c,f,m,w){this._reactName=o,this._targetInst=f,this.type=c,this.nativeEvent=m,this.target=w,this.currentTarget=null;for(var k in n)n.hasOwnProperty(k)&&(o=n[k],this[k]=o?o(m):m[k]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?St:cn,this.isPropagationStopped=cn,this}return E(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=St)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=St)},persist:function(){},isPersistent:St}),r}var Bs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zs=Rn(Bs),fs=E({},Bs,{view:0,detail:0}),Ys=Rn(fs),ir,Mi,Or,mi=E({},fs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pa,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Or&&(Or&&n.type==="mousemove"?(ir=n.screenX-Or.screenX,Mi=n.screenY-Or.screenY):Mi=ir=0,Or=n),ir)},movementY:function(n){return"movementY"in n?n.movementY:Mi}}),rc=Rn(mi),oo=E({},mi,{dataTransfer:0}),Fu=Rn(oo),qu=E({},fs,{relatedTarget:0}),lo=Rn(qu),ic=E({},Bs,{animationName:0,elapsedTime:0,pseudoElement:0}),Hu=Rn(ic),Jo=E({},Bs,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),$u=Rn(Jo),Wu=E({},Bs,{data:0}),pi=Rn(Wu),Gu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ku={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Yu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Qu(n){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(n):(n=Yu[n])?!!r[n]:!1}function pa(){return Qu}var Qs=E({},fs,{key:function(n){if(n.key){var r=Gu[n.key]||n.key;if(r!=="Unidentified")return r}return n.type==="keypress"?(n=Jn(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Ku[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pa,charCode:function(n){return n.type==="keypress"?Jn(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Jn(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Xu=Rn(Qs),Ju=E({},mi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Li=Rn(Ju),d=E({},fs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pa}),v=Rn(d),x=E({},Bs,{propertyName:0,elapsedTime:0,pseudoElement:0}),N=Rn(x),K=E({},mi,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),ce=Rn(K),De=E({},Bs,{newState:0,oldState:0}),It=Rn(De),ls=[9,13,27,32],un=Et&&"CompositionEvent"in window,$n=null;Et&&"documentMode"in document&&($n=document.documentMode);var Pr=Et&&"TextEvent"in window&&!$n,gi=Et&&(!un||$n&&8<$n&&11>=$n),Xr=" ",Jr=!1;function co(n,r){switch(n){case"keyup":return ls.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Zo(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var el=!1;function FT(n,r){switch(n){case"compositionend":return Zo(r);case"keypress":return r.which!==32?null:(Jr=!0,Xr);case"textInput":return n=r.data,n===Xr&&Jr?null:n;default:return null}}function qT(n,r){if(el)return n==="compositionend"||!un&&co(n,r)?(n=Hn(),Tt=Us=Zt=null,el=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return gi&&r.locale!=="ko"?null:r.data;default:return null}}var HT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vv(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r==="input"?!!HT[n.type]:r==="textarea"}function bv(n,r,o,c){Z?pe?pe.push(c):pe=[c]:Z=c,r=zh(r,"onChange"),0<r.length&&(o=new zs("onChange","change",null,o,c),n.push({event:o,listeners:r}))}var ac=null,oc=null;function $T(n){tb(n,0)}function Zu(n){var r=On(n);if(Kn(r))return n}function wv(n,r){if(n==="change")return r}var _v=!1;if(Et){var Cf;if(Et){var Nf="oninput"in document;if(!Nf){var xv=document.createElement("div");xv.setAttribute("oninput","return;"),Nf=typeof xv.oninput=="function"}Cf=Nf}else Cf=!1;_v=Cf&&(!document.documentMode||9<document.documentMode)}function Ev(){ac&&(ac.detachEvent("onpropertychange",Tv),oc=ac=null)}function Tv(n){if(n.propertyName==="value"&&Zu(oc)){var r=[];bv(r,oc,n,Q(n)),qe($T,r)}}function WT(n,r,o){n==="focusin"?(Ev(),ac=r,oc=o,ac.attachEvent("onpropertychange",Tv)):n==="focusout"&&Ev()}function GT(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Zu(oc)}function KT(n,r){if(n==="click")return Zu(r)}function YT(n,r){if(n==="input"||n==="change")return Zu(r)}function QT(n,r){return n===r&&(n!==0||1/n===1/r)||n!==n&&r!==r}var br=typeof Object.is=="function"?Object.is:QT;function lc(n,r){if(br(n,r))return!0;if(typeof n!="object"||n===null||typeof r!="object"||r===null)return!1;var o=Object.keys(n),c=Object.keys(r);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var f=o[c];if(!Rt.call(r,f)||!br(n[f],r[f]))return!1}return!0}function kv(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Sv(n,r){var o=kv(n);n=0;for(var c;o;){if(o.nodeType===3){if(c=n+o.textContent.length,n<=r&&c>=r)return{node:o,offset:r-n};n=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=kv(o)}}function jv(n,r){return n&&r?n===r?!0:n&&n.nodeType===3?!1:r&&r.nodeType===3?jv(n,r.parentNode):"contains"in n?n.contains(r):n.compareDocumentPosition?!!(n.compareDocumentPosition(r)&16):!1:!1}function Cv(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var r=os(n.document);r instanceof n.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)n=r.contentWindow;else break;r=os(n.document)}return r}function Af(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r&&(r==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||r==="textarea"||n.contentEditable==="true")}var XT=Et&&"documentMode"in document&&11>=document.documentMode,tl=null,Rf=null,cc=null,If=!1;function Nv(n,r,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;If||tl==null||tl!==os(c)||(c=tl,"selectionStart"in c&&Af(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),cc&&lc(cc,c)||(cc=c,c=zh(Rf,"onSelect"),0<c.length&&(r=new zs("onSelect","select",null,r,o),n.push({event:r,listeners:c}),r.target=tl)))}function uo(n,r){var o={};return o[n.toLowerCase()]=r.toLowerCase(),o["Webkit"+n]="webkit"+r,o["Moz"+n]="moz"+r,o}var nl={animationend:uo("Animation","AnimationEnd"),animationiteration:uo("Animation","AnimationIteration"),animationstart:uo("Animation","AnimationStart"),transitionrun:uo("Transition","TransitionRun"),transitionstart:uo("Transition","TransitionStart"),transitioncancel:uo("Transition","TransitionCancel"),transitionend:uo("Transition","TransitionEnd")},Df={},Av={};Et&&(Av=document.createElement("div").style,"AnimationEvent"in window||(delete nl.animationend.animation,delete nl.animationiteration.animation,delete nl.animationstart.animation),"TransitionEvent"in window||delete nl.transitionend.transition);function ho(n){if(Df[n])return Df[n];if(!nl[n])return n;var r=nl[n],o;for(o in r)if(r.hasOwnProperty(o)&&o in Av)return Df[n]=r[o];return n}var Rv=ho("animationend"),Iv=ho("animationiteration"),Dv=ho("animationstart"),JT=ho("transitionrun"),ZT=ho("transitionstart"),ek=ho("transitioncancel"),Mv=ho("transitionend"),Lv=new Map,Mf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Mf.push("scrollEnd");function Zr(n,r){Lv.set(n,r),xs(r,[n])}var eh=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},Vr=[],sl=0,Lf=0;function th(){for(var n=sl,r=Lf=sl=0;r<n;){var o=Vr[r];Vr[r++]=null;var c=Vr[r];Vr[r++]=null;var f=Vr[r];Vr[r++]=null;var m=Vr[r];if(Vr[r++]=null,c!==null&&f!==null){var w=c.pending;w===null?f.next=f:(f.next=w.next,w.next=f),c.pending=f}m!==0&&Ov(o,f,m)}}function nh(n,r,o,c){Vr[sl++]=n,Vr[sl++]=r,Vr[sl++]=o,Vr[sl++]=c,Lf|=c,n.lanes|=c,n=n.alternate,n!==null&&(n.lanes|=c)}function Of(n,r,o,c){return nh(n,r,o,c),sh(n)}function fo(n,r){return nh(n,null,null,r),sh(n)}function Ov(n,r,o){n.lanes|=o;var c=n.alternate;c!==null&&(c.lanes|=o);for(var f=!1,m=n.return;m!==null;)m.childLanes|=o,c=m.alternate,c!==null&&(c.childLanes|=o),m.tag===22&&(n=m.stateNode,n===null||n._visibility&1||(f=!0)),n=m,m=m.return;return n.tag===3?(m=n.stateNode,f&&r!==null&&(f=31-Fe(o),n=m.hiddenUpdates,c=n[f],c===null?n[f]=[r]:c.push(r),r.lane=o|536870912),m):null}function sh(n){if(50<Rc)throw Rc=0,$m=null,Error(i(185));for(var r=n.return;r!==null;)n=r,r=n.return;return n.tag===3?n.stateNode:null}var rl={};function tk(n,r,o,c){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wr(n,r,o,c){return new tk(n,r,o,c)}function Pf(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Oi(n,r){var o=n.alternate;return o===null?(o=wr(n.tag,r,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=r,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&65011712,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,r=n.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o.refCleanup=n.refCleanup,o}function Pv(n,r){n.flags&=65011714;var o=n.alternate;return o===null?(n.childLanes=0,n.lanes=r,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,r=o.dependencies,n.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),n}function rh(n,r,o,c,f,m){var w=0;if(c=n,typeof n=="function")Pf(n)&&(w=1);else if(typeof n=="string")w=aS(n,o,ke.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case I:return n=wr(31,o,r,f),n.elementType=I,n.lanes=m,n;case q:return mo(o.children,f,m,r);case B:w=8,f|=24;break;case X:return n=wr(12,o,r,f|2),n.elementType=X,n.lanes=m,n;case xe:return n=wr(13,o,r,f),n.elementType=xe,n.lanes=m,n;case ve:return n=wr(19,o,r,f),n.elementType=ve,n.lanes=m,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Y:w=10;break e;case W:w=9;break e;case de:w=11;break e;case j:w=14;break e;case S:w=16,c=null;break e}w=29,o=Error(i(130,n===null?"null":typeof n,"")),c=null}return r=wr(w,o,r,f),r.elementType=n,r.type=c,r.lanes=m,r}function mo(n,r,o,c){return n=wr(7,n,c,r),n.lanes=o,n}function Vf(n,r,o){return n=wr(6,n,null,r),n.lanes=o,n}function Vv(n){var r=wr(18,null,null,0);return r.stateNode=n,r}function Uf(n,r,o){return r=wr(4,n.children!==null?n.children:[],n.key,r),r.lanes=o,r.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},r}var Uv=new WeakMap;function Ur(n,r){if(typeof n=="object"&&n!==null){var o=Uv.get(n);return o!==void 0?o:(r={value:n,source:r,stack:ue(r)},Uv.set(n,r),r)}return{value:n,source:r,stack:ue(r)}}var il=[],al=0,ih=null,uc=0,Br=[],zr=0,ga=null,yi=1,vi="";function Pi(n,r){il[al++]=uc,il[al++]=ih,ih=n,uc=r}function Bv(n,r,o){Br[zr++]=yi,Br[zr++]=vi,Br[zr++]=ga,ga=n;var c=yi;n=vi;var f=32-Fe(c)-1;c&=~(1<<f),o+=1;var m=32-Fe(r)+f;if(30<m){var w=f-f%5;m=(c&(1<<w)-1).toString(32),c>>=w,f-=w,yi=1<<32-Fe(r)+f|o<<f|c,vi=m+n}else yi=1<<m|o<<f|c,vi=n}function Bf(n){n.return!==null&&(Pi(n,1),Bv(n,1,0))}function zf(n){for(;n===ih;)ih=il[--al],il[al]=null,uc=il[--al],il[al]=null;for(;n===ga;)ga=Br[--zr],Br[zr]=null,vi=Br[--zr],Br[zr]=null,yi=Br[--zr],Br[zr]=null}function zv(n,r){Br[zr++]=yi,Br[zr++]=vi,Br[zr++]=ga,yi=r.id,vi=r.overflow,ga=n}var As=null,Pn=null,Qt=!1,ya=null,Fr=!1,Ff=Error(i(519));function va(n){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw hc(Ur(r,n)),Ff}function Fv(n){var r=n.stateNode,o=n.type,c=n.memoizedProps;switch(r[Jt]=n,r[An]=c,o){case"dialog":Bt("cancel",r),Bt("close",r);break;case"iframe":case"object":case"embed":Bt("load",r);break;case"video":case"audio":for(o=0;o<Dc.length;o++)Bt(Dc[o],r);break;case"source":Bt("error",r);break;case"img":case"image":case"link":Bt("error",r),Bt("load",r);break;case"details":Bt("toggle",r);break;case"input":Bt("invalid",r),fa(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Bt("invalid",r);break;case"textarea":Bt("invalid",r),Lr(r,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||r.textContent===""+o||c.suppressHydrationWarning===!0||ib(r.textContent,o)?(c.popover!=null&&(Bt("beforetoggle",r),Bt("toggle",r)),c.onScroll!=null&&Bt("scroll",r),c.onScrollEnd!=null&&Bt("scrollend",r),c.onClick!=null&&(r.onclick=dt),r=!0):r=!1,r||va(n,!0)}function qv(n){for(As=n.return;As;)switch(As.tag){case 5:case 31:case 13:Fr=!1;return;case 27:case 3:Fr=!0;return;default:As=As.return}}function ol(n){if(n!==As)return!1;if(!Qt)return qv(n),Qt=!0,!1;var r=n.tag,o;if((o=r!==3&&r!==27)&&((o=r===5)&&(o=n.type,o=!(o!=="form"&&o!=="button")||ap(n.type,n.memoizedProps)),o=!o),o&&Pn&&va(n),qv(n),r===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Pn=mb(n)}else if(r===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Pn=mb(n)}else r===27?(r=Pn,Ia(n.type)?(n=hp,hp=null,Pn=n):Pn=r):Pn=As?Hr(n.stateNode.nextSibling):null;return!0}function po(){Pn=As=null,Qt=!1}function qf(){var n=ya;return n!==null&&(cr===null?cr=n:cr.push.apply(cr,n),ya=null),n}function hc(n){ya===null?ya=[n]:ya.push(n)}var Hf=L(null),go=null,Vi=null;function ba(n,r,o){we(Hf,r._currentValue),r._currentValue=o}function Ui(n){n._currentValue=Hf.current,ie(Hf)}function $f(n,r,o){for(;n!==null;){var c=n.alternate;if((n.childLanes&r)!==r?(n.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),n===o)break;n=n.return}}function Wf(n,r,o,c){var f=n.child;for(f!==null&&(f.return=n);f!==null;){var m=f.dependencies;if(m!==null){var w=f.child;m=m.firstContext;e:for(;m!==null;){var k=m;m=f;for(var U=0;U<r.length;U++)if(k.context===r[U]){m.lanes|=o,k=m.alternate,k!==null&&(k.lanes|=o),$f(m.return,o,n),c||(w=null);break e}m=k.next}}else if(f.tag===18){if(w=f.return,w===null)throw Error(i(341));w.lanes|=o,m=w.alternate,m!==null&&(m.lanes|=o),$f(w,o,n),w=null}else w=f.child;if(w!==null)w.return=f;else for(w=f;w!==null;){if(w===n){w=null;break}if(f=w.sibling,f!==null){f.return=w.return,w=f;break}w=w.return}f=w}}function ll(n,r,o,c){n=null;for(var f=r,m=!1;f!==null;){if(!m){if((f.flags&524288)!==0)m=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var w=f.alternate;if(w===null)throw Error(i(387));if(w=w.memoizedProps,w!==null){var k=f.type;br(f.pendingProps.value,w.value)||(n!==null?n.push(k):n=[k])}}else if(f===Ke.current){if(w=f.alternate,w===null)throw Error(i(387));w.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(n!==null?n.push(Vc):n=[Vc])}f=f.return}n!==null&&Wf(r,n,o,c),r.flags|=262144}function ah(n){for(n=n.firstContext;n!==null;){if(!br(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function yo(n){go=n,Vi=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Rs(n){return Hv(go,n)}function oh(n,r){return go===null&&yo(n),Hv(n,r)}function Hv(n,r){var o=r._currentValue;if(r={context:r,memoizedValue:o,next:null},Vi===null){if(n===null)throw Error(i(308));Vi=r,n.dependencies={lanes:0,firstContext:r},n.flags|=524288}else Vi=Vi.next=r;return o}var nk=typeof AbortController<"u"?AbortController:function(){var n=[],r=this.signal={aborted:!1,addEventListener:function(o,c){n.push(c)}};this.abort=function(){r.aborted=!0,n.forEach(function(o){return o()})}},sk=s.unstable_scheduleCallback,rk=s.unstable_NormalPriority,ms={$$typeof:Y,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Gf(){return{controller:new nk,data:new Map,refCount:0}}function dc(n){n.refCount--,n.refCount===0&&sk(rk,function(){n.controller.abort()})}var fc=null,Kf=0,cl=0,ul=null;function ik(n,r){if(fc===null){var o=fc=[];Kf=0,cl=Xm(),ul={status:"pending",value:void 0,then:function(c){o.push(c)}}}return Kf++,r.then($v,$v),r}function $v(){if(--Kf===0&&fc!==null){ul!==null&&(ul.status="fulfilled");var n=fc;fc=null,cl=0,ul=null;for(var r=0;r<n.length;r++)(0,n[r])()}}function ak(n,r){var o=[],c={status:"pending",value:null,reason:null,then:function(f){o.push(f)}};return n.then(function(){c.status="fulfilled",c.value=r;for(var f=0;f<o.length;f++)(0,o[f])(r)},function(f){for(c.status="rejected",c.reason=f,f=0;f<o.length;f++)(0,o[f])(void 0)}),c}var Wv=te.S;te.S=function(n,r){N1=vt(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&ik(n,r),Wv!==null&&Wv(n,r)};var vo=L(null);function Yf(){var n=vo.current;return n!==null?n:Sn.pooledCache}function lh(n,r){r===null?we(vo,vo.current):we(vo,r.pool)}function Gv(){var n=Yf();return n===null?null:{parent:ms._currentValue,pool:n}}var hl=Error(i(460)),Qf=Error(i(474)),ch=Error(i(542)),uh={then:function(){}};function Kv(n){return n=n.status,n==="fulfilled"||n==="rejected"}function Yv(n,r,o){switch(o=n[o],o===void 0?n.push(r):o!==r&&(r.then(dt,dt),r=o),r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,Xv(n),n;default:if(typeof r.status=="string")r.then(dt,dt);else{if(n=Sn,n!==null&&100<n.shellSuspendCounter)throw Error(i(482));n=r,n.status="pending",n.then(function(c){if(r.status==="pending"){var f=r;f.status="fulfilled",f.value=c}},function(c){if(r.status==="pending"){var f=r;f.status="rejected",f.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,Xv(n),n}throw wo=r,hl}}function bo(n){try{var r=n._init;return r(n._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(wo=o,hl):o}}var wo=null;function Qv(){if(wo===null)throw Error(i(459));var n=wo;return wo=null,n}function Xv(n){if(n===hl||n===ch)throw Error(i(483))}var dl=null,mc=0;function hh(n){var r=mc;return mc+=1,dl===null&&(dl=[]),Yv(dl,n,r)}function pc(n,r){r=r.props.ref,n.ref=r!==void 0?r:null}function dh(n,r){throw r.$$typeof===T?Error(i(525)):(n=Object.prototype.toString.call(r),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":n)))}function Jv(n){function r($,F){if(n){var J=$.deletions;J===null?($.deletions=[F],$.flags|=16):J.push(F)}}function o($,F){if(!n)return null;for(;F!==null;)r($,F),F=F.sibling;return null}function c($){for(var F=new Map;$!==null;)$.key!==null?F.set($.key,$):F.set($.index,$),$=$.sibling;return F}function f($,F){return $=Oi($,F),$.index=0,$.sibling=null,$}function m($,F,J){return $.index=J,n?(J=$.alternate,J!==null?(J=J.index,J<F?($.flags|=67108866,F):J):($.flags|=67108866,F)):($.flags|=1048576,F)}function w($){return n&&$.alternate===null&&($.flags|=67108866),$}function k($,F,J,ge){return F===null||F.tag!==6?(F=Vf(J,$.mode,ge),F.return=$,F):(F=f(F,J),F.return=$,F)}function U($,F,J,ge){var at=J.type;return at===q?fe($,F,J.props.children,ge,J.key):F!==null&&(F.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===S&&bo(at)===F.type)?(F=f(F,J.props),pc(F,J),F.return=$,F):(F=rh(J.type,J.key,J.props,null,$.mode,ge),pc(F,J),F.return=$,F)}function ee($,F,J,ge){return F===null||F.tag!==4||F.stateNode.containerInfo!==J.containerInfo||F.stateNode.implementation!==J.implementation?(F=Uf(J,$.mode,ge),F.return=$,F):(F=f(F,J.children||[]),F.return=$,F)}function fe($,F,J,ge,at){return F===null||F.tag!==7?(F=mo(J,$.mode,ge,at),F.return=$,F):(F=f(F,J),F.return=$,F)}function ye($,F,J){if(typeof F=="string"&&F!==""||typeof F=="number"||typeof F=="bigint")return F=Vf(""+F,$.mode,J),F.return=$,F;if(typeof F=="object"&&F!==null){switch(F.$$typeof){case O:return J=rh(F.type,F.key,F.props,null,$.mode,J),pc(J,F),J.return=$,J;case H:return F=Uf(F,$.mode,J),F.return=$,F;case S:return F=bo(F),ye($,F,J)}if(Ze(F)||M(F))return F=mo(F,$.mode,J,null),F.return=$,F;if(typeof F.then=="function")return ye($,hh(F),J);if(F.$$typeof===Y)return ye($,oh($,F),J);dh($,F)}return null}function se($,F,J,ge){var at=F!==null?F.key:null;if(typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint")return at!==null?null:k($,F,""+J,ge);if(typeof J=="object"&&J!==null){switch(J.$$typeof){case O:return J.key===at?U($,F,J,ge):null;case H:return J.key===at?ee($,F,J,ge):null;case S:return J=bo(J),se($,F,J,ge)}if(Ze(J)||M(J))return at!==null?null:fe($,F,J,ge,null);if(typeof J.then=="function")return se($,F,hh(J),ge);if(J.$$typeof===Y)return se($,F,oh($,J),ge);dh($,J)}return null}function he($,F,J,ge,at){if(typeof ge=="string"&&ge!==""||typeof ge=="number"||typeof ge=="bigint")return $=$.get(J)||null,k(F,$,""+ge,at);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case O:return $=$.get(ge.key===null?J:ge.key)||null,U(F,$,ge,at);case H:return $=$.get(ge.key===null?J:ge.key)||null,ee(F,$,ge,at);case S:return ge=bo(ge),he($,F,J,ge,at)}if(Ze(ge)||M(ge))return $=$.get(J)||null,fe(F,$,ge,at,null);if(typeof ge.then=="function")return he($,F,J,hh(ge),at);if(ge.$$typeof===Y)return he($,F,J,oh(F,ge),at);dh(F,ge)}return null}function Xe($,F,J,ge){for(var at=null,rn=null,nt=F,Ot=F=0,Ht=null;nt!==null&&Ot<J.length;Ot++){nt.index>Ot?(Ht=nt,nt=null):Ht=nt.sibling;var an=se($,nt,J[Ot],ge);if(an===null){nt===null&&(nt=Ht);break}n&&nt&&an.alternate===null&&r($,nt),F=m(an,F,Ot),rn===null?at=an:rn.sibling=an,rn=an,nt=Ht}if(Ot===J.length)return o($,nt),Qt&&Pi($,Ot),at;if(nt===null){for(;Ot<J.length;Ot++)nt=ye($,J[Ot],ge),nt!==null&&(F=m(nt,F,Ot),rn===null?at=nt:rn.sibling=nt,rn=nt);return Qt&&Pi($,Ot),at}for(nt=c(nt);Ot<J.length;Ot++)Ht=he(nt,$,Ot,J[Ot],ge),Ht!==null&&(n&&Ht.alternate!==null&&nt.delete(Ht.key===null?Ot:Ht.key),F=m(Ht,F,Ot),rn===null?at=Ht:rn.sibling=Ht,rn=Ht);return n&&nt.forEach(function(Pa){return r($,Pa)}),Qt&&Pi($,Ot),at}function ft($,F,J,ge){if(J==null)throw Error(i(151));for(var at=null,rn=null,nt=F,Ot=F=0,Ht=null,an=J.next();nt!==null&&!an.done;Ot++,an=J.next()){nt.index>Ot?(Ht=nt,nt=null):Ht=nt.sibling;var Pa=se($,nt,an.value,ge);if(Pa===null){nt===null&&(nt=Ht);break}n&&nt&&Pa.alternate===null&&r($,nt),F=m(Pa,F,Ot),rn===null?at=Pa:rn.sibling=Pa,rn=Pa,nt=Ht}if(an.done)return o($,nt),Qt&&Pi($,Ot),at;if(nt===null){for(;!an.done;Ot++,an=J.next())an=ye($,an.value,ge),an!==null&&(F=m(an,F,Ot),rn===null?at=an:rn.sibling=an,rn=an);return Qt&&Pi($,Ot),at}for(nt=c(nt);!an.done;Ot++,an=J.next())an=he(nt,$,Ot,an.value,ge),an!==null&&(n&&an.alternate!==null&&nt.delete(an.key===null?Ot:an.key),F=m(an,F,Ot),rn===null?at=an:rn.sibling=an,rn=an);return n&&nt.forEach(function(yS){return r($,yS)}),Qt&&Pi($,Ot),at}function En($,F,J,ge){if(typeof J=="object"&&J!==null&&J.type===q&&J.key===null&&(J=J.props.children),typeof J=="object"&&J!==null){switch(J.$$typeof){case O:e:{for(var at=J.key;F!==null;){if(F.key===at){if(at=J.type,at===q){if(F.tag===7){o($,F.sibling),ge=f(F,J.props.children),ge.return=$,$=ge;break e}}else if(F.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===S&&bo(at)===F.type){o($,F.sibling),ge=f(F,J.props),pc(ge,J),ge.return=$,$=ge;break e}o($,F);break}else r($,F);F=F.sibling}J.type===q?(ge=mo(J.props.children,$.mode,ge,J.key),ge.return=$,$=ge):(ge=rh(J.type,J.key,J.props,null,$.mode,ge),pc(ge,J),ge.return=$,$=ge)}return w($);case H:e:{for(at=J.key;F!==null;){if(F.key===at)if(F.tag===4&&F.stateNode.containerInfo===J.containerInfo&&F.stateNode.implementation===J.implementation){o($,F.sibling),ge=f(F,J.children||[]),ge.return=$,$=ge;break e}else{o($,F);break}else r($,F);F=F.sibling}ge=Uf(J,$.mode,ge),ge.return=$,$=ge}return w($);case S:return J=bo(J),En($,F,J,ge)}if(Ze(J))return Xe($,F,J,ge);if(M(J)){if(at=M(J),typeof at!="function")throw Error(i(150));return J=at.call(J),ft($,F,J,ge)}if(typeof J.then=="function")return En($,F,hh(J),ge);if(J.$$typeof===Y)return En($,F,oh($,J),ge);dh($,J)}return typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint"?(J=""+J,F!==null&&F.tag===6?(o($,F.sibling),ge=f(F,J),ge.return=$,$=ge):(o($,F),ge=Vf(J,$.mode,ge),ge.return=$,$=ge),w($)):o($,F)}return function($,F,J,ge){try{mc=0;var at=En($,F,J,ge);return dl=null,at}catch(nt){if(nt===hl||nt===ch)throw nt;var rn=wr(29,nt,null,$.mode);return rn.lanes=ge,rn.return=$,rn}}}var _o=Jv(!0),Zv=Jv(!1),wa=!1;function Xf(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Jf(n,r){n=n.updateQueue,r.updateQueue===n&&(r.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function _a(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function xa(n,r,o){var c=n.updateQueue;if(c===null)return null;if(c=c.shared,(hn&2)!==0){var f=c.pending;return f===null?r.next=r:(r.next=f.next,f.next=r),c.pending=r,r=sh(n),Ov(n,null,o),r}return nh(n,c,r,o),sh(n)}function gc(n,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194048)!==0)){var c=r.lanes;c&=n.pendingLanes,o|=c,r.lanes=o,vn(n,o)}}function Zf(n,r){var o=n.updateQueue,c=n.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var f=null,m=null;if(o=o.firstBaseUpdate,o!==null){do{var w={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};m===null?f=m=w:m=m.next=w,o=o.next}while(o!==null);m===null?f=m=r:m=m.next=r}else f=m=r;o={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:m,shared:c.shared,callbacks:c.callbacks},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=r:n.next=r,o.lastBaseUpdate=r}var em=!1;function yc(){if(em){var n=ul;if(n!==null)throw n}}function vc(n,r,o,c){em=!1;var f=n.updateQueue;wa=!1;var m=f.firstBaseUpdate,w=f.lastBaseUpdate,k=f.shared.pending;if(k!==null){f.shared.pending=null;var U=k,ee=U.next;U.next=null,w===null?m=ee:w.next=ee,w=U;var fe=n.alternate;fe!==null&&(fe=fe.updateQueue,k=fe.lastBaseUpdate,k!==w&&(k===null?fe.firstBaseUpdate=ee:k.next=ee,fe.lastBaseUpdate=U))}if(m!==null){var ye=f.baseState;w=0,fe=ee=U=null,k=m;do{var se=k.lane&-536870913,he=se!==k.lane;if(he?(qt&se)===se:(c&se)===se){se!==0&&se===cl&&(em=!0),fe!==null&&(fe=fe.next={lane:0,tag:k.tag,payload:k.payload,callback:null,next:null});e:{var Xe=n,ft=k;se=r;var En=o;switch(ft.tag){case 1:if(Xe=ft.payload,typeof Xe=="function"){ye=Xe.call(En,ye,se);break e}ye=Xe;break e;case 3:Xe.flags=Xe.flags&-65537|128;case 0:if(Xe=ft.payload,se=typeof Xe=="function"?Xe.call(En,ye,se):Xe,se==null)break e;ye=E({},ye,se);break e;case 2:wa=!0}}se=k.callback,se!==null&&(n.flags|=64,he&&(n.flags|=8192),he=f.callbacks,he===null?f.callbacks=[se]:he.push(se))}else he={lane:se,tag:k.tag,payload:k.payload,callback:k.callback,next:null},fe===null?(ee=fe=he,U=ye):fe=fe.next=he,w|=se;if(k=k.next,k===null){if(k=f.shared.pending,k===null)break;he=k,k=he.next,he.next=null,f.lastBaseUpdate=he,f.shared.pending=null}}while(!0);fe===null&&(U=ye),f.baseState=U,f.firstBaseUpdate=ee,f.lastBaseUpdate=fe,m===null&&(f.shared.lanes=0),ja|=w,n.lanes=w,n.memoizedState=ye}}function e0(n,r){if(typeof n!="function")throw Error(i(191,n));n.call(r)}function t0(n,r){var o=n.callbacks;if(o!==null)for(n.callbacks=null,n=0;n<o.length;n++)e0(o[n],r)}var fl=L(null),fh=L(0);function n0(n,r){n=Ki,we(fh,n),we(fl,r),Ki=n|r.baseLanes}function tm(){we(fh,Ki),we(fl,fl.current)}function nm(){Ki=fh.current,ie(fl),ie(fh)}var _r=L(null),qr=null;function Ea(n){var r=n.alternate;we(cs,cs.current&1),we(_r,n),qr===null&&(r===null||fl.current!==null||r.memoizedState!==null)&&(qr=n)}function sm(n){we(cs,cs.current),we(_r,n),qr===null&&(qr=n)}function s0(n){n.tag===22?(we(cs,cs.current),we(_r,n),qr===null&&(qr=n)):Ta()}function Ta(){we(cs,cs.current),we(_r,_r.current)}function xr(n){ie(_r),qr===n&&(qr=null),ie(cs)}var cs=L(0);function mh(n){for(var r=n;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||cp(o)||up(o)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Bi=0,Dt=null,_n=null,ps=null,ph=!1,ml=!1,xo=!1,gh=0,bc=0,pl=null,ok=0;function Zn(){throw Error(i(321))}function rm(n,r){if(r===null)return!1;for(var o=0;o<r.length&&o<n.length;o++)if(!br(n[o],r[o]))return!1;return!0}function im(n,r,o,c,f,m){return Bi=m,Dt=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,te.H=n===null||n.memoizedState===null?B0:wm,xo=!1,m=o(c,f),xo=!1,ml&&(m=i0(r,o,c,f)),r0(n),m}function r0(n){te.H=xc;var r=_n!==null&&_n.next!==null;if(Bi=0,ps=_n=Dt=null,ph=!1,bc=0,pl=null,r)throw Error(i(300));n===null||gs||(n=n.dependencies,n!==null&&ah(n)&&(gs=!0))}function i0(n,r,o,c){Dt=n;var f=0;do{if(ml&&(pl=null),bc=0,ml=!1,25<=f)throw Error(i(301));if(f+=1,ps=_n=null,n.updateQueue!=null){var m=n.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}te.H=z0,m=r(o,c)}while(ml);return m}function lk(){var n=te.H,r=n.useState()[0];return r=typeof r.then=="function"?wc(r):r,n=n.useState()[0],(_n!==null?_n.memoizedState:null)!==n&&(Dt.flags|=1024),r}function am(){var n=gh!==0;return gh=0,n}function om(n,r,o){r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~o}function lm(n){if(ph){for(n=n.memoizedState;n!==null;){var r=n.queue;r!==null&&(r.pending=null),n=n.next}ph=!1}Bi=0,ps=_n=Dt=null,ml=!1,bc=gh=0,pl=null}function Xs(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ps===null?Dt.memoizedState=ps=n:ps=ps.next=n,ps}function us(){if(_n===null){var n=Dt.alternate;n=n!==null?n.memoizedState:null}else n=_n.next;var r=ps===null?Dt.memoizedState:ps.next;if(r!==null)ps=r,_n=n;else{if(n===null)throw Dt.alternate===null?Error(i(467)):Error(i(310));_n=n,n={memoizedState:_n.memoizedState,baseState:_n.baseState,baseQueue:_n.baseQueue,queue:_n.queue,next:null},ps===null?Dt.memoizedState=ps=n:ps=ps.next=n}return ps}function yh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function wc(n){var r=bc;return bc+=1,pl===null&&(pl=[]),n=Yv(pl,n,r),r=Dt,(ps===null?r.memoizedState:ps.next)===null&&(r=r.alternate,te.H=r===null||r.memoizedState===null?B0:wm),n}function vh(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return wc(n);if(n.$$typeof===Y)return Rs(n)}throw Error(i(438,String(n)))}function cm(n){var r=null,o=Dt.updateQueue;if(o!==null&&(r=o.memoCache),r==null){var c=Dt.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(f){return f.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),o===null&&(o=yh(),Dt.updateQueue=o),o.memoCache=r,o=r.data[r.index],o===void 0)for(o=r.data[r.index]=Array(n),c=0;c<n;c++)o[c]=V;return r.index++,o}function zi(n,r){return typeof r=="function"?r(n):r}function bh(n){var r=us();return um(r,_n,n)}function um(n,r,o){var c=n.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var f=n.baseQueue,m=c.pending;if(m!==null){if(f!==null){var w=f.next;f.next=m.next,m.next=w}r.baseQueue=f=m,c.pending=null}if(m=n.baseState,f===null)n.memoizedState=m;else{r=f.next;var k=w=null,U=null,ee=r,fe=!1;do{var ye=ee.lane&-536870913;if(ye!==ee.lane?(qt&ye)===ye:(Bi&ye)===ye){var se=ee.revertLane;if(se===0)U!==null&&(U=U.next={lane:0,revertLane:0,gesture:null,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null}),ye===cl&&(fe=!0);else if((Bi&se)===se){ee=ee.next,se===cl&&(fe=!0);continue}else ye={lane:0,revertLane:ee.revertLane,gesture:null,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null},U===null?(k=U=ye,w=m):U=U.next=ye,Dt.lanes|=se,ja|=se;ye=ee.action,xo&&o(m,ye),m=ee.hasEagerState?ee.eagerState:o(m,ye)}else se={lane:ye,revertLane:ee.revertLane,gesture:ee.gesture,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null},U===null?(k=U=se,w=m):U=U.next=se,Dt.lanes|=ye,ja|=ye;ee=ee.next}while(ee!==null&&ee!==r);if(U===null?w=m:U.next=k,!br(m,n.memoizedState)&&(gs=!0,fe&&(o=ul,o!==null)))throw o;n.memoizedState=m,n.baseState=w,n.baseQueue=U,c.lastRenderedState=m}return f===null&&(c.lanes=0),[n.memoizedState,c.dispatch]}function hm(n){var r=us(),o=r.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=n;var c=o.dispatch,f=o.pending,m=r.memoizedState;if(f!==null){o.pending=null;var w=f=f.next;do m=n(m,w.action),w=w.next;while(w!==f);br(m,r.memoizedState)||(gs=!0),r.memoizedState=m,r.baseQueue===null&&(r.baseState=m),o.lastRenderedState=m}return[m,c]}function a0(n,r,o){var c=Dt,f=us(),m=Qt;if(m){if(o===void 0)throw Error(i(407));o=o()}else o=r();var w=!br((_n||f).memoizedState,o);if(w&&(f.memoizedState=o,gs=!0),f=f.queue,mm(c0.bind(null,c,f,n),[n]),f.getSnapshot!==r||w||ps!==null&&ps.memoizedState.tag&1){if(c.flags|=2048,gl(9,{destroy:void 0},l0.bind(null,c,f,o,r),null),Sn===null)throw Error(i(349));m||(Bi&127)!==0||o0(c,r,o)}return o}function o0(n,r,o){n.flags|=16384,n={getSnapshot:r,value:o},r=Dt.updateQueue,r===null?(r=yh(),Dt.updateQueue=r,r.stores=[n]):(o=r.stores,o===null?r.stores=[n]:o.push(n))}function l0(n,r,o,c){r.value=o,r.getSnapshot=c,u0(r)&&h0(n)}function c0(n,r,o){return o(function(){u0(r)&&h0(n)})}function u0(n){var r=n.getSnapshot;n=n.value;try{var o=r();return!br(n,o)}catch{return!0}}function h0(n){var r=fo(n,2);r!==null&&ur(r,n,2)}function dm(n){var r=Xs();if(typeof n=="function"){var o=n;if(n=o(),xo){st(!0);try{o()}finally{st(!1)}}}return r.memoizedState=r.baseState=n,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:zi,lastRenderedState:n},r}function d0(n,r,o,c){return n.baseState=o,um(n,_n,typeof c=="function"?c:zi)}function ck(n,r,o,c,f){if(xh(n))throw Error(i(485));if(n=r.action,n!==null){var m={payload:f,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){m.listeners.push(w)}};te.T!==null?o(!0):m.isTransition=!1,c(m),o=r.pending,o===null?(m.next=r.pending=m,f0(r,m)):(m.next=o.next,r.pending=o.next=m)}}function f0(n,r){var o=r.action,c=r.payload,f=n.state;if(r.isTransition){var m=te.T,w={};te.T=w;try{var k=o(f,c),U=te.S;U!==null&&U(w,k),m0(n,r,k)}catch(ee){fm(n,r,ee)}finally{m!==null&&w.types!==null&&(m.types=w.types),te.T=m}}else try{m=o(f,c),m0(n,r,m)}catch(ee){fm(n,r,ee)}}function m0(n,r,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){p0(n,r,c)},function(c){return fm(n,r,c)}):p0(n,r,o)}function p0(n,r,o){r.status="fulfilled",r.value=o,g0(r),n.state=o,r=n.pending,r!==null&&(o=r.next,o===r?n.pending=null:(o=o.next,r.next=o,f0(n,o)))}function fm(n,r,o){var c=n.pending;if(n.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=o,g0(r),r=r.next;while(r!==c)}n.action=null}function g0(n){n=n.listeners;for(var r=0;r<n.length;r++)(0,n[r])()}function y0(n,r){return r}function v0(n,r){if(Qt){var o=Sn.formState;if(o!==null){e:{var c=Dt;if(Qt){if(Pn){t:{for(var f=Pn,m=Fr;f.nodeType!==8;){if(!m){f=null;break t}if(f=Hr(f.nextSibling),f===null){f=null;break t}}m=f.data,f=m==="F!"||m==="F"?f:null}if(f){Pn=Hr(f.nextSibling),c=f.data==="F!";break e}}va(c)}c=!1}c&&(r=o[0])}}return o=Xs(),o.memoizedState=o.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:y0,lastRenderedState:r},o.queue=c,o=P0.bind(null,Dt,c),c.dispatch=o,c=dm(!1),m=bm.bind(null,Dt,!1,c.queue),c=Xs(),f={state:r,dispatch:null,action:n,pending:null},c.queue=f,o=ck.bind(null,Dt,f,m,o),f.dispatch=o,c.memoizedState=n,[r,o,!1]}function b0(n){var r=us();return w0(r,_n,n)}function w0(n,r,o){if(r=um(n,r,y0)[0],n=bh(zi)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=wc(r)}catch(w){throw w===hl?ch:w}else c=r;r=us();var f=r.queue,m=f.dispatch;return o!==r.memoizedState&&(Dt.flags|=2048,gl(9,{destroy:void 0},uk.bind(null,f,o),null)),[c,m,n]}function uk(n,r){n.action=r}function _0(n){var r=us(),o=_n;if(o!==null)return w0(r,o,n);us(),r=r.memoizedState,o=us();var c=o.queue.dispatch;return o.memoizedState=n,[r,c,!1]}function gl(n,r,o,c){return n={tag:n,create:o,deps:c,inst:r,next:null},r=Dt.updateQueue,r===null&&(r=yh(),Dt.updateQueue=r),o=r.lastEffect,o===null?r.lastEffect=n.next=n:(c=o.next,o.next=n,n.next=c,r.lastEffect=n),n}function x0(){return us().memoizedState}function wh(n,r,o,c){var f=Xs();Dt.flags|=n,f.memoizedState=gl(1|r,{destroy:void 0},o,c===void 0?null:c)}function _h(n,r,o,c){var f=us();c=c===void 0?null:c;var m=f.memoizedState.inst;_n!==null&&c!==null&&rm(c,_n.memoizedState.deps)?f.memoizedState=gl(r,m,o,c):(Dt.flags|=n,f.memoizedState=gl(1|r,m,o,c))}function E0(n,r){wh(8390656,8,n,r)}function mm(n,r){_h(2048,8,n,r)}function hk(n){Dt.flags|=4;var r=Dt.updateQueue;if(r===null)r=yh(),Dt.updateQueue=r,r.events=[n];else{var o=r.events;o===null?r.events=[n]:o.push(n)}}function T0(n){var r=us().memoizedState;return hk({ref:r,nextImpl:n}),function(){if((hn&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function k0(n,r){return _h(4,2,n,r)}function S0(n,r){return _h(4,4,n,r)}function j0(n,r){if(typeof r=="function"){n=n();var o=r(n);return function(){typeof o=="function"?o():r(null)}}if(r!=null)return n=n(),r.current=n,function(){r.current=null}}function C0(n,r,o){o=o!=null?o.concat([n]):null,_h(4,4,j0.bind(null,r,n),o)}function pm(){}function N0(n,r){var o=us();r=r===void 0?null:r;var c=o.memoizedState;return r!==null&&rm(r,c[1])?c[0]:(o.memoizedState=[n,r],n)}function A0(n,r){var o=us();r=r===void 0?null:r;var c=o.memoizedState;if(r!==null&&rm(r,c[1]))return c[0];if(c=n(),xo){st(!0);try{n()}finally{st(!1)}}return o.memoizedState=[c,r],c}function gm(n,r,o){return o===void 0||(Bi&1073741824)!==0&&(qt&261930)===0?n.memoizedState=r:(n.memoizedState=o,n=R1(),Dt.lanes|=n,ja|=n,o)}function R0(n,r,o,c){return br(o,r)?o:fl.current!==null?(n=gm(n,o,c),br(n,r)||(gs=!0),n):(Bi&42)===0||(Bi&1073741824)!==0&&(qt&261930)===0?(gs=!0,n.memoizedState=o):(n=R1(),Dt.lanes|=n,ja|=n,r)}function I0(n,r,o,c,f){var m=_e.p;_e.p=m!==0&&8>m?m:8;var w=te.T,k={};te.T=k,bm(n,!1,r,o);try{var U=f(),ee=te.S;if(ee!==null&&ee(k,U),U!==null&&typeof U=="object"&&typeof U.then=="function"){var fe=ak(U,c);_c(n,r,fe,kr(n))}else _c(n,r,c,kr(n))}catch(ye){_c(n,r,{then:function(){},status:"rejected",reason:ye},kr())}finally{_e.p=m,w!==null&&k.types!==null&&(w.types=k.types),te.T=w}}function dk(){}function ym(n,r,o,c){if(n.tag!==5)throw Error(i(476));var f=D0(n).queue;I0(n,f,r,Ie,o===null?dk:function(){return M0(n),o(c)})}function D0(n){var r=n.memoizedState;if(r!==null)return r;r={memoizedState:Ie,baseState:Ie,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:zi,lastRenderedState:Ie},next:null};var o={};return r.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:zi,lastRenderedState:o},next:null},n.memoizedState=r,n=n.alternate,n!==null&&(n.memoizedState=r),r}function M0(n){var r=D0(n);r.next===null&&(r=n.alternate.memoizedState),_c(n,r.next.queue,{},kr())}function vm(){return Rs(Vc)}function L0(){return us().memoizedState}function O0(){return us().memoizedState}function fk(n){for(var r=n.return;r!==null;){switch(r.tag){case 24:case 3:var o=kr();n=_a(o);var c=xa(r,n,o);c!==null&&(ur(c,r,o),gc(c,r,o)),r={cache:Gf()},n.payload=r;return}r=r.return}}function mk(n,r,o){var c=kr();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},xh(n)?V0(r,o):(o=Of(n,r,o,c),o!==null&&(ur(o,n,c),U0(o,r,c)))}function P0(n,r,o){var c=kr();_c(n,r,o,c)}function _c(n,r,o,c){var f={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(xh(n))V0(r,f);else{var m=n.alternate;if(n.lanes===0&&(m===null||m.lanes===0)&&(m=r.lastRenderedReducer,m!==null))try{var w=r.lastRenderedState,k=m(w,o);if(f.hasEagerState=!0,f.eagerState=k,br(k,w))return nh(n,r,f,0),Sn===null&&th(),!1}catch{}if(o=Of(n,r,f,c),o!==null)return ur(o,n,c),U0(o,r,c),!0}return!1}function bm(n,r,o,c){if(c={lane:2,revertLane:Xm(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},xh(n)){if(r)throw Error(i(479))}else r=Of(n,o,c,2),r!==null&&ur(r,n,2)}function xh(n){var r=n.alternate;return n===Dt||r!==null&&r===Dt}function V0(n,r){ml=ph=!0;var o=n.pending;o===null?r.next=r:(r.next=o.next,o.next=r),n.pending=r}function U0(n,r,o){if((o&4194048)!==0){var c=r.lanes;c&=n.pendingLanes,o|=c,r.lanes=o,vn(n,o)}}var xc={readContext:Rs,use:vh,useCallback:Zn,useContext:Zn,useEffect:Zn,useImperativeHandle:Zn,useLayoutEffect:Zn,useInsertionEffect:Zn,useMemo:Zn,useReducer:Zn,useRef:Zn,useState:Zn,useDebugValue:Zn,useDeferredValue:Zn,useTransition:Zn,useSyncExternalStore:Zn,useId:Zn,useHostTransitionStatus:Zn,useFormState:Zn,useActionState:Zn,useOptimistic:Zn,useMemoCache:Zn,useCacheRefresh:Zn};xc.useEffectEvent=Zn;var B0={readContext:Rs,use:vh,useCallback:function(n,r){return Xs().memoizedState=[n,r===void 0?null:r],n},useContext:Rs,useEffect:E0,useImperativeHandle:function(n,r,o){o=o!=null?o.concat([n]):null,wh(4194308,4,j0.bind(null,r,n),o)},useLayoutEffect:function(n,r){return wh(4194308,4,n,r)},useInsertionEffect:function(n,r){wh(4,2,n,r)},useMemo:function(n,r){var o=Xs();r=r===void 0?null:r;var c=n();if(xo){st(!0);try{n()}finally{st(!1)}}return o.memoizedState=[c,r],c},useReducer:function(n,r,o){var c=Xs();if(o!==void 0){var f=o(r);if(xo){st(!0);try{o(r)}finally{st(!1)}}}else f=r;return c.memoizedState=c.baseState=f,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:f},c.queue=n,n=n.dispatch=mk.bind(null,Dt,n),[c.memoizedState,n]},useRef:function(n){var r=Xs();return n={current:n},r.memoizedState=n},useState:function(n){n=dm(n);var r=n.queue,o=P0.bind(null,Dt,r);return r.dispatch=o,[n.memoizedState,o]},useDebugValue:pm,useDeferredValue:function(n,r){var o=Xs();return gm(o,n,r)},useTransition:function(){var n=dm(!1);return n=I0.bind(null,Dt,n.queue,!0,!1),Xs().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,r,o){var c=Dt,f=Xs();if(Qt){if(o===void 0)throw Error(i(407));o=o()}else{if(o=r(),Sn===null)throw Error(i(349));(qt&127)!==0||o0(c,r,o)}f.memoizedState=o;var m={value:o,getSnapshot:r};return f.queue=m,E0(c0.bind(null,c,m,n),[n]),c.flags|=2048,gl(9,{destroy:void 0},l0.bind(null,c,m,o,r),null),o},useId:function(){var n=Xs(),r=Sn.identifierPrefix;if(Qt){var o=vi,c=yi;o=(c&~(1<<32-Fe(c)-1)).toString(32)+o,r="_"+r+"R_"+o,o=gh++,0<o&&(r+="H"+o.toString(32)),r+="_"}else o=ok++,r="_"+r+"r_"+o.toString(32)+"_";return n.memoizedState=r},useHostTransitionStatus:vm,useFormState:v0,useActionState:v0,useOptimistic:function(n){var r=Xs();r.memoizedState=r.baseState=n;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=o,r=bm.bind(null,Dt,!0,o),o.dispatch=r,[n,r]},useMemoCache:cm,useCacheRefresh:function(){return Xs().memoizedState=fk.bind(null,Dt)},useEffectEvent:function(n){var r=Xs(),o={impl:n};return r.memoizedState=o,function(){if((hn&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},wm={readContext:Rs,use:vh,useCallback:N0,useContext:Rs,useEffect:mm,useImperativeHandle:C0,useInsertionEffect:k0,useLayoutEffect:S0,useMemo:A0,useReducer:bh,useRef:x0,useState:function(){return bh(zi)},useDebugValue:pm,useDeferredValue:function(n,r){var o=us();return R0(o,_n.memoizedState,n,r)},useTransition:function(){var n=bh(zi)[0],r=us().memoizedState;return[typeof n=="boolean"?n:wc(n),r]},useSyncExternalStore:a0,useId:L0,useHostTransitionStatus:vm,useFormState:b0,useActionState:b0,useOptimistic:function(n,r){var o=us();return d0(o,_n,n,r)},useMemoCache:cm,useCacheRefresh:O0};wm.useEffectEvent=T0;var z0={readContext:Rs,use:vh,useCallback:N0,useContext:Rs,useEffect:mm,useImperativeHandle:C0,useInsertionEffect:k0,useLayoutEffect:S0,useMemo:A0,useReducer:hm,useRef:x0,useState:function(){return hm(zi)},useDebugValue:pm,useDeferredValue:function(n,r){var o=us();return _n===null?gm(o,n,r):R0(o,_n.memoizedState,n,r)},useTransition:function(){var n=hm(zi)[0],r=us().memoizedState;return[typeof n=="boolean"?n:wc(n),r]},useSyncExternalStore:a0,useId:L0,useHostTransitionStatus:vm,useFormState:_0,useActionState:_0,useOptimistic:function(n,r){var o=us();return _n!==null?d0(o,_n,n,r):(o.baseState=n,[n,o.queue.dispatch])},useMemoCache:cm,useCacheRefresh:O0};z0.useEffectEvent=T0;function _m(n,r,o,c){r=n.memoizedState,o=o(c,r),o=o==null?r:E({},r,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var xm={enqueueSetState:function(n,r,o){n=n._reactInternals;var c=kr(),f=_a(c);f.payload=r,o!=null&&(f.callback=o),r=xa(n,f,c),r!==null&&(ur(r,n,c),gc(r,n,c))},enqueueReplaceState:function(n,r,o){n=n._reactInternals;var c=kr(),f=_a(c);f.tag=1,f.payload=r,o!=null&&(f.callback=o),r=xa(n,f,c),r!==null&&(ur(r,n,c),gc(r,n,c))},enqueueForceUpdate:function(n,r){n=n._reactInternals;var o=kr(),c=_a(o);c.tag=2,r!=null&&(c.callback=r),r=xa(n,c,o),r!==null&&(ur(r,n,o),gc(r,n,o))}};function F0(n,r,o,c,f,m,w){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(c,m,w):r.prototype&&r.prototype.isPureReactComponent?!lc(o,c)||!lc(f,m):!0}function q0(n,r,o,c){n=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,c),r.state!==n&&xm.enqueueReplaceState(r,r.state,null)}function Eo(n,r){var o=r;if("ref"in r){o={};for(var c in r)c!=="ref"&&(o[c]=r[c])}if(n=n.defaultProps){o===r&&(o=E({},o));for(var f in n)o[f]===void 0&&(o[f]=n[f])}return o}function H0(n){eh(n)}function $0(n){console.error(n)}function W0(n){eh(n)}function Eh(n,r){try{var o=n.onUncaughtError;o(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function G0(n,r,o){try{var c=n.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function Em(n,r,o){return o=_a(o),o.tag=3,o.payload={element:null},o.callback=function(){Eh(n,r)},o}function K0(n){return n=_a(n),n.tag=3,n}function Y0(n,r,o,c){var f=o.type.getDerivedStateFromError;if(typeof f=="function"){var m=c.value;n.payload=function(){return f(m)},n.callback=function(){G0(r,o,c)}}var w=o.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(n.callback=function(){G0(r,o,c),typeof f!="function"&&(Ca===null?Ca=new Set([this]):Ca.add(this));var k=c.stack;this.componentDidCatch(c.value,{componentStack:k!==null?k:""})})}function pk(n,r,o,c,f){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=o.alternate,r!==null&&ll(r,o,f,!0),o=_r.current,o!==null){switch(o.tag){case 31:case 13:return qr===null?Lh():o.alternate===null&&es===0&&(es=3),o.flags&=-257,o.flags|=65536,o.lanes=f,c===uh?o.flags|=16384:(r=o.updateQueue,r===null?o.updateQueue=new Set([c]):r.add(c),Km(n,c,f)),!1;case 22:return o.flags|=65536,c===uh?o.flags|=16384:(r=o.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=r):(o=r.retryQueue,o===null?r.retryQueue=new Set([c]):o.add(c)),Km(n,c,f)),!1}throw Error(i(435,o.tag))}return Km(n,c,f),Lh(),!1}if(Qt)return r=_r.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=f,c!==Ff&&(n=Error(i(422),{cause:c}),hc(Ur(n,o)))):(c!==Ff&&(r=Error(i(423),{cause:c}),hc(Ur(r,o))),n=n.current.alternate,n.flags|=65536,f&=-f,n.lanes|=f,c=Ur(c,o),f=Em(n.stateNode,c,f),Zf(n,f),es!==4&&(es=2)),!1;var m=Error(i(520),{cause:c});if(m=Ur(m,o),Ac===null?Ac=[m]:Ac.push(m),es!==4&&(es=2),r===null)return!0;c=Ur(c,o),o=r;do{switch(o.tag){case 3:return o.flags|=65536,n=f&-f,o.lanes|=n,n=Em(o.stateNode,c,n),Zf(o,n),!1;case 1:if(r=o.type,m=o.stateNode,(o.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Ca===null||!Ca.has(m))))return o.flags|=65536,f&=-f,o.lanes|=f,f=K0(f),Y0(f,n,o,c),Zf(o,f),!1}o=o.return}while(o!==null);return!1}var Tm=Error(i(461)),gs=!1;function Is(n,r,o,c){r.child=n===null?Zv(r,null,o,c):_o(r,n.child,o,c)}function Q0(n,r,o,c,f){o=o.render;var m=r.ref;if("ref"in c){var w={};for(var k in c)k!=="ref"&&(w[k]=c[k])}else w=c;return yo(r),c=im(n,r,o,w,m,f),k=am(),n!==null&&!gs?(om(n,r,f),Fi(n,r,f)):(Qt&&k&&Bf(r),r.flags|=1,Is(n,r,c,f),r.child)}function X0(n,r,o,c,f){if(n===null){var m=o.type;return typeof m=="function"&&!Pf(m)&&m.defaultProps===void 0&&o.compare===null?(r.tag=15,r.type=m,J0(n,r,m,c,f)):(n=rh(o.type,null,c,r,r.mode,f),n.ref=r.ref,n.return=r,r.child=n)}if(m=n.child,!Im(n,f)){var w=m.memoizedProps;if(o=o.compare,o=o!==null?o:lc,o(w,c)&&n.ref===r.ref)return Fi(n,r,f)}return r.flags|=1,n=Oi(m,c),n.ref=r.ref,n.return=r,r.child=n}function J0(n,r,o,c,f){if(n!==null){var m=n.memoizedProps;if(lc(m,c)&&n.ref===r.ref)if(gs=!1,r.pendingProps=c=m,Im(n,f))(n.flags&131072)!==0&&(gs=!0);else return r.lanes=n.lanes,Fi(n,r,f)}return km(n,r,o,c,f)}function Z0(n,r,o,c){var f=c.children,m=n!==null?n.memoizedState:null;if(n===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((r.flags&128)!==0){if(m=m!==null?m.baseLanes|o:o,n!==null){for(c=r.child=n.child,f=0;c!==null;)f=f|c.lanes|c.childLanes,c=c.sibling;c=f&~m}else c=0,r.child=null;return e1(n,r,m,o,c)}if((o&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},n!==null&&lh(r,m!==null?m.cachePool:null),m!==null?n0(r,m):tm(),s0(r);else return c=r.lanes=536870912,e1(n,r,m!==null?m.baseLanes|o:o,o,c)}else m!==null?(lh(r,m.cachePool),n0(r,m),Ta(),r.memoizedState=null):(n!==null&&lh(r,null),tm(),Ta());return Is(n,r,f,o),r.child}function Ec(n,r){return n!==null&&n.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function e1(n,r,o,c,f){var m=Yf();return m=m===null?null:{parent:ms._currentValue,pool:m},r.memoizedState={baseLanes:o,cachePool:m},n!==null&&lh(r,null),tm(),s0(r),n!==null&&ll(n,r,c,!0),r.childLanes=f,null}function Th(n,r){return r=Sh({mode:r.mode,children:r.children},n.mode),r.ref=n.ref,n.child=r,r.return=n,r}function t1(n,r,o){return _o(r,n.child,null,o),n=Th(r,r.pendingProps),n.flags|=2,xr(r),r.memoizedState=null,n}function gk(n,r,o){var c=r.pendingProps,f=(r.flags&128)!==0;if(r.flags&=-129,n===null){if(Qt){if(c.mode==="hidden")return n=Th(r,c),r.lanes=536870912,Ec(null,n);if(sm(r),(n=Pn)?(n=fb(n,Fr),n=n!==null&&n.data==="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:ga!==null?{id:yi,overflow:vi}:null,retryLane:536870912,hydrationErrors:null},o=Vv(n),o.return=r,r.child=o,As=r,Pn=null)):n=null,n===null)throw va(r);return r.lanes=536870912,null}return Th(r,c)}var m=n.memoizedState;if(m!==null){var w=m.dehydrated;if(sm(r),f)if(r.flags&256)r.flags&=-257,r=t1(n,r,o);else if(r.memoizedState!==null)r.child=n.child,r.flags|=128,r=null;else throw Error(i(558));else if(gs||ll(n,r,o,!1),f=(o&n.childLanes)!==0,gs||f){if(c=Sn,c!==null&&(w=Nn(c,o),w!==0&&w!==m.retryLane))throw m.retryLane=w,fo(n,w),ur(c,n,w),Tm;Lh(),r=t1(n,r,o)}else n=m.treeContext,Pn=Hr(w.nextSibling),As=r,Qt=!0,ya=null,Fr=!1,n!==null&&zv(r,n),r=Th(r,c),r.flags|=4096;return r}return n=Oi(n.child,{mode:c.mode,children:c.children}),n.ref=r.ref,r.child=n,n.return=r,n}function kh(n,r){var o=r.ref;if(o===null)n!==null&&n.ref!==null&&(r.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(n===null||n.ref!==o)&&(r.flags|=4194816)}}function km(n,r,o,c,f){return yo(r),o=im(n,r,o,c,void 0,f),c=am(),n!==null&&!gs?(om(n,r,f),Fi(n,r,f)):(Qt&&c&&Bf(r),r.flags|=1,Is(n,r,o,f),r.child)}function n1(n,r,o,c,f,m){return yo(r),r.updateQueue=null,o=i0(r,c,o,f),r0(n),c=am(),n!==null&&!gs?(om(n,r,m),Fi(n,r,m)):(Qt&&c&&Bf(r),r.flags|=1,Is(n,r,o,m),r.child)}function s1(n,r,o,c,f){if(yo(r),r.stateNode===null){var m=rl,w=o.contextType;typeof w=="object"&&w!==null&&(m=Rs(w)),m=new o(c,m),r.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=xm,r.stateNode=m,m._reactInternals=r,m=r.stateNode,m.props=c,m.state=r.memoizedState,m.refs={},Xf(r),w=o.contextType,m.context=typeof w=="object"&&w!==null?Rs(w):rl,m.state=r.memoizedState,w=o.getDerivedStateFromProps,typeof w=="function"&&(_m(r,o,w,c),m.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(w=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),w!==m.state&&xm.enqueueReplaceState(m,m.state,null),vc(r,c,m,f),yc(),m.state=r.memoizedState),typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(n===null){m=r.stateNode;var k=r.memoizedProps,U=Eo(o,k);m.props=U;var ee=m.context,fe=o.contextType;w=rl,typeof fe=="object"&&fe!==null&&(w=Rs(fe));var ye=o.getDerivedStateFromProps;fe=typeof ye=="function"||typeof m.getSnapshotBeforeUpdate=="function",k=r.pendingProps!==k,fe||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(k||ee!==w)&&q0(r,m,c,w),wa=!1;var se=r.memoizedState;m.state=se,vc(r,c,m,f),yc(),ee=r.memoizedState,k||se!==ee||wa?(typeof ye=="function"&&(_m(r,o,ye,c),ee=r.memoizedState),(U=wa||F0(r,o,U,c,se,ee,w))?(fe||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(r.flags|=4194308)):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=ee),m.props=c,m.state=ee,m.context=w,c=U):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{m=r.stateNode,Jf(n,r),w=r.memoizedProps,fe=Eo(o,w),m.props=fe,ye=r.pendingProps,se=m.context,ee=o.contextType,U=rl,typeof ee=="object"&&ee!==null&&(U=Rs(ee)),k=o.getDerivedStateFromProps,(ee=typeof k=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(w!==ye||se!==U)&&q0(r,m,c,U),wa=!1,se=r.memoizedState,m.state=se,vc(r,c,m,f),yc();var he=r.memoizedState;w!==ye||se!==he||wa||n!==null&&n.dependencies!==null&&ah(n.dependencies)?(typeof k=="function"&&(_m(r,o,k,c),he=r.memoizedState),(fe=wa||F0(r,o,fe,c,se,he,U)||n!==null&&n.dependencies!==null&&ah(n.dependencies))?(ee||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(c,he,U),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(c,he,U)),typeof m.componentDidUpdate=="function"&&(r.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof m.componentDidUpdate!="function"||w===n.memoizedProps&&se===n.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||w===n.memoizedProps&&se===n.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=he),m.props=c,m.state=he,m.context=U,c=fe):(typeof m.componentDidUpdate!="function"||w===n.memoizedProps&&se===n.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||w===n.memoizedProps&&se===n.memoizedState||(r.flags|=1024),c=!1)}return m=c,kh(n,r),c=(r.flags&128)!==0,m||c?(m=r.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:m.render(),r.flags|=1,n!==null&&c?(r.child=_o(r,n.child,null,f),r.child=_o(r,null,o,f)):Is(n,r,o,f),r.memoizedState=m.state,n=r.child):n=Fi(n,r,f),n}function r1(n,r,o,c){return po(),r.flags|=256,Is(n,r,o,c),r.child}var Sm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function jm(n){return{baseLanes:n,cachePool:Gv()}}function Cm(n,r,o){return n=n!==null?n.childLanes&~o:0,r&&(n|=Tr),n}function i1(n,r,o){var c=r.pendingProps,f=!1,m=(r.flags&128)!==0,w;if((w=m)||(w=n!==null&&n.memoizedState===null?!1:(cs.current&2)!==0),w&&(f=!0,r.flags&=-129),w=(r.flags&32)!==0,r.flags&=-33,n===null){if(Qt){if(f?Ea(r):Ta(),(n=Pn)?(n=fb(n,Fr),n=n!==null&&n.data!=="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:ga!==null?{id:yi,overflow:vi}:null,retryLane:536870912,hydrationErrors:null},o=Vv(n),o.return=r,r.child=o,As=r,Pn=null)):n=null,n===null)throw va(r);return up(n)?r.lanes=32:r.lanes=536870912,null}var k=c.children;return c=c.fallback,f?(Ta(),f=r.mode,k=Sh({mode:"hidden",children:k},f),c=mo(c,f,o,null),k.return=r,c.return=r,k.sibling=c,r.child=k,c=r.child,c.memoizedState=jm(o),c.childLanes=Cm(n,w,o),r.memoizedState=Sm,Ec(null,c)):(Ea(r),Nm(r,k))}var U=n.memoizedState;if(U!==null&&(k=U.dehydrated,k!==null)){if(m)r.flags&256?(Ea(r),r.flags&=-257,r=Am(n,r,o)):r.memoizedState!==null?(Ta(),r.child=n.child,r.flags|=128,r=null):(Ta(),k=c.fallback,f=r.mode,c=Sh({mode:"visible",children:c.children},f),k=mo(k,f,o,null),k.flags|=2,c.return=r,k.return=r,c.sibling=k,r.child=c,_o(r,n.child,null,o),c=r.child,c.memoizedState=jm(o),c.childLanes=Cm(n,w,o),r.memoizedState=Sm,r=Ec(null,c));else if(Ea(r),up(k)){if(w=k.nextSibling&&k.nextSibling.dataset,w)var ee=w.dgst;w=ee,c=Error(i(419)),c.stack="",c.digest=w,hc({value:c,source:null,stack:null}),r=Am(n,r,o)}else if(gs||ll(n,r,o,!1),w=(o&n.childLanes)!==0,gs||w){if(w=Sn,w!==null&&(c=Nn(w,o),c!==0&&c!==U.retryLane))throw U.retryLane=c,fo(n,c),ur(w,n,c),Tm;cp(k)||Lh(),r=Am(n,r,o)}else cp(k)?(r.flags|=192,r.child=n.child,r=null):(n=U.treeContext,Pn=Hr(k.nextSibling),As=r,Qt=!0,ya=null,Fr=!1,n!==null&&zv(r,n),r=Nm(r,c.children),r.flags|=4096);return r}return f?(Ta(),k=c.fallback,f=r.mode,U=n.child,ee=U.sibling,c=Oi(U,{mode:"hidden",children:c.children}),c.subtreeFlags=U.subtreeFlags&65011712,ee!==null?k=Oi(ee,k):(k=mo(k,f,o,null),k.flags|=2),k.return=r,c.return=r,c.sibling=k,r.child=c,Ec(null,c),c=r.child,k=n.child.memoizedState,k===null?k=jm(o):(f=k.cachePool,f!==null?(U=ms._currentValue,f=f.parent!==U?{parent:U,pool:U}:f):f=Gv(),k={baseLanes:k.baseLanes|o,cachePool:f}),c.memoizedState=k,c.childLanes=Cm(n,w,o),r.memoizedState=Sm,Ec(n.child,c)):(Ea(r),o=n.child,n=o.sibling,o=Oi(o,{mode:"visible",children:c.children}),o.return=r,o.sibling=null,n!==null&&(w=r.deletions,w===null?(r.deletions=[n],r.flags|=16):w.push(n)),r.child=o,r.memoizedState=null,o)}function Nm(n,r){return r=Sh({mode:"visible",children:r},n.mode),r.return=n,n.child=r}function Sh(n,r){return n=wr(22,n,null,r),n.lanes=0,n}function Am(n,r,o){return _o(r,n.child,null,o),n=Nm(r,r.pendingProps.children),n.flags|=2,r.memoizedState=null,n}function a1(n,r,o){n.lanes|=r;var c=n.alternate;c!==null&&(c.lanes|=r),$f(n.return,r,o)}function Rm(n,r,o,c,f,m){var w=n.memoizedState;w===null?n.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:f,treeForkCount:m}:(w.isBackwards=r,w.rendering=null,w.renderingStartTime=0,w.last=c,w.tail=o,w.tailMode=f,w.treeForkCount=m)}function o1(n,r,o){var c=r.pendingProps,f=c.revealOrder,m=c.tail;c=c.children;var w=cs.current,k=(w&2)!==0;if(k?(w=w&1|2,r.flags|=128):w&=1,we(cs,w),Is(n,r,c,o),c=Qt?uc:0,!k&&n!==null&&(n.flags&128)!==0)e:for(n=r.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&a1(n,o,r);else if(n.tag===19)a1(n,o,r);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break e;for(;n.sibling===null;){if(n.return===null||n.return===r)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(f){case"forwards":for(o=r.child,f=null;o!==null;)n=o.alternate,n!==null&&mh(n)===null&&(f=o),o=o.sibling;o=f,o===null?(f=r.child,r.child=null):(f=o.sibling,o.sibling=null),Rm(r,!1,f,o,m,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,f=r.child,r.child=null;f!==null;){if(n=f.alternate,n!==null&&mh(n)===null){r.child=f;break}n=f.sibling,f.sibling=o,o=f,f=n}Rm(r,!0,o,null,m,c);break;case"together":Rm(r,!1,null,null,void 0,c);break;default:r.memoizedState=null}return r.child}function Fi(n,r,o){if(n!==null&&(r.dependencies=n.dependencies),ja|=r.lanes,(o&r.childLanes)===0)if(n!==null){if(ll(n,r,o,!1),(o&r.childLanes)===0)return null}else return null;if(n!==null&&r.child!==n.child)throw Error(i(153));if(r.child!==null){for(n=r.child,o=Oi(n,n.pendingProps),r.child=o,o.return=r;n.sibling!==null;)n=n.sibling,o=o.sibling=Oi(n,n.pendingProps),o.return=r;o.sibling=null}return r.child}function Im(n,r){return(n.lanes&r)!==0?!0:(n=n.dependencies,!!(n!==null&&ah(n)))}function yk(n,r,o){switch(r.tag){case 3:ct(r,r.stateNode.containerInfo),ba(r,ms,n.memoizedState.cache),po();break;case 27:case 5:tn(r);break;case 4:ct(r,r.stateNode.containerInfo);break;case 10:ba(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,sm(r),null;break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(Ea(r),r.flags|=128,null):(o&r.child.childLanes)!==0?i1(n,r,o):(Ea(r),n=Fi(n,r,o),n!==null?n.sibling:null);Ea(r);break;case 19:var f=(n.flags&128)!==0;if(c=(o&r.childLanes)!==0,c||(ll(n,r,o,!1),c=(o&r.childLanes)!==0),f){if(c)return o1(n,r,o);r.flags|=128}if(f=r.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),we(cs,cs.current),c)break;return null;case 22:return r.lanes=0,Z0(n,r,o,r.pendingProps);case 24:ba(r,ms,n.memoizedState.cache)}return Fi(n,r,o)}function l1(n,r,o){if(n!==null)if(n.memoizedProps!==r.pendingProps)gs=!0;else{if(!Im(n,o)&&(r.flags&128)===0)return gs=!1,yk(n,r,o);gs=(n.flags&131072)!==0}else gs=!1,Qt&&(r.flags&1048576)!==0&&Bv(r,uc,r.index);switch(r.lanes=0,r.tag){case 16:e:{var c=r.pendingProps;if(n=bo(r.elementType),r.type=n,typeof n=="function")Pf(n)?(c=Eo(n,c),r.tag=1,r=s1(null,r,n,c,o)):(r.tag=0,r=km(null,r,n,c,o));else{if(n!=null){var f=n.$$typeof;if(f===de){r.tag=11,r=Q0(null,r,n,c,o);break e}else if(f===j){r.tag=14,r=X0(null,r,n,c,o);break e}}throw r=Be(n)||n,Error(i(306,r,""))}}return r;case 0:return km(n,r,r.type,r.pendingProps,o);case 1:return c=r.type,f=Eo(c,r.pendingProps),s1(n,r,c,f,o);case 3:e:{if(ct(r,r.stateNode.containerInfo),n===null)throw Error(i(387));c=r.pendingProps;var m=r.memoizedState;f=m.element,Jf(n,r),vc(r,c,null,o);var w=r.memoizedState;if(c=w.cache,ba(r,ms,c),c!==m.cache&&Wf(r,[ms],o,!0),yc(),c=w.element,m.isDehydrated)if(m={element:c,isDehydrated:!1,cache:w.cache},r.updateQueue.baseState=m,r.memoizedState=m,r.flags&256){r=r1(n,r,c,o);break e}else if(c!==f){f=Ur(Error(i(424)),r),hc(f),r=r1(n,r,c,o);break e}else for(n=r.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,Pn=Hr(n.firstChild),As=r,Qt=!0,ya=null,Fr=!0,o=Zv(r,null,c,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(po(),c===f){r=Fi(n,r,o);break e}Is(n,r,c,o)}r=r.child}return r;case 26:return kh(n,r),n===null?(o=bb(r.type,null,r.pendingProps,null))?r.memoizedState=o:Qt||(o=r.type,n=r.pendingProps,c=Fh(Ee.current).createElement(o),c[Jt]=r,c[An]=n,Ds(c,o,n),zt(c),r.stateNode=c):r.memoizedState=bb(r.type,n.memoizedProps,r.pendingProps,n.memoizedState),null;case 27:return tn(r),n===null&&Qt&&(c=r.stateNode=gb(r.type,r.pendingProps,Ee.current),As=r,Fr=!0,f=Pn,Ia(r.type)?(hp=f,Pn=Hr(c.firstChild)):Pn=f),Is(n,r,r.pendingProps.children,o),kh(n,r),n===null&&(r.flags|=4194304),r.child;case 5:return n===null&&Qt&&((f=c=Pn)&&(c=Gk(c,r.type,r.pendingProps,Fr),c!==null?(r.stateNode=c,As=r,Pn=Hr(c.firstChild),Fr=!1,f=!0):f=!1),f||va(r)),tn(r),f=r.type,m=r.pendingProps,w=n!==null?n.memoizedProps:null,c=m.children,ap(f,m)?c=null:w!==null&&ap(f,w)&&(r.flags|=32),r.memoizedState!==null&&(f=im(n,r,lk,null,null,o),Vc._currentValue=f),kh(n,r),Is(n,r,c,o),r.child;case 6:return n===null&&Qt&&((n=o=Pn)&&(o=Kk(o,r.pendingProps,Fr),o!==null?(r.stateNode=o,As=r,Pn=null,n=!0):n=!1),n||va(r)),null;case 13:return i1(n,r,o);case 4:return ct(r,r.stateNode.containerInfo),c=r.pendingProps,n===null?r.child=_o(r,null,c,o):Is(n,r,c,o),r.child;case 11:return Q0(n,r,r.type,r.pendingProps,o);case 7:return Is(n,r,r.pendingProps,o),r.child;case 8:return Is(n,r,r.pendingProps.children,o),r.child;case 12:return Is(n,r,r.pendingProps.children,o),r.child;case 10:return c=r.pendingProps,ba(r,r.type,c.value),Is(n,r,c.children,o),r.child;case 9:return f=r.type._context,c=r.pendingProps.children,yo(r),f=Rs(f),c=c(f),r.flags|=1,Is(n,r,c,o),r.child;case 14:return X0(n,r,r.type,r.pendingProps,o);case 15:return J0(n,r,r.type,r.pendingProps,o);case 19:return o1(n,r,o);case 31:return gk(n,r,o);case 22:return Z0(n,r,o,r.pendingProps);case 24:return yo(r),c=Rs(ms),n===null?(f=Yf(),f===null&&(f=Sn,m=Gf(),f.pooledCache=m,m.refCount++,m!==null&&(f.pooledCacheLanes|=o),f=m),r.memoizedState={parent:c,cache:f},Xf(r),ba(r,ms,f)):((n.lanes&o)!==0&&(Jf(n,r),vc(r,null,null,o),yc()),f=n.memoizedState,m=r.memoizedState,f.parent!==c?(f={parent:c,cache:c},r.memoizedState=f,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=f),ba(r,ms,c)):(c=m.cache,ba(r,ms,c),c!==f.cache&&Wf(r,[ms],o,!0))),Is(n,r,r.pendingProps.children,o),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function qi(n){n.flags|=4}function Dm(n,r,o,c,f){if((r=(n.mode&32)!==0)&&(r=!1),r){if(n.flags|=16777216,(f&335544128)===f)if(n.stateNode.complete)n.flags|=8192;else if(L1())n.flags|=8192;else throw wo=uh,Qf}else n.flags&=-16777217}function c1(n,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!Tb(r))if(L1())n.flags|=8192;else throw wo=uh,Qf}function jh(n,r){r!==null&&(n.flags|=4),n.flags&16384&&(r=n.tag!==22?oe():536870912,n.lanes|=r,wl|=r)}function Tc(n,r){if(!Qt)switch(n.tailMode){case"hidden":r=n.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?r||n.tail===null?n.tail=null:n.tail.sibling=null:c.sibling=null}}function Vn(n){var r=n.alternate!==null&&n.alternate.child===n.child,o=0,c=0;if(r)for(var f=n.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags&65011712,c|=f.flags&65011712,f.return=n,f=f.sibling;else for(f=n.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=n,f=f.sibling;return n.subtreeFlags|=c,n.childLanes=o,r}function vk(n,r,o){var c=r.pendingProps;switch(zf(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vn(r),null;case 1:return Vn(r),null;case 3:return o=r.stateNode,c=null,n!==null&&(c=n.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),Ui(ms),Ve(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(ol(r)?qi(r):n===null||n.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,qf())),Vn(r),null;case 26:var f=r.type,m=r.memoizedState;return n===null?(qi(r),m!==null?(Vn(r),c1(r,m)):(Vn(r),Dm(r,f,null,c,o))):m?m!==n.memoizedState?(qi(r),Vn(r),c1(r,m)):(Vn(r),r.flags&=-16777217):(n=n.memoizedProps,n!==c&&qi(r),Vn(r),Dm(r,f,n,c,o)),null;case 27:if(jn(r),o=Ee.current,f=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==c&&qi(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Vn(r),null}n=ke.current,ol(r)?Fv(r):(n=gb(f,c,o),r.stateNode=n,qi(r))}return Vn(r),null;case 5:if(jn(r),f=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==c&&qi(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Vn(r),null}if(m=ke.current,ol(r))Fv(r);else{var w=Fh(Ee.current);switch(m){case 1:m=w.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:m=w.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":m=w.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":m=w.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":m=w.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof c.is=="string"?w.createElement("select",{is:c.is}):w.createElement("select"),c.multiple?m.multiple=!0:c.size&&(m.size=c.size);break;default:m=typeof c.is=="string"?w.createElement(f,{is:c.is}):w.createElement(f)}}m[Jt]=r,m[An]=c;e:for(w=r.child;w!==null;){if(w.tag===5||w.tag===6)m.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===r)break e;for(;w.sibling===null;){if(w.return===null||w.return===r)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}r.stateNode=m;e:switch(Ds(m,f,c),f){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&qi(r)}}return Vn(r),Dm(r,r.type,n===null?null:n.memoizedProps,r.pendingProps,o),null;case 6:if(n&&r.stateNode!=null)n.memoizedProps!==c&&qi(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(i(166));if(n=Ee.current,ol(r)){if(n=r.stateNode,o=r.memoizedProps,c=null,f=As,f!==null)switch(f.tag){case 27:case 5:c=f.memoizedProps}n[Jt]=r,n=!!(n.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||ib(n.nodeValue,o)),n||va(r,!0)}else n=Fh(n).createTextNode(c),n[Jt]=r,r.stateNode=n}return Vn(r),null;case 31:if(o=r.memoizedState,n===null||n.memoizedState!==null){if(c=ol(r),o!==null){if(n===null){if(!c)throw Error(i(318));if(n=r.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(557));n[Jt]=r}else po(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Vn(r),n=!1}else o=qf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=o),n=!0;if(!n)return r.flags&256?(xr(r),r):(xr(r),null);if((r.flags&128)!==0)throw Error(i(558))}return Vn(r),null;case 13:if(c=r.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(f=ol(r),c!==null&&c.dehydrated!==null){if(n===null){if(!f)throw Error(i(318));if(f=r.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));f[Jt]=r}else po(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Vn(r),f=!1}else f=qf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=f),f=!0;if(!f)return r.flags&256?(xr(r),r):(xr(r),null)}return xr(r),(r.flags&128)!==0?(r.lanes=o,r):(o=c!==null,n=n!==null&&n.memoizedState!==null,o&&(c=r.child,f=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(f=c.alternate.memoizedState.cachePool.pool),m=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(m=c.memoizedState.cachePool.pool),m!==f&&(c.flags|=2048)),o!==n&&o&&(r.child.flags|=8192),jh(r,r.updateQueue),Vn(r),null);case 4:return Ve(),n===null&&tp(r.stateNode.containerInfo),Vn(r),null;case 10:return Ui(r.type),Vn(r),null;case 19:if(ie(cs),c=r.memoizedState,c===null)return Vn(r),null;if(f=(r.flags&128)!==0,m=c.rendering,m===null)if(f)Tc(c,!1);else{if(es!==0||n!==null&&(n.flags&128)!==0)for(n=r.child;n!==null;){if(m=mh(n),m!==null){for(r.flags|=128,Tc(c,!1),n=m.updateQueue,r.updateQueue=n,jh(r,n),r.subtreeFlags=0,n=o,o=r.child;o!==null;)Pv(o,n),o=o.sibling;return we(cs,cs.current&1|2),Qt&&Pi(r,c.treeForkCount),r.child}n=n.sibling}c.tail!==null&&vt()>Ih&&(r.flags|=128,f=!0,Tc(c,!1),r.lanes=4194304)}else{if(!f)if(n=mh(m),n!==null){if(r.flags|=128,f=!0,n=n.updateQueue,r.updateQueue=n,jh(r,n),Tc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!m.alternate&&!Qt)return Vn(r),null}else 2*vt()-c.renderingStartTime>Ih&&o!==536870912&&(r.flags|=128,f=!0,Tc(c,!1),r.lanes=4194304);c.isBackwards?(m.sibling=r.child,r.child=m):(n=c.last,n!==null?n.sibling=m:r.child=m,c.last=m)}return c.tail!==null?(n=c.tail,c.rendering=n,c.tail=n.sibling,c.renderingStartTime=vt(),n.sibling=null,o=cs.current,we(cs,f?o&1|2:o&1),Qt&&Pi(r,c.treeForkCount),n):(Vn(r),null);case 22:case 23:return xr(r),nm(),c=r.memoizedState!==null,n!==null?n.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(o&536870912)!==0&&(r.flags&128)===0&&(Vn(r),r.subtreeFlags&6&&(r.flags|=8192)):Vn(r),o=r.updateQueue,o!==null&&jh(r,o.retryQueue),o=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==o&&(r.flags|=2048),n!==null&&ie(vo),null;case 24:return o=null,n!==null&&(o=n.memoizedState.cache),r.memoizedState.cache!==o&&(r.flags|=2048),Ui(ms),Vn(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function bk(n,r){switch(zf(r),r.tag){case 1:return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 3:return Ui(ms),Ve(),n=r.flags,(n&65536)!==0&&(n&128)===0?(r.flags=n&-65537|128,r):null;case 26:case 27:case 5:return jn(r),null;case 31:if(r.memoizedState!==null){if(xr(r),r.alternate===null)throw Error(i(340));po()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 13:if(xr(r),n=r.memoizedState,n!==null&&n.dehydrated!==null){if(r.alternate===null)throw Error(i(340));po()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 19:return ie(cs),null;case 4:return Ve(),null;case 10:return Ui(r.type),null;case 22:case 23:return xr(r),nm(),n!==null&&ie(vo),n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 24:return Ui(ms),null;case 25:return null;default:return null}}function u1(n,r){switch(zf(r),r.tag){case 3:Ui(ms),Ve();break;case 26:case 27:case 5:jn(r);break;case 4:Ve();break;case 31:r.memoizedState!==null&&xr(r);break;case 13:xr(r);break;case 19:ie(cs);break;case 10:Ui(r.type);break;case 22:case 23:xr(r),nm(),n!==null&&ie(vo);break;case 24:Ui(ms)}}function kc(n,r){try{var o=r.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var f=c.next;o=f;do{if((o.tag&n)===n){c=void 0;var m=o.create,w=o.inst;c=m(),w.destroy=c}o=o.next}while(o!==f)}}catch(k){yn(r,r.return,k)}}function ka(n,r,o){try{var c=r.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var m=f.next;c=m;do{if((c.tag&n)===n){var w=c.inst,k=w.destroy;if(k!==void 0){w.destroy=void 0,f=r;var U=o,ee=k;try{ee()}catch(fe){yn(f,U,fe)}}}c=c.next}while(c!==m)}}catch(fe){yn(r,r.return,fe)}}function h1(n){var r=n.updateQueue;if(r!==null){var o=n.stateNode;try{t0(r,o)}catch(c){yn(n,n.return,c)}}}function d1(n,r,o){o.props=Eo(n.type,n.memoizedProps),o.state=n.memoizedState;try{o.componentWillUnmount()}catch(c){yn(n,r,c)}}function Sc(n,r){try{var o=n.ref;if(o!==null){switch(n.tag){case 26:case 27:case 5:var c=n.stateNode;break;case 30:c=n.stateNode;break;default:c=n.stateNode}typeof o=="function"?n.refCleanup=o(c):o.current=c}}catch(f){yn(n,r,f)}}function bi(n,r){var o=n.ref,c=n.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(f){yn(n,r,f)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(f){yn(n,r,f)}else o.current=null}function f1(n){var r=n.type,o=n.memoizedProps,c=n.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(f){yn(n,n.return,f)}}function Mm(n,r,o){try{var c=n.stateNode;zk(c,n.type,o,r),c[An]=r}catch(f){yn(n,n.return,f)}}function m1(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Ia(n.type)||n.tag===4}function Lm(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||m1(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Ia(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Om(n,r,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(n,r):(r=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,r.appendChild(n),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=dt));else if(c!==4&&(c===27&&Ia(n.type)&&(o=n.stateNode,r=null),n=n.child,n!==null))for(Om(n,r,o),n=n.sibling;n!==null;)Om(n,r,o),n=n.sibling}function Ch(n,r,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?o.insertBefore(n,r):o.appendChild(n);else if(c!==4&&(c===27&&Ia(n.type)&&(o=n.stateNode),n=n.child,n!==null))for(Ch(n,r,o),n=n.sibling;n!==null;)Ch(n,r,o),n=n.sibling}function p1(n){var r=n.stateNode,o=n.memoizedProps;try{for(var c=n.type,f=r.attributes;f.length;)r.removeAttributeNode(f[0]);Ds(r,c,o),r[Jt]=n,r[An]=o}catch(m){yn(n,n.return,m)}}var Hi=!1,ys=!1,Pm=!1,g1=typeof WeakSet=="function"?WeakSet:Set,ks=null;function wk(n,r){if(n=n.containerInfo,rp=Yh,n=Cv(n),Af(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else e:{o=(o=n.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var f=c.anchorOffset,m=c.focusNode;c=c.focusOffset;try{o.nodeType,m.nodeType}catch{o=null;break e}var w=0,k=-1,U=-1,ee=0,fe=0,ye=n,se=null;t:for(;;){for(var he;ye!==o||f!==0&&ye.nodeType!==3||(k=w+f),ye!==m||c!==0&&ye.nodeType!==3||(U=w+c),ye.nodeType===3&&(w+=ye.nodeValue.length),(he=ye.firstChild)!==null;)se=ye,ye=he;for(;;){if(ye===n)break t;if(se===o&&++ee===f&&(k=w),se===m&&++fe===c&&(U=w),(he=ye.nextSibling)!==null)break;ye=se,se=ye.parentNode}ye=he}o=k===-1||U===-1?null:{start:k,end:U}}else o=null}o=o||{start:0,end:0}}else o=null;for(ip={focusedElem:n,selectionRange:o},Yh=!1,ks=r;ks!==null;)if(r=ks,n=r.child,(r.subtreeFlags&1028)!==0&&n!==null)n.return=r,ks=n;else for(;ks!==null;){switch(r=ks,m=r.alternate,n=r.flags,r.tag){case 0:if((n&4)!==0&&(n=r.updateQueue,n=n!==null?n.events:null,n!==null))for(o=0;o<n.length;o++)f=n[o],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&m!==null){n=void 0,o=r,f=m.memoizedProps,m=m.memoizedState,c=o.stateNode;try{var Xe=Eo(o.type,f);n=c.getSnapshotBeforeUpdate(Xe,m),c.__reactInternalSnapshotBeforeUpdate=n}catch(ft){yn(o,o.return,ft)}}break;case 3:if((n&1024)!==0){if(n=r.stateNode.containerInfo,o=n.nodeType,o===9)lp(n);else if(o===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":lp(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(i(163))}if(n=r.sibling,n!==null){n.return=r.return,ks=n;break}ks=r.return}}function y1(n,r,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:Wi(n,o),c&4&&kc(5,o);break;case 1:if(Wi(n,o),c&4)if(n=o.stateNode,r===null)try{n.componentDidMount()}catch(w){yn(o,o.return,w)}else{var f=Eo(o.type,r.memoizedProps);r=r.memoizedState;try{n.componentDidUpdate(f,r,n.__reactInternalSnapshotBeforeUpdate)}catch(w){yn(o,o.return,w)}}c&64&&h1(o),c&512&&Sc(o,o.return);break;case 3:if(Wi(n,o),c&64&&(n=o.updateQueue,n!==null)){if(r=null,o.child!==null)switch(o.child.tag){case 27:case 5:r=o.child.stateNode;break;case 1:r=o.child.stateNode}try{t0(n,r)}catch(w){yn(o,o.return,w)}}break;case 27:r===null&&c&4&&p1(o);case 26:case 5:Wi(n,o),r===null&&c&4&&f1(o),c&512&&Sc(o,o.return);break;case 12:Wi(n,o);break;case 31:Wi(n,o),c&4&&w1(n,o);break;case 13:Wi(n,o),c&4&&_1(n,o),c&64&&(n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(o=Nk.bind(null,o),Yk(n,o))));break;case 22:if(c=o.memoizedState!==null||Hi,!c){r=r!==null&&r.memoizedState!==null||ys,f=Hi;var m=ys;Hi=c,(ys=r)&&!m?Gi(n,o,(o.subtreeFlags&8772)!==0):Wi(n,o),Hi=f,ys=m}break;case 30:break;default:Wi(n,o)}}function v1(n){var r=n.alternate;r!==null&&(n.alternate=null,v1(r)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(r=n.stateNode,r!==null&&Ks(r)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var Wn=null,ar=!1;function $i(n,r,o){for(o=o.child;o!==null;)b1(n,r,o),o=o.sibling}function b1(n,r,o){if($e&&typeof $e.onCommitFiberUnmount=="function")try{$e.onCommitFiberUnmount(it,o)}catch{}switch(o.tag){case 26:ys||bi(o,r),$i(n,r,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:ys||bi(o,r);var c=Wn,f=ar;Ia(o.type)&&(Wn=o.stateNode,ar=!1),$i(n,r,o),Lc(o.stateNode),Wn=c,ar=f;break;case 5:ys||bi(o,r);case 6:if(c=Wn,f=ar,Wn=null,$i(n,r,o),Wn=c,ar=f,Wn!==null)if(ar)try{(Wn.nodeType===9?Wn.body:Wn.nodeName==="HTML"?Wn.ownerDocument.body:Wn).removeChild(o.stateNode)}catch(m){yn(o,r,m)}else try{Wn.removeChild(o.stateNode)}catch(m){yn(o,r,m)}break;case 18:Wn!==null&&(ar?(n=Wn,hb(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,o.stateNode),Cl(n)):hb(Wn,o.stateNode));break;case 4:c=Wn,f=ar,Wn=o.stateNode.containerInfo,ar=!0,$i(n,r,o),Wn=c,ar=f;break;case 0:case 11:case 14:case 15:ka(2,o,r),ys||ka(4,o,r),$i(n,r,o);break;case 1:ys||(bi(o,r),c=o.stateNode,typeof c.componentWillUnmount=="function"&&d1(o,r,c)),$i(n,r,o);break;case 21:$i(n,r,o);break;case 22:ys=(c=ys)||o.memoizedState!==null,$i(n,r,o),ys=c;break;default:$i(n,r,o)}}function w1(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{Cl(n)}catch(o){yn(r,r.return,o)}}}function _1(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Cl(n)}catch(o){yn(r,r.return,o)}}function _k(n){switch(n.tag){case 31:case 13:case 19:var r=n.stateNode;return r===null&&(r=n.stateNode=new g1),r;case 22:return n=n.stateNode,r=n._retryCache,r===null&&(r=n._retryCache=new g1),r;default:throw Error(i(435,n.tag))}}function Nh(n,r){var o=_k(n);r.forEach(function(c){if(!o.has(c)){o.add(c);var f=Ak.bind(null,n,c);c.then(f,f)}})}function or(n,r){var o=r.deletions;if(o!==null)for(var c=0;c<o.length;c++){var f=o[c],m=n,w=r,k=w;e:for(;k!==null;){switch(k.tag){case 27:if(Ia(k.type)){Wn=k.stateNode,ar=!1;break e}break;case 5:Wn=k.stateNode,ar=!1;break e;case 3:case 4:Wn=k.stateNode.containerInfo,ar=!0;break e}k=k.return}if(Wn===null)throw Error(i(160));b1(m,w,f),Wn=null,ar=!1,m=f.alternate,m!==null&&(m.return=null),f.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)x1(r,n),r=r.sibling}var ei=null;function x1(n,r){var o=n.alternate,c=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:or(r,n),lr(n),c&4&&(ka(3,n,n.return),kc(3,n),ka(5,n,n.return));break;case 1:or(r,n),lr(n),c&512&&(ys||o===null||bi(o,o.return)),c&64&&Hi&&(n=n.updateQueue,n!==null&&(c=n.callbacks,c!==null&&(o=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var f=ei;if(or(r,n),lr(n),c&512&&(ys||o===null||bi(o,o.return)),c&4){var m=o!==null?o.memoizedState:null;if(c=n.memoizedState,o===null)if(c===null)if(n.stateNode===null){e:{c=n.type,o=n.memoizedProps,f=f.ownerDocument||f;t:switch(c){case"title":m=f.getElementsByTagName("title")[0],(!m||m[qn]||m[Jt]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=f.createElement(c),f.head.insertBefore(m,f.querySelector("head > title"))),Ds(m,c,o),m[Jt]=n,zt(m),c=m;break e;case"link":var w=xb("link","href",f).get(c+(o.href||""));if(w){for(var k=0;k<w.length;k++)if(m=w[k],m.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&m.getAttribute("rel")===(o.rel==null?null:o.rel)&&m.getAttribute("title")===(o.title==null?null:o.title)&&m.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){w.splice(k,1);break t}}m=f.createElement(c),Ds(m,c,o),f.head.appendChild(m);break;case"meta":if(w=xb("meta","content",f).get(c+(o.content||""))){for(k=0;k<w.length;k++)if(m=w[k],m.getAttribute("content")===(o.content==null?null:""+o.content)&&m.getAttribute("name")===(o.name==null?null:o.name)&&m.getAttribute("property")===(o.property==null?null:o.property)&&m.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&m.getAttribute("charset")===(o.charSet==null?null:o.charSet)){w.splice(k,1);break t}}m=f.createElement(c),Ds(m,c,o),f.head.appendChild(m);break;default:throw Error(i(468,c))}m[Jt]=n,zt(m),c=m}n.stateNode=c}else Eb(f,n.type,n.stateNode);else n.stateNode=_b(f,c,n.memoizedProps);else m!==c?(m===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):m.count--,c===null?Eb(f,n.type,n.stateNode):_b(f,c,n.memoizedProps)):c===null&&n.stateNode!==null&&Mm(n,n.memoizedProps,o.memoizedProps)}break;case 27:or(r,n),lr(n),c&512&&(ys||o===null||bi(o,o.return)),o!==null&&c&4&&Mm(n,n.memoizedProps,o.memoizedProps);break;case 5:if(or(r,n),lr(n),c&512&&(ys||o===null||bi(o,o.return)),n.flags&32){f=n.stateNode;try{C(f,"")}catch(Xe){yn(n,n.return,Xe)}}c&4&&n.stateNode!=null&&(f=n.memoizedProps,Mm(n,f,o!==null?o.memoizedProps:f)),c&1024&&(Pm=!0);break;case 6:if(or(r,n),lr(n),c&4){if(n.stateNode===null)throw Error(i(162));c=n.memoizedProps,o=n.stateNode;try{o.nodeValue=c}catch(Xe){yn(n,n.return,Xe)}}break;case 3:if($h=null,f=ei,ei=qh(r.containerInfo),or(r,n),ei=f,lr(n),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Cl(r.containerInfo)}catch(Xe){yn(n,n.return,Xe)}Pm&&(Pm=!1,E1(n));break;case 4:c=ei,ei=qh(n.stateNode.containerInfo),or(r,n),lr(n),ei=c;break;case 12:or(r,n),lr(n);break;case 31:or(r,n),lr(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Nh(n,c)));break;case 13:or(r,n),lr(n),n.child.flags&8192&&n.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Rh=vt()),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Nh(n,c)));break;case 22:f=n.memoizedState!==null;var U=o!==null&&o.memoizedState!==null,ee=Hi,fe=ys;if(Hi=ee||f,ys=fe||U,or(r,n),ys=fe,Hi=ee,lr(n),c&8192)e:for(r=n.stateNode,r._visibility=f?r._visibility&-2:r._visibility|1,f&&(o===null||U||Hi||ys||To(n)),o=null,r=n;;){if(r.tag===5||r.tag===26){if(o===null){U=o=r;try{if(m=U.stateNode,f)w=m.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{k=U.stateNode;var ye=U.memoizedProps.style,se=ye!=null&&ye.hasOwnProperty("display")?ye.display:null;k.style.display=se==null||typeof se=="boolean"?"":(""+se).trim()}}catch(Xe){yn(U,U.return,Xe)}}}else if(r.tag===6){if(o===null){U=r;try{U.stateNode.nodeValue=f?"":U.memoizedProps}catch(Xe){yn(U,U.return,Xe)}}}else if(r.tag===18){if(o===null){U=r;try{var he=U.stateNode;f?db(he,!0):db(U.stateNode,!1)}catch(Xe){yn(U,U.return,Xe)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===n)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break e;for(;r.sibling===null;){if(r.return===null||r.return===n)break e;o===r&&(o=null),r=r.return}o===r&&(o=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=n.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,Nh(n,o))));break;case 19:or(r,n),lr(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Nh(n,c)));break;case 30:break;case 21:break;default:or(r,n),lr(n)}}function lr(n){var r=n.flags;if(r&2){try{for(var o,c=n.return;c!==null;){if(m1(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var f=o.stateNode,m=Lm(n);Ch(n,m,f);break;case 5:var w=o.stateNode;o.flags&32&&(C(w,""),o.flags&=-33);var k=Lm(n);Ch(n,k,w);break;case 3:case 4:var U=o.stateNode.containerInfo,ee=Lm(n);Om(n,ee,U);break;default:throw Error(i(161))}}catch(fe){yn(n,n.return,fe)}n.flags&=-3}r&4096&&(n.flags&=-4097)}function E1(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var r=n;E1(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),n=n.sibling}}function Wi(n,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)y1(n,r.alternate,r),r=r.sibling}function To(n){for(n=n.child;n!==null;){var r=n;switch(r.tag){case 0:case 11:case 14:case 15:ka(4,r,r.return),To(r);break;case 1:bi(r,r.return);var o=r.stateNode;typeof o.componentWillUnmount=="function"&&d1(r,r.return,o),To(r);break;case 27:Lc(r.stateNode);case 26:case 5:bi(r,r.return),To(r);break;case 22:r.memoizedState===null&&To(r);break;case 30:To(r);break;default:To(r)}n=n.sibling}}function Gi(n,r,o){for(o=o&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,f=n,m=r,w=m.flags;switch(m.tag){case 0:case 11:case 15:Gi(f,m,o),kc(4,m);break;case 1:if(Gi(f,m,o),c=m,f=c.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(ee){yn(c,c.return,ee)}if(c=m,f=c.updateQueue,f!==null){var k=c.stateNode;try{var U=f.shared.hiddenCallbacks;if(U!==null)for(f.shared.hiddenCallbacks=null,f=0;f<U.length;f++)e0(U[f],k)}catch(ee){yn(c,c.return,ee)}}o&&w&64&&h1(m),Sc(m,m.return);break;case 27:p1(m);case 26:case 5:Gi(f,m,o),o&&c===null&&w&4&&f1(m),Sc(m,m.return);break;case 12:Gi(f,m,o);break;case 31:Gi(f,m,o),o&&w&4&&w1(f,m);break;case 13:Gi(f,m,o),o&&w&4&&_1(f,m);break;case 22:m.memoizedState===null&&Gi(f,m,o),Sc(m,m.return);break;case 30:break;default:Gi(f,m,o)}r=r.sibling}}function Vm(n,r){var o=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),n=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(n=r.memoizedState.cachePool.pool),n!==o&&(n!=null&&n.refCount++,o!=null&&dc(o))}function Um(n,r){n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&dc(n))}function ti(n,r,o,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)T1(n,r,o,c),r=r.sibling}function T1(n,r,o,c){var f=r.flags;switch(r.tag){case 0:case 11:case 15:ti(n,r,o,c),f&2048&&kc(9,r);break;case 1:ti(n,r,o,c);break;case 3:ti(n,r,o,c),f&2048&&(n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&dc(n)));break;case 12:if(f&2048){ti(n,r,o,c),n=r.stateNode;try{var m=r.memoizedProps,w=m.id,k=m.onPostCommit;typeof k=="function"&&k(w,r.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(U){yn(r,r.return,U)}}else ti(n,r,o,c);break;case 31:ti(n,r,o,c);break;case 13:ti(n,r,o,c);break;case 23:break;case 22:m=r.stateNode,w=r.alternate,r.memoizedState!==null?m._visibility&2?ti(n,r,o,c):jc(n,r):m._visibility&2?ti(n,r,o,c):(m._visibility|=2,yl(n,r,o,c,(r.subtreeFlags&10256)!==0||!1)),f&2048&&Vm(w,r);break;case 24:ti(n,r,o,c),f&2048&&Um(r.alternate,r);break;default:ti(n,r,o,c)}}function yl(n,r,o,c,f){for(f=f&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var m=n,w=r,k=o,U=c,ee=w.flags;switch(w.tag){case 0:case 11:case 15:yl(m,w,k,U,f),kc(8,w);break;case 23:break;case 22:var fe=w.stateNode;w.memoizedState!==null?fe._visibility&2?yl(m,w,k,U,f):jc(m,w):(fe._visibility|=2,yl(m,w,k,U,f)),f&&ee&2048&&Vm(w.alternate,w);break;case 24:yl(m,w,k,U,f),f&&ee&2048&&Um(w.alternate,w);break;default:yl(m,w,k,U,f)}r=r.sibling}}function jc(n,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var o=n,c=r,f=c.flags;switch(c.tag){case 22:jc(o,c),f&2048&&Vm(c.alternate,c);break;case 24:jc(o,c),f&2048&&Um(c.alternate,c);break;default:jc(o,c)}r=r.sibling}}var Cc=8192;function vl(n,r,o){if(n.subtreeFlags&Cc)for(n=n.child;n!==null;)k1(n,r,o),n=n.sibling}function k1(n,r,o){switch(n.tag){case 26:vl(n,r,o),n.flags&Cc&&n.memoizedState!==null&&oS(o,ei,n.memoizedState,n.memoizedProps);break;case 5:vl(n,r,o);break;case 3:case 4:var c=ei;ei=qh(n.stateNode.containerInfo),vl(n,r,o),ei=c;break;case 22:n.memoizedState===null&&(c=n.alternate,c!==null&&c.memoizedState!==null?(c=Cc,Cc=16777216,vl(n,r,o),Cc=c):vl(n,r,o));break;default:vl(n,r,o)}}function S1(n){var r=n.alternate;if(r!==null&&(n=r.child,n!==null)){r.child=null;do r=n.sibling,n.sibling=null,n=r;while(n!==null)}}function Nc(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];ks=c,C1(c,n)}S1(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)j1(n),n=n.sibling}function j1(n){switch(n.tag){case 0:case 11:case 15:Nc(n),n.flags&2048&&ka(9,n,n.return);break;case 3:Nc(n);break;case 12:Nc(n);break;case 22:var r=n.stateNode;n.memoizedState!==null&&r._visibility&2&&(n.return===null||n.return.tag!==13)?(r._visibility&=-3,Ah(n)):Nc(n);break;default:Nc(n)}}function Ah(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];ks=c,C1(c,n)}S1(n)}for(n=n.child;n!==null;){switch(r=n,r.tag){case 0:case 11:case 15:ka(8,r,r.return),Ah(r);break;case 22:o=r.stateNode,o._visibility&2&&(o._visibility&=-3,Ah(r));break;default:Ah(r)}n=n.sibling}}function C1(n,r){for(;ks!==null;){var o=ks;switch(o.tag){case 0:case 11:case 15:ka(8,o,r);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:dc(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,ks=c;else e:for(o=n;ks!==null;){c=ks;var f=c.sibling,m=c.return;if(v1(c),c===o){ks=null;break e}if(f!==null){f.return=m,ks=f;break e}ks=m}}}var xk={getCacheForType:function(n){var r=Rs(ms),o=r.data.get(n);return o===void 0&&(o=n(),r.data.set(n,o)),o},cacheSignal:function(){return Rs(ms).controller.signal}},Ek=typeof WeakMap=="function"?WeakMap:Map,hn=0,Sn=null,Ut=null,qt=0,gn=0,Er=null,Sa=!1,bl=!1,Bm=!1,Ki=0,es=0,ja=0,ko=0,zm=0,Tr=0,wl=0,Ac=null,cr=null,Fm=!1,Rh=0,N1=0,Ih=1/0,Dh=null,Ca=null,Es=0,Na=null,_l=null,Yi=0,qm=0,Hm=null,A1=null,Rc=0,$m=null;function kr(){return(hn&2)!==0&&qt!==0?qt&-qt:te.T!==null?Xm():Cs()}function R1(){if(Tr===0)if((qt&536870912)===0||Qt){var n=Xn;Xn<<=1,(Xn&3932160)===0&&(Xn=262144),Tr=n}else Tr=536870912;return n=_r.current,n!==null&&(n.flags|=32),Tr}function ur(n,r,o){(n===Sn&&(gn===2||gn===9)||n.cancelPendingCommit!==null)&&(xl(n,0),Aa(n,qt,Tr,!1)),Ge(n,o),((hn&2)===0||n!==Sn)&&(n===Sn&&((hn&2)===0&&(ko|=o),es===4&&Aa(n,qt,Tr,!1)),wi(n))}function I1(n,r,o){if((hn&6)!==0)throw Error(i(327));var c=!o&&(r&127)===0&&(r&n.expiredLanes)===0||ln(n,r),f=c?Sk(n,r):Gm(n,r,!0),m=c;do{if(f===0){bl&&!c&&Aa(n,r,0,!1);break}else{if(o=n.current.alternate,m&&!Tk(o)){f=Gm(n,r,!1),m=!1;continue}if(f===2){if(m=r,n.errorRecoveryDisabledLanes&m)var w=0;else w=n.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){r=w;e:{var k=n;f=Ac;var U=k.current.memoizedState.isDehydrated;if(U&&(xl(k,w).flags|=256),w=Gm(k,w,!1),w!==2){if(Bm&&!U){k.errorRecoveryDisabledLanes|=m,ko|=m,f=4;break e}m=cr,cr=f,m!==null&&(cr===null?cr=m:cr.push.apply(cr,m))}f=w}if(m=!1,f!==2)continue}}if(f===1){xl(n,0),Aa(n,r,0,!0);break}e:{switch(c=n,m=f,m){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:Aa(c,r,Tr,!Sa);break e;case 2:cr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(f=Rh+300-vt(),10<f)){if(Aa(c,r,Tr,!Sa),Cn(c,0,!0)!==0)break e;Yi=r,c.timeoutHandle=cb(D1.bind(null,c,o,cr,Dh,Fm,r,Tr,ko,wl,Sa,m,"Throttled",-0,0),f);break e}D1(c,o,cr,Dh,Fm,r,Tr,ko,wl,Sa,m,null,-0,0)}}break}while(!0);wi(n)}function D1(n,r,o,c,f,m,w,k,U,ee,fe,ye,se,he){if(n.timeoutHandle=-1,ye=r.subtreeFlags,ye&8192||(ye&16785408)===16785408){ye={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:dt},k1(r,m,ye);var Xe=(m&62914560)===m?Rh-vt():(m&4194048)===m?N1-vt():0;if(Xe=lS(ye,Xe),Xe!==null){Yi=m,n.cancelPendingCommit=Xe(z1.bind(null,n,r,m,o,c,f,w,k,U,fe,ye,null,se,he)),Aa(n,m,w,!ee);return}}z1(n,r,m,o,c,f,w,k,U)}function Tk(n){for(var r=n;;){var o=r.tag;if((o===0||o===11||o===15)&&r.flags&16384&&(o=r.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var f=o[c],m=f.getSnapshot;f=f.value;try{if(!br(m(),f))return!1}catch{return!1}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Aa(n,r,o,c){r&=~zm,r&=~ko,n.suspendedLanes|=r,n.pingedLanes&=~r,c&&(n.warmLanes|=r),c=n.expirationTimes;for(var f=r;0<f;){var m=31-Fe(f),w=1<<m;c[m]=-1,f&=~w}o!==0&&lt(n,o,r)}function Mh(){return(hn&6)===0?(Ic(0),!1):!0}function Wm(){if(Ut!==null){if(gn===0)var n=Ut.return;else n=Ut,Vi=go=null,lm(n),dl=null,mc=0,n=Ut;for(;n!==null;)u1(n.alternate,n),n=n.return;Ut=null}}function xl(n,r){var o=n.timeoutHandle;o!==-1&&(n.timeoutHandle=-1,Hk(o)),o=n.cancelPendingCommit,o!==null&&(n.cancelPendingCommit=null,o()),Yi=0,Wm(),Sn=n,Ut=o=Oi(n.current,null),qt=r,gn=0,Er=null,Sa=!1,bl=ln(n,r),Bm=!1,wl=Tr=zm=ko=ja=es=0,cr=Ac=null,Fm=!1,(r&8)!==0&&(r|=r&32);var c=n.entangledLanes;if(c!==0)for(n=n.entanglements,c&=r;0<c;){var f=31-Fe(c),m=1<<f;r|=n[f],c&=~m}return Ki=r,th(),o}function M1(n,r){Dt=null,te.H=xc,r===hl||r===ch?(r=Qv(),gn=3):r===Qf?(r=Qv(),gn=4):gn=r===Tm?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Er=r,Ut===null&&(es=1,Eh(n,Ur(r,n.current)))}function L1(){var n=_r.current;return n===null?!0:(qt&4194048)===qt?qr===null:(qt&62914560)===qt||(qt&536870912)!==0?n===qr:!1}function O1(){var n=te.H;return te.H=xc,n===null?xc:n}function P1(){var n=te.A;return te.A=xk,n}function Lh(){es=4,Sa||(qt&4194048)!==qt&&_r.current!==null||(bl=!0),(ja&134217727)===0&&(ko&134217727)===0||Sn===null||Aa(Sn,qt,Tr,!1)}function Gm(n,r,o){var c=hn;hn|=2;var f=O1(),m=P1();(Sn!==n||qt!==r)&&(Dh=null,xl(n,r)),r=!1;var w=es;e:do try{if(gn!==0&&Ut!==null){var k=Ut,U=Er;switch(gn){case 8:Wm(),w=6;break e;case 3:case 2:case 9:case 6:_r.current===null&&(r=!0);var ee=gn;if(gn=0,Er=null,El(n,k,U,ee),o&&bl){w=0;break e}break;default:ee=gn,gn=0,Er=null,El(n,k,U,ee)}}kk(),w=es;break}catch(fe){M1(n,fe)}while(!0);return r&&n.shellSuspendCounter++,Vi=go=null,hn=c,te.H=f,te.A=m,Ut===null&&(Sn=null,qt=0,th()),w}function kk(){for(;Ut!==null;)V1(Ut)}function Sk(n,r){var o=hn;hn|=2;var c=O1(),f=P1();Sn!==n||qt!==r?(Dh=null,Ih=vt()+500,xl(n,r)):bl=ln(n,r);e:do try{if(gn!==0&&Ut!==null){r=Ut;var m=Er;t:switch(gn){case 1:gn=0,Er=null,El(n,r,m,1);break;case 2:case 9:if(Kv(m)){gn=0,Er=null,U1(r);break}r=function(){gn!==2&&gn!==9||Sn!==n||(gn=7),wi(n)},m.then(r,r);break e;case 3:gn=7;break e;case 4:gn=5;break e;case 7:Kv(m)?(gn=0,Er=null,U1(r)):(gn=0,Er=null,El(n,r,m,7));break;case 5:var w=null;switch(Ut.tag){case 26:w=Ut.memoizedState;case 5:case 27:var k=Ut;if(w?Tb(w):k.stateNode.complete){gn=0,Er=null;var U=k.sibling;if(U!==null)Ut=U;else{var ee=k.return;ee!==null?(Ut=ee,Oh(ee)):Ut=null}break t}}gn=0,Er=null,El(n,r,m,5);break;case 6:gn=0,Er=null,El(n,r,m,6);break;case 8:Wm(),es=6;break e;default:throw Error(i(462))}}jk();break}catch(fe){M1(n,fe)}while(!0);return Vi=go=null,te.H=c,te.A=f,hn=o,Ut!==null?0:(Sn=null,qt=0,th(),es)}function jk(){for(;Ut!==null&&!Je();)V1(Ut)}function V1(n){var r=l1(n.alternate,n,Ki);n.memoizedProps=n.pendingProps,r===null?Oh(n):Ut=r}function U1(n){var r=n,o=r.alternate;switch(r.tag){case 15:case 0:r=n1(o,r,r.pendingProps,r.type,void 0,qt);break;case 11:r=n1(o,r,r.pendingProps,r.type.render,r.ref,qt);break;case 5:lm(r);default:u1(o,r),r=Ut=Pv(r,Ki),r=l1(o,r,Ki)}n.memoizedProps=n.pendingProps,r===null?Oh(n):Ut=r}function El(n,r,o,c){Vi=go=null,lm(r),dl=null,mc=0;var f=r.return;try{if(pk(n,f,r,o,qt)){es=1,Eh(n,Ur(o,n.current)),Ut=null;return}}catch(m){if(f!==null)throw Ut=f,m;es=1,Eh(n,Ur(o,n.current)),Ut=null;return}r.flags&32768?(Qt||c===1?n=!0:bl||(qt&536870912)!==0?n=!1:(Sa=n=!0,(c===2||c===9||c===3||c===6)&&(c=_r.current,c!==null&&c.tag===13&&(c.flags|=16384))),B1(r,n)):Oh(r)}function Oh(n){var r=n;do{if((r.flags&32768)!==0){B1(r,Sa);return}n=r.return;var o=vk(r.alternate,r,Ki);if(o!==null){Ut=o;return}if(r=r.sibling,r!==null){Ut=r;return}Ut=r=n}while(r!==null);es===0&&(es=5)}function B1(n,r){do{var o=bk(n.alternate,n);if(o!==null){o.flags&=32767,Ut=o;return}if(o=n.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!r&&(n=n.sibling,n!==null)){Ut=n;return}Ut=n=o}while(n!==null);es=6,Ut=null}function z1(n,r,o,c,f,m,w,k,U){n.cancelPendingCommit=null;do Ph();while(Es!==0);if((hn&6)!==0)throw Error(i(327));if(r!==null){if(r===n.current)throw Error(i(177));if(m=r.lanes|r.childLanes,m|=Lf,mt(n,o,m,w,k,U),n===Sn&&(Ut=Sn=null,qt=0),_l=r,Na=n,Yi=o,qm=m,Hm=f,A1=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,Rk(Xt,function(){return W1(),null})):(n.callbackNode=null,n.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=te.T,te.T=null,f=_e.p,_e.p=2,w=hn,hn|=4;try{wk(n,r,o)}finally{hn=w,_e.p=f,te.T=c}}Es=1,F1(),q1(),H1()}}function F1(){if(Es===1){Es=0;var n=Na,r=_l,o=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||o){o=te.T,te.T=null;var c=_e.p;_e.p=2;var f=hn;hn|=4;try{x1(r,n);var m=ip,w=Cv(n.containerInfo),k=m.focusedElem,U=m.selectionRange;if(w!==k&&k&&k.ownerDocument&&jv(k.ownerDocument.documentElement,k)){if(U!==null&&Af(k)){var ee=U.start,fe=U.end;if(fe===void 0&&(fe=ee),"selectionStart"in k)k.selectionStart=ee,k.selectionEnd=Math.min(fe,k.value.length);else{var ye=k.ownerDocument||document,se=ye&&ye.defaultView||window;if(se.getSelection){var he=se.getSelection(),Xe=k.textContent.length,ft=Math.min(U.start,Xe),En=U.end===void 0?ft:Math.min(U.end,Xe);!he.extend&&ft>En&&(w=En,En=ft,ft=w);var $=Sv(k,ft),F=Sv(k,En);if($&&F&&(he.rangeCount!==1||he.anchorNode!==$.node||he.anchorOffset!==$.offset||he.focusNode!==F.node||he.focusOffset!==F.offset)){var J=ye.createRange();J.setStart($.node,$.offset),he.removeAllRanges(),ft>En?(he.addRange(J),he.extend(F.node,F.offset)):(J.setEnd(F.node,F.offset),he.addRange(J))}}}}for(ye=[],he=k;he=he.parentNode;)he.nodeType===1&&ye.push({element:he,left:he.scrollLeft,top:he.scrollTop});for(typeof k.focus=="function"&&k.focus(),k=0;k<ye.length;k++){var ge=ye[k];ge.element.scrollLeft=ge.left,ge.element.scrollTop=ge.top}}Yh=!!rp,ip=rp=null}finally{hn=f,_e.p=c,te.T=o}}n.current=r,Es=2}}function q1(){if(Es===2){Es=0;var n=Na,r=_l,o=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||o){o=te.T,te.T=null;var c=_e.p;_e.p=2;var f=hn;hn|=4;try{y1(n,r.alternate,r)}finally{hn=f,_e.p=c,te.T=o}}Es=3}}function H1(){if(Es===4||Es===3){Es=0,At();var n=Na,r=_l,o=Yi,c=A1;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Es=5:(Es=0,_l=Na=null,$1(n,n.pendingLanes));var f=n.pendingLanes;if(f===0&&(Ca=null),bn(o),r=r.stateNode,$e&&typeof $e.onCommitFiberRoot=="function")try{$e.onCommitFiberRoot(it,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=te.T,f=_e.p,_e.p=2,te.T=null;try{for(var m=n.onRecoverableError,w=0;w<c.length;w++){var k=c[w];m(k.value,{componentStack:k.stack})}}finally{te.T=r,_e.p=f}}(Yi&3)!==0&&Ph(),wi(n),f=n.pendingLanes,(o&261930)!==0&&(f&42)!==0?n===$m?Rc++:(Rc=0,$m=n):Rc=0,Ic(0)}}function $1(n,r){(n.pooledCacheLanes&=r)===0&&(r=n.pooledCache,r!=null&&(n.pooledCache=null,dc(r)))}function Ph(){return F1(),q1(),H1(),W1()}function W1(){if(Es!==5)return!1;var n=Na,r=qm;qm=0;var o=bn(Yi),c=te.T,f=_e.p;try{_e.p=32>o?32:o,te.T=null,o=Hm,Hm=null;var m=Na,w=Yi;if(Es=0,_l=Na=null,Yi=0,(hn&6)!==0)throw Error(i(331));var k=hn;if(hn|=4,j1(m.current),T1(m,m.current,w,o),hn=k,Ic(0,!1),$e&&typeof $e.onPostCommitFiberRoot=="function")try{$e.onPostCommitFiberRoot(it,m)}catch{}return!0}finally{_e.p=f,te.T=c,$1(n,r)}}function G1(n,r,o){r=Ur(o,r),r=Em(n.stateNode,r,2),n=xa(n,r,2),n!==null&&(Ge(n,2),wi(n))}function yn(n,r,o){if(n.tag===3)G1(n,n,o);else for(;r!==null;){if(r.tag===3){G1(r,n,o);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Ca===null||!Ca.has(c))){n=Ur(o,n),o=K0(2),c=xa(r,o,2),c!==null&&(Y0(o,c,r,n),Ge(c,2),wi(c));break}}r=r.return}}function Km(n,r,o){var c=n.pingCache;if(c===null){c=n.pingCache=new Ek;var f=new Set;c.set(r,f)}else f=c.get(r),f===void 0&&(f=new Set,c.set(r,f));f.has(o)||(Bm=!0,f.add(o),n=Ck.bind(null,n,r,o),r.then(n,n))}function Ck(n,r,o){var c=n.pingCache;c!==null&&c.delete(r),n.pingedLanes|=n.suspendedLanes&o,n.warmLanes&=~o,Sn===n&&(qt&o)===o&&(es===4||es===3&&(qt&62914560)===qt&&300>vt()-Rh?(hn&2)===0&&xl(n,0):zm|=o,wl===qt&&(wl=0)),wi(n)}function K1(n,r){r===0&&(r=oe()),n=fo(n,r),n!==null&&(Ge(n,r),wi(n))}function Nk(n){var r=n.memoizedState,o=0;r!==null&&(o=r.retryLane),K1(n,o)}function Ak(n,r){var o=0;switch(n.tag){case 31:case 13:var c=n.stateNode,f=n.memoizedState;f!==null&&(o=f.retryLane);break;case 19:c=n.stateNode;break;case 22:c=n.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(r),K1(n,o)}function Rk(n,r){return yt(n,r)}var Vh=null,Tl=null,Ym=!1,Uh=!1,Qm=!1,Ra=0;function wi(n){n!==Tl&&n.next===null&&(Tl===null?Vh=Tl=n:Tl=Tl.next=n),Uh=!0,Ym||(Ym=!0,Dk())}function Ic(n,r){if(!Qm&&Uh){Qm=!0;do for(var o=!1,c=Vh;c!==null;){if(n!==0){var f=c.pendingLanes;if(f===0)var m=0;else{var w=c.suspendedLanes,k=c.pingedLanes;m=(1<<31-Fe(42|n)+1)-1,m&=f&~(w&~k),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(o=!0,J1(c,m))}else m=qt,m=Cn(c,c===Sn?m:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(m&3)===0||ln(c,m)||(o=!0,J1(c,m));c=c.next}while(o);Qm=!1}}function Ik(){Y1()}function Y1(){Uh=Ym=!1;var n=0;Ra!==0&&qk()&&(n=Ra);for(var r=vt(),o=null,c=Vh;c!==null;){var f=c.next,m=Q1(c,r);m===0?(c.next=null,o===null?Vh=f:o.next=f,f===null&&(Tl=o)):(o=c,(n!==0||(m&3)!==0)&&(Uh=!0)),c=f}Es!==0&&Es!==5||Ic(n),Ra!==0&&(Ra=0)}function Q1(n,r){for(var o=n.suspendedLanes,c=n.pingedLanes,f=n.expirationTimes,m=n.pendingLanes&-62914561;0<m;){var w=31-Fe(m),k=1<<w,U=f[w];U===-1?((k&o)===0||(k&c)!==0)&&(f[w]=yr(k,r)):U<=r&&(n.expiredLanes|=k),m&=~k}if(r=Sn,o=qt,o=Cn(n,n===r?o:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c=n.callbackNode,o===0||n===r&&(gn===2||gn===9)||n.cancelPendingCommit!==null)return c!==null&&c!==null&&Vt(c),n.callbackNode=null,n.callbackPriority=0;if((o&3)===0||ln(n,o)){if(r=o&-o,r===n.callbackPriority)return r;switch(c!==null&&Vt(c),bn(o)){case 2:case 8:o=rs;break;case 32:o=Xt;break;case 268435456:o=Ne;break;default:o=Xt}return c=X1.bind(null,n),o=yt(o,c),n.callbackPriority=r,n.callbackNode=o,r}return c!==null&&c!==null&&Vt(c),n.callbackPriority=2,n.callbackNode=null,2}function X1(n,r){if(Es!==0&&Es!==5)return n.callbackNode=null,n.callbackPriority=0,null;var o=n.callbackNode;if(Ph()&&n.callbackNode!==o)return null;var c=qt;return c=Cn(n,n===Sn?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c===0?null:(I1(n,c,r),Q1(n,vt()),n.callbackNode!=null&&n.callbackNode===o?X1.bind(null,n):null)}function J1(n,r){if(Ph())return null;I1(n,r,!0)}function Dk(){$k(function(){(hn&6)!==0?yt(js,Ik):Y1()})}function Xm(){if(Ra===0){var n=cl;n===0&&(n=zn,zn<<=1,(zn&261888)===0&&(zn=256)),Ra=n}return Ra}function Z1(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:kt(""+n)}function eb(n,r){var o=r.ownerDocument.createElement("input");return o.name=r.name,o.value=r.value,n.id&&o.setAttribute("form",n.id),r.parentNode.insertBefore(o,r),n=new FormData(n),o.parentNode.removeChild(o),n}function Mk(n,r,o,c,f){if(r==="submit"&&o&&o.stateNode===f){var m=Z1((f[An]||null).action),w=c.submitter;w&&(r=(r=w[An]||null)?Z1(r.formAction):w.getAttribute("formAction"),r!==null&&(m=r,w=null));var k=new zs("action","action",null,c,f);n.push({event:k,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Ra!==0){var U=w?eb(f,w):new FormData(f);ym(o,{pending:!0,data:U,method:f.method,action:m},null,U)}}else typeof m=="function"&&(k.preventDefault(),U=w?eb(f,w):new FormData(f),ym(o,{pending:!0,data:U,method:f.method,action:m},m,U))},currentTarget:f}]})}}for(var Jm=0;Jm<Mf.length;Jm++){var Zm=Mf[Jm],Lk=Zm.toLowerCase(),Ok=Zm[0].toUpperCase()+Zm.slice(1);Zr(Lk,"on"+Ok)}Zr(Rv,"onAnimationEnd"),Zr(Iv,"onAnimationIteration"),Zr(Dv,"onAnimationStart"),Zr("dblclick","onDoubleClick"),Zr("focusin","onFocus"),Zr("focusout","onBlur"),Zr(JT,"onTransitionRun"),Zr(ZT,"onTransitionStart"),Zr(ek,"onTransitionCancel"),Zr(Mv,"onTransitionEnd"),wn("onMouseEnter",["mouseout","mouseover"]),wn("onMouseLeave",["mouseout","mouseover"]),wn("onPointerEnter",["pointerout","pointerover"]),wn("onPointerLeave",["pointerout","pointerover"]),xs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),xs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),xs("onBeforeInput",["compositionend","keypress","textInput","paste"]),xs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),xs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),xs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pk=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Dc));function tb(n,r){r=(r&4)!==0;for(var o=0;o<n.length;o++){var c=n[o],f=c.event;c=c.listeners;e:{var m=void 0;if(r)for(var w=c.length-1;0<=w;w--){var k=c[w],U=k.instance,ee=k.currentTarget;if(k=k.listener,U!==m&&f.isPropagationStopped())break e;m=k,f.currentTarget=ee;try{m(f)}catch(fe){eh(fe)}f.currentTarget=null,m=U}else for(w=0;w<c.length;w++){if(k=c[w],U=k.instance,ee=k.currentTarget,k=k.listener,U!==m&&f.isPropagationStopped())break e;m=k,f.currentTarget=ee;try{m(f)}catch(fe){eh(fe)}f.currentTarget=null,m=U}}}}function Bt(n,r){var o=r[Ar];o===void 0&&(o=r[Ar]=new Set);var c=n+"__bubble";o.has(c)||(nb(r,n,2,!1),o.add(c))}function ep(n,r,o){var c=0;r&&(c|=4),nb(o,n,c,r)}var Bh="_reactListening"+Math.random().toString(36).slice(2);function tp(n){if(!n[Bh]){n[Bh]=!0,Qr.forEach(function(o){o!=="selectionchange"&&(Pk.has(o)||ep(o,!1,n),ep(o,!0,n))});var r=n.nodeType===9?n:n.ownerDocument;r===null||r[Bh]||(r[Bh]=!0,ep("selectionchange",!1,r))}}function nb(n,r,o,c){switch(Rb(r)){case 2:var f=hS;break;case 8:f=dS;break;default:f=gp}o=f.bind(null,r,o,n),f=void 0,!Pt||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(f=!0),c?f!==void 0?n.addEventListener(r,o,{capture:!0,passive:f}):n.addEventListener(r,o,!0):f!==void 0?n.addEventListener(r,o,{passive:f}):n.addEventListener(r,o,!1)}function np(n,r,o,c,f){var m=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var w=c.tag;if(w===3||w===4){var k=c.stateNode.containerInfo;if(k===f)break;if(w===4)for(w=c.return;w!==null;){var U=w.tag;if((U===3||U===4)&&w.stateNode.containerInfo===f)return;w=w.return}for(;k!==null;){if(w=_s(k),w===null)return;if(U=w.tag,U===5||U===6||U===26||U===27){c=m=w;continue e}k=k.parentNode}}c=c.return}qe(function(){var ee=m,fe=Q(o),ye=[];e:{var se=Lv.get(n);if(se!==void 0){var he=zs,Xe=n;switch(n){case"keypress":if(Jn(o)===0)break e;case"keydown":case"keyup":he=Xu;break;case"focusin":Xe="focus",he=lo;break;case"focusout":Xe="blur",he=lo;break;case"beforeblur":case"afterblur":he=lo;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":he=rc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":he=Fu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":he=v;break;case Rv:case Iv:case Dv:he=Hu;break;case Mv:he=N;break;case"scroll":case"scrollend":he=Ys;break;case"wheel":he=ce;break;case"copy":case"cut":case"paste":he=$u;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":he=Li;break;case"toggle":case"beforetoggle":he=It}var ft=(r&4)!==0,En=!ft&&(n==="scroll"||n==="scrollend"),$=ft?se!==null?se+"Capture":null:se;ft=[];for(var F=ee,J;F!==null;){var ge=F;if(J=ge.stateNode,ge=ge.tag,ge!==5&&ge!==26&&ge!==27||J===null||$===null||(ge=pt(F,$),ge!=null&&ft.push(Mc(F,ge,J))),En)break;F=F.return}0<ft.length&&(se=new he(se,Xe,null,o,fe),ye.push({event:se,listeners:ft}))}}if((r&7)===0){e:{if(se=n==="mouseover"||n==="pointerover",he=n==="mouseout"||n==="pointerout",se&&o!==P&&(Xe=o.relatedTarget||o.fromElement)&&(_s(Xe)||Xe[Ns]))break e;if((he||se)&&(se=fe.window===fe?fe:(se=fe.ownerDocument)?se.defaultView||se.parentWindow:window,he?(Xe=o.relatedTarget||o.toElement,he=ee,Xe=Xe?_s(Xe):null,Xe!==null&&(En=u(Xe),ft=Xe.tag,Xe!==En||ft!==5&&ft!==27&&ft!==6)&&(Xe=null)):(he=null,Xe=ee),he!==Xe)){if(ft=rc,ge="onMouseLeave",$="onMouseEnter",F="mouse",(n==="pointerout"||n==="pointerover")&&(ft=Li,ge="onPointerLeave",$="onPointerEnter",F="pointer"),En=he==null?se:On(he),J=Xe==null?se:On(Xe),se=new ft(ge,F+"leave",he,o,fe),se.target=En,se.relatedTarget=J,ge=null,_s(fe)===ee&&(ft=new ft($,F+"enter",Xe,o,fe),ft.target=J,ft.relatedTarget=En,ge=ft),En=ge,he&&Xe)t:{for(ft=Vk,$=he,F=Xe,J=0,ge=$;ge;ge=ft(ge))J++;ge=0;for(var at=F;at;at=ft(at))ge++;for(;0<J-ge;)$=ft($),J--;for(;0<ge-J;)F=ft(F),ge--;for(;J--;){if($===F||F!==null&&$===F.alternate){ft=$;break t}$=ft($),F=ft(F)}ft=null}else ft=null;he!==null&&sb(ye,se,he,ft,!1),Xe!==null&&En!==null&&sb(ye,En,Xe,ft,!0)}}e:{if(se=ee?On(ee):window,he=se.nodeName&&se.nodeName.toLowerCase(),he==="select"||he==="input"&&se.type==="file")var rn=wv;else if(vv(se))if(_v)rn=YT;else{rn=GT;var nt=WT}else he=se.nodeName,!he||he.toLowerCase()!=="input"||se.type!=="checkbox"&&se.type!=="radio"?ee&&Pe(ee.elementType)&&(rn=wv):rn=KT;if(rn&&(rn=rn(n,ee))){bv(ye,rn,o,fe);break e}nt&&nt(n,se,ee),n==="focusout"&&ee&&se.type==="number"&&ee.memoizedProps.value!=null&&Di(se,"number",se.value)}switch(nt=ee?On(ee):window,n){case"focusin":(vv(nt)||nt.contentEditable==="true")&&(tl=nt,Rf=ee,cc=null);break;case"focusout":cc=Rf=tl=null;break;case"mousedown":If=!0;break;case"contextmenu":case"mouseup":case"dragend":If=!1,Nv(ye,o,fe);break;case"selectionchange":if(XT)break;case"keydown":case"keyup":Nv(ye,o,fe)}var Ot;if(un)e:{switch(n){case"compositionstart":var Ht="onCompositionStart";break e;case"compositionend":Ht="onCompositionEnd";break e;case"compositionupdate":Ht="onCompositionUpdate";break e}Ht=void 0}else el?co(n,o)&&(Ht="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&(Ht="onCompositionStart");Ht&&(gi&&o.locale!=="ko"&&(el||Ht!=="onCompositionStart"?Ht==="onCompositionEnd"&&el&&(Ot=Hn()):(Zt=fe,Us="value"in Zt?Zt.value:Zt.textContent,el=!0)),nt=zh(ee,Ht),0<nt.length&&(Ht=new pi(Ht,n,null,o,fe),ye.push({event:Ht,listeners:nt}),Ot?Ht.data=Ot:(Ot=Zo(o),Ot!==null&&(Ht.data=Ot)))),(Ot=Pr?FT(n,o):qT(n,o))&&(Ht=zh(ee,"onBeforeInput"),0<Ht.length&&(nt=new pi("onBeforeInput","beforeinput",null,o,fe),ye.push({event:nt,listeners:Ht}),nt.data=Ot)),Mk(ye,n,ee,o,fe)}tb(ye,r)})}function Mc(n,r,o){return{instance:n,listener:r,currentTarget:o}}function zh(n,r){for(var o=r+"Capture",c=[];n!==null;){var f=n,m=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||m===null||(f=pt(n,o),f!=null&&c.unshift(Mc(n,f,m)),f=pt(n,r),f!=null&&c.push(Mc(n,f,m))),n.tag===3)return c;n=n.return}return[]}function Vk(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function sb(n,r,o,c,f){for(var m=r._reactName,w=[];o!==null&&o!==c;){var k=o,U=k.alternate,ee=k.stateNode;if(k=k.tag,U!==null&&U===c)break;k!==5&&k!==26&&k!==27||ee===null||(U=ee,f?(ee=pt(o,m),ee!=null&&w.unshift(Mc(o,ee,U))):f||(ee=pt(o,m),ee!=null&&w.push(Mc(o,ee,U)))),o=o.return}w.length!==0&&n.push({event:r,listeners:w})}var Uk=/\r\n?/g,Bk=/\u0000|\uFFFD/g;function rb(n){return(typeof n=="string"?n:""+n).replace(Uk,`
`).replace(Bk,"")}function ib(n,r){return r=rb(r),rb(n)===r}function xn(n,r,o,c,f,m){switch(o){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||C(n,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&C(n,""+c);break;case"className":le(n,"class",c);break;case"tabIndex":le(n,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":le(n,o,c);break;case"style":Re(n,c,m);break;case"data":if(r!=="object"){le(n,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||o!=="href")){n.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(o);break}c=kt(""+c),n.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){n.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(o==="formAction"?(r!=="input"&&xn(n,r,"name",f.name,f,null),xn(n,r,"formEncType",f.formEncType,f,null),xn(n,r,"formMethod",f.formMethod,f,null),xn(n,r,"formTarget",f.formTarget,f,null)):(xn(n,r,"encType",f.encType,f,null),xn(n,r,"method",f.method,f,null),xn(n,r,"target",f.target,f,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(o);break}c=kt(""+c),n.setAttribute(o,c);break;case"onClick":c!=null&&(n.onclick=dt);break;case"onScroll":c!=null&&Bt("scroll",n);break;case"onScrollEnd":c!=null&&Bt("scrollend",n);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"multiple":n.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":n.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){n.removeAttribute("xlink:href");break}o=kt(""+c),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,""+c):n.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,""):n.removeAttribute(o);break;case"capture":case"download":c===!0?n.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,c):n.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?n.setAttribute(o,c):n.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?n.removeAttribute(o):n.setAttribute(o,c);break;case"popover":Bt("beforetoggle",n),Bt("toggle",n),ae(n,"popover",c);break;case"xlinkActuate":Me(n,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Me(n,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Me(n,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Me(n,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Me(n,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Me(n,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Me(n,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Me(n,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Me(n,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":ae(n,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=ht.get(o)||o,ae(n,o,c))}}function sp(n,r,o,c,f,m){switch(o){case"style":Re(n,c,m);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"children":typeof c=="string"?C(n,c):(typeof c=="number"||typeof c=="bigint")&&C(n,""+c);break;case"onScroll":c!=null&&Bt("scroll",n);break;case"onScrollEnd":c!=null&&Bt("scrollend",n);break;case"onClick":c!=null&&(n.onclick=dt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Dr.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(f=o.endsWith("Capture"),r=o.slice(2,f?o.length-7:void 0),m=n[An]||null,m=m!=null?m[o]:null,typeof m=="function"&&n.removeEventListener(r,m,f),typeof c=="function")){typeof m!="function"&&m!==null&&(o in n?n[o]=null:n.hasAttribute(o)&&n.removeAttribute(o)),n.addEventListener(r,c,f);break e}o in n?n[o]=c:c===!0?n.setAttribute(o,""):ae(n,o,c)}}}function Ds(n,r,o){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Bt("error",n),Bt("load",n);var c=!1,f=!1,m;for(m in o)if(o.hasOwnProperty(m)){var w=o[m];if(w!=null)switch(m){case"src":c=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:xn(n,r,m,w,o,null)}}f&&xn(n,r,"srcSet",o.srcSet,o,null),c&&xn(n,r,"src",o.src,o,null);return;case"input":Bt("invalid",n);var k=m=w=f=null,U=null,ee=null;for(c in o)if(o.hasOwnProperty(c)){var fe=o[c];if(fe!=null)switch(c){case"name":f=fe;break;case"type":w=fe;break;case"checked":U=fe;break;case"defaultChecked":ee=fe;break;case"value":m=fe;break;case"defaultValue":k=fe;break;case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(i(137,r));break;default:xn(n,r,c,fe,o,null)}}fa(n,m,k,U,ee,w,f,!1);return;case"select":Bt("invalid",n),c=w=m=null;for(f in o)if(o.hasOwnProperty(f)&&(k=o[f],k!=null))switch(f){case"value":m=k;break;case"defaultValue":w=k;break;case"multiple":c=k;default:xn(n,r,f,k,o,null)}r=m,o=w,n.multiple=!!c,r!=null?Mr(n,!!c,r,!1):o!=null&&Mr(n,!!c,o,!0);return;case"textarea":Bt("invalid",n),m=f=c=null;for(w in o)if(o.hasOwnProperty(w)&&(k=o[w],k!=null))switch(w){case"value":c=k;break;case"defaultValue":f=k;break;case"children":m=k;break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(i(91));break;default:xn(n,r,w,k,o,null)}Lr(n,c,f,m);return;case"option":for(U in o)o.hasOwnProperty(U)&&(c=o[U],c!=null)&&(U==="selected"?n.selected=c&&typeof c!="function"&&typeof c!="symbol":xn(n,r,U,c,o,null));return;case"dialog":Bt("beforetoggle",n),Bt("toggle",n),Bt("cancel",n),Bt("close",n);break;case"iframe":case"object":Bt("load",n);break;case"video":case"audio":for(c=0;c<Dc.length;c++)Bt(Dc[c],n);break;case"image":Bt("error",n),Bt("load",n);break;case"details":Bt("toggle",n);break;case"embed":case"source":case"link":Bt("error",n),Bt("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ee in o)if(o.hasOwnProperty(ee)&&(c=o[ee],c!=null))switch(ee){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:xn(n,r,ee,c,o,null)}return;default:if(Pe(r)){for(fe in o)o.hasOwnProperty(fe)&&(c=o[fe],c!==void 0&&sp(n,r,fe,c,o,void 0));return}}for(k in o)o.hasOwnProperty(k)&&(c=o[k],c!=null&&xn(n,r,k,c,o,null))}function zk(n,r,o,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,m=null,w=null,k=null,U=null,ee=null,fe=null;for(he in o){var ye=o[he];if(o.hasOwnProperty(he)&&ye!=null)switch(he){case"checked":break;case"value":break;case"defaultValue":U=ye;default:c.hasOwnProperty(he)||xn(n,r,he,null,c,ye)}}for(var se in c){var he=c[se];if(ye=o[se],c.hasOwnProperty(se)&&(he!=null||ye!=null))switch(se){case"type":m=he;break;case"name":f=he;break;case"checked":ee=he;break;case"defaultChecked":fe=he;break;case"value":w=he;break;case"defaultValue":k=he;break;case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(i(137,r));break;default:he!==ye&&xn(n,r,se,he,c,ye)}}vr(n,w,k,U,ee,fe,m,f);return;case"select":he=w=k=se=null;for(m in o)if(U=o[m],o.hasOwnProperty(m)&&U!=null)switch(m){case"value":break;case"multiple":he=U;default:c.hasOwnProperty(m)||xn(n,r,m,null,c,U)}for(f in c)if(m=c[f],U=o[f],c.hasOwnProperty(f)&&(m!=null||U!=null))switch(f){case"value":se=m;break;case"defaultValue":k=m;break;case"multiple":w=m;default:m!==U&&xn(n,r,f,m,c,U)}r=k,o=w,c=he,se!=null?Mr(n,!!o,se,!1):!!c!=!!o&&(r!=null?Mr(n,!!o,r,!0):Mr(n,!!o,o?[]:"",!1));return;case"textarea":he=se=null;for(k in o)if(f=o[k],o.hasOwnProperty(k)&&f!=null&&!c.hasOwnProperty(k))switch(k){case"value":break;case"children":break;default:xn(n,r,k,null,c,f)}for(w in c)if(f=c[w],m=o[w],c.hasOwnProperty(w)&&(f!=null||m!=null))switch(w){case"value":se=f;break;case"defaultValue":he=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(i(91));break;default:f!==m&&xn(n,r,w,f,c,m)}ma(n,se,he);return;case"option":for(var Xe in o)se=o[Xe],o.hasOwnProperty(Xe)&&se!=null&&!c.hasOwnProperty(Xe)&&(Xe==="selected"?n.selected=!1:xn(n,r,Xe,null,c,se));for(U in c)se=c[U],he=o[U],c.hasOwnProperty(U)&&se!==he&&(se!=null||he!=null)&&(U==="selected"?n.selected=se&&typeof se!="function"&&typeof se!="symbol":xn(n,r,U,se,c,he));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ft in o)se=o[ft],o.hasOwnProperty(ft)&&se!=null&&!c.hasOwnProperty(ft)&&xn(n,r,ft,null,c,se);for(ee in c)if(se=c[ee],he=o[ee],c.hasOwnProperty(ee)&&se!==he&&(se!=null||he!=null))switch(ee){case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(i(137,r));break;default:xn(n,r,ee,se,c,he)}return;default:if(Pe(r)){for(var En in o)se=o[En],o.hasOwnProperty(En)&&se!==void 0&&!c.hasOwnProperty(En)&&sp(n,r,En,void 0,c,se);for(fe in c)se=c[fe],he=o[fe],!c.hasOwnProperty(fe)||se===he||se===void 0&&he===void 0||sp(n,r,fe,se,c,he);return}}for(var $ in o)se=o[$],o.hasOwnProperty($)&&se!=null&&!c.hasOwnProperty($)&&xn(n,r,$,null,c,se);for(ye in c)se=c[ye],he=o[ye],!c.hasOwnProperty(ye)||se===he||se==null&&he==null||xn(n,r,ye,se,c,he)}function ab(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Fk(){if(typeof performance.getEntriesByType=="function"){for(var n=0,r=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var f=o[c],m=f.transferSize,w=f.initiatorType,k=f.duration;if(m&&k&&ab(w)){for(w=0,k=f.responseEnd,c+=1;c<o.length;c++){var U=o[c],ee=U.startTime;if(ee>k)break;var fe=U.transferSize,ye=U.initiatorType;fe&&ab(ye)&&(U=U.responseEnd,w+=fe*(U<k?1:(k-ee)/(U-ee)))}if(--c,r+=8*(m+w)/(f.duration/1e3),n++,10<n)break}}if(0<n)return r/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var rp=null,ip=null;function Fh(n){return n.nodeType===9?n:n.ownerDocument}function ob(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function lb(n,r){if(n===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&r==="foreignObject"?0:n}function ap(n,r){return n==="textarea"||n==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var op=null;function qk(){var n=window.event;return n&&n.type==="popstate"?n===op?!1:(op=n,!0):(op=null,!1)}var cb=typeof setTimeout=="function"?setTimeout:void 0,Hk=typeof clearTimeout=="function"?clearTimeout:void 0,ub=typeof Promise=="function"?Promise:void 0,$k=typeof queueMicrotask=="function"?queueMicrotask:typeof ub<"u"?function(n){return ub.resolve(null).then(n).catch(Wk)}:cb;function Wk(n){setTimeout(function(){throw n})}function Ia(n){return n==="head"}function hb(n,r){var o=r,c=0;do{var f=o.nextSibling;if(n.removeChild(o),f&&f.nodeType===8)if(o=f.data,o==="/$"||o==="/&"){if(c===0){n.removeChild(f),Cl(r);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")Lc(n.ownerDocument.documentElement);else if(o==="head"){o=n.ownerDocument.head,Lc(o);for(var m=o.firstChild;m;){var w=m.nextSibling,k=m.nodeName;m[qn]||k==="SCRIPT"||k==="STYLE"||k==="LINK"&&m.rel.toLowerCase()==="stylesheet"||o.removeChild(m),m=w}}else o==="body"&&Lc(n.ownerDocument.body);o=f}while(o);Cl(r)}function db(n,r){var o=n;n=0;do{var c=o.nextSibling;if(o.nodeType===1?r?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(r?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(n===0)break;n--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||n++;o=c}while(o)}function lp(n){var r=n.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var o=r;switch(r=r.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":lp(o),Ks(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}n.removeChild(o)}}function Gk(n,r,o,c){for(;n.nodeType===1;){var f=o;if(n.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(c){if(!n[qn])switch(r){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(m=n.getAttribute("rel"),m==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(m!==f.rel||n.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||n.getAttribute("title")!==(f.title==null?null:f.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(m=n.getAttribute("src"),(m!==(f.src==null?null:f.src)||n.getAttribute("type")!==(f.type==null?null:f.type)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&m&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(r==="input"&&n.type==="hidden"){var m=f.name==null?null:""+f.name;if(f.type==="hidden"&&n.getAttribute("name")===m)return n}else return n;if(n=Hr(n.nextSibling),n===null)break}return null}function Kk(n,r,o){if(r==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=Hr(n.nextSibling),n===null))return null;return n}function fb(n,r){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!r||(n=Hr(n.nextSibling),n===null))return null;return n}function cp(n){return n.data==="$?"||n.data==="$~"}function up(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function Yk(n,r){var o=n.ownerDocument;if(n.data==="$~")n._reactRetry=r;else if(n.data!=="$?"||o.readyState!=="loading")r();else{var c=function(){r(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),n._reactRetry=c}}function Hr(n){for(;n!=null;n=n.nextSibling){var r=n.nodeType;if(r===1||r===3)break;if(r===8){if(r=n.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return n}var hp=null;function mb(n){n=n.nextSibling;for(var r=0;n;){if(n.nodeType===8){var o=n.data;if(o==="/$"||o==="/&"){if(r===0)return Hr(n.nextSibling);r--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||r++}n=n.nextSibling}return null}function pb(n){n=n.previousSibling;for(var r=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(r===0)return n;r--}else o!=="/$"&&o!=="/&"||r++}n=n.previousSibling}return null}function gb(n,r,o){switch(r=Fh(o),n){case"html":if(n=r.documentElement,!n)throw Error(i(452));return n;case"head":if(n=r.head,!n)throw Error(i(453));return n;case"body":if(n=r.body,!n)throw Error(i(454));return n;default:throw Error(i(451))}}function Lc(n){for(var r=n.attributes;r.length;)n.removeAttributeNode(r[0]);Ks(n)}var $r=new Map,yb=new Set;function qh(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Qi=_e.d;_e.d={f:Qk,r:Xk,D:Jk,C:Zk,L:eS,m:tS,X:sS,S:nS,M:rS};function Qk(){var n=Qi.f(),r=Mh();return n||r}function Xk(n){var r=kn(n);r!==null&&r.tag===5&&r.type==="form"?M0(r):Qi.r(n)}var kl=typeof document>"u"?null:document;function vb(n,r,o){var c=kl;if(c&&typeof r=="string"&&r){var f=Yn(r);f='link[rel="'+n+'"][href="'+f+'"]',typeof o=="string"&&(f+='[crossorigin="'+o+'"]'),yb.has(f)||(yb.add(f),n={rel:n,crossOrigin:o,href:r},c.querySelector(f)===null&&(r=c.createElement("link"),Ds(r,"link",n),zt(r),c.head.appendChild(r)))}}function Jk(n){Qi.D(n),vb("dns-prefetch",n,null)}function Zk(n,r){Qi.C(n,r),vb("preconnect",n,r)}function eS(n,r,o){Qi.L(n,r,o);var c=kl;if(c&&n&&r){var f='link[rel="preload"][as="'+Yn(r)+'"]';r==="image"&&o&&o.imageSrcSet?(f+='[imagesrcset="'+Yn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(f+='[imagesizes="'+Yn(o.imageSizes)+'"]')):f+='[href="'+Yn(n)+'"]';var m=f;switch(r){case"style":m=Sl(n);break;case"script":m=jl(n)}$r.has(m)||(n=E({rel:"preload",href:r==="image"&&o&&o.imageSrcSet?void 0:n,as:r},o),$r.set(m,n),c.querySelector(f)!==null||r==="style"&&c.querySelector(Oc(m))||r==="script"&&c.querySelector(Pc(m))||(r=c.createElement("link"),Ds(r,"link",n),zt(r),c.head.appendChild(r)))}}function tS(n,r){Qi.m(n,r);var o=kl;if(o&&n){var c=r&&typeof r.as=="string"?r.as:"script",f='link[rel="modulepreload"][as="'+Yn(c)+'"][href="'+Yn(n)+'"]',m=f;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=jl(n)}if(!$r.has(m)&&(n=E({rel:"modulepreload",href:n},r),$r.set(m,n),o.querySelector(f)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Pc(m)))return}c=o.createElement("link"),Ds(c,"link",n),zt(c),o.head.appendChild(c)}}}function nS(n,r,o){Qi.S(n,r,o);var c=kl;if(c&&n){var f=as(c).hoistableStyles,m=Sl(n);r=r||"default";var w=f.get(m);if(!w){var k={loading:0,preload:null};if(w=c.querySelector(Oc(m)))k.loading=5;else{n=E({rel:"stylesheet",href:n,"data-precedence":r},o),(o=$r.get(m))&&dp(n,o);var U=w=c.createElement("link");zt(U),Ds(U,"link",n),U._p=new Promise(function(ee,fe){U.onload=ee,U.onerror=fe}),U.addEventListener("load",function(){k.loading|=1}),U.addEventListener("error",function(){k.loading|=2}),k.loading|=4,Hh(w,r,c)}w={type:"stylesheet",instance:w,count:1,state:k},f.set(m,w)}}}function sS(n,r){Qi.X(n,r);var o=kl;if(o&&n){var c=as(o).hoistableScripts,f=jl(n),m=c.get(f);m||(m=o.querySelector(Pc(f)),m||(n=E({src:n,async:!0},r),(r=$r.get(f))&&fp(n,r),m=o.createElement("script"),zt(m),Ds(m,"link",n),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function rS(n,r){Qi.M(n,r);var o=kl;if(o&&n){var c=as(o).hoistableScripts,f=jl(n),m=c.get(f);m||(m=o.querySelector(Pc(f)),m||(n=E({src:n,async:!0,type:"module"},r),(r=$r.get(f))&&fp(n,r),m=o.createElement("script"),zt(m),Ds(m,"link",n),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function bb(n,r,o,c){var f=(f=Ee.current)?qh(f):null;if(!f)throw Error(i(446));switch(n){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(r=Sl(o.href),o=as(f).hoistableStyles,c=o.get(r),c||(c={type:"style",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){n=Sl(o.href);var m=as(f).hoistableStyles,w=m.get(n);if(w||(f=f.ownerDocument||f,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(n,w),(m=f.querySelector(Oc(n)))&&!m._p&&(w.instance=m,w.state.loading=5),$r.has(n)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},$r.set(n,o),m||iS(f,n,o,w.state))),r&&c===null)throw Error(i(528,""));return w}if(r&&c!==null)throw Error(i(529,""));return null;case"script":return r=o.async,o=o.src,typeof o=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=jl(o),o=as(f).hoistableScripts,c=o.get(r),c||(c={type:"script",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,n))}}function Sl(n){return'href="'+Yn(n)+'"'}function Oc(n){return'link[rel="stylesheet"]['+n+"]"}function wb(n){return E({},n,{"data-precedence":n.precedence,precedence:null})}function iS(n,r,o,c){n.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=n.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),Ds(r,"link",o),zt(r),n.head.appendChild(r))}function jl(n){return'[src="'+Yn(n)+'"]'}function Pc(n){return"script[async]"+n}function _b(n,r,o){if(r.count++,r.instance===null)switch(r.type){case"style":var c=n.querySelector('style[data-href~="'+Yn(o.href)+'"]');if(c)return r.instance=c,zt(c),c;var f=E({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(n.ownerDocument||n).createElement("style"),zt(c),Ds(c,"style",f),Hh(c,o.precedence,n),r.instance=c;case"stylesheet":f=Sl(o.href);var m=n.querySelector(Oc(f));if(m)return r.state.loading|=4,r.instance=m,zt(m),m;c=wb(o),(f=$r.get(f))&&dp(c,f),m=(n.ownerDocument||n).createElement("link"),zt(m);var w=m;return w._p=new Promise(function(k,U){w.onload=k,w.onerror=U}),Ds(m,"link",c),r.state.loading|=4,Hh(m,o.precedence,n),r.instance=m;case"script":return m=jl(o.src),(f=n.querySelector(Pc(m)))?(r.instance=f,zt(f),f):(c=o,(f=$r.get(m))&&(c=E({},o),fp(c,f)),n=n.ownerDocument||n,f=n.createElement("script"),zt(f),Ds(f,"link",c),n.head.appendChild(f),r.instance=f);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,Hh(c,o.precedence,n));return r.instance}function Hh(n,r,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=c.length?c[c.length-1]:null,m=f,w=0;w<c.length;w++){var k=c[w];if(k.dataset.precedence===r)m=k;else if(m!==f)break}m?m.parentNode.insertBefore(n,m.nextSibling):(r=o.nodeType===9?o.head:o,r.insertBefore(n,r.firstChild))}function dp(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.title==null&&(n.title=r.title)}function fp(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.integrity==null&&(n.integrity=r.integrity)}var $h=null;function xb(n,r,o){if($h===null){var c=new Map,f=$h=new Map;f.set(o,c)}else f=$h,c=f.get(o),c||(c=new Map,f.set(o,c));if(c.has(n))return c;for(c.set(n,null),o=o.getElementsByTagName(n),f=0;f<o.length;f++){var m=o[f];if(!(m[qn]||m[Jt]||n==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var w=m.getAttribute(r)||"";w=n+w;var k=c.get(w);k?k.push(m):c.set(w,[m])}}return c}function Eb(n,r,o){n=n.ownerDocument||n,n.head.insertBefore(o,r==="title"?n.querySelector("head > title"):null)}function aS(n,r,o){if(o===1||r.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;return r.rel==="stylesheet"?(n=r.disabled,typeof r.precedence=="string"&&n==null):!0;case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function Tb(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function oS(n,r,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var f=Sl(c.href),m=r.querySelector(Oc(f));if(m){r=m._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(n.count++,n=Wh.bind(n),r.then(n,n)),o.state.loading|=4,o.instance=m,zt(m);return}m=r.ownerDocument||r,c=wb(c),(f=$r.get(f))&&dp(c,f),m=m.createElement("link"),zt(m);var w=m;w._p=new Promise(function(k,U){w.onload=k,w.onerror=U}),Ds(m,"link",c),o.instance=m}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(o,r),(r=o.state.preload)&&(o.state.loading&3)===0&&(n.count++,o=Wh.bind(n),r.addEventListener("load",o),r.addEventListener("error",o))}}var mp=0;function lS(n,r){return n.stylesheets&&n.count===0&&Kh(n,n.stylesheets),0<n.count||0<n.imgCount?function(o){var c=setTimeout(function(){if(n.stylesheets&&Kh(n,n.stylesheets),n.unsuspend){var m=n.unsuspend;n.unsuspend=null,m()}},6e4+r);0<n.imgBytes&&mp===0&&(mp=62500*Fk());var f=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&Kh(n,n.stylesheets),n.unsuspend)){var m=n.unsuspend;n.unsuspend=null,m()}},(n.imgBytes>mp?50:800)+r);return n.unsuspend=o,function(){n.unsuspend=null,clearTimeout(c),clearTimeout(f)}}:null}function Wh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Kh(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Gh=null;function Kh(n,r){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Gh=new Map,r.forEach(cS,n),Gh=null,Wh.call(n))}function cS(n,r){if(!(r.state.loading&4)){var o=Gh.get(n);if(o)var c=o.get(null);else{o=new Map,Gh.set(n,o);for(var f=n.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<f.length;m++){var w=f[m];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(o.set(w.dataset.precedence,w),c=w)}c&&o.set(null,c)}f=r.instance,w=f.getAttribute("data-precedence"),m=o.get(w)||c,m===c&&o.set(null,f),o.set(w,f),this.count++,c=Wh.bind(this),f.addEventListener("load",c),f.addEventListener("error",c),m?m.parentNode.insertBefore(f,m.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(f,n.firstChild)),r.state.loading|=4}}var Vc={$$typeof:Y,Provider:null,Consumer:null,_currentValue:Ie,_currentValue2:Ie,_threadCount:0};function uS(n,r,o,c,f,m,w,k,U){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ae(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ae(0),this.hiddenUpdates=Ae(null),this.identifierPrefix=c,this.onUncaughtError=f,this.onCaughtError=m,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=U,this.incompleteTransitions=new Map}function kb(n,r,o,c,f,m,w,k,U,ee,fe,ye){return n=new uS(n,r,o,w,U,ee,fe,ye,k),r=1,m===!0&&(r|=24),m=wr(3,null,null,r),n.current=m,m.stateNode=n,r=Gf(),r.refCount++,n.pooledCache=r,r.refCount++,m.memoizedState={element:c,isDehydrated:o,cache:r},Xf(m),n}function Sb(n){return n?(n=rl,n):rl}function jb(n,r,o,c,f,m){f=Sb(f),c.context===null?c.context=f:c.pendingContext=f,c=_a(r),c.payload={element:o},m=m===void 0?null:m,m!==null&&(c.callback=m),o=xa(n,c,r),o!==null&&(ur(o,n,r),gc(o,n,r))}function Cb(n,r){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<r?o:r}}function pp(n,r){Cb(n,r),(n=n.alternate)&&Cb(n,r)}function Nb(n){if(n.tag===13||n.tag===31){var r=fo(n,67108864);r!==null&&ur(r,n,67108864),pp(n,67108864)}}function Ab(n){if(n.tag===13||n.tag===31){var r=kr();r=dn(r);var o=fo(n,r);o!==null&&ur(o,n,r),pp(n,r)}}var Yh=!0;function hS(n,r,o,c){var f=te.T;te.T=null;var m=_e.p;try{_e.p=2,gp(n,r,o,c)}finally{_e.p=m,te.T=f}}function dS(n,r,o,c){var f=te.T;te.T=null;var m=_e.p;try{_e.p=8,gp(n,r,o,c)}finally{_e.p=m,te.T=f}}function gp(n,r,o,c){if(Yh){var f=yp(c);if(f===null)np(n,r,c,Qh,o),Ib(n,c);else if(mS(f,n,r,o,c))c.stopPropagation();else if(Ib(n,c),r&4&&-1<fS.indexOf(n)){for(;f!==null;){var m=kn(f);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var w=Fn(m.pendingLanes);if(w!==0){var k=m;for(k.pendingLanes|=2,k.entangledLanes|=2;w;){var U=1<<31-Fe(w);k.entanglements[1]|=U,w&=~U}wi(m),(hn&6)===0&&(Ih=vt()+500,Ic(0))}}break;case 31:case 13:k=fo(m,2),k!==null&&ur(k,m,2),Mh(),pp(m,2)}if(m=yp(c),m===null&&np(n,r,c,Qh,o),m===f)break;f=m}f!==null&&c.stopPropagation()}else np(n,r,c,null,o)}}function yp(n){return n=Q(n),vp(n)}var Qh=null;function vp(n){if(Qh=null,n=_s(n),n!==null){var r=u(n);if(r===null)n=null;else{var o=r.tag;if(o===13){if(n=h(r),n!==null)return n;n=null}else if(o===31){if(n=p(r),n!==null)return n;n=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null)}}return Qh=n,null}function Rb(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(nn()){case js:return 2;case rs:return 8;case Xt:case ne:return 32;case Ne:return 268435456;default:return 32}default:return 32}}var bp=!1,Da=null,Ma=null,La=null,Uc=new Map,Bc=new Map,Oa=[],fS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ib(n,r){switch(n){case"focusin":case"focusout":Da=null;break;case"dragenter":case"dragleave":Ma=null;break;case"mouseover":case"mouseout":La=null;break;case"pointerover":case"pointerout":Uc.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Bc.delete(r.pointerId)}}function zc(n,r,o,c,f,m){return n===null||n.nativeEvent!==m?(n={blockedOn:r,domEventName:o,eventSystemFlags:c,nativeEvent:m,targetContainers:[f]},r!==null&&(r=kn(r),r!==null&&Nb(r)),n):(n.eventSystemFlags|=c,r=n.targetContainers,f!==null&&r.indexOf(f)===-1&&r.push(f),n)}function mS(n,r,o,c,f){switch(r){case"focusin":return Da=zc(Da,n,r,o,c,f),!0;case"dragenter":return Ma=zc(Ma,n,r,o,c,f),!0;case"mouseover":return La=zc(La,n,r,o,c,f),!0;case"pointerover":var m=f.pointerId;return Uc.set(m,zc(Uc.get(m)||null,n,r,o,c,f)),!0;case"gotpointercapture":return m=f.pointerId,Bc.set(m,zc(Bc.get(m)||null,n,r,o,c,f)),!0}return!1}function Db(n){var r=_s(n.target);if(r!==null){var o=u(r);if(o!==null){if(r=o.tag,r===13){if(r=h(o),r!==null){n.blockedOn=r,is(n.priority,function(){Ab(o)});return}}else if(r===31){if(r=p(o),r!==null){n.blockedOn=r,is(n.priority,function(){Ab(o)});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Xh(n){if(n.blockedOn!==null)return!1;for(var r=n.targetContainers;0<r.length;){var o=yp(n.nativeEvent);if(o===null){o=n.nativeEvent;var c=new o.constructor(o.type,o);P=c,o.target.dispatchEvent(c),P=null}else return r=kn(o),r!==null&&Nb(r),n.blockedOn=o,!1;r.shift()}return!0}function Mb(n,r,o){Xh(n)&&o.delete(r)}function pS(){bp=!1,Da!==null&&Xh(Da)&&(Da=null),Ma!==null&&Xh(Ma)&&(Ma=null),La!==null&&Xh(La)&&(La=null),Uc.forEach(Mb),Bc.forEach(Mb)}function Jh(n,r){n.blockedOn===r&&(n.blockedOn=null,bp||(bp=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,pS)))}var Zh=null;function Lb(n){Zh!==n&&(Zh=n,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){Zh===n&&(Zh=null);for(var r=0;r<n.length;r+=3){var o=n[r],c=n[r+1],f=n[r+2];if(typeof c!="function"){if(vp(c||o)===null)continue;break}var m=kn(o);m!==null&&(n.splice(r,3),r-=3,ym(m,{pending:!0,data:f,method:o.method,action:c},c,f))}}))}function Cl(n){function r(U){return Jh(U,n)}Da!==null&&Jh(Da,n),Ma!==null&&Jh(Ma,n),La!==null&&Jh(La,n),Uc.forEach(r),Bc.forEach(r);for(var o=0;o<Oa.length;o++){var c=Oa[o];c.blockedOn===n&&(c.blockedOn=null)}for(;0<Oa.length&&(o=Oa[0],o.blockedOn===null);)Db(o),o.blockedOn===null&&Oa.shift();if(o=(n.ownerDocument||n).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var f=o[c],m=o[c+1],w=f[An]||null;if(typeof m=="function")w||Lb(o);else if(w){var k=null;if(m&&m.hasAttribute("formAction")){if(f=m,w=m[An]||null)k=w.formAction;else if(vp(f)!==null)continue}else k=w.action;typeof k=="function"?o[c+1]=k:(o.splice(c,3),c-=3),Lb(o)}}}function Ob(){function n(m){m.canIntercept&&m.info==="react-transition"&&m.intercept({handler:function(){return new Promise(function(w){return f=w})},focusReset:"manual",scroll:"manual"})}function r(){f!==null&&(f(),f=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var m=navigation.currentEntry;m&&m.url!=null&&navigation.navigate(m.url,{state:m.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,f=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),f!==null&&(f(),f=null)}}}function wp(n){this._internalRoot=n}ed.prototype.render=wp.prototype.render=function(n){var r=this._internalRoot;if(r===null)throw Error(i(409));var o=r.current,c=kr();jb(o,c,n,r,null,null)},ed.prototype.unmount=wp.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var r=n.containerInfo;jb(n.current,2,null,n,null,null),Mh(),r[Ns]=null}};function ed(n){this._internalRoot=n}ed.prototype.unstable_scheduleHydration=function(n){if(n){var r=Cs();n={blockedOn:null,target:n,priority:r};for(var o=0;o<Oa.length&&r!==0&&r<Oa[o].priority;o++);Oa.splice(o,0,n),o===0&&Db(n)}};var Pb=e.version;if(Pb!=="19.2.4")throw Error(i(527,Pb,"19.2.4"));_e.findDOMNode=function(n){var r=n._reactInternals;if(r===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=y(r),n=n!==null?b(n):null,n=n===null?null:n.stateNode,n};var gS={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:te,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var td=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!td.isDisabled&&td.supportsFiber)try{it=td.inject(gS),$e=td}catch{}}return qc.createRoot=function(n,r){if(!l(n))throw Error(i(299));var o=!1,c="",f=H0,m=$0,w=W0;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(f=r.onUncaughtError),r.onCaughtError!==void 0&&(m=r.onCaughtError),r.onRecoverableError!==void 0&&(w=r.onRecoverableError)),r=kb(n,1,!1,null,null,o,c,null,f,m,w,Ob),n[Ns]=r.current,tp(n),new wp(r)},qc.hydrateRoot=function(n,r,o){if(!l(n))throw Error(i(299));var c=!1,f="",m=H0,w=$0,k=W0,U=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(m=o.onUncaughtError),o.onCaughtError!==void 0&&(w=o.onCaughtError),o.onRecoverableError!==void 0&&(k=o.onRecoverableError),o.formState!==void 0&&(U=o.formState)),r=kb(n,1,!0,r,o??null,c,f,U,m,w,k,Ob),r.context=Sb(null),o=r.current,c=kr(),c=dn(c),f=_a(c),f.callback=null,xa(o,f,c),o=c,r.current.lanes=o,Ge(r,o),wi(r),n[Ns]=r.current,tp(n),new ed(r)},qc.version="19.2.4",qc}var Gb;function SS(){if(Gb)return Ep.exports;Gb=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Ep.exports=kS(),Ep.exports}var jS=SS();const CS="modulepreload",NS=function(s){return"/login/"+s},Kb={},Gs=function(e,t,i){let l=Promise.resolve();if(t&&t.length>0){let g=function(y){return Promise.all(y.map(b=>Promise.resolve(b).then(E=>({status:"fulfilled",value:E}),E=>({status:"rejected",reason:E}))))};document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),p=h?.nonce||h?.getAttribute("nonce");l=g(t.map(y=>{if(y=NS(y),y in Kb)return;Kb[y]=!0;const b=y.endsWith(".css"),E=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${E}`))return;const T=document.createElement("link");if(T.rel=b?"stylesheet":CS,b||(T.as="script"),T.crossOrigin="",T.href=y,p&&T.setAttribute("nonce",p),document.head.appendChild(T),b)return new Promise((O,H)=>{T.addEventListener("load",O),T.addEventListener("error",()=>H(new Error(`Unable to preload CSS for ${y}`)))})}))}function u(h){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=h,window.dispatchEvent(p),!p.defaultPrevented)throw h}return l.then(h=>{for(const p of h||[])p.status==="rejected"&&u(p.reason);return e().catch(u)})};var Yb="popstate";function AS(s={}){function e(i,l){let{pathname:u,search:h,hash:p}=i.location;return hg("",{pathname:u,search:h,hash:p},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function t(i,l){return typeof l=="string"?l:cu(l)}return IS(e,t,null,s)}function Gn(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function Kr(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function RS(){return Math.random().toString(36).substring(2,10)}function Qb(s,e){return{usr:s.state,key:s.key,idx:e}}function hg(s,e,t=null,i){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?Yl(e):e,state:t,key:e&&e.key||i||RS()}}function cu({pathname:s="/",search:e="",hash:t=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(s+=t.charAt(0)==="#"?t:"#"+t),s}function Yl(s){let e={};if(s){let t=s.indexOf("#");t>=0&&(e.hash=s.substring(t),s=s.substring(0,t));let i=s.indexOf("?");i>=0&&(e.search=s.substring(i),s=s.substring(0,i)),s&&(e.pathname=s)}return e}function IS(s,e,t,i={}){let{window:l=document.defaultView,v5Compat:u=!1}=i,h=l.history,p="POP",g=null,y=b();y==null&&(y=0,h.replaceState({...h.state,idx:y},""));function b(){return(h.state||{idx:null}).idx}function E(){p="POP";let B=b(),X=B==null?null:B-y;y=B,g&&g({action:p,location:q.location,delta:X})}function T(B,X){p="PUSH";let W=hg(q.location,B,X);y=b()+1;let Y=Qb(W,y),de=q.createHref(W);try{h.pushState(Y,"",de)}catch(xe){if(xe instanceof DOMException&&xe.name==="DataCloneError")throw xe;l.location.assign(de)}u&&g&&g({action:p,location:q.location,delta:1})}function O(B,X){p="REPLACE";let W=hg(q.location,B,X);y=b();let Y=Qb(W,y),de=q.createHref(W);h.replaceState(Y,"",de),u&&g&&g({action:p,location:q.location,delta:0})}function H(B){return DS(B)}let q={get action(){return p},get location(){return s(l,h)},listen(B){if(g)throw new Error("A history only accepts one active listener");return l.addEventListener(Yb,E),g=B,()=>{l.removeEventListener(Yb,E),g=null}},createHref(B){return e(l,B)},createURL:H,encodeLocation(B){let X=H(B);return{pathname:X.pathname,search:X.search,hash:X.hash}},push:T,replace:O,go(B){return h.go(B)}};return q}function DS(s,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Gn(t,"No window.location.(origin|href) available to create URL");let i=typeof s=="string"?s:cu(s);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function a_(s,e,t="/"){return MS(s,e,t,!1)}function MS(s,e,t,i){let l=typeof e=="string"?Yl(e):e,u=ra(l.pathname||"/",t);if(u==null)return null;let h=o_(s);LS(h);let p=null;for(let g=0;p==null&&g<h.length;++g){let y=WS(u);p=HS(h[g],y,i)}return p}function o_(s,e=[],t=[],i="",l=!1){let u=(h,p,g=l,y)=>{let b={relativePath:y===void 0?h.path||"":y,caseSensitive:h.caseSensitive===!0,childrenIndex:p,route:h};if(b.relativePath.startsWith("/")){if(!b.relativePath.startsWith(i)&&g)return;Gn(b.relativePath.startsWith(i),`Absolute route path "${b.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),b.relativePath=b.relativePath.slice(i.length)}let E=ea([i,b.relativePath]),T=t.concat(b);h.children&&h.children.length>0&&(Gn(h.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${E}".`),o_(h.children,e,T,E,g)),!(h.path==null&&!h.index)&&e.push({path:E,score:FS(E,h.index),routesMeta:T})};return s.forEach((h,p)=>{if(h.path===""||!h.path?.includes("?"))u(h,p);else for(let g of l_(h.path))u(h,p,!0,g)}),e}function l_(s){let e=s.split("/");if(e.length===0)return[];let[t,...i]=e,l=t.endsWith("?"),u=t.replace(/\?$/,"");if(i.length===0)return l?[u,""]:[u];let h=l_(i.join("/")),p=[];return p.push(...h.map(g=>g===""?u:[u,g].join("/"))),l&&p.push(...h),p.map(g=>s.startsWith("/")&&g===""?"/":g)}function LS(s){s.sort((e,t)=>e.score!==t.score?t.score-e.score:qS(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var OS=/^:[\w-]+$/,PS=3,VS=2,US=1,BS=10,zS=-2,Xb=s=>s==="*";function FS(s,e){let t=s.split("/"),i=t.length;return t.some(Xb)&&(i+=zS),e&&(i+=VS),t.filter(l=>!Xb(l)).reduce((l,u)=>l+(OS.test(u)?PS:u===""?US:BS),i)}function qS(s,e){return s.length===e.length&&s.slice(0,-1).every((i,l)=>i===e[l])?s[s.length-1]-e[e.length-1]:0}function HS(s,e,t=!1){let{routesMeta:i}=s,l={},u="/",h=[];for(let p=0;p<i.length;++p){let g=i[p],y=p===i.length-1,b=u==="/"?e:e.slice(u.length)||"/",E=Nd({path:g.relativePath,caseSensitive:g.caseSensitive,end:y},b),T=g.route;if(!E&&y&&t&&!i[i.length-1].route.index&&(E=Nd({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},b)),!E)return null;Object.assign(l,E.params),h.push({params:l,pathname:ea([u,E.pathname]),pathnameBase:QS(ea([u,E.pathnameBase])),route:T}),E.pathnameBase!=="/"&&(u=ea([u,E.pathnameBase]))}return h}function Nd(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[t,i]=$S(s.path,s.caseSensitive,s.end),l=e.match(t);if(!l)return null;let u=l[0],h=u.replace(/(.)\/+$/,"$1"),p=l.slice(1);return{params:i.reduce((y,{paramName:b,isOptional:E},T)=>{if(b==="*"){let H=p[T]||"";h=u.slice(0,u.length-H.length).replace(/(.)\/+$/,"$1")}const O=p[T];return E&&!O?y[b]=void 0:y[b]=(O||"").replace(/%2F/g,"/"),y},{}),pathname:u,pathnameBase:h,pattern:s}}function $S(s,e=!1,t=!0){Kr(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let i=[],l="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(h,p,g)=>(i.push({paramName:p,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(i.push({paramName:"*"}),l+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?l+="\\/*$":s!==""&&s!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,e?void 0:"i"),i]}function WS(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Kr(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function ra(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=s.charAt(t);return i&&i!=="/"?null:s.slice(t)||"/"}var GS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function KS(s,e="/"){let{pathname:t,search:i="",hash:l=""}=typeof s=="string"?Yl(s):s,u;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?u=Jb(t.substring(1),"/"):u=Jb(t,e)):u=e,{pathname:u,search:XS(i),hash:JS(l)}}function Jb(s,e){let t=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(l=>{l===".."?t.length>1&&t.pop():l!=="."&&t.push(l)}),t.length>1?t.join("/"):"/"}function jp(s,e,t,i){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function YS(s){return s.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Gg(s){let e=YS(s);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function Kg(s,e,t,i=!1){let l;typeof s=="string"?l=Yl(s):(l={...s},Gn(!l.pathname||!l.pathname.includes("?"),jp("?","pathname","search",l)),Gn(!l.pathname||!l.pathname.includes("#"),jp("#","pathname","hash",l)),Gn(!l.search||!l.search.includes("#"),jp("#","search","hash",l)));let u=s===""||l.pathname==="",h=u?"/":l.pathname,p;if(h==null)p=t;else{let E=e.length-1;if(!i&&h.startsWith("..")){let T=h.split("/");for(;T[0]==="..";)T.shift(),E-=1;l.pathname=T.join("/")}p=E>=0?e[E]:"/"}let g=KS(l,p),y=h&&h!=="/"&&h.endsWith("/"),b=(u||h===".")&&t.endsWith("/");return!g.pathname.endsWith("/")&&(y||b)&&(g.pathname+="/"),g}var ea=s=>s.join("/").replace(/\/\/+/g,"/"),QS=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),XS=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,JS=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s,ZS=class{constructor(s,e,t,i=!1){this.status=s,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function ej(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}function tj(s){return s.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var c_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function u_(s,e){let t=s;if(typeof t!="string"||!GS.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,l=!1;if(c_)try{let u=new URL(window.location.href),h=t.startsWith("//")?new URL(u.protocol+t):new URL(t),p=ra(h.pathname,e);h.origin===u.origin&&p!=null?t=p+h.search+h.hash:l=!0}catch{Kr(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:l,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var h_=["POST","PUT","PATCH","DELETE"];new Set(h_);var nj=["GET",...h_];new Set(nj);var Ql=_.createContext(null);Ql.displayName="DataRouter";var Xd=_.createContext(null);Xd.displayName="DataRouterState";var sj=_.createContext(!1),d_=_.createContext({isTransitioning:!1});d_.displayName="ViewTransition";var rj=_.createContext(new Map);rj.displayName="Fetchers";var ij=_.createContext(null);ij.displayName="Await";var Nr=_.createContext(null);Nr.displayName="Navigation";var Tu=_.createContext(null);Tu.displayName="Location";var ci=_.createContext({outlet:null,matches:[],isDataRoute:!1});ci.displayName="Route";var Yg=_.createContext(null);Yg.displayName="RouteError";var f_="REACT_ROUTER_ERROR",aj="REDIRECT",oj="ROUTE_ERROR_RESPONSE";function lj(s){if(s.startsWith(`${f_}:${aj}:{`))try{let e=JSON.parse(s.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function cj(s){if(s.startsWith(`${f_}:${oj}:{`))try{let e=JSON.parse(s.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new ZS(e.status,e.statusText,e.data)}catch{}}function uj(s,{relative:e}={}){Gn(Xl(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=_.useContext(Nr),{hash:l,pathname:u,search:h}=ku(s,{relative:e}),p=u;return t!=="/"&&(p=u==="/"?t:ea([t,u])),i.createHref({pathname:p,search:h,hash:l})}function Xl(){return _.useContext(Tu)!=null}function Ii(){return Gn(Xl(),"useLocation() may be used only in the context of a <Router> component."),_.useContext(Tu).location}var m_="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function p_(s){_.useContext(Nr).static||_.useLayoutEffect(s)}function gr(){let{isDataRoute:s}=_.useContext(ci);return s?Tj():hj()}function hj(){Gn(Xl(),"useNavigate() may be used only in the context of a <Router> component.");let s=_.useContext(Ql),{basename:e,navigator:t}=_.useContext(Nr),{matches:i}=_.useContext(ci),{pathname:l}=Ii(),u=JSON.stringify(Gg(i)),h=_.useRef(!1);return p_(()=>{h.current=!0}),_.useCallback((g,y={})=>{if(Kr(h.current,m_),!h.current)return;if(typeof g=="number"){t.go(g);return}let b=Kg(g,JSON.parse(u),l,y.relative==="path");s==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:ea([e,b.pathname])),(y.replace?t.replace:t.push)(b,y.state,y)},[e,t,u,l,s])}_.createContext(null);function dj(){let{matches:s}=_.useContext(ci),e=s[s.length-1];return e?e.params:{}}function ku(s,{relative:e}={}){let{matches:t}=_.useContext(ci),{pathname:i}=Ii(),l=JSON.stringify(Gg(t));return _.useMemo(()=>Kg(s,JSON.parse(l),i,e==="path"),[s,l,i,e])}function fj(s,e){return g_(s,e)}function g_(s,e,t,i,l){Gn(Xl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=_.useContext(Nr),{matches:h}=_.useContext(ci),p=h[h.length-1],g=p?p.params:{},y=p?p.pathname:"/",b=p?p.pathnameBase:"/",E=p&&p.route;{let W=E&&E.path||"";v_(y,!E||W.endsWith("*")||W.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${y}" (under <Route path="${W}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${W}"> to <Route path="${W==="/"?"*":`${W}/*`}">.`)}let T=Ii(),O;if(e){let W=typeof e=="string"?Yl(e):e;Gn(b==="/"||W.pathname?.startsWith(b),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${b}" but pathname "${W.pathname}" was given in the \`location\` prop.`),O=W}else O=T;let H=O.pathname||"/",q=H;if(b!=="/"){let W=b.replace(/^\//,"").split("/");q="/"+H.replace(/^\//,"").split("/").slice(W.length).join("/")}let B=a_(s,{pathname:q});Kr(E||B!=null,`No routes matched location "${O.pathname}${O.search}${O.hash}" `),Kr(B==null||B[B.length-1].route.element!==void 0||B[B.length-1].route.Component!==void 0||B[B.length-1].route.lazy!==void 0,`Matched leaf route at location "${O.pathname}${O.search}${O.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let X=vj(B&&B.map(W=>Object.assign({},W,{params:Object.assign({},g,W.params),pathname:ea([b,u.encodeLocation?u.encodeLocation(W.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:W.pathname]),pathnameBase:W.pathnameBase==="/"?b:ea([b,u.encodeLocation?u.encodeLocation(W.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:W.pathnameBase])})),h,t,i,l);return e&&X?_.createElement(Tu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...O},navigationType:"POP"}},X):X}function mj(){let s=Ej(),e=ej(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),t=s instanceof Error?s.stack:null,i="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},h=null;return console.error("Error handled by React Router default ErrorBoundary:",s),h=_.createElement(_.Fragment,null,_.createElement("p",null," Hey developer "),_.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",_.createElement("code",{style:u},"ErrorBoundary")," or"," ",_.createElement("code",{style:u},"errorElement")," prop on your route.")),_.createElement(_.Fragment,null,_.createElement("h2",null,"Unexpected Application Error!"),_.createElement("h3",{style:{fontStyle:"italic"}},e),t?_.createElement("pre",{style:l},t):null,h)}var pj=_.createElement(mj,null),y_=class extends _.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){this.props.onError?this.props.onError(s,e):console.error("React Router caught the following error during render",s)}render(){let s=this.state.error;if(this.context&&typeof s=="object"&&s&&"digest"in s&&typeof s.digest=="string"){const t=cj(s.digest);t&&(s=t)}let e=s!==void 0?_.createElement(ci.Provider,{value:this.props.routeContext},_.createElement(Yg.Provider,{value:s,children:this.props.component})):this.props.children;return this.context?_.createElement(gj,{error:s},e):e}};y_.contextType=sj;var Cp=new WeakMap;function gj({children:s,error:e}){let{basename:t}=_.useContext(Nr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=lj(e.digest);if(i){let l=Cp.get(e);if(l)throw l;let u=u_(i.location,t);if(c_&&!Cp.get(e))if(u.isExternal||i.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const h=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:i.replace}));throw Cp.set(e,h),h}return _.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return s}function yj({routeContext:s,match:e,children:t}){let i=_.useContext(Ql);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),_.createElement(ci.Provider,{value:s},t)}function vj(s,e=[],t=null,i=null,l=null){if(s==null){if(!t)return null;if(t.errors)s=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)s=t.matches;else return null}let u=s,h=t?.errors;if(h!=null){let b=u.findIndex(E=>E.route.id&&h?.[E.route.id]!==void 0);Gn(b>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(h).join(",")}`),u=u.slice(0,Math.min(u.length,b+1))}let p=!1,g=-1;if(t)for(let b=0;b<u.length;b++){let E=u[b];if((E.route.HydrateFallback||E.route.hydrateFallbackElement)&&(g=b),E.route.id){let{loaderData:T,errors:O}=t,H=E.route.loader&&!T.hasOwnProperty(E.route.id)&&(!O||O[E.route.id]===void 0);if(E.route.lazy||H){p=!0,g>=0?u=u.slice(0,g+1):u=[u[0]];break}}}let y=t&&i?(b,E)=>{i(b,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:tj(t.matches),errorInfo:E})}:void 0;return u.reduceRight((b,E,T)=>{let O,H=!1,q=null,B=null;t&&(O=h&&E.route.id?h[E.route.id]:void 0,q=E.route.errorElement||pj,p&&(g<0&&T===0?(v_("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),H=!0,B=null):g===T&&(H=!0,B=E.route.hydrateFallbackElement||null)));let X=e.concat(u.slice(0,T+1)),W=()=>{let Y;return O?Y=q:H?Y=B:E.route.Component?Y=_.createElement(E.route.Component,null):E.route.element?Y=E.route.element:Y=b,_.createElement(yj,{match:E,routeContext:{outlet:b,matches:X,isDataRoute:t!=null},children:Y})};return t&&(E.route.ErrorBoundary||E.route.errorElement||T===0)?_.createElement(y_,{location:t.location,revalidation:t.revalidation,component:q,error:O,children:W(),routeContext:{outlet:null,matches:X,isDataRoute:!0},onError:y}):W()},null)}function Qg(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function bj(s){let e=_.useContext(Ql);return Gn(e,Qg(s)),e}function wj(s){let e=_.useContext(Xd);return Gn(e,Qg(s)),e}function _j(s){let e=_.useContext(ci);return Gn(e,Qg(s)),e}function Xg(s){let e=_j(s),t=e.matches[e.matches.length-1];return Gn(t.route.id,`${s} can only be used on routes that contain a unique "id"`),t.route.id}function xj(){return Xg("useRouteId")}function Ej(){let s=_.useContext(Yg),e=wj("useRouteError"),t=Xg("useRouteError");return s!==void 0?s:e.errors?.[t]}function Tj(){let{router:s}=bj("useNavigate"),e=Xg("useNavigate"),t=_.useRef(!1);return p_(()=>{t.current=!0}),_.useCallback(async(l,u={})=>{Kr(t.current,m_),t.current&&(typeof l=="number"?await s.navigate(l):await s.navigate(l,{fromRouteId:e,...u}))},[s,e])}var Zb={};function v_(s,e,t){!e&&!Zb[s]&&(Zb[s]=!0,Kr(!1,t))}_.memo(kj);function kj({routes:s,future:e,state:t,onError:i}){return g_(s,void 0,t,i,e)}function b_({to:s,replace:e,state:t,relative:i}){Gn(Xl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=_.useContext(Nr);Kr(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=_.useContext(ci),{pathname:h}=Ii(),p=gr(),g=Kg(s,Gg(u),h,i==="path"),y=JSON.stringify(g);return _.useEffect(()=>{p(JSON.parse(y),{replace:e,state:t,relative:i})},[p,y,i,e,t]),null}function In(s){Gn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Sj({basename:s="/",children:e=null,location:t,navigationType:i="POP",navigator:l,static:u=!1,unstable_useTransitions:h}){Gn(!Xl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=s.replace(/^\/*/,"/"),g=_.useMemo(()=>({basename:p,navigator:l,static:u,unstable_useTransitions:h,future:{}}),[p,l,u,h]);typeof t=="string"&&(t=Yl(t));let{pathname:y="/",search:b="",hash:E="",state:T=null,key:O="default"}=t,H=_.useMemo(()=>{let q=ra(y,p);return q==null?null:{location:{pathname:q,search:b,hash:E,state:T,key:O},navigationType:i}},[p,y,b,E,T,O,i]);return Kr(H!=null,`<Router basename="${p}"> is not able to match the URL "${y}${b}${E}" because it does not start with the basename, so the <Router> won't render anything.`),H==null?null:_.createElement(Nr.Provider,{value:g},_.createElement(Tu.Provider,{children:e,value:H}))}function jj({children:s,location:e}){return fj(dg(s),e)}function dg(s,e=[]){let t=[];return _.Children.forEach(s,(i,l)=>{if(!_.isValidElement(i))return;let u=[...e,l];if(i.type===_.Fragment){t.push.apply(t,dg(i.props.children,u));return}Gn(i.type===In,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Gn(!i.props.index||!i.props.children,"An index route cannot have child routes.");let h={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(h.children=dg(i.props.children,u)),t.push(h)}),t}var gd="get",yd="application/x-www-form-urlencoded";function Jd(s){return typeof HTMLElement<"u"&&s instanceof HTMLElement}function Cj(s){return Jd(s)&&s.tagName.toLowerCase()==="button"}function Nj(s){return Jd(s)&&s.tagName.toLowerCase()==="form"}function Aj(s){return Jd(s)&&s.tagName.toLowerCase()==="input"}function Rj(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function Ij(s,e){return s.button===0&&(!e||e==="_self")&&!Rj(s)}function fg(s=""){return new URLSearchParams(typeof s=="string"||Array.isArray(s)||s instanceof URLSearchParams?s:Object.keys(s).reduce((e,t)=>{let i=s[t];return e.concat(Array.isArray(i)?i.map(l=>[t,l]):[[t,i]])},[]))}function Dj(s,e){let t=fg(s);return e&&e.forEach((i,l)=>{t.has(l)||e.getAll(l).forEach(u=>{t.append(l,u)})}),t}var nd=null;function Mj(){if(nd===null)try{new FormData(document.createElement("form"),0),nd=!1}catch{nd=!0}return nd}var Lj=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Np(s){return s!=null&&!Lj.has(s)?(Kr(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${yd}"`),null):s}function Oj(s,e){let t,i,l,u,h;if(Nj(s)){let p=s.getAttribute("action");i=p?ra(p,e):null,t=s.getAttribute("method")||gd,l=Np(s.getAttribute("enctype"))||yd,u=new FormData(s)}else if(Cj(s)||Aj(s)&&(s.type==="submit"||s.type==="image")){let p=s.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=s.getAttribute("formaction")||p.getAttribute("action");if(i=g?ra(g,e):null,t=s.getAttribute("formmethod")||p.getAttribute("method")||gd,l=Np(s.getAttribute("formenctype"))||Np(p.getAttribute("enctype"))||yd,u=new FormData(p,s),!Mj()){let{name:y,type:b,value:E}=s;if(b==="image"){let T=y?`${y}.`:"";u.append(`${T}x`,"0"),u.append(`${T}y`,"0")}else y&&u.append(y,E)}}else{if(Jd(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=gd,i=null,l=yd,h=s}return u&&l==="text/plain"&&(h=u,u=void 0),{action:i,method:t.toLowerCase(),encType:l,formData:u,body:h}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Jg(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function Pj(s,e,t,i){let l=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return t?l.pathname.endsWith("/")?l.pathname=`${l.pathname}_.${i}`:l.pathname=`${l.pathname}.${i}`:l.pathname==="/"?l.pathname=`_root.${i}`:e&&ra(l.pathname,e)==="/"?l.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${i}`,l}async function Vj(s,e){if(s.id in e)return e[s.id];try{let t=await import(s.module);return e[s.id]=t,t}catch(t){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Uj(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function Bj(s,e,t){let i=await Promise.all(s.map(async l=>{let u=e.routes[l.route.id];if(u){let h=await Vj(u,t);return h.links?h.links():[]}return[]}));return Hj(i.flat(1).filter(Uj).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function e2(s,e,t,i,l,u){let h=(g,y)=>t[y]?g.route.id!==t[y].route.id:!0,p=(g,y)=>t[y].pathname!==g.pathname||t[y].route.path?.endsWith("*")&&t[y].params["*"]!==g.params["*"];return u==="assets"?e.filter((g,y)=>h(g,y)||p(g,y)):u==="data"?e.filter((g,y)=>{let b=i.routes[g.route.id];if(!b||!b.hasLoader)return!1;if(h(g,y)||p(g,y))return!0;if(g.route.shouldRevalidate){let E=g.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(s,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof E=="boolean")return E}return!0}):[]}function zj(s,e,{includeHydrateFallback:t}={}){return Fj(s.map(i=>{let l=e.routes[i.route.id];if(!l)return[];let u=[l.module];return l.clientActionModule&&(u=u.concat(l.clientActionModule)),l.clientLoaderModule&&(u=u.concat(l.clientLoaderModule)),t&&l.hydrateFallbackModule&&(u=u.concat(l.hydrateFallbackModule)),l.imports&&(u=u.concat(l.imports)),u}).flat(1))}function Fj(s){return[...new Set(s)]}function qj(s){let e={},t=Object.keys(s).sort();for(let i of t)e[i]=s[i];return e}function Hj(s,e){let t=new Set;return new Set(e),s.reduce((i,l)=>{let u=JSON.stringify(qj(l));return t.has(u)||(t.add(u),i.push({key:u,link:l})),i},[])}function w_(){let s=_.useContext(Ql);return Jg(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function $j(){let s=_.useContext(Xd);return Jg(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var Zg=_.createContext(void 0);Zg.displayName="FrameworkContext";function __(){let s=_.useContext(Zg);return Jg(s,"You must render this element inside a <HydratedRouter> element"),s}function Wj(s,e){let t=_.useContext(Zg),[i,l]=_.useState(!1),[u,h]=_.useState(!1),{onFocus:p,onBlur:g,onMouseEnter:y,onMouseLeave:b,onTouchStart:E}=e,T=_.useRef(null);_.useEffect(()=>{if(s==="render"&&h(!0),s==="viewport"){let q=X=>{X.forEach(W=>{h(W.isIntersecting)})},B=new IntersectionObserver(q,{threshold:.5});return T.current&&B.observe(T.current),()=>{B.disconnect()}}},[s]),_.useEffect(()=>{if(i){let q=setTimeout(()=>{h(!0)},100);return()=>{clearTimeout(q)}}},[i]);let O=()=>{l(!0)},H=()=>{l(!1),h(!1)};return t?s!=="intent"?[u,T,{}]:[u,T,{onFocus:Hc(p,O),onBlur:Hc(g,H),onMouseEnter:Hc(y,O),onMouseLeave:Hc(b,H),onTouchStart:Hc(E,O)}]:[!1,T,{}]}function Hc(s,e){return t=>{s&&s(t),t.defaultPrevented||e(t)}}function Gj({page:s,...e}){let{router:t}=w_(),i=_.useMemo(()=>a_(t.routes,s,t.basename),[t.routes,s,t.basename]);return i?_.createElement(Yj,{page:s,matches:i,...e}):null}function Kj(s){let{manifest:e,routeModules:t}=__(),[i,l]=_.useState([]);return _.useEffect(()=>{let u=!1;return Bj(s,e,t).then(h=>{u||l(h)}),()=>{u=!0}},[s,e,t]),i}function Yj({page:s,matches:e,...t}){let i=Ii(),{future:l,manifest:u,routeModules:h}=__(),{basename:p}=w_(),{loaderData:g,matches:y}=$j(),b=_.useMemo(()=>e2(s,e,y,u,i,"data"),[s,e,y,u,i]),E=_.useMemo(()=>e2(s,e,y,u,i,"assets"),[s,e,y,u,i]),T=_.useMemo(()=>{if(s===i.pathname+i.search+i.hash)return[];let q=new Set,B=!1;if(e.forEach(W=>{let Y=u.routes[W.route.id];!Y||!Y.hasLoader||(!b.some(de=>de.route.id===W.route.id)&&W.route.id in g&&h[W.route.id]?.shouldRevalidate||Y.hasClientLoader?B=!0:q.add(W.route.id))}),q.size===0)return[];let X=Pj(s,p,l.unstable_trailingSlashAwareDataRequests,"data");return B&&q.size>0&&X.searchParams.set("_routes",e.filter(W=>q.has(W.route.id)).map(W=>W.route.id).join(",")),[X.pathname+X.search]},[p,l.unstable_trailingSlashAwareDataRequests,g,i,u,b,e,s,h]),O=_.useMemo(()=>zj(E,u),[E,u]),H=Kj(E);return _.createElement(_.Fragment,null,T.map(q=>_.createElement("link",{key:q,rel:"prefetch",as:"fetch",href:q,...t})),O.map(q=>_.createElement("link",{key:q,rel:"modulepreload",href:q,...t})),H.map(({key:q,link:B})=>_.createElement("link",{key:q,nonce:t.nonce,...B,crossOrigin:B.crossOrigin??t.crossOrigin})))}function Qj(...s){return e=>{s.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var Xj=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Xj&&(window.__reactRouterVersion="7.13.0")}catch{}function Jj({basename:s,children:e,unstable_useTransitions:t,window:i}){let l=_.useRef();l.current==null&&(l.current=AS({window:i,v5Compat:!0}));let u=l.current,[h,p]=_.useState({action:u.action,location:u.location}),g=_.useCallback(y=>{t===!1?p(y):_.startTransition(()=>p(y))},[t]);return _.useLayoutEffect(()=>u.listen(g),[u,g]),_.createElement(Sj,{basename:s,children:e,location:h.location,navigationType:h.action,navigator:u,unstable_useTransitions:t})}var x_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,E_=_.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:l,reloadDocument:u,replace:h,state:p,target:g,to:y,preventScrollReset:b,viewTransition:E,unstable_defaultShouldRevalidate:T,...O},H){let{basename:q,unstable_useTransitions:B}=_.useContext(Nr),X=typeof y=="string"&&x_.test(y),W=u_(y,q);y=W.to;let Y=uj(y,{relative:l}),[de,xe,ve]=Wj(i,O),j=nC(y,{replace:h,state:p,target:g,preventScrollReset:b,relative:l,viewTransition:E,unstable_defaultShouldRevalidate:T,unstable_useTransitions:B});function S(V){e&&e(V),V.defaultPrevented||j(V)}let I=_.createElement("a",{...O,...ve,href:W.absoluteURL||Y,onClick:W.isExternal||u?e:S,ref:Qj(H,xe),target:g,"data-discover":!X&&t==="render"?"true":void 0});return de&&!X?_.createElement(_.Fragment,null,I,_.createElement(Gj,{page:Y})):I});E_.displayName="Link";var Zj=_.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:l=!1,style:u,to:h,viewTransition:p,children:g,...y},b){let E=ku(h,{relative:y.relative}),T=Ii(),O=_.useContext(Xd),{navigator:H,basename:q}=_.useContext(Nr),B=O!=null&&oC(E)&&p===!0,X=H.encodeLocation?H.encodeLocation(E).pathname:E.pathname,W=T.pathname,Y=O&&O.navigation&&O.navigation.location?O.navigation.location.pathname:null;t||(W=W.toLowerCase(),Y=Y?Y.toLowerCase():null,X=X.toLowerCase()),Y&&q&&(Y=ra(Y,q)||Y);const de=X!=="/"&&X.endsWith("/")?X.length-1:X.length;let xe=W===X||!l&&W.startsWith(X)&&W.charAt(de)==="/",ve=Y!=null&&(Y===X||!l&&Y.startsWith(X)&&Y.charAt(X.length)==="/"),j={isActive:xe,isPending:ve,isTransitioning:B},S=xe?e:void 0,I;typeof i=="function"?I=i(j):I=[i,xe?"active":null,ve?"pending":null,B?"transitioning":null].filter(Boolean).join(" ");let V=typeof u=="function"?u(j):u;return _.createElement(E_,{...y,"aria-current":S,className:I,ref:b,style:V,to:h,viewTransition:p},typeof g=="function"?g(j):g)});Zj.displayName="NavLink";var eC=_.forwardRef(({discover:s="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:l,state:u,method:h=gd,action:p,onSubmit:g,relative:y,preventScrollReset:b,viewTransition:E,unstable_defaultShouldRevalidate:T,...O},H)=>{let{unstable_useTransitions:q}=_.useContext(Nr),B=iC(),X=aC(p,{relative:y}),W=h.toLowerCase()==="get"?"get":"post",Y=typeof p=="string"&&x_.test(p),de=xe=>{if(g&&g(xe),xe.defaultPrevented)return;xe.preventDefault();let ve=xe.nativeEvent.submitter,j=ve?.getAttribute("formmethod")||h,S=()=>B(ve||xe.currentTarget,{fetcherKey:e,method:j,navigate:t,replace:l,state:u,relative:y,preventScrollReset:b,viewTransition:E,unstable_defaultShouldRevalidate:T});q&&t!==!1?_.startTransition(()=>S()):S()};return _.createElement("form",{ref:H,method:W,action:X,onSubmit:i?g:de,...O,"data-discover":!Y&&s==="render"?"true":void 0})});eC.displayName="Form";function tC(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function T_(s){let e=_.useContext(Ql);return Gn(e,tC(s)),e}function nC(s,{target:e,replace:t,state:i,preventScrollReset:l,relative:u,viewTransition:h,unstable_defaultShouldRevalidate:p,unstable_useTransitions:g}={}){let y=gr(),b=Ii(),E=ku(s,{relative:u});return _.useCallback(T=>{if(Ij(T,e)){T.preventDefault();let O=t!==void 0?t:cu(b)===cu(E),H=()=>y(s,{replace:O,state:i,preventScrollReset:l,relative:u,viewTransition:h,unstable_defaultShouldRevalidate:p});g?_.startTransition(()=>H()):H()}},[b,y,E,t,i,e,s,l,u,h,p,g])}function J5(s){Kr(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=_.useRef(fg(s)),t=_.useRef(!1),i=Ii(),l=_.useMemo(()=>Dj(i.search,t.current?null:e.current),[i.search]),u=gr(),h=_.useCallback((p,g)=>{const y=fg(typeof p=="function"?p(new URLSearchParams(l)):p);t.current=!0,u("?"+y,g)},[u,l]);return[l,h]}var sC=0,rC=()=>`__${String(++sC)}__`;function iC(){let{router:s}=T_("useSubmit"),{basename:e}=_.useContext(Nr),t=xj(),i=s.fetch,l=s.navigate;return _.useCallback(async(u,h={})=>{let{action:p,method:g,encType:y,formData:b,body:E}=Oj(u,e);if(h.navigate===!1){let T=h.fetcherKey||rC();await i(T,t,h.action||p,{unstable_defaultShouldRevalidate:h.unstable_defaultShouldRevalidate,preventScrollReset:h.preventScrollReset,formData:b,body:E,formMethod:h.method||g,formEncType:h.encType||y,flushSync:h.flushSync})}else await l(h.action||p,{unstable_defaultShouldRevalidate:h.unstable_defaultShouldRevalidate,preventScrollReset:h.preventScrollReset,formData:b,body:E,formMethod:h.method||g,formEncType:h.encType||y,replace:h.replace,state:h.state,fromRouteId:t,flushSync:h.flushSync,viewTransition:h.viewTransition})},[i,l,e,t])}function aC(s,{relative:e}={}){let{basename:t}=_.useContext(Nr),i=_.useContext(ci);Gn(i,"useFormAction must be used inside a RouteContext");let[l]=i.matches.slice(-1),u={...ku(s||".",{relative:e})},h=Ii();if(s==null){u.search=h.search;let p=new URLSearchParams(u.search),g=p.getAll("index");if(g.some(b=>b==="")){p.delete("index"),g.filter(E=>E).forEach(E=>p.append("index",E));let b=p.toString();u.search=b?`?${b}`:""}}return(!s||s===".")&&l.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(u.pathname=u.pathname==="/"?t:ea([t,u.pathname])),cu(u)}function oC(s,{relative:e}={}){let t=_.useContext(d_);Gn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=T_("useViewTransitionState"),l=ku(s,{relative:e});if(!t.isTransitioning)return!1;let u=ra(t.currentLocation.pathname,i)||t.currentLocation.pathname,h=ra(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Nd(l.pathname,h)!=null||Nd(l.pathname,u)!=null}const lC=()=>{};var t2={};const k_=function(s){const e=[];let t=0;for(let i=0;i<s.length;i++){let l=s.charCodeAt(i);l<128?e[t++]=l:l<2048?(e[t++]=l>>6|192,e[t++]=l&63|128):(l&64512)===55296&&i+1<s.length&&(s.charCodeAt(i+1)&64512)===56320?(l=65536+((l&1023)<<10)+(s.charCodeAt(++i)&1023),e[t++]=l>>18|240,e[t++]=l>>12&63|128,e[t++]=l>>6&63|128,e[t++]=l&63|128):(e[t++]=l>>12|224,e[t++]=l>>6&63|128,e[t++]=l&63|128)}return e},cC=function(s){const e=[];let t=0,i=0;for(;t<s.length;){const l=s[t++];if(l<128)e[i++]=String.fromCharCode(l);else if(l>191&&l<224){const u=s[t++];e[i++]=String.fromCharCode((l&31)<<6|u&63)}else if(l>239&&l<365){const u=s[t++],h=s[t++],p=s[t++],g=((l&7)<<18|(u&63)<<12|(h&63)<<6|p&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const u=s[t++],h=s[t++];e[i++]=String.fromCharCode((l&15)<<12|(u&63)<<6|h&63)}}return e.join("")},S_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let l=0;l<s.length;l+=3){const u=s[l],h=l+1<s.length,p=h?s[l+1]:0,g=l+2<s.length,y=g?s[l+2]:0,b=u>>2,E=(u&3)<<4|p>>4;let T=(p&15)<<2|y>>6,O=y&63;g||(O=64,h||(T=64)),i.push(t[b],t[E],t[T],t[O])}return i.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(k_(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):cC(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let l=0;l<s.length;){const u=t[s.charAt(l++)],p=l<s.length?t[s.charAt(l)]:0;++l;const y=l<s.length?t[s.charAt(l)]:64;++l;const E=l<s.length?t[s.charAt(l)]:64;if(++l,u==null||p==null||y==null||E==null)throw new uC;const T=u<<2|p>>4;if(i.push(T),y!==64){const O=p<<4&240|y>>2;if(i.push(O),E!==64){const H=y<<6&192|E;i.push(H)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class uC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const hC=function(s){const e=k_(s);return S_.encodeByteArray(e,!0)},Ad=function(s){return hC(s).replace(/\./g,"")},j_=function(s){try{return S_.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function dC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const fC=()=>dC().__FIREBASE_DEFAULTS__,mC=()=>{if(typeof process>"u"||typeof t2>"u")return;const s=t2.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},pC=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&j_(s[1]);return e&&JSON.parse(e)},Zd=()=>{try{return lC()||fC()||mC()||pC()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},C_=s=>Zd()?.emulatorHosts?.[s],N_=s=>{const e=C_(s);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},A_=()=>Zd()?.config,R_=s=>Zd()?.[`_${s}`];class gC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function no(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function ey(s){return(await fetch(s,{credentials:"include"})).ok}function I_(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",l=s.iat||0,u=s.sub||s.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const h={iss:`https://securetoken.google.com/${i}`,aud:i,iat:l,exp:l+3600,auth_time:l,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...s};return[Ad(JSON.stringify(t)),Ad(JSON.stringify(h)),""].join(".")}const nu={};function yC(){const s={prod:[],emulator:[]};for(const e of Object.keys(nu))nu[e]?s.emulator.push(e):s.prod.push(e);return s}function vC(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let n2=!1;function ty(s,e){if(typeof window>"u"||typeof document>"u"||!no(window.location.host)||nu[s]===e||nu[s]||n2)return;nu[s]=e;function t(T){return`__firebase__banner__${T}`}const i="__firebase__banner",u=yC().prod.length>0;function h(){const T=document.getElementById(i);T&&T.remove()}function p(T){T.style.display="flex",T.style.background="#7faaf0",T.style.position="fixed",T.style.bottom="5px",T.style.left="5px",T.style.padding=".5em",T.style.borderRadius="5px",T.style.alignItems="center"}function g(T,O){T.setAttribute("width","24"),T.setAttribute("id",O),T.setAttribute("height","24"),T.setAttribute("viewBox","0 0 24 24"),T.setAttribute("fill","none"),T.style.marginLeft="-6px"}function y(){const T=document.createElement("span");return T.style.cursor="pointer",T.style.marginLeft="16px",T.style.fontSize="24px",T.innerHTML=" &times;",T.onclick=()=>{n2=!0,h()},T}function b(T,O){T.setAttribute("id",O),T.innerText="Learn more",T.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",T.setAttribute("target","__blank"),T.style.paddingLeft="5px",T.style.textDecoration="underline"}function E(){const T=vC(i),O=t("text"),H=document.getElementById(O)||document.createElement("span"),q=t("learnmore"),B=document.getElementById(q)||document.createElement("a"),X=t("preprendIcon"),W=document.getElementById(X)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(T.created){const Y=T.element;p(Y),b(B,q);const de=y();g(W,X),Y.append(W,H,B,de),document.body.appendChild(Y)}u?(H.innerText="Preview backend disconnected.",W.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(W.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,H.innerText="Preview backend running in this workspace."),H.setAttribute("id",O)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",E):E()}function Ws(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function bC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ws())}function wC(){const s=Zd()?.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function _C(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function xC(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function EC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function TC(){const s=Ws();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function kC(){return!wC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function D_(){try{return typeof indexedDB=="object"}catch{return!1}}function M_(){return new Promise((s,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(i);l.onsuccess=()=>{l.result.close(),t||self.indexedDB.deleteDatabase(i),s(!0)},l.onupgradeneeded=()=>{t=!1},l.onerror=()=>{e(l.error?.message||"")}}catch(t){e(t)}})}function SC(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}const jC="FirebaseError";class ui extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=jC,Object.setPrototypeOf(this,ui.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ho.prototype.create)}}class Ho{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},l=`${this.service}/${e}`,u=this.errors[e],h=u?CC(u,i):"Error",p=`${this.serviceName}: ${h} (${l}).`;return new ui(l,p,i)}}function CC(s,e){return s.replace(NC,(t,i)=>{const l=e[i];return l!=null?String(l):`<${i}?>`})}const NC=/\{\$([^}]+)}/g;function AC(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function ia(s,e){if(s===e)return!0;const t=Object.keys(s),i=Object.keys(e);for(const l of t){if(!i.includes(l))return!1;const u=s[l],h=e[l];if(s2(u)&&s2(h)){if(!ia(u,h))return!1}else if(u!==h)return!1}for(const l of i)if(!t.includes(l))return!1;return!0}function s2(s){return s!==null&&typeof s=="object"}function Su(s){const e=[];for(const[t,i]of Object.entries(s))Array.isArray(i)?i.forEach(l=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Qc(s){const e={};return s.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[l,u]=i.split("=");e[decodeURIComponent(l)]=decodeURIComponent(u)}}),e}function Xc(s){const e=s.indexOf("?");if(!e)return"";const t=s.indexOf("#",e);return s.substring(e,t>0?t:void 0)}function RC(s,e){const t=new IC(s,e);return t.subscribe.bind(t)}class IC{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let l;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");DC(e,["next","error","complete"])?l=e:l={next:e,error:t,complete:i},l.next===void 0&&(l.next=Ap),l.error===void 0&&(l.error=Ap),l.complete===void 0&&(l.complete=Ap);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch{}}),this.observers.push(l),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function DC(s,e){if(typeof s!="object"||s===null)return!1;for(const t of e)if(t in s&&typeof s[t]=="function")return!0;return!1}function Ap(){}function pn(s){return s&&s._delegate?s._delegate:s}class Yr{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Co="[DEFAULT]";class MC{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new gC;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:t});l&&i.resolve(l)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(l){if(i)return null;throw l}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(OC(e))try{this.getOrInitializeService({instanceIdentifier:Co})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(t);try{const u=this.getOrInitializeService({instanceIdentifier:l});i.resolve(u)}catch{}}}}clearInstance(e=Co){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Co){return this.instances.has(e)}getOptions(e=Co){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[u,h]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(u);i===p&&h.resolve(l)}return l}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),l=this.onInitCallbacks.get(i)??new Set;l.add(e),this.onInitCallbacks.set(i,l);const u=this.instances.get(i);return u&&e(u,i),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const l of i)try{l(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:LC(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Co){return this.component?this.component.multipleInstances?e:Co:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function LC(s){return s===Co?void 0:s}function OC(s){return s.instantiationMode==="EAGER"}class PC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new MC(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var $t;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})($t||($t={}));const VC={debug:$t.DEBUG,verbose:$t.VERBOSE,info:$t.INFO,warn:$t.WARN,error:$t.ERROR,silent:$t.SILENT},UC=$t.INFO,BC={[$t.DEBUG]:"log",[$t.VERBOSE]:"log",[$t.INFO]:"info",[$t.WARN]:"warn",[$t.ERROR]:"error"},zC=(s,e,...t)=>{if(e<s.logLevel)return;const i=new Date().toISOString(),l=BC[e];if(l)console[l](`[${i}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ny{constructor(e){this.name=e,this._logLevel=UC,this._logHandler=zC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in $t))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?VC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,$t.DEBUG,...e),this._logHandler(this,$t.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,$t.VERBOSE,...e),this._logHandler(this,$t.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,$t.INFO,...e),this._logHandler(this,$t.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,$t.WARN,...e),this._logHandler(this,$t.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,$t.ERROR,...e),this._logHandler(this,$t.ERROR,...e)}}const FC=(s,e)=>e.some(t=>s instanceof t);let r2,i2;function qC(){return r2||(r2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function HC(){return i2||(i2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const L_=new WeakMap,mg=new WeakMap,O_=new WeakMap,Rp=new WeakMap,sy=new WeakMap;function $C(s){const e=new Promise((t,i)=>{const l=()=>{s.removeEventListener("success",u),s.removeEventListener("error",h)},u=()=>{t(ta(s.result)),l()},h=()=>{i(s.error),l()};s.addEventListener("success",u),s.addEventListener("error",h)});return e.then(t=>{t instanceof IDBCursor&&L_.set(t,s)}).catch(()=>{}),sy.set(e,s),e}function WC(s){if(mg.has(s))return;const e=new Promise((t,i)=>{const l=()=>{s.removeEventListener("complete",u),s.removeEventListener("error",h),s.removeEventListener("abort",h)},u=()=>{t(),l()},h=()=>{i(s.error||new DOMException("AbortError","AbortError")),l()};s.addEventListener("complete",u),s.addEventListener("error",h),s.addEventListener("abort",h)});mg.set(s,e)}let pg={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return mg.get(s);if(e==="objectStoreNames")return s.objectStoreNames||O_.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ta(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function GC(s){pg=s(pg)}function KC(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=s.call(Ip(this),e,...t);return O_.set(i,e.sort?e.sort():[e]),ta(i)}:HC().includes(s)?function(...e){return s.apply(Ip(this),e),ta(L_.get(this))}:function(...e){return ta(s.apply(Ip(this),e))}}function YC(s){return typeof s=="function"?KC(s):(s instanceof IDBTransaction&&WC(s),FC(s,qC())?new Proxy(s,pg):s)}function ta(s){if(s instanceof IDBRequest)return $C(s);if(Rp.has(s))return Rp.get(s);const e=YC(s);return e!==s&&(Rp.set(s,e),sy.set(e,s)),e}const Ip=s=>sy.get(s);function ef(s,e,{blocked:t,upgrade:i,blocking:l,terminated:u}={}){const h=indexedDB.open(s,e),p=ta(h);return i&&h.addEventListener("upgradeneeded",g=>{i(ta(h.result),g.oldVersion,g.newVersion,ta(h.transaction),g)}),t&&h.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),p.then(g=>{u&&g.addEventListener("close",()=>u()),l&&g.addEventListener("versionchange",y=>l(y.oldVersion,y.newVersion,y))}).catch(()=>{}),p}function Dp(s,{blocked:e}={}){const t=indexedDB.deleteDatabase(s);return e&&t.addEventListener("blocked",i=>e(i.oldVersion,i)),ta(t).then(()=>{})}const QC=["get","getKey","getAll","getAllKeys","count"],XC=["put","add","delete","clear"],Mp=new Map;function a2(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(Mp.get(e))return Mp.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,l=XC.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(l||QC.includes(t)))return;const u=async function(h,...p){const g=this.transaction(h,l?"readwrite":"readonly");let y=g.store;return i&&(y=y.index(p.shift())),(await Promise.all([y[t](...p),l&&g.done]))[0]};return Mp.set(e,u),u}GC(s=>({...s,get:(e,t,i)=>a2(e,t)||s.get(e,t,i),has:(e,t)=>!!a2(e,t)||s.has(e,t)}));class JC{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(ZC(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function ZC(s){return s.getComponent()?.type==="VERSION"}const gg="@firebase/app",o2="0.14.7";const aa=new ny("@firebase/app"),eN="@firebase/app-compat",tN="@firebase/analytics-compat",nN="@firebase/analytics",sN="@firebase/app-check-compat",rN="@firebase/app-check",iN="@firebase/auth",aN="@firebase/auth-compat",oN="@firebase/database",lN="@firebase/data-connect",cN="@firebase/database-compat",uN="@firebase/functions",hN="@firebase/functions-compat",dN="@firebase/installations",fN="@firebase/installations-compat",mN="@firebase/messaging",pN="@firebase/messaging-compat",gN="@firebase/performance",yN="@firebase/performance-compat",vN="@firebase/remote-config",bN="@firebase/remote-config-compat",wN="@firebase/storage",_N="@firebase/storage-compat",xN="@firebase/firestore",EN="@firebase/ai",TN="@firebase/firestore-compat",kN="firebase",SN="12.8.0";const yg="[DEFAULT]",jN={[gg]:"fire-core",[eN]:"fire-core-compat",[nN]:"fire-analytics",[tN]:"fire-analytics-compat",[rN]:"fire-app-check",[sN]:"fire-app-check-compat",[iN]:"fire-auth",[aN]:"fire-auth-compat",[oN]:"fire-rtdb",[lN]:"fire-data-connect",[cN]:"fire-rtdb-compat",[uN]:"fire-fn",[hN]:"fire-fn-compat",[dN]:"fire-iid",[fN]:"fire-iid-compat",[mN]:"fire-fcm",[pN]:"fire-fcm-compat",[gN]:"fire-perf",[yN]:"fire-perf-compat",[vN]:"fire-rc",[bN]:"fire-rc-compat",[wN]:"fire-gcs",[_N]:"fire-gcs-compat",[xN]:"fire-fst",[TN]:"fire-fst-compat",[EN]:"fire-vertex","fire-js":"fire-js",[kN]:"fire-js-all"};const Rd=new Map,CN=new Map,vg=new Map;function l2(s,e){try{s.container.addComponent(e)}catch(t){aa.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function ai(s){const e=s.name;if(vg.has(e))return aa.debug(`There were multiple attempts to register component ${e}.`),!1;vg.set(e,s);for(const t of Rd.values())l2(t,s);for(const t of CN.values())l2(t,s);return!0}function $o(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function Sr(s){return s==null?!1:s.settings!==void 0}const NN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ga=new Ho("app","Firebase",NN);class AN{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Yr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ga.create("app-deleted",{appName:this._name})}}const Wo=SN;function ry(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const i={name:yg,automaticDataCollectionEnabled:!0,...e},l=i.name;if(typeof l!="string"||!l)throw Ga.create("bad-app-name",{appName:String(l)});if(t||(t=A_()),!t)throw Ga.create("no-options");const u=Rd.get(l);if(u){if(ia(t,u.options)&&ia(i,u.config))return u;throw Ga.create("duplicate-app",{appName:l})}const h=new PC(l);for(const g of vg.values())h.addComponent(g);const p=new AN(t,i,h);return Rd.set(l,p),p}function ju(s=yg){const e=Rd.get(s);if(!e&&s===yg&&A_())return ry();if(!e)throw Ga.create("no-app",{appName:s});return e}function pr(s,e,t){let i=jN[s]??s;t&&(i+=`-${t}`);const l=i.match(/\s|\//),u=e.match(/\s|\//);if(l||u){const h=[`Unable to register library "${i}" with version "${e}":`];l&&h.push(`library name "${i}" contains illegal characters (whitespace or "/")`),l&&u&&h.push("and"),u&&h.push(`version name "${e}" contains illegal characters (whitespace or "/")`),aa.warn(h.join(" "));return}ai(new Yr(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const RN="firebase-heartbeat-database",IN=1,uu="firebase-heartbeat-store";let Lp=null;function P_(){return Lp||(Lp=ef(RN,IN,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(uu)}catch(t){console.warn(t)}}}}).catch(s=>{throw Ga.create("idb-open",{originalErrorMessage:s.message})})),Lp}async function DN(s){try{const t=(await P_()).transaction(uu),i=await t.objectStore(uu).get(V_(s));return await t.done,i}catch(e){if(e instanceof ui)aa.warn(e.message);else{const t=Ga.create("idb-get",{originalErrorMessage:e?.message});aa.warn(t.message)}}}async function c2(s,e){try{const i=(await P_()).transaction(uu,"readwrite");await i.objectStore(uu).put(e,V_(s)),await i.done}catch(t){if(t instanceof ui)aa.warn(t.message);else{const i=Ga.create("idb-set",{originalErrorMessage:t?.message});aa.warn(i.message)}}}function V_(s){return`${s.name}!${s.options.appId}`}const MN=1024,LN=30;class ON{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new VN(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=u2();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>LN){const l=UN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){aa.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=u2(),{heartbeatsToSend:t,unsentEntries:i}=PN(this._heartbeatsCache.heartbeats),l=Ad(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(e){return aa.warn(e),""}}}function u2(){return new Date().toISOString().substring(0,10)}function PN(s,e=MN){const t=[];let i=s.slice();for(const l of s){const u=t.find(h=>h.agent===l.agent);if(u){if(u.dates.push(l.date),h2(t)>e){u.dates.pop();break}}else if(t.push({agent:l.agent,dates:[l.date]}),h2(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class VN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return D_()?M_().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await DN(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return c2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return c2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function h2(s){return Ad(JSON.stringify({version:2,heartbeats:s})).length}function UN(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let i=1;i<s.length;i++)s[i].date<t&&(t=s[i].date,e=i);return e}function BN(s){ai(new Yr("platform-logger",e=>new JC(e),"PRIVATE")),ai(new Yr("heartbeat",e=>new ON(e),"PRIVATE")),pr(gg,o2,s),pr(gg,o2,"esm2020"),pr("fire-js","")}BN("");function U_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const zN=U_,B_=new Ho("auth","Firebase",U_());const Id=new ny("@firebase/auth");function FN(s,...e){Id.logLevel<=$t.WARN&&Id.warn(`Auth (${Wo}): ${s}`,...e)}function vd(s,...e){Id.logLevel<=$t.ERROR&&Id.error(`Auth (${Wo}): ${s}`,...e)}function oi(s,...e){throw iy(s,...e)}function Ti(s,...e){return iy(s,...e)}function z_(s,e,t){const i={...zN(),[e]:t};return new Ho("auth","Firebase",i).create(e,{appName:s.name})}function na(s){return z_(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function iy(s,...e){if(typeof s!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=s.name),s._errorFactory.create(t,...i)}return B_.create(s,...e)}function wt(s,e,...t){if(!s)throw iy(e,...t)}function Ji(s){const e="INTERNAL ASSERTION FAILED: "+s;throw vd(e),new Error(e)}function oa(s,e){s||Ji(e)}function bg(){return typeof self<"u"&&self.location?.href||""}function qN(){return d2()==="http:"||d2()==="https:"}function d2(){return typeof self<"u"&&self.location?.protocol||null}function HN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(qN()||xC()||"connection"in navigator)?navigator.onLine:!0}function $N(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}class Cu{constructor(e,t){this.shortDelay=e,this.longDelay=t,oa(t>e,"Short delay should be less than long delay!"),this.isMobile=bC()||EC()}get(){return HN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function ay(s,e){oa(s.emulator,"Emulator should always be set here");const{url:t}=s.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class F_{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ji("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ji("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ji("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const WN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const GN=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],KN=new Cu(3e4,6e4);function ua(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function ha(s,e,t,i,l={}){return q_(s,l,async()=>{let u={},h={};i&&(e==="GET"?h=i:u={body:JSON.stringify(i)});const p=Su({key:s.config.apiKey,...h}).slice(1),g=await s._getAdditionalHeaders();g["Content-Type"]="application/json",s.languageCode&&(g["X-Firebase-Locale"]=s.languageCode);const y={method:e,headers:g,...u};return _C()||(y.referrerPolicy="no-referrer"),s.emulatorConfig&&no(s.emulatorConfig.host)&&(y.credentials="include"),F_.fetch()(await H_(s,s.config.apiHost,t,p),y)})}async function q_(s,e,t){s._canInitEmulator=!1;const i={...WN,...e};try{const l=new QN(s),u=await Promise.race([t(),l.promise]);l.clearNetworkTimeout();const h=await u.json();if("needConfirmation"in h)throw sd(s,"account-exists-with-different-credential",h);if(u.ok&&!("errorMessage"in h))return h;{const p=u.ok?h.errorMessage:h.error.message,[g,y]=p.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw sd(s,"credential-already-in-use",h);if(g==="EMAIL_EXISTS")throw sd(s,"email-already-in-use",h);if(g==="USER_DISABLED")throw sd(s,"user-disabled",h);const b=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw z_(s,b,y);oi(s,b)}}catch(l){if(l instanceof ui)throw l;oi(s,"network-request-failed",{message:String(l)})}}async function Nu(s,e,t,i,l={}){const u=await ha(s,e,t,i,l);return"mfaPendingCredential"in u&&oi(s,"multi-factor-auth-required",{_serverResponse:u}),u}async function H_(s,e,t,i){const l=`${e}${t}?${i}`,u=s,h=u.config.emulator?ay(s.config,l):`${s.config.apiScheme}://${l}`;return GN.includes(t)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(h).toString():h}function YN(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class QN{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Ti(this.auth,"network-request-failed")),KN.get())})}}function sd(s,e,t){const i={appName:s.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const l=Ti(s,e,i);return l.customData._tokenResponse=t,l}function f2(s){return s!==void 0&&s.enterprise!==void 0}class XN{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return YN(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function JN(s,e){return ha(s,"GET","/v2/recaptchaConfig",ua(s,e))}async function ZN(s,e){return ha(s,"POST","/v1/accounts:delete",e)}async function Dd(s,e){return ha(s,"POST","/v1/accounts:lookup",e)}function su(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function eA(s,e=!1){const t=pn(s),i=await t.getIdToken(e),l=oy(i);wt(l&&l.exp&&l.auth_time&&l.iat,t.auth,"internal-error");const u=typeof l.firebase=="object"?l.firebase:void 0,h=u?.sign_in_provider;return{claims:l,token:i,authTime:su(Op(l.auth_time)),issuedAtTime:su(Op(l.iat)),expirationTime:su(Op(l.exp)),signInProvider:h||null,signInSecondFactor:u?.sign_in_second_factor||null}}function Op(s){return Number(s)*1e3}function oy(s){const[e,t,i]=s.split(".");if(e===void 0||t===void 0||i===void 0)return vd("JWT malformed, contained fewer than 3 sections"),null;try{const l=j_(t);return l?JSON.parse(l):(vd("Failed to decode base64 JWT payload"),null)}catch(l){return vd("Caught error parsing JWT payload as JSON",l?.toString()),null}}function m2(s){const e=oy(s);return wt(e,"internal-error"),wt(typeof e.exp<"u","internal-error"),wt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function hu(s,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof ui&&tA(i)&&s.auth.currentUser===s&&await s.auth.signOut(),i}}function tA({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}class nA{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class wg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=su(this.lastLoginAt),this.creationTime=su(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Md(s){const e=s.auth,t=await s.getIdToken(),i=await hu(s,Dd(e,{idToken:t}));wt(i?.users.length,e,"internal-error");const l=i.users[0];s._notifyReloadListener(l);const u=l.providerUserInfo?.length?$_(l.providerUserInfo):[],h=rA(s.providerData,u),p=s.isAnonymous,g=!(s.email&&l.passwordHash)&&!h?.length,y=p?g:!1,b={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:h,metadata:new wg(l.createdAt,l.lastLoginAt),isAnonymous:y};Object.assign(s,b)}async function sA(s){const e=pn(s);await Md(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function rA(s,e){return[...s.filter(i=>!e.some(l=>l.providerId===i.providerId)),...e]}function $_(s){return s.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function iA(s,e){const t=await q_(s,{},async()=>{const i=Su({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:l,apiKey:u}=s.config,h=await H_(s,l,"/v1/token",`key=${u}`),p=await s._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:p,body:i};return s.emulatorConfig&&no(s.emulatorConfig.host)&&(g.credentials="include"),F_.fetch()(h,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function aA(s,e){return ha(s,"POST","/v2/accounts:revokeToken",ua(s,e))}class Ol{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){wt(e.idToken,"internal-error"),wt(typeof e.idToken<"u","internal-error"),wt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):m2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){wt(e.length!==0,"internal-error");const t=m2(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(wt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:l,expiresIn:u}=await iA(e,t);this.updateTokensAndExpiration(i,l,Number(u))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:l,expirationTime:u}=t,h=new Ol;return i&&(wt(typeof i=="string","internal-error",{appName:e}),h.refreshToken=i),l&&(wt(typeof l=="string","internal-error",{appName:e}),h.accessToken=l),u&&(wt(typeof u=="number","internal-error",{appName:e}),h.expirationTime=u),h}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ol,this.toJSON())}_performRefresh(){return Ji("not implemented")}}function Va(s,e){wt(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class si{constructor({uid:e,auth:t,stsTokenManager:i,...l}){this.providerId="firebase",this.proactiveRefresh=new nA(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new wg(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await hu(this,this.stsTokenManager.getToken(this.auth,e));return wt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return eA(this,e)}reload(){return sA(this)}_assign(e){this!==e&&(wt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new si({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){wt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Md(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Sr(this.auth.app))return Promise.reject(na(this.auth));const e=await this.getIdToken();return await hu(this,ZN(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,l=t.email??void 0,u=t.phoneNumber??void 0,h=t.photoURL??void 0,p=t.tenantId??void 0,g=t._redirectEventId??void 0,y=t.createdAt??void 0,b=t.lastLoginAt??void 0,{uid:E,emailVerified:T,isAnonymous:O,providerData:H,stsTokenManager:q}=t;wt(E&&q,e,"internal-error");const B=Ol.fromJSON(this.name,q);wt(typeof E=="string",e,"internal-error"),Va(i,e.name),Va(l,e.name),wt(typeof T=="boolean",e,"internal-error"),wt(typeof O=="boolean",e,"internal-error"),Va(u,e.name),Va(h,e.name),Va(p,e.name),Va(g,e.name),Va(y,e.name),Va(b,e.name);const X=new si({uid:E,auth:e,email:l,emailVerified:T,displayName:i,isAnonymous:O,photoURL:h,phoneNumber:u,tenantId:p,stsTokenManager:B,createdAt:y,lastLoginAt:b});return H&&Array.isArray(H)&&(X.providerData=H.map(W=>({...W}))),g&&(X._redirectEventId=g),X}static async _fromIdTokenResponse(e,t,i=!1){const l=new Ol;l.updateFromServerResponse(t);const u=new si({uid:t.localId,auth:e,stsTokenManager:l,isAnonymous:i});return await Md(u),u}static async _fromGetAccountInfoResponse(e,t,i){const l=t.users[0];wt(l.localId!==void 0,"internal-error");const u=l.providerUserInfo!==void 0?$_(l.providerUserInfo):[],h=!(l.email&&l.passwordHash)&&!u?.length,p=new Ol;p.updateFromIdToken(i);const g=new si({uid:l.localId,auth:e,stsTokenManager:p,isAnonymous:h}),y={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:u,metadata:new wg(l.createdAt,l.lastLoginAt),isAnonymous:!(l.email&&l.passwordHash)&&!u?.length};return Object.assign(g,y),g}}const p2=new Map;function Zi(s){oa(s instanceof Function,"Expected a class definition");let e=p2.get(s);return e?(oa(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,p2.set(s,e),e)}class W_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}W_.type="NONE";const g2=W_;function bd(s,e,t){return`firebase:${s}:${e}:${t}`}class Pl{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:l,name:u}=this.auth;this.fullUserKey=bd(this.userKey,l.apiKey,u),this.fullPersistenceKey=bd("persistence",l.apiKey,u),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Dd(this.auth,{idToken:e}).catch(()=>{});return t?si._fromGetAccountInfoResponse(this.auth,t,e):null}return si._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Pl(Zi(g2),e,i);const l=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let u=l[0]||Zi(g2);const h=bd(i,e.config.apiKey,e.name);let p=null;for(const y of t)try{const b=await y._get(h);if(b){let E;if(typeof b=="string"){const T=await Dd(e,{idToken:b}).catch(()=>{});if(!T)break;E=await si._fromGetAccountInfoResponse(e,T,b)}else E=si._fromJSON(e,b);y!==u&&(p=E),u=y;break}}catch{}const g=l.filter(y=>y._shouldAllowMigration);return!u._shouldAllowMigration||!g.length?new Pl(u,e,i):(u=g[0],p&&await u._set(h,p.toJSON()),await Promise.all(t.map(async y=>{if(y!==u)try{await y._remove(h)}catch{}})),new Pl(u,e,i))}}function y2(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Q_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(G_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(J_(e))return"Blackberry";if(Z_(e))return"Webos";if(K_(e))return"Safari";if((e.includes("chrome/")||Y_(e))&&!e.includes("edge/"))return"Chrome";if(X_(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=s.match(t);if(i?.length===2)return i[1]}return"Other"}function G_(s=Ws()){return/firefox\//i.test(s)}function K_(s=Ws()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Y_(s=Ws()){return/crios\//i.test(s)}function Q_(s=Ws()){return/iemobile/i.test(s)}function X_(s=Ws()){return/android/i.test(s)}function J_(s=Ws()){return/blackberry/i.test(s)}function Z_(s=Ws()){return/webos/i.test(s)}function ly(s=Ws()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function oA(s=Ws()){return ly(s)&&!!window.navigator?.standalone}function lA(){return TC()&&document.documentMode===10}function ex(s=Ws()){return ly(s)||X_(s)||Z_(s)||J_(s)||/windows phone/i.test(s)||Q_(s)}function tx(s,e=[]){let t;switch(s){case"Browser":t=y2(Ws());break;case"Worker":t=`${y2(Ws())}-${s}`;break;default:t=s}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Wo}/${i}`}class cA{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=u=>new Promise((h,p)=>{try{const g=e(u);h(g)}catch(g){p(g)}});i.onAbort=t,this.queue.push(i);const l=this.queue.length-1;return()=>{this.queue[l]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const l of t)try{l()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function uA(s,e={}){return ha(s,"GET","/v2/passwordPolicy",ua(s,e))}const hA=6;class dA{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??hA,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,l=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),l&&(t.meetsMaxPasswordLength=e.length<=l)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let l=0;l<e.length;l++)i=e.charAt(l),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,l,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=l)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}class fA{constructor(e,t,i,l){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new v2(this),this.idTokenSubscription=new v2(this),this.beforeStateQueue=new cA(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=B_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=l.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Zi(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Pl.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Dd(this,{idToken:e}),i=await si._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Sr(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(h=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(h,h))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,h=i?._redirectEventId,p=await this.tryRedirectSignIn(e);(!u||u===h)&&p?.user&&(i=p.user,l=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return wt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Md(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=$N()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Sr(this.app))return Promise.reject(na(this));const t=e?pn(e):null;return t&&wt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&wt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Sr(this.app)?Promise.reject(na(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Sr(this.app)?Promise.reject(na(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Zi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await uA(this),t=new dA(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ho("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await aA(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Zi(e)||this._popupRedirectResolver;wt(t,this,"argument-error"),this.redirectPersistenceManager=await Pl.create(this,[Zi(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,l){if(this._deleted)return()=>{};const u=typeof t=="function"?t:t.next.bind(t);let h=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(wt(p,this,"internal-error"),p.then(()=>{h||u(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,i,l);return()=>{h=!0,g()}}else{const g=e.addObserver(t);return()=>{h=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return wt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=tx(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Sr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&FN(`Error while retrieving App Check token: ${e.error}`),e?.token}}function so(s){return pn(s)}class v2{constructor(e){this.auth=e,this.observer=null,this.addObserver=RC(t=>this.observer=t)}get next(){return wt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let tf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function mA(s){tf=s}function nx(s){return tf.loadJS(s)}function pA(){return tf.recaptchaEnterpriseScript}function gA(){return tf.gapiScript}function yA(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class vA{constructor(){this.enterprise=new bA}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class bA{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const wA="recaptcha-enterprise",sx="NO_RECAPTCHA";class _A{constructor(e){this.type=wA,this.auth=so(e)}async verify(e="verify",t=!1){async function i(u){if(!t){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(h,p)=>{JN(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const y=new XN(g);return u.tenantId==null?u._agentRecaptchaConfig=y:u._tenantRecaptchaConfigs[u.tenantId]=y,h(y.siteKey)}}).catch(g=>{p(g)})})}function l(u,h,p){const g=window.grecaptcha;f2(g)?g.enterprise.ready(()=>{g.enterprise.execute(u,{action:e}).then(y=>{h(y)}).catch(()=>{h(sx)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new vA().execute("siteKey",{action:"verify"}):new Promise((u,h)=>{i(this.auth).then(p=>{if(!t&&f2(window.grecaptcha))l(p,u,h);else{if(typeof window>"u"){h(new Error("RecaptchaVerifier is only supported in browser"));return}let g=pA();g.length!==0&&(g+=p),nx(g).then(()=>{l(p,u,h)}).catch(y=>{h(y)})}}).catch(p=>{h(p)})})}}async function b2(s,e,t,i=!1,l=!1){const u=new _A(s);let h;if(l)h=sx;else try{h=await u.verify(t)}catch{h=await u.verify(t,!0)}const p={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const g=p.phoneEnrollmentInfo.phoneNumber,y=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:y,captchaResponse:h,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const g=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:h,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return i?Object.assign(p,{captchaResp:h}):Object.assign(p,{captchaResponse:h}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function Ld(s,e,t,i,l){if(s._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await b2(s,e,t,t==="getOobCode");return i(s,u)}else return i(s,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const h=await b2(s,e,t,t==="getOobCode");return i(s,h)}else return Promise.reject(u)})}function xA(s,e){const t=$o(s,"auth");if(t.isInitialized()){const l=t.getImmediate(),u=t.getOptions();if(ia(u,e??{}))return l;oi(l,"already-initialized")}return t.initialize({options:e})}function EA(s,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(Zi);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(i,e?.popupRedirectResolver)}function TA(s,e,t){const i=so(s);wt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const l=!1,u=rx(e),{host:h,port:p}=kA(e),g=p===null?"":`:${p}`,y={url:`${u}//${h}${g}/`},b=Object.freeze({host:h,port:p,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!i._canInitEmulator){wt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),wt(ia(y,i.config.emulator)&&ia(b,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=y,i.emulatorConfig=b,i.settings.appVerificationDisabledForTesting=!0,no(h)?(ey(`${u}//${h}${g}`),ty("Auth",!0)):SA()}function rx(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function kA(s){const e=rx(s),t=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",l=/^(\[[^\]]+\])(:|$)/.exec(i);if(l){const u=l[1];return{host:u,port:w2(i.substr(u.length+1))}}else{const[u,h]=i.split(":");return{host:u,port:w2(h)}}}function w2(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function SA(){function s(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}class cy{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ji("not implemented")}_getIdTokenResponse(e){return Ji("not implemented")}_linkToIdToken(e,t){return Ji("not implemented")}_getReauthenticationResolver(e){return Ji("not implemented")}}async function jA(s,e){return ha(s,"POST","/v1/accounts:signUp",e)}async function CA(s,e){return Nu(s,"POST","/v1/accounts:signInWithPassword",ua(s,e))}async function ix(s,e){return ha(s,"POST","/v1/accounts:sendOobCode",ua(s,e))}async function NA(s,e){return ix(s,e)}async function AA(s,e){return ix(s,e)}async function RA(s,e){return Nu(s,"POST","/v1/accounts:signInWithEmailLink",ua(s,e))}async function IA(s,e){return Nu(s,"POST","/v1/accounts:signInWithEmailLink",ua(s,e))}class du extends cy{constructor(e,t,i,l=null){super("password",i),this._email=e,this._password=t,this._tenantId=l}static _fromEmailAndPassword(e,t){return new du(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new du(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ld(e,t,"signInWithPassword",CA);case"emailLink":return RA(e,{email:this._email,oobCode:this._password});default:oi(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ld(e,i,"signUpPassword",jA);case"emailLink":return IA(e,{idToken:t,email:this._email,oobCode:this._password});default:oi(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Vl(s,e){return Nu(s,"POST","/v1/accounts:signInWithIdp",ua(s,e))}const DA="http://localhost";class Oo extends cy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Oo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):oi("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:l,...u}=t;if(!i||!l)return null;const h=new Oo(i,l);return h.idToken=u.idToken||void 0,h.accessToken=u.accessToken||void 0,h.secret=u.secret,h.nonce=u.nonce,h.pendingToken=u.pendingToken||null,h}_getIdTokenResponse(e){const t=this.buildRequest();return Vl(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Vl(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Vl(e,t)}buildRequest(){const e={requestUri:DA,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Su(t)}return e}}function MA(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function LA(s){const e=Qc(Xc(s)).link,t=e?Qc(Xc(e)).deep_link_id:null,i=Qc(Xc(s)).deep_link_id;return(i?Qc(Xc(i)).link:null)||i||t||e||s}class uy{constructor(e){const t=Qc(Xc(e)),i=t.apiKey??null,l=t.oobCode??null,u=MA(t.mode??null);wt(i&&l&&u,"argument-error"),this.apiKey=i,this.operation=u,this.code=l,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=LA(e);try{return new uy(t)}catch{return null}}}class Jl{constructor(){this.providerId=Jl.PROVIDER_ID}static credential(e,t){return du._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=uy.parseLink(t);return wt(i,"argument-error"),du._fromEmailAndCode(e,i.code,i.tenantId)}}Jl.PROVIDER_ID="password";Jl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Jl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class ax{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Au extends ax{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ua extends Au{constructor(){super("facebook.com")}static credential(e){return Oo._fromParams({providerId:Ua.PROVIDER_ID,signInMethod:Ua.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ua.credentialFromTaggedObject(e)}static credentialFromError(e){return Ua.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ua.credential(e.oauthAccessToken)}catch{return null}}}Ua.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ua.PROVIDER_ID="facebook.com";class Ba extends Au{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Oo._fromParams({providerId:Ba.PROVIDER_ID,signInMethod:Ba.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ba.credentialFromTaggedObject(e)}static credentialFromError(e){return Ba.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Ba.credential(t,i)}catch{return null}}}Ba.GOOGLE_SIGN_IN_METHOD="google.com";Ba.PROVIDER_ID="google.com";class za extends Au{constructor(){super("github.com")}static credential(e){return Oo._fromParams({providerId:za.PROVIDER_ID,signInMethod:za.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return za.credentialFromTaggedObject(e)}static credentialFromError(e){return za.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return za.credential(e.oauthAccessToken)}catch{return null}}}za.GITHUB_SIGN_IN_METHOD="github.com";za.PROVIDER_ID="github.com";class Fa extends Au{constructor(){super("twitter.com")}static credential(e,t){return Oo._fromParams({providerId:Fa.PROVIDER_ID,signInMethod:Fa.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Fa.credentialFromTaggedObject(e)}static credentialFromError(e){return Fa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Fa.credential(t,i)}catch{return null}}}Fa.TWITTER_SIGN_IN_METHOD="twitter.com";Fa.PROVIDER_ID="twitter.com";async function OA(s,e){return Nu(s,"POST","/v1/accounts:signUp",ua(s,e))}class Po{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,l=!1){const u=await si._fromIdTokenResponse(e,i,l),h=_2(i);return new Po({user:u,providerId:h,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const l=_2(i);return new Po({user:e,providerId:l,_tokenResponse:i,operationType:t})}}function _2(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}class Od extends ui{constructor(e,t,i,l){super(t.code,t.message),this.operationType=i,this.user=l,Object.setPrototypeOf(this,Od.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,l){return new Od(e,t,i,l)}}function ox(s,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(s):t._getIdTokenResponse(s)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?Od._fromErrorAndOperation(s,u,e,i):u})}async function PA(s,e,t=!1){const i=await hu(s,e._linkToIdToken(s.auth,await s.getIdToken()),t);return Po._forOperation(s,"link",i)}async function VA(s,e,t=!1){const{auth:i}=s;if(Sr(i.app))return Promise.reject(na(i));const l="reauthenticate";try{const u=await hu(s,ox(i,l,e,s),t);wt(u.idToken,i,"internal-error");const h=oy(u.idToken);wt(h,i,"internal-error");const{sub:p}=h;return wt(s.uid===p,i,"user-mismatch"),Po._forOperation(s,l,u)}catch(u){throw u?.code==="auth/user-not-found"&&oi(i,"user-mismatch"),u}}async function lx(s,e,t=!1){if(Sr(s.app))return Promise.reject(na(s));const i="signIn",l=await ox(s,i,e),u=await Po._fromIdTokenResponse(s,i,l);return t||await s._updateCurrentUser(u.user),u}async function UA(s,e){return lx(so(s),e)}async function cx(s){const e=so(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function BA(s,e,t){const i=so(s);await Ld(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",AA)}async function zA(s,e,t){if(Sr(s.app))return Promise.reject(na(s));const i=so(s),h=await Ld(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",OA).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&cx(s),g}),p=await Po._fromIdTokenResponse(i,"signIn",h);return await i._updateCurrentUser(p.user),p}function FA(s,e,t){return Sr(s.app)?Promise.reject(na(s)):UA(pn(s),Jl.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&cx(s),i})}async function Z5(s,e){const t=pn(s),l={requestType:"VERIFY_EMAIL",idToken:await s.getIdToken()},{email:u}=await NA(t.auth,l);u!==s.email&&await s.reload()}function x2(s,e){return pn(s).setPersistence(e)}function qA(s,e,t,i){return pn(s).onIdTokenChanged(e,t,i)}function HA(s,e,t){return pn(s).beforeAuthStateChanged(e,t)}function $A(s,e,t,i){return pn(s).onAuthStateChanged(e,t,i)}function WA(s){return pn(s).signOut()}const Pd="__sak";class ux{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Pd,"1"),this.storage.removeItem(Pd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const GA=1e3,KA=10;class hx extends ux{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ex(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),l=this.localCache[t];i!==l&&e(t,l,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((h,p,g)=>{this.notifyListeners(h,g)});return}const i=e.key;t?this.detachListener():this.stopPolling();const l=()=>{const h=this.storage.getItem(i);!t&&this.localCache[i]===h||this.notifyListeners(i,h)},u=this.storage.getItem(i);lA()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(l,KA):l()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},GA)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}hx.type="LOCAL";const _g=hx;class dx extends ux{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}dx.type="SESSION";const hy=dx;function YA(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class nf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(l=>l.isListeningto(e));if(t)return t;const i=new nf(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:l,data:u}=t.data,h=this.handlersMap[l];if(!h?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:l});const p=Array.from(h).map(async y=>y(t.origin,u)),g=await YA(p);t.ports[0].postMessage({status:"done",eventId:i,eventType:l,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}nf.receivers=[];function dy(s="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return s+t}class QA{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const l=typeof MessageChannel<"u"?new MessageChannel:null;if(!l)throw new Error("connection_unavailable");let u,h;return new Promise((p,g)=>{const y=dy("",20);l.port1.start();const b=setTimeout(()=>{g(new Error("unsupported_event"))},i);h={messageChannel:l,onMessage(E){const T=E;if(T.data.eventId===y)switch(T.data.status){case"ack":clearTimeout(b),u=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),p(T.data.response);break;default:clearTimeout(b),clearTimeout(u),g(new Error("invalid_response"));break}}},this.handlers.add(h),l.port1.addEventListener("message",h.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[l.port2])}).finally(()=>{h&&this.removeMessageHandler(h)})}}function ki(){return window}function XA(s){ki().location.href=s}function fx(){return typeof ki().WorkerGlobalScope<"u"&&typeof ki().importScripts=="function"}async function JA(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function ZA(){return navigator?.serviceWorker?.controller||null}function eR(){return fx()?self:null}const mx="firebaseLocalStorageDb",tR=1,Vd="firebaseLocalStorage",px="fbase_key";class Ru{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function sf(s,e){return s.transaction([Vd],e?"readwrite":"readonly").objectStore(Vd)}function nR(){const s=indexedDB.deleteDatabase(mx);return new Ru(s).toPromise()}function xg(){const s=indexedDB.open(mx,tR);return new Promise((e,t)=>{s.addEventListener("error",()=>{t(s.error)}),s.addEventListener("upgradeneeded",()=>{const i=s.result;try{i.createObjectStore(Vd,{keyPath:px})}catch(l){t(l)}}),s.addEventListener("success",async()=>{const i=s.result;i.objectStoreNames.contains(Vd)?e(i):(i.close(),await nR(),e(await xg()))})})}async function E2(s,e,t){const i=sf(s,!0).put({[px]:e,value:t});return new Ru(i).toPromise()}async function sR(s,e){const t=sf(s,!1).get(e),i=await new Ru(t).toPromise();return i===void 0?null:i.value}function T2(s,e){const t=sf(s,!0).delete(e);return new Ru(t).toPromise()}const rR=800,iR=3;class gx{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await xg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>iR)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return fx()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=nf._getInstance(eR()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await JA(),!this.activeServiceWorker)return;this.sender=new QA(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||ZA()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await xg();return await E2(e,Pd,"1"),await T2(e,Pd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>E2(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>sR(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>T2(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(l=>{const u=sf(l,!1).getAll();return new Ru(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:l,value:u}of e)i.add(l),JSON.stringify(this.localCache[l])!==JSON.stringify(u)&&(this.notifyListeners(l,u),t.push(l));for(const l of Object.keys(this.localCache))this.localCache[l]&&!i.has(l)&&(this.notifyListeners(l,null),t.push(l));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),rR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}gx.type="LOCAL";const aR=gx;new Cu(3e4,6e4);function oR(s,e){return e?Zi(e):(wt(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}class fy extends cy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Vl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Vl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Vl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function lR(s){return lx(s.auth,new fy(s),s.bypassAuthState)}function cR(s){const{auth:e,user:t}=s;return wt(t,e,"internal-error"),VA(t,new fy(s),s.bypassAuthState)}async function uR(s){const{auth:e,user:t}=s;return wt(t,e,"internal-error"),PA(t,new fy(s),s.bypassAuthState)}class yx{constructor(e,t,i,l,u=!1){this.auth=e,this.resolver=i,this.user=l,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:l,tenantId:u,error:h,type:p}=e;if(h){this.reject(h);return}const g={auth:this.auth,requestUri:t,sessionId:i,tenantId:u||void 0,postBody:l||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(g))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return lR;case"linkViaPopup":case"linkViaRedirect":return uR;case"reauthViaPopup":case"reauthViaRedirect":return cR;default:oi(this.auth,"internal-error")}}resolve(e){oa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){oa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const hR=new Cu(2e3,1e4);class Ll extends yx{constructor(e,t,i,l,u){super(e,t,l,u),this.provider=i,this.authWindow=null,this.pollId=null,Ll.currentPopupAction&&Ll.currentPopupAction.cancel(),Ll.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return wt(e,this.auth,"internal-error"),e}async onExecution(){oa(this.filter.length===1,"Popup operations only handle one event");const e=dy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ti(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ti(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ll.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ti(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,hR.get())};e()}}Ll.currentPopupAction=null;const dR="pendingRedirect",wd=new Map;class fR extends yx{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=wd.get(this.auth._key());if(!e){try{const i=await mR(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}wd.set(this.auth._key(),e)}return this.bypassAuthState||wd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function mR(s,e){const t=yR(e),i=gR(s);if(!await i._isAvailable())return!1;const l=await i._get(t)==="true";return await i._remove(t),l}function pR(s,e){wd.set(s._key(),e)}function gR(s){return Zi(s._redirectPersistence)}function yR(s){return bd(dR,s.config.apiKey,s.name)}async function vR(s,e,t=!1){if(Sr(s.app))return Promise.reject(na(s));const i=so(s),l=oR(i,e),h=await new fR(i,l,t).execute();return h&&!t&&(delete h.user._redirectEventId,await i._persistUserIfCurrent(h.user),await i._setRedirectUser(null,e)),h}const bR=600*1e3;class wR{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!_R(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!vx(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Ti(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=bR&&this.cachedEventUids.clear(),this.cachedEventUids.has(k2(e))}saveEventToCache(e){this.cachedEventUids.add(k2(e)),this.lastProcessedEventTime=Date.now()}}function k2(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function vx({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function _R(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return vx(s);default:return!1}}async function xR(s,e={}){return ha(s,"GET","/v1/projects",e)}const ER=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,TR=/^https?/;async function kR(s){if(s.config.emulator)return;const{authorizedDomains:e}=await xR(s);for(const t of e)try{if(SR(t))return}catch{}oi(s,"unauthorized-domain")}function SR(s){const e=bg(),{protocol:t,hostname:i}=new URL(e);if(s.startsWith("chrome-extension://")){const h=new URL(s);return h.hostname===""&&i===""?t==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&h.hostname===i}if(!TR.test(t))return!1;if(ER.test(s))return i===s;const l=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(i)}const jR=new Cu(3e4,6e4);function S2(){const s=ki().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let t=0;t<s.CP.length;t++)s.CP[t]=null}}function CR(s){return new Promise((e,t)=>{function i(){S2(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{S2(),t(Ti(s,"network-request-failed"))},timeout:jR.get()})}if(ki().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(ki().gapi?.load)i();else{const l=yA("iframefcb");return ki()[l]=()=>{gapi.load?i():t(Ti(s,"network-request-failed"))},nx(`${gA()}?onload=${l}`).catch(u=>t(u))}}).catch(e=>{throw _d=null,e})}let _d=null;function NR(s){return _d=_d||CR(s),_d}const AR=new Cu(5e3,15e3),RR="__/auth/iframe",IR="emulator/auth/iframe",DR={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},MR=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function LR(s){const e=s.config;wt(e.authDomain,s,"auth-domain-config-required");const t=e.emulator?ay(e,IR):`https://${s.config.authDomain}/${RR}`,i={apiKey:e.apiKey,appName:s.name,v:Wo},l=MR.get(s.config.apiHost);l&&(i.eid=l);const u=s._getFrameworks();return u.length&&(i.fw=u.join(",")),`${t}?${Su(i).slice(1)}`}async function OR(s){const e=await NR(s),t=ki().gapi;return wt(t,s,"internal-error"),e.open({where:document.body,url:LR(s),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:DR,dontclear:!0},i=>new Promise(async(l,u)=>{await i.restyle({setHideOnLeave:!1});const h=Ti(s,"network-request-failed"),p=ki().setTimeout(()=>{u(h)},AR.get());function g(){ki().clearTimeout(p),l(i)}i.ping(g).then(g,()=>{u(h)})}))}const PR={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},VR=500,UR=600,BR="_blank",zR="http://localhost";class j2{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function FR(s,e,t,i=VR,l=UR){const u=Math.max((window.screen.availHeight-l)/2,0).toString(),h=Math.max((window.screen.availWidth-i)/2,0).toString();let p="";const g={...PR,width:i.toString(),height:l.toString(),top:u,left:h},y=Ws().toLowerCase();t&&(p=Y_(y)?BR:t),G_(y)&&(e=e||zR,g.scrollbars="yes");const b=Object.entries(g).reduce((T,[O,H])=>`${T}${O}=${H},`,"");if(oA(y)&&p!=="_self")return qR(e||"",p),new j2(null);const E=window.open(e||"",p,b);wt(E,s,"popup-blocked");try{E.focus()}catch{}return new j2(E)}function qR(s,e){const t=document.createElement("a");t.href=s,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const HR="__/auth/handler",$R="emulator/auth/handler",WR=encodeURIComponent("fac");async function C2(s,e,t,i,l,u){wt(s.config.authDomain,s,"auth-domain-config-required"),wt(s.config.apiKey,s,"invalid-api-key");const h={apiKey:s.config.apiKey,appName:s.name,authType:t,redirectUrl:i,v:Wo,eventId:l};if(e instanceof ax){e.setDefaultLanguage(s.languageCode),h.providerId=e.providerId||"",AC(e.getCustomParameters())||(h.customParameters=JSON.stringify(e.getCustomParameters()));for(const[b,E]of Object.entries({}))h[b]=E}if(e instanceof Au){const b=e.getScopes().filter(E=>E!=="");b.length>0&&(h.scopes=b.join(","))}s.tenantId&&(h.tid=s.tenantId);const p=h;for(const b of Object.keys(p))p[b]===void 0&&delete p[b];const g=await s._getAppCheckToken(),y=g?`#${WR}=${encodeURIComponent(g)}`:"";return`${GR(s)}?${Su(p).slice(1)}${y}`}function GR({config:s}){return s.emulator?ay(s,$R):`https://${s.authDomain}/${HR}`}const Pp="webStorageSupport";class KR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=hy,this._completeRedirectFn=vR,this._overrideRedirectResult=pR}async _openPopup(e,t,i,l){oa(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await C2(e,t,i,bg(),l);return FR(e,u,dy())}async _openRedirect(e,t,i,l){await this._originValidation(e);const u=await C2(e,t,i,bg(),l);return XA(u),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:l,promise:u}=this.eventManagers[t];return l?Promise.resolve(l):(oa(u,"If manager is not set, promise should be"),u)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await OR(e),i=new wR(e);return t.register("authEvent",l=>(wt(l?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(l.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Pp,{type:Pp},l=>{const u=l?.[0]?.[Pp];u!==void 0&&t(!!u),oi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=kR(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ex()||K_()||ly()}}const YR=KR;var N2="@firebase/auth",A2="1.12.0";class QR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){wt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function XR(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function JR(s){ai(new Yr("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),l=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:h,authDomain:p}=i.options;wt(h&&!h.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:h,authDomain:p,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:tx(s)},y=new fA(i,l,u,g);return EA(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),ai(new Yr("auth-internal",e=>{const t=so(e.getProvider("auth").getImmediate());return(i=>new QR(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),pr(N2,A2,XR(s)),pr(N2,A2,"esm2020")}const ZR=300,e4=R_("authIdTokenMaxAge")||ZR;let R2=null;const t4=s=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>e4)return;const l=t?.token;R2!==l&&(R2=l,await fetch(s,{method:l?"POST":"DELETE",headers:l?{Authorization:`Bearer ${l}`}:{}}))};function bx(s=ju()){const e=$o(s,"auth");if(e.isInitialized())return e.getImmediate();const t=xA(s,{popupRedirectResolver:YR,persistence:[aR,_g,hy]}),i=R_("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(i,location.origin);if(location.origin===u.origin){const h=t4(u.toString());HA(t,h,()=>h(t.currentUser)),qA(t,p=>h(p))}}const l=C_("auth");return l&&TA(t,`http://${l}`),t}function n4(){return document.getElementsByTagName("head")?.[0]??document}mA({loadJS(s){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",s),i.onload=e,i.onerror=l=>{const u=Ti("internal-error");u.customData=l,t(u)},i.type="text/javascript",i.charset="UTF-8",n4().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});JR("Browser");var I2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Ka,wx;(function(){var s;function e(j,S){function I(){}I.prototype=S.prototype,j.F=S.prototype,j.prototype=new I,j.prototype.constructor=j,j.D=function(V,D,M){for(var A=Array(arguments.length-2),Be=2;Be<arguments.length;Be++)A[Be-2]=arguments[Be];return S.prototype[D].apply(V,A)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function l(j,S,I){I||(I=0);const V=Array(16);if(typeof S=="string")for(var D=0;D<16;++D)V[D]=S.charCodeAt(I++)|S.charCodeAt(I++)<<8|S.charCodeAt(I++)<<16|S.charCodeAt(I++)<<24;else for(D=0;D<16;++D)V[D]=S[I++]|S[I++]<<8|S[I++]<<16|S[I++]<<24;S=j.g[0],I=j.g[1],D=j.g[2];let M=j.g[3],A;A=S+(M^I&(D^M))+V[0]+3614090360&4294967295,S=I+(A<<7&4294967295|A>>>25),A=M+(D^S&(I^D))+V[1]+3905402710&4294967295,M=S+(A<<12&4294967295|A>>>20),A=D+(I^M&(S^I))+V[2]+606105819&4294967295,D=M+(A<<17&4294967295|A>>>15),A=I+(S^D&(M^S))+V[3]+3250441966&4294967295,I=D+(A<<22&4294967295|A>>>10),A=S+(M^I&(D^M))+V[4]+4118548399&4294967295,S=I+(A<<7&4294967295|A>>>25),A=M+(D^S&(I^D))+V[5]+1200080426&4294967295,M=S+(A<<12&4294967295|A>>>20),A=D+(I^M&(S^I))+V[6]+2821735955&4294967295,D=M+(A<<17&4294967295|A>>>15),A=I+(S^D&(M^S))+V[7]+4249261313&4294967295,I=D+(A<<22&4294967295|A>>>10),A=S+(M^I&(D^M))+V[8]+1770035416&4294967295,S=I+(A<<7&4294967295|A>>>25),A=M+(D^S&(I^D))+V[9]+2336552879&4294967295,M=S+(A<<12&4294967295|A>>>20),A=D+(I^M&(S^I))+V[10]+4294925233&4294967295,D=M+(A<<17&4294967295|A>>>15),A=I+(S^D&(M^S))+V[11]+2304563134&4294967295,I=D+(A<<22&4294967295|A>>>10),A=S+(M^I&(D^M))+V[12]+1804603682&4294967295,S=I+(A<<7&4294967295|A>>>25),A=M+(D^S&(I^D))+V[13]+4254626195&4294967295,M=S+(A<<12&4294967295|A>>>20),A=D+(I^M&(S^I))+V[14]+2792965006&4294967295,D=M+(A<<17&4294967295|A>>>15),A=I+(S^D&(M^S))+V[15]+1236535329&4294967295,I=D+(A<<22&4294967295|A>>>10),A=S+(D^M&(I^D))+V[1]+4129170786&4294967295,S=I+(A<<5&4294967295|A>>>27),A=M+(I^D&(S^I))+V[6]+3225465664&4294967295,M=S+(A<<9&4294967295|A>>>23),A=D+(S^I&(M^S))+V[11]+643717713&4294967295,D=M+(A<<14&4294967295|A>>>18),A=I+(M^S&(D^M))+V[0]+3921069994&4294967295,I=D+(A<<20&4294967295|A>>>12),A=S+(D^M&(I^D))+V[5]+3593408605&4294967295,S=I+(A<<5&4294967295|A>>>27),A=M+(I^D&(S^I))+V[10]+38016083&4294967295,M=S+(A<<9&4294967295|A>>>23),A=D+(S^I&(M^S))+V[15]+3634488961&4294967295,D=M+(A<<14&4294967295|A>>>18),A=I+(M^S&(D^M))+V[4]+3889429448&4294967295,I=D+(A<<20&4294967295|A>>>12),A=S+(D^M&(I^D))+V[9]+568446438&4294967295,S=I+(A<<5&4294967295|A>>>27),A=M+(I^D&(S^I))+V[14]+3275163606&4294967295,M=S+(A<<9&4294967295|A>>>23),A=D+(S^I&(M^S))+V[3]+4107603335&4294967295,D=M+(A<<14&4294967295|A>>>18),A=I+(M^S&(D^M))+V[8]+1163531501&4294967295,I=D+(A<<20&4294967295|A>>>12),A=S+(D^M&(I^D))+V[13]+2850285829&4294967295,S=I+(A<<5&4294967295|A>>>27),A=M+(I^D&(S^I))+V[2]+4243563512&4294967295,M=S+(A<<9&4294967295|A>>>23),A=D+(S^I&(M^S))+V[7]+1735328473&4294967295,D=M+(A<<14&4294967295|A>>>18),A=I+(M^S&(D^M))+V[12]+2368359562&4294967295,I=D+(A<<20&4294967295|A>>>12),A=S+(I^D^M)+V[5]+4294588738&4294967295,S=I+(A<<4&4294967295|A>>>28),A=M+(S^I^D)+V[8]+2272392833&4294967295,M=S+(A<<11&4294967295|A>>>21),A=D+(M^S^I)+V[11]+1839030562&4294967295,D=M+(A<<16&4294967295|A>>>16),A=I+(D^M^S)+V[14]+4259657740&4294967295,I=D+(A<<23&4294967295|A>>>9),A=S+(I^D^M)+V[1]+2763975236&4294967295,S=I+(A<<4&4294967295|A>>>28),A=M+(S^I^D)+V[4]+1272893353&4294967295,M=S+(A<<11&4294967295|A>>>21),A=D+(M^S^I)+V[7]+4139469664&4294967295,D=M+(A<<16&4294967295|A>>>16),A=I+(D^M^S)+V[10]+3200236656&4294967295,I=D+(A<<23&4294967295|A>>>9),A=S+(I^D^M)+V[13]+681279174&4294967295,S=I+(A<<4&4294967295|A>>>28),A=M+(S^I^D)+V[0]+3936430074&4294967295,M=S+(A<<11&4294967295|A>>>21),A=D+(M^S^I)+V[3]+3572445317&4294967295,D=M+(A<<16&4294967295|A>>>16),A=I+(D^M^S)+V[6]+76029189&4294967295,I=D+(A<<23&4294967295|A>>>9),A=S+(I^D^M)+V[9]+3654602809&4294967295,S=I+(A<<4&4294967295|A>>>28),A=M+(S^I^D)+V[12]+3873151461&4294967295,M=S+(A<<11&4294967295|A>>>21),A=D+(M^S^I)+V[15]+530742520&4294967295,D=M+(A<<16&4294967295|A>>>16),A=I+(D^M^S)+V[2]+3299628645&4294967295,I=D+(A<<23&4294967295|A>>>9),A=S+(D^(I|~M))+V[0]+4096336452&4294967295,S=I+(A<<6&4294967295|A>>>26),A=M+(I^(S|~D))+V[7]+1126891415&4294967295,M=S+(A<<10&4294967295|A>>>22),A=D+(S^(M|~I))+V[14]+2878612391&4294967295,D=M+(A<<15&4294967295|A>>>17),A=I+(M^(D|~S))+V[5]+4237533241&4294967295,I=D+(A<<21&4294967295|A>>>11),A=S+(D^(I|~M))+V[12]+1700485571&4294967295,S=I+(A<<6&4294967295|A>>>26),A=M+(I^(S|~D))+V[3]+2399980690&4294967295,M=S+(A<<10&4294967295|A>>>22),A=D+(S^(M|~I))+V[10]+4293915773&4294967295,D=M+(A<<15&4294967295|A>>>17),A=I+(M^(D|~S))+V[1]+2240044497&4294967295,I=D+(A<<21&4294967295|A>>>11),A=S+(D^(I|~M))+V[8]+1873313359&4294967295,S=I+(A<<6&4294967295|A>>>26),A=M+(I^(S|~D))+V[15]+4264355552&4294967295,M=S+(A<<10&4294967295|A>>>22),A=D+(S^(M|~I))+V[6]+2734768916&4294967295,D=M+(A<<15&4294967295|A>>>17),A=I+(M^(D|~S))+V[13]+1309151649&4294967295,I=D+(A<<21&4294967295|A>>>11),A=S+(D^(I|~M))+V[4]+4149444226&4294967295,S=I+(A<<6&4294967295|A>>>26),A=M+(I^(S|~D))+V[11]+3174756917&4294967295,M=S+(A<<10&4294967295|A>>>22),A=D+(S^(M|~I))+V[2]+718787259&4294967295,D=M+(A<<15&4294967295|A>>>17),A=I+(M^(D|~S))+V[9]+3951481745&4294967295,j.g[0]=j.g[0]+S&4294967295,j.g[1]=j.g[1]+(D+(A<<21&4294967295|A>>>11))&4294967295,j.g[2]=j.g[2]+D&4294967295,j.g[3]=j.g[3]+M&4294967295}i.prototype.v=function(j,S){S===void 0&&(S=j.length);const I=S-this.blockSize,V=this.C;let D=this.h,M=0;for(;M<S;){if(D==0)for(;M<=I;)l(this,j,M),M+=this.blockSize;if(typeof j=="string"){for(;M<S;)if(V[D++]=j.charCodeAt(M++),D==this.blockSize){l(this,V),D=0;break}}else for(;M<S;)if(V[D++]=j[M++],D==this.blockSize){l(this,V),D=0;break}}this.h=D,this.o+=S},i.prototype.A=function(){var j=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);j[0]=128;for(var S=1;S<j.length-8;++S)j[S]=0;S=this.o*8;for(var I=j.length-8;I<j.length;++I)j[I]=S&255,S/=256;for(this.v(j),j=Array(16),S=0,I=0;I<4;++I)for(let V=0;V<32;V+=8)j[S++]=this.g[I]>>>V&255;return j};function u(j,S){var I=p;return Object.prototype.hasOwnProperty.call(I,j)?I[j]:I[j]=S(j)}function h(j,S){this.h=S;const I=[];let V=!0;for(let D=j.length-1;D>=0;D--){const M=j[D]|0;V&&M==S||(I[D]=M,V=!1)}this.g=I}var p={};function g(j){return-128<=j&&j<128?u(j,function(S){return new h([S|0],S<0?-1:0)}):new h([j|0],j<0?-1:0)}function y(j){if(isNaN(j)||!isFinite(j))return E;if(j<0)return B(y(-j));const S=[];let I=1;for(let V=0;j>=I;V++)S[V]=j/I|0,I*=4294967296;return new h(S,0)}function b(j,S){if(j.length==0)throw Error("number format error: empty string");if(S=S||10,S<2||36<S)throw Error("radix out of range: "+S);if(j.charAt(0)=="-")return B(b(j.substring(1),S));if(j.indexOf("-")>=0)throw Error('number format error: interior "-" character');const I=y(Math.pow(S,8));let V=E;for(let M=0;M<j.length;M+=8){var D=Math.min(8,j.length-M);const A=parseInt(j.substring(M,M+D),S);D<8?(D=y(Math.pow(S,D)),V=V.j(D).add(y(A))):(V=V.j(I),V=V.add(y(A)))}return V}var E=g(0),T=g(1),O=g(16777216);s=h.prototype,s.m=function(){if(q(this))return-B(this).m();let j=0,S=1;for(let I=0;I<this.g.length;I++){const V=this.i(I);j+=(V>=0?V:4294967296+V)*S,S*=4294967296}return j},s.toString=function(j){if(j=j||10,j<2||36<j)throw Error("radix out of range: "+j);if(H(this))return"0";if(q(this))return"-"+B(this).toString(j);const S=y(Math.pow(j,6));var I=this;let V="";for(;;){const D=de(I,S).g;I=X(I,D.j(S));let M=((I.g.length>0?I.g[0]:I.h)>>>0).toString(j);if(I=D,H(I))return M+V;for(;M.length<6;)M="0"+M;V=M+V}},s.i=function(j){return j<0?0:j<this.g.length?this.g[j]:this.h};function H(j){if(j.h!=0)return!1;for(let S=0;S<j.g.length;S++)if(j.g[S]!=0)return!1;return!0}function q(j){return j.h==-1}s.l=function(j){return j=X(this,j),q(j)?-1:H(j)?0:1};function B(j){const S=j.g.length,I=[];for(let V=0;V<S;V++)I[V]=~j.g[V];return new h(I,~j.h).add(T)}s.abs=function(){return q(this)?B(this):this},s.add=function(j){const S=Math.max(this.g.length,j.g.length),I=[];let V=0;for(let D=0;D<=S;D++){let M=V+(this.i(D)&65535)+(j.i(D)&65535),A=(M>>>16)+(this.i(D)>>>16)+(j.i(D)>>>16);V=A>>>16,M&=65535,A&=65535,I[D]=A<<16|M}return new h(I,I[I.length-1]&-2147483648?-1:0)};function X(j,S){return j.add(B(S))}s.j=function(j){if(H(this)||H(j))return E;if(q(this))return q(j)?B(this).j(B(j)):B(B(this).j(j));if(q(j))return B(this.j(B(j)));if(this.l(O)<0&&j.l(O)<0)return y(this.m()*j.m());const S=this.g.length+j.g.length,I=[];for(var V=0;V<2*S;V++)I[V]=0;for(V=0;V<this.g.length;V++)for(let D=0;D<j.g.length;D++){const M=this.i(V)>>>16,A=this.i(V)&65535,Be=j.i(D)>>>16,Ze=j.i(D)&65535;I[2*V+2*D]+=A*Ze,W(I,2*V+2*D),I[2*V+2*D+1]+=M*Ze,W(I,2*V+2*D+1),I[2*V+2*D+1]+=A*Be,W(I,2*V+2*D+1),I[2*V+2*D+2]+=M*Be,W(I,2*V+2*D+2)}for(j=0;j<S;j++)I[j]=I[2*j+1]<<16|I[2*j];for(j=S;j<2*S;j++)I[j]=0;return new h(I,0)};function W(j,S){for(;(j[S]&65535)!=j[S];)j[S+1]+=j[S]>>>16,j[S]&=65535,S++}function Y(j,S){this.g=j,this.h=S}function de(j,S){if(H(S))throw Error("division by zero");if(H(j))return new Y(E,E);if(q(j))return S=de(B(j),S),new Y(B(S.g),B(S.h));if(q(S))return S=de(j,B(S)),new Y(B(S.g),S.h);if(j.g.length>30){if(q(j)||q(S))throw Error("slowDivide_ only works with positive integers.");for(var I=T,V=S;V.l(j)<=0;)I=xe(I),V=xe(V);var D=ve(I,1),M=ve(V,1);for(V=ve(V,2),I=ve(I,2);!H(V);){var A=M.add(V);A.l(j)<=0&&(D=D.add(I),M=A),V=ve(V,1),I=ve(I,1)}return S=X(j,D.j(S)),new Y(D,S)}for(D=E;j.l(S)>=0;){for(I=Math.max(1,Math.floor(j.m()/S.m())),V=Math.ceil(Math.log(I)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),M=y(I),A=M.j(S);q(A)||A.l(j)>0;)I-=V,M=y(I),A=M.j(S);H(M)&&(M=T),D=D.add(M),j=X(j,A)}return new Y(D,j)}s.B=function(j){return de(this,j).h},s.and=function(j){const S=Math.max(this.g.length,j.g.length),I=[];for(let V=0;V<S;V++)I[V]=this.i(V)&j.i(V);return new h(I,this.h&j.h)},s.or=function(j){const S=Math.max(this.g.length,j.g.length),I=[];for(let V=0;V<S;V++)I[V]=this.i(V)|j.i(V);return new h(I,this.h|j.h)},s.xor=function(j){const S=Math.max(this.g.length,j.g.length),I=[];for(let V=0;V<S;V++)I[V]=this.i(V)^j.i(V);return new h(I,this.h^j.h)};function xe(j){const S=j.g.length+1,I=[];for(let V=0;V<S;V++)I[V]=j.i(V)<<1|j.i(V-1)>>>31;return new h(I,j.h)}function ve(j,S){const I=S>>5;S%=32;const V=j.g.length-I,D=[];for(let M=0;M<V;M++)D[M]=S>0?j.i(M+I)>>>S|j.i(M+I+1)<<32-S:j.i(M+I);return new h(D,j.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,wx=i,h.prototype.add=h.prototype.add,h.prototype.multiply=h.prototype.j,h.prototype.modulo=h.prototype.B,h.prototype.compare=h.prototype.l,h.prototype.toNumber=h.prototype.m,h.prototype.toString=h.prototype.toString,h.prototype.getBits=h.prototype.i,h.fromNumber=y,h.fromString=b,Ka=h}).apply(typeof I2<"u"?I2:typeof self<"u"?self:typeof window<"u"?window:{});var rd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var _x,Jc,xx,xd,Eg,Ex,Tx,kx;(function(){var s,e=Object.defineProperty;function t(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof rd=="object"&&rd];for(var v=0;v<d.length;++v){var x=d[v];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var i=t(this);function l(d,v){if(v)e:{var x=i;d=d.split(".");for(var N=0;N<d.length-1;N++){var K=d[N];if(!(K in x))break e;x=x[K]}d=d[d.length-1],N=x[d],v=v(N),v!=N&&v!=null&&e(x,d,{configurable:!0,writable:!0,value:v})}}l("Symbol.dispose",function(d){return d||Symbol("Symbol.dispose")}),l("Array.prototype.values",function(d){return d||function(){return this[Symbol.iterator]()}}),l("Object.entries",function(d){return d||function(v){var x=[],N;for(N in v)Object.prototype.hasOwnProperty.call(v,N)&&x.push([N,v[N]]);return x}});var u=u||{},h=this||self;function p(d){var v=typeof d;return v=="object"&&d!=null||v=="function"}function g(d,v,x){return d.call.apply(d.bind,arguments)}function y(d,v,x){return y=g,y.apply(null,arguments)}function b(d,v){var x=Array.prototype.slice.call(arguments,1);return function(){var N=x.slice();return N.push.apply(N,arguments),d.apply(this,N)}}function E(d,v){function x(){}x.prototype=v.prototype,d.Z=v.prototype,d.prototype=new x,d.prototype.constructor=d,d.Ob=function(N,K,ce){for(var De=Array(arguments.length-2),It=2;It<arguments.length;It++)De[It-2]=arguments[It];return v.prototype[K].apply(N,De)}}var T=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?d=>d&&AsyncContext.Snapshot.wrap(d):d=>d;function O(d){const v=d.length;if(v>0){const x=Array(v);for(let N=0;N<v;N++)x[N]=d[N];return x}return[]}function H(d,v){for(let N=1;N<arguments.length;N++){const K=arguments[N];var x=typeof K;if(x=x!="object"?x:K?Array.isArray(K)?"array":x:"null",x=="array"||x=="object"&&typeof K.length=="number"){x=d.length||0;const ce=K.length||0;d.length=x+ce;for(let De=0;De<ce;De++)d[x+De]=K[De]}else d.push(K)}}class q{constructor(v,x){this.i=v,this.j=x,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function B(d){h.setTimeout(()=>{throw d},0)}function X(){var d=j;let v=null;return d.g&&(v=d.g,d.g=d.g.next,d.g||(d.h=null),v.next=null),v}class W{constructor(){this.h=this.g=null}add(v,x){const N=Y.get();N.set(v,x),this.h?this.h.next=N:this.g=N,this.h=N}}var Y=new q(()=>new de,d=>d.reset());class de{constructor(){this.next=this.g=this.h=null}set(v,x){this.h=v,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let xe,ve=!1,j=new W,S=()=>{const d=Promise.resolve(void 0);xe=()=>{d.then(I)}};function I(){for(var d;d=X();){try{d.h.call(d.g)}catch(x){B(x)}var v=Y;v.j(d),v.h<100&&(v.h++,d.next=v.g,v.g=d)}ve=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(d,v){this.type=d,this.g=this.target=v,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var M=(function(){if(!h.addEventListener||!Object.defineProperty)return!1;var d=!1,v=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const x=()=>{};h.addEventListener("test",x,v),h.removeEventListener("test",x,v)}catch{}return d})();function A(d){return/^[\s\xa0]*$/.test(d)}function Be(d,v){D.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d&&this.init(d,v)}E(Be,D),Be.prototype.init=function(d,v){const x=this.type=d.type,N=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;this.target=d.target||d.srcElement,this.g=v,v=d.relatedTarget,v||(x=="mouseover"?v=d.fromElement:x=="mouseout"&&(v=d.toElement)),this.relatedTarget=v,N?(this.clientX=N.clientX!==void 0?N.clientX:N.pageX,this.clientY=N.clientY!==void 0?N.clientY:N.pageY,this.screenX=N.screenX||0,this.screenY=N.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=d.pointerType,this.state=d.state,this.i=d,d.defaultPrevented&&Be.Z.h.call(this)},Be.prototype.h=function(){Be.Z.h.call(this);const d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var Ze="closure_listenable_"+(Math.random()*1e6|0),te=0;function _e(d,v,x,N,K){this.listener=d,this.proxy=null,this.src=v,this.type=x,this.capture=!!N,this.ha=K,this.key=++te,this.da=this.fa=!1}function Ie(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function ze(d,v,x){for(const N in d)v.call(x,d[N],N,d)}function re(d,v){for(const x in d)v.call(void 0,d[x],x,d)}function L(d){const v={};for(const x in d)v[x]=d[x];return v}const ie="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function we(d,v){let x,N;for(let K=1;K<arguments.length;K++){N=arguments[K];for(x in N)d[x]=N[x];for(let ce=0;ce<ie.length;ce++)x=ie[ce],Object.prototype.hasOwnProperty.call(N,x)&&(d[x]=N[x])}}function ke(d){this.src=d,this.g={},this.h=0}ke.prototype.add=function(d,v,x,N,K){const ce=d.toString();d=this.g[ce],d||(d=this.g[ce]=[],this.h++);const De=Ee(d,v,N,K);return De>-1?(v=d[De],x||(v.fa=!1)):(v=new _e(v,this.src,ce,!!N,K),v.fa=x,d.push(v)),v};function Te(d,v){const x=v.type;if(x in d.g){var N=d.g[x],K=Array.prototype.indexOf.call(N,v,void 0),ce;(ce=K>=0)&&Array.prototype.splice.call(N,K,1),ce&&(Ie(v),d.g[x].length==0&&(delete d.g[x],d.h--))}}function Ee(d,v,x,N){for(let K=0;K<d.length;++K){const ce=d[K];if(!ce.da&&ce.listener==v&&ce.capture==!!x&&ce.ha==N)return K}return-1}var Ke="closure_lm_"+(Math.random()*1e6|0),ct={};function Ve(d,v,x,N,K){if(Array.isArray(v)){for(let ce=0;ce<v.length;ce++)Ve(d,v[ce],x,N,K);return null}return x=ue(x),d&&d[Ze]?d.J(v,x,p(N)?!!N.capture:!1,K):tn(d,v,x,!1,N,K)}function tn(d,v,x,N,K,ce){if(!v)throw Error("Invalid event type");const De=p(K)?!!K.capture:!!K;let It=ut(d);if(It||(d[Ke]=It=new ke(d)),x=It.add(v,x,N,De,ce),x.proxy)return x;if(N=jn(),x.proxy=N,N.src=d,N.listener=x,d.addEventListener)M||(K=De),K===void 0&&(K=!1),d.addEventListener(v.toString(),N,K);else if(d.attachEvent)d.attachEvent(rt(v.toString()),N);else if(d.addListener&&d.removeListener)d.addListener(N);else throw Error("addEventListener and attachEvent are unavailable.");return x}function jn(){function d(x){return v.call(d.src,d.listener,x)}const v=gt;return d}function Un(d,v,x,N,K){if(Array.isArray(v))for(var ce=0;ce<v.length;ce++)Un(d,v[ce],x,N,K);else N=p(N)?!!N.capture:!!N,x=ue(x),d&&d[Ze]?(d=d.i,ce=String(v).toString(),ce in d.g&&(v=d.g[ce],x=Ee(v,x,N,K),x>-1&&(Ie(v[x]),Array.prototype.splice.call(v,x,1),v.length==0&&(delete d.g[ce],d.h--)))):d&&(d=ut(d))&&(v=d.g[v.toString()],d=-1,v&&(d=Ee(v,x,N,K)),(x=d>-1?v[d]:null)&&Lt(x))}function Lt(d){if(typeof d!="number"&&d&&!d.da){var v=d.src;if(v&&v[Ze])Te(v.i,d);else{var x=d.type,N=d.proxy;v.removeEventListener?v.removeEventListener(x,N,d.capture):v.detachEvent?v.detachEvent(rt(x),N):v.addListener&&v.removeListener&&v.removeListener(N),(x=ut(v))?(Te(x,d),x.h==0&&(x.src=null,v[Ke]=null)):Ie(d)}}}function rt(d){return d in ct?ct[d]:ct[d]="on"+d}function gt(d,v){if(d.da)d=!0;else{v=new Be(v,this);const x=d.listener,N=d.ha||d.src;d.fa&&Lt(d),d=x.call(N,v)}return d}function ut(d){return d=d[Ke],d instanceof ke?d:null}var Bn="__closure_events_fn_"+(Math.random()*1e9>>>0);function ue(d){return typeof d=="function"?d:(d[Bn]||(d[Bn]=function(v){return d.handleEvent(v)}),d[Bn])}function Rt(){V.call(this),this.i=new ke(this),this.M=this,this.G=null}E(Rt,V),Rt.prototype[Ze]=!0,Rt.prototype.removeEventListener=function(d,v,x,N){Un(this,d,v,x,N)};function yt(d,v){var x,N=d.G;if(N)for(x=[];N;N=N.G)x.push(N);if(d=d.M,N=v.type||v,typeof v=="string")v=new D(v,d);else if(v instanceof D)v.target=v.target||d;else{var K=v;v=new D(N,d),we(v,K)}K=!0;let ce,De;if(x)for(De=x.length-1;De>=0;De--)ce=v.g=x[De],K=Vt(ce,N,!0,v)&&K;if(ce=v.g=d,K=Vt(ce,N,!0,v)&&K,K=Vt(ce,N,!1,v)&&K,x)for(De=0;De<x.length;De++)ce=v.g=x[De],K=Vt(ce,N,!1,v)&&K}Rt.prototype.N=function(){if(Rt.Z.N.call(this),this.i){var d=this.i;for(const v in d.g){const x=d.g[v];for(let N=0;N<x.length;N++)Ie(x[N]);delete d.g[v],d.h--}}this.G=null},Rt.prototype.J=function(d,v,x,N){return this.i.add(String(d),v,!1,x,N)},Rt.prototype.K=function(d,v,x,N){return this.i.add(String(d),v,!0,x,N)};function Vt(d,v,x,N){if(v=d.i.g[String(v)],!v)return!0;v=v.concat();let K=!0;for(let ce=0;ce<v.length;++ce){const De=v[ce];if(De&&!De.da&&De.capture==x){const It=De.listener,ls=De.ha||De.src;De.fa&&Te(d.i,De),K=It.call(ls,N)!==!1&&K}}return K&&!N.defaultPrevented}function Je(d,v){if(typeof d!="function")if(d&&typeof d.handleEvent=="function")d=y(d.handleEvent,d);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:h.setTimeout(d,v||0)}function At(d){d.g=Je(()=>{d.g=null,d.i&&(d.i=!1,At(d))},d.l);const v=d.h;d.h=null,d.m.apply(null,v)}class vt extends V{constructor(v,x){super(),this.m=v,this.l=x,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:At(this)}N(){super.N(),this.g&&(h.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function nn(d){V.call(this),this.h=d,this.g={}}E(nn,V);var js=[];function rs(d){ze(d.g,function(v,x){this.g.hasOwnProperty(x)&&Lt(v)},d),d.g={}}nn.prototype.N=function(){nn.Z.N.call(this),rs(this)},nn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Xt=h.JSON.stringify,ne=h.JSON.parse,Ne=class{stringify(d){return h.JSON.stringify(d,void 0)}parse(d){return h.JSON.parse(d,void 0)}};function xt(){}function bt(){}var it={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function $e(){D.call(this,"d")}E($e,D);function st(){D.call(this,"c")}E(st,D);var Fe={},sn=null;function on(){return sn=sn||new Rt}Fe.Ia="serverreachability";function Ln(d){D.call(this,Fe.Ia,d)}E(Ln,D);function zn(d){const v=on();yt(v,new Ln(v))}Fe.STAT_EVENT="statevent";function Xn(d,v){D.call(this,Fe.STAT_EVENT,d),this.stat=v}E(Xn,D);function Yt(d){const v=on();yt(v,new Xn(v,d))}Fe.Ja="timingevent";function Fn(d,v){D.call(this,Fe.Ja,d),this.size=v}E(Fn,D);function Cn(d,v){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return h.setTimeout(function(){d()},v)}function ln(){this.g=!0}ln.prototype.ua=function(){this.g=!1};function yr(d,v,x,N,K,ce){d.info(function(){if(d.g)if(ce){var De="",It=ce.split("&");for(let un=0;un<It.length;un++){var ls=It[un].split("=");if(ls.length>1){const $n=ls[0];ls=ls[1];const Pr=$n.split("_");De=Pr.length>=2&&Pr[1]=="type"?De+($n+"="+ls+"&"):De+($n+"=redacted&")}}}else De=null;else De=ce;return"XMLHTTP REQ ("+N+") [attempt "+K+"]: "+v+`
`+x+`
`+De})}function oe(d,v,x,N,K,ce,De){d.info(function(){return"XMLHTTP RESP ("+N+") [ attempt "+K+"]: "+v+`
`+x+`
`+ce+" "+De})}function Ae(d,v,x,N){d.info(function(){return"XMLHTTP TEXT ("+v+"): "+mt(d,x)+(N?" "+N:"")})}function Ge(d,v){d.info(function(){return"TIMEOUT: "+v})}ln.prototype.info=function(){};function mt(d,v){if(!d.g)return v;if(!v)return null;try{const ce=JSON.parse(v);if(ce){for(d=0;d<ce.length;d++)if(Array.isArray(ce[d])){var x=ce[d];if(!(x.length<2)){var N=x[1];if(Array.isArray(N)&&!(N.length<1)){var K=N[0];if(K!="noop"&&K!="stop"&&K!="close")for(let De=1;De<N.length;De++)N[De]=""}}}}return Xt(ce)}catch{return v}}var lt={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},vn={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Nn;function dn(){}E(dn,xt),dn.prototype.g=function(){return new XMLHttpRequest},Nn=new dn;function bn(d){return encodeURIComponent(String(d))}function Cs(d){var v=1;d=d.split(":");const x=[];for(;v>0&&d.length;)x.push(d.shift()),v--;return d.length&&x.push(d.join(":")),x}function is(d,v,x,N){this.j=d,this.i=v,this.l=x,this.S=N||1,this.V=new nn(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ds}function ds(){this.i=null,this.g="",this.h=!1}var Jt={},An={};function Ns(d,v,x){d.M=1,d.A=Kn(Me(v)),d.u=x,d.R=!0,Ar(d,null)}function Ar(d,v){d.F=Date.now(),qn(d),d.B=Me(d.A);var x=d.B,N=d.S;Array.isArray(N)||(N=[String(N)]),Pe(x.i,"t",N),d.C=0,x=d.j.L,d.h=new ds,d.g=Yu(d.j,x?v:null,!d.u),d.P>0&&(d.O=new vt(y(d.Y,d,d.g),d.P)),v=d.V,x=d.g,N=d.ba;var K="readystatechange";Array.isArray(K)||(K&&(js[0]=K.toString()),K=js);for(let ce=0;ce<K.length;ce++){const De=Ve(x,K[ce],N||v.handleEvent,!1,v.h||v);if(!De)break;v.g[De.key]=De}v=d.J?L(d.J):{},d.u?(d.v||(d.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.B,d.v,d.u,v)):(d.v="GET",d.g.ea(d.B,d.v,null,v)),zn(),yr(d.i,d.v,d.B,d.l,d.S,d.u)}is.prototype.ba=function(d){d=d.target;const v=this.O;v&&cn(d)==3?v.j():this.Y(d)},is.prototype.Y=function(d){try{if(d==this.g)e:{const It=cn(this.g),ls=this.g.ya(),un=this.g.ca();if(!(It<3)&&(It!=3||this.g&&(this.h.h||this.g.la()||Rn(this.g)))){this.K||It!=4||ls==7||(ls==8||un<=0?zn(3):zn(2)),_s(this);var v=this.g.ca();this.X=v;var x=di(this);if(this.o=v==200,oe(this.i,this.v,this.B,this.l,this.S,It,v),this.o){if(this.U&&!this.L){t:{if(this.g){var N,K=this.g;if((N=K.g?K.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(N)){var ce=N;break t}}ce=null}if(d=ce)Ae(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,as(this,d);else{this.o=!1,this.m=3,Yt(12),On(this),kn(this);break e}}if(this.R){d=!0;let $n;for(;!this.K&&this.C<x.length;)if($n=Ir(this,x),$n==An){It==4&&(this.m=4,Yt(14),d=!1),Ae(this.i,this.l,null,"[Incomplete Response]");break}else if($n==Jt){this.m=4,Yt(15),Ae(this.i,this.l,x,"[Invalid Chunk]"),d=!1;break}else Ae(this.i,this.l,$n,null),as(this,$n);if(Rr(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),It!=4||x.length!=0||this.h.h||(this.m=1,Yt(16),d=!1),this.o=this.o&&d,!d)Ae(this.i,this.l,x,"[Invalid Chunked Response]"),On(this),kn(this);else if(x.length>0&&!this.W){this.W=!0;var De=this.j;De.g==this&&De.aa&&!De.P&&(De.j.info("Great, no buffering proxy detected. Bytes received: "+x.length),ic(De),De.P=!0,Yt(11))}}else Ae(this.i,this.l,x,null),as(this,x);It==4&&On(this),this.o&&!this.K&&(It==4?$u(this.j,this):(this.o=!1,qn(this)))}else Bs(this.g),v==400&&x.indexOf("Unknown SID")>0?(this.m=3,Yt(12)):(this.m=0,Yt(13)),On(this),kn(this)}}}catch{}};function di(d){if(!Rr(d))return d.g.la();const v=Rn(d.g);if(v==="")return"";let x="";const N=v.length,K=cn(d.g)==4;if(!d.h.i){if(typeof TextDecoder>"u")return On(d),kn(d),"";d.h.i=new h.TextDecoder}for(let ce=0;ce<N;ce++)d.h.h=!0,x+=d.h.i.decode(v[ce],{stream:!(K&&ce==N-1)});return v.length=0,d.h.g+=x,d.C=0,d.h.g}function Rr(d){return d.g?d.v=="GET"&&d.M!=2&&d.j.Aa:!1}function Ir(d,v){var x=d.C,N=v.indexOf(`
`,x);return N==-1?An:(x=Number(v.substring(x,N)),isNaN(x)?Jt:(N+=1,N+x>v.length?An:(v=v.slice(N,N+x),d.C=N+x,v)))}is.prototype.cancel=function(){this.K=!0,On(this)};function qn(d){d.T=Date.now()+d.H,Ks(d,d.H)}function Ks(d,v){if(d.D!=null)throw Error("WatchDog timer not null");d.D=Cn(y(d.aa,d),v)}function _s(d){d.D&&(h.clearTimeout(d.D),d.D=null)}is.prototype.aa=function(){this.D=null;const d=Date.now();d-this.T>=0?(Ge(this.i,this.B),this.M!=2&&(zn(),Yt(17)),On(this),this.m=2,kn(this)):Ks(this,this.T-d)};function kn(d){d.j.I==0||d.K||$u(d.j,d)}function On(d){_s(d);var v=d.O;v&&typeof v.dispose=="function"&&v.dispose(),d.O=null,rs(d.V),d.g&&(v=d.g,d.g=null,v.abort(),v.dispose())}function as(d,v){try{var x=d.j;if(x.I!=0&&(x.g==d||wn(x.h,d))){if(!d.L&&wn(x.h,d)&&x.I==3){try{var N=x.Ba.g.parse(v)}catch{N=null}if(Array.isArray(N)&&N.length==3){var K=N;if(K[0]==0){e:if(!x.v){if(x.g)if(x.g.F+3e3<d.F)Jo(x),ir(x);else break e;lo(x),Yt(18)}}else x.xa=K[1],0<x.xa-x.K&&K[2]<37500&&x.F&&x.A==0&&!x.C&&(x.C=Cn(y(x.Va,x),6e3));xs(x.h)<=1&&x.ta&&(x.ta=void 0)}else pi(x,11)}else if((d.L||x.g==d)&&Jo(x),!A(v))for(K=x.Ba.g.parse(v),v=0;v<K.length;v++){let un=K[v];const $n=un[0];if(!($n<=x.K))if(x.K=$n,un=un[1],x.I==2)if(un[0]=="c"){x.M=un[1],x.ba=un[2];const Pr=un[3];Pr!=null&&(x.ka=Pr,x.j.info("VER="+x.ka));const gi=un[4];gi!=null&&(x.za=gi,x.j.info("SVER="+x.za));const Xr=un[5];Xr!=null&&typeof Xr=="number"&&Xr>0&&(N=1.5*Xr,x.O=N,x.j.info("backChannelRequestTimeoutMs_="+N)),N=x;const Jr=d.g;if(Jr){const co=Jr.g?Jr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(co){var ce=N.h;ce.g||co.indexOf("spdy")==-1&&co.indexOf("quic")==-1&&co.indexOf("h2")==-1||(ce.j=ce.l,ce.g=new Set,ce.h&&(rr(ce,ce.h),ce.h=null))}if(N.G){const Zo=Jr.g?Jr.g.getResponseHeader("X-HTTP-Session-Id"):null;Zo&&(N.wa=Zo,Ye(N.J,N.G,Zo))}}x.I=3,x.l&&x.l.ra(),x.aa&&(x.T=Date.now()-d.F,x.j.info("Handshake RTT: "+x.T+"ms")),N=x;var De=d;if(N.na=Ku(N,N.L?N.ba:null,N.W),De.L){fi(N.h,De);var It=De,ls=N.O;ls&&(It.H=ls),It.D&&(_s(It),qn(It)),N.g=De}else qu(N);x.i.length>0&&Or(x)}else un[0]!="stop"&&un[0]!="close"||pi(x,7);else x.I==3&&(un[0]=="stop"||un[0]=="close"?un[0]=="stop"?pi(x,7):Ys(x):un[0]!="noop"&&x.l&&x.l.qa(un),x.A=0)}}zn(4)}catch{}}var zt=class{constructor(d,v){this.g=d,this.map=v}};function Qr(d){this.l=d||10,h.PerformanceNavigationTiming?(d=h.performance.getEntriesByType("navigation"),d=d.length>0&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(h.chrome&&h.chrome.loadTimes&&h.chrome.loadTimes()&&h.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Dr(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function xs(d){return d.h?1:d.g?d.g.size:0}function wn(d,v){return d.h?d.h==v:d.g?d.g.has(v):!1}function rr(d,v){d.g?d.g.add(v):d.h=v}function fi(d,v){d.h&&d.h==v?d.h=null:d.g&&d.g.has(v)&&d.g.delete(v)}Qr.prototype.cancel=function(){if(this.i=R(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function R(d){if(d.h!=null)return d.i.concat(d.h.G);if(d.g!=null&&d.g.size!==0){let v=d.i;for(const x of d.g.values())v=v.concat(x.G);return v}return O(d.i)}var z=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ae(d,v){if(d){d=d.split("&");for(let x=0;x<d.length;x++){const N=d[x].indexOf("=");let K,ce=null;N>=0?(K=d[x].substring(0,N),ce=d[x].substring(N+1)):K=d[x],v(K,ce?decodeURIComponent(ce.replace(/\+/g," ")):"")}}}function le(d){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;d instanceof le?(this.l=d.l,Le(this,d.j),this.o=d.o,this.g=d.g,He(this,d.u),this.h=d.h,Ft(this,ht(d.i)),this.m=d.m):d&&(v=String(d).match(z))?(this.l=!1,Le(this,v[1]||"",!0),this.o=os(v[2]||""),this.g=os(v[3]||"",!0),He(this,v[4]),this.h=os(v[5]||"",!0),Ft(this,v[6]||"",!0),this.m=os(v[7]||"")):(this.l=!1,this.i=new Lr(null,this.l))}le.prototype.toString=function(){const d=[];var v=this.j;v&&d.push(Vs(v,vr,!0),":");var x=this.g;return(x||v=="file")&&(d.push("//"),(v=this.o)&&d.push(Vs(v,vr,!0),"@"),d.push(bn(x).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.u,x!=null&&d.push(":",String(x))),(x=this.h)&&(this.g&&x.charAt(0)!="/"&&d.push("/"),d.push(Vs(x,x.charAt(0)=="/"?Di:fa,!0))),(x=this.i.toString())&&d.push("?",x),(x=this.m)&&d.push("#",Vs(x,ma)),d.join("")},le.prototype.resolve=function(d){const v=Me(this);let x=!!d.j;x?Le(v,d.j):x=!!d.o,x?v.o=d.o:x=!!d.g,x?v.g=d.g:x=d.u!=null;var N=d.h;if(x)He(v,d.u);else if(x=!!d.h){if(N.charAt(0)!="/")if(this.g&&!this.h)N="/"+N;else{var K=v.h.lastIndexOf("/");K!=-1&&(N=v.h.slice(0,K+1)+N)}if(K=N,K==".."||K==".")N="";else if(K.indexOf("./")!=-1||K.indexOf("/.")!=-1){N=K.lastIndexOf("/",0)==0,K=K.split("/");const ce=[];for(let De=0;De<K.length;){const It=K[De++];It=="."?N&&De==K.length&&ce.push(""):It==".."?((ce.length>1||ce.length==1&&ce[0]!="")&&ce.pop(),N&&De==K.length&&ce.push("")):(ce.push(It),N=!0)}N=ce.join("/")}else N=K}return x?v.h=N:x=d.i.toString()!=="",x?Ft(v,ht(d.i)):x=!!d.m,x&&(v.m=d.m),v};function Me(d){return new le(d)}function Le(d,v,x){d.j=x?os(v,!0):v,d.j&&(d.j=d.j.replace(/:$/,""))}function He(d,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);d.u=v}else d.u=null}function Ft(d,v,x){v instanceof Lr?(d.i=v,kt(d.i,d.l)):(x||(v=Vs(v,Mr)),d.i=new Lr(v,d.l))}function Ye(d,v,x){d.i.set(v,x)}function Kn(d){return Ye(d,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),d}function os(d,v){return d?v?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function Vs(d,v,x){return typeof d=="string"?(d=encodeURI(d).replace(v,Yn),x&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function Yn(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var vr=/[#\/\?@]/g,fa=/[#\?:]/g,Di=/[#\?]/g,Mr=/[#\?@]/g,ma=/#/g;function Lr(d,v){this.h=this.g=null,this.i=d||null,this.j=!!v}function C(d){d.g||(d.g=new Map,d.h=0,d.i&&ae(d.i,function(v,x){d.add(decodeURIComponent(v.replace(/\+/g," ")),x)}))}s=Lr.prototype,s.add=function(d,v){C(this),this.i=null,d=et(this,d);let x=this.g.get(d);return x||this.g.set(d,x=[]),x.push(v),this.h+=1,this};function G(d,v){C(d),v=et(d,v),d.g.has(v)&&(d.i=null,d.h-=d.g.get(v).length,d.g.delete(v))}function Ce(d,v){return C(d),v=et(d,v),d.g.has(v)}s.forEach=function(d,v){C(this),this.g.forEach(function(x,N){x.forEach(function(K){d.call(v,K,N,this)},this)},this)};function Re(d,v){C(d);let x=[];if(typeof v=="string")Ce(d,v)&&(x=x.concat(d.g.get(et(d,v))));else for(d=Array.from(d.g.values()),v=0;v<d.length;v++)x=x.concat(d[v]);return x}s.set=function(d,v){return C(this),this.i=null,d=et(this,d),Ce(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[v]),this.h+=1,this},s.get=function(d,v){return d?(d=Re(this,d),d.length>0?String(d[0]):v):v};function Pe(d,v,x){G(d,v),x.length>0&&(d.i=null,d.g.set(et(d,v),O(x)),d.h+=x.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],v=Array.from(this.g.keys());for(let N=0;N<v.length;N++){var x=v[N];const K=bn(x);x=Re(this,x);for(let ce=0;ce<x.length;ce++){let De=K;x[ce]!==""&&(De+="="+bn(x[ce])),d.push(De)}}return this.i=d.join("&")};function ht(d){const v=new Lr;return v.i=d.i,d.g&&(v.g=new Map(d.g),v.h=d.h),v}function et(d,v){return v=String(v),d.j&&(v=v.toLowerCase()),v}function kt(d,v){v&&!d.j&&(C(d),d.i=null,d.g.forEach(function(x,N){const K=N.toLowerCase();N!=K&&(G(this,N),Pe(this,K,x))},d)),d.j=v}function dt(d,v){const x=new ln;if(h.Image){const N=new Image;N.onload=b(Q,x,"TestLoadImage: loaded",!0,v,N),N.onerror=b(Q,x,"TestLoadImage: error",!1,v,N),N.onabort=b(Q,x,"TestLoadImage: abort",!1,v,N),N.ontimeout=b(Q,x,"TestLoadImage: timeout",!1,v,N),h.setTimeout(function(){N.ontimeout&&N.ontimeout()},1e4),N.src=d}else v(!1)}function P(d,v){const x=new ln,N=new AbortController,K=setTimeout(()=>{N.abort(),Q(x,"TestPingServer: timeout",!1,v)},1e4);fetch(d,{signal:N.signal}).then(ce=>{clearTimeout(K),ce.ok?Q(x,"TestPingServer: ok",!0,v):Q(x,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(K),Q(x,"TestPingServer: error",!1,v)})}function Q(d,v,x,N,K){try{K&&(K.onload=null,K.onerror=null,K.onabort=null,K.ontimeout=null),N(x)}catch{}}function Z(){this.g=new Ne}function pe(d){this.i=d.Sb||null,this.h=d.ab||!1}E(pe,xt),pe.prototype.g=function(){return new je(this.i,this.h)};function je(d,v){Rt.call(this),this.H=d,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}E(je,Rt),s=je.prototype,s.open=function(d,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=d,this.D=v,this.readyState=1,pt(this)},s.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};d&&(v.body=d),(this.H||h).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,qe(this)),this.readyState=0},s.Pa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,pt(this)),this.g&&(this.readyState=3,pt(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof h.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Oe(this)}else d.text().then(this.Oa.bind(this),this.ga.bind(this))};function Oe(d){d.j.read().then(d.Ma.bind(d)).catch(d.ga.bind(d))}s.Ma=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var v=d.value?d.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!d.done}))&&(this.response=this.responseText+=v)}d.done?qe(this):pt(this),this.readyState==3&&Oe(this)}},s.Oa=function(d){this.g&&(this.response=this.responseText=d,qe(this))},s.Na=function(d){this.g&&(this.response=d,qe(this))},s.ga=function(){this.g&&qe(this)};function qe(d){d.readyState=4,d.l=null,d.j=null,d.B=null,pt(d)}s.setRequestHeader=function(d,v){this.A.append(d,v)},s.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],v=this.h.entries();for(var x=v.next();!x.done;)x=x.value,d.push(x[0]+": "+x[1]),x=v.next();return d.join(`\r
`)};function pt(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(je.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function Et(d){let v="";return ze(d,function(x,N){v+=N,v+=":",v+=x,v+=`\r
`}),v}function Pt(d,v,x){e:{for(N in x){var N=!1;break e}N=!0}N||(x=Et(x),typeof d=="string"?x!=null&&bn(x):Ye(d,v,x))}function Qe(d){Rt.call(this),this.headers=new Map,this.L=d||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}E(Qe,Rt);var Zt=/^https?$/i,Us=["POST","PUT"];s=Qe.prototype,s.Fa=function(d){this.H=d},s.ea=function(d,v,x,N){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);v=v?v.toUpperCase():"GET",this.D=d,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Nn.g(),this.g.onreadystatechange=T(y(this.Ca,this));try{this.B=!0,this.g.open(v,String(d),!0),this.B=!1}catch(ce){Tt(this,ce);return}if(d=x||"",x=new Map(this.headers),N)if(Object.getPrototypeOf(N)===Object.prototype)for(var K in N)x.set(K,N[K]);else if(typeof N.keys=="function"&&typeof N.get=="function")for(const ce of N.keys())x.set(ce,N.get(ce));else throw Error("Unknown input type for opt_headers: "+String(N));N=Array.from(x.keys()).find(ce=>ce.toLowerCase()=="content-type"),K=h.FormData&&d instanceof h.FormData,!(Array.prototype.indexOf.call(Us,v,void 0)>=0)||N||K||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ce,De]of x)this.g.setRequestHeader(ce,De);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(d),this.v=!1}catch(ce){Tt(this,ce)}};function Tt(d,v){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=v,d.o=5,Hn(d),St(d)}function Hn(d){d.A||(d.A=!0,yt(d,"complete"),yt(d,"error"))}s.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=d||7,yt(this,"complete"),yt(this,"abort"),St(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),St(this,!0)),Qe.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?Jn(this):this.Xa())},s.Xa=function(){Jn(this)};function Jn(d){if(d.h&&typeof u<"u"){if(d.v&&cn(d)==4)setTimeout(d.Ca.bind(d),0);else if(yt(d,"readystatechange"),cn(d)==4){d.h=!1;try{const ce=d.ca();e:switch(ce){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var x;if(!(x=v)){var N;if(N=ce===0){let De=String(d.D).match(z)[1]||null;!De&&h.self&&h.self.location&&(De=h.self.location.protocol.slice(0,-1)),N=!Zt.test(De?De.toLowerCase():"")}x=N}if(x)yt(d,"complete"),yt(d,"success");else{d.o=6;try{var K=cn(d)>2?d.g.statusText:""}catch{K=""}d.l=K+" ["+d.ca()+"]",Hn(d)}}finally{St(d)}}}}function St(d,v){if(d.g){d.m&&(clearTimeout(d.m),d.m=null);const x=d.g;d.g=null,v||yt(d,"ready");try{x.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function cn(d){return d.g?d.g.readyState:0}s.ca=function(){try{return cn(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(d){if(this.g){var v=this.g.responseText;return d&&v.indexOf(d)==0&&(v=v.substring(d.length)),ne(v)}};function Rn(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.F){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function Bs(d){const v={};d=(d.g&&cn(d)>=2&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let N=0;N<d.length;N++){if(A(d[N]))continue;var x=Cs(d[N]);const K=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();const ce=v[K]||[];v[K]=ce,ce.push(x)}re(v,function(N){return N.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function zs(d,v,x){return x&&x.internalChannelParams&&x.internalChannelParams[d]||v}function fs(d){this.za=0,this.i=[],this.j=new ln,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=zs("failFast",!1,d),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=zs("baseRetryDelayMs",5e3,d),this.Za=zs("retryDelaySeedMs",1e4,d),this.Ta=zs("forwardChannelMaxRetries",2,d),this.va=zs("forwardChannelRequestTimeoutMs",2e4,d),this.ma=d&&d.xmlHttpFactory||void 0,this.Ua=d&&d.Rb||void 0,this.Aa=d&&d.useFetchStreams||!1,this.O=void 0,this.L=d&&d.supportsCrossDomainXhr||!1,this.M="",this.h=new Qr(d&&d.concurrentRequestLimit),this.Ba=new Z,this.S=d&&d.fastHandshake||!1,this.R=d&&d.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=d&&d.Pb||!1,d&&d.ua&&this.j.ua(),d&&d.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&d&&d.detectBufferingProxy||!1,this.ia=void 0,d&&d.longPollingTimeout&&d.longPollingTimeout>0&&(this.ia=d.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=fs.prototype,s.ka=8,s.I=1,s.connect=function(d,v,x,N){Yt(0),this.W=d,this.H=v||{},x&&N!==void 0&&(this.H.OSID=x,this.H.OAID=N),this.F=this.X,this.J=Ku(this,null,this.W),Or(this)};function Ys(d){if(Mi(d),d.I==3){var v=d.V++,x=Me(d.J);if(Ye(x,"SID",d.M),Ye(x,"RID",v),Ye(x,"TYPE","terminate"),oo(d,x),v=new is(d,d.j,v),v.M=2,v.A=Kn(Me(x)),x=!1,h.navigator&&h.navigator.sendBeacon)try{x=h.navigator.sendBeacon(v.A.toString(),"")}catch{}!x&&h.Image&&(new Image().src=v.A,x=!0),x||(v.g=Yu(v.j,null),v.g.ea(v.A)),v.F=Date.now(),qn(v)}Gu(d)}function ir(d){d.g&&(ic(d),d.g.cancel(),d.g=null)}function Mi(d){ir(d),d.v&&(h.clearTimeout(d.v),d.v=null),Jo(d),d.h.cancel(),d.m&&(typeof d.m=="number"&&h.clearTimeout(d.m),d.m=null)}function Or(d){if(!Dr(d.h)&&!d.m){d.m=!0;var v=d.Ea;xe||S(),ve||(xe(),ve=!0),j.add(v,d),d.D=0}}function mi(d,v){return xs(d.h)>=d.h.j-(d.m?1:0)?!1:d.m?(d.i=v.G.concat(d.i),!0):d.I==1||d.I==2||d.D>=(d.Sa?0:d.Ta)?!1:(d.m=Cn(y(d.Ea,d,v),Wu(d,d.D)),d.D++,!0)}s.Ea=function(d){if(this.m)if(this.m=null,this.I==1){if(!d){this.V=Math.floor(Math.random()*1e5),d=this.V++;const K=new is(this,this.j,d);let ce=this.o;if(this.U&&(ce?(ce=L(ce),we(ce,this.U)):ce=this.U),this.u!==null||this.R||(K.J=ce,ce=null),this.S)e:{for(var v=0,x=0;x<this.i.length;x++){t:{var N=this.i[x];if("__data__"in N.map&&(N=N.map.__data__,typeof N=="string")){N=N.length;break t}N=void 0}if(N===void 0)break;if(v+=N,v>4096){v=x;break e}if(v===4096||x===this.i.length-1){v=x+1;break e}}v=1e3}else v=1e3;v=Fu(this,K,v),x=Me(this.J),Ye(x,"RID",d),Ye(x,"CVER",22),this.G&&Ye(x,"X-HTTP-Session-Id",this.G),oo(this,x),ce&&(this.R?v="headers="+bn(Et(ce))+"&"+v:this.u&&Pt(x,this.u,ce)),rr(this.h,K),this.Ra&&Ye(x,"TYPE","init"),this.S?(Ye(x,"$req",v),Ye(x,"SID","null"),K.U=!0,Ns(K,x,null)):Ns(K,x,v),this.I=2}}else this.I==3&&(d?rc(this,d):this.i.length==0||Dr(this.h)||rc(this))};function rc(d,v){var x;v?x=v.l:x=d.V++;const N=Me(d.J);Ye(N,"SID",d.M),Ye(N,"RID",x),Ye(N,"AID",d.K),oo(d,N),d.u&&d.o&&Pt(N,d.u,d.o),x=new is(d,d.j,x,d.D+1),d.u===null&&(x.J=d.o),v&&(d.i=v.G.concat(d.i)),v=Fu(d,x,1e3),x.H=Math.round(d.va*.5)+Math.round(d.va*.5*Math.random()),rr(d.h,x),Ns(x,N,v)}function oo(d,v){d.H&&ze(d.H,function(x,N){Ye(v,N,x)}),d.l&&ze({},function(x,N){Ye(v,N,x)})}function Fu(d,v,x){x=Math.min(d.i.length,x);const N=d.l?y(d.l.Ka,d.l,d):null;e:{var K=d.i;let It=-1;for(;;){const ls=["count="+x];It==-1?x>0?(It=K[0].g,ls.push("ofs="+It)):It=0:ls.push("ofs="+It);let un=!0;for(let $n=0;$n<x;$n++){var ce=K[$n].g;const Pr=K[$n].map;if(ce-=It,ce<0)It=Math.max(0,K[$n].g-100),un=!1;else try{ce="req"+ce+"_"||"";try{var De=Pr instanceof Map?Pr:Object.entries(Pr);for(const[gi,Xr]of De){let Jr=Xr;p(Xr)&&(Jr=Xt(Xr)),ls.push(ce+gi+"="+encodeURIComponent(Jr))}}catch(gi){throw ls.push(ce+"type="+encodeURIComponent("_badmap")),gi}}catch{N&&N(Pr)}}if(un){De=ls.join("&");break e}}De=void 0}return d=d.i.splice(0,x),v.G=d,De}function qu(d){if(!d.g&&!d.v){d.Y=1;var v=d.Da;xe||S(),ve||(xe(),ve=!0),j.add(v,d),d.A=0}}function lo(d){return d.g||d.v||d.A>=3?!1:(d.Y++,d.v=Cn(y(d.Da,d),Wu(d,d.A)),d.A++,!0)}s.Da=function(){if(this.v=null,Hu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var d=4*this.T;this.j.info("BP detection timer enabled: "+d),this.B=Cn(y(this.Wa,this),d)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Yt(10),ir(this),Hu(this))};function ic(d){d.B!=null&&(h.clearTimeout(d.B),d.B=null)}function Hu(d){d.g=new is(d,d.j,"rpc",d.Y),d.u===null&&(d.g.J=d.o),d.g.P=0;var v=Me(d.na);Ye(v,"RID","rpc"),Ye(v,"SID",d.M),Ye(v,"AID",d.K),Ye(v,"CI",d.F?"0":"1"),!d.F&&d.ia&&Ye(v,"TO",d.ia),Ye(v,"TYPE","xmlhttp"),oo(d,v),d.u&&d.o&&Pt(v,d.u,d.o),d.O&&(d.g.H=d.O);var x=d.g;d=d.ba,x.M=1,x.A=Kn(Me(v)),x.u=null,x.R=!0,Ar(x,d)}s.Va=function(){this.C!=null&&(this.C=null,ir(this),lo(this),Yt(19))};function Jo(d){d.C!=null&&(h.clearTimeout(d.C),d.C=null)}function $u(d,v){var x=null;if(d.g==v){Jo(d),ic(d),d.g=null;var N=2}else if(wn(d.h,v))x=v.G,fi(d.h,v),N=1;else return;if(d.I!=0){if(v.o)if(N==1){x=v.u?v.u.length:0,v=Date.now()-v.F;var K=d.D;N=on(),yt(N,new Fn(N,x)),Or(d)}else qu(d);else if(K=v.m,K==3||K==0&&v.X>0||!(N==1&&mi(d,v)||N==2&&lo(d)))switch(x&&x.length>0&&(v=d.h,v.i=v.i.concat(x)),K){case 1:pi(d,5);break;case 4:pi(d,10);break;case 3:pi(d,6);break;default:pi(d,2)}}}function Wu(d,v){let x=d.Qa+Math.floor(Math.random()*d.Za);return d.isActive()||(x*=2),x*v}function pi(d,v){if(d.j.info("Error code "+v),v==2){var x=y(d.bb,d),N=d.Ua;const K=!N;N=new le(N||"//www.google.com/images/cleardot.gif"),h.location&&h.location.protocol=="http"||Le(N,"https"),Kn(N),K?dt(N.toString(),x):P(N.toString(),x)}else Yt(2);d.I=0,d.l&&d.l.pa(v),Gu(d),Mi(d)}s.bb=function(d){d?(this.j.info("Successfully pinged google.com"),Yt(2)):(this.j.info("Failed to ping google.com"),Yt(1))};function Gu(d){if(d.I=0,d.ja=[],d.l){const v=R(d.h);(v.length!=0||d.i.length!=0)&&(H(d.ja,v),H(d.ja,d.i),d.h.i.length=0,O(d.i),d.i.length=0),d.l.oa()}}function Ku(d,v,x){var N=x instanceof le?Me(x):new le(x);if(N.g!="")v&&(N.g=v+"."+N.g),He(N,N.u);else{var K=h.location;N=K.protocol,v=v?v+"."+K.hostname:K.hostname,K=+K.port;const ce=new le(null);N&&Le(ce,N),v&&(ce.g=v),K&&He(ce,K),x&&(ce.h=x),N=ce}return x=d.G,v=d.wa,x&&v&&Ye(N,x,v),Ye(N,"VER",d.ka),oo(d,N),N}function Yu(d,v,x){if(v&&!d.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=d.Aa&&!d.ma?new Qe(new pe({ab:x})):new Qe(d.ma),v.Fa(d.L),v}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function Qu(){}s=Qu.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function pa(){}pa.prototype.g=function(d,v){return new Qs(d,v)};function Qs(d,v){Rt.call(this),this.g=new fs(v),this.l=d,this.h=v&&v.messageUrlParams||null,d=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(d?d["X-WebChannel-Content-Type"]=v.messageContentType:d={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(d?d["X-WebChannel-Client-Profile"]=v.sa:d={"X-WebChannel-Client-Profile":v.sa}),this.g.U=d,(d=v&&v.Qb)&&!A(d)&&(this.g.u=d),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!A(v)&&(this.g.G=v,d=this.h,d!==null&&v in d&&(d=this.h,v in d&&delete d[v])),this.j=new Li(this)}E(Qs,Rt),Qs.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Qs.prototype.close=function(){Ys(this.g)},Qs.prototype.o=function(d){var v=this.g;if(typeof d=="string"){var x={};x.__data__=d,d=x}else this.v&&(x={},x.__data__=Xt(d),d=x);v.i.push(new zt(v.Ya++,d)),v.I==3&&Or(v)},Qs.prototype.N=function(){this.g.l=null,delete this.j,Ys(this.g),delete this.g,Qs.Z.N.call(this)};function Xu(d){$e.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var v=d.__sm__;if(v){e:{for(const x in v){d=x;break e}d=void 0}(this.i=d)&&(d=this.i,v=v!==null&&d in v?v[d]:void 0),this.data=v}else this.data=d}E(Xu,$e);function Ju(){st.call(this),this.status=1}E(Ju,st);function Li(d){this.g=d}E(Li,Qu),Li.prototype.ra=function(){yt(this.g,"a")},Li.prototype.qa=function(d){yt(this.g,new Xu(d))},Li.prototype.pa=function(d){yt(this.g,new Ju)},Li.prototype.oa=function(){yt(this.g,"b")},pa.prototype.createWebChannel=pa.prototype.g,Qs.prototype.send=Qs.prototype.o,Qs.prototype.open=Qs.prototype.m,Qs.prototype.close=Qs.prototype.close,kx=function(){return new pa},Tx=function(){return on()},Ex=Fe,Eg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},lt.NO_ERROR=0,lt.TIMEOUT=8,lt.HTTP_ERROR=6,xd=lt,vn.COMPLETE="complete",xx=vn,bt.EventType=it,it.OPEN="a",it.CLOSE="b",it.ERROR="c",it.MESSAGE="d",Rt.prototype.listen=Rt.prototype.J,Jc=bt,Qe.prototype.listenOnce=Qe.prototype.K,Qe.prototype.getLastError=Qe.prototype.Ha,Qe.prototype.getLastErrorCode=Qe.prototype.ya,Qe.prototype.getStatus=Qe.prototype.ca,Qe.prototype.getResponseJson=Qe.prototype.La,Qe.prototype.getResponseText=Qe.prototype.la,Qe.prototype.send=Qe.prototype.ea,Qe.prototype.setWithCredentials=Qe.prototype.Fa,_x=Qe}).apply(typeof rd<"u"?rd:typeof self<"u"?self:typeof window<"u"?window:{});class Hs{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Hs.UNAUTHENTICATED=new Hs(null),Hs.GOOGLE_CREDENTIALS=new Hs("google-credentials-uid"),Hs.FIRST_PARTY=new Hs("first-party-uid"),Hs.MOCK_USER=new Hs("mock-user");let Zl="12.8.0";function s4(s){Zl=s}const Vo=new ny("@firebase/firestore");function Rl(){return Vo.logLevel}function We(s,...e){if(Vo.logLevel<=$t.DEBUG){const t=e.map(my);Vo.debug(`Firestore (${Zl}): ${s}`,...t)}}function la(s,...e){if(Vo.logLevel<=$t.ERROR){const t=e.map(my);Vo.error(`Firestore (${Zl}): ${s}`,...t)}}function zl(s,...e){if(Vo.logLevel<=$t.WARN){const t=e.map(my);Vo.warn(`Firestore (${Zl}): ${s}`,...t)}}function my(s){if(typeof s=="string")return s;try{return(function(t){return JSON.stringify(t)})(s)}catch{return s}}function _t(s,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,Sx(s,i,t)}function Sx(s,e,t){let i=`FIRESTORE (${Zl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw la(i),new Error(i)}function mn(s,e,t,i){let l="Unexpected state";typeof t=="string"?l=t:i=t,s||Sx(e,l,i)}function Nt(s,e){return s}const me={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ue extends ui{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class sa{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class jx{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class r4{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Hs.UNAUTHENTICATED)))}shutdown(){}}class i4{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class a4{constructor(e){this.t=e,this.currentUser=Hs.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){mn(this.o===void 0,42304);let i=this.i;const l=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let u=new sa;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new sa,e.enqueueRetryable((()=>l(this.currentUser)))};const h=()=>{const g=u;e.enqueueRetryable((async()=>{await g.promise,await l(this.currentUser)}))},p=g=>{We("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),h())};this.t.onInit((g=>p(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?p(g):(We("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new sa)}}),0),h()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(We("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(mn(typeof i.accessToken=="string",31837,{l:i}),new jx(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return mn(e===null||typeof e=="string",2055,{h:e}),new Hs(e)}}class o4{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Hs.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class l4{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new o4(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Hs.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class D2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class c4{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Sr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){mn(this.o===void 0,3512);const i=u=>{u.error!=null&&We("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const h=u.token!==this.m;return this.m=u.token,We("FirebaseAppCheckTokenProvider",`Received ${h?"new":"existing"} token.`),h?t(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>i(u)))};const l=u=>{We("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>l(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?l(u):We("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new D2(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(mn(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new D2(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function u4(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<s;i++)t[i]=Math.floor(256*Math.random());return t}class py{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const l=u4(40);for(let u=0;u<l.length;++u)i.length<20&&l[u]<t&&(i+=e.charAt(l[u]%62))}return i}}function Wt(s,e){return s<e?-1:s>e?1:0}function Tg(s,e){const t=Math.min(s.length,e.length);for(let i=0;i<t;i++){const l=s.charAt(i),u=e.charAt(i);if(l!==u)return Vp(l)===Vp(u)?Wt(l,u):Vp(l)?1:-1}return Wt(s.length,e.length)}const h4=55296,d4=57343;function Vp(s){const e=s.charCodeAt(0);return e>=h4&&e<=d4}function Fl(s,e,t){return s.length===e.length&&s.every(((i,l)=>t(i,e[l])))}const M2="__name__";class xi{constructor(e,t,i){t===void 0?t=0:t>e.length&&_t(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&_t(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return xi.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof xi?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let l=0;l<i;l++){const u=xi.compareSegments(e.get(l),t.get(l));if(u!==0)return u}return Wt(e.length,t.length)}static compareSegments(e,t){const i=xi.isNumericId(e),l=xi.isNumericId(t);return i&&!l?-1:!i&&l?1:i&&l?xi.extractNumericId(e).compare(xi.extractNumericId(t)):Tg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ka.fromString(e.substring(4,e.length-2))}}class Mn extends xi{construct(e,t,i){return new Mn(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Ue(me.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((l=>l.length>0)))}return new Mn(t)}static emptyPath(){return new Mn([])}}const f4=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ls extends xi{construct(e,t,i){return new Ls(e,t,i)}static isValidIdentifier(e){return f4.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ls.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===M2}static keyField(){return new Ls([M2])}static fromServerFormat(e){const t=[];let i="",l=0;const u=()=>{if(i.length===0)throw new Ue(me.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let h=!1;for(;l<e.length;){const p=e[l];if(p==="\\"){if(l+1===e.length)throw new Ue(me.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[l+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new Ue(me.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,l+=2}else p==="`"?(h=!h,l++):p!=="."||h?(i+=p,l++):(u(),l++)}if(u(),h)throw new Ue(me.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ls(t)}static emptyPath(){return new Ls([])}}class ot{constructor(e){this.path=e}static fromPath(e){return new ot(Mn.fromString(e))}static fromName(e){return new ot(Mn.fromString(e).popFirst(5))}static empty(){return new ot(Mn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Mn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Mn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ot(new Mn(e.slice()))}}function Cx(s,e,t){if(!t)throw new Ue(me.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function m4(s,e,t,i){if(e===!0&&i===!0)throw new Ue(me.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function L2(s){if(!ot.isDocumentKey(s))throw new Ue(me.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function O2(s){if(ot.isDocumentKey(s))throw new Ue(me.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function Nx(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function rf(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":_t(12329,{type:typeof s})}function tr(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new Ue(me.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=rf(s);throw new Ue(me.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}function p4(s,e){if(e<=0)throw new Ue(me.INVALID_ARGUMENT,`Function ${s}() requires a positive number, but it was: ${e}.`)}function ws(s,e){const t={typeString:s};return e&&(t.value=e),t}function Iu(s,e){if(!Nx(s))throw new Ue(me.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const l=e[i].typeString,u="value"in e[i]?{value:e[i].value}:void 0;if(!(i in s)){t=`JSON missing required field: '${i}'`;break}const h=s[i];if(l&&typeof h!==l){t=`JSON field '${i}' must be a ${l}.`;break}if(u!==void 0&&h!==u.value){t=`Expected '${i}' field to equal '${u.value}'`;break}}if(t)throw new Ue(me.INVALID_ARGUMENT,t);return!0}const P2=-62135596800,V2=1e6;class Gt{static now(){return Gt.fromMillis(Date.now())}static fromDate(e){return Gt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*V2);return new Gt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ue(me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ue(me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<P2)throw new Ue(me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ue(me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/V2}_compareTo(e){return this.seconds===e.seconds?Wt(this.nanoseconds,e.nanoseconds):Wt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Gt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Iu(e,Gt._jsonSchema))return new Gt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-P2;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Gt._jsonSchemaVersion="firestore/timestamp/1.0",Gt._jsonSchema={type:ws("string",Gt._jsonSchemaVersion),seconds:ws("number"),nanoseconds:ws("number")};class jt{static fromTimestamp(e){return new jt(e)}static min(){return new jt(new Gt(0,0))}static max(){return new jt(new Gt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const fu=-1;function g4(s,e){const t=s.toTimestamp().seconds,i=s.toTimestamp().nanoseconds+1,l=jt.fromTimestamp(i===1e9?new Gt(t+1,0):new Gt(t,i));return new Qa(l,ot.empty(),e)}function y4(s){return new Qa(s.readTime,s.key,fu)}class Qa{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Qa(jt.min(),ot.empty(),fu)}static max(){return new Qa(jt.max(),ot.empty(),fu)}}function v4(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=ot.comparator(s.documentKey,e.documentKey),t!==0?t:Wt(s.largestBatchId,e.largestBatchId))}const b4="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class w4{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function ec(s){if(s.code!==me.FAILED_PRECONDITION||s.message!==b4)throw s;We("LocalStore","Unexpectedly lost primary lease")}class be{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&_t(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new be(((i,l)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,l)},this.catchCallback=u=>{this.wrapFailure(t,u).next(i,l)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof be?t:be.resolve(t)}catch(t){return be.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):be.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):be.reject(t)}static resolve(e){return new be(((t,i)=>{t(e)}))}static reject(e){return new be(((t,i)=>{i(e)}))}static waitFor(e){return new be(((t,i)=>{let l=0,u=0,h=!1;e.forEach((p=>{++l,p.next((()=>{++u,h&&u===l&&t()}),(g=>i(g)))})),h=!0,u===l&&t()}))}static or(e){let t=be.resolve(!1);for(const i of e)t=t.next((l=>l?be.resolve(l):i()));return t}static forEach(e,t){const i=[];return e.forEach(((l,u)=>{i.push(t.call(this,l,u))})),this.waitFor(i)}static mapArray(e,t){return new be(((i,l)=>{const u=e.length,h=new Array(u);let p=0;for(let g=0;g<u;g++){const y=g;t(e[y]).next((b=>{h[y]=b,++p,p===u&&i(h)}),(b=>l(b)))}}))}static doWhile(e,t){return new be(((i,l)=>{const u=()=>{e()===!0?t().next((()=>{u()}),l):i()};u()}))}}function _4(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function tc(s){return s.name==="IndexedDbTransactionError"}class af{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}af.ce=-1;const gy=-1;function of(s){return s==null}function Ud(s){return s===0&&1/s==-1/0}function x4(s){return typeof s=="number"&&Number.isInteger(s)&&!Ud(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}const Ax="";function E4(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=U2(e)),e=T4(s.get(t),e);return U2(e)}function T4(s,e){let t=e;const i=s.length;for(let l=0;l<i;l++){const u=s.charAt(l);switch(u){case"\0":t+="";break;case Ax:t+="";break;default:t+=u}}return t}function U2(s){return s+Ax+""}function B2(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function ro(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function Rx(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}class Qn{constructor(e,t){this.comparator=e,this.root=t||Ms.EMPTY}insert(e,t){return new Qn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ms.BLACK,null,null))}remove(e){return new Qn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ms.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const l=this.comparator(e,i.key);if(l===0)return t+i.left.size;l<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new id(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new id(this.root,e,this.comparator,!1)}getReverseIterator(){return new id(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new id(this.root,e,this.comparator,!0)}}class id{constructor(e,t,i,l){this.isReverse=l,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?i(e.key,t):1,t&&l&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ms{constructor(e,t,i,l,u){this.key=e,this.value=t,this.color=i??Ms.RED,this.left=l??Ms.EMPTY,this.right=u??Ms.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,l,u){return new Ms(e??this.key,t??this.value,i??this.color,l??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let l=this;const u=i(e,l.key);return l=u<0?l.copy(null,null,null,l.left.insert(e,t,i),null):u===0?l.copy(null,t,null,null,null):l.copy(null,null,null,null,l.right.insert(e,t,i)),l.fixUp()}removeMin(){if(this.left.isEmpty())return Ms.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,l=this;if(t(e,l.key)<0)l.left.isEmpty()||l.left.isRed()||l.left.left.isRed()||(l=l.moveRedLeft()),l=l.copy(null,null,null,l.left.remove(e,t),null);else{if(l.left.isRed()&&(l=l.rotateRight()),l.right.isEmpty()||l.right.isRed()||l.right.left.isRed()||(l=l.moveRedRight()),t(e,l.key)===0){if(l.right.isEmpty())return Ms.EMPTY;i=l.right.min(),l=l.copy(i.key,i.value,null,null,l.right.removeMin())}l=l.copy(null,null,null,null,l.right.remove(e,t))}return l.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ms.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ms.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw _t(43730,{key:this.key,value:this.value});if(this.right.isRed())throw _t(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw _t(27949);return e+(this.isRed()?0:1)}}Ms.EMPTY=null,Ms.RED=!0,Ms.BLACK=!1;Ms.EMPTY=new class{constructor(){this.size=0}get key(){throw _t(57766)}get value(){throw _t(16141)}get color(){throw _t(16727)}get left(){throw _t(29726)}get right(){throw _t(36894)}copy(e,t,i,l,u){return this}insert(e,t,i){return new Ms(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ts{constructor(e){this.comparator=e,this.data=new Qn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const l=i.getNext();if(this.comparator(l.key,e[1])>=0)return;t(l.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new z2(this.data.getIterator())}getIteratorFrom(e){return new z2(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Ts)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(this.comparator(l,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Ts(this.comparator);return t.data=e,t}}class z2{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Cr{constructor(e){this.fields=e,e.sort(Ls.comparator)}static empty(){return new Cr([])}unionWith(e){let t=new Ts(Ls.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Cr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Fl(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class Ix extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ps{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(l){try{return atob(l)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new Ix("Invalid base64 string: "+u):u}})(e);return new Ps(t)}static fromUint8Array(e){const t=(function(l){let u="";for(let h=0;h<l.length;++h)u+=String.fromCharCode(l[h]);return u})(e);return new Ps(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Wt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ps.EMPTY_BYTE_STRING=new Ps("");const k4=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Xa(s){if(mn(!!s,39018),typeof s=="string"){let e=0;const t=k4.exec(s);if(mn(!!t,46558,{timestamp:s}),t[1]){let l=t[1];l=(l+"000000000").substr(0,9),e=Number(l)}const i=new Date(s);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:hs(s.seconds),nanos:hs(s.nanos)}}function hs(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function Ja(s){return typeof s=="string"?Ps.fromBase64String(s):Ps.fromUint8Array(s)}const Dx="server_timestamp",Mx="__type__",Lx="__previous_value__",Ox="__local_write_time__";function yy(s){return(s?.mapValue?.fields||{})[Mx]?.stringValue===Dx}function lf(s){const e=s.mapValue.fields[Lx];return yy(e)?lf(e):e}function mu(s){const e=Xa(s.mapValue.fields[Ox].timestampValue);return new Gt(e.seconds,e.nanos)}class S4{constructor(e,t,i,l,u,h,p,g,y,b,E){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=l,this.ssl=u,this.forceLongPolling=h,this.autoDetectLongPolling=p,this.longPollingOptions=g,this.useFetchStreams=y,this.isUsingEmulator=b,this.apiKey=E}}const Bd="(default)";class pu{constructor(e,t){this.projectId=e,this.database=t||Bd}static empty(){return new pu("","")}get isDefaultDatabase(){return this.database===Bd}isEqual(e){return e instanceof pu&&e.projectId===this.projectId&&e.database===this.database}}function j4(s,e){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new Ue(me.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new pu(s.options.projectId,e)}const Px="__type__",C4="__max__",ad={mapValue:{}},Vx="__vector__",zd="value";function Za(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?yy(s)?4:A4(s)?9007199254740991:N4(s)?10:11:_t(28295,{value:s})}function Ni(s,e){if(s===e)return!0;const t=Za(s);if(t!==Za(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return mu(s).isEqual(mu(e));case 3:return(function(l,u){if(typeof l.timestampValue=="string"&&typeof u.timestampValue=="string"&&l.timestampValue.length===u.timestampValue.length)return l.timestampValue===u.timestampValue;const h=Xa(l.timestampValue),p=Xa(u.timestampValue);return h.seconds===p.seconds&&h.nanos===p.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(l,u){return Ja(l.bytesValue).isEqual(Ja(u.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(l,u){return hs(l.geoPointValue.latitude)===hs(u.geoPointValue.latitude)&&hs(l.geoPointValue.longitude)===hs(u.geoPointValue.longitude)})(s,e);case 2:return(function(l,u){if("integerValue"in l&&"integerValue"in u)return hs(l.integerValue)===hs(u.integerValue);if("doubleValue"in l&&"doubleValue"in u){const h=hs(l.doubleValue),p=hs(u.doubleValue);return h===p?Ud(h)===Ud(p):isNaN(h)&&isNaN(p)}return!1})(s,e);case 9:return Fl(s.arrayValue.values||[],e.arrayValue.values||[],Ni);case 10:case 11:return(function(l,u){const h=l.mapValue.fields||{},p=u.mapValue.fields||{};if(B2(h)!==B2(p))return!1;for(const g in h)if(h.hasOwnProperty(g)&&(p[g]===void 0||!Ni(h[g],p[g])))return!1;return!0})(s,e);default:return _t(52216,{left:s})}}function gu(s,e){return(s.values||[]).find((t=>Ni(t,e)))!==void 0}function ql(s,e){if(s===e)return 0;const t=Za(s),i=Za(e);if(t!==i)return Wt(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Wt(s.booleanValue,e.booleanValue);case 2:return(function(u,h){const p=hs(u.integerValue||u.doubleValue),g=hs(h.integerValue||h.doubleValue);return p<g?-1:p>g?1:p===g?0:isNaN(p)?isNaN(g)?0:-1:1})(s,e);case 3:return F2(s.timestampValue,e.timestampValue);case 4:return F2(mu(s),mu(e));case 5:return Tg(s.stringValue,e.stringValue);case 6:return(function(u,h){const p=Ja(u),g=Ja(h);return p.compareTo(g)})(s.bytesValue,e.bytesValue);case 7:return(function(u,h){const p=u.split("/"),g=h.split("/");for(let y=0;y<p.length&&y<g.length;y++){const b=Wt(p[y],g[y]);if(b!==0)return b}return Wt(p.length,g.length)})(s.referenceValue,e.referenceValue);case 8:return(function(u,h){const p=Wt(hs(u.latitude),hs(h.latitude));return p!==0?p:Wt(hs(u.longitude),hs(h.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return q2(s.arrayValue,e.arrayValue);case 10:return(function(u,h){const p=u.fields||{},g=h.fields||{},y=p[zd]?.arrayValue,b=g[zd]?.arrayValue,E=Wt(y?.values?.length||0,b?.values?.length||0);return E!==0?E:q2(y,b)})(s.mapValue,e.mapValue);case 11:return(function(u,h){if(u===ad.mapValue&&h===ad.mapValue)return 0;if(u===ad.mapValue)return 1;if(h===ad.mapValue)return-1;const p=u.fields||{},g=Object.keys(p),y=h.fields||{},b=Object.keys(y);g.sort(),b.sort();for(let E=0;E<g.length&&E<b.length;++E){const T=Tg(g[E],b[E]);if(T!==0)return T;const O=ql(p[g[E]],y[b[E]]);if(O!==0)return O}return Wt(g.length,b.length)})(s.mapValue,e.mapValue);default:throw _t(23264,{he:t})}}function F2(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return Wt(s,e);const t=Xa(s),i=Xa(e),l=Wt(t.seconds,i.seconds);return l!==0?l:Wt(t.nanos,i.nanos)}function q2(s,e){const t=s.values||[],i=e.values||[];for(let l=0;l<t.length&&l<i.length;++l){const u=ql(t[l],i[l]);if(u)return u}return Wt(t.length,i.length)}function Hl(s){return kg(s)}function kg(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(t){const i=Xa(t);return`time(${i.seconds},${i.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(t){return Ja(t).toBase64()})(s.bytesValue):"referenceValue"in s?(function(t){return ot.fromName(t).toString()})(s.referenceValue):"geoPointValue"in s?(function(t){return`geo(${t.latitude},${t.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(t){let i="[",l=!0;for(const u of t.values||[])l?l=!1:i+=",",i+=kg(u);return i+"]"})(s.arrayValue):"mapValue"in s?(function(t){const i=Object.keys(t.fields||{}).sort();let l="{",u=!0;for(const h of i)u?u=!1:l+=",",l+=`${h}:${kg(t.fields[h])}`;return l+"}"})(s.mapValue):_t(61005,{value:s})}function Ed(s){switch(Za(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=lf(s);return e?16+Ed(e):16;case 5:return 2*s.stringValue.length;case 6:return Ja(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((l,u)=>l+Ed(u)),0)})(s.arrayValue);case 10:case 11:return(function(i){let l=0;return ro(i.fields,((u,h)=>{l+=u.length+Ed(h)})),l})(s.mapValue);default:throw _t(13486,{value:s})}}function H2(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function Sg(s){return!!s&&"integerValue"in s}function vy(s){return!!s&&"arrayValue"in s}function $2(s){return!!s&&"nullValue"in s}function W2(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function Td(s){return!!s&&"mapValue"in s}function N4(s){return(s?.mapValue?.fields||{})[Px]?.stringValue===Vx}function ru(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return ro(s.mapValue.fields,((t,i)=>e.mapValue.fields[t]=ru(i))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ru(s.arrayValue.values[t]);return e}return{...s}}function A4(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===C4}class dr{constructor(e){this.value=e}static empty(){return new dr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Td(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ru(t)}setAll(e){let t=Ls.emptyPath(),i={},l=[];e.forEach(((h,p)=>{if(!t.isImmediateParentOf(p)){const g=this.getFieldsMap(t);this.applyChanges(g,i,l),i={},l=[],t=p.popLast()}h?i[p.lastSegment()]=ru(h):l.push(p.lastSegment())}));const u=this.getFieldsMap(t);this.applyChanges(u,i,l)}delete(e){const t=this.field(e.popLast());Td(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ni(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let l=t.mapValue.fields[e.get(i)];Td(l)&&l.mapValue.fields||(l={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=l),t=l}return t.mapValue.fields}applyChanges(e,t,i){ro(t,((l,u)=>e[l]=u));for(const l of i)delete e[l]}clone(){return new dr(ru(this.value))}}function Ux(s){const e=[];return ro(s.fields,((t,i)=>{const l=new Ls([t]);if(Td(i)){const u=Ux(i.mapValue).fields;if(u.length===0)e.push(l);else for(const h of u)e.push(l.child(h))}else e.push(l)})),new Cr(e)}class $s{constructor(e,t,i,l,u,h,p){this.key=e,this.documentType=t,this.version=i,this.readTime=l,this.createTime=u,this.data=h,this.documentState=p}static newInvalidDocument(e){return new $s(e,0,jt.min(),jt.min(),jt.min(),dr.empty(),0)}static newFoundDocument(e,t,i,l){return new $s(e,1,t,jt.min(),i,l,0)}static newNoDocument(e,t){return new $s(e,2,t,jt.min(),jt.min(),dr.empty(),0)}static newUnknownDocument(e,t){return new $s(e,3,t,jt.min(),jt.min(),dr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(jt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=dr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=dr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=jt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof $s&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new $s(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Fd{constructor(e,t){this.position=e,this.inclusive=t}}function G2(s,e,t){let i=0;for(let l=0;l<s.position.length;l++){const u=e[l],h=s.position[l];if(u.field.isKeyField()?i=ot.comparator(ot.fromName(h.referenceValue),t.key):i=ql(h,t.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function K2(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!Ni(s.position[t],e.position[t]))return!1;return!0}class yu{constructor(e,t="asc"){this.field=e,this.dir=t}}function R4(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}class Bx{}class bs extends Bx{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new D4(e,t,i):t==="array-contains"?new O4(e,i):t==="in"?new P4(e,i):t==="not-in"?new V4(e,i):t==="array-contains-any"?new U4(e,i):new bs(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new M4(e,i):new L4(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(ql(t,this.value)):t!==null&&Za(this.value)===Za(t)&&this.matchesComparison(ql(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return _t(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class li extends Bx{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new li(e,t)}matches(e){return zx(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function zx(s){return s.op==="and"}function Fx(s){return I4(s)&&zx(s)}function I4(s){for(const e of s.filters)if(e instanceof li)return!1;return!0}function jg(s){if(s instanceof bs)return s.field.canonicalString()+s.op.toString()+Hl(s.value);if(Fx(s))return s.filters.map((e=>jg(e))).join(",");{const e=s.filters.map((t=>jg(t))).join(",");return`${s.op}(${e})`}}function qx(s,e){return s instanceof bs?(function(i,l){return l instanceof bs&&i.op===l.op&&i.field.isEqual(l.field)&&Ni(i.value,l.value)})(s,e):s instanceof li?(function(i,l){return l instanceof li&&i.op===l.op&&i.filters.length===l.filters.length?i.filters.reduce(((u,h,p)=>u&&qx(h,l.filters[p])),!0):!1})(s,e):void _t(19439)}function Hx(s){return s instanceof bs?(function(t){return`${t.field.canonicalString()} ${t.op} ${Hl(t.value)}`})(s):s instanceof li?(function(t){return t.op.toString()+" {"+t.getFilters().map(Hx).join(" ,")+"}"})(s):"Filter"}class D4 extends bs{constructor(e,t,i){super(e,t,i),this.key=ot.fromName(i.referenceValue)}matches(e){const t=ot.comparator(e.key,this.key);return this.matchesComparison(t)}}class M4 extends bs{constructor(e,t){super(e,"in",t),this.keys=$x("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class L4 extends bs{constructor(e,t){super(e,"not-in",t),this.keys=$x("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function $x(s,e){return(e.arrayValue?.values||[]).map((t=>ot.fromName(t.referenceValue)))}class O4 extends bs{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return vy(t)&&gu(t.arrayValue,this.value)}}class P4 extends bs{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&gu(this.value.arrayValue,t)}}class V4 extends bs{constructor(e,t){super(e,"not-in",t)}matches(e){if(gu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!gu(this.value.arrayValue,t)}}class U4 extends bs{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!vy(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>gu(this.value.arrayValue,i)))}}class B4{constructor(e,t=null,i=[],l=[],u=null,h=null,p=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=l,this.limit=u,this.startAt=h,this.endAt=p,this.Te=null}}function Y2(s,e=null,t=[],i=[],l=null,u=null,h=null){return new B4(s,e,t,i,l,u,h)}function by(s){const e=Nt(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>jg(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(u){return u.field.canonicalString()+u.dir})(i))).join(","),of(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Hl(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Hl(i))).join(",")),e.Te=t}return e.Te}function wy(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!R4(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!qx(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!K2(s.startAt,e.startAt)&&K2(s.endAt,e.endAt)}function Cg(s){return ot.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}class nc{constructor(e,t=null,i=[],l=[],u=null,h="F",p=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=l,this.limit=u,this.limitType=h,this.startAt=p,this.endAt=g,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function z4(s,e,t,i,l,u,h,p){return new nc(s,e,t,i,l,u,h,p)}function cf(s){return new nc(s)}function Q2(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function F4(s){return ot.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function Wx(s){return s.collectionGroup!==null}function iu(s){const e=Nt(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),t.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(h){let p=new Ts(Ls.comparator);return h.filters.forEach((g=>{g.getFlattenedFilters().forEach((y=>{y.isInequality()&&(p=p.add(y.field))}))})),p})(e).forEach((u=>{t.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new yu(u,i))})),t.has(Ls.keyField().canonicalString())||e.Ie.push(new yu(Ls.keyField(),i))}return e.Ie}function Si(s){const e=Nt(s);return e.Ee||(e.Ee=q4(e,iu(s))),e.Ee}function q4(s,e){if(s.limitType==="F")return Y2(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((l=>{const u=l.dir==="desc"?"asc":"desc";return new yu(l.field,u)}));const t=s.endAt?new Fd(s.endAt.position,s.endAt.inclusive):null,i=s.startAt?new Fd(s.startAt.position,s.startAt.inclusive):null;return Y2(s.path,s.collectionGroup,e,s.filters,s.limit,t,i)}}function Ng(s,e){const t=s.filters.concat([e]);return new nc(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function H4(s,e){const t=s.explicitOrderBy.concat([e]);return new nc(s.path,s.collectionGroup,t,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}function qd(s,e,t){return new nc(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function uf(s,e){return wy(Si(s),Si(e))&&s.limitType===e.limitType}function Gx(s){return`${by(Si(s))}|lt:${s.limitType}`}function Il(s){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((l=>Hx(l))).join(", ")}]`),of(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((l=>(function(h){return`${h.field.canonicalString()} (${h.dir})`})(l))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((l=>Hl(l))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((l=>Hl(l))).join(",")),`Target(${i})`})(Si(s))}; limitType=${s.limitType})`}function hf(s,e){return e.isFoundDocument()&&(function(i,l){const u=l.key.path;return i.collectionGroup!==null?l.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):ot.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)})(s,e)&&(function(i,l){for(const u of iu(i))if(!u.field.isKeyField()&&l.data.field(u.field)===null)return!1;return!0})(s,e)&&(function(i,l){for(const u of i.filters)if(!u.matches(l))return!1;return!0})(s,e)&&(function(i,l){return!(i.startAt&&!(function(h,p,g){const y=G2(h,p,g);return h.inclusive?y<=0:y<0})(i.startAt,iu(i),l)||i.endAt&&!(function(h,p,g){const y=G2(h,p,g);return h.inclusive?y>=0:y>0})(i.endAt,iu(i),l))})(s,e)}function $4(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function Kx(s){return(e,t)=>{let i=!1;for(const l of iu(s)){const u=W4(l,e,t);if(u!==0)return u;i=i||l.field.isKeyField()}return 0}}function W4(s,e,t){const i=s.field.isKeyField()?ot.comparator(e.key,t.key):(function(u,h,p){const g=h.data.field(u),y=p.data.field(u);return g!==null&&y!==null?ql(g,y):_t(42886)})(s.field,e,t);switch(s.dir){case"asc":return i;case"desc":return-1*i;default:return _t(19790,{direction:s.dir})}}class Go{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[l,u]of i)if(this.equalsFn(l,e))return u}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),l=this.inner[i];if(l===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let u=0;u<l.length;u++)if(this.equalsFn(l[u][0],e))return void(l[u]=[e,t]);l.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let l=0;l<i.length;l++)if(this.equalsFn(i[l][0],e))return i.length===1?delete this.inner[t]:i.splice(l,1),this.innerSize--,!0;return!1}forEach(e){ro(this.inner,((t,i)=>{for(const[l,u]of i)e(l,u)}))}isEmpty(){return Rx(this.inner)}size(){return this.innerSize}}const G4=new Qn(ot.comparator);function ca(){return G4}const Yx=new Qn(ot.comparator);function Zc(...s){let e=Yx;for(const t of s)e=e.insert(t.key,t);return e}function Qx(s){let e=Yx;return s.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function No(){return au()}function Xx(){return au()}function au(){return new Go((s=>s.toString()),((s,e)=>s.isEqual(e)))}const K4=new Qn(ot.comparator),Y4=new Ts(ot.comparator);function Kt(...s){let e=Y4;for(const t of s)e=e.add(t);return e}const Q4=new Ts(Wt);function X4(){return Q4}function _y(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ud(e)?"-0":e}}function Jx(s){return{integerValue:""+s}}function Zx(s,e){return x4(e)?Jx(e):_y(s,e)}class df{constructor(){this._=void 0}}function J4(s,e,t){return s instanceof vu?(function(l,u){const h={fields:{[Mx]:{stringValue:Dx},[Ox]:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}};return u&&yy(u)&&(u=lf(u)),u&&(h.fields[Lx]=u),{mapValue:h}})(t,e):s instanceof $l?tE(s,e):s instanceof Wl?nE(s,e):(function(l,u){const h=eE(l,u),p=X2(h)+X2(l.Ae);return Sg(h)&&Sg(l.Ae)?Jx(p):_y(l.serializer,p)})(s,e)}function Z4(s,e,t){return s instanceof $l?tE(s,e):s instanceof Wl?nE(s,e):t}function eE(s,e){return s instanceof bu?(function(i){return Sg(i)||(function(u){return!!u&&"doubleValue"in u})(i)})(e)?e:{integerValue:0}:null}class vu extends df{}class $l extends df{constructor(e){super(),this.elements=e}}function tE(s,e){const t=sE(e);for(const i of s.elements)t.some((l=>Ni(l,i)))||t.push(i);return{arrayValue:{values:t}}}class Wl extends df{constructor(e){super(),this.elements=e}}function nE(s,e){let t=sE(e);for(const i of s.elements)t=t.filter((l=>!Ni(l,i)));return{arrayValue:{values:t}}}class bu extends df{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function X2(s){return hs(s.integerValue||s.doubleValue)}function sE(s){return vy(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}class ff{constructor(e,t){this.field=e,this.transform=t}}function eI(s,e){return s.field.isEqual(e.field)&&(function(i,l){return i instanceof $l&&l instanceof $l||i instanceof Wl&&l instanceof Wl?Fl(i.elements,l.elements,Ni):i instanceof bu&&l instanceof bu?Ni(i.Ae,l.Ae):i instanceof vu&&l instanceof vu})(s.transform,e.transform)}class tI{constructor(e,t){this.version=e,this.transformResults=t}}class nr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new nr}static exists(e){return new nr(void 0,e)}static updateTime(e){return new nr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function kd(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class mf{}function rE(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new pf(s.key,nr.none()):new Du(s.key,s.data,nr.none());{const t=s.data,i=dr.empty();let l=new Ts(Ls.comparator);for(let u of e.fields)if(!l.has(u)){let h=t.field(u);h===null&&u.length>1&&(u=u.popLast(),h=t.field(u)),h===null?i.delete(u):i.set(u,h),l=l.add(u)}return new io(s.key,i,new Cr(l.toArray()),nr.none())}}function nI(s,e,t){s instanceof Du?(function(l,u,h){const p=l.value.clone(),g=Z2(l.fieldTransforms,u,h.transformResults);p.setAll(g),u.convertToFoundDocument(h.version,p).setHasCommittedMutations()})(s,e,t):s instanceof io?(function(l,u,h){if(!kd(l.precondition,u))return void u.convertToUnknownDocument(h.version);const p=Z2(l.fieldTransforms,u,h.transformResults),g=u.data;g.setAll(iE(l)),g.setAll(p),u.convertToFoundDocument(h.version,g).setHasCommittedMutations()})(s,e,t):(function(l,u,h){u.convertToNoDocument(h.version).setHasCommittedMutations()})(0,e,t)}function ou(s,e,t,i){return s instanceof Du?(function(u,h,p,g){if(!kd(u.precondition,h))return p;const y=u.value.clone(),b=ew(u.fieldTransforms,g,h);return y.setAll(b),h.convertToFoundDocument(h.version,y).setHasLocalMutations(),null})(s,e,t,i):s instanceof io?(function(u,h,p,g){if(!kd(u.precondition,h))return p;const y=ew(u.fieldTransforms,g,h),b=h.data;return b.setAll(iE(u)),b.setAll(y),h.convertToFoundDocument(h.version,b).setHasLocalMutations(),p===null?null:p.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((E=>E.field)))})(s,e,t,i):(function(u,h,p){return kd(u.precondition,h)?(h.convertToNoDocument(h.version).setHasLocalMutations(),null):p})(s,e,t)}function sI(s,e){let t=null;for(const i of s.fieldTransforms){const l=e.data.field(i.field),u=eE(i.transform,l||null);u!=null&&(t===null&&(t=dr.empty()),t.set(i.field,u))}return t||null}function J2(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(i,l){return i===void 0&&l===void 0||!(!i||!l)&&Fl(i,l,((u,h)=>eI(u,h)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class Du extends mf{constructor(e,t,i,l=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=l,this.type=0}getFieldMask(){return null}}class io extends mf{constructor(e,t,i,l,u=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=l,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function iE(s){const e=new Map;return s.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=s.data.field(t);e.set(t,i)}})),e}function Z2(s,e,t){const i=new Map;mn(s.length===t.length,32656,{Ve:t.length,de:s.length});for(let l=0;l<t.length;l++){const u=s[l],h=u.transform,p=e.data.field(u.field);i.set(u.field,Z4(h,p,t[l]))}return i}function ew(s,e,t){const i=new Map;for(const l of s){const u=l.transform,h=t.data.field(l.field);i.set(l.field,J4(u,h,e))}return i}class pf extends mf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class rI extends mf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class iI{constructor(e,t,i,l){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=l}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let l=0;l<this.mutations.length;l++){const u=this.mutations[l];u.key.isEqual(e.key)&&nI(u,e,i[l])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=ou(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=ou(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=Xx();return this.mutations.forEach((l=>{const u=e.get(l.key),h=u.overlayedDocument;let p=this.applyToLocalView(h,u.mutatedFields);p=t.has(l.key)?null:p;const g=rE(h,p);g!==null&&i.set(l.key,g),h.isValidDocument()||h.convertToNoDocument(jt.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Kt())}isEqual(e){return this.batchId===e.batchId&&Fl(this.mutations,e.mutations,((t,i)=>J2(t,i)))&&Fl(this.baseMutations,e.baseMutations,((t,i)=>J2(t,i)))}}class xy{constructor(e,t,i,l){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=l}static from(e,t,i){mn(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let l=(function(){return K4})();const u=e.mutations;for(let h=0;h<u.length;h++)l=l.insert(u[h].key,i[h].version);return new xy(e,t,i,l)}}class aI{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class oI{constructor(e,t){this.count=e,this.unchangedNames=t}}var vs,en;function lI(s){switch(s){case me.OK:return _t(64938);case me.CANCELLED:case me.UNKNOWN:case me.DEADLINE_EXCEEDED:case me.RESOURCE_EXHAUSTED:case me.INTERNAL:case me.UNAVAILABLE:case me.UNAUTHENTICATED:return!1;case me.INVALID_ARGUMENT:case me.NOT_FOUND:case me.ALREADY_EXISTS:case me.PERMISSION_DENIED:case me.FAILED_PRECONDITION:case me.ABORTED:case me.OUT_OF_RANGE:case me.UNIMPLEMENTED:case me.DATA_LOSS:return!0;default:return _t(15467,{code:s})}}function aE(s){if(s===void 0)return la("GRPC error has no .code"),me.UNKNOWN;switch(s){case vs.OK:return me.OK;case vs.CANCELLED:return me.CANCELLED;case vs.UNKNOWN:return me.UNKNOWN;case vs.DEADLINE_EXCEEDED:return me.DEADLINE_EXCEEDED;case vs.RESOURCE_EXHAUSTED:return me.RESOURCE_EXHAUSTED;case vs.INTERNAL:return me.INTERNAL;case vs.UNAVAILABLE:return me.UNAVAILABLE;case vs.UNAUTHENTICATED:return me.UNAUTHENTICATED;case vs.INVALID_ARGUMENT:return me.INVALID_ARGUMENT;case vs.NOT_FOUND:return me.NOT_FOUND;case vs.ALREADY_EXISTS:return me.ALREADY_EXISTS;case vs.PERMISSION_DENIED:return me.PERMISSION_DENIED;case vs.FAILED_PRECONDITION:return me.FAILED_PRECONDITION;case vs.ABORTED:return me.ABORTED;case vs.OUT_OF_RANGE:return me.OUT_OF_RANGE;case vs.UNIMPLEMENTED:return me.UNIMPLEMENTED;case vs.DATA_LOSS:return me.DATA_LOSS;default:return _t(39323,{code:s})}}(en=vs||(vs={}))[en.OK=0]="OK",en[en.CANCELLED=1]="CANCELLED",en[en.UNKNOWN=2]="UNKNOWN",en[en.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",en[en.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",en[en.NOT_FOUND=5]="NOT_FOUND",en[en.ALREADY_EXISTS=6]="ALREADY_EXISTS",en[en.PERMISSION_DENIED=7]="PERMISSION_DENIED",en[en.UNAUTHENTICATED=16]="UNAUTHENTICATED",en[en.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",en[en.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",en[en.ABORTED=10]="ABORTED",en[en.OUT_OF_RANGE=11]="OUT_OF_RANGE",en[en.UNIMPLEMENTED=12]="UNIMPLEMENTED",en[en.INTERNAL=13]="INTERNAL",en[en.UNAVAILABLE=14]="UNAVAILABLE",en[en.DATA_LOSS=15]="DATA_LOSS";function cI(){return new TextEncoder}const uI=new Ka([4294967295,4294967295],0);function tw(s){const e=cI().encode(s),t=new wx;return t.update(e),new Uint8Array(t.digest())}function nw(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),l=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new Ka([t,i],0),new Ka([l,u],0)]}class Ey{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new eu(`Invalid padding: ${t}`);if(i<0)throw new eu(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new eu(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new eu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Ka.fromNumber(this.ge)}ye(e,t,i){let l=e.add(t.multiply(Ka.fromNumber(i)));return l.compare(uI)===1&&(l=new Ka([l.getBits(0),l.getBits(1)],0)),l.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=tw(e),[i,l]=nw(t);for(let u=0;u<this.hashCount;u++){const h=this.ye(i,l,u);if(!this.we(h))return!1}return!0}static create(e,t,i){const l=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),h=new Ey(u,l,t);return i.forEach((p=>h.insert(p))),h}insert(e){if(this.ge===0)return;const t=tw(e),[i,l]=nw(t);for(let u=0;u<this.hashCount;u++){const h=this.ye(i,l,u);this.be(h)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class eu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class gf{constructor(e,t,i,l,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=l,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const l=new Map;return l.set(e,Mu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new gf(jt.min(),l,new Qn(Wt),ca(),Kt())}}class Mu{constructor(e,t,i,l,u){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=l,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Mu(i,t,Kt(),Kt(),Kt())}}class Sd{constructor(e,t,i,l){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=l}}class oE{constructor(e,t){this.targetId=e,this.Ce=t}}class lE{constructor(e,t,i=Ps.EMPTY_BYTE_STRING,l=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=l}}class sw{constructor(){this.ve=0,this.Fe=rw(),this.Me=Ps.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Kt(),t=Kt(),i=Kt();return this.Fe.forEach(((l,u)=>{switch(u){case 0:e=e.add(l);break;case 2:t=t.add(l);break;case 1:i=i.add(l);break;default:_t(38017,{changeType:u})}})),new Mu(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=rw()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,mn(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class hI{constructor(e){this.Ge=e,this.ze=new Map,this.je=ca(),this.He=od(),this.Je=od(),this.Ze=new Qn(Wt)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:_t(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,l)=>{this.rt(l)&&t(l)}))}st(e){const t=e.targetId,i=e.Ce.count,l=this.ot(t);if(l){const u=l.target;if(Cg(u))if(i===0){const h=new ot(u.path);this.et(t,h,$s.newNoDocument(h,jt.min()))}else mn(i===1,20013,{expectedCount:i});else{const h=this._t(t);if(h!==i){const p=this.ut(e),g=p?this.ct(p,e,h):1;if(g!==0){this.it(t);const y=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,y)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:l=0},hashCount:u=0}=t;let h,p;try{h=Ja(i).toUint8Array()}catch(g){if(g instanceof Ix)return zl("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{p=new Ey(h,l,u)}catch(g){return zl(g instanceof eu?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return p.ge===0?null:p}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let l=0;return i.forEach((u=>{const h=this.Ge.ht(),p=`projects/${h.projectId}/databases/${h.database}/documents/${u.path.canonicalString()}`;e.mightContain(p)||(this.et(t,u,null),l++)})),l}Tt(e){const t=new Map;this.ze.forEach(((u,h)=>{const p=this.ot(h);if(p){if(u.current&&Cg(p.target)){const g=new ot(p.target.path);this.It(g).has(h)||this.Et(h,g)||this.et(h,g,$s.newNoDocument(g,e))}u.Be&&(t.set(h,u.ke()),u.Ke())}}));let i=Kt();this.Je.forEach(((u,h)=>{let p=!0;h.forEachWhile((g=>{const y=this.ot(g);return!y||y.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(i=i.add(u))})),this.je.forEach(((u,h)=>h.setReadTime(e)));const l=new gf(e,t,this.Ze,this.je,i);return this.je=ca(),this.He=od(),this.Je=od(),this.Ze=new Qn(Wt),l}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const l=this.nt(e);this.Et(e,t)?l.qe(t,1):l.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new sw,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Ts(Wt),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Ts(Wt),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||We("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new sw),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function od(){return new Qn(ot.comparator)}function rw(){return new Qn(ot.comparator)}const dI={asc:"ASCENDING",desc:"DESCENDING"},fI={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},mI={and:"AND",or:"OR"};class pI{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Ag(s,e){return s.useProto3Json||of(e)?e:{value:e}}function Hd(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function cE(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function gI(s,e){return Hd(s,e.toTimestamp())}function ji(s){return mn(!!s,49232),jt.fromTimestamp((function(t){const i=Xa(t);return new Gt(i.seconds,i.nanos)})(s))}function Ty(s,e){return Rg(s,e).canonicalString()}function Rg(s,e){const t=(function(l){return new Mn(["projects",l.projectId,"databases",l.database])})(s).child("documents");return e===void 0?t:t.child(e)}function uE(s){const e=Mn.fromString(s);return mn(pE(e),10190,{key:e.toString()}),e}function Ig(s,e){return Ty(s.databaseId,e.path)}function Up(s,e){const t=uE(e);if(t.get(1)!==s.databaseId.projectId)throw new Ue(me.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new Ue(me.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new ot(dE(t))}function hE(s,e){return Ty(s.databaseId,e)}function yI(s){const e=uE(s);return e.length===4?Mn.emptyPath():dE(e)}function Dg(s){return new Mn(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function dE(s){return mn(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function iw(s,e,t){return{name:Ig(s,e),fields:t.value.mapValue.fields}}function vI(s,e){let t;if("targetChange"in e){e.targetChange;const i=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:_t(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),l=e.targetChange.targetIds||[],u=(function(y,b){return y.useProto3Json?(mn(b===void 0||typeof b=="string",58123),Ps.fromBase64String(b||"")):(mn(b===void 0||b instanceof Buffer||b instanceof Uint8Array,16193),Ps.fromUint8Array(b||new Uint8Array))})(s,e.targetChange.resumeToken),h=e.targetChange.cause,p=h&&(function(y){const b=y.code===void 0?me.UNKNOWN:aE(y.code);return new Ue(b,y.message||"")})(h);t=new lE(i,l,u,p||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const l=Up(s,i.document.name),u=ji(i.document.updateTime),h=i.document.createTime?ji(i.document.createTime):jt.min(),p=new dr({mapValue:{fields:i.document.fields}}),g=$s.newFoundDocument(l,u,h,p),y=i.targetIds||[],b=i.removedTargetIds||[];t=new Sd(y,b,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const l=Up(s,i.document),u=i.readTime?ji(i.readTime):jt.min(),h=$s.newNoDocument(l,u),p=i.removedTargetIds||[];t=new Sd([],p,h.key,h)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const l=Up(s,i.document),u=i.removedTargetIds||[];t=new Sd([],u,l,null)}else{if(!("filter"in e))return _t(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:l=0,unchangedNames:u}=i,h=new oI(l,u),p=i.targetId;t=new oE(p,h)}}return t}function bI(s,e){let t;if(e instanceof Du)t={update:iw(s,e.key,e.value)};else if(e instanceof pf)t={delete:Ig(s,e.key)};else if(e instanceof io)t={update:iw(s,e.key,e.data),updateMask:CI(e.fieldMask)};else{if(!(e instanceof rI))return _t(16599,{dt:e.type});t={verify:Ig(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(u,h){const p=h.transform;if(p instanceof vu)return{fieldPath:h.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof $l)return{fieldPath:h.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof Wl)return{fieldPath:h.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof bu)return{fieldPath:h.field.canonicalString(),increment:p.Ae};throw _t(20930,{transform:h.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(l,u){return u.updateTime!==void 0?{updateTime:gI(l,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:_t(27497)})(s,e.precondition)),t}function wI(s,e){return s&&s.length>0?(mn(e!==void 0,14353),s.map((t=>(function(l,u){let h=l.updateTime?ji(l.updateTime):ji(u);return h.isEqual(jt.min())&&(h=ji(u)),new tI(h,l.transformResults||[])})(t,e)))):[]}function _I(s,e){return{documents:[hE(s,e.path)]}}function xI(s,e){const t={structuredQuery:{}},i=e.path;let l;e.collectionGroup!==null?(l=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(l=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=hE(s,l);const u=(function(y){if(y.length!==0)return mE(li.create(y,"and"))})(e.filters);u&&(t.structuredQuery.where=u);const h=(function(y){if(y.length!==0)return y.map((b=>(function(T){return{field:Dl(T.field),direction:kI(T.dir)}})(b)))})(e.orderBy);h&&(t.structuredQuery.orderBy=h);const p=Ag(s,e.limit);return p!==null&&(t.structuredQuery.limit=p),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:t,parent:l}}function EI(s){let e=yI(s.parent);const t=s.structuredQuery,i=t.from?t.from.length:0;let l=null;if(i>0){mn(i===1,65062);const b=t.from[0];b.allDescendants?l=b.collectionId:e=e.child(b.collectionId)}let u=[];t.where&&(u=(function(E){const T=fE(E);return T instanceof li&&Fx(T)?T.getFilters():[T]})(t.where));let h=[];t.orderBy&&(h=(function(E){return E.map((T=>(function(H){return new yu(Ml(H.field),(function(B){switch(B){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(H.direction))})(T)))})(t.orderBy));let p=null;t.limit&&(p=(function(E){let T;return T=typeof E=="object"?E.value:E,of(T)?null:T})(t.limit));let g=null;t.startAt&&(g=(function(E){const T=!!E.before,O=E.values||[];return new Fd(O,T)})(t.startAt));let y=null;return t.endAt&&(y=(function(E){const T=!E.before,O=E.values||[];return new Fd(O,T)})(t.endAt)),z4(e,l,h,u,p,"F",g,y)}function TI(s,e){const t=(function(l){switch(l){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return _t(28987,{purpose:l})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function fE(s){return s.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Ml(t.unaryFilter.field);return bs.create(i,"==",{doubleValue:NaN});case"IS_NULL":const l=Ml(t.unaryFilter.field);return bs.create(l,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=Ml(t.unaryFilter.field);return bs.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const h=Ml(t.unaryFilter.field);return bs.create(h,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return _t(61313);default:return _t(60726)}})(s):s.fieldFilter!==void 0?(function(t){return bs.create(Ml(t.fieldFilter.field),(function(l){switch(l){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return _t(58110);default:return _t(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(t){return li.create(t.compositeFilter.filters.map((i=>fE(i))),(function(l){switch(l){case"AND":return"and";case"OR":return"or";default:return _t(1026)}})(t.compositeFilter.op))})(s):_t(30097,{filter:s})}function kI(s){return dI[s]}function SI(s){return fI[s]}function jI(s){return mI[s]}function Dl(s){return{fieldPath:s.canonicalString()}}function Ml(s){return Ls.fromServerFormat(s.fieldPath)}function mE(s){return s instanceof bs?(function(t){if(t.op==="=="){if(W2(t.value))return{unaryFilter:{field:Dl(t.field),op:"IS_NAN"}};if($2(t.value))return{unaryFilter:{field:Dl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(W2(t.value))return{unaryFilter:{field:Dl(t.field),op:"IS_NOT_NAN"}};if($2(t.value))return{unaryFilter:{field:Dl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Dl(t.field),op:SI(t.op),value:t.value}}})(s):s instanceof li?(function(t){const i=t.getFilters().map((l=>mE(l)));return i.length===1?i[0]:{compositeFilter:{op:jI(t.op),filters:i}}})(s):_t(54877,{filter:s})}function CI(s){const e=[];return s.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function pE(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}function gE(s){return!!s&&typeof s._toProto=="function"&&s._protoValueType==="ProtoValue"}class Ha{constructor(e,t,i,l,u=jt.min(),h=jt.min(),p=Ps.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=l,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=h,this.resumeToken=p,this.expectedCount=g}withSequenceNumber(e){return new Ha(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ha(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ha(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ha(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class NI{constructor(e){this.yt=e}}function AI(s){const e=EI({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?qd(e,e.limit,"L"):e}class RI{constructor(){this.Sn=new II}addToCollectionParentIndex(e,t){return this.Sn.add(t),be.resolve()}getCollectionParents(e,t){return be.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return be.resolve()}deleteFieldIndex(e,t){return be.resolve()}deleteAllFieldIndexes(e){return be.resolve()}createTargetIndexes(e,t){return be.resolve()}getDocumentsMatchingTarget(e,t){return be.resolve(null)}getIndexType(e,t){return be.resolve(0)}getFieldIndexes(e,t){return be.resolve([])}getNextCollectionGroupToUpdate(e){return be.resolve(null)}getMinOffset(e,t){return be.resolve(Qa.min())}getMinOffsetFromCollectionGroup(e,t){return be.resolve(Qa.min())}updateCollectionGroup(e,t,i){return be.resolve()}updateIndexEntries(e,t){return be.resolve()}}class II{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t]||new Ts(Mn.comparator),u=!l.has(i);return this.index[t]=l.add(i),u}has(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t];return l&&l.has(i)}getEntries(e){return(this.index[e]||new Ts(Mn.comparator)).toArray()}}const aw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},yE=41943040;class hr{static withCacheSize(e){return new hr(e,hr.DEFAULT_COLLECTION_PERCENTILE,hr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}hr.DEFAULT_COLLECTION_PERCENTILE=10,hr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,hr.DEFAULT=new hr(yE,hr.DEFAULT_COLLECTION_PERCENTILE,hr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),hr.DISABLED=new hr(-1,0,0);class Gl{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Gl(0)}static ar(){return new Gl(-1)}}const ow="LruGarbageCollector",DI=1048576;function lw([s,e],[t,i]){const l=Wt(s,t);return l===0?Wt(e,i):l}class MI{constructor(e){this.Pr=e,this.buffer=new Ts(lw),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();lw(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class LI{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){We(ow,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){tc(t)?We(ow,"Ignoring IndexedDB error during garbage collection: ",t):await ec(t)}await this.Ar(3e5)}))}}class OI{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return be.resolve(af.ce);const i=new MI(t);return this.Vr.forEachTarget(e,(l=>i.Er(l.sequenceNumber))).next((()=>this.Vr.mr(e,(l=>i.Er(l))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(We("LruGarbageCollector","Garbage collection skipped; disabled"),be.resolve(aw)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(We("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),aw):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,l,u,h,p,g,y;const b=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((E=>(E>this.params.maximumSequenceNumbersToCollect?(We("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${E}`),l=this.params.maximumSequenceNumbersToCollect):l=E,h=Date.now(),this.nthSequenceNumber(e,l)))).next((E=>(i=E,p=Date.now(),this.removeTargets(e,i,t)))).next((E=>(u=E,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((E=>(y=Date.now(),Rl()<=$t.DEBUG&&We("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${h-b}ms
	Determined least recently used ${l} in `+(p-h)+`ms
	Removed ${u} targets in `+(g-p)+`ms
	Removed ${E} documents in `+(y-g)+`ms
Total Duration: ${y-b}ms`),be.resolve({didRun:!0,sequenceNumbersCollected:l,targetsRemoved:u,documentsRemoved:E}))))}}function PI(s,e){return new OI(s,e)}class VI{constructor(){this.changes=new Go((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,$s.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?be.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class UI{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class BI{constructor(e,t,i,l){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=l}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((l=>(i=l,this.remoteDocumentCache.getEntry(e,t)))).next((l=>(i!==null&&ou(i.mutation,l,Cr.empty(),Gt.now()),l)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Kt()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Kt()){const l=No();return this.populateOverlays(e,l,t).next((()=>this.computeViews(e,t,l,i).next((u=>{let h=Zc();return u.forEach(((p,g)=>{h=h.insert(p,g.overlayedDocument)})),h}))))}getOverlayedDocuments(e,t){const i=No();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Kt())))}populateOverlays(e,t,i){const l=[];return i.forEach((u=>{t.has(u)||l.push(u)})),this.documentOverlayCache.getOverlays(e,l).next((u=>{u.forEach(((h,p)=>{t.set(h,p)}))}))}computeViews(e,t,i,l){let u=ca();const h=au(),p=(function(){return au()})();return t.forEach(((g,y)=>{const b=i.get(y.key);l.has(y.key)&&(b===void 0||b.mutation instanceof io)?u=u.insert(y.key,y):b!==void 0?(h.set(y.key,b.mutation.getFieldMask()),ou(b.mutation,y,b.mutation.getFieldMask(),Gt.now())):h.set(y.key,Cr.empty())})),this.recalculateAndSaveOverlays(e,u).next((g=>(g.forEach(((y,b)=>h.set(y,b))),t.forEach(((y,b)=>p.set(y,new UI(b,h.get(y)??null)))),p)))}recalculateAndSaveOverlays(e,t){const i=au();let l=new Qn(((h,p)=>h-p)),u=Kt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((h=>{for(const p of h)p.keys().forEach((g=>{const y=t.get(g);if(y===null)return;let b=i.get(g)||Cr.empty();b=p.applyToLocalView(y,b),i.set(g,b);const E=(l.get(p.batchId)||Kt()).add(g);l=l.insert(p.batchId,E)}))})).next((()=>{const h=[],p=l.getReverseIterator();for(;p.hasNext();){const g=p.getNext(),y=g.key,b=g.value,E=Xx();b.forEach((T=>{if(!u.has(T)){const O=rE(t.get(T),i.get(T));O!==null&&E.set(T,O),u=u.add(T)}})),h.push(this.documentOverlayCache.saveOverlays(e,y,E))}return be.waitFor(h)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,l){return F4(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Wx(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,l):this.getDocumentsMatchingCollectionQuery(e,t,i,l)}getNextDocuments(e,t,i,l){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,l).next((u=>{const h=l-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,l-u.size):be.resolve(No());let p=fu,g=u;return h.next((y=>be.forEach(y,((b,E)=>(p<E.largestBatchId&&(p=E.largestBatchId),u.get(b)?be.resolve():this.remoteDocumentCache.getEntry(e,b).next((T=>{g=g.insert(b,T)}))))).next((()=>this.populateOverlays(e,y,u))).next((()=>this.computeViews(e,g,y,Kt()))).next((b=>({batchId:p,changes:Qx(b)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ot(t)).next((i=>{let l=Zc();return i.isFoundDocument()&&(l=l.insert(i.key,i)),l}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,l){const u=t.collectionGroup;let h=Zc();return this.indexManager.getCollectionParents(e,u).next((p=>be.forEach(p,(g=>{const y=(function(E,T){return new nc(T,null,E.explicitOrderBy.slice(),E.filters.slice(),E.limit,E.limitType,E.startAt,E.endAt)})(t,g.child(u));return this.getDocumentsMatchingCollectionQuery(e,y,i,l).next((b=>{b.forEach(((E,T)=>{h=h.insert(E,T)}))}))})).next((()=>h))))}getDocumentsMatchingCollectionQuery(e,t,i,l){let u;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((h=>(u=h,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,u,l)))).next((h=>{u.forEach(((g,y)=>{const b=y.getKey();h.get(b)===null&&(h=h.insert(b,$s.newInvalidDocument(b)))}));let p=Zc();return h.forEach(((g,y)=>{const b=u.get(g);b!==void 0&&ou(b.mutation,y,Cr.empty(),Gt.now()),hf(t,y)&&(p=p.insert(g,y))})),p}))}}class zI{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return be.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(l){return{id:l.id,version:l.version,createTime:ji(l.createTime)}})(t)),be.resolve()}getNamedQuery(e,t){return be.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(l){return{name:l.name,query:AI(l.bundledQuery),readTime:ji(l.readTime)}})(t)),be.resolve()}}class FI{constructor(){this.overlays=new Qn(ot.comparator),this.Lr=new Map}getOverlay(e,t){return be.resolve(this.overlays.get(t))}getOverlays(e,t){const i=No();return be.forEach(t,(l=>this.getOverlay(e,l).next((u=>{u!==null&&i.set(l,u)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((l,u)=>{this.bt(e,t,u)})),be.resolve()}removeOverlaysForBatchId(e,t,i){const l=this.Lr.get(i);return l!==void 0&&(l.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(i)),be.resolve()}getOverlaysForCollection(e,t,i){const l=No(),u=t.length+1,h=new ot(t.child("")),p=this.overlays.getIteratorFrom(h);for(;p.hasNext();){const g=p.getNext().value,y=g.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===u&&g.largestBatchId>i&&l.set(g.getKey(),g)}return be.resolve(l)}getOverlaysForCollectionGroup(e,t,i,l){let u=new Qn(((y,b)=>y-b));const h=this.overlays.getIterator();for(;h.hasNext();){const y=h.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>i){let b=u.get(y.largestBatchId);b===null&&(b=No(),u=u.insert(y.largestBatchId,b)),b.set(y.getKey(),y)}}const p=No(),g=u.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((y,b)=>p.set(y,b))),!(p.size()>=l)););return be.resolve(p)}bt(e,t,i){const l=this.overlays.get(i.key);if(l!==null){const h=this.Lr.get(l.largestBatchId).delete(i.key);this.Lr.set(l.largestBatchId,h)}this.overlays=this.overlays.insert(i.key,new aI(t,i));let u=this.Lr.get(t);u===void 0&&(u=Kt(),this.Lr.set(t,u)),this.Lr.set(t,u.add(i.key))}}class qI{constructor(){this.sessionToken=Ps.EMPTY_BYTE_STRING}getSessionToken(e){return be.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,be.resolve()}}class ky{constructor(){this.kr=new Ts(Ss.Kr),this.qr=new Ts(Ss.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Ss(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Ss(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new ot(new Mn([])),i=new Ss(t,e),l=new Ss(t,e+1),u=[];return this.qr.forEachInRange([i,l],(h=>{this.Wr(h),u.push(h.key)})),u}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new ot(new Mn([])),i=new Ss(t,e),l=new Ss(t,e+1);let u=Kt();return this.qr.forEachInRange([i,l],(h=>{u=u.add(h.key)})),u}containsKey(e){const t=new Ss(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Ss{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return ot.comparator(e.key,t.key)||Wt(e.Hr,t.Hr)}static Ur(e,t){return Wt(e.Hr,t.Hr)||ot.comparator(e.key,t.key)}}class HI{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Ts(Ss.Kr)}checkEmpty(e){return be.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,l){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const h=new iI(u,t,i,l);this.mutationQueue.push(h);for(const p of l)this.Jr=this.Jr.add(new Ss(p.key,u)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return be.resolve(h)}lookupMutationBatch(e,t){return be.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,l=this.Xr(i),u=l<0?0:l;return be.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return be.resolve(this.mutationQueue.length===0?gy:this.Yn-1)}getAllMutationBatches(e){return be.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Ss(t,0),l=new Ss(t,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([i,l],(h=>{const p=this.Zr(h.Hr);u.push(p)})),be.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Ts(Wt);return t.forEach((l=>{const u=new Ss(l,0),h=new Ss(l,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,h],(p=>{i=i.add(p.Hr)}))})),be.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,l=i.length+1;let u=i;ot.isDocumentKey(u)||(u=u.child(""));const h=new Ss(new ot(u),0);let p=new Ts(Wt);return this.Jr.forEachWhile((g=>{const y=g.key.path;return!!i.isPrefixOf(y)&&(y.length===l&&(p=p.add(g.Hr)),!0)}),h),be.resolve(this.Yr(p))}Yr(e){const t=[];return e.forEach((i=>{const l=this.Zr(i);l!==null&&t.push(l)})),t}removeMutationBatch(e,t){mn(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return be.forEach(t.mutations,(l=>{const u=new Ss(l.key,t.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,l.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Ss(t,0),l=this.Jr.firstAfterOrEqual(i);return be.resolve(t.isEqual(l&&l.key))}performConsistencyCheck(e){return this.mutationQueue.length,be.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class $I{constructor(e){this.ti=e,this.docs=(function(){return new Qn(ot.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,l=this.docs.get(i),u=l?l.size:0,h=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:h}),this.size+=h-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return be.resolve(i?i.document.mutableCopy():$s.newInvalidDocument(t))}getEntries(e,t){let i=ca();return t.forEach((l=>{const u=this.docs.get(l);i=i.insert(l,u?u.document.mutableCopy():$s.newInvalidDocument(l))})),be.resolve(i)}getDocumentsMatchingQuery(e,t,i,l){let u=ca();const h=t.path,p=new ot(h.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(p);for(;g.hasNext();){const{key:y,value:{document:b}}=g.getNext();if(!h.isPrefixOf(y.path))break;y.path.length>h.length+1||v4(y4(b),i)<=0||(l.has(b.key)||hf(t,b))&&(u=u.insert(b.key,b.mutableCopy()))}return be.resolve(u)}getAllFromCollectionGroup(e,t,i,l){_t(9500)}ni(e,t){return be.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new WI(this)}getSize(e){return be.resolve(this.size)}}class WI extends VI{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,l)=>{l.isValidDocument()?t.push(this.Mr.addEntry(e,l)):this.Mr.removeEntry(i)})),be.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class GI{constructor(e){this.persistence=e,this.ri=new Go((t=>by(t)),wy),this.lastRemoteSnapshotVersion=jt.min(),this.highestTargetId=0,this.ii=0,this.si=new ky,this.targetCount=0,this.oi=Gl._r()}forEachTarget(e,t){return this.ri.forEach(((i,l)=>t(l))),be.resolve()}getLastRemoteSnapshotVersion(e){return be.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return be.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),be.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),be.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Gl(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,be.resolve()}updateTargetData(e,t){return this.lr(t),be.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,be.resolve()}removeTargets(e,t,i){let l=0;const u=[];return this.ri.forEach(((h,p)=>{p.sequenceNumber<=t&&i.get(p.targetId)===null&&(this.ri.delete(h),u.push(this.removeMatchingKeysForTargetId(e,p.targetId)),l++)})),be.waitFor(u).next((()=>l))}getTargetCount(e){return be.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return be.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),be.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const l=this.persistence.referenceDelegate,u=[];return l&&t.forEach((h=>{u.push(l.markPotentiallyOrphaned(e,h))})),be.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),be.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return be.resolve(i)}containsKey(e,t){return be.resolve(this.si.containsKey(t))}}class vE{constructor(e,t){this._i={},this.overlays={},this.ai=new af(0),this.ui=!1,this.ui=!0,this.ci=new qI,this.referenceDelegate=e(this),this.li=new GI(this),this.indexManager=new RI,this.remoteDocumentCache=(function(l){return new $I(l)})((i=>this.referenceDelegate.hi(i))),this.serializer=new NI(t),this.Pi=new zI(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new FI,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new HI(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){We("MemoryPersistence","Starting transaction:",e);const l=new KI(this.ai.next());return this.referenceDelegate.Ti(),i(l).next((u=>this.referenceDelegate.Ii(l).next((()=>u)))).toPromise().then((u=>(l.raiseOnCommittedEvent(),u)))}Ei(e,t){return be.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class KI extends w4{constructor(e){super(),this.currentSequenceNumber=e}}class Sy{constructor(e){this.persistence=e,this.Ri=new ky,this.Ai=null}static Vi(e){return new Sy(e)}get di(){if(this.Ai)return this.Ai;throw _t(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),be.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),be.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),be.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((l=>this.di.add(l.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((l=>{l.forEach((u=>this.di.add(u.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return be.forEach(this.di,(i=>{const l=ot.fromPath(i);return this.mi(e,l).next((u=>{u||t.removeEntry(l,jt.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return be.or([()=>be.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class $d{constructor(e,t){this.persistence=e,this.fi=new Go((i=>E4(i.path)),((i,l)=>i.isEqual(l))),this.garbageCollector=PI(this,t)}static Vi(e,t){return new $d(e,t)}Ti(){}Ii(e){return be.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((l=>i+l))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return be.forEach(this.fi,((i,l)=>this.wr(e,i,l).next((u=>u?be.resolve():t(l)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const l=this.persistence.getRemoteDocumentCache(),u=l.newChangeBuffer();return l.ni(e,(h=>this.wr(e,h,t).next((p=>{p||(i++,u.removeEntry(h,jt.min()))})))).next((()=>u.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),be.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),be.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),be.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),be.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Ed(e.data.value)),t}wr(e,t,i){return be.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const l=this.fi.get(t);return be.resolve(l!==void 0&&l>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class jy{constructor(e,t,i,l){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=l}static Es(e,t){let i=Kt(),l=Kt();for(const u of t.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:l=l.add(u.doc.key)}return new jy(e,t.fromCache,i,l)}}class YI{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class QI{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return kC()?8:_4(Ws())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,l){const u={result:null};return this.gs(e,t).next((h=>{u.result=h})).next((()=>{if(!u.result)return this.ps(e,t,l,i).next((h=>{u.result=h}))})).next((()=>{if(u.result)return;const h=new YI;return this.ys(e,t,h).next((p=>{if(u.result=p,this.As)return this.ws(e,t,h,p.size)}))})).next((()=>u.result))}ws(e,t,i,l){return i.documentReadCount<this.Vs?(Rl()<=$t.DEBUG&&We("QueryEngine","SDK will not create cache indexes for query:",Il(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),be.resolve()):(Rl()<=$t.DEBUG&&We("QueryEngine","Query:",Il(t),"scans",i.documentReadCount,"local documents and returns",l,"documents as results."),i.documentReadCount>this.ds*l?(Rl()<=$t.DEBUG&&We("QueryEngine","The SDK decides to create cache indexes for query:",Il(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Si(t))):be.resolve())}gs(e,t){if(Q2(t))return be.resolve(null);let i=Si(t);return this.indexManager.getIndexType(e,i).next((l=>l===0?null:(t.limit!==null&&l===1&&(t=qd(t,null,"F"),i=Si(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((u=>{const h=Kt(...u);return this.fs.getDocuments(e,h).next((p=>this.indexManager.getMinOffset(e,i).next((g=>{const y=this.bs(t,p);return this.Ss(t,y,h,g.readTime)?this.gs(e,qd(t,null,"F")):this.Ds(e,y,t,g)}))))})))))}ps(e,t,i,l){return Q2(t)||l.isEqual(jt.min())?be.resolve(null):this.fs.getDocuments(e,i).next((u=>{const h=this.bs(t,u);return this.Ss(t,h,i,l)?be.resolve(null):(Rl()<=$t.DEBUG&&We("QueryEngine","Re-using previous result from %s to execute query: %s",l.toString(),Il(t)),this.Ds(e,h,t,g4(l,fu)).next((p=>p)))}))}bs(e,t){let i=new Ts(Kx(e));return t.forEach(((l,u)=>{hf(e,u)&&(i=i.add(u))})),i}Ss(e,t,i,l){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const u=e.limitType==="F"?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(l)>0)}ys(e,t,i){return Rl()<=$t.DEBUG&&We("QueryEngine","Using full collection scan to execute query:",Il(t)),this.fs.getDocumentsMatchingQuery(e,t,Qa.min(),i)}Ds(e,t,i,l){return this.fs.getDocumentsMatchingQuery(e,i,l).next((u=>(t.forEach((h=>{u=u.insert(h.key,h)})),u)))}}const Cy="LocalStore",XI=3e8;class JI{constructor(e,t,i,l){this.persistence=e,this.Cs=t,this.serializer=l,this.vs=new Qn(Wt),this.Fs=new Go((u=>by(u)),wy),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new BI(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function ZI(s,e,t,i){return new JI(s,e,t,i)}async function bE(s,e){const t=Nt(s);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let l;return t.mutationQueue.getAllMutationBatches(i).next((u=>(l=u,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((u=>{const h=[],p=[];let g=Kt();for(const y of l){h.push(y.batchId);for(const b of y.mutations)g=g.add(b.key)}for(const y of u){p.push(y.batchId);for(const b of y.mutations)g=g.add(b.key)}return t.localDocuments.getDocuments(i,g).next((y=>({Ns:y,removedBatchIds:h,addedBatchIds:p})))}))}))}function eD(s,e){const t=Nt(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const l=e.batch.keys(),u=t.xs.newChangeBuffer({trackRemovals:!0});return(function(p,g,y,b){const E=y.batch,T=E.keys();let O=be.resolve();return T.forEach((H=>{O=O.next((()=>b.getEntry(g,H))).next((q=>{const B=y.docVersions.get(H);mn(B!==null,48541),q.version.compareTo(B)<0&&(E.applyToRemoteDocument(q,y),q.isValidDocument()&&(q.setReadTime(y.commitVersion),b.addEntry(q)))}))})),O.next((()=>p.mutationQueue.removeMutationBatch(g,E)))})(t,i,e,u).next((()=>u.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,l,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(p){let g=Kt();for(let y=0;y<p.mutationResults.length;++y)p.mutationResults[y].transformResults.length>0&&(g=g.add(p.batch.mutations[y].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(i,l)))}))}function wE(s){const e=Nt(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function tD(s,e){const t=Nt(s),i=e.snapshotVersion;let l=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const h=t.xs.newChangeBuffer({trackRemovals:!0});l=t.vs;const p=[];e.targetChanges.forEach(((b,E)=>{const T=l.get(E);if(!T)return;p.push(t.li.removeMatchingKeys(u,b.removedDocuments,E).next((()=>t.li.addMatchingKeys(u,b.addedDocuments,E))));let O=T.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(E)!==null?O=O.withResumeToken(Ps.EMPTY_BYTE_STRING,jt.min()).withLastLimboFreeSnapshotVersion(jt.min()):b.resumeToken.approximateByteSize()>0&&(O=O.withResumeToken(b.resumeToken,i)),l=l.insert(E,O),(function(q,B,X){return q.resumeToken.approximateByteSize()===0||B.snapshotVersion.toMicroseconds()-q.snapshotVersion.toMicroseconds()>=XI?!0:X.addedDocuments.size+X.modifiedDocuments.size+X.removedDocuments.size>0})(T,O,b)&&p.push(t.li.updateTargetData(u,O))}));let g=ca(),y=Kt();if(e.documentUpdates.forEach((b=>{e.resolvedLimboDocuments.has(b)&&p.push(t.persistence.referenceDelegate.updateLimboDocument(u,b))})),p.push(nD(u,h,e.documentUpdates).next((b=>{g=b.Bs,y=b.Ls}))),!i.isEqual(jt.min())){const b=t.li.getLastRemoteSnapshotVersion(u).next((E=>t.li.setTargetsMetadata(u,u.currentSequenceNumber,i)));p.push(b)}return be.waitFor(p).next((()=>h.apply(u))).next((()=>t.localDocuments.getLocalViewOfDocuments(u,g,y))).next((()=>g))})).then((u=>(t.vs=l,u)))}function nD(s,e,t){let i=Kt(),l=Kt();return t.forEach((u=>i=i.add(u))),e.getEntries(s,i).next((u=>{let h=ca();return t.forEach(((p,g)=>{const y=u.get(p);g.isFoundDocument()!==y.isFoundDocument()&&(l=l.add(p)),g.isNoDocument()&&g.version.isEqual(jt.min())?(e.removeEntry(p,g.readTime),h=h.insert(p,g)):!y.isValidDocument()||g.version.compareTo(y.version)>0||g.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(g),h=h.insert(p,g)):We(Cy,"Ignoring outdated watch update for ",p,". Current version:",y.version," Watch version:",g.version)})),{Bs:h,Ls:l}}))}function sD(s,e){const t=Nt(s);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=gy),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function rD(s,e){const t=Nt(s);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let l;return t.li.getTargetData(i,e).next((u=>u?(l=u,be.resolve(l)):t.li.allocateTargetId(i).next((h=>(l=new Ha(e,h,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,l).next((()=>l)))))))})).then((i=>{const l=t.vs.get(i.targetId);return(l===null||i.snapshotVersion.compareTo(l.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function Mg(s,e,t){const i=Nt(s),l=i.vs.get(e),u=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",u,(h=>i.persistence.referenceDelegate.removeTarget(h,l)))}catch(h){if(!tc(h))throw h;We(Cy,`Failed to update sequence numbers for target ${e}: ${h}`)}i.vs=i.vs.remove(e),i.Fs.delete(l.target)}function cw(s,e,t){const i=Nt(s);let l=jt.min(),u=Kt();return i.persistence.runTransaction("Execute query","readwrite",(h=>(function(g,y,b){const E=Nt(g),T=E.Fs.get(b);return T!==void 0?be.resolve(E.vs.get(T)):E.li.getTargetData(y,b)})(i,h,Si(e)).next((p=>{if(p)return l=p.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(h,p.targetId).next((g=>{u=g}))})).next((()=>i.Cs.getDocumentsMatchingQuery(h,e,t?l:jt.min(),t?u:Kt()))).next((p=>(iD(i,$4(e),p),{documents:p,ks:u})))))}function iD(s,e,t){let i=s.Ms.get(e)||jt.min();t.forEach(((l,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)})),s.Ms.set(e,i)}class uw{constructor(){this.activeTargetIds=X4()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class aD{constructor(){this.vo=new uw,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new uw,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class oD{Mo(e){}shutdown(){}}const hw="ConnectivityMonitor";class dw{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){We(hw,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){We(hw,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let ld=null;function Lg(){return ld===null?ld=(function(){return 268435456+Math.round(2147483648*Math.random())})():ld++,"0x"+ld.toString(16)}const Bp="RestConnection",lD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class cD{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${l}`,this.$o=this.databaseId.database===Bd?`project_id=${i}`:`project_id=${i}&database_id=${l}`}Wo(e,t,i,l,u){const h=Lg(),p=this.Qo(e,t.toUriEncodedString());We(Bp,`Sending RPC '${e}' ${h}:`,p,i);const g={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(g,l,u);const{host:y}=new URL(p),b=no(y);return this.zo(e,p,g,i,b).then((E=>(We(Bp,`Received RPC '${e}' ${h}: `,E),E)),(E=>{throw zl(Bp,`RPC '${e}' ${h} failed with error: `,E,"url: ",p,"request:",i),E}))}jo(e,t,i,l,u,h){return this.Wo(e,t,i,l,u)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Zl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((l,u)=>e[u]=l)),i&&i.headers.forEach(((l,u)=>e[u]=l))}Qo(e,t){const i=lD[e];let l=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(l=`${l}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),l}terminate(){}}class uD{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const qs="WebChannelConnection",$c=(s,e,t)=>{s.listen(e,(i=>{try{t(i)}catch(l){setTimeout((()=>{throw l}),0)}}))};class Ul extends cD{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Ul.c_){const e=Tx();$c(e,Ex.STAT_EVENT,(t=>{t.stat===Eg.PROXY?We(qs,"STAT_EVENT: detected buffering proxy"):t.stat===Eg.NOPROXY&&We(qs,"STAT_EVENT: detected no buffering proxy")})),Ul.c_=!0}}zo(e,t,i,l,u){const h=Lg();return new Promise(((p,g)=>{const y=new _x;y.setWithCredentials(!0),y.listenOnce(xx.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case xd.NO_ERROR:const E=y.getResponseJson();We(qs,`XHR for RPC '${e}' ${h} received:`,JSON.stringify(E)),p(E);break;case xd.TIMEOUT:We(qs,`RPC '${e}' ${h} timed out`),g(new Ue(me.DEADLINE_EXCEEDED,"Request time out"));break;case xd.HTTP_ERROR:const T=y.getStatus();if(We(qs,`RPC '${e}' ${h} failed with status:`,T,"response text:",y.getResponseText()),T>0){let O=y.getResponseJson();Array.isArray(O)&&(O=O[0]);const H=O?.error;if(H&&H.status&&H.message){const q=(function(X){const W=X.toLowerCase().replace(/_/g,"-");return Object.values(me).indexOf(W)>=0?W:me.UNKNOWN})(H.status);g(new Ue(q,H.message))}else g(new Ue(me.UNKNOWN,"Server responded with status "+y.getStatus()))}else g(new Ue(me.UNAVAILABLE,"Connection failed."));break;default:_t(9055,{l_:e,streamId:h,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{We(qs,`RPC '${e}' ${h} completed.`)}}));const b=JSON.stringify(l);We(qs,`RPC '${e}' ${h} sending request:`,l),y.send(t,"POST",b,i,15)}))}T_(e,t,i){const l=Lg(),u=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],h=this.createWebChannelTransport(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Go(p.initMessageHeaders,t,i),p.encodeInitMessageHeaders=!0;const y=u.join("");We(qs,`Creating RPC '${e}' stream ${l}: ${y}`,p);const b=h.createWebChannel(y,p);this.I_(b);let E=!1,T=!1;const O=new uD({Ho:H=>{T?We(qs,`Not sending because RPC '${e}' stream ${l} is closed:`,H):(E||(We(qs,`Opening RPC '${e}' stream ${l} transport.`),b.open(),E=!0),We(qs,`RPC '${e}' stream ${l} sending:`,H),b.send(H))},Jo:()=>b.close()});return $c(b,Jc.EventType.OPEN,(()=>{T||(We(qs,`RPC '${e}' stream ${l} transport opened.`),O.i_())})),$c(b,Jc.EventType.CLOSE,(()=>{T||(T=!0,We(qs,`RPC '${e}' stream ${l} transport closed`),O.o_(),this.E_(b))})),$c(b,Jc.EventType.ERROR,(H=>{T||(T=!0,zl(qs,`RPC '${e}' stream ${l} transport errored. Name:`,H.name,"Message:",H.message),O.o_(new Ue(me.UNAVAILABLE,"The operation could not be completed")))})),$c(b,Jc.EventType.MESSAGE,(H=>{if(!T){const q=H.data[0];mn(!!q,16349);const B=q,X=B?.error||B[0]?.error;if(X){We(qs,`RPC '${e}' stream ${l} received error:`,X);const W=X.status;let Y=(function(ve){const j=vs[ve];if(j!==void 0)return aE(j)})(W),de=X.message;Y===void 0&&(Y=me.INTERNAL,de="Unknown error status: "+W+" with message "+X.message),T=!0,O.o_(new Ue(Y,de)),b.close()}else We(qs,`RPC '${e}' stream ${l} received:`,q),O.__(q)}})),Ul.u_(),setTimeout((()=>{O.s_()}),0),O}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return kx()}}function hD(s){return new Ul(s)}function zp(){return typeof document<"u"?document:null}function yf(s){return new pI(s,!0)}Ul.c_=!1;class _E{constructor(e,t,i=1e3,l=1.5,u=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=l,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),l=Math.max(0,t-i);l>0&&We("ExponentialBackoff",`Backing off for ${l} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,l,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const fw="PersistentStream";class xE{constructor(e,t,i,l,u,h,p,g){this.Ci=e,this.b_=i,this.S_=l,this.connection=u,this.authCredentialsProvider=h,this.appCheckCredentialsProvider=p,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new _E(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===me.RESOURCE_EXHAUSTED?(la(t.toString()),la("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===me.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,l])=>{this.D_===t&&this.G_(i,l)}),(i=>{e((()=>{const l=new Ue(me.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(l)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((l=>{i((()=>this.z_(l)))})),this.stream.onMessage((l=>{i((()=>++this.F_==1?this.H_(l):this.onNext(l)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return We(fw,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(We(fw,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class dD extends xE{constructor(e,t,i,l,u,h){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,l,h),this.serializer=u}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=vI(this.serializer,e),i=(function(u){if(!("targetChange"in u))return jt.min();const h=u.targetChange;return h.targetIds&&h.targetIds.length?jt.min():h.readTime?ji(h.readTime):jt.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=Dg(this.serializer),t.addTarget=(function(u,h){let p;const g=h.target;if(p=Cg(g)?{documents:_I(u,g)}:{query:xI(u,g).ft},p.targetId=h.targetId,h.resumeToken.approximateByteSize()>0){p.resumeToken=cE(u,h.resumeToken);const y=Ag(u,h.expectedCount);y!==null&&(p.expectedCount=y)}else if(h.snapshotVersion.compareTo(jt.min())>0){p.readTime=Hd(u,h.snapshotVersion.toTimestamp());const y=Ag(u,h.expectedCount);y!==null&&(p.expectedCount=y)}return p})(this.serializer,e);const i=TI(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=Dg(this.serializer),t.removeTarget=e,this.K_(t)}}class fD extends xE{constructor(e,t,i,l,u,h){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,l,h),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return mn(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,mn(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){mn(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=wI(e.writeResults,e.commitTime),i=ji(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=Dg(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>bI(this.serializer,i)))};this.K_(t)}}class mD{}class pD extends mD{constructor(e,t,i,l){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=l,this.ia=!1}sa(){if(this.ia)throw new Ue(me.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,h])=>this.connection.Wo(e,Rg(t,i),l,u,h))).catch((u=>{throw u.name==="FirebaseError"?(u.code===me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new Ue(me.UNKNOWN,u.toString())}))}jo(e,t,i,l,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([h,p])=>this.connection.jo(e,Rg(t,i),l,h,p,u))).catch((h=>{throw h.name==="FirebaseError"?(h.code===me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),h):new Ue(me.UNKNOWN,h.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function gD(s,e,t,i){return new pD(s,e,t,i)}class yD{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(la(t),this.aa=!1):We("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Uo="RemoteStore";class vD{constructor(e,t,i,l,u){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((h=>{i.enqueueAndForget((async()=>{Ko(this)&&(We(Uo,"Restarting streams for network reachability change."),await(async function(g){const y=Nt(g);y.Ea.add(4),await Lu(y),y.Va.set("Unknown"),y.Ea.delete(4),await vf(y)})(this))}))})),this.Va=new yD(i,l)}}async function vf(s){if(Ko(s))for(const e of s.Ra)await e(!0)}async function Lu(s){for(const e of s.Ra)await e(!1)}function EE(s,e){const t=Nt(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Iy(t)?Ry(t):sc(t).O_()&&Ay(t,e))}function Ny(s,e){const t=Nt(s),i=sc(t);t.Ia.delete(e),i.O_()&&TE(t,e),t.Ia.size===0&&(i.O_()?i.L_():Ko(t)&&t.Va.set("Unknown"))}function Ay(s,e){if(s.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(jt.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}sc(s).Z_(e)}function TE(s,e){s.da.$e(e),sc(s).X_(e)}function Ry(s){s.da=new hI({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),sc(s).start(),s.Va.ua()}function Iy(s){return Ko(s)&&!sc(s).x_()&&s.Ia.size>0}function Ko(s){return Nt(s).Ea.size===0}function kE(s){s.da=void 0}async function bD(s){s.Va.set("Online")}async function wD(s){s.Ia.forEach(((e,t)=>{Ay(s,e)}))}async function _D(s,e){kE(s),Iy(s)?(s.Va.ha(e),Ry(s)):s.Va.set("Unknown")}async function xD(s,e,t){if(s.Va.set("Online"),e instanceof lE&&e.state===2&&e.cause)try{await(async function(l,u){const h=u.cause;for(const p of u.targetIds)l.Ia.has(p)&&(await l.remoteSyncer.rejectListen(p,h),l.Ia.delete(p),l.da.removeTarget(p))})(s,e)}catch(i){We(Uo,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Wd(s,i)}else if(e instanceof Sd?s.da.Xe(e):e instanceof oE?s.da.st(e):s.da.tt(e),!t.isEqual(jt.min()))try{const i=await wE(s.localStore);t.compareTo(i)>=0&&await(function(u,h){const p=u.da.Tt(h);return p.targetChanges.forEach(((g,y)=>{if(g.resumeToken.approximateByteSize()>0){const b=u.Ia.get(y);b&&u.Ia.set(y,b.withResumeToken(g.resumeToken,h))}})),p.targetMismatches.forEach(((g,y)=>{const b=u.Ia.get(g);if(!b)return;u.Ia.set(g,b.withResumeToken(Ps.EMPTY_BYTE_STRING,b.snapshotVersion)),TE(u,g);const E=new Ha(b.target,g,y,b.sequenceNumber);Ay(u,E)})),u.remoteSyncer.applyRemoteEvent(p)})(s,t)}catch(i){We(Uo,"Failed to raise snapshot:",i),await Wd(s,i)}}async function Wd(s,e,t){if(!tc(e))throw e;s.Ea.add(1),await Lu(s),s.Va.set("Offline"),t||(t=()=>wE(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{We(Uo,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await vf(s)}))}function SE(s,e){return e().catch((t=>Wd(s,t,e)))}async function bf(s){const e=Nt(s),t=eo(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:gy;for(;ED(e);)try{const l=await sD(e.localStore,i);if(l===null){e.Ta.length===0&&t.L_();break}i=l.batchId,TD(e,l)}catch(l){await Wd(e,l)}jE(e)&&CE(e)}function ED(s){return Ko(s)&&s.Ta.length<10}function TD(s,e){s.Ta.push(e);const t=eo(s);t.O_()&&t.Y_&&t.ea(e.mutations)}function jE(s){return Ko(s)&&!eo(s).x_()&&s.Ta.length>0}function CE(s){eo(s).start()}async function kD(s){eo(s).ra()}async function SD(s){const e=eo(s);for(const t of s.Ta)e.ea(t.mutations)}async function jD(s,e,t){const i=s.Ta.shift(),l=xy.from(i,e,t);await SE(s,(()=>s.remoteSyncer.applySuccessfulWrite(l))),await bf(s)}async function CD(s,e){e&&eo(s).Y_&&await(async function(i,l){if((function(h){return lI(h)&&h!==me.ABORTED})(l.code)){const u=i.Ta.shift();eo(i).B_(),await SE(i,(()=>i.remoteSyncer.rejectFailedWrite(u.batchId,l))),await bf(i)}})(s,e),jE(s)&&CE(s)}async function mw(s,e){const t=Nt(s);t.asyncQueue.verifyOperationInProgress(),We(Uo,"RemoteStore received new credentials");const i=Ko(t);t.Ea.add(3),await Lu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await vf(t)}async function ND(s,e){const t=Nt(s);e?(t.Ea.delete(2),await vf(t)):e||(t.Ea.add(2),await Lu(t),t.Va.set("Unknown"))}function sc(s){return s.ma||(s.ma=(function(t,i,l){const u=Nt(t);return u.sa(),new dD(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(s.datastore,s.asyncQueue,{Zo:bD.bind(null,s),Yo:wD.bind(null,s),t_:_D.bind(null,s),J_:xD.bind(null,s)}),s.Ra.push((async e=>{e?(s.ma.B_(),Iy(s)?Ry(s):s.Va.set("Unknown")):(await s.ma.stop(),kE(s))}))),s.ma}function eo(s){return s.fa||(s.fa=(function(t,i,l){const u=Nt(t);return u.sa(),new fD(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(s.datastore,s.asyncQueue,{Zo:()=>Promise.resolve(),Yo:kD.bind(null,s),t_:CD.bind(null,s),ta:SD.bind(null,s),na:jD.bind(null,s)}),s.Ra.push((async e=>{e?(s.fa.B_(),await bf(s)):(await s.fa.stop(),s.Ta.length>0&&(We(Uo,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}class Dy{constructor(e,t,i,l,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=l,this.removalCallback=u,this.deferred=new sa,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((h=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,l,u){const h=Date.now()+i,p=new Dy(e,t,h,l,u);return p.start(i),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ue(me.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function My(s,e){if(la("AsyncQueue",`${e}: ${s}`),tc(s))return new Ue(me.UNAVAILABLE,`${e}: ${s}`);throw s}class Bl{static emptySet(e){return new Bl(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||ot.comparator(t.key,i.key):(t,i)=>ot.comparator(t.key,i.key),this.keyedMap=Zc(),this.sortedSet=new Qn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Bl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(!l.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Bl;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class pw{constructor(){this.ga=new Qn(ot.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):_t(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Kl{constructor(e,t,i,l,u,h,p,g,y){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=l,this.mutatedKeys=u,this.fromCache=h,this.syncStateChanged=p,this.excludesMetadataChanges=g,this.hasCachedResults=y}static fromInitialDocuments(e,t,i,l,u){const h=[];return t.forEach((p=>{h.push({type:0,doc:p})})),new Kl(e,t,Bl.emptySet(t),h,i,l,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&uf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let l=0;l<t.length;l++)if(t[l].type!==i[l].type||!t[l].doc.isEqual(i[l].doc))return!1;return!0}}class AD{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class RD{constructor(){this.queries=gw(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const l=Nt(t),u=l.queries;l.queries=gw(),u.forEach(((h,p)=>{for(const g of p.ba)g.onError(i)}))})(this,new Ue(me.ABORTED,"Firestore shutting down"))}}function gw(){return new Go((s=>Gx(s)),uf)}async function Ly(s,e){const t=Nt(s);let i=3;const l=e.query;let u=t.queries.get(l);u?!u.Sa()&&e.Da()&&(i=2):(u=new AD,i=e.Da()?0:1);try{switch(i){case 0:u.wa=await t.onListen(l,!0);break;case 1:u.wa=await t.onListen(l,!1);break;case 2:await t.onFirstRemoteStoreListen(l)}}catch(h){const p=My(h,`Initialization of query '${Il(e.query)}' failed`);return void e.onError(p)}t.queries.set(l,u),u.ba.push(e),e.va(t.onlineState),u.wa&&e.Fa(u.wa)&&Py(t)}async function Oy(s,e){const t=Nt(s),i=e.query;let l=3;const u=t.queries.get(i);if(u){const h=u.ba.indexOf(e);h>=0&&(u.ba.splice(h,1),u.ba.length===0?l=e.Da()?0:1:!u.Sa()&&e.Da()&&(l=2))}switch(l){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function ID(s,e){const t=Nt(s);let i=!1;for(const l of e){const u=l.query,h=t.queries.get(u);if(h){for(const p of h.ba)p.Fa(l)&&(i=!0);h.wa=l}}i&&Py(t)}function DD(s,e,t){const i=Nt(s),l=i.queries.get(e);if(l)for(const u of l.ba)u.onError(t);i.queries.delete(e)}function Py(s){s.Ca.forEach((e=>{e.next()}))}var Og,yw;(yw=Og||(Og={})).Ma="default",yw.Cache="cache";class Vy{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const l of e.docChanges)l.type!==3&&i.push(l);e=new Kl(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Kl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Og.Cache}}class NE{constructor(e){this.key=e}}class AE{constructor(e){this.key=e}}class MD{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Kt(),this.mutatedKeys=Kt(),this.eu=Kx(e),this.tu=new Bl(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new pw,l=t?t.tu:this.tu;let u=t?t.mutatedKeys:this.mutatedKeys,h=l,p=!1;const g=this.query.limitType==="F"&&l.size===this.query.limit?l.last():null,y=this.query.limitType==="L"&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal(((b,E)=>{const T=l.get(b),O=hf(this.query,E)?E:null,H=!!T&&this.mutatedKeys.has(T.key),q=!!O&&(O.hasLocalMutations||this.mutatedKeys.has(O.key)&&O.hasCommittedMutations);let B=!1;T&&O?T.data.isEqual(O.data)?H!==q&&(i.track({type:3,doc:O}),B=!0):this.su(T,O)||(i.track({type:2,doc:O}),B=!0,(g&&this.eu(O,g)>0||y&&this.eu(O,y)<0)&&(p=!0)):!T&&O?(i.track({type:0,doc:O}),B=!0):T&&!O&&(i.track({type:1,doc:T}),B=!0,(g||y)&&(p=!0)),B&&(O?(h=h.add(O),u=q?u.add(b):u.delete(b)):(h=h.delete(b),u=u.delete(b)))})),this.query.limit!==null)for(;h.size>this.query.limit;){const b=this.query.limitType==="F"?h.last():h.first();h=h.delete(b.key),u=u.delete(b.key),i.track({type:1,doc:b})}return{tu:h,iu:i,Ss:p,mutatedKeys:u}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,l){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const h=e.iu.ya();h.sort(((b,E)=>(function(O,H){const q=B=>{switch(B){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _t(20277,{Vt:B})}};return q(O)-q(H)})(b.type,E.type)||this.eu(b.doc,E.doc))),this.ou(i),l=l??!1;const p=t&&!l?this._u():[],g=this.Ya.size===0&&this.current&&!l?1:0,y=g!==this.Xa;return this.Xa=g,h.length!==0||y?{snapshot:new Kl(this.query,e.tu,u,h,e.mutatedKeys,g===0,y,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new pw,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=Kt(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new AE(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new NE(i))})),t}cu(e){this.Za=e.ks,this.Ya=Kt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Kl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Uy="SyncEngine";class LD{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class OD{constructor(e){this.key=e,this.hu=!1}}class PD{constructor(e,t,i,l,u,h){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=l,this.currentUser=u,this.maxConcurrentLimboResolutions=h,this.Pu={},this.Tu=new Go((p=>Gx(p)),uf),this.Iu=new Map,this.Eu=new Set,this.Ru=new Qn(ot.comparator),this.Au=new Map,this.Vu=new ky,this.du={},this.mu=new Map,this.fu=Gl.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function VD(s,e,t=!0){const i=OE(s);let l;const u=i.Tu.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),l=u.view.lu()):l=await RE(i,e,t,!0),l}async function UD(s,e){const t=OE(s);await RE(t,e,!0,!1)}async function RE(s,e,t,i){const l=await rD(s.localStore,Si(e)),u=l.targetId,h=s.sharedClientState.addLocalQueryTarget(u,t);let p;return i&&(p=await BD(s,e,u,h==="current",l.resumeToken)),s.isPrimaryClient&&t&&EE(s.remoteStore,l),p}async function BD(s,e,t,i,l){s.pu=(E,T,O)=>(async function(q,B,X,W){let Y=B.view.ru(X);Y.Ss&&(Y=await cw(q.localStore,B.query,!1).then((({documents:j})=>B.view.ru(j,Y))));const de=W&&W.targetChanges.get(B.targetId),xe=W&&W.targetMismatches.get(B.targetId)!=null,ve=B.view.applyChanges(Y,q.isPrimaryClient,de,xe);return bw(q,B.targetId,ve.au),ve.snapshot})(s,E,T,O);const u=await cw(s.localStore,e,!0),h=new MD(e,u.ks),p=h.ru(u.documents),g=Mu.createSynthesizedTargetChangeForCurrentChange(t,i&&s.onlineState!=="Offline",l),y=h.applyChanges(p,s.isPrimaryClient,g);bw(s,t,y.au);const b=new LD(e,t,h);return s.Tu.set(e,b),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),y.snapshot}async function zD(s,e,t){const i=Nt(s),l=i.Tu.get(e),u=i.Iu.get(l.targetId);if(u.length>1)return i.Iu.set(l.targetId,u.filter((h=>!uf(h,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(l.targetId),i.sharedClientState.isActiveQueryTarget(l.targetId)||await Mg(i.localStore,l.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(l.targetId),t&&Ny(i.remoteStore,l.targetId),Pg(i,l.targetId)})).catch(ec)):(Pg(i,l.targetId),await Mg(i.localStore,l.targetId,!0))}async function FD(s,e){const t=Nt(s),i=t.Tu.get(e),l=t.Iu.get(i.targetId);t.isPrimaryClient&&l.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Ny(t.remoteStore,i.targetId))}async function qD(s,e,t){const i=QD(s);try{const l=await(function(h,p){const g=Nt(h),y=Gt.now(),b=p.reduce(((O,H)=>O.add(H.key)),Kt());let E,T;return g.persistence.runTransaction("Locally write mutations","readwrite",(O=>{let H=ca(),q=Kt();return g.xs.getEntries(O,b).next((B=>{H=B,H.forEach(((X,W)=>{W.isValidDocument()||(q=q.add(X))}))})).next((()=>g.localDocuments.getOverlayedDocuments(O,H))).next((B=>{E=B;const X=[];for(const W of p){const Y=sI(W,E.get(W.key).overlayedDocument);Y!=null&&X.push(new io(W.key,Y,Ux(Y.value.mapValue),nr.exists(!0)))}return g.mutationQueue.addMutationBatch(O,y,X,p)})).next((B=>{T=B;const X=B.applyToLocalDocumentSet(E,q);return g.documentOverlayCache.saveOverlays(O,B.batchId,X)}))})).then((()=>({batchId:T.batchId,changes:Qx(E)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(l.batchId),(function(h,p,g){let y=h.du[h.currentUser.toKey()];y||(y=new Qn(Wt)),y=y.insert(p,g),h.du[h.currentUser.toKey()]=y})(i,l.batchId,t),await Ou(i,l.changes),await bf(i.remoteStore)}catch(l){const u=My(l,"Failed to persist write");t.reject(u)}}async function IE(s,e){const t=Nt(s);try{const i=await tD(t.localStore,e);e.targetChanges.forEach(((l,u)=>{const h=t.Au.get(u);h&&(mn(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size<=1,22616),l.addedDocuments.size>0?h.hu=!0:l.modifiedDocuments.size>0?mn(h.hu,14607):l.removedDocuments.size>0&&(mn(h.hu,42227),h.hu=!1))})),await Ou(t,i,e)}catch(i){await ec(i)}}function vw(s,e,t){const i=Nt(s);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const l=[];i.Tu.forEach(((u,h)=>{const p=h.view.va(e);p.snapshot&&l.push(p.snapshot)})),(function(h,p){const g=Nt(h);g.onlineState=p;let y=!1;g.queries.forEach(((b,E)=>{for(const T of E.ba)T.va(p)&&(y=!0)})),y&&Py(g)})(i.eventManager,e),l.length&&i.Pu.J_(l),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function HD(s,e,t){const i=Nt(s);i.sharedClientState.updateQueryState(e,"rejected",t);const l=i.Au.get(e),u=l&&l.key;if(u){let h=new Qn(ot.comparator);h=h.insert(u,$s.newNoDocument(u,jt.min()));const p=Kt().add(u),g=new gf(jt.min(),new Map,new Qn(Wt),h,p);await IE(i,g),i.Ru=i.Ru.remove(u),i.Au.delete(e),By(i)}else await Mg(i.localStore,e,!1).then((()=>Pg(i,e,t))).catch(ec)}async function $D(s,e){const t=Nt(s),i=e.batch.batchId;try{const l=await eD(t.localStore,e);ME(t,i,null),DE(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Ou(t,l)}catch(l){await ec(l)}}async function WD(s,e,t){const i=Nt(s);try{const l=await(function(h,p){const g=Nt(h);return g.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let b;return g.mutationQueue.lookupMutationBatch(y,p).next((E=>(mn(E!==null,37113),b=E.keys(),g.mutationQueue.removeMutationBatch(y,E)))).next((()=>g.mutationQueue.performConsistencyCheck(y))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(y,b,p))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,b))).next((()=>g.localDocuments.getDocuments(y,b)))}))})(i.localStore,e);ME(i,e,t),DE(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Ou(i,l)}catch(l){await ec(l)}}function DE(s,e){(s.mu.get(e)||[]).forEach((t=>{t.resolve()})),s.mu.delete(e)}function ME(s,e,t){const i=Nt(s);let l=i.du[i.currentUser.toKey()];if(l){const u=l.get(e);u&&(t?u.reject(t):u.resolve(),l=l.remove(e)),i.du[i.currentUser.toKey()]=l}}function Pg(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const i of s.Iu.get(e))s.Tu.delete(i),t&&s.Pu.yu(i,t);s.Iu.delete(e),s.isPrimaryClient&&s.Vu.Gr(e).forEach((i=>{s.Vu.containsKey(i)||LE(s,i)}))}function LE(s,e){s.Eu.delete(e.path.canonicalString());const t=s.Ru.get(e);t!==null&&(Ny(s.remoteStore,t),s.Ru=s.Ru.remove(e),s.Au.delete(t),By(s))}function bw(s,e,t){for(const i of t)i instanceof NE?(s.Vu.addReference(i.key,e),GD(s,i)):i instanceof AE?(We(Uy,"Document no longer in limbo: "+i.key),s.Vu.removeReference(i.key,e),s.Vu.containsKey(i.key)||LE(s,i.key)):_t(19791,{wu:i})}function GD(s,e){const t=e.key,i=t.path.canonicalString();s.Ru.get(t)||s.Eu.has(i)||(We(Uy,"New document in limbo: "+t),s.Eu.add(i),By(s))}function By(s){for(;s.Eu.size>0&&s.Ru.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new ot(Mn.fromString(e)),i=s.fu.next();s.Au.set(i,new OD(t)),s.Ru=s.Ru.insert(t,i),EE(s.remoteStore,new Ha(Si(cf(t.path)),i,"TargetPurposeLimboResolution",af.ce))}}async function Ou(s,e,t){const i=Nt(s),l=[],u=[],h=[];i.Tu.isEmpty()||(i.Tu.forEach(((p,g)=>{h.push(i.pu(g,e,t).then((y=>{if((y||t)&&i.isPrimaryClient){const b=y?!y.fromCache:t?.targetChanges.get(g.targetId)?.current;i.sharedClientState.updateQueryState(g.targetId,b?"current":"not-current")}if(y){l.push(y);const b=jy.Es(g.targetId,y);u.push(b)}})))})),await Promise.all(h),i.Pu.J_(l),await(async function(g,y){const b=Nt(g);try{await b.persistence.runTransaction("notifyLocalViewChanges","readwrite",(E=>be.forEach(y,(T=>be.forEach(T.Ts,(O=>b.persistence.referenceDelegate.addReference(E,T.targetId,O))).next((()=>be.forEach(T.Is,(O=>b.persistence.referenceDelegate.removeReference(E,T.targetId,O)))))))))}catch(E){if(!tc(E))throw E;We(Cy,"Failed to update sequence numbers: "+E)}for(const E of y){const T=E.targetId;if(!E.fromCache){const O=b.vs.get(T),H=O.snapshotVersion,q=O.withLastLimboFreeSnapshotVersion(H);b.vs=b.vs.insert(T,q)}}})(i.localStore,u))}async function KD(s,e){const t=Nt(s);if(!t.currentUser.isEqual(e)){We(Uy,"User change. New user:",e.toKey());const i=await bE(t.localStore,e);t.currentUser=e,(function(u,h){u.mu.forEach((p=>{p.forEach((g=>{g.reject(new Ue(me.CANCELLED,h))}))})),u.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Ou(t,i.Ns)}}function YD(s,e){const t=Nt(s),i=t.Au.get(e);if(i&&i.hu)return Kt().add(i.key);{let l=Kt();const u=t.Iu.get(e);if(!u)return l;for(const h of u){const p=t.Tu.get(h);l=l.unionWith(p.view.nu)}return l}}function OE(s){const e=Nt(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=IE.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=YD.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=HD.bind(null,e),e.Pu.J_=ID.bind(null,e.eventManager),e.Pu.yu=DD.bind(null,e.eventManager),e}function QD(s){const e=Nt(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=$D.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=WD.bind(null,e),e}class Gd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=yf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return ZI(this.persistence,new QI,e.initialUser,this.serializer)}Cu(e){return new vE(Sy.Vi,this.serializer)}Du(e){return new aD}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Gd.provider={build:()=>new Gd};class XD extends Gd{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){mn(this.persistence.referenceDelegate instanceof $d,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new LI(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?hr.withCacheSize(this.cacheSizeBytes):hr.DEFAULT;return new vE((i=>$d.Vi(i,t)),this.serializer)}}class Vg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>vw(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=KD.bind(null,this.syncEngine),await ND(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new RD})()}createDatastore(e){const t=yf(e.databaseInfo.databaseId),i=hD(e.databaseInfo);return gD(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,l,u,h,p){return new vD(i,l,u,h,p)})(this.localStore,this.datastore,e.asyncQueue,(t=>vw(this.syncEngine,t,0)),(function(){return dw.v()?new dw:new oD})())}createSyncEngine(e,t){return(function(l,u,h,p,g,y,b){const E=new PD(l,u,h,p,g,y);return b&&(E.gu=!0),E})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=Nt(t);We(Uo,"RemoteStore shutting down."),i.Ea.add(5),await Lu(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Vg.provider={build:()=>new Vg};class zy{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):la("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const to="FirestoreClient";class JD{constructor(e,t,i,l,u){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=l,this.user=Hs.UNAUTHENTICATED,this.clientId=py.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,(async h=>{We(to,"Received user=",h.uid),await this.authCredentialListener(h),this.user=h})),this.appCheckCredentials.start(i,(h=>(We(to,"Received new app check token=",h),this.appCheckCredentialListener(h,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new sa;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=My(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Fp(s,e){s.asyncQueue.verifyOperationInProgress(),We(to,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let i=t.initialUser;s.setCredentialChangeListener((async l=>{i.isEqual(l)||(await bE(e.localStore,l),i=l)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function ww(s,e){s.asyncQueue.verifyOperationInProgress();const t=await ZD(s);We(to,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener((i=>mw(e.remoteStore,i))),s.setAppCheckTokenChangeListener(((i,l)=>mw(e.remoteStore,l))),s._onlineComponents=e}async function ZD(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){We(to,"Using user provided OfflineComponentProvider");try{await Fp(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(l){return l.name==="FirebaseError"?l.code===me.FAILED_PRECONDITION||l.code===me.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11})(t))throw t;zl("Error using user provided cache. Falling back to memory cache: "+t),await Fp(s,new Gd)}}else We(to,"Using default OfflineComponentProvider"),await Fp(s,new XD(void 0));return s._offlineComponents}async function PE(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(We(to,"Using user provided OnlineComponentProvider"),await ww(s,s._uninitializedComponentsProvider._online)):(We(to,"Using default OnlineComponentProvider"),await ww(s,new Vg))),s._onlineComponents}function eM(s){return PE(s).then((e=>e.syncEngine))}async function Kd(s){const e=await PE(s),t=e.eventManager;return t.onListen=VD.bind(null,e.syncEngine),t.onUnlisten=zD.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=UD.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=FD.bind(null,e.syncEngine),t}function tM(s,e,t,i){const l=new zy(i),u=new Vy(e,l,t);return s.asyncQueue.enqueueAndForget((async()=>Ly(await Kd(s),u))),()=>{l.Nu(),s.asyncQueue.enqueueAndForget((async()=>Oy(await Kd(s),u)))}}function nM(s,e,t={}){const i=new sa;return s.asyncQueue.enqueueAndForget((async()=>(function(u,h,p,g,y){const b=new zy({next:T=>{b.Nu(),h.enqueueAndForget((()=>Oy(u,E)));const O=T.docs.has(p);!O&&T.fromCache?y.reject(new Ue(me.UNAVAILABLE,"Failed to get document because the client is offline.")):O&&T.fromCache&&g&&g.source==="server"?y.reject(new Ue(me.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(T)},error:T=>y.reject(T)}),E=new Vy(cf(p.path),b,{includeMetadataChanges:!0,Ka:!0});return Ly(u,E)})(await Kd(s),s.asyncQueue,e,t,i))),i.promise}function sM(s,e,t={}){const i=new sa;return s.asyncQueue.enqueueAndForget((async()=>(function(u,h,p,g,y){const b=new zy({next:T=>{b.Nu(),h.enqueueAndForget((()=>Oy(u,E))),T.fromCache&&g.source==="server"?y.reject(new Ue(me.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(T)},error:T=>y.reject(T)}),E=new Vy(p,b,{includeMetadataChanges:!0,Ka:!0});return Ly(u,E)})(await Kd(s),s.asyncQueue,e,t,i))),i.promise}function rM(s,e){const t=new sa;return s.asyncQueue.enqueueAndForget((async()=>qD(await eM(s),e,t))),t.promise}function VE(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}const iM="ComponentProvider",_w=new Map;function aM(s,e,t,i,l){return new S4(s,e,t,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,VE(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator,i)}const UE="firestore.googleapis.com",xw=!0;class Ew{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ue(me.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=UE,this.ssl=xw}else this.host=e.host,this.ssl=e.ssl??xw;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=yE;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<DI)throw new Ue(me.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}m4("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=VE(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Ue(me.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Ue(me.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Ue(me.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,l){return i.timeoutSeconds===l.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class wf{constructor(e,t,i,l){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=l,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ew({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ue(me.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ue(me.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ew(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new r4;switch(i.type){case"firstParty":return new l4(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Ue(me.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=_w.get(t);i&&(We(iM,"Removing Datastore"),_w.delete(t),i.terminate())})(this),Promise.resolve()}}function oM(s,e,t,i={}){s=tr(s,wf);const l=no(e),u=s._getSettings(),h={...u,emulatorOptions:s._getEmulatorOptions()},p=`${e}:${t}`;l&&(ey(`https://${p}`),ty("Firestore",!0)),u.host!==UE&&u.host!==p&&zl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...u,host:p,ssl:l,emulatorOptions:i};if(!ia(g,h)&&(s._setSettings(g),i.mockUserToken)){let y,b;if(typeof i.mockUserToken=="string")y=i.mockUserToken,b=Hs.MOCK_USER;else{y=I_(i.mockUserToken,s._app?.options.projectId);const E=i.mockUserToken.sub||i.mockUserToken.user_id;if(!E)throw new Ue(me.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new Hs(E)}s._authCredentials=new i4(new jx(y,b))}}class da{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new da(this.firestore,e,this._query)}}class ts{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ya(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ts(this.firestore,e,this._key)}toJSON(){return{type:ts._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Iu(t,ts._jsonSchema))return new ts(e,i||null,new ot(Mn.fromString(t.referencePath)))}}ts._jsonSchemaVersion="firestore/documentReference/1.0",ts._jsonSchema={type:ws("string",ts._jsonSchemaVersion),referencePath:ws("string")};class Ya extends da{constructor(e,t,i){super(e,t,cf(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ts(this.firestore,null,new ot(e))}withConverter(e){return new Ya(this.firestore,e,this._path)}}function Mt(s,e,...t){if(s=pn(s),Cx("collection","path",e),s instanceof wf){const i=Mn.fromString(e,...t);return O2(i),new Ya(s,null,i)}{if(!(s instanceof ts||s instanceof Ya))throw new Ue(me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(Mn.fromString(e,...t));return O2(i),new Ya(s.firestore,null,i)}}function tt(s,e,...t){if(s=pn(s),arguments.length===1&&(e=py.newId()),Cx("doc","path",e),s instanceof wf){const i=Mn.fromString(e,...t);return L2(i),new ts(s,null,new ot(i))}{if(!(s instanceof ts||s instanceof Ya))throw new Ue(me.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(Mn.fromString(e,...t));return L2(i),new ts(s.firestore,s instanceof Ya?s.converter:null,new ot(i))}}const Tw="AsyncQueue";class kw{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new _E(this,"async_queue_retry"),this._c=()=>{const i=zp();i&&We(Tw,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=zp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=zp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new sa;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!tc(e))throw e;We(Tw,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,la("INTERNAL UNHANDLED ERROR: ",Sw(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const l=Dy.createAndSchedule(this,e,t,i,(u=>this.hc(u)));return this.tc.push(l),l}uc(){this.nc&&_t(47125,{Pc:Sw(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Sw(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}class Ai extends wf{constructor(e,t,i,l){super(e,t,i,l),this.type="firestore",this._queue=new kw,this._persistenceKey=l?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new kw(e),this._firestoreClient=void 0,await e}}}function lM(s,e){const t=typeof s=="object"?s:ju(),i=typeof s=="string"?s:Bd,l=$o(t,"firestore").getImmediate({identifier:i});if(!l._initialized){const u=N_("firestore");u&&oM(l,...u)}return l}function Pu(s){if(s._terminated)throw new Ue(me.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||cM(s),s._firestoreClient}function cM(s){const e=s._freezeSettings(),t=aM(s._databaseId,s._app?.options.appId||"",s._persistenceKey,s._app?.options.apiKey,e);s._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new JD(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&(function(l){const u=l?._online.build();return{_offline:l?._offline.build(u),_online:u}})(s._componentsProvider))}class Gr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Gr(Ps.fromBase64String(e))}catch(t){throw new Ue(me.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Gr(Ps.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Gr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Iu(e,Gr._jsonSchema))return Gr.fromBase64String(e.bytes)}}Gr._jsonSchemaVersion="firestore/bytes/1.0",Gr._jsonSchema={type:ws("string",Gr._jsonSchemaVersion),bytes:ws("string")};class _f{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ue(me.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ls(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Yo{constructor(e){this._methodName=e}}class Ci{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ue(me.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ue(me.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Wt(this._lat,e._lat)||Wt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ci._jsonSchemaVersion}}static fromJSON(e){if(Iu(e,Ci._jsonSchema))return new Ci(e.latitude,e.longitude)}}Ci._jsonSchemaVersion="firestore/geoPoint/1.0",Ci._jsonSchema={type:ws("string",Ci._jsonSchemaVersion),latitude:ws("number"),longitude:ws("number")};class ii{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,l){if(i.length!==l.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==l[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ii._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Iu(e,ii._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ii(e.vectorValues);throw new Ue(me.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ii._jsonSchemaVersion="firestore/vectorValue/1.0",ii._jsonSchema={type:ws("string",ii._jsonSchemaVersion),vectorValues:ws("object")};const uM=/^__.*__$/;class hM{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new io(e,this.data,this.fieldMask,t,this.fieldTransforms):new Du(e,this.data,t,this.fieldTransforms)}}class BE{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new io(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function zE(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw _t(40011,{dataSource:s})}}class xf{constructor(e,t,i,l,u,h){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=l,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=h||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new xf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Yd(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(zE(this.dataSource)&&uM.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class dM{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||yf(e)}createContext(e,t,i,l=!1){return new xf({dataSource:e,methodName:t,targetDoc:i,path:Ls.emptyPath(),arrayElement:!1,hasConverter:l},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Vu(s){const e=s._freezeSettings(),t=yf(s._databaseId);return new dM(s._databaseId,!!e.ignoreUndefinedProperties,t)}function Fy(s,e,t,i,l,u={}){const h=s.createContext(u.merge||u.mergeFields?2:0,e,t,l);Gy("Data must be an object, but it was:",h,i);const p=$E(i,h);let g,y;if(u.merge)g=new Cr(h.fieldMask),y=h.fieldTransforms;else if(u.mergeFields){const b=[];for(const E of u.mergeFields){const T=Bo(e,E,t);if(!h.contains(T))throw new Ue(me.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);KE(b,T)||b.push(T)}g=new Cr(b),y=h.fieldTransforms.filter((E=>g.covers(E.field)))}else g=null,y=h.fieldTransforms;return new hM(new dr(p),g,y)}class Ef extends Yo{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ef}}function FE(s,e,t){return new xf({dataSource:3,targetDoc:e.settings.targetDoc,methodName:s._methodName,arrayElement:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class qy extends Yo{_toFieldTransform(e){return new ff(e.path,new vu)}isEqual(e){return e instanceof qy}}class Hy extends Yo{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=FE(this,e,!0),i=this.Ac.map((u=>Qo(u,t))),l=new $l(i);return new ff(e.path,l)}isEqual(e){return e instanceof Hy&&ia(this.Ac,e.Ac)}}class $y extends Yo{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=FE(this,e,!0),i=this.Ac.map((u=>Qo(u,t))),l=new Wl(i);return new ff(e.path,l)}isEqual(e){return e instanceof $y&&ia(this.Ac,e.Ac)}}class Wy extends Yo{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new bu(e.serializer,Zx(e.serializer,this.Vc));return new ff(e.path,t)}isEqual(e){return e instanceof Wy&&this.Vc===e.Vc}}function qE(s,e,t,i){const l=s.createContext(1,e,t);Gy("Data must be an object, but it was:",l,i);const u=[],h=dr.empty();ro(i,((g,y)=>{const b=GE(e,g,t);y=pn(y);const E=l.childContextForFieldPath(b);if(y instanceof Ef)u.push(b);else{const T=Qo(y,E);T!=null&&(u.push(b),h.set(b,T))}}));const p=new Cr(u);return new BE(h,p,l.fieldTransforms)}function HE(s,e,t,i,l,u){const h=s.createContext(1,e,t),p=[Bo(e,i,t)],g=[l];if(u.length%2!=0)throw new Ue(me.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<u.length;T+=2)p.push(Bo(e,u[T])),g.push(u[T+1]);const y=[],b=dr.empty();for(let T=p.length-1;T>=0;--T)if(!KE(y,p[T])){const O=p[T];let H=g[T];H=pn(H);const q=h.childContextForFieldPath(O);if(H instanceof Ef)y.push(O);else{const B=Qo(H,q);B!=null&&(y.push(O),b.set(O,B))}}const E=new Cr(y);return new BE(b,E,h.fieldTransforms)}function fM(s,e,t,i=!1){return Qo(t,s.createContext(i?4:3,e))}function Qo(s,e){if(WE(s=pn(s)))return Gy("Unsupported field value:",e,s),$E(s,e);if(s instanceof Yo)return(function(i,l){if(!zE(l.dataSource))throw l.createError(`${i._methodName}() can only be used with update() and set()`);if(!l.path)throw l.createError(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(l);u&&l.fieldTransforms.push(u)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,l){const u=[];let h=0;for(const p of i){let g=Qo(p,l.childContextForArray(h));g==null&&(g={nullValue:"NULL_VALUE"}),u.push(g),h++}return{arrayValue:{values:u}}})(s,e)}return(function(i,l){if((i=pn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return Zx(l.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=Gt.fromDate(i);return{timestampValue:Hd(l.serializer,u)}}if(i instanceof Gt){const u=new Gt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Hd(l.serializer,u)}}if(i instanceof Ci)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Gr)return{bytesValue:cE(l.serializer,i._byteString)};if(i instanceof ts){const u=l.databaseId,h=i.firestore._databaseId;if(!h.isEqual(u))throw l.createError(`Document reference is for database ${h.projectId}/${h.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:Ty(i.firestore._databaseId||l.databaseId,i._key.path)}}if(i instanceof ii)return(function(h,p){const g=h instanceof ii?h.toArray():h;return{mapValue:{fields:{[Px]:{stringValue:Vx},[zd]:{arrayValue:{values:g.map((b=>{if(typeof b!="number")throw p.createError("VectorValues must only contain numeric values.");return _y(p.serializer,b)}))}}}}}})(i,l);if(gE(i))return i._toProto(l.serializer);throw l.createError(`Unsupported field value: ${rf(i)}`)})(s,e)}function $E(s,e){const t={};return Rx(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ro(s,((i,l)=>{const u=Qo(l,e.childContextForField(i));u!=null&&(t[i]=u)})),{mapValue:{fields:t}}}function WE(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof Gt||s instanceof Ci||s instanceof Gr||s instanceof ts||s instanceof Yo||s instanceof ii||gE(s))}function Gy(s,e,t){if(!WE(t)||!Nx(t)){const i=rf(t);throw i==="an object"?e.createError(s+" a custom object"):e.createError(s+" "+i)}}function Bo(s,e,t){if((e=pn(e))instanceof _f)return e._internalPath;if(typeof e=="string")return GE(s,e);throw Yd("Field path arguments must be of type string or ",s,!1,void 0,t)}const mM=new RegExp("[~\\*/\\[\\]]");function GE(s,e,t){if(e.search(mM)>=0)throw Yd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new _f(...e.split("."))._internalPath}catch{throw Yd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function Yd(s,e,t,i,l){const u=i&&!i.isEmpty(),h=l!==void 0;let p=`Function ${e}() called with invalid data`;t&&(p+=" (via `toFirestore()`)"),p+=". ";let g="";return(u||h)&&(g+=" (found",u&&(g+=` in field ${i}`),h&&(g+=` in document ${l}`),g+=")"),new Ue(me.INVALID_ARGUMENT,p+s+g)}function KE(s,e){return s.some((t=>t.isEqual(e)))}class pM{convertValue(e,t="none"){switch(Za(e)){case 0:return null;case 1:return e.booleanValue;case 2:return hs(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ja(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw _t(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return ro(e,((l,u)=>{i[l]=this.convertValue(u,t)})),i}convertVectorValue(e){const t=e.fields?.[zd].arrayValue?.values?.map((i=>hs(i.doubleValue)));return new ii(t)}convertGeoPoint(e){return new Ci(hs(e.latitude),hs(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=lf(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(mu(e));default:return null}}convertTimestamp(e){const t=Xa(e);return new Gt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Mn.fromString(e);mn(pE(i),9688,{name:e});const l=new pu(i.get(1),i.get(3)),u=new ot(i.popFirst(5));return l.isEqual(t)||la(`Document ${u} contains a document reference within a different database (${l.projectId}/${l.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}class Ky extends pM{constructor(e){super(),this.firestore=e}convertBytes(e){return new Gr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ts(this.firestore,null,t)}}function fr(){return new qy("serverTimestamp")}function gM(...s){return new Hy("arrayUnion",s)}function yM(...s){return new $y("arrayRemove",s)}function Ao(s){return new Wy("increment",s)}const jw="@firebase/firestore",Cw="4.10.0";function Nw(s){return(function(t,i){if(typeof t!="object"||t===null)return!1;const l=t;for(const u of i)if(u in l&&typeof l[u]=="function")return!0;return!1})(s,["next","error","complete"])}class YE{constructor(e,t,i,l,u){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=l,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new ts(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new vM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(Bo("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class vM extends YE{data(){return super.data()}}function QE(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new Ue(me.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Yy{}class Qy extends Yy{}function Dn(s,e,...t){let i=[];e instanceof Yy&&i.push(e),i=i.concat(t),(function(u){const h=u.filter((g=>g instanceof Xy)).length,p=u.filter((g=>g instanceof Tf)).length;if(h>1||h>0&&p>0)throw new Ue(me.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const l of i)s=l._apply(s);return s}class Tf extends Qy{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Tf(e,t,i)}_apply(e){const t=this._parse(e);return XE(e._query,t),new da(e.firestore,e.converter,Ng(e._query,t))}_parse(e){const t=Vu(e.firestore);return(function(u,h,p,g,y,b,E){let T;if(y.isKeyField()){if(b==="array-contains"||b==="array-contains-any")throw new Ue(me.INVALID_ARGUMENT,`Invalid Query. You can't perform '${b}' queries on documentId().`);if(b==="in"||b==="not-in"){Rw(E,b);const H=[];for(const q of E)H.push(Aw(g,u,q));T={arrayValue:{values:H}}}else T=Aw(g,u,E)}else b!=="in"&&b!=="not-in"&&b!=="array-contains-any"||Rw(E,b),T=fM(p,h,E,b==="in"||b==="not-in");return bs.create(y,b,T)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function fn(s,e,t){const i=e,l=Bo("where",s);return Tf._create(l,i,t)}class Xy extends Yy{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Xy(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:li.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(l,u){let h=l;const p=u.getFlattenedFilters();for(const g of p)XE(h,g),h=Ng(h,g)})(e._query,t),new da(e.firestore,e.converter,Ng(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Jy extends Qy{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Jy(e,t)}_apply(e){const t=(function(l,u,h){if(l.startAt!==null)throw new Ue(me.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(l.endAt!==null)throw new Ue(me.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new yu(u,h)})(e._query,this._field,this._direction);return new da(e.firestore,e.converter,H4(e._query,t))}}function wu(s,e="asc"){const t=e,i=Bo("orderBy",s);return Jy._create(i,t)}class Zy extends Qy{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new Zy(e,t,i)}_apply(e){return new da(e.firestore,e.converter,qd(e._query,this._limit,this._limitType))}}function _u(s){return p4("limit",s),Zy._create("limit",s,"F")}function Aw(s,e,t){if(typeof(t=pn(t))=="string"){if(t==="")throw new Ue(me.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Wx(e)&&t.indexOf("/")!==-1)throw new Ue(me.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Mn.fromString(t));if(!ot.isDocumentKey(i))throw new Ue(me.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return H2(s,new ot(i))}if(t instanceof ts)return H2(s,t._key);throw new Ue(me.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${rf(t)}.`)}function Rw(s,e){if(!Array.isArray(s)||s.length===0)throw new Ue(me.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function XE(s,e){const t=(function(l,u){for(const h of l)for(const p of h.getFlattenedFilters())if(u.indexOf(p.op)>=0)return p.op;return null})(s.filters,(function(l){switch(l){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Ue(me.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ue(me.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function ev(s,e,t){let i;return i=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,i}class tu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Io extends YE{constructor(e,t,i,l,u,h){super(e,t,i,l,h),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new jd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(Bo("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ue(me.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Io._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Io._jsonSchemaVersion="firestore/documentSnapshot/1.0",Io._jsonSchema={type:ws("string",Io._jsonSchemaVersion),bundleSource:ws("string","DocumentSnapshot"),bundleName:ws("string"),bundle:ws("string")};class jd extends Io{data(e={}){return super.data(e)}}class Do{constructor(e,t,i,l){this._firestore=e,this._userDataWriter=t,this._snapshot=l,this.metadata=new tu(l.hasPendingWrites,l.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new jd(this._firestore,this._userDataWriter,i.key,i,new tu(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ue(me.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(l,u){if(l._snapshot.oldDocs.isEmpty()){let h=0;return l._snapshot.docChanges.map((p=>{const g=new jd(l._firestore,l._userDataWriter,p.doc.key,p.doc,new tu(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);return p.doc,{type:"added",doc:g,oldIndex:-1,newIndex:h++}}))}{let h=l._snapshot.oldDocs;return l._snapshot.docChanges.filter((p=>u||p.type!==3)).map((p=>{const g=new jd(l._firestore,l._userDataWriter,p.doc.key,p.doc,new tu(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);let y=-1,b=-1;return p.type!==0&&(y=h.indexOf(p.doc.key),h=h.delete(p.doc.key)),p.type!==1&&(h=h.add(p.doc),b=h.indexOf(p.doc.key)),{type:bM(p.type),doc:g,oldIndex:y,newIndex:b}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ue(me.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Do._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=py.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],l=[];return this.docs.forEach((u=>{u._document!==null&&(t.push(u._document),i.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),l.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function bM(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _t(61501,{type:s})}}Do._jsonSchemaVersion="firestore/querySnapshot/1.0",Do._jsonSchema={type:ws("string",Do._jsonSchemaVersion),bundleSource:ws("string","QuerySnapshot"),bundleName:ws("string"),bundle:ws("string")};class wM{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Vu(e)}set(e,t,i){this._verifyNotCommitted();const l=qp(e,this._firestore),u=ev(l.converter,t,i),h=Fy(this._dataReader,"WriteBatch.set",l._key,u,l.converter!==null,i);return this._mutations.push(h.toMutation(l._key,nr.none())),this}update(e,t,i,...l){this._verifyNotCommitted();const u=qp(e,this._firestore);let h;return h=typeof(t=pn(t))=="string"||t instanceof _f?HE(this._dataReader,"WriteBatch.update",u._key,t,i,l):qE(this._dataReader,"WriteBatch.update",u._key,t),this._mutations.push(h.toMutation(u._key,nr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=qp(e,this._firestore);return this._mutations=this._mutations.concat(new pf(t._key,nr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ue(me.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function qp(s,e){if((s=pn(s)).firestore!==e)throw new Ue(me.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}function mr(s){s=tr(s,ts);const e=tr(s.firestore,Ai),t=Pu(e);return nM(t,s._key).then((i=>ZE(e,s,i)))}function Tn(s){s=tr(s,da);const e=tr(s.firestore,Ai),t=Pu(e),i=new Ky(e);return QE(s._query),sM(t,s._query).then((l=>new Do(e,i,s,l)))}function Os(s,e,t){s=tr(s,ts);const i=tr(s.firestore,Ai),l=ev(s.converter,e,t),u=Vu(i);return Uu(i,[Fy(u,"setDoc",s._key,l,s.converter!==null,t).toMutation(s._key,nr.none())])}function Zs(s,e,t,...i){s=tr(s,ts);const l=tr(s.firestore,Ai),u=Vu(l);let h;return h=typeof(e=pn(e))=="string"||e instanceof _f?HE(u,"updateDoc",s._key,e,t,i):qE(u,"updateDoc",s._key,e),Uu(l,[h.toMutation(s._key,nr.exists(!0))])}function jr(s){return Uu(tr(s.firestore,Ai),[new pf(s._key,nr.none())])}function ri(s,e){const t=tr(s.firestore,Ai),i=tt(s),l=ev(s.converter,e),u=Vu(s.firestore);return Uu(t,[Fy(u,"addDoc",i._key,l,s.converter!==null,{}).toMutation(i._key,nr.exists(!1))]).then((()=>i))}function JE(s,...e){s=pn(s);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||Nw(e[i])||(t=e[i++]);const l={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Nw(e[i])){const y=e[i];e[i]=y.next?.bind(y),e[i+1]=y.error?.bind(y),e[i+2]=y.complete?.bind(y)}let u,h,p;if(s instanceof ts)h=tr(s.firestore,Ai),p=cf(s._key.path),u={next:y=>{e[i]&&e[i](ZE(h,s,y))},error:e[i+1],complete:e[i+2]};else{const y=tr(s,da);h=tr(y.firestore,Ai),p=y._query;const b=new Ky(h);u={next:E=>{e[i]&&e[i](new Do(h,b,y,E))},error:e[i+1],complete:e[i+2]},QE(s._query)}const g=Pu(h);return tM(g,p,l,u)}function Uu(s,e){const t=Pu(s);return rM(t,e)}function ZE(s,e,t){const i=t.docs.get(e._key),l=new Ky(s);return new Io(s,l,e._key,i,new tu(t.hasPendingWrites,t.fromCache),e.converter)}function Iw(s){return s=tr(s,Ai),Pu(s),new wM(s,(e=>Uu(s,e)))}(function(e,t=!0){s4(Wo),ai(new Yr("firestore",((i,{instanceIdentifier:l,options:u})=>{const h=i.getProvider("app").getImmediate(),p=new Ai(new a4(i.getProvider("auth-internal")),new c4(h,i.getProvider("app-check-internal")),j4(h,l),h);return u={useFetchStreams:t,...u},p._setSettings(u),p}),"PUBLIC").setMultipleInstances(!0)),pr(jw,Cw,e),pr(jw,Cw,"esm2020")})();var _M="firebase",xM="12.8.0";pr(_M,xM,"app");const eT="firebasestorage.googleapis.com",tT="storageBucket",EM=120*1e3,TM=600*1e3;class ss extends ui{constructor(e,t,i=0){super(Hp(e),`Firebase Storage: ${t} (${Hp(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ss.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Hp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ns;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ns||(ns={}));function Hp(s){return"storage/"+s}function tv(){const s="An unknown error occurred, please check the error payload for server response.";return new ss(ns.UNKNOWN,s)}function kM(s){return new ss(ns.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")}function SM(s){return new ss(ns.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function jM(){const s="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new ss(ns.UNAUTHENTICATED,s)}function CM(){return new ss(ns.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function NM(s){return new ss(ns.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")}function AM(){return new ss(ns.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function RM(){return new ss(ns.CANCELED,"User canceled the upload/download.")}function IM(s){return new ss(ns.INVALID_URL,"Invalid URL '"+s+"'.")}function DM(s){return new ss(ns.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function MM(){return new ss(ns.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+tT+"' property when initializing the app?")}function LM(){return new ss(ns.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function OM(){return new ss(ns.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function PM(s){return new ss(ns.UNSUPPORTED_ENVIRONMENT,`${s} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Ug(s){return new ss(ns.INVALID_ARGUMENT,s)}function nT(){return new ss(ns.APP_DELETED,"The Firebase app was deleted.")}function VM(s){return new ss(ns.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function lu(s,e){return new ss(ns.INVALID_FORMAT,"String does not match format '"+s+"': "+e)}function Wc(s){throw new ss(ns.INTERNAL_ERROR,"Internal error: "+s)}class er{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=er.makeFromUrl(e,t)}catch{return new er(e,"")}if(i.path==="")return i;throw DM(e)}static makeFromUrl(e,t){let i=null;const l="([A-Za-z0-9.\\-_]+)";function u(de){de.path.charAt(de.path.length-1)==="/"&&(de.path_=de.path_.slice(0,-1))}const h="(/(.*))?$",p=new RegExp("^gs://"+l+h,"i"),g={bucket:1,path:3};function y(de){de.path_=decodeURIComponent(de.path)}const b="v[A-Za-z0-9_]+",E=t.replace(/[.]/g,"\\."),T="(/([^?#]*).*)?$",O=new RegExp(`^https?://${E}/${b}/b/${l}/o${T}`,"i"),H={bucket:1,path:3},q=t===eT?"(?:storage.googleapis.com|storage.cloud.google.com)":t,B="([^?#]*)",X=new RegExp(`^https?://${q}/${l}/${B}`,"i"),Y=[{regex:p,indices:g,postModify:u},{regex:O,indices:H,postModify:y},{regex:X,indices:{bucket:1,path:2},postModify:y}];for(let de=0;de<Y.length;de++){const xe=Y[de],ve=xe.regex.exec(e);if(ve){const j=ve[xe.indices.bucket];let S=ve[xe.indices.path];S||(S=""),i=new er(j,S),xe.postModify(i);break}}if(i==null)throw IM(e);return i}}class UM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function BM(s,e,t){let i=1,l=null,u=null,h=!1,p=0;function g(){return p===2}let y=!1;function b(...B){y||(y=!0,e.apply(null,B))}function E(B){l=setTimeout(()=>{l=null,s(O,g())},B)}function T(){u&&clearTimeout(u)}function O(B,...X){if(y){T();return}if(B){T(),b.call(null,B,...X);return}if(g()||h){T(),b.call(null,B,...X);return}i<64&&(i*=2);let Y;p===1?(p=2,Y=0):Y=(i+Math.random())*1e3,E(Y)}let H=!1;function q(B){H||(H=!0,T(),!y&&(l!==null?(B||(p=2),clearTimeout(l),E(0)):B||(p=1)))}return E(0),u=setTimeout(()=>{h=!0,q(!0)},t),q}function zM(s){s(!1)}function FM(s){return s!==void 0}function qM(s){return typeof s=="object"&&!Array.isArray(s)}function nv(s){return typeof s=="string"||s instanceof String}function Dw(s){return sv()&&s instanceof Blob}function sv(){return typeof Blob<"u"}function Bg(s,e,t,i){if(i<e)throw Ug(`Invalid value for '${s}'. Expected ${e} or greater.`);if(i>t)throw Ug(`Invalid value for '${s}'. Expected ${t} or less.`)}function kf(s,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${s}`}function sT(s){const e=encodeURIComponent;let t="?";for(const i in s)if(s.hasOwnProperty(i)){const l=e(i)+"="+e(s[i]);t=t+l+"&"}return t=t.slice(0,-1),t}var Mo;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(Mo||(Mo={}));function HM(s,e){const t=s>=500&&s<600,l=[408,429].indexOf(s)!==-1,u=e.indexOf(s)!==-1;return t||l||u}class $M{constructor(e,t,i,l,u,h,p,g,y,b,E,T=!0,O=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=l,this.successCodes_=u,this.additionalRetryCodes_=h,this.callback_=p,this.errorCallback_=g,this.timeout_=y,this.progressCallback_=b,this.connectionFactory_=E,this.retry=T,this.isUsingEmulator=O,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((H,q)=>{this.resolve_=H,this.reject_=q,this.start_()})}start_(){const e=(i,l)=>{if(l){i(!1,new cd(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const h=p=>{const g=p.loaded,y=p.lengthComputable?p.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,y)};this.progressCallback_!==null&&u.addUploadProgressListener(h),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(h),this.pendingConnection_=null;const p=u.getErrorCode()===Mo.NO_ERROR,g=u.getStatus();if(!p||HM(g,this.additionalRetryCodes_)&&this.retry){const b=u.getErrorCode()===Mo.ABORT;i(!1,new cd(!1,null,b));return}const y=this.successCodes_.indexOf(g)!==-1;i(!0,new cd(y,u))})},t=(i,l)=>{const u=this.resolve_,h=this.reject_,p=l.connection;if(l.wasSuccessCode)try{const g=this.callback_(p,p.getResponse());FM(g)?u(g):u()}catch(g){h(g)}else if(p!==null){const g=tv();g.serverResponse=p.getErrorText(),this.errorCallback_?h(this.errorCallback_(p,g)):h(g)}else if(l.canceled){const g=this.appDelete_?nT():RM();h(g)}else{const g=AM();h(g)}};this.canceled_?t(!1,new cd(!1,null,!0)):this.backoffId_=BM(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&zM(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class cd{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function WM(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function GM(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function KM(s,e){e&&(s["X-Firebase-GMPID"]=e)}function YM(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function QM(s,e,t,i,l,u,h=!0,p=!1){const g=sT(s.urlParams),y=s.url+g,b=Object.assign({},s.headers);return KM(b,e),WM(b,t),GM(b,u),YM(b,i),new $M(y,s.method,b,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,l,h,p)}function XM(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function JM(...s){const e=XM();if(e!==void 0){const t=new e;for(let i=0;i<s.length;i++)t.append(s[i]);return t.getBlob()}else{if(sv())return new Blob(s);throw new ss(ns.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function ZM(s,e,t){return s.webkitSlice?s.webkitSlice(e,t):s.mozSlice?s.mozSlice(e,t):s.slice?s.slice(e,t):null}function e6(s){if(typeof atob>"u")throw PM("base-64");return atob(s)}const Ei={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class $p{constructor(e,t){this.data=e,this.contentType=t||null}}function t6(s,e){switch(s){case Ei.RAW:return new $p(rT(e));case Ei.BASE64:case Ei.BASE64URL:return new $p(iT(s,e));case Ei.DATA_URL:return new $p(s6(e),r6(e))}throw tv()}function rT(s){const e=[];for(let t=0;t<s.length;t++){let i=s.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<s.length-1&&(s.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const u=i,h=s.charCodeAt(++t);i=65536|(u&1023)<<10|h&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function n6(s){let e;try{e=decodeURIComponent(s)}catch{throw lu(Ei.DATA_URL,"Malformed data URL.")}return rT(e)}function iT(s,e){switch(s){case Ei.BASE64:{const l=e.indexOf("-")!==-1,u=e.indexOf("_")!==-1;if(l||u)throw lu(s,"Invalid character '"+(l?"-":"_")+"' found: is it base64url encoded?");break}case Ei.BASE64URL:{const l=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(l||u)throw lu(s,"Invalid character '"+(l?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=e6(e)}catch(l){throw l.message.includes("polyfill")?l:lu(s,"Invalid character found")}const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i}class aT{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw lu(Ei.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=i6(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function s6(s){const e=new aT(s);return e.base64?iT(Ei.BASE64,e.rest):n6(e.rest)}function r6(s){return new aT(s).contentType}function i6(s,e){return s.length>=e.length?s.substring(s.length-e.length)===e:!1}class qa{constructor(e,t){let i=0,l="";Dw(e)?(this.data_=e,i=e.size,l=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=l}size(){return this.size_}type(){return this.type_}slice(e,t){if(Dw(this.data_)){const i=this.data_,l=ZM(i,e,t);return l===null?null:new qa(l)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new qa(i,!0)}}static getBlob(...e){if(sv()){const t=e.map(i=>i instanceof qa?i.data_:i);return new qa(JM.apply(null,t))}else{const t=e.map(h=>nv(h)?t6(Ei.RAW,h).data:h.data_);let i=0;t.forEach(h=>{i+=h.byteLength});const l=new Uint8Array(i);let u=0;return t.forEach(h=>{for(let p=0;p<h.length;p++)l[u++]=h[p]}),new qa(l,!0)}}uploadData(){return this.data_}}function rv(s){let e;try{e=JSON.parse(s)}catch{return null}return qM(e)?e:null}function a6(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function o6(s,e){const t=e.split("/").filter(i=>i.length>0).join("/");return s.length===0?t:s+"/"+t}function oT(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}function l6(s,e){return e}class Js{constructor(e,t,i,l){this.server=e,this.local=t||e,this.writable=!!i,this.xform=l||l6}}let ud=null;function c6(s){return!nv(s)||s.length<2?s:oT(s)}function lT(){if(ud)return ud;const s=[];s.push(new Js("bucket")),s.push(new Js("generation")),s.push(new Js("metageneration")),s.push(new Js("name","fullPath",!0));function e(u,h){return c6(h)}const t=new Js("name");t.xform=e,s.push(t);function i(u,h){return h!==void 0?Number(h):h}const l=new Js("size");return l.xform=i,s.push(l),s.push(new Js("timeCreated")),s.push(new Js("updated")),s.push(new Js("md5Hash",null,!0)),s.push(new Js("cacheControl",null,!0)),s.push(new Js("contentDisposition",null,!0)),s.push(new Js("contentEncoding",null,!0)),s.push(new Js("contentLanguage",null,!0)),s.push(new Js("contentType",null,!0)),s.push(new Js("metadata","customMetadata",!0)),ud=s,ud}function u6(s,e){function t(){const i=s.bucket,l=s.fullPath,u=new er(i,l);return e._makeStorageReference(u)}Object.defineProperty(s,"ref",{get:t})}function h6(s,e,t){const i={};i.type="file";const l=t.length;for(let u=0;u<l;u++){const h=t[u];i[h.local]=h.xform(i,e[h.server])}return u6(i,s),i}function cT(s,e,t){const i=rv(e);return i===null?null:h6(s,i,t)}function d6(s,e,t,i){const l=rv(e);if(l===null||!nv(l.downloadTokens))return null;const u=l.downloadTokens;if(u.length===0)return null;const h=encodeURIComponent;return u.split(",").map(y=>{const b=s.bucket,E=s.fullPath,T="/b/"+h(b)+"/o/"+h(E),O=kf(T,t,i),H=sT({alt:"media",token:y});return O+H})[0]}function f6(s,e){const t={},i=e.length;for(let l=0;l<i;l++){const u=e[l];u.writable&&(t[u.server]=s[u.local])}return JSON.stringify(t)}const Mw="prefixes",Lw="items";function m6(s,e,t){const i={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[Mw])for(const l of t[Mw]){const u=l.replace(/\/$/,""),h=s._makeStorageReference(new er(e,u));i.prefixes.push(h)}if(t[Lw])for(const l of t[Lw]){const u=s._makeStorageReference(new er(e,l.name));i.items.push(u)}return i}function p6(s,e,t){const i=rv(t);return i===null?null:m6(s,e,i)}class iv{constructor(e,t,i,l){this.url=e,this.method=t,this.handler=i,this.timeout=l,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function av(s){if(!s)throw tv()}function g6(s,e){function t(i,l){const u=cT(s,l,e);return av(u!==null),u}return t}function y6(s,e){function t(i,l){const u=p6(s,e,l);return av(u!==null),u}return t}function v6(s,e){function t(i,l){const u=cT(s,l,e);return av(u!==null),d6(u,l,s.host,s._protocol)}return t}function ov(s){function e(t,i){let l;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?l=CM():l=jM():t.getStatus()===402?l=SM(s.bucket):t.getStatus()===403?l=NM(s.path):l=i,l.status=t.getStatus(),l.serverResponse=i.serverResponse,l}return e}function b6(s){const e=ov(s);function t(i,l){let u=e(i,l);return i.getStatus()===404&&(u=kM(s.path)),u.serverResponse=l.serverResponse,u}return t}function w6(s,e,t,i,l){const u={};e.isRoot?u.prefix="":u.prefix=e.path+"/",t.length>0&&(u.delimiter=t),i&&(u.pageToken=i),l&&(u.maxResults=l);const h=e.bucketOnlyServerUrl(),p=kf(h,s.host,s._protocol),g="GET",y=s.maxOperationRetryTime,b=new iv(p,g,y6(s,e.bucket),y);return b.urlParams=u,b.errorHandler=ov(e),b}function _6(s,e,t){const i=e.fullServerUrl(),l=kf(i,s.host,s._protocol),u="GET",h=s.maxOperationRetryTime,p=new iv(l,u,v6(s,t),h);return p.errorHandler=b6(e),p}function x6(s,e){return s&&s.contentType||e&&e.type()||"application/octet-stream"}function E6(s,e,t){const i=Object.assign({},t);return i.fullPath=s.path,i.size=e.size(),i.contentType||(i.contentType=x6(null,e)),i}function T6(s,e,t,i,l){const u=e.bucketOnlyServerUrl(),h={"X-Goog-Upload-Protocol":"multipart"};function p(){let Y="";for(let de=0;de<2;de++)Y=Y+Math.random().toString().slice(2);return Y}const g=p();h["Content-Type"]="multipart/related; boundary="+g;const y=E6(e,i,l),b=f6(y,t),E="--"+g+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+b+`\r
--`+g+`\r
Content-Type: `+y.contentType+`\r
\r
`,T=`\r
--`+g+"--",O=qa.getBlob(E,i,T);if(O===null)throw LM();const H={name:y.fullPath},q=kf(u,s.host,s._protocol),B="POST",X=s.maxUploadRetryTime,W=new iv(q,B,g6(s,t),X);return W.urlParams=H,W.headers=h,W.body=O.uploadData(),W.errorHandler=ov(e),W}class k6{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Mo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Mo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Mo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,l,u){if(this.sent_)throw Wc("cannot .send() more than once");if(no(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),u!==void 0)for(const h in u)u.hasOwnProperty(h)&&this.xhr_.setRequestHeader(h,u[h].toString());return l!==void 0?this.xhr_.send(l):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Wc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Wc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Wc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Wc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class S6 extends k6{initXhr(){this.xhr_.responseType="text"}}function lv(){return new S6}class zo{constructor(e,t){this._service=e,t instanceof er?this._location=t:this._location=er.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new zo(e,t)}get root(){const e=new er(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return oT(this._location.path)}get storage(){return this._service}get parent(){const e=a6(this._location.path);if(e===null)return null;const t=new er(this._location.bucket,e);return new zo(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw VM(e)}}function j6(s,e,t){s._throwIfRoot("uploadBytes");const i=T6(s.storage,s._location,lT(),new qa(e,!0),t);return s.storage.makeRequestWithTokens(i,lv).then(l=>({metadata:l,ref:s}))}function C6(s){const e={prefixes:[],items:[]};return uT(s,e).then(()=>e)}async function uT(s,e,t){const l=await N6(s,{pageToken:t});e.prefixes.push(...l.prefixes),e.items.push(...l.items),l.nextPageToken!=null&&await uT(s,e,l.nextPageToken)}function N6(s,e){e!=null&&typeof e.maxResults=="number"&&Bg("options.maxResults",1,1e3,e.maxResults);const t=e||{},i=w6(s.storage,s._location,"/",t.pageToken,t.maxResults);return s.storage.makeRequestWithTokens(i,lv)}function A6(s){s._throwIfRoot("getDownloadURL");const e=_6(s.storage,s._location,lT());return s.storage.makeRequestWithTokens(e,lv).then(t=>{if(t===null)throw OM();return t})}function R6(s,e){const t=o6(s._location.path,e),i=new er(s._location.bucket,t);return new zo(s.storage,i)}function I6(s){return/^[A-Za-z]+:\/\//.test(s)}function D6(s,e){return new zo(s,e)}function hT(s,e){if(s instanceof cv){const t=s;if(t._bucket==null)throw MM();const i=new zo(t,t._bucket);return e!=null?hT(i,e):i}else return e!==void 0?R6(s,e):s}function M6(s,e){if(e&&I6(e)){if(s instanceof cv)return D6(s,e);throw Ug("To use ref(service, url), the first argument must be a Storage instance.")}else return hT(s,e)}function Ow(s,e){const t=e?.[tT];return t==null?null:er.makeFromBucketSpec(t,s)}function L6(s,e,t,i={}){s.host=`${e}:${t}`;const l=no(e);l&&(ey(`https://${s.host}/b`),ty("Storage",!0)),s._isUsingEmulator=!0,s._protocol=l?"https":"http";const{mockUserToken:u}=i;u&&(s._overrideAuthToken=typeof u=="string"?u:I_(u,s.app.options.projectId))}class cv{constructor(e,t,i,l,u,h=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=l,this._firebaseVersion=u,this._isUsingEmulator=h,this._bucket=null,this._host=eT,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=EM,this._maxUploadRetryTime=TM,this._requests=new Set,l!=null?this._bucket=er.makeFromBucketSpec(l,this._host):this._bucket=Ow(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=er.makeFromBucketSpec(this._url,e):this._bucket=Ow(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Bg("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Bg("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Sr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new zo(this,e)}_makeRequest(e,t,i,l,u=!0){if(this._deleted)return new UM(nT());{const h=QM(e,this._appId,i,l,t,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(h),h.getPromise().then(()=>this._requests.delete(h),()=>this._requests.delete(h)),h}}async makeRequestWithTokens(e,t){const[i,l]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,l).getPromise()}}const Pw="@firebase/storage",Vw="0.14.0";const dT="storage";function Cd(s,e,t){return s=pn(s),j6(s,e,t)}function Uw(s){return s=pn(s),C6(s)}function Lo(s){return s=pn(s),A6(s)}function $a(s,e){return s=pn(s),M6(s,e)}function O6(s=ju(),e){s=pn(s);const i=$o(s,dT).getImmediate({identifier:e}),l=N_("storage");return l&&P6(i,...l),i}function P6(s,e,t,i={}){L6(s,e,t,i)}function V6(s,{instanceIdentifier:e}){const t=s.getProvider("app").getImmediate(),i=s.getProvider("auth-internal"),l=s.getProvider("app-check-internal");return new cv(t,i,l,e,Wo)}function U6(){ai(new Yr(dT,V6,"PUBLIC").setMultipleInstances(!0)),pr(Pw,Vw,""),pr(Pw,Vw,"esm2020")}U6();const fT={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},uv=ry(fT),So=bx(uv),Se=lM(uv),Wa=O6(uv),B6=ry(fT,"secondary"),tO=bx(B6),z6="EYdciKDOi3UYBLk1u8hHams5tmO2",mT=_.createContext();function hi(){return _.useContext(mT)}function F6({children:s}){const[e,t]=_.useState(null),[i,l]=_.useState(!1),[u,h]=_.useState(!1),[p,g]=_.useState(null),[y,b]=_.useState(!0);_.useEffect(()=>{let W=null;const Y=$A(So,de=>{if(t(de),W&&(W(),W=null),de)if(de.uid===z6)l(!0),h(!1),g(null),b(!1);else{l(!1);const xe=Dn(Mt(Se,"clients"),fn("uid","==",de.uid)),ve=async()=>{const j=localStorage.getItem("mcf_clientId");if(j)try{const S=await mr(tt(Se,"clients",j));S.exists()&&(h(!0),g({id:S.id,...S.data()}))}catch(S){console.error("Direct client read failed:",S)}};W=JE(xe,async j=>{if(j.empty)await ve();else{const S=j.docs[0];h(!0),g({id:S.id,...S.data()});try{localStorage.setItem("mcf_clientId",S.id)}catch{}}b(!1)},async j=>{console.error("Error listening to client data:",j),await ve(),b(!1)})}else l(!1),h(!1),g(null),b(!1)});return()=>{Y(),W&&W()}},[]);const X={currentUser:e,isAdmin:i,isClient:u,clientData:p,updateClientData:W=>{g(Y=>Y?{...Y,...W}:W)},resolveClient:async()=>{if(p)return p;const W=localStorage.getItem("mcf_clientId");if(W)try{const Y=await mr(tt(Se,"clients",W));if(Y.exists()){const de={id:Y.id,...Y.data()};return h(!0),g(de),de}}catch(Y){console.error("resolveClient direct read failed:",Y)}if(e){const Y=Dn(Mt(Se,"clients"),fn("uid","==",e.uid)),de=await Tn(Y);if(!de.empty){const xe={id:de.docs[0].id,...de.docs[0].data()};return h(!0),g(xe),xe}}return null},login:async(W,Y,de=!0)=>(await x2(So,de?_g:hy),await FA(So,W,Y)),signup:async(W,Y,de)=>{await x2(So,_g);const xe=await zA(So,Y.trim().toLowerCase(),de),ve=xe.user,j=tt(Mt(Se,"clients")),S={uid:ve.uid,name:W.trim(),email:Y.trim().toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"self_signup",createdAt:Gt.now()};await Os(j,S),h(!0),g({id:j.id,...S});try{localStorage.setItem("mcf_clientId",j.id)}catch{}return xe},logout:()=>{try{localStorage.removeItem("mcf_clientId")}catch{}return WA(So)},resetPassword:W=>BA(So,W),loading:y};return a.jsx(mT.Provider,{value:X,children:s})}const pT=_.createContext();function ao(){return _.useContext(pT)}function q6({children:s}){const[e,t]=_.useState(()=>{const g=localStorage.getItem("theme");return g?g==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),[i,l]=_.useState(()=>localStorage.getItem("accent")||"red");_.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light")},[e]),_.useEffect(()=>{localStorage.setItem("accent",i)},[i]);const p={isDark:e,toggleTheme:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),t(!e),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)},accent:i,setAccent:g=>l(g)};return a.jsx(pT.Provider,{value:p,children:s})}const gT=_.createContext();function Bu(){return _.useContext(gT)}const H6=["nutrition","buddies"],$6=[5,10],W6=2,G6=1;function K6({children:s}){const{clientData:e,loading:t}=hi(),i=_.useMemo(()=>{const l=e?.tier||"free",u=e?.subscriptionStatus||null,h=e&&e.signupSource!=="self_signup",p=l==="premium"||!!h;function g(y){return p?!0:!H6.includes(y)}return{tier:l,subscriptionStatus:u,isPremium:p,canAccess:g,loading:t,FREE_RANDOMISER_DURATIONS:$6,FREE_RANDOMISER_WEEKLY_LIMIT:W6,FREE_HABIT_LIMIT:G6}},[e?.tier,e?.subscriptionStatus,e?.signupSource,t]);return a.jsx(gT.Provider,{value:i,children:s})}function Y6(s){if(s?.signupSource==="self_signup"&&!s?.onboardingComplete)return"/onboarding";const e=s?.clientType;return e==="core_buddy"?"/client/core-buddy":e==="circuit_vip"||e==="circuit_dropin"?"/client/circuit":"/client"}function Q6({className:s=""}){const{isDark:e,toggleTheme:t}=ao();return a.jsx("button",{className:s||"theme-toggle",onClick:t,"aria-label":e?"Switch to light mode":"Switch to dark mode",children:e?a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})})}function X6(){const[s,e]=_.useState(""),[t,i]=_.useState(""),[l,u]=_.useState(!0),[h,p]=_.useState(""),[g,y]=_.useState(!1),[b,E]=_.useState(!1),[T,O]=_.useState(!1),{login:H,resetPassword:q,currentUser:B,isAdmin:X,isClient:W,clientData:Y,loading:de}=hi(),xe=gr();if(_.useEffect(()=>{if(!de&&B){if(!B.emailVerified&&Y?.signupSource==="self_signup"){xe("/signup");return}X?xe("/dashboard"):W?xe(Y6(Y)):(y(!1),p("No account found. Please sign up or contact your trainer."))}},[de,B,X,W,Y,xe]),de||B)return a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",background:"var(--bg-body)"},children:a.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})});const ve=async S=>{S.preventDefault(),p(""),y(!0);try{await H(s,t,l)}catch(I){p(I.message||"Failed to log in"),y(!1)}},j=async S=>{if(S.preventDefault(),p(""),!s.trim()){p("Please enter your email address");return}y(!0);try{await q(s.trim()),O(!0)}catch(I){I.code==="auth/user-not-found"?p("No account found with this email"):p(I.message||"Failed to send reset email")}y(!1)};return a.jsxs("div",{className:"login-container",children:[a.jsx(Q6,{className:"login-theme-toggle"}),a.jsxs("div",{className:"login-card",children:[a.jsxs("div",{className:"login-header",children:[a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),a.jsx("p",{children:a.jsx("strong",{children:b?"Reset Password":"Sign in as 1-2-1 or a Core Buddy"})})]}),h&&a.jsx("div",{className:"error-message",children:h}),T?a.jsxs("div",{className:"reset-sent",children:[a.jsx("div",{className:"reset-sent-icon",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),a.jsx("p",{children:"Reset email sent!"}),a.jsx("span",{children:"Check your inbox for a password reset link"}),a.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{E(!1),O(!1),p("")},children:"Back to Log In"})]}):b?a.jsxs("form",{onSubmit:j,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:s,onChange:S=>e(S.target.value),placeholder:"Enter your email",required:!0})]}),a.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Sending...":"Send Reset Link"}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{E(!1),p("")},children:"Back to Log In"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("form",{onSubmit:ve,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:s,onChange:S=>e(S.target.value),required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"password",children:"Password"}),a.jsx("input",{type:"password",id:"password",value:t,onChange:S=>i(S.target.value),required:!0})]}),a.jsx("div",{className:"remember-me",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:l,onChange:S=>u(S.target.checked)}),a.jsx("span",{children:"Remember me"})]})}),a.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Logging in...":"Log In"})]}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{E(!0),p("")},children:"Forgot password?"}),a.jsx("button",{type:"button",className:"login-btn login-btn-outline",onClick:()=>xe("/signup"),children:"Don't have an account? Create one free"})]}),a.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})]})}function hd({feature:s,children:e}){const{canAccess:t,loading:i}=Bu();return i||t(s)?e:a.jsx(b_,{to:"/upgrade",replace:!0})}function Ri({active:s}){const e=gr(),{clientData:t}=hi(),{isPremium:i}=Bu(),l=t?.clientType==="block"&&t?.coreBuddyAccess;return a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:`block-nav-tab${s==="home"?" active":""}`,onClick:()=>e("/client/core-buddy"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),a.jsx("span",{children:"Profile"})]}),a.jsxs("button",{className:`block-nav-tab${s==="workouts"?" active":""}`,onClick:()=>e("/client/core-buddy/workouts"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:a.jsx("path",{d:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"})}),a.jsx("span",{children:"Workout"})]}),i&&a.jsxs("button",{className:`block-nav-tab${s==="nutrition"?" active":""}`,onClick:()=>e("/client/core-buddy/nutrition"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"})}),a.jsx("span",{children:"Nutrition"})]}),i&&a.jsxs("button",{className:`block-nav-tab${s==="buddies"?" active":""}`,onClick:()=>e("/client/core-buddy/buddies"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"Buddies"})]}),l&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>e("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),a.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),a.jsx("span",{children:"Block"})]})]})}function Xo({children:s,onRefresh:e}){const[t,i]=_.useState(0),[l,u]=_.useState(!1),h=_.useRef(null),p=_.useRef(0),g=_.useRef(!1),y=_.useCallback(T=>{window.scrollY<=0&&(p.current=T.touches[0].clientY,g.current=!0)},[]),b=_.useCallback(T=>{if(!g.current||l)return;const O=T.touches[0].clientY-p.current;O>20&&window.scrollY<=0&&(T.preventDefault(),i(Math.min((O-20)*.35,80)))},[l]),E=_.useCallback(async()=>{t>55&&!l&&(u(!0),e?await e():window.location.reload(),u(!1)),i(0),g.current=!1},[t,l,e]);return a.jsxs("div",{ref:h,onTouchStart:y,onTouchMove:b,onTouchEnd:E,children:[a.jsxs("div",{className:`pull-refresh-indicator ${t>0?"visible":""} ${l?"refreshing":""}`,style:{height:t},children:[a.jsx("div",{className:`refresh-spinner ${l?"spinning":""}`,children:a.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:a.jsx("path",{fill:"currentColor",d:"M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})})}),a.jsx("span",{className:"refresh-text",children:l?"Refreshing...":"Pull to refresh"})]}),s]})}function zu(s,e,t,i,l){const u=[];for(let h=0;h<s;h++){const p=(h*(360/s)-90)*(Math.PI/180);u.push({x1:e+i*Math.cos(p),y1:t+i*Math.sin(p),x2:e+l*Math.cos(p),y2:t+l*Math.sin(p),thick:h%5===0})}return u}const yT=zu(60,100,100,85,96),J6=zu(60,100,100,78,94),Z6=zu(60,100,100,82,94);zu(60,50,50,38,46);const nO=zu(60,40,40,30,37);function e3({steps:s,onFinish:e,active:t}){const[i,l]=_.useState(0),[u,h]=_.useState(null),[p,g]=_.useState("below"),[y,b]=_.useState(!1),E=_.useRef(null),T=_.useRef(t);T.current=t,_.useEffect(()=>{t||l(0)},[t]),_.useEffect(()=>{if(!t)return;const xe=ve=>ve.preventDefault();return document.addEventListener("touchmove",xe,{passive:!1}),document.addEventListener("wheel",xe,{passive:!1}),document.body.style.overflow="hidden",()=>{document.removeEventListener("touchmove",xe),document.removeEventListener("wheel",xe),document.body.style.overflow=""}},[t]);const O=_.useMemo(()=>t?s.filter(xe=>document.querySelector(xe.selector)):[],[t]),H=O[i],q=i===O.length-1,B=H?.selector,X=_.useCallback(()=>{if(!B)return;const xe=document.querySelector(B);if(!xe){h(null);return}const ve=xe.getBoundingClientRect(),j=8;h({top:ve.top-j,left:ve.left-j,width:ve.width+j*2,height:ve.height+j*2});const S=window.innerHeight-ve.bottom;g(S<260?"above":"below")},[B]);if(_.useEffect(()=>{if(!t||!B)return;b(!0);const xe=document.querySelector(B);if(xe){document.body.style.overflow="",xe.scrollIntoView({behavior:"smooth",block:"center"});let ve=null,j=0,S=0;const I=60,V=()=>{S++;const A=xe.getBoundingClientRect(),Be=Math.round(A.top);if(ve!==null&&Be===ve?j++:j=0,ve=Be,j>=3||S>=I){T.current&&(document.body.style.overflow="hidden"),X(),b(!1);return}D=requestAnimationFrame(V)};let D;const M=setTimeout(()=>{D=requestAnimationFrame(V)},120);return()=>{clearTimeout(M),D&&cancelAnimationFrame(D),T.current&&(document.body.style.overflow="hidden")}}},[t,i,B,X]),_.useEffect(()=>{if(!t)return;const xe=()=>{E.current&&cancelAnimationFrame(E.current),E.current=requestAnimationFrame(X)};return window.addEventListener("scroll",xe,!0),window.addEventListener("resize",xe),()=>{window.removeEventListener("scroll",xe,!0),window.removeEventListener("resize",xe),E.current&&cancelAnimationFrame(E.current)}},[t,X]),!t||!H||O.length===0)return null;const W=()=>{q?e():l(i+1)},Y=()=>{i>0&&l(i-1)},de=()=>e();return a.jsxs("div",{className:"st-overlay",onClick:xe=>{xe.stopPropagation()},children:[a.jsx("div",{className:"st-backdrop",onClick:W}),u&&a.jsx("div",{className:`st-spotlight${y?" st-transitioning":""}`,style:{top:u.top,left:u.left,width:u.width,height:u.height}}),u&&a.jsxs("div",{className:`st-tooltip st-tooltip-${p}${y?" st-transitioning":""}`,style:{top:p==="below"?Math.min(Math.max(u.top+u.height+16,16),window.innerHeight-200):void 0,bottom:p==="above"?Math.min(Math.max(window.innerHeight-u.top+16,16),window.innerHeight-60):void 0,left:Math.max(16,Math.min(u.left,window.innerWidth-320))},children:[a.jsx("div",{className:"st-dots",children:O.map((xe,ve)=>a.jsx("span",{className:`st-dot${ve===i?" active":""}${ve<i?" done":""}`},ve))}),a.jsx("h3",{className:"st-title",children:H.title}),a.jsx("p",{className:"st-body",children:H.body}),a.jsxs("div",{className:"st-actions",children:[i>0&&a.jsx("button",{className:"st-btn st-btn-back",onClick:Y,children:"Back"}),a.jsx("button",{className:"st-btn st-btn-next",onClick:W,children:H.cta||(q?"Let's Go!":"Next")})]}),a.jsx("button",{className:"st-skip",onClick:de,children:"Skip tour"})]})]})}const Bw=3,t3=5;function Wp(s){return s.toISOString().split("T")[0]}const Gp=[{text:"You have 24 hours a day...",bold:"make it count"},{text:"Discipline beats motivation...",bold:"every single time"},{text:"Rest when you're done,",bold:"not when you're tired"},{text:"Small daily gains...",bold:"create massive results"},{text:"Your body keeps score,",bold:"train it well"},{text:"Consistency over intensity...",bold:"always wins"},{text:"The only bad workout...",bold:"is the one you skipped"}];function Kp(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function Gc(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function n3(s,e=800){return new Promise(t=>{const i=new Image;i.onload=()=>{const l=document.createElement("canvas");let u=i.width,h=i.height;u>h?u>e&&(h=Math.round(h*e/u),u=e):h>e&&(u=Math.round(u*e/h),h=e),l.width=u,l.height=h,l.getContext("2d").drawImage(i,0,0,u,h),l.toBlob(p=>t(p),"image/jpeg",.8)},i.src=URL.createObjectURL(s)})}function s3(){const{currentUser:s,isClient:e,clientData:t,logout:i,updateClientData:l,loading:u}=hi(),{isDark:h,toggleTheme:p}=ao(),{isPremium:g,FREE_HABIT_LIMIT:y}=Bu(),b=gr(),E=g?t3:y,[T,O]=_.useState({hours:0,minutes:0,seconds:0}),[H,q]=_.useState(0),[B,X]=_.useState(0),[W,Y]=_.useState(0),[de,xe]=_.useState(!1),[ve,j]=_.useState({protein:0,carbs:0,fats:0,calories:0}),[S,I]=_.useState(null),[V,D]=_.useState(0),[M,A]=_.useState(0),[Be,Ze]=_.useState(Bw),[te,_e]=_.useState(!1),[Ie,ze]=_.useState(!1),[re,L]=_.useState([]),[ie,we]=_.useState(null),[ke,Te]=_.useState(!1),Ee=_.useRef(null),[Ke,ct]=_.useState(0),[Ve,tn]=_.useState(0),[jn,Un]=_.useState(null),Lt=_.useCallback((C,G="info")=>{Un({message:C,type:G}),setTimeout(()=>Un(null),4e3)},[]),[rt,gt]=_.useState([]),[ut,Bn]=_.useState(!1),[ue,Rt]=_.useState(""),[yt,Vt]=_.useState(null),[Je,At]=_.useState(null),[vt,nn]=_.useState(!1),[js,rs]=_.useState(new Set),[Xt,ne]=_.useState(new Set),[Ne,xt]=_.useState({}),[bt,it]=_.useState({}),[$e,st]=_.useState({}),[Fe,sn]=_.useState({}),[on,Ln]=_.useState({}),[zn,Xn]=_.useState({}),Yt=_.useRef(null),Fn=_.useRef(null),Cn=_.useRef({}),[ln,yr]=_.useState([]),[oe,Ae]=_.useState(!1),Ge=_.useRef(null),[mt,lt]=_.useState([]),[vn,Nn]=_.useState(""),[dn,bn]=_.useState(!1),[Cs,is]=_.useState(null),[ds,Jt]=_.useState([]),[An,Ns]=_.useState(null),[Ar,di]=_.useState(!1),Rr=_.useRef(!1),Ir=(()=>{const C=[{selector:".cb-ring-container",title:"Your 24-Hour Countdown",body:"Every day resets. This ring tracks the time you have left  tap your photo to personalise your profile.",cta:"Next"},{selector:".cb-stats-row",title:"Progress at a Glance",body:"Your workout streak, sessions this week, and daily habits  all in one row. These fill up as you go."},{selector:".cb-nudge-card",title:"Smart Suggestions",body:"We'll highlight what needs your attention  your next session, unfinished habits, or a meal to log."},{selector:".cb-card-workouts-hero",title:"Workout",body:"Randomiser workouts  pick your focus, level and time. Save and replay your favourites.",cta:"Next"}];return g&&C.push({selector:".cb-card-nutrition",title:"Nutrition Tracking",body:"Set your macro targets, scan barcodes, and log meals to hit your daily goals."},{selector:".cb-card-consistency",title:"Daily Habits",body:"5 simple habits each day  train, hit protein, 10k steps, sleep, and hydrate. Build your streak."},{selector:".cb-card-buddies",title:"Buddies & Social",body:"Connect with other members, share your journey, and keep each other accountable."},{selector:".cb-journey-section",title:"Share Your Journey",body:"Post photos, updates, and milestones  your fitness journey in one place. Like and comment on each other's posts."}),C.push({selector:".block-bottom-nav",title:"You're All Set!",body:"Use the nav bar to jump between your profile, workouts, nutrition, and buddies. Time to get after it.",cta:"Let's Go!"}),C})();_.useEffect(()=>{!u&&!s&&b("/")},[u,s,b]),_.useEffect(()=>{!u&&t&&t.signupSource==="self_signup"&&!t.onboardingComplete&&b("/onboarding")},[u,t,b]),_.useEffect(()=>{let C=t?.tourComplete||Rr.current;if(!C&&t?.id)try{C=!!localStorage.getItem(`tourDone_${t.id}`)}catch{}if(de&&t&&!C){const G=setTimeout(()=>di(!0),600);return()=>clearTimeout(G)}},[de,t]),_.useEffect(()=>{if(!(!de||!t?.id)){try{if(localStorage.getItem(`targetHint_${t.id}`))return}catch{}if(!t?.weeklyWorkoutTarget){const C=setTimeout(()=>ze(!0),1500);return()=>clearTimeout(C)}}},[de,t]),_.useEffect(()=>{if(t)try{const C=sessionStorage.getItem(`cbDash_${t.id}`);if(C){const G=JSON.parse(C);X(G.totalWorkouts??0),Y(G.habitWeekPct??0),j(G.nutritionTotals??{protein:0,carbs:0,fats:0,calories:0}),I(G.nutritionTargetData??null),D(G.todayHabitsCount??0),A(G.weeklyWorkouts??0),Ze(G.weeklyWorkoutTarget??Bw),L(G.leaderboardTop3??[]),ct(G.streakWeeks??0),xe(!0)}}catch{}},[t]),_.useEffect(()=>{t?.photoURL&&we(t.photoURL),t?.weeklyWorkoutTarget&&Ze(t.weeklyWorkoutTarget)},[t]),_.useEffect(()=>{if(!t)return;const C=Dn(Mt(Se,"notifications"),fn("toId","==",t.id)),G=JE(C,Ce=>{const Re=Ce.docs.map(Pe=>({id:Pe.id,...Pe.data()}));Re.sort((Pe,ht)=>{const et=Pe.createdAt?.toMillis?.()||0;return(ht.createdAt?.toMillis?.()||0)-et}),yr(Re.slice(0,50))},Ce=>{console.error("Notification listener error:",Ce),Ce.code==="permission-denied"&&console.warn("Firestore rules may be missing for the notifications collection. Please update your Firestore rules in the Firebase Console.")});return()=>G()},[t]),_.useEffect(()=>{const C=G=>{Ge.current&&!Ge.current.contains(G.target)&&Ae(!1)};return document.addEventListener("mousedown",C),()=>document.removeEventListener("mousedown",C)},[]),_.useEffect(()=>{if(!t)return;const C=t.id;(async()=>{try{const[G,Ce,Re]=await Promise.all([Tn(Dn(Mt(Se,"buddies"),fn("user1","==",C))),Tn(Dn(Mt(Se,"buddies"),fn("user2","==",C))),Tn(Mt(Se,"clients"))]),Pe=new Set;[...G.docs,...Ce.docs].forEach(et=>{const kt=et.data();Pe.add(kt.user1===C?kt.user2:kt.user1)});const ht={};Re.docs.forEach(et=>{ht[et.id]=et.data()}),lt(Array.from(Pe).filter(et=>ht[et]).map(et=>({id:et,name:ht[et].name,photoURL:ht[et].photoURL||null})))}catch(G){console.error("Error loading buddies for mentions:",G)}})()},[t]);const qn=ln.filter(C=>!C.read).length,Ks=async()=>{const C=ln.filter(Ce=>!Ce.read);if(!C.length)return;const G=Iw(Se);C.forEach(Ce=>G.update(tt(Se,"notifications",Ce.id),{read:!0})),await G.commit()},_s=async()=>{if(!ln.length)return;const C=Iw(Se);ln.forEach(G=>C.delete(tt(Se,"notifications",G.id))),await C.commit()},kn=async(C,G,Ce={})=>{if(!(!t||C===t.id))try{await ri(Mt(Se,"notifications"),{toId:C,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:G,read:!1,createdAt:fr(),...Ce})}catch(Re){console.error("Notification create error:",Re),Re.code==="permission-denied"&&Lt("Notifications blocked  check Firestore rules","error")}},On=(C,G)=>{const Ce=G==="compose"?Yt.current?.selectionStart:null,Pe=(Ce!=null?C.slice(0,Ce):C).match(/@(\w*)$/);if(Pe){bn(!0),is(G),Nn(Pe[1].toLowerCase());const ht=mt.filter(et=>et.name&&et.name.toLowerCase().includes(Pe[1].toLowerCase())).slice(0,5);Jt(ht)}else bn(!1),Jt([])},as=(C,G)=>{if(G==="compose"){const Ce=Yt.current,Re=ue,Pe=Ce?.selectionStart??Re.length,ht=Re.slice(0,Pe),et=Re.slice(Pe),kt=ht.replace(/@\w*$/,`@${C.name} `);Rt(kt+et),setTimeout(()=>{Ce?.focus(),Ce.selectionStart=Ce.selectionEnd=kt.length},0)}else{const Re=(bt[G]||"").replace(/@\w*$/,`@${C.name} `);it(Pe=>({...Pe,[G]:Re}))}bn(!1),Jt([])},zt=C=>C&&C.split(/(@\w[\w\s]*?\s)/g).map((Ce,Re)=>Ce.startsWith("@")&&mt.some(Pe=>Ce.trim()===`@${Pe.name}`)?a.jsx("span",{className:"mention-highlight",children:Ce.trim()},Re):Ce),Qr=async C=>{const G=C.target.files?.[0];if(!(!G||!t)){if(!G.type.startsWith("image/")){Lt("Please select an image file","error");return}if(G.size>5*1024*1024){Lt("Image must be under 5MB","error");return}Te(!0);try{const Ce=await new Promise(ht=>{const et=new Image;et.onload=()=>{const kt=document.createElement("canvas"),dt=400;let P=et.width,Q=et.height;P>Q?(Q=Q/P*dt,P=dt):(P=P/Q*dt,Q=dt),kt.width=P,kt.height=Q,kt.getContext("2d").drawImage(et,0,0,P,Q),kt.toBlob(Z=>ht(Z),"image/jpeg",.75)},et.src=URL.createObjectURL(G)}),Re=$a(Wa,`profilePhotos/${t.id}`);await Cd(Re,Ce);const Pe=await Lo(Re);await Zs(tt(Se,"clients",t.id),{photoURL:Pe}),we(Pe),l({photoURL:Pe}),Lt("Profile photo updated!","success")}catch(Ce){console.error("Photo upload error:",Ce),Lt("Failed to upload photo","error")}Te(!1),Ee.current&&(Ee.current.value="")}};_.useEffect(()=>{const C=()=>{const Ce=new Date,Re=new Date(Ce);Re.setHours(23,59,59,999);const Pe=Re-Ce,ht=Math.floor(Pe/(1e3*60*60)),et=Math.floor(Pe%(1e3*60*60)/(1e3*60)),kt=Math.floor(Pe%(1e3*60)/1e3);O({hours:ht,minutes:et,seconds:kt}),q(60-kt)};C();const G=setInterval(C,1e3);return()=>clearInterval(G)},[]),_.useEffect(()=>{const C=setInterval(()=>{tn(G=>(G+1)%Gp.length)},8e3);return()=>clearInterval(C)},[]),_.useEffect(()=>{if(!s||!t)return;(async()=>{let G=null,Ce=null;try{const Re=Wp(new Date),Pe=Mt(Se,"workoutLogs"),ht=Dn(Pe,fn("clientId","==",t.id));G=await Tn(ht),X(G.docs.length);const et=new Date,kt=et.getDay(),dt=kt===0?6:kt-1,P=new Date(et);P.setDate(et.getDate()-dt),P.setHours(0,0,0,0);const Q=P.getTime(),Z=G.docs.filter(Pt=>{const Qe=Pt.data().completedAt;return Qe?(Qe.toDate?Qe.toDate().getTime():new Date(Qe).getTime())>=Q:!1}).length;A(Z);const pe=Mt(Se,"habitLogs"),je=Dn(pe,fn("clientId","==",t.id),fn("date","==",Re)),Oe=await Tn(je);let qe=0;if(!Oe.empty){const Pt=Oe.docs[0].data().habits||{};qe=Math.min(Object.values(Pt).filter(Boolean).length,E)}Y(Math.round(qe/E*100)),D(qe);const pt=await mr(tt(Se,"nutritionTargets",t.id));pt.exists()&&(I(pt.data()),Ce=pt.data());const Et=await mr(tt(Se,"nutritionLogs",`${t.id}_${Re}`));if(Et.exists()){const Qe=(Et.data().entries||[]).reduce((Zt,Us)=>({protein:Zt.protein+(Us.protein||0),carbs:Zt.carbs+(Us.carbs||0),fats:Zt.fats+(Us.fats||0),calories:Zt.calories+(Us.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});j(Qe)}}catch(Re){console.error("Error loading dashboard stats:",Re)}try{const Re=Mt(Se,"clients"),Pe=Dn(Re,fn("leaderboardOptIn","==",!0)),et=(await Tn(Pe)).docs.map(kt=>({id:kt.id,name:kt.data().name,photoURL:kt.data().photoURL||null}));L(et.slice(0,3))}catch(Re){console.error("Leaderboard preview error:",Re)}try{let Re=0;if(G){const Pe=G.docs.map(ht=>ht.data().date).filter(Boolean).sort().reverse();if(Pe.length>0){const ht=new Date;let et=new Date(ht);e:for(let kt=0;kt<52;kt++){const dt=new Date(et),P=dt.getDay(),Q=P===0?6:P-1;dt.setDate(dt.getDate()-Q),dt.setHours(0,0,0,0);const Z=new Date(dt);Z.setDate(Z.getDate()+7);const pe=Wp(dt),je=Wp(Z);if(Pe.some(qe=>qe>=pe&&qe<je))Re++;else{if(kt>0)break e;break}et.setDate(et.getDate()-7)}}}ct(Re)}catch(Re){console.error("Streak computation error:",Re)}xe(!0)})()},[s,t,E]),_.useEffect(()=>{if(!(!de||!t))try{sessionStorage.setItem(`cbDash_${t.id}`,JSON.stringify({totalWorkouts:B,habitWeekPct:W,nutritionTotals:ve,nutritionTargetData:S,todayHabitsCount:V,weeklyWorkouts:M,weeklyWorkoutTarget:Be,leaderboardTop3:re,streakWeeks:Ke}))}catch{}},[de,B,W,ve,S,V,M,Be,re,Ke,t]);const Dr=_.useCallback(async()=>{if(Rr.current=!0,di(!1),l({tourComplete:!0}),t?.id){try{localStorage.setItem(`tourDone_${t.id}`,"1")}catch{}try{await Zs(tt(Se,"clients",t.id),{tourComplete:!0})}catch(C){console.error("Failed to save tour completion:",C)}}},[t,l]),xs=_.useCallback(async C=>{if(Ze(C),_e(!1),ze(!1),t?.id){try{localStorage.setItem(`targetHint_${t.id}`,"1")}catch{}try{await Zs(tt(Se,"clients",t.id),{weeklyWorkoutTarget:C})}catch(G){console.error("Failed to save weekly target:",G)}}},[t]),wn=C=>{const G=C.currentTarget,Ce=G.querySelector(".ripple");Ce&&Ce.remove();const Re=G.getBoundingClientRect(),Pe=Math.max(Re.width,Re.height),ht=C.clientX-Re.left-Pe/2,et=C.clientY-Re.top-Pe/2,kt=document.createElement("span");kt.className="ripple",kt.style.cssText=`width:${Pe}px;height:${Pe}px;left:${ht}px;top:${et}px;`,G.appendChild(kt),setTimeout(()=>kt.remove(),600)},rr=t?.name?.split(" ")[0]||"there",fi=Math.min(Math.round(M/Be*100),100),R=Ke>0?Math.min(Math.round(Ke/12*100),100):0,z=[{label:"Wk Streak",value:`${Ke}`,pct:R,color:"var(--color-primary)",size:"normal"},{label:"Workouts",value:`${M}/${Be}`,pct:fi,color:"var(--color-primary)",size:"large",editable:!0},{label:"Habits Today",value:`${W}%`,pct:W,color:"var(--color-primary)",size:"normal"}],ae=C=>!S||!S[C]?0:Math.min(Math.round(ve[C]/S[C]*100),100),le=(()=>{const C=new Date().getHours();return de&&V>=E&&ve.calories>0?{main:"Smashed it today,",sub:"Rest up and go again tomorrow."}:C>=5&&C<12?{main:"Rise and grind,",sub:"let's get after it!"}:C>=12&&C<17?{main:"Oye",sub:"crack on and make it count!"}:C>=17&&C<21?{main:"Evening session?",sub:"Let's finish strong!"}:{main:"Burning the midnight oil,",sub:"Respect the hustle!"}})(),Me=de?M===0?{label:"WORKOUT",message:"No workouts this week yet",cta:"Start One",action:()=>b("/client/core-buddy/workouts"),pct:0,ringLabel:"0"}:V<E?{label:"DAILY HABITS",message:`${V}/${E} completed`,cta:"Open Habits",action:()=>b("/client/core-buddy/consistency"),pct:W,ringLabel:`${V}/${E}`}:g&&ve.calories===0?{label:"NUTRITION",message:"No meals logged today",cta:"Log Meal",action:()=>b("/client/core-buddy/nutrition"),pct:0,ringLabel:"0"}:{label:"TODAY",message:"You're crushing it!",cta:null,action:null,pct:100,ringLabel:""}:null,Le=_.useCallback(async()=>{if(t){Bn(!0);try{const C=await Tn(Dn(Mt(Se,"posts"),fn("authorId","==",t.id),wu("createdAt","desc"),_u(30)));gt(C.docs.map(Ce=>({id:Ce.id,...Ce.data()})));const G=await Tn(Dn(Mt(Se,"postLikes"),fn("userId","==",t.id)));rs(new Set(G.docs.map(Ce=>Ce.data().postId)))}catch(C){console.error("Error loading journey:",C)}finally{Bn(!1)}}},[t]);_.useEffect(()=>{de&&t&&Le()},[de,t,Le]);const He=C=>{const G=C.target.files?.[0];if(G){if(!G.type.startsWith("image/")){Lt("Please select an image file","error");return}if(G.size>10*1024*1024){Lt("Image must be under 10MB","error");return}Vt(G),At(URL.createObjectURL(G))}},Ft=()=>{Vt(null),Je&&URL.revokeObjectURL(Je),At(null),Fn.current&&(Fn.current.value="")},Ye=async()=>{if(!(!ue.trim()&&!yt||vt||!t)){nn(!0);try{let C=null;if(yt){const Re=await n3(yt),Pe=`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,ht=$a(Wa,`postImages/${t.id}/${Pe}`);await Cd(ht,Re),C=await Lo(ht)}await ri(Mt(Se,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:ue.trim(),type:C?"image":"text",imageURL:C||null,createdAt:fr(),likeCount:0,commentCount:0});const Ce=ue.trim().match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Ce){const Re=new Set;Ce.forEach(Pe=>{const ht=Pe.slice(1).trim(),et=mt.find(kt=>kt.name&&kt.name.toLowerCase()===ht.toLowerCase());et&&!Re.has(et.id)&&(Re.add(et.id),kn(et.id,"mention",{}))})}Rt(""),Ft(),Yt.current&&(Yt.current.style.height="auto"),await Le(),Lt("Posted!","success")}catch(C){console.error("Error posting:",C),Lt(C?.message||"Failed to post","error")}finally{nn(!1)}}},Kn=async C=>{if(window.confirm("Delete this post?"))try{await jr(tt(Se,"posts",C)),gt(G=>G.filter(Ce=>Ce.id!==C)),Lt("Post deleted","info")}catch(G){console.error("Delete error:",G),Lt("Failed to delete","error")}},os=async C=>{if(!t)return;const G=t.id,Ce=`${C}_${G}`,Re=js.has(C),Pe=new Set(js);Re?Pe.delete(C):Pe.add(C),rs(Pe),gt(ht=>ht.map(et=>et.id===C?{...et,likeCount:Math.max(0,(et.likeCount||0)+(Re?-1:1))}:et));try{if(Re)await jr(tt(Se,"postLikes",Ce)),await Zs(tt(Se,"posts",C),{likeCount:Ao(-1)});else{await Os(tt(Se,"postLikes",Ce),{postId:C,userId:G,createdAt:fr()}),await Zs(tt(Se,"posts",C),{likeCount:Ao(1)});const ht=rt.find(et=>et.id===C);ht&&kn(ht.authorId,"like",{postId:C})}}catch(ht){console.error("Like error:",ht),Le()}},Vs=async C=>{try{const G=await Tn(Dn(Mt(Se,"postComments"),fn("postId","==",C),wu("createdAt","asc"),_u(50)));xt(Ce=>({...Ce,[C]:G.docs.map(Re=>({id:Re.id,...Re.data()}))}))}catch(G){console.error("Error loading comments:",G)}},Yn=C=>{const G=new Set(Xt);G.has(C)?G.delete(C):(G.add(C),Ne[C]||Vs(C)),ne(G)},vr=async C=>{const G=(bt[C]||"").trim(),Ce=on[C];if(!(!G&&!Ce||!t)){st(Re=>({...Re,[C]:!0}));try{let Re=null;if(Ce){const dt=$a(Wa,`comment-images/${Date.now()}_${Ce.name}`);await Cd(dt,Ce),Re=await Lo(dt)}const Pe={postId:C,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:G||"",createdAt:fr()};Re&&(Pe.imageURL=Re);const ht=Fe[C];ht&&(Pe.replyToId=ht.id,Pe.replyToName=ht.authorName),await ri(Mt(Se,"postComments"),Pe),await Zs(tt(Se,"posts",C),{commentCount:Ao(1)});const et=rt.find(dt=>dt.id===C);et&&kn(et.authorId,"comment",{postId:C});const kt=G.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(kt){const dt=new Set;kt.forEach(P=>{const Q=P.slice(1).trim(),Z=mt.find(pe=>pe.name&&pe.name.toLowerCase()===Q.toLowerCase());Z&&!dt.has(Z.id)&&(dt.add(Z.id),kn(Z.id,"mention",{postId:C}))})}it(dt=>({...dt,[C]:""})),Ln(dt=>({...dt,[C]:null})),Xn(dt=>({...dt,[C]:null})),sn(dt=>({...dt,[C]:null})),Cn.current[C]&&(Cn.current[C].value=""),gt(dt=>dt.map(P=>P.id===C?{...P,commentCount:(P.commentCount||0)+1}:P)),await Vs(C)}catch(Re){console.error("Comment error:",Re),Lt("Failed to comment","error")}finally{st(Re=>({...Re,[C]:!1}))}}},fa=async(C,G)=>{try{await jr(tt(Se,"postComments",G)),await Zs(tt(Se,"posts",C),{commentCount:Ao(-1)}),xt(Ce=>({...Ce,[C]:(Ce[C]||[]).filter(Re=>Re.id!==G)})),gt(Ce=>Ce.map(Re=>Re.id===C?{...Re,commentCount:Math.max((Re.commentCount||1)-1,0)}:Re))}catch(Ce){console.error("Delete comment error:",Ce),Lt("Failed to delete comment","error")}},Di=(C,G)=>{const Ce=G.target.files?.[0];if(!Ce)return;if(Ce.size>5*1024*1024){Lt("Image must be under 5MB","error");return}Ln(Pe=>({...Pe,[C]:Ce}));const Re=new FileReader;Re.onload=Pe=>Xn(ht=>({...ht,[C]:Pe.target.result})),Re.readAsDataURL(Ce)},Mr=C=>{Ln(G=>({...G,[C]:null})),Xn(G=>({...G,[C]:null})),Cn.current[C]&&(Cn.current[C].value="")},ma=C=>{Rt(C.target.value),C.target.style.height="auto",C.target.style.height=Math.min(C.target.scrollHeight,120)+"px",On(C.target.value,"compose")},Lr=(C,G)=>{it(Ce=>({...Ce,[C]:G})),On(G,C)};return a.jsx(Xo,{children:a.jsxs("div",{className:"cb-dashboard","data-theme":h?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsxs("div",{className:"header-notif-wrap",ref:Ge,children:[a.jsxs("button",{className:"header-notif-btn",onClick:()=>{Ae(!oe),oe||Ks()},"aria-label":"Notifications",children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),a.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),qn>0&&a.jsx("span",{className:"header-notif-badge",children:qn>9?"9+":qn})]}),oe&&a.jsxs("div",{className:"notif-panel",children:[a.jsxs("div",{className:"notif-panel-header",children:[a.jsx("span",{className:"notif-panel-title",children:"Notifications"}),ln.length>0&&a.jsx("button",{className:"notif-clear-btn",onClick:_s,children:"Clear all"})]}),a.jsx("div",{className:"notif-panel-list",children:ln.length===0?a.jsx("div",{className:"notif-empty",children:"No notifications yet"}):ln.map(C=>a.jsxs("div",{className:`notif-item${C.read?"":" unread"}`,onClick:()=>{if(Ae(!1),C.type==="buddy_request"||C.type==="buddy_accept")b(g?"/client/core-buddy/buddies":"/upgrade");else if((C.type==="like"||C.type==="comment")&&C.postId){if(!Xt.has(C.postId)){const G=new Set(Xt);G.add(C.postId),ne(G),Ne[C.postId]||Vs(C.postId)}setTimeout(()=>{const G=document.getElementById(`post-${C.postId}`);G&&G.scrollIntoView({behavior:"smooth",block:"center"})},150)}else C.type==="like"||C.type==="comment"?document.querySelector(".cb-journey-section")?.scrollIntoView({behavior:"smooth"}):C.type==="mention"&&b(`/client/core-buddy/profile/${C.fromId}`)},children:[a.jsx("div",{className:"notif-item-avatar",children:C.fromPhotoURL?a.jsx("img",{src:C.fromPhotoURL,alt:""}):a.jsx("span",{children:(C.fromName||"?")[0]})}),a.jsxs("div",{className:"notif-item-body",children:[a.jsxs("p",{className:"notif-item-text",children:[a.jsx("strong",{children:C.fromName})," ",C.type==="buddy_request"&&"sent you a buddy request",C.type==="buddy_accept"&&"accepted your buddy request",C.type==="like"&&"liked your post",C.type==="comment"&&"commented on your post",C.type==="mention"&&"mentioned you"]}),a.jsx("span",{className:"notif-item-time",children:Kp(C.createdAt)})]})]},C.id))})]})]}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:()=>b("/client/core-buddy/settings"),"aria-label":"Settings",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),a.jsx("button",{onClick:i,"aria-label":"Log out",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),a.jsxs("main",{className:"cb-main",children:[a.jsxs("div",{className:"cb-ring-container",children:[a.jsxs("div",{className:"cb-ring",children:[a.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:yT.map((C,G)=>{const Ce=G<H;return a.jsx("line",{x1:C.x1,y1:C.y1,x2:C.x2,y2:C.y2,className:`ring-tick ${Ce?"elapsed":"remaining"}`,strokeWidth:C.thick?"3":"2"},G)})}),a.jsxs("div",{className:"cb-ring-center",children:[a.jsxs("div",{className:"cb-ring-logo",onClick:()=>Ee.current?.click(),role:"button",tabIndex:0,"aria-label":"Change profile photo",children:[a.jsx("img",{src:ie||"/Logo.webp",alt:ie?"Profile":"Mind Core Fitness"}),a.jsx("div",{className:`cb-photo-overlay${ke?" uploading":""}`,children:ke?a.jsx("div",{className:"cb-photo-spinner"}):a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),a.jsx("input",{ref:Ee,type:"file",accept:"image/*",onChange:Qr,style:{display:"none"}})]}),!ie&&!ke&&a.jsx("div",{className:"cb-photo-badge",onClick:()=>Ee.current?.click(),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),a.jsxs("div",{className:"cb-ring-countdown",children:[a.jsx("span",{className:"cb-timer-digit",children:String(T.hours).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit",children:String(T.minutes).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(T.seconds).padStart(2,"0")})]}),a.jsx("span",{className:"cb-ring-label",children:"remaining today"}),a.jsxs("p",{className:"cb-ring-tagline",children:[Gp[Ve].text," ",a.jsx("strong",{children:Gp[Ve].bold})]},Ve)]}),a.jsx("div",{className:"cb-stats-row",children:z.map(C=>{const G=(C.size==="large",38),Ce=2*Math.PI*G,Re=Ce-C.pct/100*Ce,Pe=C.editable;return a.jsxs("div",{className:`cb-stat-item${C.size==="large"?" cb-stat-large":""}`,children:[a.jsxs("div",{className:`cb-stat-ring${Pe?" cb-stat-tappable":""}${Pe&&Ie?" cb-stat-hint":""}`,onClick:Pe?()=>{_e(!0),ze(!1)}:void 0,children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-stat-track",cx:"50",cy:"50",r:G}),a.jsx("circle",{className:"cb-stat-fill",cx:"50",cy:"50",r:G,style:{stroke:C.color},strokeDasharray:Ce,strokeDashoffset:Re})]}),a.jsx("span",{className:"cb-stat-value",style:{color:C.color},children:C.value})]}),a.jsx("span",{className:"cb-stat-label",children:C.label})]},C.label)})}),te&&a.jsx("div",{className:"cb-target-overlay",onClick:()=>_e(!1),children:a.jsxs("div",{className:"cb-target-picker",onClick:C=>C.stopPropagation(),children:[a.jsx("h4",{children:"Weekly workout goal"}),a.jsx("p",{children:"How many sessions per week?"}),a.jsx("div",{className:"cb-target-options",children:[1,2,3,4,5,6,7].map(C=>a.jsx("button",{className:`cb-target-option${C===Be?" active":""}`,onClick:()=>xs(C),children:C},C))})]})}),a.jsxs("p",{className:"cb-coach-msg",children:[le.main," ",a.jsx("strong",{children:rr}),"  ",le.sub]}),Me&&a.jsxs("button",{className:"cb-nudge-card",onClick:Me.action||void 0,style:Me.action?void 0:{cursor:"default"},children:[a.jsxs("div",{className:"cb-nudge-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-nudge-ring-track",cx:"50",cy:"50",r:"38"}),a.jsx("circle",{className:"cb-nudge-ring-fill",cx:"50",cy:"50",r:"38",strokeDasharray:2*Math.PI*38,strokeDashoffset:2*Math.PI*38-Me.pct/100*2*Math.PI*38})]}),a.jsx("span",{className:"cb-nudge-ring-val",children:Me.ringLabel})]}),a.jsxs("div",{className:"cb-nudge-info",children:[a.jsx("span",{className:"cb-nudge-label",children:Me.label}),a.jsx("span",{className:"cb-nudge-title",children:Me.message}),Me.cta&&a.jsxs("span",{className:"cb-nudge-cta",children:[Me.cta," "]})]})]}),a.jsxs("div",{className:"cb-features",children:[g&&a.jsxs("button",{className:"cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn",onClick:C=>{wn(C),b("/client/core-buddy/nutrition")},children:[a.jsxs("div",{className:"cb-card-top-row",children:[a.jsx("div",{className:"cb-card-content",children:a.jsx("h3",{children:"Today's Nutrition"})}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsx("div",{className:"cb-card-preview-row",children:a.jsx("div",{className:"cb-mini-rings",children:[{label:"P",pct:ae("protein"),color:"var(--color-primary)"},{label:"C",pct:ae("carbs"),color:"var(--color-primary)"},{label:"F",pct:ae("fats"),color:"var(--color-primary)"},{label:"Cal",pct:ae("calories"),color:"var(--color-primary)"}].map(C=>{const Ce=2*Math.PI*38,Re=Ce-C.pct/100*Ce;return a.jsxs("div",{className:"cb-mini-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-mini-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"cb-mini-fill",cx:"50",cy:"50",r:38,style:{stroke:C.color},strokeDasharray:Ce,strokeDashoffset:Re})]}),a.jsx("span",{style:{color:C.color},children:C.label})]},C.label)})})}),a.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),a.jsxs("button",{className:"cb-feature-card cb-card-workouts-hero ripple-btn",onClick:C=>{wn(C),b("/client/core-buddy/workouts")},children:[a.jsx("h3",{className:"cb-hero-title",children:"Workout"}),a.jsxs("div",{className:"cb-hero-stats",children:[a.jsxs("span",{children:[M," this week"]}),a.jsx("span",{className:"cb-hero-dot",children:""}),a.jsxs("span",{children:[B," total"]})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"cb-feature-card cb-card-consistency ripple-btn",onClick:C=>{wn(C),b("/client/core-buddy/consistency")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Habits"}),a.jsx("div",{className:"cb-habit-dots",children:Array.from({length:E},(C,G)=>a.jsx("span",{className:`cb-habit-dot${G<V?" done":""}`},G))}),a.jsxs("span",{className:"cb-habit-dots-label",children:[V,"/",E," today"]})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"cb-feature-card cb-card-leaderboard ripple-btn",onClick:C=>{wn(C),b("/client/leaderboard")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Leaderboard"}),re.length>0?a.jsx("div",{className:"cb-lb-preview",children:re.map((C,G)=>{const Ce=["#FFD700","#A8B4C0","#CD7F32"][G],Re=C.name?C.name.split(" ").map(ht=>ht[0]).join("").slice(0,2).toUpperCase():"?",Pe=C.id===t?.id;return a.jsxs("div",{className:`cb-lb-entry${Pe?" cb-lb-me":""}`,children:[a.jsx("div",{className:"cb-lb-avatar",style:{borderColor:Ce},children:C.photoURL?a.jsx("img",{src:C.photoURL,alt:"",className:"cb-lb-avatar-img"}):a.jsx("span",{children:Re})}),a.jsxs("span",{className:"cb-lb-rank",style:{color:Ce},children:["#",G+1]})]},C.id)})}):a.jsx("p",{children:"Opt in to compete with your Core Buddies"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),g&&a.jsxs("button",{className:"cb-feature-card cb-card-buddies ripple-btn",onClick:C=>{wn(C),b("/client/core-buddy/buddies")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Buddies"}),a.jsx("p",{children:"Connect with other members and track each other's progress"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),g&&a.jsxs("div",{className:"cb-journey-section",children:[a.jsx("h3",{className:"cb-journey-title",children:"My Journey"}),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"journey-compose",children:[a.jsx("div",{className:"journey-compose-avatar",children:ie?a.jsx("img",{src:ie,alt:""}):a.jsx("span",{children:Gc(t?.name)})}),a.jsxs("div",{className:"journey-compose-body",style:{position:"relative"},children:[a.jsx("textarea",{ref:Yt,placeholder:"Share your progress... (use @ to mention)",value:ue,onChange:ma,rows:1,maxLength:500}),dn&&Cs==="compose"&&ds.length>0&&a.jsx("div",{className:"mention-dropdown",children:ds.map(C=>a.jsxs("button",{className:"mention-option",onClick:()=>as(C,"compose"),children:[a.jsx("div",{className:"mention-option-avatar",children:C.photoURL?a.jsx("img",{src:C.photoURL,alt:""}):a.jsx("span",{children:Gc(C.name)})}),a.jsx("span",{children:C.name})]},C.id))}),Je&&a.jsxs("div",{className:"journey-image-preview",children:[a.jsx("img",{src:Je,alt:"Preview"}),a.jsx("button",{className:"journey-image-remove",onClick:Ft,"aria-label":"Remove image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-compose-actions",children:[a.jsx("button",{className:"journey-image-btn",onClick:()=>Fn.current?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:Fn,type:"file",accept:"image/*",onChange:He,hidden:!0}),(ue.trim()||yt)&&a.jsx("button",{className:"journey-post-btn",onClick:Ye,disabled:vt,children:vt?a.jsx("div",{className:"journey-btn-spinner"}):"Post"})]})]})]}),ut?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"cb-spinner"})}):rt.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"Start sharing your fitness journey!"})]}):a.jsx("div",{className:"journey-list",children:rt.map(C=>a.jsxs("div",{id:`post-${C.id}`,className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:C.authorPhotoURL?a.jsx("img",{src:C.authorPhotoURL,alt:""}):a.jsx("span",{children:Gc(C.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:C.authorName}),a.jsx("span",{className:"journey-post-time",children:Kp(C.createdAt)})]}),a.jsx("button",{className:"journey-delete-btn",onClick:()=>Kn(C.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),C.type==="workout_summary"&&C.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:C.metadata.title}),C.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:C.metadata.stats.map(G=>`${G.value} ${G.label}`).join("    ")}),!C.metadata.stats?.length&&C.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:C.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed a workout using Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):C.type==="badge_earned"&&C.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame journey-card-logo-badge",children:a.jsx("img",{src:"/Logo.webp",alt:C.metadata.title,className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:C.metadata.title}),C.metadata.badgeDesc&&a.jsx("p",{className:"journey-card-stats-line",children:C.metadata.badgeDesc}),a.jsx("p",{className:"journey-card-cta",children:"I just earned a badge on Core Buddy"}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):C.type==="habits_summary"&&C.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:C.metadata.title}),C.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:C.metadata.stats.map(G=>`${G.value} ${G.label}`).join("    ")}),C.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:C.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed my daily habits with Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):a.jsxs(a.Fragment,{children:[C.content&&a.jsx("p",{className:"journey-post-content",children:zt(C.content)}),C.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:C.imageURL,alt:"Post",loading:"lazy"})})]}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${js.has(C.id)?" liked":""}`,onClick:()=>os(C.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:js.has(C.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:C.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${Xt.has(C.id)?" active":""}`,onClick:()=>Yn(C.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:C.commentCount||0})]})]}),Xt.has(C.id)&&a.jsxs("div",{className:"journey-comments",children:[Ne[C.id]?.length>0?Ne[C.id].map(G=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",children:G.authorPhotoURL?a.jsx("img",{src:G.authorPhotoURL,alt:""}):a.jsx("span",{children:Gc(G.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:G.authorName}),G.replyToName&&a.jsxs("span",{className:"journey-comment-reply-tag",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"9 14 4 9 9 4"}),a.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),G.replyToName]}),G.content&&a.jsx("span",{className:"journey-comment-text",children:zt(G.content)}),G.imageURL&&a.jsx("img",{className:"journey-comment-image",src:G.imageURL,alt:"Comment",loading:"lazy"})]}),a.jsxs("div",{className:"journey-comment-actions-row",children:[a.jsx("span",{className:"journey-comment-time",children:Kp(G.createdAt)}),a.jsx("button",{className:"journey-comment-reply-btn",onClick:()=>sn(Ce=>({...Ce,[C.id]:{id:G.id,authorName:G.authorName}})),children:"Reply"}),a.jsx("button",{className:"journey-comment-delete-btn",onClick:()=>fa(C.id,G.id),"aria-label":"Delete comment",children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},G.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),Fe[C.id]&&a.jsxs("div",{className:"journey-comment-replying",children:[a.jsxs("span",{children:["Replying to ",a.jsx("strong",{children:Fe[C.id].authorName})]}),a.jsx("button",{onClick:()=>sn(G=>({...G,[C.id]:null})),"aria-label":"Cancel reply",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),zn[C.id]&&a.jsxs("div",{className:"journey-comment-img-preview",children:[a.jsx("img",{src:zn[C.id],alt:"Preview"}),a.jsx("button",{onClick:()=>Mr(C.id),"aria-label":"Remove image",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("button",{className:"journey-comment-img-btn",onClick:()=>Cn.current[C.id]?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:G=>{Cn.current[C.id]=G},type:"file",accept:"image/*",onChange:G=>Di(C.id,G),hidden:!0}),a.jsx("input",{type:"text",placeholder:"Comment",value:bt[C.id]||"",onChange:G=>Lr(C.id,G.target.value),onKeyDown:G=>{G.key==="Enter"&&vr(C.id)},maxLength:300}),dn&&Cs===C.id&&ds.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:ds.map(G=>a.jsxs("button",{className:"mention-option",onClick:()=>as(G,C.id),children:[a.jsx("div",{className:"mention-option-avatar",children:G.photoURL?a.jsx("img",{src:G.photoURL,alt:""}):a.jsx("span",{children:Gc(G.name)})}),a.jsx("span",{children:G.name})]},G.id))}),a.jsx("button",{onClick:()=>vr(C.id),disabled:!(bt[C.id]||"").trim()&&!on[C.id]||$e[C.id],children:$e[C.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},C.id))})]})]}),!g&&a.jsxs("button",{className:"cb-upgrade-cta",onClick:()=>b("/upgrade"),children:[a.jsx("span",{className:"cb-upgrade-cta-text",children:"Unlock the full experience"}),a.jsx("span",{className:"cb-upgrade-cta-sub",children:"Unlimited workout times, nutrition, buddies & more"}),a.jsxs("svg",{className:"cb-upgrade-cta-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]})]})]}),a.jsx(Ri,{active:"home"}),jn&&a.jsxs("div",{className:`toast-notification ${jn.type}`,children:[jn.type==="info"&&a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),jn.message]}),a.jsx(e3,{steps:Ir,active:Ar,onFinish:Dr})]})})}const Yp=new Map;function ni(){return new Date().toISOString().split("T")[0]}const zw=[{key:"breakfast",label:"Breakfast"},{key:"lunch",label:"Lunch"},{key:"dinner",label:"Dinner"},{key:"snacks",label:"Snacks"}],r3={breakfast:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),a.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),a.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),a.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),a.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),lunch:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),dinner:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),snacks:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})};function i3(){const s=new Date().getHours();return s<11?"breakfast":s<14?"lunch":s<17?"snacks":"dinner"}function a3(){const{currentUser:s,isClient:e,clientData:t,loading:i}=hi(),{isDark:l,toggleTheme:u,accent:h}=ao(),p=gr(),[g,y]=_.useState("loading"),[b,E]=_.useState(null),[T,O]=_.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",dailyActivity:"sedentary",trainingFrequency:"moderate",goal:"maintain",deficitLevel:"moderate"}),[H,q]=_.useState(null),[B,X]=_.useState(ni()),[W,Y]=_.useState({entries:[]}),[de,xe]=_.useState({protein:0,carbs:0,fats:0,calories:0}),[ve,j]=_.useState(!1),[S,I]=_.useState(()=>{const R=new Date;return{year:R.getFullYear(),month:R.getMonth()}}),[V,D]=_.useState(!1),[M,A]=_.useState(()=>{const R=new Date;return{year:R.getFullYear(),month:R.getMonth()}}),[Be,Ze]=_.useState(!1),[te,_e]=_.useState(i3),[Ie,ze]=_.useState(null),[re,L]=_.useState(null),[ie,we]=_.useState(!1),[ke,Te]=_.useState(null),[Ee,Ke]=_.useState(""),[ct,Ve]=_.useState(!1),[tn,jn]=_.useState(""),[Un,Lt]=_.useState([]),[rt,gt]=_.useState(!1),[ut,Bn]=_.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[ue,Rt]=_.useState(null),[yt,Vt]=_.useState("100"),[Je,At]=_.useState(0),[vt,nn]=_.useState("weight"),[js,rs]=_.useState(0),[Xt,ne]=_.useState(null);_.useRef(null);const Ne=_.useRef(!1),xt=_.useRef(null),bt=_.useRef(null),it=_.useRef(null),$e=_.useCallback((R,z="info")=>{ne({message:R,type:z}),setTimeout(()=>ne(null),3e3)},[]);_.useEffect(()=>{!i&&(!s||!e)&&p("/")},[s,e,i,p]),_.useEffect(()=>{if(!t?.id)return;(async()=>{try{const z=await mr(tt(Se,"nutritionTargets",t.id));z.exists()?(E(z.data()),y("dashboard")):y("setup")}catch(z){console.error("Error loading nutrition data:",z),y("setup")}})()},[t?.id]),_.useEffect(()=>{if(!t?.id)return;(async()=>{try{const z=await mr(tt(Se,"nutritionLogs",`${t.id}_${B}`));if(z.exists()){const ae=z.data();Y({entries:ae.entries||[]})}else Y({entries:[]})}catch(z){console.error("Error loading log:",z),Y({entries:[]})}})()},[t?.id,B]),_.useEffect(()=>{const R=W.entries.reduce((z,ae)=>({protein:z.protein+(ae.protein||0),carbs:z.carbs+(ae.carbs||0),fats:z.fats+(ae.fats||0),calories:z.calories+(ae.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});xe(R)},[W.entries]);const st=async R=>{try{await Os(tt(Se,"nutritionLogs",`${t.id}_${B}`),{clientId:t.id,date:B,entries:R.entries,updatedAt:Gt.now()})}catch(z){console.error("Error saving nutrition log:",z)}},Fe=B===ni(),sn=(R,z)=>new Date(R,z+1,0).getDate(),on=(R,z)=>new Date(R,z,1).getDay(),Ln=R=>{if(R===ni())return"Today";const z=new Date(R+"T12:00:00"),ae=new Date;return ae.setDate(ae.getDate()-1),R===ae.toISOString().split("T")[0]?"Yesterday":z.toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short"})},zn=["January","February","March","April","May","June","July","August","September","October","November","December"],Xn=["Su","Mo","Tu","We","Th","Fr","Sa"],Yt=()=>{let R=parseFloat(T.weight);T.weightUnit==="lbs"&&(R*=.453592);let z;T.heightUnit==="cm"?z=parseFloat(T.height):z=(parseFloat(T.heightFeet)||0)*30.48+(parseFloat(T.heightInches)||0)*2.54;const ae=parseInt(T.age);let le=T.gender==="male"?10*R+6.25*z-5*ae+5:10*R+6.25*z-5*ae-161;const Le=le*{sedentary:1.2,light:1.3,moderate:1.4,active:1.5}[T.dailyActivity],He={low:100,moderate:200,high:300,daily:400},Ft=Math.round(Le+He[T.trainingFrequency]);let Ye=Ft,Kn,os;switch(T.goal){case"lose":Ye=Ft*(1-{light:.15,moderate:.2,harsh:.25}[T.deficitLevel]),Kn=2.2,os=.3;break;case"build":Ye=Ft*1.1,Kn=2,os=.22;break;default:Kn=1.8,os=.25}Ye=Math.max(Ye,T.gender==="male"?1400:1100);const Vs=Math.round(R*Kn),Yn=Math.round(Ye*os/9),vr=Math.max(0,Math.round((Ye-Vs*4-Yn*9)/4));q({calories:Math.round(Ye),protein:Vs,carbs:vr,fats:Yn,bmr:Math.round(le),neat:Math.round(Le),exerciseAdd:He[T.trainingFrequency],tdee:Math.round(Ft)})},Fn=async()=>{if(H)try{const R={clientId:t.id,calories:H.calories,protein:H.protein,carbs:H.carbs,fats:H.fats,goal:T.goal,updatedAt:Gt.now()};await Os(tt(Se,"nutritionTargets",t.id),R),E(R),y("dashboard"),$e("Macro targets saved!","success")}catch(R){console.error("Error saving targets:",R),$e("Failed to save targets. Please try again.","error")}},Cn=()=>{const R=T.weight&&parseFloat(T.weight)>0,z=T.age&&parseInt(T.age)>0,ae=T.heightUnit==="cm"?T.height&&parseFloat(T.height)>0:T.heightFeet&&parseFloat(T.heightFeet)>0||T.heightInches&&parseFloat(T.heightInches)>0;return R&&z&&ae},ln="nut_favourite_foods",yr=()=>{try{return JSON.parse(localStorage.getItem(ln)||"[]")}catch{return[]}};_.useEffect(()=>{if(!t?.id)return;(async()=>{try{const z=await mr(tt(Se,"favouriteFoods",t.id));if(z.exists()){const ae=z.data().items||[];localStorage.setItem(ln,JSON.stringify(ae)),rs(le=>le+1)}else{const ae=yr();ae.length>0&&await Os(tt(Se,"favouriteFoods",t.id),{items:ae,updatedAt:Gt.now()})}}catch(z){console.error("Error loading favourites:",z)}})()},[t?.id]);const oe=R=>yr().some(z=>z.name.toLowerCase()===(R||"").toLowerCase()),Ae=R=>{const z=yr(),ae=z.findIndex(le=>le.name.toLowerCase()===R.name.toLowerCase());ae>=0?z.splice(ae,1):z.unshift({name:R.name,protein:R.protein,carbs:R.carbs,fats:R.fats,calories:R.calories,serving:R.serving,per100g:R.per100g||null,servingUnit:R.servingUnit||"g",portion:R.portion||null}),localStorage.setItem(ln,JSON.stringify(z)),t?.id&&Os(tt(Se,"favouriteFoods",t.id),{items:z,updatedAt:Gt.now()}).catch(le=>console.error("Error saving favourites:",le)),rs(le=>le+1)},Ge=R=>{const z=[...W.entries,{...R,meal:te,id:Date.now(),addedAt:new Date().toISOString()}],ae={...W,entries:z};Y(ae),st(ae),L(null),Rt(null),Vt("100"),At(0),nn("weight"),Bn({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),$e("Food added!","success")},mt=R=>{const z=W.entries.filter(le=>le.id!==R),ae={...W,entries:z};Y(ae),st(ae)},lt=async R=>{if(!(!t?.id||R===B)){Ze(!0);try{const z=await mr(tt(Se,"nutritionLogs",`${t.id}_${R}`));if(!z.exists()||!z.data().entries?.length){$e("No food logged on that day","error");return}const ae=z.data().entries.map(Le=>({...Le,id:Date.now()+Math.random(),addedAt:new Date().toISOString()})),le=[...W.entries,...ae],Me={...W,entries:le};Y(Me),st(Me),D(!1),$e(`Copied ${ae.length} items from ${Ln(R)}`,"success")}catch(z){console.error("Error copying day:",z),$e("Failed to copy day","error")}finally{Ze(!1)}}},vn=_.useRef(null),Nn=_.useRef([]),dn=3,bn=5,Cs=async()=>{we(!0);const R=document.querySelector("#barcode-reader");if(!R){we(!1),$e("Scanner container not found.","error");return}if(!vn.current)try{const ae=await Gs(()=>import("./quagga.min-BbicSfvA.js").then(le=>le.q),[]);vn.current=ae.default}catch(ae){console.error("Failed to load barcode scanner:",ae),we(!1),$e("Could not load scanner.","error");return}const z=vn.current;z.init({inputStream:{type:"LiveStream",target:R,constraints:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader","ean_8_reader","upc_reader","upc_e_reader","code_128_reader","code_39_reader"]},locate:!0},ae=>{if(ae){console.error("Quagga init error:",ae),we(!1),$e("Could not access camera. Check permissions.","error");return}z.start(),Ne.current=!0}),Nn.current=[],z.onDetected(ae=>{const le=ae.codeResult.decodedCodes?.filter(Le=>Le.error!==void 0)?.map(Le=>Le.error)||[];if((le.length>0?le.reduce((Le,He)=>Le+He,0)/le.length:1)<.15){const Le=ae.codeResult.code,He=Nn.current;He.push(Le),He.length>bn&&He.shift(),He.filter(Ye=>Ye===Le).length>=dn&&(z.offDetected(),Nn.current=[],Te(Le))}})},is=()=>{const R=vn.current;Ne.current&&R&&(R.stop(),R.offDetected(),Ne.current=!1),we(!1)},ds=/\b(milk|semi.skimmed|skimmed|whole milk|oat milk|almond milk|soy milk|juice|smoothie|water|squash|cordial|cola|pepsi|fanta|lemonade|soda|beer|wine|cider|lager|spirit|whisky|vodka|rum|gin|brandy|cream|yoghurt drink|milkshake|coffee|tea|broth|stock|soup|sauce|ketchup|vinegar|oil|syrup|honey|custard|coconut water|kombucha|energy drink|protein shake)\b/i,Jt=R=>/ml|cl|\dl(?!b)|litre|liter|fl\s?oz/i.test((R||"").replace(/\s/g,"")),An=R=>{if(!R)return{value:100,unit:"g"};const z=R.toLowerCase().replace(/\s/g,""),ae=z.match(/([\d.]+)/),le=ae?parseFloat(ae[1]):100;return Jt(R)?/cl/.test(z)?{value:le*10,unit:"ml"}:/(?:^|\d)l(?!i)/.test(z)&&!/ml/.test(z)?{value:le*1e3,unit:"ml"}:{value:le,unit:"ml"}:{value:le,unit:"g"}},Ns=R=>{if(Jt(R.serving_size)||Jt(R.quantity))return"ml";const z=R.product_name||R.product_name_en||"";return ds.test(z)?"ml":"g"},Ar=[{pattern:/\b(toast|bread|loaf|brioche|bagel|pitta|wrap|tortilla|crumpet|muffin|waffle|pancake)\b/i,label:"slice",weight:36},{pattern:/\begg\b/i,label:"egg",weight:60},{pattern:/\b(biscuit|cookie|digestive|hobnob|rich tea|oreo)\b/i,label:"biscuit",weight:13},{pattern:/\b(sausage|banger)\b/i,label:"sausage",weight:57},{pattern:/\b(rasher|bacon)\b/i,label:"rasher",weight:25},{pattern:/\b(rice cake)\b/i,label:"cake",weight:9},{pattern:/\b(cracker|ryvita)\b/i,label:"cracker",weight:10}],di=(R,z)=>{const ae=R||"",le=ae.match(/\((\d+\.?\d*)\s*g\)/i),Me=ae.match(/(?:^|per\s+)(\d*\s*[a-z][a-z\s]*?)(?:\s*\(|\s*-\s*|\s*$)/i);if(le&&Me){const Ft=parseFloat(le[1]);let Ye=Me[1].replace(/^\d+\s*/,"").trim();if(Ye&&Ft>0)return{label:Ye,weight:Ft}}const Le=ae.match(/(\d+\.?\d*)\s*g\s*[\/=]\s*(\d*\s*[a-z][a-z\s]*)/i);if(Le){const Ft=parseFloat(Le[1]);let Ye=Le[2].replace(/^\d+\s*/,"").trim();if(Ye&&Ft>0)return{label:Ye,weight:Ft}}const He=z||"";for(const{pattern:Ft,label:Ye,weight:Kn}of Ar)if(Ft.test(He))return{label:Ye,weight:Kn};return null},Rr=R=>{const z=R.nutriments||{},ae=Ns(R),le=An(R.serving_size),Me=ae==="ml"?le.unit==="ml"?le.value:100:le.value,Le=R.product_name||R.product_name_en||"Unknown Product",He=di(R.serving_size,Le);return{name:Le,brand:R.brands||"",image:R.image_small_url||R.image_url||null,servingSize:R.serving_size||"100g",servingValue:Me,servingUnit:ae,portion:He,protein:Math.round(z.proteins_100g||z.proteins||0),carbs:Math.round(z.carbohydrates_100g||z.carbohydrates||0),fats:Math.round(z.fat_100g||z.fat||0),calories:Math.round(z["energy-kcal_100g"]||z["energy-kcal"]||(z.energy_100g?z.energy_100g/4.184:0)),per100g:!0}},Ir=async R=>{Ve(!0);try{const z=`https://world.openfoodfacts.org/api/v2/product/${R}?fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,ae=await fetch(z);if(!ae.ok)throw new Error(`HTTP ${ae.status}`);const le=await ae.json();if(le.status==="success"||le.status===1||le.product){const Me=Rr(le.product);Me.calories===0&&Me.protein===0&&Me.carbs===0?$e("Product found but no nutrition data available.","error"):(Rt(Me),Me.portion?(At(1),Vt(String(Me.portion.weight)),nn("portion")):(At(0),Vt(String(Me.servingValue||100)),nn("weight")),Ke(""))}else $e("Product not found. Try search or manual entry.","error")}catch(z){console.error("Barcode lookup error:",z),$e("Failed to look up product. Check your connection.","error")}Ve(!1)},qn=(R,z,ae)=>{const le=R.toLowerCase().trim(),Me=z.toLowerCase().trim(),Le=ae.toLowerCase().trim();let He=0;return(le===Le||le===Le+"s"||le+"s"===Le)&&(He+=100),(le.endsWith(" "+Le)||le.endsWith(" "+Le+"s"))&&(He+=40),(le.startsWith(Le+" ")||le.startsWith(Le+"s "))&&(He+=15),Le.split(/\s+/).some(Ye=>Me===Ye||Me.startsWith(Ye))&&(He+=30),He+=Math.max(0,30-le.length),He},Ks=async()=>{if(!tn.trim())return;xt.current&&xt.current.abort();const R=new AbortController;xt.current=R;const z=tn.trim().toLowerCase(),ae=z.split(/\s+/).filter(Boolean);if(Yp.has(z)){Lt(Yp.get(z));return}gt(!0);try{const Me=`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(tn.trim())}&search_simple=1&action=process&json=1&page_size=10&lc=en&sort_by=unique_scans_n&fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,Le=await fetch(Me,{signal:R.signal});if(!Le.ok)throw new Error(`HTTP ${Le.status}`);const Ft=((await Le.json()).products||[]).map(Ye=>Rr(Ye)).filter(Ye=>Ye.name!=="Unknown Product"&&(Ye.calories>0||Ye.protein>0)).filter(Ye=>{const Kn=(Ye.name+" "+Ye.brand).toLowerCase();return ae.every(os=>Kn.includes(os))}).sort((Ye,Kn)=>qn(Kn.name,Kn.brand,z)-qn(Ye.name,Ye.brand,z)).slice(0,10);Yp.set(z,Ft),Lt(Ft),Ft.length===0&&$e("No results found. Try a different search.","info")}catch(le){if(le.name==="AbortError")return;console.error("Search error:",le),$e("Search failed. Check your connection.","error")}gt(!1)};_.useEffect(()=>{if(bt.current&&clearTimeout(bt.current),!(!tn.trim()||re!=="search"||ue))return bt.current=setTimeout(()=>{Ks()},700),()=>clearTimeout(bt.current)},[tn]);const _s=l,kn={"ring-protein":_s?"#2dd4bf":"#14b8a6","ring-carbs":_s?"#fbbf24":"#f59e0b","ring-fats":_s?"#a78bfa":"#8b5cf6","ring-cals":"var(--color-primary)"},On=80,as=2*Math.PI*On,zt=(R,z,ae,le,Me)=>{const Le=le>0?Math.min(100,Math.round(ae/le*100)):0,He=as-Le/100*as,Ft=kn[Me]||"#14b8a6";return a.jsxs("div",{className:"nut-ring-wrap",children:[a.jsxs("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"nut-arc-track",cx:"100",cy:"100",r:On}),a.jsx("circle",{className:"nut-arc-fill",cx:"100",cy:"100",r:On,style:{stroke:Ft},strokeDasharray:as,strokeDashoffset:He})]}),a.jsxs("div",{className:"nut-ring-center",children:[a.jsx("span",{className:"nut-ring-value",style:{color:Ft},children:Math.round(ae)}),a.jsxs("span",{className:"nut-ring-target",children:["/ ",le,R==="Calories"?"":"g"]}),a.jsx("span",{className:"nut-ring-label",style:{color:Ft},children:z})]}),a.jsxs("span",{className:"nut-ring-pct",style:{color:Ft},children:[Le,"%"]})]})};if(_.useEffect(()=>{if(!ke)return;const R=setTimeout(()=>{const z=ke;is(),Te(null),Ir(z)},1500);return()=>clearTimeout(R)},[ke]),_.useEffect(()=>()=>{const R=vn.current;if(Ne.current&&R){try{R.stop(),R.offDetected()}catch{}Ne.current=!1}},[]),i||g==="loading")return a.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"nut-loading-inline",children:a.jsx("div",{className:"cb-loading-spinner"})})]});if(g==="setup")return a.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"nut-main",children:[a.jsxs("div",{className:"nut-setup-intro",children:[a.jsx("h2",{children:"Set Your Daily Targets"}),a.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),a.jsxs("div",{className:"nut-calc-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Gender"}),a.jsxs("div",{className:"nut-toggle-group",children:[a.jsx("button",{className:T.gender==="male"?"active":"",onClick:()=>{O(R=>({...R,gender:"male"})),q(null)},children:"Male"}),a.jsx("button",{className:T.gender==="female"?"active":"",onClick:()=>{O(R=>({...R,gender:"female"})),q(null)},children:"Female"})]})]}),a.jsxs("div",{className:"nut-form-row",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Age"}),a.jsx("input",{type:"number",value:T.age,onChange:R=>{O(z=>({...z,age:R.target.value})),q(null)},placeholder:"Years",min:"15",max:"100"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Weight"}),a.jsxs("div",{className:"nut-input-unit",children:[a.jsx("input",{type:"number",value:T.weight,onChange:R=>{O(z=>({...z,weight:R.target.value})),q(null)},placeholder:T.weightUnit,min:"30",max:"300"}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:T.weightUnit==="kg"?"active":"",onClick:()=>{O(R=>({...R,weightUnit:"kg"})),q(null)},children:"kg"}),a.jsx("button",{className:T.weightUnit==="lbs"?"active":"",onClick:()=>{O(R=>({...R,weightUnit:"lbs"})),q(null)},children:"lbs"})]})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Height"}),a.jsxs("div",{className:"nut-input-unit",children:[T.heightUnit==="cm"?a.jsx("input",{type:"number",value:T.height,onChange:R=>{O(z=>({...z,height:R.target.value})),q(null)},placeholder:"cm",min:"100",max:"250"}):a.jsxs("div",{className:"nut-height-imperial",children:[a.jsx("input",{type:"number",value:T.heightFeet,onChange:R=>{O(z=>({...z,heightFeet:R.target.value})),q(null)},placeholder:"ft",min:"4",max:"7"}),a.jsx("input",{type:"number",value:T.heightInches,onChange:R=>{O(z=>({...z,heightInches:R.target.value})),q(null)},placeholder:"in",min:"0",max:"11"})]}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:T.heightUnit==="cm"?"active":"",onClick:()=>{O(R=>({...R,heightUnit:"cm"})),q(null)},children:"cm"}),a.jsx("button",{className:T.heightUnit==="ft"?"active":"",onClick:()=>{O(R=>({...R,heightUnit:"ft"})),q(null)},children:"ft/in"})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Daily Activity (outside of training)"}),a.jsxs("select",{value:T.dailyActivity,onChange:R=>{O(z=>({...z,dailyActivity:R.target.value})),q(null)},children:[a.jsx("option",{value:"sedentary",children:"Sedentary  desk job, under 5k steps"}),a.jsx("option",{value:"light",children:"Lightly Active  office + walking, 5-8k steps"}),a.jsx("option",{value:"moderate",children:"Moderately Active  on feet often, 8-12k steps"}),a.jsx("option",{value:"active",children:"Very Active  physical job, 12k+ steps"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Training Sessions per Week"}),a.jsxs("select",{value:T.trainingFrequency,onChange:R=>{O(z=>({...z,trainingFrequency:R.target.value})),q(null)},children:[a.jsx("option",{value:"low",children:"1-2 sessions"}),a.jsx("option",{value:"moderate",children:"3-4 sessions"}),a.jsx("option",{value:"high",children:"5-6 sessions"}),a.jsx("option",{value:"daily",children:"7+ sessions"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fitness Goal"}),a.jsxs("div",{className:"nut-goal-options",children:[a.jsxs("button",{className:T.goal==="lose"?"active":"",onClick:()=>{O(R=>({...R,goal:"lose"})),q(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"-"}),a.jsx("span",{children:"Lose Weight"})]}),a.jsxs("button",{className:T.goal==="maintain"?"active":"",onClick:()=>{O(R=>({...R,goal:"maintain"})),q(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"="}),a.jsx("span",{children:"Maintain"})]}),a.jsxs("button",{className:T.goal==="build"?"active":"",onClick:()=>{O(R=>({...R,goal:"build"})),q(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"+"}),a.jsx("span",{children:"Build Muscle"})]})]})]}),T.goal==="lose"&&a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Deficit Level"}),a.jsxs("div",{className:"nut-deficit-options",children:[a.jsxs("button",{className:T.deficitLevel==="light"?"active":"",onClick:()=>{O(R=>({...R,deficitLevel:"light"})),q(null)},children:[a.jsx("strong",{children:"Mild"}),a.jsx("span",{children:"15% below TDEE"})]}),a.jsxs("button",{className:T.deficitLevel==="moderate"?"active":"",onClick:()=>{O(R=>({...R,deficitLevel:"moderate"})),q(null)},children:[a.jsx("strong",{children:"Moderate"}),a.jsx("span",{children:"20% below TDEE"})]}),a.jsxs("button",{className:T.deficitLevel==="harsh"?"active":"",onClick:()=>{O(R=>({...R,deficitLevel:"harsh"})),q(null)},children:[a.jsx("strong",{children:"Aggressive"}),a.jsx("span",{children:"25% below TDEE"})]})]})]}),a.jsx("button",{className:"nut-calc-btn",onClick:Yt,disabled:!Cn(),children:"Calculate Macros"})]}),H&&a.jsxs("div",{className:"nut-calc-results",children:[a.jsx("h3",{children:"Your Daily Targets"}),a.jsxs("div",{className:"nut-calc-rings",children:[zt("Protein","Protein",H.protein,H.protein,"ring-protein"),zt("Carbs","Carbs",H.carbs,H.carbs,"ring-carbs"),zt("Fats","Fats",H.fats,H.fats,"ring-fats"),zt("Calories","Calories",H.calories,H.calories,"ring-cals")]}),a.jsxs("div",{className:"nut-calc-info",children:[a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"BMR (body at rest)"}),a.jsxs("span",{children:[H.bmr," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Daily activity (NEAT)"}),a.jsxs("span",{children:[H.neat," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Training sessions"}),a.jsxs("span",{children:["+",H.exerciseAdd," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",style:{fontWeight:600},children:[a.jsx("span",{children:"TDEE (total burn)"}),a.jsxs("span",{children:[H.tdee," cal"]})]})]}),a.jsx("button",{className:"nut-save-targets-btn",onClick:Fn,children:"Set as My Daily Targets"})]})]}),Xt&&a.jsx("div",{className:`toast-notification ${Xt.type}`,children:Xt.message})]});const Qr=R=>{const z=new Date(R+"T12:00:00"),ae=z.getDay(),le=new Date(z);le.setDate(z.getDate()-(ae+6)%7);const Me=[];for(let Le=0;Le<7;Le++){const He=new Date(le);He.setDate(le.getDate()+Le),Me.push(He.toISOString().split("T")[0])}return Me},Dr=["M","T","W","T","F","S","S"],xs=(R,z="search")=>{_e(R),z==="scan"?(L("scan"),Rt(null)):z==="manual"?(L("manual"),Bn({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})):z==="favourites"?L("favourites"):(L("search"),Lt([]),jn(""))},wn=Qr(B),rr=new Date(B+"T12:00:00"),fi=`${zn[rr.getMonth()]} ${rr.getFullYear()}`;return a.jsx(Xo,{children:a.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsxs("div",{className:"nut-dark-zone",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:()=>{y("setup"),q(null)},"aria-label":"Recalculate macros",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]})}),a.jsxs("div",{className:"nut-dark-content",children:[a.jsxs("div",{className:"nut-week-strip anim-fade-up",children:[a.jsxs("div",{className:"nut-week-header",children:[a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const R=new Date(B+"T12:00:00");R.setDate(R.getDate()-7);const z=R.toISOString().split("T")[0];X(z)},"aria-label":"Previous week",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsx("button",{className:"nut-week-month-label",onClick:()=>{j(!ve),I({year:rr.getFullYear(),month:rr.getMonth()})},children:fi}),a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const R=new Date(B+"T12:00:00");R.setDate(R.getDate()+7);const z=R.toISOString().split("T")[0];z<=ni()&&X(z)},"aria-label":"Next week",disabled:wn[6]>=ni(),children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-week-days",children:wn.map((R,z)=>{const ae=new Date(R+"T12:00:00").getDate(),le=R===B,Me=R>ni(),Le=R===ni();return a.jsxs("button",{className:`nut-week-day${le?" selected":""}${Le?" today":""}${Me?" future":""}`,disabled:Me,onClick:()=>X(R),children:[a.jsx("span",{className:"nut-week-day-letter",children:Dr[z]}),a.jsx("span",{className:"nut-week-day-num",children:ae})]},R)})})]}),ve&&a.jsxs("div",{className:"nut-calendar nut-calendar-dark",children:[a.jsxs("div",{className:"nut-cal-header",children:[a.jsx("button",{onClick:()=>I(R=>{let z=R.month-1,ae=R.year;return z<0&&(z=11,ae--),{year:ae,month:z}}),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsxs("span",{children:[zn[S.month]," ",S.year]}),a.jsx("button",{onClick:()=>I(R=>{let z=R.month+1,ae=R.year;return z>11&&(z=0,ae++),{year:ae,month:z}}),disabled:S.year===new Date().getFullYear()&&S.month>=new Date().getMonth(),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-cal-days-header",children:Xn.map(R=>a.jsx("span",{children:R},R))}),a.jsxs("div",{className:"nut-cal-grid",children:[[...Array(on(S.year,S.month))].map((R,z)=>a.jsx("span",{},`e${z}`)),[...Array(sn(S.year,S.month))].map((R,z)=>{const ae=z+1,le=`${S.year}-${String(S.month+1).padStart(2,"0")}-${String(ae).padStart(2,"0")}`,Me=le>ni(),Le=le===B,He=le===ni();return a.jsx("button",{className:`nut-cal-day${Le?" selected":""}${He?" today":""}${Me?" future":""}`,disabled:Me,onClick:()=>{X(le),j(!1)},children:ae},ae)})]})]}),a.jsxs("div",{className:"nut-rings-row anim-fade-up-d2",children:[zt("Protein","Protein",de.protein,b.protein,"ring-protein"),zt("Carbs","Carbs",de.carbs,b.carbs,"ring-carbs"),zt("Fats","Fats",de.fats,b.fats,"ring-fats"),zt("Calories","kCal",de.calories,b.calories,"ring-cals")]})]})]}),a.jsx("div",{className:"nut-light-zone anim-fade-up-d4",children:a.jsxs("div",{className:"nut-light-content",children:[Fe&&a.jsx("div",{className:"nut-quick-row",children:a.jsxs("button",{className:"nut-copy-day-btn",onClick:()=>{D(!0),A({year:new Date().getFullYear(),month:new Date().getMonth()})},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",width:"18",height:"18",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),a.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),a.jsx("span",{children:"Copy day"})]})}),a.jsx("div",{className:"nut-log-section",children:a.jsx("div",{className:"nut-meals-list",children:zw.map(R=>{const z=W.entries.filter(le=>(le.meal||"snacks")===R.key),ae=z.reduce((le,Me)=>({protein:le.protein+(Me.protein||0),carbs:le.carbs+(Me.carbs||0),fats:le.fats+(Me.fats||0),calories:le.calories+(Me.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});return a.jsxs("div",{className:"nut-meal-card",children:[a.jsxs("div",{className:"nut-meal-card-header",children:[a.jsx("span",{className:`nut-meal-card-icon nut-meal-icon-${R.key}`,children:r3[R.key]}),a.jsx("span",{className:"nut-meal-card-title",children:R.label}),z.length>0&&a.jsxs("span",{className:"nut-meal-card-cal",children:[ae.calories," cal"]}),Fe&&a.jsx("button",{className:"nut-meal-add-btn",onClick:()=>ze(Ie===R.key?null:R.key),"aria-label":`Add to ${R.label}`,children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),z.length>0&&a.jsxs("div",{className:"nut-meal-bars",children:[a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-p",children:"P"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-protein",style:{width:`${Math.min(100,b.protein>0?ae.protein/b.protein*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[ae.protein,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-c",children:"C"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-carbs",style:{width:`${Math.min(100,b.carbs>0?ae.carbs/b.carbs*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[ae.carbs,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-f",children:"F"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-fats",style:{width:`${Math.min(100,b.fats>0?ae.fats/b.fats*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[ae.fats,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-cal",children:"K"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-cals",style:{width:`${Math.min(100,b.calories>0?ae.calories/b.calories*100:0)}%`}})}),a.jsx("span",{className:"nut-meal-bar-val",children:ae.calories})]})]}),z.length>0&&a.jsx("div",{className:"nut-log-list",children:z.map(le=>a.jsxs("div",{className:"nut-log-item",children:[a.jsx("button",{className:`nut-fav-star log${oe(le.name)?" active":""}`,onClick:()=>Ae(le),"aria-label":oe(le.name)?"Remove from favourites":"Add to favourites",children:a.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:oe(le.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("div",{className:"nut-log-item-info",children:[a.jsx("span",{className:"nut-log-item-name",children:le.name}),le.serving&&a.jsx("span",{className:"nut-log-item-serving",children:le.serving})]}),a.jsxs("div",{className:"nut-log-item-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[le.protein,"p"]}),a.jsxs("span",{className:"nut-macro-c",children:[le.carbs,"c"]}),a.jsxs("span",{className:"nut-macro-f",children:[le.fats,"f"]}),a.jsx("span",{className:"nut-macro-cal",children:le.calories})]}),Fe&&a.jsx("button",{className:"nut-log-delete",onClick:()=>mt(le.id),"aria-label":"Remove",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},le.id))}),z.length===0&&a.jsx("div",{className:"nut-meal-empty",children:a.jsx("p",{children:Fe?"Tap + to add food":"No entries"})})]},R.key)})})})]})}),Ie&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"nut-add-picker-backdrop",onClick:()=>ze(null)}),a.jsxs("div",{className:"nut-add-picker",children:[a.jsx("div",{className:"nut-add-picker-handle"}),a.jsxs("h3",{className:"nut-add-picker-title",children:["Add to ",zw.find(R=>R.key===Ie)?.label]}),a.jsxs("div",{className:"nut-add-picker-options",children:[a.jsxs("button",{onClick:()=>{const R=Ie;ze(null),xs(R,"scan")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),a.jsx("span",{children:"Scan Barcode"})]}),a.jsxs("button",{onClick:()=>{const R=Ie;ze(null),xs(R,"search")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Search Food"})]}),a.jsxs("button",{onClick:()=>{const R=Ie;ze(null),xs(R,"manual")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),a.jsx("span",{children:"Manual Entry"})]}),a.jsxs("button",{onClick:()=>{const R=Ie;ze(null),xs(R,"favourites")},children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),a.jsx("span",{children:"Favourites"})]})]})]})]}),V&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>D(!1),children:a.jsxs("div",{className:"nut-copy-from-popup",onClick:R=>R.stopPropagation(),children:[a.jsxs("div",{className:"nut-copy-from-header",children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",width:"20",height:"20",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),a.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),a.jsx("span",{children:"Copy from..."}),a.jsx("button",{className:"nut-modal-close",onClick:()=>D(!1),children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsx("p",{className:"nut-copy-from-hint",children:"Pick a day to copy its food log into today"}),a.jsxs("div",{className:"nut-cal-header",children:[a.jsx("button",{onClick:()=>A(R=>{let z=R.month-1,ae=R.year;return z<0&&(z=11,ae--),{year:ae,month:z}}),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsxs("span",{children:[zn[M.month]," ",M.year]}),a.jsx("button",{onClick:()=>A(R=>{let z=R.month+1,ae=R.year;return z>11&&(z=0,ae++),{year:ae,month:z}}),disabled:M.year===new Date().getFullYear()&&M.month>=new Date().getMonth(),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-cal-days-header",children:Xn.map(R=>a.jsx("span",{children:R},R))}),a.jsxs("div",{className:"nut-cal-grid",children:[[...Array(on(M.year,M.month))].map((R,z)=>a.jsx("span",{},`e${z}`)),[...Array(sn(M.year,M.month))].map((R,z)=>{const ae=z+1,le=`${M.year}-${String(M.month+1).padStart(2,"0")}-${String(ae).padStart(2,"0")}`,Me=le>ni(),Le=le===B,He=le===ni(),Ft=Me||Le;return a.jsx("button",{className:`nut-cal-day${Le?" selected":""}${He?" today":""}${Me?" future":""}`,disabled:Ft,onClick:()=>lt(le),children:ae},ae)})]}),Be&&a.jsxs("div",{className:"nut-copy-from-loading",children:[a.jsx("div",{className:"wk-loading-spinner"}),a.jsx("span",{children:"Copying..."})]})]})}),re&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>{is(),Te(null),L(null),Rt(null)},children:a.jsxs("div",{className:"nut-modal",onClick:R=>R.stopPropagation(),children:[a.jsxs("div",{className:"nut-modal-header",children:[a.jsx("h3",{children:re==="scan"?"Scan Barcode":re==="search"?"Search Food":re==="favourites"?"Favourites":"Manual Entry"}),a.jsx("button",{className:"nut-modal-close",onClick:()=>{is(),Te(null),L(null),Rt(null)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),re==="scan"&&!ue&&a.jsxs("div",{className:"nut-scan-area",children:[a.jsxs("div",{className:"nut-scanner-wrapper",children:[a.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),ie&&!ke&&a.jsx("div",{className:"nut-scan-line"}),ke&&a.jsxs("div",{className:"nut-scan-detected-overlay",children:[a.jsx("svg",{className:"nut-scan-detected-tick",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),a.jsx("p",{className:"nut-scan-detected-label",children:"Barcode found!"}),a.jsx("p",{className:"nut-scan-detected-code",children:ke})]})]}),!ie&&a.jsxs("button",{className:"nut-scan-start-btn",onClick:Cs,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),ie&&!ke&&a.jsx("p",{className:"nut-scan-hint",children:"Align barcode within the frame"}),a.jsx("div",{className:"nut-barcode-divider",children:a.jsx("span",{children:"or enter barcode manually"})}),a.jsxs("div",{className:"nut-barcode-manual",children:[a.jsx("input",{type:"text",inputMode:"numeric",value:Ee,onChange:R=>Ke(R.target.value),onKeyDown:R=>R.key==="Enter"&&Ee.trim()&&Ir(Ee.trim()),placeholder:"Enter barcode number"}),a.jsx("button",{onClick:()=>Ee.trim()&&Ir(Ee.trim()),disabled:!Ee.trim()||ct,children:ct?"...":"Look Up"})]})]}),re==="scan"&&ue&&(()=>{const R=ue.servingUnit||"g",z=ue.portion,ae=vt==="portion"&&z?Je*z.weight:parseFloat(yt)||0,le=ae/100,Me=R==="ml"?[100,200,250,500]:[50,100,150,200],Le=vt==="portion"&&z?`${Je} ${z.label}${Je!==1?"s":""} (${Math.round(ae)}${R})`:`${Math.round(ae)}${R}`;return a.jsxs("div",{className:"nut-product-result",children:[ue.image&&a.jsx("img",{src:ue.image,alt:ue.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:ue.name}),a.jsx("button",{className:`nut-fav-star confirm${oe(ue.name)?" active":""}`,onClick:()=>Ae({name:ue.name,protein:ue.protein,carbs:ue.carbs,fats:ue.fats,calories:ue.calories,serving:ue.servingSize,per100g:{protein:ue.protein,carbs:ue.carbs,fats:ue.fats,calories:ue.calories},servingUnit:ue.servingUnit||"g",portion:ue.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:oe(ue.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),ue.brand&&a.jsx("p",{className:"nut-product-brand",children:ue.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",R,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[ue.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[ue.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[ue.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[ue.calories," cal"]})]}),z&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:vt==="portion"?"active":"",onClick:()=>{nn("portion"),Je<1&&At(1)},children:"Portions"}),a.jsxs("button",{className:vt==="weight"?"active":"",onClick:()=>{nn("weight"),Vt(String(Math.round(ae)||100))},children:["Custom (",R,")"]})]}),vt==="portion"&&z?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>At(Math.max(1,Je-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:Je}),a.jsxs("span",{className:"nut-stepper-label",children:[z.label,Je!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(ae),R]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>At(Je+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",R,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:yt,onChange:He=>Vt(He.target.value),onFocus:He=>He.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Me.map(He=>a.jsxs("button",{className:`nut-quick-btn${yt===String(He)?" active":""}`,onClick:()=>Vt(String(He)),children:[He,R]},He))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(ue.protein*le),"p / ",Math.round(ue.carbs*le),"c / ",Math.round(ue.fats*le),"f / ",Math.round(ue.calories*le)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>{Rt(null),L("scan")},children:"Scan Again"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Ge({name:ue.name,protein:Math.round(ue.protein*le),carbs:Math.round(ue.carbs*le),fats:Math.round(ue.fats*le),calories:Math.round(ue.calories*le),serving:Le}),children:"Add"})]})]})})(),re==="search"&&!ue&&a.jsxs("div",{className:"nut-search-area",children:[a.jsxs("div",{className:"nut-search-bar",children:[a.jsx("input",{type:"text",ref:it,value:tn,onChange:R=>jn(R.target.value),onKeyDown:R=>{R.key==="Enter"&&(clearTimeout(bt.current),Ks())},onFocus:()=>setTimeout(()=>it.current?.scrollIntoView({behavior:"smooth",block:"center"}),350),placeholder:"Search food or product...",autoFocus:!0}),a.jsx("button",{onClick:Ks,disabled:rt,children:rt?"...":"Search"})]}),a.jsxs("div",{className:"nut-search-results",children:[Un.map((R,z)=>a.jsxs("button",{className:"nut-search-item",onClick:()=>{Rt(R),R.portion?(At(1),Vt(String(R.portion.weight)),nn("portion")):(At(0),Vt(String(R.servingValue||100)),nn("weight"))},children:[R.image&&a.jsx("img",{src:R.image,alt:R.name||"Product",loading:"lazy"}),a.jsxs("div",{className:"nut-search-item-info",children:[a.jsx("span",{className:"nut-search-item-name",children:R.name}),R.brand&&a.jsx("span",{className:"nut-search-item-brand",children:R.brand}),a.jsxs("span",{className:"nut-search-item-macros",children:[R.calories," cal  ",R.protein,"p  ",R.carbs,"c  ",R.fats,"f per 100",R.servingUnit||"g"]})]})]},z)),Un.length===0&&tn&&!rt&&a.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]})]}),re==="search"&&ue&&(()=>{const R=ue.servingUnit||"g",z=ue.portion,ae=vt==="portion"&&z?Je*z.weight:parseFloat(yt)||0,le=ae/100,Me=R==="ml"?[100,200,250,500]:[50,100,150,200],Le=vt==="portion"&&z?`${Je} ${z.label}${Je!==1?"s":""} (${Math.round(ae)}${R})`:`${Math.round(ae)}${R}`;return a.jsxs("div",{className:"nut-product-result",children:[ue.image&&a.jsx("img",{src:ue.image,alt:ue.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:ue.name}),a.jsx("button",{className:`nut-fav-star confirm${oe(ue.name)?" active":""}`,onClick:()=>Ae({name:ue.name,protein:ue.protein,carbs:ue.carbs,fats:ue.fats,calories:ue.calories,serving:ue.servingSize,per100g:{protein:ue.protein,carbs:ue.carbs,fats:ue.fats,calories:ue.calories},servingUnit:ue.servingUnit||"g",portion:ue.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:oe(ue.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),ue.brand&&a.jsx("p",{className:"nut-product-brand",children:ue.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",R,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[ue.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[ue.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[ue.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[ue.calories," cal"]})]}),z&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:vt==="portion"?"active":"",onClick:()=>{nn("portion"),Je<1&&At(1)},children:"Portions"}),a.jsxs("button",{className:vt==="weight"?"active":"",onClick:()=>{nn("weight"),Vt(String(Math.round(ae)||100))},children:["Custom (",R,")"]})]}),vt==="portion"&&z?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>At(Math.max(1,Je-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:Je}),a.jsxs("span",{className:"nut-stepper-label",children:[z.label,Je!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(ae),R]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>At(Je+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",R,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:yt,onChange:He=>Vt(He.target.value),onFocus:He=>He.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Me.map(He=>a.jsxs("button",{className:`nut-quick-btn${yt===String(He)?" active":""}`,onClick:()=>Vt(String(He)),children:[He,R]},He))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(ue.protein*le),"p / ",Math.round(ue.carbs*le),"c / ",Math.round(ue.fats*le),"f / ",Math.round(ue.calories*le)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>Rt(null),children:"Back to Search"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Ge({name:ue.name,protein:Math.round(ue.protein*le),carbs:Math.round(ue.carbs*le),fats:Math.round(ue.fats*le),calories:Math.round(ue.calories*le),serving:Le}),children:"Add"})]})]})})(),re==="manual"&&a.jsxs("div",{className:"nut-manual-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Food Name"}),a.jsx("input",{type:"text",value:ut.name,onChange:R=>Bn(z=>({...z,name:R.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Serving Size (optional)"}),a.jsx("input",{type:"text",value:ut.serving,onChange:R=>Bn(z=>({...z,serving:R.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),a.jsxs("div",{className:"nut-manual-macros",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Protein (g)"}),a.jsx("input",{type:"number",value:ut.protein,onChange:R=>Bn(z=>({...z,protein:R.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Carbs (g)"}),a.jsx("input",{type:"number",value:ut.carbs,onChange:R=>Bn(z=>({...z,carbs:R.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fats (g)"}),a.jsx("input",{type:"number",value:ut.fats,onChange:R=>Bn(z=>({...z,fats:R.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Calories"}),a.jsx("input",{type:"number",value:ut.calories,onChange:R=>Bn(z=>({...z,calories:R.target.value})),min:"0"})]})]}),a.jsx("button",{className:"nut-btn-primary",disabled:!ut.name.trim(),onClick:()=>Ge({name:ut.name,protein:parseFloat(ut.protein)||0,carbs:parseFloat(ut.carbs)||0,fats:parseFloat(ut.fats)||0,calories:parseFloat(ut.calories)||0,serving:ut.serving||""}),children:"Add Food"})]}),re==="favourites"&&!ue&&(()=>{const R=yr(),z=ae=>{if(ae.per100g){const le=ae.per100g;Rt({name:ae.name,brand:"",image:null,servingSize:ae.serving||"100g",servingValue:100,servingUnit:ae.servingUnit||"g",portion:ae.portion||null,protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories,per100g:!0}),ae.portion?(At(1),Vt(String(ae.portion.weight)),nn("portion")):(At(0),Vt("100"),nn("weight"))}else Ge({name:ae.name,protein:ae.protein,carbs:ae.carbs,fats:ae.fats,calories:ae.calories,serving:ae.serving||""})};return a.jsx("div",{className:"nut-recent-area",children:R.length===0?a.jsx("p",{className:"nut-search-empty",children:"No favourites yet. Tap the star on any food to save it here."}):a.jsx("div",{className:"nut-recent-list",children:R.map((ae,le)=>a.jsxs("div",{className:"nut-recent-item-row",children:[a.jsx("button",{className:"nut-fav-star active",onClick:Me=>{Me.stopPropagation(),Ae(ae)},children:a.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("button",{className:"nut-recent-item",onClick:()=>z(ae),children:[a.jsxs("div",{className:"nut-recent-item-info",children:[a.jsx("span",{className:"nut-recent-item-name",children:ae.name}),a.jsx("span",{className:"nut-recent-item-serving",children:ae.serving||""})]}),a.jsxs("span",{className:"nut-recent-item-macros",children:[ae.calories," cal"]})]})]},le))})})})(),re==="favourites"&&ue&&(()=>{const R=ue.servingUnit||"g",z=ue.portion,ae=vt==="portion"&&z?Je*z.weight:parseFloat(yt)||0,le=ae/100,Me=R==="ml"?[100,200,250,500]:[50,100,150,200],Le=vt==="portion"&&z?`${Je} ${z.label}${Je!==1?"s":""} (${Math.round(ae)}${R})`:`${Math.round(ae)}${R}`;return a.jsxs("div",{className:"nut-product-result",children:[a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:ue.name}),a.jsx("button",{className:`nut-fav-star confirm${oe(ue.name)?" active":""}`,onClick:()=>Ae({name:ue.name,protein:ue.protein,carbs:ue.carbs,fats:ue.fats,calories:ue.calories,serving:ue.servingSize,per100g:{protein:ue.protein,carbs:ue.carbs,fats:ue.fats,calories:ue.calories},servingUnit:ue.servingUnit||"g",portion:ue.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:oe(ue.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",R,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[ue.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[ue.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[ue.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[ue.calories," cal"]})]}),z&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:vt==="portion"?"active":"",onClick:()=>{nn("portion"),Je<1&&At(1)},children:"Portions"}),a.jsxs("button",{className:vt==="weight"?"active":"",onClick:()=>{nn("weight"),Vt(String(Math.round(ae)||100))},children:["Custom (",R,")"]})]}),vt==="portion"&&z?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>At(Math.max(1,Je-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:Je}),a.jsxs("span",{className:"nut-stepper-label",children:[z.label,Je!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(ae),R]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>At(Je+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",R,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:yt,onChange:He=>Vt(He.target.value),onFocus:He=>He.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Me.map(He=>a.jsxs("button",{className:`nut-quick-btn${yt===String(He)?" active":""}`,onClick:()=>Vt(String(He)),children:[He,R]},He))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(ue.protein*le),"p / ",Math.round(ue.carbs*le),"c / ",Math.round(ue.fats*le),"f / ",Math.round(ue.calories*le)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>Rt(null),children:"Back to Favourites"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Ge({name:ue.name,protein:Math.round(ue.protein*le),carbs:Math.round(ue.carbs*le),fats:Math.round(ue.fats*le),calories:Math.round(ue.calories*le),serving:Le}),children:"Add"})]})]})})()]})}),a.jsx(Ri,{active:"nutrition"}),Xt&&a.jsx("div",{className:`toast-notification ${Xt.type}`,children:Xt.message})]})})}async function o3(s){const{type:e="workout",title:t="Workout Complete!",stats:i=[],badges:l=[],badgeImage:u,badgeDesc:h}=s,p=1080,g=1920,y=document.createElement("canvas");y.width=p,y.height=g;const b=y.getContext("2d"),E="#2a2a28",T="#ffffff",O="#A12F3A",H="#1a1a1a",q="#555555";b.fillStyle=E,b.fillRect(0,0,p,g);const B=Math.round(p*.82),X=Math.round(g*.75),W=Math.round((p-B)/2),Y=Math.round((g-X)/2),de=28,xe=5;b.save(),b.shadowColor="rgba(0, 0, 0, 0.45)",b.shadowBlur=40,b.shadowOffsetY=10,Fw(b,W,Y,B,X,de),b.fillStyle=T,b.fill(),b.restore(),b.save(),Fw(b,W,Y,B,X,de),b.strokeStyle=O,b.lineWidth=xe,b.stroke(),b.restore();const ve=220,j=50,S=52,I=68,V=10,D=36,M=48,A=30,Be=34,Ze=46,te=30,_e=28;b.font=`bold ${S}px 'Orbitron', sans-serif`;const Ie=Kc(b,t.toUpperCase(),B-100);b.font=`500 ${D}px 'Montserrat', sans-serif`;let ze=[];e==="badge"&&h?ze=Kc(b,h,B-120):e==="badge"&&l.length>0?ze=Kc(b,l.join("    "),B-120):i.length>0&&(ze=Kc(b,i.map(gt=>`${gt.value} ${gt.label}`).join("    "),B-120));const re=e==="badge"?"I just earned a badge on Core Buddy ":e==="habits"?"I just completed my daily habits with Core Buddy ":"I just completed a workout using Core Buddy ";b.font=`bold ${Be}px 'Montserrat', sans-serif`;const L=Kc(b,re,B-80);let ie=Ie.length*I;ze.length>0&&(ie+=V+ze.length*M),ie+=A+L.length*Ze,ie+=te+_e;const ke=Y+X-60-ie,Ee=Y+40,Ke=ke-j,ct=p/2,Ve=(Ee+Ke)/2,tn=e==="badge"&&u?u:"/Logo.webp";b.save();const jn=e==="badge"?"rgba(255, 193, 7, 0.15)":"rgba(161, 47, 58, 0.12)",Un=b.createRadialGradient(ct,Ve,ve*.6,ct,Ve,ve*1.5);Un.addColorStop(0,jn),Un.addColorStop(1,"rgba(0, 0, 0, 0)"),b.fillStyle=Un,b.fillRect(ct-ve*1.5,Ve-ve*1.5,ve*3,ve*3),b.restore(),b.beginPath(),b.arc(ct,Ve,ve+6,0,Math.PI*2),b.fillStyle=T,b.fill();const Lt=e==="badge"?"#ffc107":O;b.beginPath(),b.arc(ct,Ve,ve,0,Math.PI*2),b.strokeStyle=Lt,b.lineWidth=5,b.stroke();try{const gt=await l3(tn);b.save(),b.beginPath(),b.arc(ct,Ve,ve-6,0,Math.PI*2),b.clip();const ut=(ve-6)*2;b.drawImage(gt,ct-ve+6,Ve-ve+6,ut,ut),b.restore()}catch{b.textAlign="center",b.textBaseline="middle",b.fillStyle=O,b.font="bold 80px 'Orbitron', sans-serif",b.fillText(e==="badge"?"":"MCF",ct,Ve)}let rt=ke;b.textAlign="center",b.textBaseline="alphabetic",b.fillStyle=H,b.font=`bold ${S}px 'Orbitron', sans-serif`;for(const gt of Ie)b.fillText(gt,p/2,rt),rt+=I;if(ze.length>0){rt+=V,b.fillStyle=q,b.font=`500 ${D}px 'Montserrat', sans-serif`;for(const gt of ze)b.fillText(gt,p/2,rt),rt+=M}rt+=A,b.fillStyle=H,b.font=`bold ${Be}px 'Montserrat', sans-serif`;for(const gt of L)b.fillText(gt,p/2,rt),rt+=Ze;return rt+=te,b.fillStyle=O,b.font=`600 ${_e}px 'Montserrat', sans-serif`,b.fillText("Make It Count with Core Buddy",p/2,rt),new Promise(gt=>{y.toBlob(ut=>gt(ut),"image/png")})}function Fw(s,e,t,i,l,u){s.beginPath(),s.moveTo(e+u,t),s.lineTo(e+i-u,t),s.quadraticCurveTo(e+i,t,e+i,t+u),s.lineTo(e+i,t+l-u),s.quadraticCurveTo(e+i,t+l,e+i-u,t+l),s.lineTo(e+u,t+l),s.quadraticCurveTo(e,t+l,e,t+l-u),s.lineTo(e,t+u),s.quadraticCurveTo(e,t,e+u,t),s.closePath()}function l3(s){return new Promise((e,t)=>{const i=new Image;i.crossOrigin="anonymous",i.onload=()=>e(i),i.onerror=t,i.src=s})}function Kc(s,e,t){if(s.measureText(e).width<=t)return[e];const i=e.split(" "),l=[];let u="";for(const h of i){const p=u?`${u} ${h}`:h;s.measureText(p).width>t&&u?(l.push(u),u=h):u=p}return u&&l.push(u),l}function c3(){const s=_.useRef(null),e=_.useCallback(()=>{if(!s.current)try{s.current=new(window.AudioContext||window.webkitAudioContext)}catch{}const u=s.current;return u?.state==="suspended"&&u.resume(),u},[]),t=_.useCallback(()=>{navigator.vibrate&&navigator.vibrate([40,60,30]);const u=e();if(!u)return;const h=u.currentTime,p=u.createBiquadFilter();p.type="lowpass",p.frequency.value=500,p.Q.value=.7,p.connect(u.destination);const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=50,y.gain.value=.3,y.gain.setTargetAtTime(0,h+.08,.04),g.connect(y).connect(p),g.start(h),g.stop(h+.2);const b=u.createOscillator(),E=u.createGain();b.type="sine",b.frequency.value=70,E.gain.value=.2,E.gain.setTargetAtTime(0,h+.22,.04),b.connect(E).connect(p),b.start(h+.15),b.stop(h+.35)},[e]),i=_.useCallback(()=>{navigator.vibrate&&navigator.vibrate(30);const u=e();if(!u)return;const h=u.currentTime,p=u.createBiquadFilter();p.type="lowpass",p.frequency.value=500,p.Q.value=.7,p.connect(u.destination);const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=55,y.gain.value=.35,y.gain.setTargetAtTime(0,h+.08,.04),g.connect(y).connect(p),g.start(h),g.stop(h+.2)},[e]),l=_.useCallback(()=>{navigator.vibrate&&navigator.vibrate([50,80,100]);const u=e();u&&[0,.12].forEach((h,p)=>{const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=p===0?523:784,y.gain.value=.12,y.gain.setTargetAtTime(0,u.currentTime+h+.15,.02),g.connect(y).connect(u.destination),g.start(u.currentTime+h),g.stop(u.currentTime+h+.2)})},[e]);return _.useEffect(()=>()=>{s.current?.close()},[]),{tap:i,tick:t,complete:l}}const u3=2e3,zg=42,Nl=2*Math.PI*zg,h3=1200,qw=["Another one in the bank!","Consistency beats everything.","You showed up  that's what counts.","Stronger every session."];function Fg({title:s,subtitle:e,stats:t,onDone:i,onDismissStart:l,onShareJourney:u,userName:h,buttonLabel:p="Done",holdLabel:g="Hold To Complete Session",shareType:y="workout",hideShare:b=!1}){const[E,T]=_.useState("hold"),[O,H]=_.useState(!1),[q,B]=_.useState(0),[X,W]=_.useState(!1),[Y,de]=_.useState(!1),[xe,ve]=_.useState(null),j=c3(),S=_.useRef(null),I=_.useRef(null),V=_.useRef(null),D=_.useRef(null),M=_.useRef(!1),A=_.useRef(!1),Be=_.useRef(0),Ze=_.useRef(qw[Math.floor(Math.random()*qw.length)]),te=_.useRef([...Array(80)].map((Te,Ee)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#ffffff","#000000"][Ee%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:Ee%3}))),_e=_.useCallback(()=>{if(M.current)return;M.current=!0,A.current=!1,Be.current=0,H(!0),B(0),D.current=performance.now(),j.tap(),S.current&&(S.current.style.strokeDashoffset=Nl);const Te=Ee=>{const Ke=Ee-D.current,ct=Math.min(Ke/u3,1);if(S.current&&(S.current.style.strokeDashoffset=Nl-ct*Nl),I.current){const Ve=8*(1-ct),tn=1-ct,jn=1+ct*.15;I.current.style.filter=`blur(${Ve}px) grayscale(${tn})`,I.current.style.transform=`scale(${jn})`}B(ct),Ke-Be.current>=h3&&(Be.current=Ke,j.tick()),ct<1?V.current=requestAnimationFrame(Te):(M.current=!1,A.current=!0,V.current=null,H(!1),B(1),j.complete(),T("celebrate"))};V.current=requestAnimationFrame(Te)},[j]),Ie=_.useCallback(()=>{M.current&&(M.current=!1,V.current&&(cancelAnimationFrame(V.current),V.current=null),S.current&&(S.current.style.strokeDashoffset=Nl),I.current&&(I.current.style.filter="",I.current.style.transform=""),H(!1),B(0))},[]),ze=_.useCallback(()=>{W(!0),l?.(),setTimeout(()=>{i?.()},300)},[i,l]),re=_.useCallback(()=>{const Te=[s||"Workout Complete!"];return e&&Te.push(e),t?.length&&Te.push(t.map(Ee=>`${Ee.value} ${Ee.label}`).join(" | ")),Te.push("#MindCoreFitness"),Te.join(`
`)},[s,e,t]),L=_.useCallback(async()=>{if(!(Y||!u))try{await u({type:y==="habits"?"habits_summary":"workout_summary",title:s||"Workout Complete!",subtitle:e,stats:t||[],quote:Ze.current}),de(!0),ve("Posted to Journey!"),setTimeout(()=>ve(null),2500)}catch(Te){console.error("Journey post failed:",Te),ve(Te?.message||"Failed to post"),setTimeout(()=>ve(null),3500)}},[Y,u,s,e,t]),[ie,we]=_.useState(!1),ke=_.useCallback(async()=>{we(!0);try{const Te=await o3({type:y||"workout",title:s||"Workout Complete!",subtitle:e,stats:t||[],quote:Ze.current,userName:h}),Ee=re();if(navigator.share&&navigator.canShare?.({files:[new File([Te],"workout.png",{type:"image/png"})]})){const Ke=new File([Te],"workout.png",{type:"image/png"});await navigator.share({title:"Mind Core Fitness",text:Ee,files:[Ke]})}else navigator.share?await navigator.share({title:"Mind Core Fitness",text:Ee}):(await navigator.clipboard.writeText(Ee),ve("Copied to clipboard!"),setTimeout(()=>ve(null),2500))}catch{try{await navigator.clipboard.writeText(re()),ve("Copied to clipboard!"),setTimeout(()=>ve(null),2500)}catch{}}finally{we(!1)}},[s,e,t,h,re]);return E==="hold"?a.jsxs("div",{className:"wc-hold-page",children:[a.jsx("div",{className:"wc-hold-glow","aria-hidden":"true"}),a.jsx("p",{className:"wc-hold-label",children:g}),a.jsxs("div",{className:`wc-hold-ring-touch ${O?"wc-holding":""}`,onPointerDown:Te=>{Te.preventDefault(),_e()},onPointerUp:Ie,onPointerLeave:Ie,onPointerCancel:Ie,onClick:Te=>{Te.stopPropagation(),A.current&&(A.current=!1)},role:"button",tabIndex:0,"aria-label":"Press and hold to finish workout",onKeyDown:Te=>{(Te.key==="Enter"||Te.key===" ")&&(Te.preventDefault(),j.complete(),T("celebrate"))},children:[a.jsx("div",{className:"wc-hold-ring-glow","aria-hidden":"true"}),a.jsxs("svg",{className:"wc-hold-ring-svg",viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"wc-hold-ring-track",cx:"50",cy:"50",r:zg}),a.jsx("circle",{className:"wc-hold-ring-fill",ref:S,cx:"50",cy:"50",r:zg,style:{strokeDasharray:Nl,strokeDashoffset:Nl}})]}),a.jsx("img",{ref:I,src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-hold-logo",draggable:!1})]})]}):a.jsxs("div",{className:`wc-celeb-overlay ${X?"wc-celeb-dismissing":""}`,children:[a.jsx("div",{className:"wc-celeb-confetti","aria-hidden":"true",children:te.current.map((Te,Ee)=>a.jsx("span",{className:`wc-celeb-confetti-piece wc-confetti-shape-${Te.shape}`,style:{"--x":`${Te.x}%`,"--delay":`${Te.delay}s`,"--color":Te.color,"--drift":`${Te.drift}px`,"--spin":`${Te.spin}deg`,"--duration":`${Te.duration}s`,width:`${Te.width}px`,height:`${Te.height}px`}},Ee))}),a.jsxs("div",{className:"wc-celeb-content",children:[a.jsx("div",{className:"wc-celeb-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-celeb-logo-img"})}),a.jsx("h2",{className:"wc-celeb-heading",children:s||"Congratulations!"}),e&&a.jsx("p",{className:"wc-celeb-subtext",children:e}),a.jsx("p",{className:"wc-celeb-quote",children:Ze.current}),t&&t.length>0&&a.jsx("div",{className:"wc-celeb-stats-row",children:t.map((Te,Ee)=>a.jsxs("div",{className:"wc-celeb-stat",children:[a.jsx("span",{className:"wc-celeb-stat-val",children:Te.value}),a.jsx("span",{className:"wc-celeb-stat-label",children:Te.label})]},Ee))}),!b&&a.jsxs("div",{className:"wc-share-row",children:[u&&a.jsxs("button",{className:`wc-share-btn wc-share-journey ${Y?"wc-share-done":""}`,onClick:L,disabled:Y,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 20h9"}),a.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),Y?"Posted!":"Post to Journey"]}),a.jsxs("button",{className:"wc-share-btn wc-share-external",onClick:ke,disabled:ie,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"18",cy:"5",r:"3"}),a.jsx("circle",{cx:"6",cy:"12",r:"3"}),a.jsx("circle",{cx:"18",cy:"19",r:"3"}),a.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),a.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),ie?"Generating...":"Share"]})]}),a.jsx("button",{className:"wc-celeb-btn",onClick:ze,children:p}),xe&&a.jsx("div",{className:"wc-share-toast",children:xe})]})]})}const Hw="/login/assets/randomiser-glq9YJkL.jpg",$w="/login/assets/programme-card-workout-CnNzTYkz.webp",d3="/login/assets/prog-fullbody-4wk-r6m9HJys.jpg",f3="/login/assets/muscle-group-arms-C9AdZL4-.png",m3="/login/assets/arms-bicep-BUrmT1o-.png",p3="/login/assets/arms-tricep-D9tAnFnS.png",g3="/login/assets/arms-full-arms-BY3TvpJm.png",y3="/login/assets/muscle-group-chest-Cxfuc7XI.png",v3="/login/assets/chest-strength-BR4BAFTH.png",b3="/login/assets/chest-hypertrophy-B8yNrvjB.png",w3="/login/assets/chest-endurance-e-OSWtWO.png",_3="/login/assets/muscle-group-shoulders-DibNtCLF.png",x3="/login/assets/shoulders-strength-CKlZBF5A.png",E3="/login/assets/shoulders-hypertrophy-BUd76jiS.png",T3="/login/assets/shoulders-endurance-HuqNG5rD.png",k3="/login/assets/muscle-group-core-CPR-bdRg.png",S3="/login/assets/core-lower-abs-TVcqGMFJ.png",j3="/login/assets/core-obliques-rotation-Djb7Qlbk.png",C3="/login/assets/core-weighted-core-4Kwh9mTv.png",N3="/login/assets/muscle-group-back-8JPV-YUo.png",A3="/login/assets/back-strength-BmSRxnwo.png",R3="/login/assets/back-hypertrophy-CXHmsnCz.png",I3="/login/assets/back-endurance-C8qJ8l5I.png",D3="/login/assets/muscle-group-legs-B8jcbdov.png",M3="/login/assets/legs-quads-DbnfsebI.png",L3="/login/assets/legs-hamstrings-glutes-BrfsvvzX.png",O3="/login/assets/legs-power-plyo-D2qBXeUR.png",P3=60,Qp=5,V3={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},U3={fullbody:"linear-gradient(160deg, rgba(153,49,60,0.15) 0%, rgba(153,49,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",upper:"linear-gradient(160deg, rgba(100,60,140,0.2) 0%, rgba(100,60,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",lower:"linear-gradient(160deg, rgba(40,120,80,0.2) 0%, rgba(40,120,80,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)"},Xp={arms:"linear-gradient(160deg, rgba(180,60,60,0.2) 0%, rgba(180,60,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",chest:"linear-gradient(160deg, rgba(50,100,160,0.2) 0%, rgba(50,100,160,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",back:"linear-gradient(160deg, rgba(80,130,60,0.2) 0%, rgba(80,130,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",shoulders:"linear-gradient(160deg, rgba(160,100,40,0.2) 0%, rgba(160,100,40,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",legs:"linear-gradient(160deg, rgba(100,50,140,0.2) 0%, rgba(100,50,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)"},Jp=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,level:"All Levels",daysPerWeek:3,image:d3},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,level:"Intermediate",daysPerWeek:3},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,level:"Advanced",daysPerWeek:3},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,level:"Beginner",daysPerWeek:3},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,level:"Intermediate",daysPerWeek:3},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,level:"Advanced",daysPerWeek:3},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,level:"Intermediate",daysPerWeek:3},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,level:"Intermediate",daysPerWeek:3}],Yc=[{key:"arms",label:"Arms",icon:"M7 5h2v14H7V5zm8 0h2v14h-2V5zm-5 4h4v6h-4V9z",image:f3},{key:"chest",label:"Chest",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-2h2v2zm4 0h-2v-2h2v2zm3-6c0 1.1-.36 2.12-.97 2.95l-.87-.87C16.7 12.53 17 11.8 17 11c0-2.76-2.24-5-5-5S7 8.24 7 11c0 .8.3 1.53.84 2.08l-.87.87A4.977 4.977 0 0 1 6 11c0-3.31 2.69-6 6-6s6 2.69 6 6z",image:y3},{key:"back",label:"Back",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm4 18H8v-6l-4-4 1.41-1.41L8 11.17V8h8v3.17l2.59-2.58L20 10l-4 4v6z",image:N3},{key:"shoulders",label:"Shoulders",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",image:_3},{key:"legs",label:"Legs",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z",image:D3},{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",image:k3}],Ww={chest:[{id:"chest_strength",name:"Chest Strength",desc:"Heavy pressing for max strength",image:v3,level:"Intermediate",overview:"A heavy pressing session designed to build raw chest strength. Focus on controlled negatives and powerful pressing movements.",tips:["Go heavy  pick a weight where the last 2 reps are a real challenge","Control the negative (lowering phase) for 2-3 seconds","Keep your shoulder blades squeezed together throughout all pressing movements","Rest 90-120 seconds between sets to allow full recovery"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Squeeze Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"chest_hypertrophy",name:"Chest Hypertrophy",desc:"Volume training for muscle growth",image:b3,level:"Intermediate",overview:"A high-volume chest session focused on time under tension and muscle growth. Lighter weights, more reps, and slow controlled movements.",tips:["Use moderate weight  you should feel the burn by rep 10","Squeeze your chest at the top of every rep for 1 second","Keep rest periods short at 60-90 seconds to keep the pump going","On press ups, go to failure on the final set"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Press Up",type:"reps",sets:3,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"}]},{id:"chest_endurance",name:"Chest Endurance",desc:"Bodyweight pushing to failure",image:w3,level:"All Levels",overview:"No weights needed. This bodyweight-only session builds chest endurance and muscular stamina through high-rep push up variations.",tips:["Focus on full range of motion  chest to floor on every rep","Keep your core tight and body in a straight line throughout","Scale down to knee press ups if you can't maintain form","Push through the burn  the last 5 reps are where the growth happens"],exercises:[{name:"Press Up",type:"reps",sets:4,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null},{name:"Decline Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Press Up Hold",type:"timed",sets:3,time:30,storagePath:null}]}],back:[{id:"back_strength",name:"Back Strength",desc:"Heavy rows for a thick back",image:A3,level:"Intermediate",overview:"Build a thick, powerful back with heavy rowing movements. This session targets your lats, rhomboids, and traps for overall back development.",tips:["Go heavy on rows  use a weight that challenges you by rep 6-8","Drive your elbows back and squeeze your shoulder blades together at the top","Keep a slight bend in your knees and hinge at the hips for bent over movements","Rest 90-120 seconds between sets for full recovery"],exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"back_hypertrophy",name:"Back Hypertrophy",desc:"Width and thickness volume work",image:R3,level:"Intermediate",overview:"A volume-focused back session combining rows and isolation moves to build width and thickness. Focus on the mind-muscle connection.",tips:["Use moderate weight  feel the stretch and squeeze on every rep","On renegade rows, keep your hips square to the floor and avoid rotating","For reverse flys, use lighter weight and focus on squeezing your rear delts","Keep rest to 60-90 seconds to maintain intensity"],exercises:[{name:"Renegade Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Reverse Fly",type:"weighted",sets:3,reps:15,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null}]},{id:"back_endurance",name:"Back Endurance",desc:"Bodyweight back conditioning",image:I3,level:"All Levels",overview:"A bodyweight session to strengthen your posterior chain and improve posture. Great for back health, mobility, and muscular endurance.",tips:["On superman holds, lift your arms and legs simultaneously and hold tight","Focus on slow, controlled movements  quality over speed","Breathe steadily throughout timed holds  don't hold your breath","Engage your glutes and lower back together on every movement"],exercises:[{name:"Superman Hold",type:"timed",sets:4,time:30,storagePath:"exercises/bodyweight/upper/Superman Hold.mp4"},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:12,storagePath:null},{name:"Reverse Snow Angel",type:"reps",sets:3,reps:12,storagePath:null},{name:"Bird Dog",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Back Extension Hold",type:"timed",sets:3,time:30,storagePath:null}]}],shoulders:[{id:"shoulders_strength",name:"Shoulder Strength",desc:"Heavy pressing for boulder shoulders",image:x3,level:"Intermediate",overview:"A heavy overhead pressing session to build strong, powerful shoulders. Compound movements first, followed by isolation work for all three delt heads.",tips:["Go heavy on presses  pick a weight where you struggle on the last 2 reps","Brace your core and avoid arching your back during overhead movements","Press straight up and control the weight down slowly","Rest 90-120 seconds between pressing sets, 60 seconds for isolation moves"],exercises:[{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"shoulders_hypertrophy",name:"Shoulder Hypertrophy",desc:"Volume and isolation for 3D delts",image:E3,level:"Intermediate",overview:"A high-volume session targeting all three heads of the deltoid for that 3D capped shoulder look. Moderate weight, high reps, constant tension.",tips:["Use lighter weight than you think  shoulders respond best to high reps","On lateral raises, lead with your elbows and don't swing the weight","Pause at the top of each raise for a 1-second squeeze","Keep rest periods at 60 seconds to maximise the pump"],exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Y-Raise",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"shoulders_endurance",name:"Shoulder Endurance",desc:"Bodyweight and high-rep work",image:T3,level:"All Levels",overview:"A shoulder endurance session combining bodyweight movements with high-rep dumbbell work. Builds stamina, stability, and shoulder resilience.",tips:["On pike push ups, walk your feet close to your hands to increase the angle","For high-rep lateral raises, use a very light weight and focus on form","Wall walks are advanced  scale to pike push ups if needed","Keep your core braced throughout to protect your lower back"],exercises:[{name:"Pike Push Ups",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/upper/pike push ups.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,reps:20,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Wall Walks",type:"reps",sets:3,reps:6,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null},{name:"Shoulder Tap Hold",type:"timed",sets:3,time:30,storagePath:null}]}],arms:[{id:"arms_bicep",name:"Bicep Focus",desc:"Curl variations for peak biceps",image:m3,level:"All Levels",overview:"An arm session dedicated entirely to biceps. Multiple curl variations target different parts of the bicep for maximum peak and thickness.",tips:["Keep your elbows pinned to your sides  no swinging","Control the negative (lowering) for 2-3 seconds on every rep","Start with your heaviest weight and decrease as you fatigue","Squeeze hard at the top of each curl for a full contraction"],exercises:[{name:"Bicep Curl",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Concentration Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Isometric Bicep Hold",type:"timed",sets:3,time:20,storagePath:null}]},{id:"arms_tricep",name:"Tricep Focus",desc:"Extensions and dips for horseshoe triceps",image:p3,level:"All Levels",overview:"All-out tricep training with extensions, dips, and pressing movements. The triceps make up two-thirds of your arm  this session builds serious size.",tips:["On overhead extensions, keep your elbows close to your head","For skullcrushers, lower the weight slowly to just above your forehead","On dips, lean slightly forward to reduce shoulder strain","Full lockout at the top of every extension for maximum tricep contraction"],exercises:[{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Tricep Dips",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null}]},{id:"arms_full",name:"Full Arms",desc:"Superset biceps and triceps",image:g3,level:"All Levels",overview:"A balanced arm session alternating between biceps and triceps. Superset style keeps the intensity high and maximises the pump.",tips:["Superset each pair  do biceps then immediately hit triceps","Use moderate weight that lets you maintain strict form for all reps","Rest 60 seconds after each superset pair","Focus on the squeeze at the peak contraction of every rep"],exercises:[{name:"Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Wrist Curl",type:"weighted",sets:3,reps:15,storagePath:null}]}],legs:[{id:"legs_quad",name:"Quad Dominant",desc:"Squats and lunges for quad power",image:M3,level:"All Levels",overview:"A quad-focused leg session built around squats and lunges. Heavy compound movements to build strong, powerful quads and overall leg strength.",tips:["On goblet squats, hold the dumbbell close to your chest and sit deep","Keep your knees tracking over your toes  don't let them cave inward","Drive through your heels on all squatting movements","Rest 90-120 seconds between heavy sets, 60 seconds on bodyweight moves"],exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/lower/bulgarian split squats.mp4"},{name:"Squat And Hold",type:"timed",sets:3,time:30,storagePath:"exercises/bodyweight/lower/squat and hold.mp4"}]},{id:"legs_ham_glute",name:"Hamstring & Glute",desc:"Posterior chain focus",image:L3,level:"Intermediate",overview:"Target the back of your legs with deadlift and hip hinge variations. This session builds a strong posterior chain  hamstrings, glutes, and lower back.",tips:["On RDLs, push your hips back and feel the stretch in your hamstrings","Keep a slight bend in your knees throughout hip hinge movements","Squeeze your glutes hard at the top of every rep","For single leg work, start with your weaker side first"],exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/romanian deadlifts.mp4"},{name:"1 Legged RDL",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.mp4"},{name:"Hip Thrusts",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/hip thrusts.mp4"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.mp4"},{name:"Donkey Kicks",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.mp4"}]},{id:"legs_power",name:"Power & Plyo",desc:"Explosive leg training",image:O3,level:"Intermediate",overview:"An explosive leg session combining plyometrics with weighted movements. Build power, speed, and athletic performance.",tips:["On jump squats, land softly with bent knees to absorb the impact","Explode up on every rep  power comes from speed, not just weight","Keep rest periods at 60-90 seconds to maintain intensity","Focus on landing mechanics  knees out, chest up, soft landing"],exercises:[{name:"Jump Squats",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/lower/jump squats.mp4"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Skater Jumps",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/skater jumps.mp4"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.mp4"}]}],core:[{id:"core_lower_abs",name:"Lower Abs Blast",desc:"40s work / 20s rest  3 rounds",image:S3,level:"Intermediate",overview:"An interval-based core burner targeting the lower abdominals. 40 seconds of work followed by 20 seconds of rest  keep the intensity high and your lower back pressed into the floor throughout.",tips:["Press your lower back firmly into the floor on every rep","Exhale hard as you contract your abs  don't hold your breath","If your lower back lifts off the ground, reduce the range of motion","Focus on slow, controlled movements rather than speed"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Leg Raises",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Reverse Crunch To Leg Raise",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Flutter Kicks",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Dead Bug Single Leg Drop",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Hollow Hold Flutter Kicks",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"}]},{id:"core_obliques",name:"Obliques & Rotation",desc:"35s work / 25s rest  3 rounds",image:j3,level:"Intermediate",overview:"Target the obliques and rotational core muscles with this interval session. 35 seconds of work with 25 seconds rest  every exercise involves twisting, rotating, or side-bracing movements.",tips:["Rotate from your ribcage, not just your arms","Keep your hips as still as possible during twisting exercises","Brace your core before each movement  think about squeezing a belt","On side planks, stack your hips and push the floor away"],interval:!0,rounds:3,work:35,rest:25,exercises:[{name:"Russian Twist",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank Rotation",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Cross Body Mountain Climbers",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Hip Dips Plank",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Bicycle Crunch",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank",storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{id:"core_weighted",name:"Weighted Core",desc:"40s work / 20s rest  3 rounds",image:C3,level:"Advanced",overview:"Add resistance to your core training with dumbbells and kettlebells. 40 seconds of weighted work followed by 20 seconds rest  this session builds serious core strength and stability.",tips:["Start with a moderate weight  form is more important than load","Brace your entire core before picking up the weight each round","Keep movements controlled  no swinging or using momentum","If grip fails before core does, go slightly lighter next time"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Russian Twists Dumbbell",storagePath:"exercises/dumbbells/core/russian twists dumbbell.mp4"},{name:"Kettlebell Russian Twist",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Dumbbell Plank Pull Through",storagePath:null}]}]},Zp=[{key:"bodyweight",label:"Bodyweight",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"},{key:"dumbbells",label:"Dumbbells",icon:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"},{key:"kettlebells",label:"Kettlebells",icon:"M12 2C9.24 2 7 4.24 7 7c0 1.1.36 2.12.97 2.95C6.76 11.08 6 12.96 6 15c0 3.87 2.69 7 6 7s6-3.13 6-7c0-2.04-.76-3.92-1.97-5.05.61-.83.97-1.85.97-2.95 0-2.76-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}],Wr=[{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"},{key:"upper",label:"Upper",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"lower",label:"Lower",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"fullbody",label:"Full Body",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z"},{key:"mix",label:"Mix It Up",icon:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm-.83 9.41l-1.42 1.42L17.96 20.54l1.42-1.42-5.71-5.71z"}],_i=[{key:"beginner",label:"Beginner",work:30,rest:30,desc:"30s work / 30s rest"},{key:"intermediate",label:"Intermediate",work:40,rest:20,desc:"40s work / 20s rest"},{key:"advanced",label:"Advanced",work:40,rest:15,desc:"40s work / 15s rest"}],eg=[5,10,15,20,30],dd={core:"#e85d04",upper:"#2196f3",lower:"#4caf50",fullbody:"#9c27b0",mix:"#ff9800"},Gw=["Mix up your focus areas to build balanced strength.","Consistency beats intensity  show up and press play.","Try a new difficulty level to keep your body guessing.","Short on time? A 5-minute blast still counts.","Save your favourite combos so you can replay them anytime.","Your body adapts  switch equipment for fresh stimulus.","Rest days are growth days. Listen to your body.","Challenge yourself: go one level higher this week."];function B3(s){return s.replace(/\b\w/g,e=>e.toUpperCase())}function z3(s){const e=[...s];for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}function F3(){const{currentUser:s,isClient:e,clientData:t,loading:i}=hi(),{isDark:l,toggleTheme:u,accent:h}=ao(),{isPremium:p,FREE_RANDOMISER_DURATIONS:g,FREE_RANDOMISER_WEEKLY_LIMIT:y}=Bu(),b=gr(),[E,T]=_.useState("randomiser_hub"),[O,H]=_.useState(["bodyweight"]),[q,B]=_.useState("core"),[X,W]=_.useState("intermediate"),[Y,de]=_.useState(p?15:5),[xe,ve]=_.useState([]),[j,S]=_.useState(!1),I=_.useRef(!1),V=_.useRef([]),[D,M]=_.useState([]),[A,Be]=_.useState(2),[Ze,te]=_.useState(_i[1]),[_e,Ie]=_.useState(1),[ze,re]=_.useState(0),[L,ie]=_.useState("work"),[we,ke]=_.useState(0),[Te,Ee]=_.useState(!1),[Ke,ct]=_.useState(0),[Ve,tn]=_.useState(!1),[jn,Un]=_.useState(!1),[Lt,rt]=_.useState(null),gt=_.useRef(null);_.useRef(null),_.useRef(null);const[ut,Bn]=_.useState(null),ue=_.useCallback((P,Q="info")=>{Bn({message:P,type:Q}),setTimeout(()=>Bn(null),3e3)},[]),Rt=_.useCallback(async P=>{if(!t)throw new Error("Not signed in");const Q=P&&typeof P=="object"&&P.type;await ri(Mt(Se,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Q?"":P,type:Q?P.type:"text",imageURL:null,createdAt:fr(),likeCount:0,commentCount:0,...Q?{metadata:{title:P.title||"",subtitle:P.subtitle||"",stats:P.stats||[],quote:P.quote||"",badges:P.badges||[]}}:{}})},[t]),[yt,Vt]=_.useState(null),[Je,At]=_.useState(null),[vt,nn]=_.useState(0),[js,rs]=_.useState(0),[Xt,ne]=_.useState([]),[Ne,xt]=_.useState(""),[bt,it]=_.useState(""),[$e,st]=_.useState(!1),[Fe,sn]=_.useState(0),[on,Ln]=_.useState(!1),[zn,Xn]=_.useState({}),Yt=_.useRef(null),Fn=_.useRef(null),[Cn,ln]=_.useState(0),[yr,oe]=_.useState(0),[Ae,Ge]=_.useState(0),[mt,lt]=_.useState(0),[vn,Nn]=_.useState(0),[dn,bn]=_.useState(0),[Cs,is]=_.useState({beginner:0,intermediate:0,advanced:0}),ds=p?eg:eg.filter(P=>g.includes(P)),Jt=!p&&Cn>=y,[An,Ns]=_.useState([]),[Ar,di]=_.useState(!1),[Rr,Ir]=_.useState({}),[qn,Ks]=_.useState(!1),[_s,kn]=_.useState(!1),[On,as]=_.useState(""),[zt,Qr]=_.useState(null),[Dr,xs]=_.useState([]),[wn,rr]=_.useState({total:0,favouriteFocus:null,streak:0}),[fi,R]=_.useState(null),[z,ae]=_.useState(""),[le,Me]=_.useState(!1);_.useEffect(()=>{!i&&(!s||!e)&&b("/")},[s,e,i,b]),_.useEffect(()=>{if(!s||!t)return;(async()=>{try{const Q=Mt(Se,"workoutLogs"),Z=Dn(Q,fn("clientId","==",t.id)),je=(await Tn(Z)).docs.map(St=>St.data()),Oe=je.filter(St=>St.type!=="programme");lt(Oe.length);const qe=Oe.reduce((St,cn)=>St+(cn.duration||0),0);Nn(qe);const pt={beginner:0,intermediate:0,advanced:0};Oe.forEach(St=>{St.level&&pt[St.level]!==void 0&&pt[St.level]++}),is(pt);const Et=new Date,Pt=Et.getDay(),Qe=Pt===0?-6:1-Pt,Zt=new Date(Et);Zt.setDate(Et.getDate()+Qe),Zt.setHours(0,0,0,0);const Us=Zt.getTime(),Tt=je.filter(St=>{const cn=St.completedAt;return cn?(cn.toDate?cn.toDate().getTime():new Date(cn).getTime())>=Us:!1});ln(Tt.filter(St=>St.type!=="programme").length);let Hn=0;if(t)try{const St=await mr(tt(Se,"clientProgrammes",t.id));if(St.exists()){const cn=St.data(),Rn=cn.templateId;Hn=Tt.filter(fs=>fs.type==="programme"&&fs.programmeId===Rn).length,R(Rn);const Bs=Jp.find(fs=>fs.id===Rn);Bs&&ae(Bs.name);const zs=V3[Rn];if(zs){const fs=Object.keys(cn.completedSessions||{}).length,Ys=zs.duration*zs.daysPerWeek;Ge(Ys>0?Math.round(fs/Ys*100):0)}}else R(null),ae(""),Ge(0)}catch{}oe(Hn);const Jn=Oe.map(St=>St.completedAt).filter(Boolean).map(St=>St.toDate?St.toDate().getTime():new Date(St).getTime()).sort((St,cn)=>cn-St);if(Jn.length===0)bn(0);else{const St=new Set;Jn.forEach(Ys=>{const ir=new Date(Ys),Mi=ir.getDay(),Or=Mi===0?-6:1-Mi,mi=new Date(ir);mi.setDate(ir.getDate()+Or),mi.setHours(0,0,0,0),St.add(mi.getTime())});const cn=[...St].sort((Ys,ir)=>ir-Ys);let Rn=0;const Bs=new Date(Et),zs=Et.getDay()===0?-6:1-Et.getDay();Bs.setDate(Et.getDate()+zs),Bs.setHours(0,0,0,0);let fs=Bs.getTime();cn.includes(fs)||(fs-=10080*60*1e3);for(let Ys=0;Ys<200&&cn.includes(fs);Ys++)Rn++,fs-=10080*60*1e3;bn(Rn)}}catch(Q){console.error("Error loading workout stats:",Q)}finally{Me(!0)}})()},[s,t,E]),_.useEffect(()=>{if(!s||!t)return;(async()=>{try{const Q=Dn(Mt(Se,"savedWorkouts"),fn("clientId","==",t.id)),pe=(await Tn(Q)).docs.map(je=>({id:je.id,...je.data()}));pe.sort((je,Oe)=>{const qe=je.savedAt?.toMillis?.()||je.savedAt?.seconds*1e3||0;return(Oe.savedAt?.toMillis?.()||Oe.savedAt?.seconds*1e3||0)-qe}),Ns(pe)}catch(Q){console.error("Error loading saved workouts:",Q)}finally{di(!0)}})()},[s,t]),_.useEffect(()=>{if(!s||!t)return;(async()=>{try{const Q=Dn(Mt(Se,"workoutLogs"),fn("clientId","==",t.id),wu("completedAt","desc"),_u(20)),je=(await Tn(Q)).docs.map(Tt=>Tt.data()).filter(Tt=>Tt.type!=="programme"&&Tt.type!=="muscle_group");xs(je.slice(0,3));const Oe=je.length,qe={};je.forEach(Tt=>{Tt.focus&&(qe[Tt.focus]=(qe[Tt.focus]||0)+1)});const pt=Object.keys(qe).sort((Tt,Hn)=>qe[Hn]-qe[Tt])[0]||null;let Et=0;if(je.length>0){const Tt=new Set;je.forEach(St=>{const cn=St.completedAt?.toDate?St.completedAt.toDate():St.completedAt?new Date(St.completedAt):null;cn&&Tt.add(new Date(cn.getFullYear(),cn.getMonth(),cn.getDate()).toDateString())});const Hn=new Date;Hn.setHours(0,0,0,0);let Jn=new Date(Hn);for(Tt.has(Jn.toDateString())||Jn.setDate(Jn.getDate()-1);Tt.has(Jn.toDateString());)Et++,Jn.setDate(Jn.getDate()-1)}rr({total:Oe,favouriteFocus:pt,streak:Et});const Pt={core:null,upper:null,lower:null,fullbody:null};je.forEach(Tt=>{if(Tt.focus&&Pt[Tt.focus]===null&&Tt.completedAt){const Hn=Tt.completedAt.toDate?Tt.completedAt.toDate():new Date(Tt.completedAt);Pt[Tt.focus]=Hn}});let Qe=null,Zt=new Date;const Us=["core","upper","lower","fullbody"];for(const Tt of Us){if(Pt[Tt]===null){const Hn=Wr.find(Jn=>Jn.key===Tt)?.label||Tt;Qe={focus:Tt,label:Hn,daysAgo:null,message:`You haven't tried ${Hn} yet`};break}if(Pt[Tt]<Zt){Zt=Pt[Tt];const Hn=Math.floor((Date.now()-Pt[Tt].getTime())/864e5);if(Hn>=5){const Jn=Wr.find(St=>St.key===Tt)?.label||Tt;Qe={focus:Tt,label:Jn,daysAgo:Hn,message:`${Jn}  ${Hn} days ago`}}}}Qr(Qe)}catch(Q){console.error("Error loading recent workouts:",Q)}})()},[s,t,E]);const Le=async P=>{if(!(!s||!t||D.length===0)){Ks(!0);try{const Q=Wr.find(je=>je.key===q)?.label||q,Z=P||`${Q} ${Y}min`,pe=await ri(Mt(Se,"savedWorkouts"),{clientId:t.id,name:Z,equipment:O,focus:q,level:X,duration:Y,exercises:D.map(je=>({name:je.name,videoUrl:je.videoUrl,isGif:je.isGif||!1})),rounds:A,savedAt:Gt.now()});Ns(je=>[{id:pe.id,clientId:t.id,name:Z,equipment:O,focus:q,level:X,duration:Y,exercises:D.map(Oe=>({name:Oe.name,videoUrl:Oe.videoUrl,isGif:Oe.isGif||!1})),rounds:A,savedAt:Gt.now()},...je]),ue("Workout saved!","success")}catch(Q){console.error("Error saving workout:",Q),ue("Failed to save workout","error")}finally{Ks(!1),kn(!1),as("")}}},He=async P=>{try{await jr(tt(Se,"savedWorkouts",P)),Ns(Q=>Q.filter(Z=>Z.id!==P)),ue("Workout removed","info")}catch(Q){console.error("Error deleting saved workout:",Q),ue("Failed to remove workout","error")}},Ft=P=>{H(P.equipment||["bodyweight"]),B(P.focus||"core"),W(P.level||"intermediate"),de(P.duration||15);const Q=_i.find(Z=>Z.key===(P.level||"intermediate"));te(Q),M(P.exercises||[]),Be(P.rounds||2),T("preview")},Ye=async()=>{const P=JSON.parse(localStorage.getItem("mcf_last_randomiser")||"null");H(P?.equipment||["bodyweight"]),B(P?.focus||"core"),W(P?.level||"intermediate"),de(P?.duration||15),setTimeout(()=>Yn(),50)},Kn=()=>{localStorage.setItem("mcf_last_randomiser",JSON.stringify({equipment:O,focus:q,level:X,duration:Y}))};localStorage.getItem("mcf_last_randomiser");const os=()=>{const P=[];let Q;q==="mix"?Q=["core","upper","lower"]:q==="fullbody"?Q=["upper","lower"]:Q=[q];for(const Z of O)for(const pe of Q)P.push(`exercises/${Z}/${pe}`);return P},Vs=async()=>{if(I.current){for(;I.current;)await new Promise(P=>setTimeout(P,200));return V.current}I.current=!0,S(!0);try{const P=os(),Q=[];for(const Oe of P)try{const qe=$a(Wa,Oe),pt=await Uw(qe);Q.push(...pt.items)}catch{console.warn(`Folder ${Oe} not found, skipping.`)}if(Q.length===0&&O.includes("bodyweight")&&q==="core")try{const Oe=$a(Wa,"core"),qe=await Uw(Oe);Q.push(...qe.items)}catch{console.warn("Legacy core/ folder not found either.")}if(Q.length===0){const Oe=O.map(pt=>Zp.find(Et=>Et.key===pt)?.label).join(" + "),qe=Wr.find(pt=>pt.key===q)?.label;return ue(`No exercises found for ${Oe} / ${qe}. Upload videos to Firebase Storage.`,"error"),I.current=!1,S(!1),[]}const Z=new Set,pe=Q.filter(Oe=>{const qe=Oe.name.replace(/\.(mp4|gif)$/i,"");return Z.has(qe)?!1:(Z.add(qe),!0)}),je=await Promise.all(pe.map(async Oe=>{const qe=await Lo(Oe),pt=B3(Oe.name.replace(/\.(mp4|gif)$/i,"")),Et=/\.gif$/i.test(Oe.name);return{name:pt,videoUrl:qe,isGif:Et}}));return V.current=je,ve(je),I.current=!1,S(!1),je}catch(P){console.error("Error loading exercises:",P);const Q=P.code==="storage/unauthorized"?"Storage access denied. Check Firebase Storage rules allow read access.":`Failed to load exercises: ${P.message||P.code||"Unknown error"}`;return ue(Q,"error"),I.current=!1,S(!1),[]}},Yn=async()=>{if(Jt)return;Kn(),T("spinning"),V.current=[];const P=await Vs();if(P.length===0){T("setup");return}const Q=_i.find(Pt=>Pt.key===X);te(Q);const Z=Q.work+Q.rest,pe=Y*60,je=Math.floor(pe/Z);let Oe,qe;je<=6?(Oe=Math.max(3,Math.floor(je/2)),qe=Math.floor(je/Oe)):je<=12?(Oe=Math.min(6,Math.floor(je/2)),qe=Math.floor(je/Oe)):(Oe=Math.min(10,Math.floor(je/2)),qe=Math.floor(je/Oe)),qe=Math.max(2,qe);const pt=z3(P),Et=pt.slice(0,Math.min(Oe,pt.length));M(Et),Be(qe),setTimeout(()=>T("preview"),2e3)},vr=()=>{T("countdown"),ct(3)};_.useEffect(()=>{if(E!=="countdown")return;if(Ke<=0){T("workout"),Ie(1),re(0),ie("work"),ke(Ze.work),Ee(!1),ht();return}Pe();const P=setTimeout(()=>ct(Q=>Q-1),1e3);return()=>clearTimeout(P)},[Ke,E]),_.useEffect(()=>{if(E!=="workout"||Te)return;if(we<=0){fa();return}we<=3&&Pe();const P=setTimeout(()=>ke(Q=>Q-1),1e3);return()=>clearTimeout(P)},[we,E,Te]);const fa=()=>{if(L==="work")ie("rest"),ke(Ze.rest);else{const P=ze+1;if(P>=D.length){const Q=_e+1;if(Q>A){tn(!0),Di();return}Ie(Q),re(0)}else re(P);ie("work"),ke(Ze.work),ht()}},Di=async()=>{if(s)try{await ri(Mt(Se,"workoutLogs"),{clientId:t.id,level:X,duration:Y,equipment:O,focus:q,exerciseCount:D.length,rounds:A,exercises:D.map(P=>P.name),completedAt:Gt.now()}),typeof fbq=="function"&&fbq("trackCustom","WorkoutCompleted",{duration:Y,level:X,focus_area:q,exercise_count:D.length}),ln(P=>P+1),lt(P=>P+1),Nn(P=>P+Y),is(P=>({...P,[X]:(P[X]||0)+1}))}catch(P){console.error("Error saving workout log:",P)}},Mr=async(P,Q,Z)=>{if(!(!t||!Q))try{const pe=t.id,je=await mr(tt(Se,"coreBuddyPBs",pe)),qe=(je.exists()?je.data():null)?.exercises||{},pt=qe[P];let Et=!1;if(pt?(Q>(pt.weight||0)||Q===(pt.weight||0)&&Z>(pt.reps||0))&&(Et=!0):Et=!0,Et){const Pt={...qe,[P]:{weight:Q,reps:Z,achievedAt:Gt.now()}};await Os(tt(Se,"coreBuddyPBs",pe),{clientId:t.id,exercises:Pt,updatedAt:Gt.now()}),ue(`New PB! ${Q}kg  ${Z} reps`,"success"),Pe()}}catch(pe){console.error("Error checking PB:",pe)}},ma=async P=>{if(At(P),P.interval){const pe=[];for(const je of P.exercises){let Oe=null,qe=!1;if(je.storagePath)try{const pt=$a(Wa,je.storagePath);Oe=await Lo(pt),qe=/\.gif$/i.test(je.storagePath)}catch{}pe.push({name:je.name,videoUrl:Oe,isGif:qe})}M(pe),Be(P.rounds),te({work:P.work,rest:P.rest}),T("preview");return}const Q={};for(const pe of P.exercises)if(pe.storagePath)try{const je=$a(Wa,pe.storagePath);Q[pe.name]={url:await Lo(je),isGif:/\.gif$/i.test(pe.storagePath)}}catch{}Xn(Q);const Z=P.exercises.map(pe=>({name:pe.name,type:pe.type,targetSets:pe.sets,targetReps:pe.reps||0,targetTime:pe.time||0,sets:[]}));ne(Z),nn(0),rs(0),xt(""),it(""),Ln(!1),st(!1),sn(0),setMgSessionBadges([]),setMgBadgeCelebration(null),T("muscle_workout")},Lr=()=>{const P=Yt.current;P&&(P.paused?(P.play(),Ln(!0)):(P.pause(),Ln(!1)))};_.useEffect(()=>{if(E!=="muscle_workout"||!$e||Fe<=0){E==="muscle_workout"&&$e&&Fe<=0&&(st(!1),Pe());return}return Fn.current=setTimeout(()=>sn(P=>P-1),1e3),()=>clearTimeout(Fn.current)},[E,$e,Fe]);const C=async()=>{const P=Xt[vt];let Q={};if(P.type==="weighted"){const je=parseFloat(Ne)||0,Oe=parseInt(bt)||0;if(Oe===0){ue("Enter your reps","error");return}Q={weight:je,reps:Oe}}else if(P.type==="reps"){const je=parseInt(bt)||0;if(je===0){ue("Enter your reps","error");return}Q={reps:je}}else if(P.type==="timed"){const je=P.targetTime-Fe;Q={time:Math.max(je,1)}}const Z=[...Xt];Z[vt]={...P,sets:[...P.sets,Q]},ne(Z),P.type==="weighted"&&Q.weight>0&&await Mr(P.name,Q.weight,Q.reps);const pe=P.sets.length+1;if(pe<P.targetSets)rs(pe),it(""),st(!1),sn(0);else if(vt+1<Xt.length){const je=vt+1;nn(je),rs(0),xt(""),it(""),Ln(!1),st(!1),sn(0)}else await G(Z),Un(!0)},G=async P=>{if(!(!s||!t))try{const Q=P.reduce((Z,pe)=>Z+pe.sets.length,0);await ri(Mt(Se,"workoutLogs"),{clientId:t.id,type:"muscle_group",muscleGroup:yt,sessionId:Je?.id,sessionName:Je?.name,exerciseCount:P.length,totalSets:Q,duration:Math.round(Q*1.5),exercises:P.map(Z=>({name:Z.name,type:Z.type,sets:Z.sets})),completedAt:Gt.now()})}catch(Q){console.error("Error saving muscle group workout log:",Q)}},Ce=_.useRef(null),Re=()=>(Ce.current||(Ce.current=new(window.AudioContext||window.webkitAudioContext)),Ce.current),Pe=()=>{try{const P=Re(),Q=P.createOscillator(),Z=P.createGain();Q.connect(Z),Z.connect(P.destination),Q.frequency.value=880,Z.gain.value=.3,Q.start(P.currentTime),Q.stop(P.currentTime+.15)}catch{}},ht=()=>{try{const P=Re(),Q=P.createOscillator(),Z=P.createGain();Q.connect(Z),Z.connect(P.destination),Q.frequency.value=1200,Z.gain.value=.4,Q.start(P.currentTime),Q.stop(P.currentTime+.3)}catch{}};_.useEffect(()=>{if(E!=="workout"||L!=="work"||!D[ze]?.isGif)return;const Q=setInterval(()=>{const Z=gt.current;if(!Z)return;const pe=Z.getAttribute("src");Z.removeAttribute("src"),setTimeout(()=>{gt.current&&gt.current.setAttribute("src",pe)},0)},4e3);return()=>clearInterval(Q)},[E,L,ze,_e,D]);const et=(P,Q,Z)=>{const pe=Math.round(P/Q*P3);return a.jsx("svg",{className:"wk-ring-svg",viewBox:"0 0 200 200",children:Z6.map((je,Oe)=>a.jsx("line",{x1:je.x1,y1:je.y1,x2:je.x2,y2:je.y2,className:Oe<pe?`wk-tick-filled ${Z}`:"wk-tick-empty",strokeWidth:je.thick?"3":"2"},Oe))})},kt=()=>{const P=D.length*A;return((_e-1)*D.length+ze+(L==="rest"?.5:0))/P},dt=ut&&a.jsx("div",{className:`toast-notification ${ut.type}`,children:ut.message});if(i)return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>b("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"wk-loading-inline",children:a.jsx("div",{className:"wk-loading-spinner"})})]});if(E==="menu")return a.jsx(Xo,{children:a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>b("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"wk-menu-heading",children:[a.jsx("h2",{children:"Choose Your Workout"}),a.jsx("p",{children:"No excuses. Just results."})]}),a.jsx("button",{className:"wk-hero-card",onClick:()=>T("randomiser_hub"),children:a.jsx("img",{src:Hw,alt:"Randomise Workout",className:"wk-hero-bg"})}),!p&&a.jsxs("button",{className:"wk-hero-card wk-free-card-premium",onClick:()=>b("/upgrade"),children:[a.jsx("img",{src:$w,alt:"Programmes",className:"wk-hero-bg"}),a.jsx("div",{className:"wk-free-card-overlay"}),a.jsxs("div",{className:"wk-free-card-content",children:[a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{className:"wk-free-card-label",children:"Unlock Full Access"})]})]}),p&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"wk-section-header",children:[a.jsx("h2",{children:"Programmes"}),a.jsxs("span",{className:"wk-section-count",children:[Jp.length," available"]})]}),a.jsx("div",{className:"wk-prog-scroll-wrap",children:a.jsx("div",{className:"wk-prog-scroll",children:Jp.map((P,Q)=>P.image?a.jsxs("button",{className:"wk-prog-img-card",onClick:()=>b("/client/core-buddy/programmes",{state:{templateId:P.id}}),style:{animationDelay:`${Q*.06}s`},children:[a.jsx("img",{src:P.image,alt:P.name,className:"wk-prog-img"}),Q===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},P.id):a.jsxs("button",{className:"wk-prog-hero-card",onClick:()=>b("/client/core-buddy/programmes",{state:{templateId:P.id}}),style:{animationDelay:`${Q*.06}s`},children:[a.jsx("img",{src:$w,alt:"Programme",className:"wk-prog-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-prog-hero-overlay",style:{background:U3[P.focus]}}),a.jsxs("div",{className:"wk-prog-hero-content",children:[a.jsxs("div",{className:"wk-prog-hero-top",children:[a.jsxs("span",{className:"wk-prog-hero-badge",children:[P.duration," WEEKS"]}),a.jsx("span",{className:"wk-prog-hero-level",children:P.level})]}),a.jsxs("div",{className:"wk-prog-hero-bottom",children:[a.jsx("h3",{children:P.name.toUpperCase()}),a.jsxs("p",{children:[P.daysPerWeek,"x per week  ",P.focus==="fullbody"?"Full Body":P.focus.charAt(0).toUpperCase()+P.focus.slice(1)," Focus"]}),a.jsx("span",{className:"wk-prog-hero-go",children:"VIEW PROGRAMME "})]})]}),Q===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},P.id))})})]}),p&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"wk-section-header",children:[a.jsx("h2",{children:"Muscle Groups"}),a.jsxs("span",{className:"wk-section-count",children:[Yc.length," groups"]})]}),a.jsx("div",{className:"wk-muscle-grid",children:Yc.map((P,Q)=>a.jsx("button",{className:`wk-muscle-hero-card${P.image?" wk-muscle-thumb":""}`,onClick:()=>{Vt(P.key),T("muscle_sessions")},style:{animationDelay:`${Q*.05}s`},children:P.image?a.jsx("img",{src:P.image,alt:P.label,className:"wk-muscle-thumb-img"}):a.jsxs(a.Fragment,{children:[a.jsx("img",{src:Hw,alt:"Muscle group",className:"wk-muscle-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-muscle-hero-overlay",style:{background:Xp[P.key]}}),a.jsxs("div",{className:"wk-muscle-hero-content",children:[a.jsx("div",{className:"wk-muscle-hero-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:P.icon})})}),a.jsxs("div",{className:"wk-muscle-hero-text",children:[a.jsx("span",{className:"wk-muscle-hero-name",children:P.label}),a.jsxs("span",{className:"wk-muscle-hero-count",children:[Ww[P.key]?.length||0," sessions"]})]})]})]})},P.key))})]})]}),a.jsx(Ri,{active:"workouts"}),dt]})});if(E==="randomiser_hub"){const P=JSON.parse(localStorage.getItem("mcf_last_randomiser")||"null")||{focus:"core",level:"intermediate",duration:15},Q=Wr.find(pe=>pe.key===P.focus)?.label||P.focus,Z=_i.find(pe=>pe.key===P.level)?.label||P.level;return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>b("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"wk-hub-heading wk-hub-heading-hero",children:[a.jsx("div",{className:"wk-hub-circle-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-hub-circle-logo"})}),a.jsx("h2",{children:"Randomiser"}),a.jsx("p",{children:"Generate, save & replay workouts"})]}),a.jsxs("div",{className:"wk-hub-launch-zone",children:[wn.total>0&&a.jsxs("div",{className:"wk-hub-stats",children:[a.jsxs("div",{className:"wk-hub-stat",children:[a.jsx("span",{className:"wk-hub-stat-value",children:wn.total}),a.jsx("span",{className:"wk-hub-stat-label",children:"Workouts"})]}),wn.streak>0&&a.jsxs("div",{className:"wk-hub-stat",children:[a.jsxs("span",{className:"wk-hub-stat-value",children:[wn.streak,a.jsx("small",{children:"d"})]}),a.jsx("span",{className:"wk-hub-stat-label",children:"Streak"})]}),wn.favouriteFocus&&a.jsxs("div",{className:"wk-hub-stat",children:[a.jsx("span",{className:"wk-hub-stat-value wk-hub-stat-focus",style:{color:dd[wn.favouriteFocus]||"var(--color-primary)"},children:Wr.find(pe=>pe.key===wn.favouriteFocus)?.label||wn.favouriteFocus}),a.jsx("span",{className:"wk-hub-stat-label",children:"Top Focus"})]})]}),a.jsxs("div",{className:"wk-hub-actions",children:[a.jsxs("button",{className:"wk-hub-action-btn wk-hub-new wk-hub-new-glow",onClick:()=>T("setup"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"New Workout"]}),a.jsxs("button",{className:"wk-hub-action-btn wk-hub-quick",onClick:Ye,disabled:Jt,children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})}),"Quick Start",a.jsxs("span",{className:"wk-hub-quick-meta",children:[Q,"  ",Z,"  ",P.duration,"min"]})]})]}),zt&&a.jsxs("button",{className:"wk-hub-suggestion",onClick:()=>{B(zt.focus),T("setup")},children:[a.jsx("svg",{className:"wk-hub-suggestion-bulb",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),a.jsxs("div",{className:"wk-hub-suggestion-info",children:[a.jsx("span",{className:"wk-hub-suggestion-label",children:zt.message}),a.jsx("span",{className:"wk-hub-suggestion-cta",children:"Tap to set up "})]}),a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"wk-hub-tip",children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),Gw[Math.floor(Date.now()/864e5)%Gw.length]]})]}),p&&a.jsxs("div",{className:"wk-hub-section wk-hub-section--saved",children:[a.jsxs("h3",{className:"wk-hub-section-title",children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Saved Workouts",An.length>0&&a.jsx("span",{className:"wk-hub-count",children:An.length})]}),Ar?An.length===0?a.jsxs("div",{className:"wk-hub-empty wk-hub-empty-enhanced",children:[a.jsx("svg",{className:"wk-hub-empty-icon",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),a.jsx("p",{children:a.jsx("strong",{children:"No saved workouts yet"})}),a.jsx("p",{className:"wk-hub-empty-sub",children:"Generate a workout and hit save to stash it here for quick replay."})]}):a.jsx("div",{className:"wk-hub-saved-categories",children:Wr.map(pe=>{const je=An.filter(qe=>qe.focus===pe.key);if(je.length===0)return null;const Oe=Rr[pe.key]||!1;return a.jsxs("div",{className:"wk-hub-saved-cat",children:[a.jsxs("button",{className:`wk-hub-saved-cat-header${Oe?" wk-hub-saved-cat-open":""}`,style:{"--cat-color":dd[pe.key]||"var(--color-primary)"},onClick:()=>Ir(qe=>({...qe,[pe.key]:!qe[pe.key]})),children:[a.jsxs("span",{className:"wk-hub-saved-cat-label",children:[a.jsx("span",{className:"wk-hub-focus-pill",style:{"--pill-color":dd[pe.key]||"var(--color-primary)"},children:pe.label}),a.jsx("span",{className:"wk-hub-saved-cat-count",children:je.length})]}),a.jsx("svg",{className:`wk-hub-saved-cat-chevron${Oe?" wk-hub-saved-cat-chevron-open":""}`,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),Oe&&a.jsx("div",{className:"wk-hub-saved-list",children:je.map((qe,pt)=>{const Et=(qe.equipment||[]).map(Qe=>Zp.find(Zt=>Zt.key===Qe)?.label||Qe).join(", "),Pt=_i.find(Qe=>Qe.key===qe.level)?.label||qe.level;return a.jsxs("div",{className:"wk-hub-saved-card",style:{animationDelay:`${pt*.05}s`},children:[a.jsxs("button",{className:"wk-hub-saved-main",onClick:()=>Ft(qe),children:[a.jsxs("div",{className:"wk-hub-saved-info",children:[a.jsx("span",{className:"wk-hub-saved-name",children:qe.name}),a.jsx("span",{className:"wk-hub-saved-tags",children:a.jsxs("span",{className:"wk-hub-saved-meta",children:[Pt,"  ",qe.duration,"min  ",(qe.exercises||[]).length," ex"]})}),Et&&a.jsx("span",{className:"wk-hub-saved-equip",children:Et})]}),a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]}),a.jsx("button",{className:"wk-hub-saved-delete",onClick:()=>He(qe.id),"aria-label":"Remove saved workout",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("polyline",{points:"3 6 5 6 21 6"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]},qe.id)})})]},pe.key)})}):a.jsx("div",{className:"wk-hub-empty",children:a.jsx("div",{className:"wk-loading-spinner"})})]}),a.jsxs("div",{className:"wk-hub-section wk-hub-section--recent",children:[a.jsxs("h3",{className:"wk-hub-section-title",children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("polyline",{points:"12 6 12 12 16 14"})]}),"Recent"]}),Dr.length===0?a.jsxs("div",{className:"wk-hub-empty wk-hub-empty-enhanced",children:[a.jsxs("svg",{className:"wk-hub-empty-icon",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("polyline",{points:"12 6 12 12 16 14"})]}),a.jsx("p",{children:a.jsx("strong",{children:"No workouts yet"})}),a.jsx("p",{className:"wk-hub-empty-sub",children:"Complete your first workout to see your history here."})]}):a.jsx("div",{className:"wk-hub-recent-list",children:Dr.map((pe,je)=>{const Oe=Wr.find(Pt=>Pt.key===pe.focus)?.label||pe.focus||"",qe=_i.find(Pt=>Pt.key===pe.level)?.label||pe.level||"",pt=pe.completedAt?.toDate?pe.completedAt.toDate():pe.completedAt?new Date(pe.completedAt):null,Et=pt?(()=>{const Pt=Math.floor((Date.now()-pt.getTime())/1e3);return Pt<3600?`${Math.floor(Pt/60)}m ago`:Pt<86400?`${Math.floor(Pt/3600)}h ago`:`${Math.floor(Pt/86400)}d ago`})():"";return a.jsxs("button",{className:"wk-hub-recent-card",style:{animationDelay:`${je*.05}s`},onClick:()=>{B(pe.focus||"core"),W(pe.level||"intermediate"),de(pe.duration||15),pe.equipment&&H(pe.equipment),T("setup")},children:[a.jsx("div",{className:"wk-hub-recent-info",children:a.jsxs("span",{className:"wk-hub-recent-tags",children:[a.jsx("span",{className:"wk-hub-focus-pill",style:{"--pill-color":dd[pe.focus]||"var(--color-primary)"},children:Oe}),a.jsxs("span",{className:"wk-hub-recent-meta",children:[qe,"  ",pe.duration||"?","min  ",pe.exerciseCount||"?"," ex"]})]})}),a.jsxs("div",{className:"wk-hub-recent-action",children:[a.jsx("span",{className:"wk-hub-recent-time",children:Et}),a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]})]},je)})})]})]}),a.jsx(Ri,{active:"workouts"}),dt]})}if(E==="setup"){const P=Wr.find(Z=>Z.key===q)?.label||q,Q=_i.find(Z=>Z.key===X)?.label||X;return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>T("randomiser_hub"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main wk-setup-main",children:[a.jsx("div",{className:"wk-stats-row",children:[{label:"Total",value:`${mt}`,pct:mt>0?Math.min(Math.round(mt/100*100),100):0,color:"#14b8a6",size:"normal"},{label:"This Week",value:`${Cn}/${Qp}`,pct:Math.round(Math.min(Cn,Qp)/Qp*100),color:"var(--color-primary)",size:"large"},{label:"Wk Streak",value:`${dn}`,pct:dn>0?Math.min(Math.round(dn/12*100),100):0,color:"#38B6FF",size:"normal"}].map(Z=>{const je=2*Math.PI*38,Oe=je-Z.pct/100*je;return a.jsxs("div",{className:`wk-stat-item${Z.size==="large"?" wk-stat-large":""}`,children:[a.jsxs("div",{className:"wk-stat-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"wk-stat-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"wk-stat-fill",cx:"50",cy:"50",r:38,style:{stroke:Z.color},strokeDasharray:je,strokeDashoffset:Oe})]}),a.jsx("span",{className:"wk-stat-value",style:{color:Z.color},children:Z.value})]}),a.jsx("span",{className:"wk-stat-label",children:Z.label})]},Z.label)})}),a.jsxs("div",{className:"wk-setup-flow",children:[a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Focus Area"}),a.jsx("div",{className:"wk-focus-grid",children:Wr.map(Z=>a.jsxs("button",{className:`wk-equip-btn${q===Z.key?" active":""}${Z.key==="mix"?" wk-mix-btn":""}`,onClick:()=>{Pe(),B(Z.key)},children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:Z.icon})}),a.jsx("span",{children:Z.label})]},Z.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Level"}),a.jsx("div",{className:"wk-level-cards",children:_i.map(Z=>a.jsxs("button",{className:`wk-level-card wk-level-${Z.key}${X===Z.key?" active":""}`,onClick:()=>{Pe(),W(Z.key)},children:[a.jsx("span",{className:"wk-level-name",children:Z.label}),a.jsx("span",{className:"wk-level-desc",children:Z.desc})]},Z.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Time"}),a.jsx("div",{className:"wk-time-options",children:eg.map(Z=>{const pe=!ds.includes(Z);return a.jsxs("button",{className:`wk-time-btn${Y===Z?" active":""}${pe?" locked":""}`,onClick:()=>{pe||(Pe(),de(Z))},disabled:pe,children:[a.jsx("span",{className:"wk-time-num",children:Z}),a.jsx("span",{className:"wk-time-unit",children:pe?a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}):"min"})]},Z)})})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Equipment"}),a.jsx("div",{className:"wk-equip-options",children:Zp.map(Z=>{const pe=O.includes(Z.key);return a.jsxs("button",{className:`wk-equip-btn${pe?" active":""}`,onClick:()=>{pe&&O.length===1||(Pe(),H(je=>pe&&je.length===1?je:pe?je.filter(Oe=>Oe!==Z.key):[...je,Z.key]))},children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:Z.icon})}),a.jsx("span",{children:Z.label})]},Z.key)})})]}),a.jsx("div",{className:"wk-setup-summary",children:a.jsxs("span",{children:[P,"  ",Q,"  ",Y," min"]})})]})]}),a.jsxs("div",{className:"wk-go-sticky",children:[Jt&&a.jsx("p",{className:"wk-free-limit-msg",children:"You've used your free workout this week. Upgrade for unlimited access."}),a.jsx("button",{className:"wk-randomise-btn",onClick:Yn,disabled:j||Jt,children:j?"Loading exercises...":Jt?"Limit Reached":"Randomise Workout"})]}),dt]})}if(E==="spinning")return a.jsxs("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":h,children:[a.jsxs("div",{className:"wk-spin-container",children:[a.jsxs("div",{className:"wk-spin-ring",children:[a.jsx("svg",{className:"wk-spin-svg",viewBox:"0 0 200 200",children:J6.map((P,Q)=>a.jsx("line",{x1:P.x1,y1:P.y1,x2:P.x2,y2:P.y2,className:"wk-spin-tick",strokeWidth:P.thick?"3.5":"2",style:{animationDelay:`${Q*.03}s`}},Q))}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-spin-logo",width:"50",height:"50"})]}),a.jsx("p",{className:"wk-spin-text",children:"Generating workout..."})]}),dt]});if(E==="preview"){const P=Je?.interval?{work:Je.work,rest:Je.rest}:_i.find(Z=>Z.key===X),Q=D.length*A*(P.work+P.rest);return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>T(Je?.interval?"muscle_sessions":"setup"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[Je?.interval&&a.jsx("h2",{className:"mg-preview-title",children:Je.name}),a.jsxs("div",{className:"wk-preview-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:D.length}),a.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:A}),a.jsx("span",{className:"wk-stat-label",children:"Rounds"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.ceil(Q/60)}),a.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsxs("span",{className:"wk-stat-val",children:[P.work,"/",P.rest]}),a.jsx("span",{className:"wk-stat-label",children:"Work/Rest"})]})]}),a.jsx("div",{className:"wk-preview-list",children:D.map((Z,pe)=>a.jsxs("div",{className:"wk-preview-item",style:{animationDelay:`${pe*.06}s`},onClick:()=>rt(Z),children:[a.jsx("span",{className:"wk-preview-num",children:pe+1}),a.jsx("div",{className:"wk-preview-thumb",children:Z.isGif?a.jsx("img",{src:Z.videoUrl,alt:Z.name,loading:"lazy"}):a.jsx("video",{src:`${Z.videoUrl}#t=0.1`,muted:!0,playsInline:!0,preload:"auto"})}),a.jsx("span",{className:"wk-preview-name",children:Z.name}),a.jsx("svg",{className:"wk-preview-play",width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]},pe))}),Lt&&a.jsx("div",{className:"wk-preview-modal-backdrop",onClick:()=>rt(null),children:a.jsxs("div",{className:"wk-preview-modal",onClick:Z=>Z.stopPropagation(),children:[a.jsx("button",{className:"wk-preview-modal-close",onClick:()=>rt(null),"aria-label":"Close preview",children:a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),a.jsx("div",{className:"wk-preview-modal-video",children:Lt.isGif?a.jsx("img",{src:Lt.videoUrl,alt:Lt.name}):a.jsx("video",{src:Lt.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}),a.jsx("h3",{className:"wk-preview-modal-title",children:Lt.name})]})}),a.jsxs("div",{className:"wk-preview-actions",children:[!Je?.interval&&a.jsxs("div",{className:"wk-preview-actions-row",children:[a.jsxs("button",{className:"wk-btn-secondary wk-btn-half",onClick:()=>Yn(),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"1 4 1 10 7 10"}),a.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),"Reshuffle"]}),p&&a.jsxs("button",{className:"wk-btn-secondary wk-btn-half",onClick:()=>kn(!0),disabled:qn,children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Save"]})]}),a.jsx("button",{className:"wk-btn-primary wk-btn-full",onClick:vr,children:"Start Workout"})]}),_s&&a.jsx("div",{className:"wk-save-modal-backdrop",onClick:()=>kn(!1),children:a.jsxs("div",{className:"wk-save-modal",onClick:Z=>Z.stopPropagation(),children:[a.jsx("h3",{children:"Save Workout"}),a.jsx("p",{children:"Give this workout a name (or leave blank for auto-name)"}),a.jsx("input",{type:"text",className:"wk-save-input",value:On,onChange:Z=>as(Z.target.value),placeholder:`${Wr.find(Z=>Z.key===q)?.label||q} ${Y}min`,maxLength:40,autoFocus:!0}),a.jsxs("div",{className:"wk-save-modal-actions",children:[a.jsx("button",{className:"wk-btn-secondary",onClick:()=>kn(!1),children:"Cancel"}),a.jsx("button",{className:"wk-btn-primary",onClick:()=>Le(On),disabled:qn,children:qn?"Saving...":"Save"})]})]})})]})]})}if(E==="countdown")return a.jsx("div",{className:"wk-page wk-page-center wk-page-dark","data-theme":l?"dark":"light","data-accent":h,children:a.jsxs("div",{className:"wk-countdown-big",children:[a.jsx("span",{className:"wk-countdown-num",children:Ke}),a.jsx("span",{className:"wk-countdown-label",children:"GET READY"})]})});if(E==="workout"){const P=D[ze],Q=L==="work"?Ze.work:Ze.rest,Z=L==="rest"?ze+1<D.length?D[ze+1]:_e<A?D[0]:null:null;return a.jsxs("div",{className:"wk-page wk-page-workout","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("div",{className:"wk-video-container",children:L==="work"?P.isGif?a.jsx("img",{ref:gt,className:"wk-video",src:P.videoUrl,alt:P.name},P.videoUrl):a.jsx("video",{className:"wk-video",src:P.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0},P.videoUrl):a.jsxs("div",{className:"wk-rest-screen",children:[a.jsx("span",{className:"wk-rest-label",children:"REST"}),Z&&a.jsxs("span",{className:"wk-next-label",children:["Next: ",Z.name]})]})}),a.jsx("div",{className:"wk-back-row",children:a.jsxs("button",{className:"wk-back-btn",onClick:()=>{confirm("Leave workout?")&&T("randomiser_hub")},children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]})}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"wk-exercise-info",children:[a.jsxs("span",{className:"wk-exercise-counter",children:[ze+1," / ",D.length]}),a.jsx("h2",{className:"wk-exercise-name",children:P.name}),a.jsxs("span",{className:"wk-round-label",children:["Round ",_e," of ",A]})]}),a.jsx("div",{className:"wk-timer-section",children:a.jsxs("div",{className:"wk-timer-ring-wrap",children:[et(we,Q,L==="work"?"wk-tick-work":"wk-tick-rest"),a.jsxs("div",{className:"wk-timer-center",children:[a.jsx("span",{className:"wk-timer-time",children:we}),a.jsx("span",{className:`wk-timer-phase ${L}`,children:L==="work"?"WORK":"REST"})]})]})}),a.jsxs("div",{className:"wk-controls",children:[a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-stop",onClick:()=>{confirm("End workout early?")&&T("randomiser_hub")},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-pause",onClick:()=>Ee(!Te),children:Te?a.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}):a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),a.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-skip",onClick:()=>{ke(0)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("polygon",{points:"5 4 15 12 5 20 5 4"}),a.jsx("rect",{x:"15",y:"4",width:"4",height:"16"})]})})]}),a.jsx("div",{className:"wk-progress-bar",children:a.jsx("div",{className:"wk-progress-fill",style:{width:`${kt()*100}%`}})}),Ve&&(()=>{const pe=_i.find(Oe=>Oe.key===X),je=D.length*A*(pe.work+pe.rest);return a.jsxs(a.Fragment,{children:[a.jsx(Fg,{title:"Workout Complete!",stats:[{value:Math.ceil(je/60),label:"Minutes"},{value:D.length*A,label:"Intervals"},{value:A,label:"Rounds"}],hideShare:!p,onShareJourney:t?Rt:null,userName:t?.name,onDismissStart:()=>T("randomiser_hub"),onDone:()=>{tn(!1),At(null),Vt(null)}}),!Je?.interval&&a.jsxs("button",{className:"wk-complete-save-btn",onClick:()=>kn(!0),disabled:qn,children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Save This Workout"]}),_s&&a.jsx("div",{className:"wk-save-modal-backdrop",onClick:()=>kn(!1),style:{zIndex:10001},children:a.jsxs("div",{className:"wk-save-modal",onClick:Oe=>Oe.stopPropagation(),children:[a.jsx("h3",{children:"Save Workout"}),a.jsx("p",{children:"Give this workout a name (or leave blank for auto-name)"}),a.jsx("input",{type:"text",className:"wk-save-input",value:On,onChange:Oe=>as(Oe.target.value),placeholder:`${Wr.find(Oe=>Oe.key===q)?.label||q} ${Y}min`,maxLength:40,autoFocus:!0}),a.jsxs("div",{className:"wk-save-modal-actions",children:[a.jsx("button",{className:"wk-btn-secondary",onClick:()=>kn(!1),children:"Cancel"}),a.jsx("button",{className:"wk-btn-primary",onClick:()=>Le(On),disabled:qn,children:qn?"Saving...":"Save"})]})]})})]})})()]})}if(E==="muscle_sessions"){const P=Yc.find(Z=>Z.key===yt),Q=Ww[yt]||[];return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>T("randomiser_hub"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"mg-sessions-header",children:[a.jsx("div",{className:"mg-sessions-icon",style:{background:Xp[yt]},children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:P?.icon})})}),a.jsxs("h2",{children:[P?.label," Workouts"]}),a.jsxs("p",{children:[Q.length," sessions available"]})]}),a.jsx("div",{className:"mg-sessions-list",children:Q.map((Z,pe)=>a.jsxs("button",{className:"mg-session-card",onClick:()=>{At(Z),T("muscle_overview")},style:{animationDelay:`${pe*.08}s`},children:[a.jsxs("div",{className:"mg-session-info",children:[a.jsx("h3",{children:Z.name}),a.jsx("p",{children:Z.desc}),a.jsx("div",{className:"mg-session-meta",children:Z.interval?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-interval",children:"Interval"}),a.jsxs("span",{className:"mg-session-tag",children:[Z.exercises.length," exercises"]}),a.jsxs("span",{className:"mg-session-tag",children:[Z.rounds," rounds"]})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-strength",children:"Strength"}),a.jsxs("span",{className:"mg-session-tag",children:[Z.exercises.length," exercises"]}),a.jsx("span",{className:"mg-session-tag",children:(()=>{const je=Z.exercises.map(pt=>pt.sets||0),Oe=Math.min(...je),qe=Math.max(...je);return Oe===qe?`${Oe} sets each`:`${Oe}-${qe} sets each`})()})]})})]}),a.jsx("div",{className:"mg-session-arrow",children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},Z.id))})]}),dt]})}if(E==="muscle_overview"){const P=Je;if(!P)return null;const Q=Yc.find(Z=>Z.key===yt);return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>T("muscle_sessions"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main mg-overview-main",children:[a.jsx("div",{className:"mg-overview-hero",style:P.image?void 0:{background:Xp[yt]},children:P.image?a.jsx("img",{src:P.image,alt:P.name,className:"mg-overview-hero-img"}):a.jsx("div",{className:"mg-overview-hero-content",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"mg-overview-hero-icon",children:a.jsx("path",{d:Q?.icon})})})}),a.jsxs("div",{className:"mg-overview-header",children:[a.jsxs("div",{className:"mg-overview-title-row",children:[a.jsx("h2",{children:P.name}),P.level&&a.jsx("span",{className:"mg-overview-level",children:P.level})]}),a.jsx("p",{className:"mg-overview-desc",children:P.desc})]}),P.overview&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"About This Workout"]}),a.jsx("p",{children:P.overview})]}),P.tips&&P.tips.length>0&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Tips & Form"]}),a.jsx("ul",{className:"mg-overview-tips",children:P.tips.map((Z,pe)=>a.jsx("li",{children:Z},pe))})]}),a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"}),a.jsx("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),a.jsx("path",{d:"M9 14l2 2 4-4"})]}),"Exercises (",P.exercises.length,")"]}),a.jsx("div",{className:"mg-overview-exercises",children:P.exercises.map((Z,pe)=>a.jsxs("div",{className:"mg-overview-exercise",children:[a.jsx("span",{className:"mg-overview-ex-num",children:pe+1}),a.jsxs("div",{className:"mg-overview-ex-info",children:[a.jsx("span",{className:"mg-overview-ex-name",children:Z.name}),P.interval?a.jsxs("span",{className:"mg-overview-ex-detail",children:[P.work,"s work / ",P.rest,"s rest"]}):a.jsxs("span",{className:"mg-overview-ex-detail",children:[Z.sets," sets  ",Z.reps?`${Z.reps} reps`:`${Z.time}s`,Z.type==="weighted"&&"  weighted"]})]})]},pe))})]}),a.jsxs("button",{className:"mg-overview-start-btn",onClick:()=>ma(P),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Workout"]})]}),dt]})}if(E==="muscle_workout"){const P=Je;if(!P)return null;const Q=P.exercises[vt],Z=Xt[vt];if(!Q||!Z)return null;const pe=Z.sets.length,je=P.exercises.length,Oe=P.exercises.reduce((Qe,Zt)=>Qe+(Zt.sets||0),0),pt=Xt.reduce((Qe,Zt)=>Qe+Zt.sets.length,0)/Oe*100,Et=zn[Q.name];Q.type==="timed"&&Fe===0&&!$e&&pe===js&&setTimeout(()=>sn(Q.time),0);const Pt=pe+1<Q.sets?"Log Set":vt+1<je?"Log Set  Next Exercise":"Log Set  Complete";return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("div",{className:"mg-session-progress",children:a.jsx("div",{className:"mg-session-progress-fill",style:{width:`${pt}%`}})}),a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>{confirm("End workout early?")&&T("muscle_overview")},"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsxs("span",{className:"mg-header-info",children:["Exercise ",vt+1,"/",je]}),a.jsx("div",{style:{width:22}})]})}),a.jsxs("main",{className:"wk-main",children:[Et?a.jsxs("div",{className:"mg-video-container",onClick:Lr,children:[Et.isGif?a.jsx("img",{className:"mg-video",src:Et.url,alt:Q.name}):a.jsx("video",{ref:Yt,className:"mg-video",src:Et.url,loop:!0,muted:!0,playsInline:!0},Q.name),!on&&!Et.isGif&&a.jsxs("div",{className:"mg-video-overlay",children:[a.jsx("svg",{className:"mg-play-icon",width:"48",height:"48",viewBox:"0 0 24 24",fill:"rgba(255,255,255,0.9)",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),a.jsx("span",{className:"mg-video-hint",children:"Tap for demo"})]})]}):a.jsxs("div",{className:"mg-video-placeholder",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.4",children:[a.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),a.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),a.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),a.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),a.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),a.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),a.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),a.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"})]}),a.jsx("span",{children:"Video coming soon"})]}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"mg-exercise-card",children:[a.jsx("h2",{className:"mg-ex-name",children:Q.name}),a.jsx("span",{className:`mg-ex-type-badge ${Q.type}`,children:Q.type==="weighted"?"Weight + Reps":Q.type==="reps"?"Reps Only":"Timed"}),a.jsxs("div",{className:"mg-ex-set-info",children:[a.jsxs("span",{className:"mg-ex-set-num",children:["Set ",pe+1," of ",Q.sets]}),Q.type!=="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",Q.reps," reps"]}),Q.type==="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",Q.time,"s"]})]}),Q.type==="weighted"&&a.jsxs("div",{className:"mg-input-area",children:[a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",className:"mg-input",value:Ne,onChange:Qe=>xt(Qe.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:bt,onChange:Qe=>it(Qe.target.value),placeholder:"0"})]})]}),Q.type==="reps"&&a.jsx("div",{className:"mg-input-area",children:a.jsxs("div",{className:"mg-input-group mg-input-single",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:bt,onChange:Qe=>it(Qe.target.value),placeholder:"0"})]})}),Q.type==="timed"&&a.jsxs("div",{className:"mg-timer-area",children:[a.jsx("div",{className:"mg-timer-display",children:a.jsxs("span",{className:"mg-timer-value",children:[Fe,"s"]})}),$e?a.jsx("button",{className:"mg-timer-btn mg-timer-stop",onClick:()=>st(!1),children:"Stop"}):a.jsx("button",{className:"mg-timer-btn",onClick:()=>{Fe===0&&sn(Q.time),st(!0)},children:Fe<Q.time&&Fe>0?"Resume":"Start Timer"})]}),a.jsx("button",{className:"mg-log-set-btn",onClick:C,children:Pt}),Z.sets.length>0&&a.jsx("div",{className:"mg-completed-sets",children:Z.sets.map((Qe,Zt)=>a.jsxs("div",{className:"mg-completed-set",children:[a.jsx("span",{className:"mg-completed-set-check",children:""}),a.jsxs("span",{children:["Set ",Zt+1,": ",Qe.weight!=null?`${Qe.weight}kg  ${Qe.reps}`:Qe.reps!=null?`${Qe.reps} reps`:`${Qe.time}s`]})]},Zt))})]})]}),dt,jn&&(()=>{const Qe=Xt.reduce((Tt,Hn)=>Tt+Hn.sets.length,0),Zt=Yc.find(Tt=>Tt.key===yt)?.label||"",Us=[{value:Xt.length,label:"Exercises"},{value:Qe,label:"Sets"}];return a.jsx(Fg,{title:`${Zt} Complete!`,subtitle:Je?.name,stats:Us,hideShare:!p,onShareJourney:t?Rt:null,userName:t?.name,onDismissStart:()=>T("randomiser_hub"),onDone:()=>{Un(!1),At(null),Vt(null)}})})()]})}return null}const q3=[{key:"trained",label:"Trained",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4",color:"#A12F3A",darkColor:"#E8475A"},{key:"protein",label:"Hit Protein",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z",color:"#4caf50",darkColor:"#5CDB61"},{key:"steps",label:"10k Steps",icon:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20M4 12.5A2.5 2.5 0 0 1 6.5 10H20M4 5.5A2.5 2.5 0 0 1 6.5 3H20",color:"#ff9800",darkColor:"#FFB020"},{key:"sleep",label:"8hrs Sleep",icon:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",color:"#7c3aed",darkColor:"#9B5AF2"},{key:"water",label:"2L Water",icon:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z",color:"#2196f3",darkColor:"#42A5F5"}],H3="M12 2l2.4 7.2L22 12l-7.6 2.8L12 22l-2.4-7.2L2 12l7.6-2.8z",$3="#e91e63",W3="#FF4D88",G3=700,qg=42,Al=2*Math.PI*qg,fd=["Every day counts. See you tomorrow!","Consistency is your superpower.","Perfect day  keep the streak alive!","You showed up for yourself today."];function K3(s){const e=new Date(s),t=e.getDay(),i=t===0?-6:1-t;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function jo(s){return s.toISOString().split("T")[0]}function Y3(s){return Array.from({length:7},(e,t)=>{const i=new Date(s);return i.setDate(s.getDate()+t),i})}function Q3(){const{currentUser:s,isClient:e,clientData:t,loading:i}=hi(),{isDark:l,toggleTheme:u,accent:h}=ao(),{isPremium:p,FREE_HABIT_LIMIT:g}=Bu(),y=gr(),[b,E]=_.useState({}),[T,O]=_.useState([]),[H,q]=_.useState(!0),[B,X]=_.useState(!1),[W,Y]=_.useState(0),[de,xe]=_.useState(null),[ve,j]=_.useState(null),[S,I]=_.useState(!1),[V,D]=_.useState(!1),[M,A]=_.useState(!1),[Be,Ze]=_.useState(!1),[te,_e]=_.useState(""),[Ie,ze]=_.useState(null),[re,L]=_.useState([]),[ie,we]=_.useState(null),ke=_.useRef(null),Te=_.useRef(null),Ee=_.useRef(null),Ke=_.useRef(null),ct=_.useRef(!1),Ve=_.useRef({}),tn=_.useRef([]),jn=_.useRef([]),Un=_.useRef(null),Lt=_.useRef(fd[Math.floor(Math.random()*fd.length)]),rt=_.useCallback((oe,Ae="info")=>{xe({message:oe,type:Ae}),setTimeout(()=>xe(null),3e3)},[]),gt=new Date,ut=jo(gt),Bn=K3(gt),ue=Y3(Bn),Rt=["M","T","W","T","F","S","S"],yt=(oe,Ae)=>l&&Ae?Ae:oe,Vt=[...q3.filter(oe=>!re.includes(oe.key)).map(oe=>({...oe,color:yt(oe.color,oe.darkColor)})),...T.map(oe=>({key:`custom_${oe.id}`,label:oe.label,icon:H3,color:yt($3,W3),isCustom:!0,id:oe.id}))],Je=p?Vt:Vt.slice(0,g);_.useEffect(()=>{!i&&(!s||!e)&&y("/")},[s,e,i,y]),_.useEffect(()=>{if(!s||!t)return;(async()=>{try{const Ae=Mt(Se,"habitLogs"),Ge=Dn(Ae,fn("clientId","==",t.id)),mt=await Tn(Ge),lt={};mt.docs.forEach(bn=>{const Cs=bn.data();lt[Cs.date]={...Cs,_id:bn.id}}),E(lt);const vn=await mr(tt(Se,"customHabits",t.id));if(vn.exists()){const bn=vn.data();O(bn.habits||[]),L(bn.hiddenDefaults||[])}let Nn=0;const dn=new Date(gt);for(;;){const bn=jo(dn),Cs=lt[bn];if(Cs)if(Object.values(Cs.habits||{}).filter(Boolean).length>=3)Nn++,dn.setDate(dn.getDate()-1);else break;else if(bn===ut)dn.setDate(dn.getDate()-1);else break}Y(Nn)}catch(Ae){console.error("Error loading habit logs:",Ae)}finally{q(!1)}})()},[s,t]);const At=b[ut]||{habits:{}};_.useEffect(()=>{Object.values(At.habits||{}).filter(Boolean).length<Je.length&&M&&A(!1)},[Je.length,At.habits]);const vt=async oe=>{if(!(!s||B||At.habits?.[oe])){tn.current=[...Array(10)].map((Ge,mt)=>{const lt=mt/10*2*Math.PI,vn=18+Math.random()*20;return{tx:Math.cos(lt)*vn,ty:Math.sin(lt)*vn,size:3+Math.random()*4,duration:.4+Math.random()*.3}}),j(oe),setTimeout(()=>j(null),700),navigator.vibrate&&navigator.vibrate(50),X(!0);try{const mt={...At.habits||{},[oe]:!0},lt=At._id||`${t.id}_${ut}`;E(Nn=>({...Nn,[ut]:{clientId:t.id,date:ut,habits:mt,_id:lt}})),await Os(tt(Se,"habitLogs",lt),{clientId:t.id,date:ut,habits:mt}),Object.values(mt).filter(Boolean).length===Je.length&&!M&&(Lt.current=fd[Math.floor(Math.random()*fd.length)],jn.current=[...Array(80)].map((Nn,dn)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#4caf50","#ff9800","#2196f3","#e91e63","#ffeb3b","#FFD700","#ffffff","#9c27b0"][dn%9],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:dn%3})),setTimeout(()=>{I(!0),A(!0),setTimeout(()=>Un.current?.focus(),1100)},400))}catch(Ge){console.error("Error saving habit:",Ge),rt("Failed to save. Try again.","error"),E(mt=>({...mt,[ut]:{...mt[ut],habits:{...mt[ut]?.habits||{},[oe]:!1}}}))}finally{X(!1)}}},nn=async oe=>{if(!(!s||B)){X(!0);try{const Ge={...At.habits||{},[oe]:!1},mt=At._id||`${t.id}_${ut}`;await Os(tt(Se,"habitLogs",mt),{clientId:t.id,date:ut,habits:Ge}),E(lt=>({...lt,[ut]:{clientId:t.id,date:ut,habits:Ge,_id:mt}}))}catch(Ae){console.error("Error undoing habit:",Ae),rt("Failed to undo. Try again.","error")}finally{X(!1)}}},js=oe=>{if(At.habits?.[oe]||!1||B||Ke.current)return;Ke.current=oe,we(oe),Te.current=performance.now();const Ge=Ve.current[oe];Ge&&(Ge.style.strokeDashoffset=Al);const mt=lt=>{const vn=lt-Te.current,Nn=Math.min(vn/G3,1),dn=Ve.current[oe];dn&&(dn.style.strokeDashoffset=Al-Nn*Al),Nn<1?Ee.current=requestAnimationFrame(mt):(Ke.current=null,ct.current=!0,Ee.current=null,we(null),vt(oe))};Ee.current=requestAnimationFrame(mt)},rs=()=>{if(!Ke.current)return;const oe=Ke.current;Ke.current=null,Ee.current&&(cancelAnimationFrame(Ee.current),Ee.current=null),ke.current&&(clearTimeout(ke.current),ke.current=null),Ve.current[oe]&&(Ve.current[oe].style.strokeDashoffset=Al),we(null),Te.current=null};_.useEffect(()=>()=>{Ee.current&&cancelAnimationFrame(Ee.current),ke.current&&clearTimeout(ke.current)},[]);const Xt=_.useCallback(async oe=>{if(!t)throw new Error("Not signed in");const Ae=oe&&typeof oe=="object"&&oe.type;await ri(Mt(Se,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Ae?"":oe,type:Ae?oe.type:"text",imageURL:null,createdAt:fr(),likeCount:0,commentCount:0,...Ae?{metadata:{title:oe.title||"",subtitle:oe.subtitle||"",stats:oe.stats||[],quote:oe.quote||"",badges:oe.badges||[]}}:{}})},[t]),ne=async()=>{const oe=te.trim();if(!oe)return;if(!t?.id){rt("Still loading, try again","error");return}const Ae=Date.now().toString(36),Ge=[...T,{id:Ae,label:oe}];try{await Os(tt(Se,"customHabits",t.id),{clientId:t.id,habits:Ge,hiddenDefaults:re},{merge:!0}),O(Ge),_e(""),Ze(!1),rt(`Added "${oe}"`,"success")}catch(mt){console.error("Error adding custom habit:",mt),rt(mt?.code==="permission-denied"?"Permission denied  check Firestore rules for customHabits":`Failed to add habit: ${mt?.message||"Unknown error"}`,"error")}},Ne=async oe=>{if(!t?.id)return;const Ae=T.filter(Ge=>Ge.id!==oe);try{await Os(tt(Se,"customHabits",t.id),{clientId:t.id,habits:Ae,hiddenDefaults:re},{merge:!0}),O(Ae),ze(null),rt("Habit removed","success")}catch(Ge){console.error("Error deleting habit:",Ge),rt("Failed to remove","error")}},xt=async oe=>{if(!t?.id)return;const Ae=[...re,oe];try{await Os(tt(Se,"customHabits",t.id),{clientId:t.id,habits:T,hiddenDefaults:Ae},{merge:!0}),L(Ae),ze(null),rt("Habit removed","success")}catch(Ge){console.error("Error hiding default habit:",Ge),rt("Failed to remove","error")}},bt=ue.map(oe=>{const Ae=jo(oe),Ge=b[Ae],mt=Ge?Object.values(Ge.habits||{}).filter(Boolean).length:0;return{date:oe,dateStr:Ae,completed:mt,total:Je.length}}),it=bt.reduce((oe,Ae)=>oe+Ae.completed,0),$e=bt.reduce((oe,Ae)=>oe+Ae.total,0),st=$e>0?Math.round(it/$e*100):0,Fe=Object.values(At.habits||{}).filter(Boolean).length,sn=Je.length>0?Math.round(Fe/Je.length*100):0,on=Fe===Je.length&&Je.length>0,Ln=(()=>{const oe=Object.keys(b).sort();let Ae=0,Ge=0,mt=null;for(const lt of oe){const vn=b[lt];if(Object.values(vn.habits||{}).filter(Boolean).length>=3){if(mt){const dn=new Date(mt);Ge=(new Date(lt)-dn)/(1e3*60*60*24)===1?Ge+1:1}else Ge=1;Ge>Ae&&(Ae=Ge),mt=lt}else Ge=0,mt=null}return Math.max(Ae,W)})(),zn=new Date(gt.getFullYear(),gt.getMonth(),1),Xn=zn.toLocaleString("default",{month:"long"}),Yt=new Date(gt.getFullYear(),gt.getMonth()+1,0).getDate(),Fn=(zn.getDay()+6)%7,Cn=Array.from({length:Yt},(oe,Ae)=>{const Ge=new Date(gt.getFullYear(),gt.getMonth(),Ae+1),mt=jo(Ge),lt=b[mt],vn=lt?Object.values(lt.habits||{}).filter(Boolean).length:0,Nn=Ge>gt;return{day:Ae+1,dateStr:mt,completed:vn,total:Je.length,isFuture:Nn,isToday:mt===ut}}),ln=Je.map(oe=>({...oe,days:ue.map(Ae=>{const Ge=jo(Ae);return b[Ge]?.habits?.[oe.key]||!1})})),yr=bt.filter(oe=>oe.completed===oe.total&&oe.total>0).length;return a.jsx(Xo,{children:a.jsxs("div",{className:"cbc-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>y("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),i||H?a.jsx("div",{className:"cbc-loading-inline",children:a.jsx("div",{className:"cbc-loading-spinner"})}):a.jsxs("main",{className:"cbc-main",children:[a.jsxs("div",{className:"cbc-hero anim-fade-up",children:[a.jsxs("div",{className:`cbc-progress-ring${on?" cbc-ring-complete":""}`,children:[a.jsxs("svg",{viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"cbc-arc-track",cx:"100",cy:"100",r:"80"}),a.jsx("circle",{className:"cbc-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-sn/100*2*Math.PI*80})]}),a.jsxs("div",{className:"cbc-ring-center",children:[a.jsxs("span",{className:"cbc-ring-count",children:[Fe,a.jsx("span",{className:"cbc-ring-divider",children:"/"}),Je.length]}),a.jsx("span",{className:"cbc-ring-label",children:on?"complete":"today"})]})]}),a.jsx("p",{className:"cbc-hero-tagline",children:on?"You showed up for yourself today.":Fe===0?"Start your day strong.":`${Je.length-Fe} to go  keep pushing.`})]}),a.jsxs("div",{className:"cbc-streak-card anim-fade-up-d1",children:[a.jsx("div",{className:"cbc-streak-icon",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})})}),a.jsxs("div",{className:"cbc-streak-info",children:[a.jsx("span",{className:"cbc-streak-count",children:W}),a.jsx("span",{className:"cbc-streak-label",children:"day streak"})]}),a.jsxs("div",{className:"cbc-streak-best",children:[a.jsx("span",{className:"cbc-streak-best-val",children:Ln}),a.jsx("span",{className:"cbc-streak-best-label",children:"best"})]})]}),a.jsxs("div",{className:"cbc-section anim-fade-up-d2",children:[a.jsx("h2",{className:"cbc-section-title",children:"Today's Habits"}),a.jsxs("div",{className:"cbc-habits-grid",children:[Je.map(oe=>{const Ae=At.habits?.[oe.key]||!1,Ge=ve===oe.key,mt=ie===oe.key;return a.jsxs("div",{className:`cbc-habit-tile ${Ae?"cbc-habit-done":""} ${Ge?"cbc-habit-just-checked":""}`,style:{"--habit-color":oe.color},children:[p&&a.jsx("button",{className:"cbc-habit-delete",onClick:lt=>{lt.stopPropagation(),ze(oe.isCustom?{type:"custom",id:oe.id,label:oe.label}:{type:"default",key:oe.key,label:oe.label})},"aria-label":`Remove ${oe.label}`,children:a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),a.jsxs("div",{className:`cbc-habit-ring-touch ${mt?"cbc-holding":""} ${Ae?"cbc-ring-completed":""}`,onPointerDown:lt=>{Ae||(lt.preventDefault(),js(oe.key))},onPointerUp:rs,onPointerLeave:rs,onPointerCancel:rs,onClick:lt=>{if(lt.stopPropagation(),ct.current){ct.current=!1;return}Ae&&nn(oe.key)},role:"button",tabIndex:0,"aria-label":Ae?`Undo ${oe.label}`:`Press and hold to complete ${oe.label}`,onKeyDown:lt=>{(lt.key==="Enter"||lt.key===" ")&&(lt.preventDefault(),Ae?nn(oe.key):vt(oe.key))},children:[a.jsxs("svg",{className:"cbc-habit-ring-svg",viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cbc-habit-ring-track",cx:"50",cy:"50",r:qg}),a.jsx("circle",{className:"cbc-habit-ring-fill",ref:lt=>{lt&&(Ve.current[oe.key]=lt)},cx:"50",cy:"50",r:qg,style:{stroke:oe.color,strokeDasharray:Al,strokeDashoffset:Ae?0:Al}})]}),Ae&&a.jsx("div",{className:"cbc-habit-glow-orb",style:{"--habit-color":oe.color}}),a.jsx("div",{className:"cbc-habit-ring-icon",style:{color:oe.color},children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:oe.icon})})}),Ge&&a.jsx("div",{className:"cbc-particles",children:tn.current.map((lt,vn)=>a.jsx("span",{className:"cbc-particle",style:{"--tx":`${lt.tx}px`,"--ty":`${lt.ty}px`,"--size":`${lt.size}px`,"--particle-color":oe.color,animationDuration:`${lt.duration}s`}},vn))})]}),a.jsx("span",{className:"cbc-habit-label",children:oe.label}),Ae?a.jsx("span",{className:"cbc-habit-done-tag",children:"Done"}):a.jsx("span",{className:"cbc-habit-hold-hint",children:"Hold to complete"})]},oe.key)}),p?a.jsxs("div",{className:"cbc-habit-tile cbc-add-tile",onClick:()=>Ze(!0),role:"button",tabIndex:0,children:[a.jsx("div",{className:"cbc-add-ring",children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),a.jsx("span",{className:"cbc-habit-label",children:"Add Habit"}),a.jsx("span",{className:"cbc-habit-hold-hint",children:"Your own"})]}):a.jsxs("div",{className:"cbc-habit-tile cbc-unlock-tile",onClick:()=>y("/upgrade"),role:"button",tabIndex:0,children:[a.jsx("div",{className:"cbc-unlock-ring",children:a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),a.jsx("span",{className:"cbc-habit-label",children:"More Habits"}),a.jsx("span",{className:"cbc-habit-hold-hint",children:"Custom & editable"})]})]})]}),a.jsxs("div",{className:"cbc-section anim-fade-up-d3",children:[a.jsxs("div",{className:"cbc-section-header",children:[a.jsx("h2",{className:"cbc-section-title",children:"This Week"}),a.jsxs("span",{className:"cbc-section-badge",children:[yr,"/7 perfect"]})]}),a.jsxs("div",{className:"cbc-weekly-card",children:[a.jsxs("div",{className:"cbc-weekly-header",children:[a.jsx("span",{className:"cbc-weekly-habit-name"}),Rt.map((oe,Ae)=>a.jsx("span",{className:`cbc-weekly-day-label${ue[Ae]&&jo(ue[Ae])===ut?" cbc-today-label":""}`,children:oe},Ae))]}),ln.map(oe=>(oe.days.filter(Boolean).length,a.jsxs("div",{className:"cbc-weekly-row",children:[a.jsx("span",{className:"cbc-weekly-habit-name",style:{color:oe.color},children:oe.label}),oe.days.map((Ae,Ge)=>a.jsx("span",{className:`cbc-weekly-dot${Ae?" cbc-dot-done":""}${ue[Ge]&&jo(ue[Ge])===ut?" cbc-dot-today":""}`,style:Ae?{background:oe.color,borderColor:oe.color,boxShadow:`0 0 6px ${oe.color}40`}:void 0},Ge))]},oe.key))),a.jsxs("div",{className:"cbc-week-summary",children:[a.jsx("div",{className:"cbc-week-summary-bar",children:a.jsx("div",{className:"cbc-week-summary-fill",style:{width:`${st}%`}})}),a.jsxs("span",{className:"cbc-week-summary-text",children:[it,"/",$e," completed (",st,"%)"]})]})]})]}),a.jsxs("div",{className:"cbc-section anim-fade-up-d4",children:[a.jsx("h2",{className:"cbc-section-title",children:Xn}),a.jsxs("div",{className:"cbc-calendar-card",children:[a.jsx("div",{className:"cbc-cal-header",children:["M","T","W","T","F","S","S"].map((oe,Ae)=>a.jsx("span",{className:"cbc-cal-day-label",children:oe},Ae))}),a.jsxs("div",{className:"cbc-cal-grid",children:[Array.from({length:Fn},(oe,Ae)=>a.jsx("span",{className:"cbc-cal-cell cbc-cal-empty"},`e${Ae}`)),Cn.map(oe=>{const Ae=oe.total>0?oe.completed/oe.total:0,Ge=oe.isFuture?-1:Ae===0?0:Ae<.4?1:Ae<.75?2:Ae<1?3:4;return a.jsx("span",{className:`cbc-cal-cell${oe.isToday?" cbc-cal-today":""}${Ge===4?" cbc-cal-perfect":""} cbc-cal-heat-${Ge<0?"future":Ge}`,children:oe.day},oe.day)})]}),a.jsxs("div",{className:"cbc-cal-legend",children:[a.jsx("span",{className:"cbc-cal-legend-label",children:"Less"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-0"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-1"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-2"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-3"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-4"}),a.jsx("span",{className:"cbc-cal-legend-label",children:"More"})]})]})]})]}),a.jsx(Ri,{active:"home"}),Be&&a.jsx("div",{className:"cbc-modal-overlay",onClick:()=>Ze(!1),children:a.jsxs("div",{className:"cbc-modal",onClick:oe=>oe.stopPropagation(),children:[a.jsx("h3",{className:"cbc-modal-title",children:"Add Habit"}),a.jsx("p",{className:"cbc-modal-desc",children:"Track something personal to your routine."}),a.jsx("input",{className:"cbc-modal-input",type:"text",placeholder:"e.g. Meditate, Stretch, Read...",value:te,onChange:oe=>_e(oe.target.value),maxLength:30,autoFocus:!0,onKeyDown:oe=>oe.key==="Enter"&&ne()}),a.jsxs("div",{className:"cbc-modal-actions",children:[a.jsx("button",{className:"cbc-modal-cancel",onClick:()=>{Ze(!1),_e("")},children:"Cancel"}),a.jsx("button",{className:"cbc-modal-save",onClick:ne,disabled:!te.trim(),children:"Add"})]})]})}),Ie&&a.jsx("div",{className:"cbc-modal-overlay",onClick:()=>ze(null),children:a.jsxs("div",{className:"cbc-modal",onClick:oe=>oe.stopPropagation(),children:[a.jsxs("h3",{className:"cbc-modal-title",children:['Remove "',Ie.label,'"?']}),a.jsx("p",{className:"cbc-modal-desc",children:"This will remove the habit from your daily tracker. Past logs won't be affected."}),a.jsxs("div",{className:"cbc-modal-actions",children:[a.jsx("button",{className:"cbc-modal-cancel",onClick:()=>ze(null),children:"Keep"}),a.jsx("button",{className:"cbc-modal-delete",onClick:()=>Ie.type==="custom"?Ne(Ie.id):xt(Ie.key),children:"Remove"})]})]})}),S&&a.jsx(Fg,{title:"All Habits Complete!",subtitle:Lt.current,stats:[{value:`${Fe}/${Je.length}`,label:"Habits"},{value:W||1,label:"Day Streak"}],buttonLabel:"Keep Going",holdLabel:"Hold To Complete Today's Habits",shareType:"habits",hideShare:!p,onShareJourney:t?Xt:null,userName:t?.name,onDone:()=>{I(!1),D(!1)}}),de&&a.jsx("div",{className:`toast-notification ${de.type}`,children:de.message})]})})}function md(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function Kw(s,e){return[s,e].sort().join("_")}function X3(){const{currentUser:s,isClient:e,clientData:t,loading:i}=hi(),{isDark:l,toggleTheme:u}=ao(),h=gr(),[p,g]=_.useState("buddies"),[y,b]=_.useState([]),[E,T]=_.useState([]),[O,H]=_.useState([]),[q,B]=_.useState(""),[X,W]=_.useState([]),[Y,de]=_.useState([]),[xe,ve]=_.useState(!0),[j,S]=_.useState(null),[I,V]=_.useState(null),D=_.useCallback((re,L="info")=>{V({message:re,type:L}),setTimeout(()=>V(null),3500)},[]);_.useEffect(()=>{!i&&(!s||!e)&&h("/")},[s,e,i,h]);const M=_.useCallback(async()=>{if(t){ve(!0);try{const re=t.id,ie=(await Tn(Mt(Se,"clients"))).docs.map(Ve=>({id:Ve.id,...Ve.data()}));de(ie);const we=Object.fromEntries(ie.map(Ve=>[Ve.id,Ve])),ke=await Tn(Dn(Mt(Se,"buddies"),fn("user1","==",re))),Te=await Tn(Dn(Mt(Se,"buddies"),fn("user2","==",re))),Ee=new Set;[...ke.docs,...Te.docs].forEach(Ve=>{const tn=Ve.data(),jn=tn.user1===re?tn.user2:tn.user1;Ee.add(jn)}),b(Array.from(Ee).map(Ve=>we[Ve]).filter(Boolean));const Ke=await Tn(Dn(Mt(Se,"buddyRequests"),fn("toId","==",re),fn("status","==","pending")));T(Ke.docs.map(Ve=>({reqId:Ve.id,...Ve.data(),fromClient:we[Ve.data().fromId]})).filter(Ve=>Ve.fromClient));const ct=await Tn(Dn(Mt(Se,"buddyRequests"),fn("fromId","==",re),fn("status","==","pending")));H(ct.docs.map(Ve=>({reqId:Ve.id,...Ve.data(),toClient:we[Ve.data().toId]})).filter(Ve=>Ve.toClient))}catch(re){console.error("Error fetching buddy data:",re),D("Failed to load buddies","error")}finally{ve(!1)}}},[t,D]);_.useEffect(()=>{M()},[M]),_.useEffect(()=>{if(!q.trim()||!t){W([]);return}const re=q.toLowerCase(),L=t.id,ie=new Set(y.map(Ee=>Ee.id)),we=new Set(O.map(Ee=>Ee.toId)),ke=new Set(E.map(Ee=>Ee.fromId)),Te=Y.filter(Ee=>Ee.id===L||!Ee.name||!Ee.coreBuddyAccess&&Ee.clientType!=="core_buddy"?!1:Ee.name.toLowerCase().includes(re)).map(Ee=>({...Ee,isBuddy:ie.has(Ee.id),isPendingOut:we.has(Ee.id),isPendingIn:ke.has(Ee.id)})).slice(0,20);W(Te)},[q,Y,y,O,E,t]);const A=async(re,L)=>{if(!(!t||re===t.id))try{await ri(Mt(Se,"notifications"),{toId:re,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:L,read:!1,createdAt:fr()})}catch(ie){console.error("Notification error:",ie),ie.code==="permission-denied"&&D("Notifications blocked  check Firestore rules","error")}},Be=async re=>{S(re);try{const L=`${t.id}_${re}`;await Os(tt(Se,"buddyRequests",L),{fromId:t.id,toId:re,status:"pending",createdAt:fr()}),await A(re,"buddy_request"),D("Buddy request sent!","success"),await M()}catch(L){console.error("Error sending request:",L),D("Failed to send request","error")}finally{S(null)}},Ze=async re=>{S(re.reqId);try{const L=Kw(re.fromId,t.id);await Os(tt(Se,"buddies",L),{user1:[re.fromId,t.id].sort()[0],user2:[re.fromId,t.id].sort()[1],connectedAt:fr()}),await jr(tt(Se,"buddyRequests",re.reqId)),await A(re.fromId,"buddy_accept"),D("Buddy added!","success"),await M()}catch(L){console.error("Error accepting request:",L),D("Failed to accept","error")}finally{S(null)}},te=async re=>{S(re.reqId);try{await jr(tt(Se,"buddyRequests",re.reqId)),D("Request declined","info"),await M()}catch(L){console.error("Error declining:",L),D("Failed to decline","error")}finally{S(null)}},_e=async re=>{S(re.reqId);try{await jr(tt(Se,"buddyRequests",re.reqId)),D("Request cancelled","info"),await M()}catch(L){console.error("Error cancelling:",L),D("Failed to cancel","error")}finally{S(null)}},Ie=async re=>{S(re);try{const L=Kw(t.id,re);await jr(tt(Se,"buddies",L)),D("Buddy removed","info"),await M()}catch(L){console.error("Error removing buddy:",L),D("Failed to remove buddy","error")}finally{S(null)}},ze=E.length;return i?a.jsx("div",{className:"bdy-loading",children:a.jsx("div",{className:"bdy-spinner"})}):!s||!e||!t?null:a.jsx(Xo,{children:a.jsxs("div",{className:"bdy-page","data-theme":l?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>h("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"bdy-main",children:[a.jsx("h1",{className:"bdy-title",children:"Buddies"}),a.jsxs("button",{className:"bdy-leaderboard-link",onClick:()=>h("/client/leaderboard"),children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),a.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),a.jsx("rect",{x:"6",y:"9",width:"12",height:"13",rx:"2"}),a.jsx("path",{d:"M12 9v13"}),a.jsx("path",{d:"M2 22h20"})]}),a.jsx("span",{children:"Leaderboard"}),a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"bdy-tabs",children:[a.jsxs("button",{className:`bdy-tab${p==="buddies"?" active":""}`,onClick:()=>g("buddies"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"My Buddies"})]}),a.jsxs("button",{className:`bdy-tab${p==="requests"?" active":""}`,onClick:()=>g("requests"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),a.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),a.jsx("span",{children:"Requests"}),ze>0&&a.jsx("span",{className:"bdy-tab-badge",children:ze})]}),a.jsxs("button",{className:`bdy-tab${p==="search"?" active":""}`,onClick:()=>g("search"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Find"})]})]}),xe?a.jsx("div",{className:"bdy-content-loading",children:a.jsx("div",{className:"bdy-spinner"})}):a.jsxs(a.Fragment,{children:[p==="buddies"&&a.jsx("div",{className:"bdy-section",children:y.length===0?a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("h3",{children:"No buddies yet"}),a.jsx("p",{children:"Find members and send buddy requests to connect!"}),a.jsx("button",{className:"bdy-empty-btn",onClick:()=>g("search"),children:"Find Buddies"})]}):a.jsx("div",{className:"bdy-list",children:y.map(re=>a.jsxs("div",{className:"bdy-card",onClick:()=>h(`/client/core-buddy/profile/${re.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:re.photoURL?a.jsx("img",{src:re.photoURL,alt:re.name}):a.jsx("span",{children:md(re.name)})}),a.jsx("div",{className:"bdy-card-info",children:a.jsx("span",{className:"bdy-card-name",children:re.name})}),a.jsx("button",{className:"bdy-remove-btn",onClick:L=>{L.stopPropagation(),Ie(re.id)},disabled:j===re.id,"aria-label":"Remove buddy",children:j===re.id?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},re.id))})}),p==="requests"&&a.jsxs("div",{className:"bdy-section",children:[E.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Incoming"}),a.jsx("div",{className:"bdy-list",children:E.map(re=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:re.fromClient.photoURL?a.jsx("img",{src:re.fromClient.photoURL,alt:re.fromClient.name}):a.jsx("span",{children:md(re.fromClient.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:re.fromClient.name}),a.jsx("span",{className:"bdy-card-sub",children:"wants to be your buddy"})]}),a.jsxs("div",{className:"bdy-action-pair",children:[a.jsx("button",{className:"bdy-accept-btn",onClick:()=>Ze(re),disabled:j===re.reqId,children:j===re.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}),a.jsx("button",{className:"bdy-decline-btn",onClick:()=>te(re),disabled:j===re.reqId,children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},re.reqId))})]}),O.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Sent"}),a.jsx("div",{className:"bdy-list",children:O.map(re=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:re.toClient?.photoURL?a.jsx("img",{src:re.toClient.photoURL,alt:re.toClient.name}):a.jsx("span",{children:md(re.toClient?.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:re.toClient?.name}),a.jsx("span",{className:"bdy-card-sub",children:"pending"})]}),a.jsx("button",{className:"bdy-cancel-btn",onClick:()=>_e(re),disabled:j===re.reqId,children:j===re.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):"Cancel"})]},re.reqId))})]}),E.length===0&&O.length===0&&a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),a.jsx("h3",{children:"No pending requests"}),a.jsx("p",{children:"All caught up!"})]})]}),p==="search"&&a.jsxs("div",{className:"bdy-section",children:[a.jsxs("div",{className:"bdy-search-bar",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("input",{type:"text",placeholder:"Search by name...",value:q,onChange:re=>B(re.target.value),autoFocus:!0}),q&&a.jsx("button",{className:"bdy-search-clear",onClick:()=>B(""),children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),q.trim()&&X.length===0&&a.jsx("div",{className:"bdy-empty bdy-empty-sm",children:a.jsxs("p",{children:['No members found for "',q,'"']})}),X.length>0&&a.jsx("div",{className:"bdy-list",children:X.map(re=>a.jsxs("div",{className:"bdy-card",onClick:()=>h(`/client/core-buddy/profile/${re.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:re.photoURL?a.jsx("img",{src:re.photoURL,alt:re.name}):a.jsx("span",{children:md(re.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:re.name}),re.isBuddy&&a.jsx("span",{className:"bdy-card-badge",children:"Buddy"})]}),re.isBuddy?a.jsx("span",{className:"bdy-status-icon",children:a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-success)",strokeWidth:"2.5",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):re.isPendingOut?a.jsx("span",{className:"bdy-pending-label",children:"Pending"}):re.isPendingIn?a.jsx("button",{className:"bdy-accept-btn",onClick:L=>{L.stopPropagation();const ie=E.find(we=>we.fromId===re.id);ie&&Ze(ie)},disabled:!!j,children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):a.jsx("button",{className:"bdy-add-btn",onClick:L=>{L.stopPropagation(),Be(re.id)},disabled:j===re.id,children:j===re.id?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]},re.id))})]})]})]}),a.jsx(Ri,{}),I&&a.jsxs("div",{className:`toast-notification ${I.type}`,children:[a.jsx("span",{className:"toast-icon",children:I.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):I.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:I.message})]})]})})}function pd(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function tg(s,e){return[s,e].sort().join("_")}const J3=5;function ng(s){return s.toISOString().split("T")[0]}function Yw(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function Z3(){const{userId:s}=dj(),{currentUser:e,isClient:t,clientData:i,loading:l}=hi(),{isDark:u,toggleTheme:h}=ao(),p=gr(),[g,y]=_.useState(null),[b,E]=_.useState("none"),[T,O]=_.useState(null),[H,q]=_.useState(!0),[B,X]=_.useState(!1),[W,Y]=_.useState(null),[de,xe]=_.useState([]),[ve,j]=_.useState(!1),[S,I]=_.useState(new Set),[V,D]=_.useState(new Set),[M,A]=_.useState({}),[Be,Ze]=_.useState({}),[te,_e]=_.useState({}),[Ie,ze]=_.useState(!0),[re,L]=_.useState(0),[ie,we]=_.useState(0),[ke,Te]=_.useState(0),[Ee,Ke]=_.useState([]),[ct,Ve]=_.useState(!1),[tn,jn]=_.useState(null),[Un,Lt]=_.useState([]),rt=_.useCallback((ne,Ne="info")=>{Y({message:ne,type:Ne}),setTimeout(()=>Y(null),3500)},[]);_.useEffect(()=>{!l&&(!e||!t)&&p("/")},[e,t,l,p]),_.useEffect(()=>{i&&s&&i.id===s&&p("/client/core-buddy",{replace:!0})},[i,s,p]),_.useEffect(()=>{if(!i||!s||i.id===s)return;let ne=!1;return(async()=>{q(!0);try{const bt=(await Tn(Mt(Se,"clients"))).docs.map(Fe=>({id:Fe.id,...Fe.data()})).find(Fe=>Fe.id===s);if(!bt){ne||q(!1);return}ne||y(bt);const it=i.id,$e=tg(it,s);if((await mr(tt(Se,"buddies",$e))).exists())ne||E("buddy");else{const Fe=`${it}_${s}`,sn=await mr(tt(Se,"buddyRequests",Fe));if(sn.exists()&&sn.data().status==="pending")ne||(E("pending_out"),O(Fe));else{const on=`${s}_${it}`,Ln=await mr(tt(Se,"buddyRequests",on));Ln.exists()&&Ln.data().status==="pending"?ne||(E("pending_in"),O(on)):ne||E("none")}}}catch(Ne){console.error("Error loading profile:",Ne)}finally{ne||q(!1)}})(),()=>{ne=!0}},[i,s]),_.useEffect(()=>{if(!s||!g)return;let ne=!1;return(async()=>{ze(!0);try{const Ne=await Tn(Dn(Mt(Se,"workoutLogs"),fn("clientId","==",s)));if(ne)return;const xt=Ne.docs.length;L(xt);let bt=0;const it=Ne.docs.map(st=>st.data().date).filter(Boolean).sort().reverse();if(it.length>0){const st=new Date;let Fe=new Date(st);for(let sn=0;sn<52;sn++){const on=new Date(Fe),Ln=on.getDay(),zn=Ln===0?6:Ln-1;on.setDate(on.getDate()-zn),on.setHours(0,0,0,0);const Xn=new Date(on);Xn.setDate(Xn.getDate()+7);const Yt=ng(on),Fn=ng(Xn);if(it.some(ln=>ln>=Yt&&ln<Fn))bt++;else{if(sn>0)break;break}Fe.setDate(Fe.getDate()-7)}}ne||we(bt);let $e=0;for(let st=0;st<30;st++){const Fe=new Date;Fe.setDate(Fe.getDate()-st);const sn=ng(Fe);try{const on=await Tn(Dn(Mt(Se,"habitLogs"),fn("clientId","==",s),fn("date","==",sn)));if(on.empty)break;{const Ln=on.docs[0].data().habits||{};if(Object.values(Ln).filter(Boolean).length>=J3)$e++;else break}}catch{break}}ne||Te($e)}catch(Ne){console.error("Error loading buddy stats:",Ne)}finally{ne||ze(!1)}})(),()=>{ne=!0}},[s,g]),_.useEffect(()=>{if(!i)return;const ne=i.id;(async()=>{try{const[Ne,xt,bt]=await Promise.all([Tn(Dn(Mt(Se,"buddies"),fn("user1","==",ne))),Tn(Dn(Mt(Se,"buddies"),fn("user2","==",ne))),Tn(Mt(Se,"clients"))]),it=new Set;[...Ne.docs,...xt.docs].forEach(st=>{const Fe=st.data();it.add(Fe.user1===ne?Fe.user2:Fe.user1)});const $e={};bt.docs.forEach(st=>{$e[st.id]=st.data()}),Ke(Array.from(it).filter(st=>$e[st]).map(st=>({id:st,name:$e[st].name,photoURL:$e[st].photoURL||null})))}catch(Ne){console.error("Error loading buddies for mentions:",Ne)}})()},[i]);const gt=async(ne,Ne,xt={})=>{if(!(!i||ne===i.id))try{await ri(Mt(Se,"notifications"),{toId:ne,fromId:i.id,fromName:i.name||"Someone",fromPhotoURL:i.photoURL||null,type:Ne,read:!1,createdAt:fr(),...xt})}catch(bt){console.error("Notification error:",bt),bt.code==="permission-denied"&&rt("Notifications blocked  check Firestore rules","error")}},ut=async()=>{X(!0);try{const ne=`${i.id}_${s}`;await Os(tt(Se,"buddyRequests",ne),{fromId:i.id,toId:s,status:"pending",createdAt:fr()}),await gt(s,"buddy_request"),E("pending_out"),O(ne),rt("Buddy request sent!","success")}catch(ne){console.error(ne),rt("Failed to send request","error")}finally{X(!1)}},Bn=async()=>{if(T){X(!0);try{const ne=tg(i.id,s);await Os(tt(Se,"buddies",ne),{user1:[i.id,s].sort()[0],user2:[i.id,s].sort()[1],connectedAt:fr()}),await jr(tt(Se,"buddyRequests",T)),await gt(s,"buddy_accept"),E("buddy"),rt("Buddy added!","success")}catch(ne){console.error(ne),rt("Failed to accept","error")}finally{X(!1)}}},ue=async()=>{if(T){X(!0);try{await jr(tt(Se,"buddyRequests",T)),E("none"),rt(b==="pending_out"?"Request cancelled":"Request declined","info")}catch(ne){console.error(ne),rt("Failed","error")}finally{X(!1)}}},Rt=async()=>{X(!0);try{const ne=tg(i.id,s);await jr(tt(Se,"buddies",ne)),E("none"),rt("Buddy removed","info")}catch(ne){console.error(ne),rt("Failed to remove","error")}finally{X(!1)}},yt=_.useCallback(async()=>{if(s){j(!0);try{const ne=await Tn(Dn(Mt(Se,"posts"),fn("authorId","==",s),wu("createdAt","desc"),_u(30)));if(xe(ne.docs.map(Ne=>({id:Ne.id,...Ne.data()}))),i){const Ne=await Tn(Dn(Mt(Se,"postLikes"),fn("userId","==",i.id)));I(new Set(Ne.docs.map(xt=>xt.data().postId)))}}catch(ne){console.error("Error loading journey:",ne)}finally{j(!1)}}},[s,i]);_.useEffect(()=>{!H&&g&&yt()},[H,g,yt]);const Vt=async ne=>{if(window.confirm("Delete this post?"))try{await jr(tt(Se,"posts",ne)),xe(Ne=>Ne.filter(xt=>xt.id!==ne)),rt("Post deleted","info")}catch(Ne){console.error("Delete error:",Ne),rt("Failed to delete","error")}},Je=async ne=>{if(!i)return;const Ne=i.id,xt=`${ne}_${Ne}`,bt=S.has(ne),it=new Set(S);bt?it.delete(ne):it.add(ne),I(it),xe($e=>$e.map(st=>st.id===ne?{...st,likeCount:Math.max(0,(st.likeCount||0)+(bt?-1:1))}:st));try{if(bt)await jr(tt(Se,"postLikes",xt)),await Zs(tt(Se,"posts",ne),{likeCount:Ao(-1)});else{await Os(tt(Se,"postLikes",xt),{postId:ne,userId:Ne,createdAt:fr()}),await Zs(tt(Se,"posts",ne),{likeCount:Ao(1)});const $e=de.find(st=>st.id===ne);$e&&gt($e.authorId,"like",{postId:ne})}}catch($e){console.error("Like error:",$e),yt()}},At=async ne=>{try{const Ne=await Tn(Dn(Mt(Se,"postComments"),fn("postId","==",ne),wu("createdAt","asc"),_u(50)));A(xt=>({...xt,[ne]:Ne.docs.map(bt=>({id:bt.id,...bt.data()}))}))}catch(Ne){console.error("Error loading comments:",Ne)}},vt=ne=>{const Ne=new Set(V);Ne.has(ne)?Ne.delete(ne):(Ne.add(ne),M[ne]||At(ne)),D(Ne)},nn=(ne,Ne)=>{const xt=ne.match(/@(\w*)$/);if(xt){Ve(!0),jn(Ne);const bt=Ee.filter(it=>it.name&&it.name.toLowerCase().includes(xt[1].toLowerCase())).slice(0,5);Lt(bt)}else Ve(!1),Lt([])},js=(ne,Ne)=>{const bt=(Be[Ne]||"").replace(/@\w*$/,`@${ne.name} `);Ze(it=>({...it,[Ne]:bt})),Ve(!1),Lt([])},rs=(ne,Ne)=>{Ze(xt=>({...xt,[ne]:Ne})),nn(Ne,ne)},Xt=async ne=>{const Ne=(Be[ne]||"").trim();if(!(!Ne||!i)){_e(xt=>({...xt,[ne]:!0}));try{await ri(Mt(Se,"postComments"),{postId:ne,authorId:i.id,authorName:i.name||"Unknown",authorPhotoURL:i.photoURL||null,content:Ne,createdAt:fr()}),await Zs(tt(Se,"posts",ne),{commentCount:Ao(1)});const xt=de.find(it=>it.id===ne);xt&&gt(xt.authorId,"comment",{postId:ne});const bt=Ne.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(bt){const it=new Set;bt.forEach($e=>{const st=$e.slice(1).trim(),Fe=Ee.find(sn=>sn.name&&sn.name.toLowerCase()===st.toLowerCase());Fe&&!it.has(Fe.id)&&(it.add(Fe.id),gt(Fe.id,"mention",{postId:ne}))})}Ze(it=>({...it,[ne]:""})),xe(it=>it.map($e=>$e.id===ne?{...$e,commentCount:($e.commentCount||0)+1}:$e)),await At(ne)}catch(xt){console.error("Comment error:",xt),rt("Failed to comment","error")}finally{_e(xt=>({...xt,[ne]:!1}))}}};return l||H||!i?a.jsx("div",{className:"prf-loading","data-theme":u?"dark":"light",children:a.jsx("div",{className:"prf-spinner"})}):!e||!t?null:g?a.jsx(Xo,{children:a.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:h,"aria-label":"Toggle theme",children:u?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"prf-main",children:[a.jsxs("div",{className:"prf-hero",children:[a.jsx("div",{className:"prf-avatar-lg",children:g.photoURL?a.jsx("img",{src:g.photoURL,alt:g.name}):a.jsx("span",{children:pd(g.name)})}),a.jsx("h1",{className:"prf-name",children:g.name}),a.jsxs("div",{className:"prf-buddy-action",children:[b==="none"&&a.jsx("button",{className:"prf-btn prf-btn-primary",onClick:ut,disabled:B,children:B?a.jsx("div",{className:"prf-btn-spinner"}):a.jsxs(a.Fragment,{children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Buddy"]})}),b==="pending_out"&&a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:ue,disabled:B,children:B?a.jsx("div",{className:"prf-btn-spinner dark"}):"Cancel Request"}),b==="pending_in"&&a.jsxs("div",{className:"prf-btn-pair",children:[a.jsx("button",{className:"prf-btn prf-btn-success",onClick:Bn,disabled:B,children:B?a.jsx("div",{className:"prf-btn-spinner"}):"Accept"}),a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:ue,disabled:B,children:"Decline"})]}),b==="buddy"&&a.jsx("button",{className:"prf-btn prf-btn-danger",onClick:Rt,disabled:B,children:B?a.jsx("div",{className:"prf-btn-spinner"}):"Remove Buddy"})]})]}),Ie?a.jsx("div",{className:"prf-stats-loading",children:a.jsx("div",{className:"prf-spinner"})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"prf-stats",children:[a.jsxs("div",{className:"prf-stat",children:[a.jsx("span",{className:"prf-stat-value",children:re}),a.jsx("span",{className:"prf-stat-label",children:"Workouts"})]}),a.jsxs("div",{className:"prf-stat",children:[a.jsxs("span",{className:"prf-stat-value",children:[ie,a.jsx("span",{className:"prf-stat-unit",children:"wk"})]}),a.jsx("span",{className:"prf-stat-label",children:"Streak"})]})]}),ke>0&&a.jsx("div",{className:"prf-info-row",children:a.jsxs("div",{className:"prf-info-card info-habit",children:[a.jsx("div",{className:"prf-info-icon",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]})}),a.jsxs("div",{className:"prf-info-text",children:[a.jsxs("span",{className:"prf-info-value",children:[ke," day",ke!==1?"s":""]}),a.jsx("span",{className:"prf-info-sub",children:"Habit Streak"})]})]})})]}),a.jsxs("div",{className:"prf-section",children:[a.jsx("h2",{className:"prf-section-title",children:`${g.name?.split(" ")[0]}'s Journey`}),ve?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"prf-spinner"})}):de.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"No posts yet"})]}):a.jsx("div",{className:"journey-list",children:de.map(ne=>a.jsxs("div",{className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:ne.authorPhotoURL?a.jsx("img",{src:ne.authorPhotoURL,alt:""}):a.jsx("span",{children:pd(ne.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:ne.authorName}),a.jsx("span",{className:"journey-post-time",children:Yw(ne.createdAt)})]}),ne.authorId===i.id&&a.jsx("button",{className:"journey-delete-btn",onClick:()=>Vt(ne.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),ne.type==="workout_summary"&&ne.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:ne.metadata.title}),ne.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:ne.metadata.stats.map(Ne=>`${Ne.value} ${Ne.label}`).join("    ")}),!ne.metadata.stats?.length&&ne.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:ne.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed a workout using Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):ne.type==="badge_earned"&&ne.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame journey-card-logo-badge",children:a.jsx("img",{src:"/Logo.webp",alt:ne.metadata.title,className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:ne.metadata.title}),ne.metadata.badgeDesc&&a.jsx("p",{className:"journey-card-stats-line",children:ne.metadata.badgeDesc}),a.jsx("p",{className:"journey-card-cta",children:"I just earned a badge on Core Buddy"}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):ne.type==="habits_summary"&&ne.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:ne.metadata.title}),ne.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:ne.metadata.stats.map(Ne=>`${Ne.value} ${Ne.label}`).join("    ")}),ne.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:ne.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed my daily habits with Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):a.jsxs(a.Fragment,{children:[ne.content&&a.jsx("p",{className:"journey-post-content",children:ne.content}),ne.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:ne.imageURL,alt:"Post",loading:"lazy"})})]}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${S.has(ne.id)?" liked":""}`,onClick:()=>Je(ne.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:S.has(ne.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:ne.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${V.has(ne.id)?" active":""}`,onClick:()=>vt(ne.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:ne.commentCount||0})]})]}),V.has(ne.id)&&a.jsxs("div",{className:"journey-comments",children:[M[ne.id]?.length>0?M[ne.id].map(Ne=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",onClick:()=>p(`/client/core-buddy/profile/${Ne.authorId}`),children:Ne.authorPhotoURL?a.jsx("img",{src:Ne.authorPhotoURL,alt:""}):a.jsx("span",{children:pd(Ne.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:Ne.authorName}),a.jsx("span",{className:"journey-comment-text",children:Ne.content})]}),a.jsx("span",{className:"journey-comment-time",children:Yw(Ne.createdAt)})]})]},Ne.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("input",{type:"text",placeholder:"Comment... (@ to mention)",value:Be[ne.id]||"",onChange:Ne=>rs(ne.id,Ne.target.value),onKeyDown:Ne=>{Ne.key==="Enter"&&Xt(ne.id)},maxLength:300}),ct&&tn===ne.id&&Un.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:Un.map(Ne=>a.jsxs("button",{className:"mention-option",onClick:()=>js(Ne,ne.id),children:[a.jsx("div",{className:"mention-option-avatar",children:Ne.photoURL?a.jsx("img",{src:Ne.photoURL,alt:""}):a.jsx("span",{children:pd(Ne.name)})}),a.jsx("span",{children:Ne.name})]},Ne.id))}),a.jsx("button",{onClick:()=>Xt(ne.id),disabled:!(Be[ne.id]||"").trim()||te[ne.id],children:te[ne.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},ne.id))})]})]}),a.jsx(Ri,{}),W&&a.jsxs("div",{className:`toast-notification ${W.type}`,children:[a.jsx("span",{className:"toast-icon",children:W.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):W.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:W.message})]})]})}):a.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions"})]})}),a.jsx("main",{className:"prf-main",children:a.jsx("p",{style:{textAlign:"center",color:"var(--text-tertiary)",padding:"40px 0"},children:"User not found"})}),a.jsx(Ri,{})]})}const sg=[{text:"Build your dashboard...",bold:"your way"},{text:"Pick what matters to you...",bold:"nothing else"},{text:"Your goals, your layout...",bold:"your rules"}],Qw=[{id:"stats",label:"Stats Rings",desc:"Programme %, workouts this week, habits today",icon:"rings",defaultOn:!0},{id:"workouts",label:"Workouts",desc:"Sessions this week and total count",icon:"dumbbell",defaultOn:!0},{id:"habits",label:"Habits",desc:"Daily habit tracker dots",icon:"check",defaultOn:!0},{id:"pbs",label:"Personal Bests",desc:"Your top lifts at a glance",icon:"trophy"},{id:"nutrition",label:"Nutrition",desc:"Macro rings  protein, carbs, fats, cals",icon:"apple"},{id:"leaderboard",label:"Leaderboard",desc:"See where you rank among buddies",icon:"podium"},{id:"journey",label:"Journey",desc:"Your posts, likes and comments feed",icon:"feed"},{id:"coach",label:"Coach Message",desc:"Motivational nudge from Buddy",icon:"message",defaultOn:!0},{id:"nudge",label:"Smart Nudge",desc:"Contextual reminder of what to do next",icon:"lightbulb"}];function eL(s){switch(s){case"rings":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("circle",{cx:"12",cy:"12",r:"6"}),a.jsx("circle",{cx:"12",cy:"12",r:"2"})]});case"dumbbell":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M6.5 6.5h11v11h-11z",strokeLinejoin:"round"}),a.jsx("line",{x1:"2",y1:"12",x2:"6.5",y2:"12"}),a.jsx("line",{x1:"17.5",y1:"12",x2:"22",y2:"12"})]});case"check":return a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})});case"trophy":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M6 9H3V6a1 1 0 0 1 1-1h2M18 9h3V6a1 1 0 0 0-1-1h-2"}),a.jsx("path",{d:"M6 5h12v7a6 6 0 0 1-12 0V5z"}),a.jsx("path",{d:"M9 21h6"}),a.jsx("path",{d:"M12 17v4"})]});case"apple":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M12 3c-1.5 0-3 1-3 1s-3-.5-4.5 1.5S3 9 3 12s1.5 6 3 8 3 3 6 3 4.5-1 6-3 3-5 3-8-1.5-4-3-6.5S13.5 3 12 3z"}),a.jsx("path",{d:"M12 3c0 0 1-2 3-2"})]});case"podium":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"2",y:"14",width:"6",height:"8",rx:"1"}),a.jsx("rect",{x:"9",y:"8",width:"6",height:"14",rx:"1"}),a.jsx("rect",{x:"16",y:"11",width:"6",height:"11",rx:"1"})]});case"medal":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"15",r:"6"}),a.jsx("path",{d:"M8.21 13.89L7 2h10l-1.21 11.89"})]});case"feed":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"3"}),a.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),a.jsx("line",{x1:"3",y1:"15",x2:"21",y2:"15"})]});case"message":return a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})});case"lightbulb":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 18h6"}),a.jsx("path",{d:"M10 22h4"}),a.jsx("path",{d:"M12 2a7 7 0 0 0-4 12.7V17h8v-2.3A7 7 0 0 0 12 2z"})]});default:return null}}function tL(){const s=gr(),{clientData:e,currentUser:t,updateClientData:i,resolveClient:l}=hi(),[u,h]=_.useState({hours:0,minutes:0,seconds:0}),[p,g]=_.useState(0),[y,b]=_.useState(0),[E,T]=_.useState(null),[O,H]=_.useState(!1),q=_.useRef(null),[B,X]=_.useState(()=>{const M=e?.dashboardWidgets;return M&&Array.isArray(M)?M:Qw.filter(A=>A.defaultOn).map(A=>A.id)}),[W,Y]=_.useState(!1),[de,xe]=_.useState(!1),[ve,j]=_.useState(null);_.useEffect(()=>{e?.photoURL&&T(e.photoURL)},[e?.photoURL]),_.useEffect(()=>{const M=()=>{const Be=new Date,Ze=new Date(Be);Ze.setHours(23,59,59,999);const te=Ze-Be;h({hours:Math.floor(te/36e5),minutes:Math.floor(te%36e5/6e4),seconds:Math.floor(te%6e4/1e3)}),g(60-Math.floor(te%6e4/1e3))};M();const A=setInterval(M,1e3);return()=>clearInterval(A)},[]),_.useEffect(()=>{const M=setInterval(()=>b(A=>(A+1)%sg.length),8e3);return()=>clearInterval(M)},[]);const S=async M=>{const A=M.target.files?.[0];if(!(!A||!e?.id)){H(!0);try{const Be=$a(Wa,`profilePhotos/${e.id}`);await Cd(Be,A);const Ze=await Lo(Be);await Zs(tt(Se,"clients",e.id),{photoURL:Ze}),T(Ze),i({photoURL:Ze})}catch(Be){console.error("Photo upload error:",Be)}finally{H(!1)}}},I=M=>{xe(!1),X(A=>A.includes(M)?A.filter(Be=>Be!==M):[...A,M])},V=(M,A)=>{xe(!1),X(Be=>{const Ze=Be.indexOf(M);if(Ze<0)return Be;const te=Ze+A;if(te<0||te>=Be.length)return Be;const _e=[...Be];return[_e[Ze],_e[te]]=[_e[te],_e[Ze]],_e})},D=async()=>{Y(!0),j(null);try{const M=e||await l();if(!M?.id){j("Could not find your profile. Try refreshing."),Y(!1);return}await Zs(tt(Se,"clients",M.id),{dashboardWidgets:B}),i({dashboardWidgets:B}),xe(!0)}catch(M){console.error("Save config error:",M),j("Save failed  please try again.")}finally{Y(!1)}};return a.jsx(Xo,{children:a.jsxs("div",{className:"bldr-page",children:[a.jsxs("div",{className:"bldr-container",children:[a.jsxs("div",{className:"bldr-header",children:[a.jsx("button",{className:"bldr-back",onClick:()=>s("/client/core-buddy"),children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("h1",{className:"bldr-title",children:"Build Your Dashboard"})]}),a.jsxs("div",{className:"bldr-ring-container",children:[a.jsxs("div",{className:"bldr-ring",children:[a.jsx("svg",{className:"bldr-ring-svg",viewBox:"0 0 200 200",children:yT.map((M,A)=>a.jsx("line",{x1:M.x1,y1:M.y1,x2:M.x2,y2:M.y2,className:`bldr-tick ${A<p?"elapsed":"remaining"}`,strokeWidth:M.thick?"3":"2"},A))}),a.jsxs("div",{className:"bldr-ring-center",children:[a.jsxs("div",{className:"bldr-ring-photo",onClick:()=>q.current?.click(),children:[a.jsx("img",{src:E||"/Logo.webp",alt:E?"Profile":"Mind Core Fitness"}),a.jsx("div",{className:`bldr-photo-overlay${O?" uploading":""}`,children:O?a.jsx("div",{className:"bldr-photo-spinner"}):a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),a.jsx("input",{ref:q,type:"file",accept:"image/*",onChange:S,style:{display:"none"}})]}),!E&&!O&&a.jsx("div",{className:"bldr-photo-badge",onClick:()=>q.current?.click(),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),a.jsxs("div",{className:"bldr-countdown",children:[a.jsx("span",{className:"bldr-timer-digit",children:String(u.hours).padStart(2,"0")}),a.jsx("span",{className:"bldr-timer-colon",children:":"}),a.jsx("span",{className:"bldr-timer-digit",children:String(u.minutes).padStart(2,"0")}),a.jsx("span",{className:"bldr-timer-colon",children:":"}),a.jsx("span",{className:"bldr-timer-digit bldr-timer-sec",children:String(u.seconds).padStart(2,"0")})]}),a.jsx("span",{className:"bldr-ring-label",children:"remaining today"}),a.jsxs("p",{className:"bldr-tagline",children:[sg[y].text," ",a.jsx("strong",{children:sg[y].bold})]})]}),a.jsxs("div",{className:"bldr-section",children:[a.jsx("h2",{className:"bldr-section-title",children:"Choose Your Widgets"}),a.jsx("p",{className:"bldr-section-desc",children:"The countdown ring and your profile always stay at the top. Pick what goes below."}),a.jsx("div",{className:"bldr-widgets-list",children:Qw.map(M=>{const A=B.includes(M.id),Be=B.indexOf(M.id);return a.jsxs("div",{className:`bldr-widget-card${A?" active":""}`,children:[a.jsx("div",{className:"bldr-widget-icon",children:eL(M.icon)}),a.jsxs("div",{className:"bldr-widget-info",children:[a.jsx("div",{className:"bldr-widget-label",children:M.label}),a.jsx("div",{className:"bldr-widget-desc",children:M.desc})]}),a.jsxs("div",{className:"bldr-widget-actions",children:[A&&a.jsxs("div",{className:"bldr-widget-order",children:[a.jsx("button",{className:"bldr-order-btn",onClick:()=>V(M.id,-1),disabled:Be===0,"aria-label":"Move up",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M18 15l-6-6-6 6"})})}),a.jsx("span",{className:"bldr-order-num",children:Be+1}),a.jsx("button",{className:"bldr-order-btn",onClick:()=>V(M.id,1),disabled:Be===B.length-1,"aria-label":"Move down",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M6 9l6 6 6-6"})})})]}),a.jsx("button",{className:`bldr-toggle${A?" on":""}`,onClick:()=>I(M.id),"aria-label":A?`Remove ${M.label}`:`Add ${M.label}`,children:a.jsx("div",{className:"bldr-toggle-thumb"})})]})]},M.id)})})]}),a.jsxs("div",{className:"bldr-save-wrap",children:[a.jsx("button",{className:`bldr-save-btn${de?" saved":""}`,onClick:D,disabled:W||de,children:W?"Saving...":de?"Saved":"Save Dashboard"}),ve&&a.jsx("p",{className:"bldr-save-error",children:ve}),de&&a.jsx("button",{className:"bldr-view-btn",onClick:()=>s("/client/core-buddy"),children:"View Dashboard"})]})]}),a.jsx(Ri,{active:"home"})]})})}const vT="@firebase/installations",hv="0.6.19";const bT=1e4,wT=`w:${hv}`,_T="FIS_v2",nL="https://firebaseinstallations.googleapis.com/v1",sL=3600*1e3,rL="installations",iL="Installations";const aL={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Fo=new Ho(rL,iL,aL);function xT(s){return s instanceof ui&&s.code.includes("request-failed")}function ET({projectId:s}){return`${nL}/projects/${s}/installations`}function TT(s){return{token:s.token,requestStatus:2,expiresIn:lL(s.expiresIn),creationTime:Date.now()}}async function kT(s,e){const i=(await e.json()).error;return Fo.create("request-failed",{requestName:s,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function ST({apiKey:s}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s})}function oL(s,{refreshToken:e}){const t=ST(s);return t.append("Authorization",cL(e)),t}async function jT(s){const e=await s();return e.status>=500&&e.status<600?s():e}function lL(s){return Number(s.replace("s","000"))}function cL(s){return`${_T} ${s}`}async function uL({appConfig:s,heartbeatServiceProvider:e},{fid:t}){const i=ET(s),l=ST(s),u=e.getImmediate({optional:!0});if(u){const y=await u.getHeartbeatsHeader();y&&l.append("x-firebase-client",y)}const h={fid:t,authVersion:_T,appId:s.appId,sdkVersion:wT},p={method:"POST",headers:l,body:JSON.stringify(h)},g=await jT(()=>fetch(i,p));if(g.ok){const y=await g.json();return{fid:y.fid||t,registrationStatus:2,refreshToken:y.refreshToken,authToken:TT(y.authToken)}}else throw await kT("Create Installation",g)}function CT(s){return new Promise(e=>{setTimeout(e,s)})}function hL(s){return btoa(String.fromCharCode(...s)).replace(/\+/g,"-").replace(/\//g,"_")}const dL=/^[cdef][\w-]{21}$/,Hg="";function fL(){try{const s=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(s),s[0]=112+s[0]%16;const t=mL(s);return dL.test(t)?t:Hg}catch{return Hg}}function mL(s){return hL(s).substr(0,22)}function Sf(s){return`${s.appName}!${s.appId}`}const NT=new Map;function AT(s,e){const t=Sf(s);RT(t,e),pL(t,e)}function RT(s,e){const t=NT.get(s);if(t)for(const i of t)i(e)}function pL(s,e){const t=gL();t&&t.postMessage({key:s,fid:e}),yL()}let Ro=null;function gL(){return!Ro&&"BroadcastChannel"in self&&(Ro=new BroadcastChannel("[Firebase] FID Change"),Ro.onmessage=s=>{RT(s.data.key,s.data.fid)}),Ro}function yL(){NT.size===0&&Ro&&(Ro.close(),Ro=null)}const vL="firebase-installations-database",bL=1,qo="firebase-installations-store";let rg=null;function dv(){return rg||(rg=ef(vL,bL,{upgrade:(s,e)=>{e===0&&s.createObjectStore(qo)}})),rg}async function Qd(s,e){const t=Sf(s),l=(await dv()).transaction(qo,"readwrite"),u=l.objectStore(qo),h=await u.get(t);return await u.put(e,t),await l.done,(!h||h.fid!==e.fid)&&AT(s,e.fid),e}async function IT(s){const e=Sf(s),i=(await dv()).transaction(qo,"readwrite");await i.objectStore(qo).delete(e),await i.done}async function jf(s,e){const t=Sf(s),l=(await dv()).transaction(qo,"readwrite"),u=l.objectStore(qo),h=await u.get(t),p=e(h);return p===void 0?await u.delete(t):await u.put(p,t),await l.done,p&&(!h||h.fid!==p.fid)&&AT(s,p.fid),p}async function fv(s){let e;const t=await jf(s.appConfig,i=>{const l=wL(i),u=_L(s,l);return e=u.registrationPromise,u.installationEntry});return t.fid===Hg?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function wL(s){const e=s||{fid:fL(),registrationStatus:0};return DT(e)}function _L(s,e){if(e.registrationStatus===0){if(!navigator.onLine){const l=Promise.reject(Fo.create("app-offline"));return{installationEntry:e,registrationPromise:l}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=xL(s,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:EL(s)}:{installationEntry:e}}async function xL(s,e){try{const t=await uL(s,e);return Qd(s.appConfig,t)}catch(t){throw xT(t)&&t.customData.serverCode===409?await IT(s.appConfig):await Qd(s.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function EL(s){let e=await Xw(s.appConfig);for(;e.registrationStatus===1;)await CT(100),e=await Xw(s.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:i}=await fv(s);return i||t}return e}function Xw(s){return jf(s,e=>{if(!e)throw Fo.create("installation-not-found");return DT(e)})}function DT(s){return TL(s)?{fid:s.fid,registrationStatus:0}:s}function TL(s){return s.registrationStatus===1&&s.registrationTime+bT<Date.now()}async function kL({appConfig:s,heartbeatServiceProvider:e},t){const i=SL(s,t),l=oL(s,t),u=e.getImmediate({optional:!0});if(u){const y=await u.getHeartbeatsHeader();y&&l.append("x-firebase-client",y)}const h={installation:{sdkVersion:wT,appId:s.appId}},p={method:"POST",headers:l,body:JSON.stringify(h)},g=await jT(()=>fetch(i,p));if(g.ok){const y=await g.json();return TT(y)}else throw await kT("Generate Auth Token",g)}function SL(s,{fid:e}){return`${ET(s)}/${e}/authTokens:generate`}async function mv(s,e=!1){let t;const i=await jf(s.appConfig,u=>{if(!MT(u))throw Fo.create("not-registered");const h=u.authToken;if(!e&&NL(h))return u;if(h.requestStatus===1)return t=jL(s,e),u;{if(!navigator.onLine)throw Fo.create("app-offline");const p=RL(u);return t=CL(s,p),p}});return t?await t:i.authToken}async function jL(s,e){let t=await Jw(s.appConfig);for(;t.authToken.requestStatus===1;)await CT(100),t=await Jw(s.appConfig);const i=t.authToken;return i.requestStatus===0?mv(s,e):i}function Jw(s){return jf(s,e=>{if(!MT(e))throw Fo.create("not-registered");const t=e.authToken;return IL(t)?{...e,authToken:{requestStatus:0}}:e})}async function CL(s,e){try{const t=await kL(s,e),i={...e,authToken:t};return await Qd(s.appConfig,i),t}catch(t){if(xT(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await IT(s.appConfig);else{const i={...e,authToken:{requestStatus:0}};await Qd(s.appConfig,i)}throw t}}function MT(s){return s!==void 0&&s.registrationStatus===2}function NL(s){return s.requestStatus===2&&!AL(s)}function AL(s){const e=Date.now();return e<s.creationTime||s.creationTime+s.expiresIn<e+sL}function RL(s){const e={requestStatus:1,requestTime:Date.now()};return{...s,authToken:e}}function IL(s){return s.requestStatus===1&&s.requestTime+bT<Date.now()}async function DL(s){const e=s,{installationEntry:t,registrationPromise:i}=await fv(e);return i?i.catch(console.error):mv(e).catch(console.error),t.fid}async function ML(s,e=!1){const t=s;return await LL(t),(await mv(t,e)).token}async function LL(s){const{registrationPromise:e}=await fv(s);e&&await e}function OL(s){if(!s||!s.options)throw ig("App Configuration");if(!s.name)throw ig("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!s.options[t])throw ig(t);return{appName:s.name,projectId:s.options.projectId,apiKey:s.options.apiKey,appId:s.options.appId}}function ig(s){return Fo.create("missing-app-config-values",{valueName:s})}const LT="installations",PL="installations-internal",VL=s=>{const e=s.getProvider("app").getImmediate(),t=OL(e),i=$o(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},UL=s=>{const e=s.getProvider("app").getImmediate(),t=$o(e,LT).getImmediate();return{getId:()=>DL(t),getToken:l=>ML(t,l)}};function BL(){ai(new Yr(LT,VL,"PUBLIC")),ai(new Yr(PL,UL,"PRIVATE"))}BL();pr(vT,hv);pr(vT,hv,"esm2020");const zL="/firebase-messaging-sw.js",FL="/firebase-cloud-messaging-push-scope",OT="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",qL="https://fcmregistrations.googleapis.com/v1",PT="google.c.a.c_id",HL="google.c.a.c_l",$L="google.c.a.ts",WL="google.c.a.e",Zw=1e4;var e_;(function(s){s[s.DATA_MESSAGE=1]="DATA_MESSAGE",s[s.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(e_||(e_={}));var xu;(function(s){s.PUSH_RECEIVED="push-received",s.NOTIFICATION_CLICKED="notification-clicked"})(xu||(xu={}));function Xi(s){const e=new Uint8Array(s);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function GL(s){const e="=".repeat((4-s.length%4)%4),t=(s+e).replace(/\-/g,"+").replace(/_/g,"/"),i=atob(t),l=new Uint8Array(i.length);for(let u=0;u<i.length;++u)l[u]=i.charCodeAt(u);return l}const ag="fcm_token_details_db",KL=5,t_="fcm_token_object_Store";async function YL(s){if("databases"in indexedDB&&!(await indexedDB.databases()).map(u=>u.name).includes(ag))return null;let e=null;return(await ef(ag,KL,{upgrade:async(i,l,u,h)=>{if(l<2||!i.objectStoreNames.contains(t_))return;const p=h.objectStore(t_),g=await p.index("fcmSenderId").get(s);if(await p.clear(),!!g){if(l===2){const y=g;if(!y.auth||!y.p256dh||!y.endpoint)return;e={token:y.fcmToken,createTime:y.createTime??Date.now(),subscriptionOptions:{auth:y.auth,p256dh:y.p256dh,endpoint:y.endpoint,swScope:y.swScope,vapidKey:typeof y.vapidKey=="string"?y.vapidKey:Xi(y.vapidKey)}}}else if(l===3){const y=g;e={token:y.fcmToken,createTime:y.createTime,subscriptionOptions:{auth:Xi(y.auth),p256dh:Xi(y.p256dh),endpoint:y.endpoint,swScope:y.swScope,vapidKey:Xi(y.vapidKey)}}}else if(l===4){const y=g;e={token:y.fcmToken,createTime:y.createTime,subscriptionOptions:{auth:Xi(y.auth),p256dh:Xi(y.p256dh),endpoint:y.endpoint,swScope:y.swScope,vapidKey:Xi(y.vapidKey)}}}}}})).close(),await Dp(ag),await Dp("fcm_vapid_details_db"),await Dp("undefined"),QL(e)?e:null}function QL(s){if(!s||!s.subscriptionOptions)return!1;const{subscriptionOptions:e}=s;return typeof s.createTime=="number"&&s.createTime>0&&typeof s.token=="string"&&s.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}const XL="firebase-messaging-database",JL=1,Eu="firebase-messaging-store";let og=null;function VT(){return og||(og=ef(XL,JL,{upgrade:(s,e)=>{e===0&&s.createObjectStore(Eu)}})),og}async function ZL(s){const e=UT(s),i=await(await VT()).transaction(Eu).objectStore(Eu).get(e);if(i)return i;{const l=await YL(s.appConfig.senderId);if(l)return await pv(s,l),l}}async function pv(s,e){const t=UT(s),l=(await VT()).transaction(Eu,"readwrite");return await l.objectStore(Eu).put(e,t),await l.done,e}function UT({appConfig:s}){return s.appId}const e5={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},sr=new Ho("messaging","Messaging",e5);async function t5(s,e){const t=await yv(s),i=BT(e),l={method:"POST",headers:t,body:JSON.stringify(i)};let u;try{u=await(await fetch(gv(s.appConfig),l)).json()}catch(h){throw sr.create("token-subscribe-failed",{errorInfo:h?.toString()})}if(u.error){const h=u.error.message;throw sr.create("token-subscribe-failed",{errorInfo:h})}if(!u.token)throw sr.create("token-subscribe-no-token");return u.token}async function n5(s,e){const t=await yv(s),i=BT(e.subscriptionOptions),l={method:"PATCH",headers:t,body:JSON.stringify(i)};let u;try{u=await(await fetch(`${gv(s.appConfig)}/${e.token}`,l)).json()}catch(h){throw sr.create("token-update-failed",{errorInfo:h?.toString()})}if(u.error){const h=u.error.message;throw sr.create("token-update-failed",{errorInfo:h})}if(!u.token)throw sr.create("token-update-no-token");return u.token}async function s5(s,e){const i={method:"DELETE",headers:await yv(s)};try{const u=await(await fetch(`${gv(s.appConfig)}/${e}`,i)).json();if(u.error){const h=u.error.message;throw sr.create("token-unsubscribe-failed",{errorInfo:h})}}catch(l){throw sr.create("token-unsubscribe-failed",{errorInfo:l?.toString()})}}function gv({projectId:s}){return`${qL}/projects/${s}/registrations`}async function yv({appConfig:s,installations:e}){const t=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}function BT({p256dh:s,auth:e,endpoint:t,vapidKey:i}){const l={web:{endpoint:t,auth:e,p256dh:s}};return i!==OT&&(l.web.applicationPubKey=i),l}const r5=10080*60*1e3;async function i5(s){const e=await o5(s.swRegistration,s.vapidKey),t={vapidKey:s.vapidKey,swScope:s.swRegistration.scope,endpoint:e.endpoint,auth:Xi(e.getKey("auth")),p256dh:Xi(e.getKey("p256dh"))},i=await ZL(s.firebaseDependencies);if(i){if(l5(i.subscriptionOptions,t))return Date.now()>=i.createTime+r5?a5(s,{token:i.token,createTime:Date.now(),subscriptionOptions:t}):i.token;try{await s5(s.firebaseDependencies,i.token)}catch(l){console.warn(l)}return n_(s.firebaseDependencies,t)}else return n_(s.firebaseDependencies,t)}async function a5(s,e){try{const t=await n5(s.firebaseDependencies,e),i={...e,token:t,createTime:Date.now()};return await pv(s.firebaseDependencies,i),t}catch(t){throw t}}async function n_(s,e){const i={token:await t5(s,e),createTime:Date.now(),subscriptionOptions:e};return await pv(s,i),i.token}async function o5(s,e){const t=await s.pushManager.getSubscription();return t||s.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:GL(e)})}function l5(s,e){const t=e.vapidKey===s.vapidKey,i=e.endpoint===s.endpoint,l=e.auth===s.auth,u=e.p256dh===s.p256dh;return t&&i&&l&&u}function s_(s){const e={from:s.from,collapseKey:s.collapse_key,messageId:s.fcmMessageId};return c5(e,s),u5(e,s),h5(e,s),e}function c5(s,e){if(!e.notification)return;s.notification={};const t=e.notification.title;t&&(s.notification.title=t);const i=e.notification.body;i&&(s.notification.body=i);const l=e.notification.image;l&&(s.notification.image=l);const u=e.notification.icon;u&&(s.notification.icon=u)}function u5(s,e){e.data&&(s.data=e.data)}function h5(s,e){if(!e.fcmOptions&&!e.notification?.click_action)return;s.fcmOptions={};const t=e.fcmOptions?.link??e.notification?.click_action;t&&(s.fcmOptions.link=t);const i=e.fcmOptions?.analytics_label;i&&(s.fcmOptions.analyticsLabel=i)}function d5(s){return typeof s=="object"&&!!s&&PT in s}function f5(s){if(!s||!s.options)throw lg("App Configuration Object");if(!s.name)throw lg("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=s;for(const i of e)if(!t[i])throw lg(i);return{appName:s.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function lg(s){return sr.create("missing-app-config-values",{valueName:s})}class m5{constructor(e,t,i){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const l=f5(e);this.firebaseDependencies={app:e,appConfig:l,installations:t,analyticsProvider:i}}_delete(){return Promise.resolve()}}async function p5(s){try{s.swRegistration=await navigator.serviceWorker.register(zL,{scope:FL}),s.swRegistration.update().catch(()=>{}),await g5(s.swRegistration)}catch(e){throw sr.create("failed-service-worker-registration",{browserErrorMessage:e?.message})}}async function g5(s){return new Promise((e,t)=>{const i=setTimeout(()=>t(new Error(`Service worker not registered after ${Zw} ms`)),Zw),l=s.installing||s.waiting;s.active?(clearTimeout(i),e()):l?l.onstatechange=u=>{u.target?.state==="activated"&&(l.onstatechange=null,clearTimeout(i),e())}:(clearTimeout(i),t(new Error("No incoming service worker found.")))})}async function y5(s,e){if(!e&&!s.swRegistration&&await p5(s),!(!e&&s.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw sr.create("invalid-sw-registration");s.swRegistration=e}}async function v5(s,e){e?s.vapidKey=e:s.vapidKey||(s.vapidKey=OT)}async function zT(s,e){if(!navigator)throw sr.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw sr.create("permission-blocked");return await v5(s,e?.vapidKey),await y5(s,e?.serviceWorkerRegistration),i5(s)}async function b5(s,e,t){const i=w5(e);(await s.firebaseDependencies.analyticsProvider.get()).logEvent(i,{message_id:t[PT],message_name:t[HL],message_time:t[$L],message_device_time:Math.floor(Date.now()/1e3)})}function w5(s){switch(s){case xu.NOTIFICATION_CLICKED:return"notification_open";case xu.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}async function _5(s,e){const t=e.data;if(!t.isFirebaseMessaging)return;s.onMessageHandler&&t.messageType===xu.PUSH_RECEIVED&&(typeof s.onMessageHandler=="function"?s.onMessageHandler(s_(t)):s.onMessageHandler.next(s_(t)));const i=t.data;d5(i)&&i[WL]==="1"&&await b5(s,t.messageType,i)}const r_="@firebase/messaging",i_="0.12.23";const x5=s=>{const e=new m5(s.getProvider("app").getImmediate(),s.getProvider("installations-internal").getImmediate(),s.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>_5(e,t)),e},E5=s=>{const e=s.getProvider("messaging").getImmediate();return{getToken:i=>zT(e,i)}};function T5(){ai(new Yr("messaging",x5,"PUBLIC")),ai(new Yr("messaging-internal",E5,"PRIVATE")),pr(r_,i_),pr(r_,i_,"esm2020")}async function k5(){try{await M_()}catch{return!1}return typeof window<"u"&&D_()&&SC()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function S5(s=ju()){return k5().then(e=>{if(!e)throw sr.create("unsupported-browser")},e=>{throw sr.create("indexed-db-unsupported")}),$o(pn(s),"messaging").getImmediate()}async function j5(s,e){return s=pn(s),zT(s,e)}T5();const C5="BNVNdqAPfJYhKBjF9qd-YPEMYIbecZLWiOGUF5tOBfNuv6P1iXgJS6IoS9dHLM5gp-WMrExfir0pCpkMzOdTWKY";let cg=null;function N5(){if(!cg)try{cg=S5(ju())}catch{return null}return cg}function $g(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window}function ug(){return"Notification"in window?Notification.permission:"denied"}async function A5(s){if(!$g())return null;try{if(await Notification.requestPermission()!=="granted")return null;const t=N5();if(!t)return console.error("Push: could not initialise Firebase Messaging"),null;const i=await navigator.serviceWorker.ready;let l=null;const u=3;for(let h=1;h<=u;h++){try{if(l=await j5(t,{vapidKey:C5,serviceWorkerRegistration:i}),l)break}catch(p){console.warn(`Push getToken attempt ${h}/${u} failed:`,p)}h<u&&await new Promise(p=>setTimeout(p,1500*h))}return l&&s&&await Zs(tt(Se,"clients",s),{fcmTokens:gM(l)}),l}catch(e){return console.error("Push permission request failed:",e),null}}async function R5(s,e){if(!(!e||!s))try{await Zs(tt(Se,"clients",s),{fcmTokens:yM(e)})}catch(t){console.error("Token revoke failed:",t)}}const I5=[{key:"buddy_request",label:"Buddy requests",desc:"When someone sends you a buddy request"},{key:"buddy_accept",label:"Buddy accepted",desc:"When your buddy request is accepted"},{key:"like",label:"Likes",desc:"When someone likes your post"},{key:"comment",label:"Comments",desc:"When someone comments on your post"},{key:"mention",label:"Mentions",desc:"When someone @mentions you"}];function D5(){const{currentUser:s,clientData:e,updateClientData:t,logout:i,loading:l}=hi(),{isDark:u,toggleTheme:h}=ao(),p=gr(),[g,y]=_.useState(!1),[b,E]=_.useState(null),[T,O]=_.useState(!1),[H,q]=_.useState("default"),[B,X]=_.useState({buddy_request:!0,buddy_accept:!0,like:!0,comment:!0,mention:!0}),[W,Y]=_.useState(null),de=_.useCallback((j,S="info")=>{Y({message:j,type:S}),setTimeout(()=>Y(null),4e3)},[]);_.useEffect(()=>{!l&&!s&&p("/")},[l,s,p]),_.useEffect(()=>{if(!e)return;const j=e.notificationPrefs;j&&X(I=>({...I,...j}));const S=e.fcmTokens||[];S.length>0&&(y(!0),E(S[S.length-1])),q(ug())},[e]);const xe=async()=>{if(e){if(!g&&ug()==="denied"){de("Notifications blocked  enable them in your browser/device settings, then try again","error");return}O(!0);try{if(g)b&&await R5(e.id,b),y(!1),E(null),t({fcmTokens:[]}),de("Push notifications disabled","info");else{if(!$g()){de("Push notifications are not supported on this device","error");return}const j=await A5(e.id),S=ug();q(S),j?(y(!0),E(j),t({fcmTokens:[...e.fcmTokens||[],j]}),de("Push notifications enabled!","success")):de(S==="denied"?"Notifications blocked  enable them in your browser/device settings":S==="granted"?"Permission granted but setup failed  try closing and reopening the app, then toggle again":"Could not enable notifications  please try again","error")}}catch(j){console.error("Push toggle failed:",j),de("Something went wrong  please try again","error")}finally{O(!1)}}},ve=async j=>{if(!e)return;const S={...B,[j]:!B[j]};X(S);try{await Zs(tt(Se,"clients",e.id),{notificationPrefs:S}),t({notificationPrefs:S})}catch(I){console.error("Failed to save pref:",I),X(V=>({...V,[j]:!V[j]})),de("Failed to save preference","error")}};return l||!e?a.jsx("div",{className:"cb-loading",children:a.jsx("div",{className:"cb-loading-spinner"})}):a.jsxs("div",{className:"cb-settings","data-theme":u?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Back",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M19 12H5"}),a.jsx("path",{d:"M12 19l-7-7 7-7"})]})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:h,"aria-label":"Toggle theme",children:u?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),a.jsx("button",{onClick:i,"aria-label":"Log out",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),a.jsxs("main",{className:"settings-main",children:[a.jsx("h1",{className:"settings-title",children:"Settings"}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),a.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),"Notifications"]}),a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Push notifications"}),a.jsx("span",{className:"settings-row-desc",children:H==="denied"?"Blocked in browser  update in your device/browser settings":"Receive notifications even when the app is closed"})]}),a.jsx("button",{className:`settings-toggle${g?" on":""}${T?" loading":""}`,onClick:xe,disabled:T,"aria-label":"Toggle push notifications",children:a.jsx("span",{className:"settings-toggle-knob"})})]}),!$g()&&a.jsx("p",{className:"settings-hint",children:"Push notifications aren't supported on this browser. Try using the app from your home screen."}),a.jsxs("div",{className:"settings-sub-section",children:[a.jsx("span",{className:"settings-sub-title",children:"Notify me about"}),I5.map(j=>a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:j.label}),a.jsx("span",{className:"settings-row-desc",children:j.desc})]}),a.jsx("button",{className:`settings-toggle${B[j.key]?" on":""}`,onClick:()=>ve(j.key),"aria-label":`Toggle ${j.label}`,children:a.jsx("span",{className:"settings-toggle-knob"})})]},j.key))]})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),"Account"]}),a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Dark mode"}),a.jsx("span",{className:"settings-row-desc",children:"Switch between light and dark themes"})]}),a.jsx("button",{className:`settings-toggle${u?" on":""}`,onClick:h,"aria-label":"Toggle dark mode",children:a.jsx("span",{className:"settings-toggle-knob"})})]}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Email"}),a.jsx("span",{className:"settings-row-desc",children:e?.email||""})]})}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Plan"}),a.jsx("span",{className:"settings-row-desc",style:{textTransform:"capitalize"},children:e?.tier||"free"})]})})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),"Support & Feedback"]}),a.jsxs("a",{href:"mailto:ross@mindcorefitness.com?subject=Core%20Buddy%20Bug%20Report",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Report a Bug"}),a.jsx("span",{className:"settings-row-desc",children:"Found something not working? Let us know"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]}),a.jsxs("a",{href:"mailto:ross@mindcorefitness.com?subject=Core%20Buddy%20Feature%20Request",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Request a Feature"}),a.jsx("span",{className:"settings-row-desc",children:"Have an idea to improve Core Buddy?"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]}),a.jsxs("a",{href:"mailto:ross@mindcorefitness.com?subject=Core%20Buddy%20Feedback",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"General Feedback"}),a.jsx("span",{className:"settings-row-desc",children:"We'd love to hear from you"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Contact Email"}),a.jsx("span",{className:"settings-row-desc",children:"ross@mindcorefitness.com"})]})})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),a.jsx("polyline",{points:"10 9 9 9 8 9"})]}),"Legal"]}),a.jsxs("a",{href:"/privacy-policy",target:"_blank",rel:"noopener noreferrer",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Privacy Policy"}),a.jsx("span",{className:"settings-row-desc",children:"How we collect, use, and protect your data"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a.jsx("polyline",{points:"15 3 21 3 21 9"}),a.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]}),a.jsxs("a",{href:"/terms",target:"_blank",rel:"noopener noreferrer",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Terms & Conditions"}),a.jsx("span",{className:"settings-row-desc",children:"Terms of use for Core Buddy"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a.jsx("polyline",{points:"15 3 21 3 21 9"}),a.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),"About"]}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Core Buddy"}),a.jsx("span",{className:"settings-row-desc",children:"Food. Habits. Move."})]})}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Version"}),a.jsx("span",{className:"settings-row-desc",children:"1.0.0"})]})}),a.jsxs("a",{href:"/core-buddy",target:"_blank",rel:"noopener noreferrer",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Visit Our Website"}),a.jsx("span",{className:"settings-row-desc",children:"mindcorefitness.com"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a.jsx("polyline",{points:"15 3 21 3 21 9"}),a.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]})]})]}),W&&a.jsx("div",{className:`settings-toast ${W.type}`,children:W.message}),a.jsx(Ri,{active:"home"})]})}const M5=_.lazy(()=>Gs(()=>import("./Dashboard-Didbj82H.js"),__vite__mapDeps([0,1,2]))),L5=_.lazy(()=>Gs(()=>import("./AddClient-CEURoo_P.js"),__vite__mapDeps([3,4]))),O5=_.lazy(()=>Gs(()=>import("./ClientDashboard-BtpjbWY3.js"),__vite__mapDeps([5,1,6]))),P5=_.lazy(()=>Gs(()=>import("./ClientForms-oTMOD_Kq.js"),__vite__mapDeps([7,8,6]))),V5=_.lazy(()=>Gs(()=>import("./ClientTools-DqdrkZjN.js"),__vite__mapDeps([9,10,6]))),U5=_.lazy(()=>Gs(()=>import("./MacroCalculator-BMs9SNTG.js"),__vite__mapDeps([11,10,6]))),B5=_.lazy(()=>Gs(()=>import("./ProteinSnacks-B9LW55bJ.js"),__vite__mapDeps([12,10,6]))),z5=_.lazy(()=>Gs(()=>import("./DailyMotivation-D8l-5pfD.js"),__vite__mapDeps([13,10,6]))),F5=_.lazy(()=>Gs(()=>import("./CircuitDashboard-B4AmunNQ.js"),__vite__mapDeps([14,15]))),q5=_.lazy(()=>Gs(()=>import("./CircuitBooking-CnZghVFB.js"),__vite__mapDeps([16,17,15]))),H5=_.lazy(()=>Gs(()=>import("./PersonalBests-Bz2lGqLf.js"),__vite__mapDeps([18,19,6]))),$5=_.lazy(()=>Gs(()=>import("./Leaderboard-wZmPc9si.js"),__vite__mapDeps([20,21]))),W5=_.lazy(()=>Gs(()=>import("./UpgradePage-B0DQ7ZRk.js"),__vite__mapDeps([22,23,24]))),G5=_.lazy(()=>Gs(()=>import("./SignUp-C5abbeWn.js"),[])),K5=_.lazy(()=>Gs(()=>import("./Onboarding-B8Lxhvqw.js"),__vite__mapDeps([25,23,26])));function Y5({children:s}){const{pathname:e}=Ii();return _.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),_.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),s}function Q5(){const s=gr();return _.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const t=e.replace("/login","")||"/";s(t,{replace:!0})}},[s]),null}function X5(){return a.jsx(q6,{children:a.jsx(F6,{children:a.jsx(K6,{children:a.jsxs(Jj,{basename:"/login",children:[a.jsx(Q5,{}),a.jsx(Y5,{children:a.jsx(_.Suspense,{fallback:a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"60vh"},children:a.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})}),children:a.jsxs(jj,{children:[a.jsx(In,{path:"/",element:a.jsx(X6,{})}),a.jsx(In,{path:"/dashboard",element:a.jsx(M5,{})}),a.jsx(In,{path:"/add-client",element:a.jsx(L5,{})}),a.jsx(In,{path:"/client",element:a.jsx(O5,{})}),a.jsx(In,{path:"/client/forms",element:a.jsx(P5,{})}),a.jsx(In,{path:"/client/tools",element:a.jsx(V5,{})}),a.jsx(In,{path:"/client/tools/macros",element:a.jsx(U5,{})}),a.jsx(In,{path:"/client/tools/snacks",element:a.jsx(B5,{})}),a.jsx(In,{path:"/client/tools/motivation",element:a.jsx(z5,{})}),a.jsx(In,{path:"/client/personal-bests",element:a.jsx(H5,{})}),a.jsx(In,{path:"/client/circuit",element:a.jsx(F5,{})}),a.jsx(In,{path:"/client/circuit/booking",element:a.jsx(q5,{})}),a.jsx(In,{path:"/client/core-buddy",element:a.jsx(s3,{})}),a.jsx(In,{path:"/client/core-buddy/nutrition",element:a.jsx(hd,{feature:"nutrition",children:a.jsx(a3,{})})}),a.jsx(In,{path:"/client/core-buddy/workouts",element:a.jsx(F3,{})}),a.jsx(In,{path:"/client/core-buddy/consistency",element:a.jsx(hd,{feature:"consistency",children:a.jsx(Q3,{})})}),a.jsx(In,{path:"/client/core-buddy/buddies",element:a.jsx(hd,{feature:"buddies",children:a.jsx(X3,{})})}),a.jsx(In,{path:"/client/core-buddy/builder",element:a.jsx(tL,{})}),a.jsx(In,{path:"/client/core-buddy/profile/:userId",element:a.jsx(Z3,{})}),a.jsx(In,{path:"/client/core-buddy/settings",element:a.jsx(D5,{})}),a.jsx(In,{path:"/client/leaderboard",element:a.jsx(hd,{feature:"leaderboard",children:a.jsx($5,{})})}),a.jsx(In,{path:"/signup",element:a.jsx(G5,{})}),a.jsx(In,{path:"/onboarding",element:a.jsx(K5,{})}),a.jsx(In,{path:"/upgrade",element:a.jsx(W5,{})}),a.jsx(In,{path:"*",element:a.jsx(b_,{to:"/",replace:!0})})]})})})]})})})})}jS.createRoot(document.getElementById("root")).render(a.jsx(_.StrictMode,{children:a.jsx(X5,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/login/sw.js").then(s=>{setInterval(()=>s.update(),3600*1e3)}).catch(s=>console.warn("SW registration failed:",s))});export{Z5 as A,fr as B,Ri as C,Xo as P,Gt as T,ri as a,jr as b,Mt as c,Se as d,tt as e,zA as f,Tn as g,WA as h,Os as i,a as j,mr as k,hi as l,ao as m,gr as n,wu as o,yT as p,Dn as q,_ as r,tO as s,J5 as t,Zs as u,nO as v,fn as w,Bu as x,Q6 as y,Y6 as z};
