import{r as l,l as ms,m as xs,n as ps,g as M,q as ce,c as S,d as N,w as re,k as js,e as Ce,j as e,p as gs,b as vs,a as fs,T as Ns,u as ys}from"./index-EBou5_Qe.js";const Fe={monday:{morning:{start:"06:15",end:"12:00"},afternoon:{start:"15:00",end:"20:00"}},tuesday:{morning:{start:"06:15",end:"12:00"},afternoon:{start:"15:00",end:"20:00"}},wednesday:{morning:{start:"06:15",end:"12:00"},afternoon:{start:"15:00",end:"20:00"}},thursday:{morning:{start:"06:15",end:"12:00"},afternoon:{start:"15:00",end:"20:00"}},friday:{morning:{start:"06:15",end:"12:00"},afternoon:{start:"12:00",end:"17:00"},defaultBlocked:!0}},ws=["monday","tuesday","wednesday","thursday","friday"],C=d=>{const i=d.getFullYear(),u=(d.getMonth()+1).toString().padStart(2,"0"),m=d.getDate().toString().padStart(2,"0");return`${i}-${u}-${m}`},De=d=>{const[i,u]=d.split(":").map(Number);return i*60+u},Z=(d,i)=>{const u=De(d)+i,m=Math.floor(u/60),D=u%60;return`${m.toString().padStart(2,"0")}:${D.toString().padStart(2,"0")}`},ks=d=>{const i=Fe[d];if(!i)return[];const u=[];if(i.morning){let m=i.morning.start;for(;m<i.morning.end;)u.push({time:m,period:"morning"}),m=Z(m,15)}if(i.afternoon){let m=i.afternoon.start;for(;m<i.afternoon.end;)u.push({time:m,period:"afternoon"}),m=Z(m,15)}return u},bs=d=>{const i=d.getDay();return i>=1&&i<=5},Ve=d=>{const i=d.getDay();return i===0||i===6?null:ws[i-1]},Ss=(d,i,u,m,D,q=null,F=[],E=[])=>{const V=Ve(d);if(!V)return!1;const y=C(d),j=Fe[V];if(D.some(r=>r.date===y))return!1;if(j.defaultBlocked){const r=Math.ceil(u/15);for(let g=0;g<r;g++){const v=Z(i,g*15);if(!E.some(f=>f.date===y&&f.time===v))return!1}}else{const r=Math.ceil(u/15);for(let g=0;g<r;g++){const v=Z(i,g*15);if(F.some(f=>f.date===y&&f.time===v))return!1}}const z=new Date,T=C(z);if(y<T)return!1;if(y===T){const r=`${z.getHours().toString().padStart(2,"0")}:${z.getMinutes().toString().padStart(2,"0")}`;if(i<r)return!1}const J=Z(i,u),A=j.morning&&i>=j.morning.start&&i<j.morning.end,Q=j.afternoon&&i>=j.afternoon.start&&i<j.afternoon.end,ee=j.morning&&J<=j.morning.end,se=j.afternoon&&J<=j.afternoon.end;if(A&&!ee||Q&&!se||!A&&!Q)return!1;for(const r of m){if(q&&r.id===q||r.date!==y)continue;const g=De(r.time),v=g+(r.duration||45),f=De(i),I=f+u;if(f<v&&I>g)return!1}return!0},Cs=(d,i,u,m,D=null,q=[],F=[])=>{const E=Ve(d);return E?ks(E).filter(y=>Ss(d,y.time,i,u,m,D,q,F)):[]};function Ms(){const[d,i]=l.useState([]),[u,m]=l.useState([]),[D,q]=l.useState([]),[F,E]=l.useState([]),[V,y]=l.useState([]),[j,z]=l.useState([]),[T,J]=l.useState(!0),[A,Q]=l.useState(null),[ee,se]=l.useState(!1),[r,g]=l.useState(null),[v,f]=l.useState(null),[I,te]=l.useState(null),[Le,de]=l.useState([]),[Me,Te]=l.useState(!1),[Qe,Xe]=l.useState([]),[X,he]=l.useState(null),[K,ue]=l.useState(0),[me,Ke]=l.useState(!1),Be=l.useRef(0),O=l.useRef(!1),[Re,G]=l.useState(null),[Y,xe]=l.useState(null),[U,Oe]=l.useState([]),[We,Ge]=l.useState(!1),[b,pe]=l.useState(null),[je,ge]=l.useState(null),[P,Ue]=l.useState([]),[L,ve]=l.useState(null),_e=l.useRef(null),{currentUser:fe,isClient:Ne,clientData:c,logout:Ze,loading:ye}=ms(),{isDark:$e,toggleTheme:Je}=xs(),w=ps(),ne=l.useCallback((s,t="info")=>{he({message:s,type:t}),setTimeout(()=>he(null),4e3)},[]),H=s=>{const t=s.currentTarget,o=t.querySelector(".ripple");o&&o.remove();const a=document.createElement("span"),h=Math.max(t.clientWidth,t.clientHeight),p=h/2,x=t.getBoundingClientRect();a.style.width=a.style.height=`${h}px`,a.style.left=`${s.clientX-x.left-p}px`,a.style.top=`${s.clientY-x.top-p}px`,a.classList.add("ripple"),t.appendChild(a),setTimeout(()=>a.remove(),600)};l.useEffect(()=>{const s=()=>window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,t=h=>{s()<=0&&(Be.current=h.touches[0].clientY,O.current=!1)},o=h=>{const p=s(),k=h.touches[0].clientY-Be.current;if(p>5||k<=0){O.current=!1,ue(0);return}k>20&&p<=0&&(O.current=!0,ue(Math.min((k-20)*.4,80)))},a=()=>{O.current&&K>60?(Ke(!0),setTimeout(()=>{window.location.reload()},300)):ue(0),O.current=!1};return document.addEventListener("touchstart",t,{passive:!0}),document.addEventListener("touchmove",o,{passive:!0}),document.addEventListener("touchend",a),()=>{document.removeEventListener("touchstart",t),document.removeEventListener("touchmove",o),document.removeEventListener("touchend",a)}},[K]);const es=(s,t)=>{const o=s.touches[0];s.currentTarget.dataset.startX=o.clientX,s.currentTarget.dataset.startY=o.clientY},ss=(s,t)=>{const o=s.touches[0],a=parseFloat(s.currentTarget.dataset.startX),h=parseFloat(s.currentTarget.dataset.startY),p=o.clientX-a,x=o.clientY-h;Math.abs(p)>Math.abs(x)&&Math.abs(p)>10&&(s.preventDefault(),p<-50?G(t):p>50&&G(null))};l.useEffect(()=>{!ye&&(!fe||!Ne)&&w("/")},[fe,Ne,ye,w]),l.useEffect(()=>{if(c){if(c.dailyQuote){const s=new Date().toISOString().split("T")[0];c.dailyQuote.date===s&&ge(c.dailyQuote)}qe()}},[c]),l.useEffect(()=>{if(!T&&c){const s=setTimeout(()=>Ge(!0),300);return()=>clearTimeout(s)}},[T,c]),l.useEffect(()=>{const s=()=>{const o=we();if(o.length===0){pe(null);return}const a=o[0],h=new Date,x=new Date(a.date+"T"+a.time)-h;if(x<=0){pe(null);return}const k=Math.floor(x/(1e3*60*60*24)),Se=Math.floor(x%(1e3*60*60*24)/(1e3*60*60)),le=Math.floor(x%(1e3*60*60)/(1e3*60)),oe=Math.floor(x%(1e3*60)/1e3);pe({days:k,hours:Se,minutes:le,seconds:oe,session:a})};s();const t=setInterval(s,1e3);return()=>clearInterval(t)},[d,T]);const qe=async()=>{try{const[s,t,o,a,h,p,x,k,Se]=await Promise.all([M(ce(S(N,"sessions"),re("clientId","==",c.id))),M(S(N,"sessions")),M(S(N,"holidays")),M(S(N,"blockedTimes")),M(S(N,"openedSlots")),M(ce(S(N,"rescheduleRequests"),re("clientId","==",c.id))),M(ce(S(N,"achievements"),re("clientId","==",c.id))),js(Ce(N,"clients",c.id)),M(ce(S(N,"sessionNotes"),re("clientId","==",c.id)))]),le=s.docs.map(n=>({id:n.id,...n.data()}));le.sort((n,$)=>n.date!==$.date?n.date.localeCompare($.date):n.time.localeCompare($.time)),i(le),m(t.docs.map(n=>({id:n.id,...n.data()}))),q(o.docs.map(n=>({id:n.id,...n.data()}))),E(a.docs.map(n=>({id:n.id,...n.data()}))),y(h.docs.map(n=>({id:n.id,...n.data()})));const oe=p.docs.map(n=>({id:n.id,...n.data()}));Xe(oe.filter(n=>n.status==="pending"));const hs=oe.filter(n=>{if(n.status==="pending"||!n.respondedAt)return!1;const $=n.respondedAt.toDate?n.respondedAt.toDate():new Date(n.respondedAt),_=new Date;return _.setDate(_.getDate()-7),$>_&&!n.dismissed});if(z(hs),!x.empty){const n=x.docs[0].data().badges||[];Oe(n)}const us=new Date().toISOString().split("T")[0];if(k.exists()){const n=k.data();n.dailyQuote&&n.dailyQuote.date===us?ge(n.dailyQuote):ge(null)}const He=Se.docs.map(n=>({id:n.id,...n.data()}));He.sort((n,$)=>{const _=n.createdAt?.toMillis?.()||0;return($.createdAt?.toMillis?.()||0)-_}),Ue(He)}catch(s){console.error("Error fetching data:",s)}J(!1)},B=s=>new Date(s).toLocaleDateString("en-GB",{weekday:"long",day:"numeric",month:"long"}),R=s=>{const[t,o]=s.split(":"),a=parseInt(t),h=a>=12?"pm":"am";return`${a>12?a-12:a===0?12:a}:${o}${h}`},Ee=s=>s?(s.toDate?s.toDate():new Date(s)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}):"-",ae=s=>{const t=new Date,o=C(t),a=`${t.getHours().toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}`;return s.date<o||s.date===o&&s.time<a},ze=s=>{const o=C(new Date);return s.date===o&&!ae(s)},ts=()=>d.filter(s=>ae(s)).length,we=()=>d.filter(s=>!ae(s)),Ae=s=>{xe({title:"Cancel Session?",message:`Cancel your session on ${B(s.date)} at ${R(s.time)}? This cannot be undone.`,onConfirm:async()=>{xe(null),Q(s.id),G(null);try{await vs(Ce(N,"sessions",s.id)),i(d.filter(t=>t.id!==s.id)),ne("Session cancelled","success")}catch(t){console.error("Error cancelling session:",t),ne("Failed to cancel session. Please try again.","error")}Q(null)},onCancel:()=>xe(null)})},ns=async()=>{try{await Ze(),w("/")}catch(s){console.error("Failed to log out:",s)}},ke=s=>Qe.some(t=>t.sessionId===s),Ie=s=>{g(s),f(null),te(null),de([]),se(!0)},ie=()=>{se(!1),g(null),f(null),te(null),de([])},as=()=>c.endDate?c.endDate.toDate?c.endDate.toDate():new Date(c.endDate):new Date,is=()=>{const s=[],t=new Date,o=as(),a=new Date(t);for(a.setDate(a.getDate()+1);a<=o;){if(bs(a)){const h=C(a);D.some(x=>x.date===h)||s.push(new Date(a))}a.setDate(a.getDate()+1)}return s},ls=s=>{f(s),te(null);const t=r?.duration||c.sessionDuration||45;let o=Cs(s,t,u,D,r?.id,F,V);r&&C(s)===r.date&&(o=o.filter(a=>a.time!==r.time)),de(o)},os=async()=>{if(!(!v||!I||!r)){Te(!0);try{await fs(S(N,"rescheduleRequests"),{sessionId:r.id,clientId:c.id,clientName:c.name,originalDate:r.date,originalTime:r.time,requestedDate:C(v),requestedTime:I,duration:r.duration,status:"pending",createdAt:Ns.now(),respondedAt:null,dismissed:!1}),ie(),ne("Reschedule request submitted! You'll be notified when your trainer responds.","success"),qe()}catch(s){console.error("Error submitting reschedule request:",s),ne("Failed to submit request. Please try again.","error")}Te(!1)}},cs=async s=>{try{await ys(Ce(N,"rescheduleRequests",s),{dismissed:!0}),z(j.filter(t=>t.id!==s))}catch(t){console.error("Error dismissing notification:",t)}},rs=()=>{const s=we();if(s.length===0)return null;const t=s[0],o=new Date,h=new Date(t.date+"T"+t.time)-o;if(h<=0)return null;const p=Math.floor(h/(1e3*60*60*24)),x=Math.floor(h%(1e3*60*60*24)/(1e3*60*60)),k=Math.floor(h%(1e3*60*60)/(1e3*60));return{days:p,hours:x,minutes:k,session:t}};if(ye||T)return e.jsxs("div",{className:"client-dashboard",children:[e.jsx("header",{className:"client-header",children:e.jsx("div",{className:"header-content",children:e.jsx("div",{className:"skeleton skeleton-logo"})})}),e.jsxs("main",{className:"client-main",children:[e.jsxs("div",{className:"skeleton-welcome",children:[e.jsx("div",{className:"skeleton skeleton-title"}),e.jsx("div",{className:"skeleton skeleton-btn-small"})]}),e.jsxs("div",{className:"skeleton-actions",children:[e.jsx("div",{className:"skeleton skeleton-btn"}),e.jsx("div",{className:"skeleton skeleton-btn"})]}),e.jsx("div",{className:"skeleton skeleton-card-large"}),e.jsx("div",{className:"skeleton skeleton-card-medium"}),e.jsx("div",{className:"skeleton skeleton-card-medium"})]})]});if(!fe||!Ne||!c)return null;const W=ts(),ds=c.totalSessions-W,be=we(),Ye=ee?is():[];rs();const Pe=c.totalSessions>0?W/c.totalSessions*100:0;return e.jsxs("div",{className:"client-dashboard",children:[K>0&&e.jsxs("div",{className:"pull-indicator",style:{height:K},children:[e.jsx("div",{className:`pull-spinner ${me?"spinning":""}`,children:me?"↻":"↓"}),e.jsx("span",{children:me?"Refreshing...":K>60?"Release to refresh":"Pull to refresh"})]}),e.jsx("header",{className:"client-header",children:e.jsxs("div",{className:"header-content",children:[e.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),e.jsx("div",{className:"header-actions"})]})}),e.jsxs("main",{className:"client-main page-transition-enter",children:[e.jsxs("div",{className:"welcome-section",children:[e.jsxs("h2",{children:["Welcome, ",c.name.split(" ")[0]]}),e.jsxs("div",{className:"welcome-actions",children:[e.jsx("button",{className:"theme-toggle",onClick:Je,"aria-label":$e?"Switch to light mode":"Switch to dark mode",children:$e?e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})}),e.jsx("button",{className:"logout-btn",onClick:ns,children:"Log Out"})]})]}),j.length>0&&e.jsx("div",{className:"notifications-section",children:j.map(s=>e.jsxs("div",{className:`notification ${s.status}`,children:[e.jsxs("div",{className:"notification-content",children:[e.jsx("span",{className:"notification-icon",children:s.status==="approved"?"✓":"✗"}),e.jsxs("div",{className:"notification-text",children:[e.jsx("strong",{children:s.status==="approved"?"Reschedule Approved!":"Reschedule Declined"}),e.jsx("p",{children:s.status==="approved"?`Your session has been moved to ${B(s.requestedDate)} at ${R(s.requestedTime)}`:`Your request to reschedule from ${B(s.originalDate)} was declined. Please contact your trainer.`})]})]}),e.jsx("button",{className:"dismiss-btn",onClick:()=>cs(s.id),children:"✕"})]},s.id))}),b&&e.jsxs("div",{className:"ring-timer-container",children:[e.jsxs("div",{className:"ring-timer",children:[e.jsx("svg",{className:"ring-timer-svg",viewBox:"0 0 200 200",children:gs.map((s,t)=>{const a=60-b.seconds,h=t<a;return e.jsx("line",{x1:s.x1,y1:s.y1,x2:s.x2,y2:s.y2,className:`ring-tick ${h?"elapsed":"remaining"}`,strokeWidth:s.thick?"3":"2"},t)})}),e.jsxs("div",{className:"ring-timer-center",children:[e.jsx("div",{className:"ring-timer-logo",children:e.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness"})}),e.jsxs("div",{className:"ring-timer-countdown",children:[b.days>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"timer-digit",children:String(b.days).padStart(2,"0")}),e.jsx("span",{className:"timer-colon",children:":"})]}),e.jsx("span",{className:"timer-digit",children:String(b.hours).padStart(2,"0")}),e.jsx("span",{className:"timer-colon",children:":"}),e.jsx("span",{className:"timer-digit",children:String(b.minutes).padStart(2,"0")}),e.jsx("span",{className:"timer-colon",children:":"}),e.jsx("span",{className:"timer-digit timer-seconds",children:String(b.seconds).padStart(2,"0")})]}),e.jsx("div",{className:"ring-timer-label",children:"until next session"})]})]}),e.jsxs("div",{className:"ring-timer-session-info",children:[B(b.session.date)," at ",R(b.session.time)]})]}),e.jsxs("div",{className:"block-info-card",children:[e.jsx("div",{className:"block-header-row",children:e.jsx("h3",{children:"Your Training Block"})}),e.jsxs("div",{className:"progress-section",children:[e.jsxs("div",{className:"progress-ring-container",children:[e.jsxs("svg",{className:"progress-ring",viewBox:"0 0 100 100",children:[e.jsx("circle",{className:"progress-ring-bg",cx:"50",cy:"50",r:"42",fill:"none",strokeWidth:"8"}),e.jsx("circle",{className:`progress-ring-fill ${We?"animate":""}`,cx:"50",cy:"50",r:"42",fill:"none",strokeWidth:"8",strokeDasharray:`${2*Math.PI*42}`,strokeDashoffset:We?`${2*Math.PI*42*(1-Pe/100)}`:`${2*Math.PI*42}`,strokeLinecap:"round"})]}),e.jsxs("div",{className:"progress-ring-text",children:[e.jsxs("span",{className:"progress-percent",children:[Math.round(Pe),"%"]}),e.jsx("span",{className:"progress-label",children:"complete"})]})]}),e.jsxs("div",{className:"progress-stats",children:[e.jsxs("div",{className:"progress-stat",children:[e.jsx("span",{className:"progress-stat-value",children:W}),e.jsx("span",{className:"progress-stat-label",children:"Completed"})]}),e.jsxs("div",{className:"progress-stat",children:[e.jsx("span",{className:"progress-stat-value",children:ds}),e.jsx("span",{className:"progress-stat-label",children:"Remaining"})]}),e.jsxs("div",{className:"progress-stat",children:[e.jsx("span",{className:"progress-stat-value",children:c.totalSessions}),e.jsx("span",{className:"progress-stat-label",children:"Total"})]})]})]}),e.jsxs("div",{className:"block-dates",children:[e.jsxs("div",{className:"date-item",children:[e.jsx("span",{className:"date-label",children:"Start Date"}),e.jsx("span",{className:"date-value",children:Ee(c.startDate)})]}),e.jsxs("div",{className:"date-item",children:[e.jsx("span",{className:"date-label",children:"End Date"}),e.jsx("span",{className:"date-value",children:Ee(c.endDate)})]}),e.jsxs("div",{className:"date-item",children:[e.jsx("span",{className:"date-label",children:"Session Duration"}),e.jsxs("span",{className:"date-value",children:[c.sessionDuration," minutes"]})]})]})]}),c?.coreBuddyAccess&&e.jsxs("div",{className:"core-buddy-cta",onClick:()=>w("/client/core-buddy"),children:[e.jsx("div",{className:"core-buddy-cta-icon",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"})})}),e.jsxs("div",{className:"core-buddy-cta-text",children:[e.jsx("span",{className:"core-buddy-cta-title",children:"Core Buddy"}),e.jsx("span",{className:"core-buddy-cta-sub",children:"Workouts, nutrition & habits"})]}),e.jsx("svg",{className:"core-buddy-cta-arrow",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})]}),P.length>0&&e.jsxs("div",{className:"session-notes-card",ref:_e,children:[e.jsxs("div",{className:"session-notes-header",children:[e.jsxs("div",{className:"session-notes-title",children:[e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",width:"18",height:"18",children:[e.jsx("path",{d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),e.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),e.jsx("span",{children:"Session Notes"})]}),e.jsx("span",{className:"session-notes-count",children:P.length})]}),e.jsx("div",{className:"session-notes-list",children:P.slice(0,L==="show-all"?void 0:3).map((s,t)=>e.jsxs("div",{className:`session-note-item ${L===s.id?"expanded":""}`,onClick:()=>ve(L===s.id?null:s.id),children:[e.jsxs("div",{className:"session-note-top",children:[e.jsx("span",{className:"session-note-date",children:s.date}),e.jsx("svg",{className:`session-note-chevron ${L===s.id?"open":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",width:"16",height:"16",children:e.jsx("path",{d:"M6 9l6 6 6-6"})})]}),s.sessionNotes&&e.jsx("p",{className:"session-note-preview",children:L===s.id?s.sessionNotes:s.sessionNotes.length>80?s.sessionNotes.slice(0,80)+"...":s.sessionNotes}),L===s.id&&e.jsxs("div",{className:"session-note-details",children:[s.whatWentWell&&e.jsxs("div",{className:"session-note-section went-well",children:[e.jsx("span",{className:"session-note-label",children:"What Went Well"}),e.jsx("p",{children:s.whatWentWell})]}),s.whatWentWrong&&e.jsxs("div",{className:"session-note-section went-wrong",children:[e.jsx("span",{className:"session-note-label",children:"What Went Wrong"}),e.jsx("p",{children:s.whatWentWrong})]}),s.whatsNext&&e.jsxs("div",{className:"session-note-section whats-next",children:[e.jsx("span",{className:"session-note-label",children:"What's Next"}),e.jsx("p",{children:s.whatsNext})]})]})]},s.id))}),P.length>3&&L===null&&e.jsxs("button",{className:"session-notes-viewall",onClick:()=>ve("show-all"),children:["View all ",P.length," notes",e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"16",height:"16",children:e.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})]}),L==="show-all"&&P.length>3&&e.jsxs("button",{className:"session-notes-viewall",onClick:()=>ve(null),children:["Show less",e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"16",height:"16",style:{transform:"rotate(180deg)"},children:e.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})]})]}),U.length>0&&e.jsxs("div",{className:"achievements-card",children:[e.jsxs("div",{className:"achievements-card-header",children:[e.jsxs("div",{className:"achievements-card-title",children:[e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),e.jsx("span",{children:"Targets Achieved"})]}),e.jsx("span",{className:"achievements-card-count",children:U.length})]}),e.jsx("div",{className:"achievements-card-list",children:[...U].reverse().slice(0,3).map((s,t)=>e.jsxs("div",{className:"achievements-card-item",children:[e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),e.jsx("span",{className:"achievements-card-label",children:s.label}),e.jsx("span",{className:"achievements-card-date",children:s.achievedMonth})]},t))}),U.length>3&&e.jsxs("button",{className:"achievements-card-viewall",onClick:()=>w("/client/personal-bests"),children:["View all ",U.length," achievements",e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})]})]}),je?e.jsxs("div",{className:"daily-quote-card",children:[e.jsx("div",{className:"daily-quote-icon",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M6 17h3l2-4V7H5v6h3zm8 0h3l2-4V7h-6v6h3z"})})}),e.jsxs("div",{className:"daily-quote-content",children:[e.jsx("div",{className:"daily-quote-label",children:"Daily Motivation"}),e.jsx("div",{className:"daily-quote-text",children:je.text}),e.jsxs("div",{className:"daily-quote-author",children:["— ",je.author]}),e.jsxs("div",{className:"daily-quote-lock",children:[e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"12",height:"12",children:e.jsx("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1v2z"})}),"New quote at midnight"]})]})]}):e.jsxs("div",{className:"daily-quote-cta",onClick:()=>w("/client/tools/motivation"),children:[e.jsx("div",{className:"daily-quote-cta-icon",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:e.jsx("path",{d:"M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"})})}),e.jsxs("div",{className:"daily-quote-cta-text",children:[e.jsx("span",{className:"daily-quote-cta-title",children:"Daily Motivation"}),e.jsx("span",{className:"daily-quote-cta-sub",children:"Tap to get today's inspiration"})]}),e.jsx("svg",{className:"daily-quote-cta-arrow",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})]}),e.jsxs("div",{className:"sessions-section",children:[e.jsxs("h3",{children:["Upcoming Sessions (",be.length,")"]}),be.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-state-icon",children:e.jsxs("svg",{viewBox:"0 0 100 100",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("rect",{x:"20",y:"15",width:"60",height:"70",rx:"4"}),e.jsx("line",{x1:"20",y1:"35",x2:"80",y2:"35"}),e.jsx("line",{x1:"35",y1:"15",x2:"35",y2:"35"}),e.jsx("line",{x1:"65",y1:"15",x2:"65",y2:"35"}),e.jsx("circle",{cx:"40",cy:"55",r:"4",fill:"currentColor",opacity:"0.3"}),e.jsx("circle",{cx:"60",cy:"55",r:"4",fill:"currentColor",opacity:"0.3"}),e.jsx("circle",{cx:"40",cy:"70",r:"4",fill:"currentColor",opacity:"0.3"}),e.jsx("circle",{cx:"60",cy:"70",r:"4",fill:"currentColor",opacity:"0.3"})]})}),e.jsx("h4",{children:"No upcoming sessions"}),e.jsx("p",{children:"Contact your trainer to book sessions"})]}):e.jsx("div",{className:"sessions-list",children:be.map(s=>e.jsxs("div",{className:`session-card-wrapper ${Re===s.id?"swiped":""}`,onTouchStart:t=>es(t,s.id),onTouchMove:t=>ss(t,s.id),children:[e.jsxs("div",{className:"session-card-swipe-actions",children:[e.jsx("button",{className:"swipe-action-btn reschedule ripple-btn",onClick:t=>{H(t),G(null),Ie(s)},disabled:ke(s.id),children:"Reschedule"}),e.jsx("button",{className:"swipe-action-btn cancel ripple-btn",onClick:t=>{H(t),Ae(s)},disabled:A===s.id,children:"Cancel"})]}),e.jsxs("div",{className:`session-card ${ze(s)?"today-session":""}`,onClick:()=>Re===s.id&&G(null),children:[e.jsxs("div",{className:"session-info",children:[e.jsxs("div",{className:"session-date",children:[ze(s)&&e.jsx("span",{className:"today-label",children:"Today - "}),B(s.date)]}),e.jsxs("div",{className:"session-time",children:[R(s.time)," (",s.duration," min)"]}),ke(s.id)&&e.jsx("div",{className:"pending-badge",children:"Reschedule pending"})]}),e.jsxs("div",{className:"session-actions",children:[e.jsx("button",{className:"reschedule-btn ripple-btn",onClick:t=>{t.stopPropagation(),H(t),Ie(s)},disabled:ke(s.id),children:"Reschedule"}),e.jsx("button",{className:"cancel-btn ripple-btn",onClick:t=>{t.stopPropagation(),H(t),Ae(s)},disabled:A===s.id,children:A===s.id?"Cancelling...":"Cancel"})]}),e.jsxs("div",{className:"swipe-hint",children:[e.jsx("span",{className:"swipe-hint-text",children:"Swipe"}),e.jsxs("span",{className:"swipe-hint-chevrons",children:[e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})}),e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})}),e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})]})]})]})]},s.id))})]}),e.jsxs("div",{className:"completed-section",children:[e.jsxs("h3",{children:["Completed Sessions (",W,")"]}),W===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-state-icon",children:e.jsxs("svg",{viewBox:"0 0 100 100",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"50",cy:"50",r:"35"}),e.jsx("path",{d:"M35 50 L45 60 L65 40",strokeLinecap:"round",strokeLinejoin:"round",opacity:"0.3"}),e.jsx("path",{d:"M50 25 L50 50 L65 55",strokeLinecap:"round",strokeLinejoin:"round"})]})}),e.jsx("h4",{children:"No completed sessions yet"}),e.jsx("p",{children:"Your completed sessions will appear here"})]}):e.jsxs("div",{className:"sessions-list completed",children:[d.filter(s=>ae(s)).slice(-5).reverse().map(s=>e.jsxs("div",{className:"session-card completed",children:[e.jsxs("div",{className:"session-info",children:[e.jsx("div",{className:"session-date",children:B(s.date)}),e.jsx("div",{className:"session-time",children:R(s.time)})]}),e.jsx("span",{className:"completed-badge",children:"Completed"})]},s.id)),W>5&&e.jsxs("div",{className:"more-sessions",children:["And ",W-5," more completed sessions"]})]})]})]}),ee&&r&&e.jsx("div",{className:"modal-overlay",onClick:ie,children:e.jsxs("div",{className:"reschedule-modal",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"Reschedule Session"}),e.jsx("button",{className:"close-modal-btn",onClick:ie,children:"✕"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("div",{className:"current-session-info",children:e.jsxs("p",{children:["Current: ",e.jsx("strong",{children:B(r.date)})," at ",e.jsx("strong",{children:R(r.time)})]})}),e.jsxs("div",{className:"date-selection",children:[e.jsx("h4",{children:"Select New Date"}),Ye.length===0?e.jsx("p",{className:"no-dates",children:"No available dates within your training block"}):e.jsx("div",{className:"dates-grid",children:Ye.map((s,t)=>e.jsxs("button",{className:`date-btn ${v&&C(v)===C(s)?"selected":""}`,onClick:()=>ls(s),children:[e.jsx("span",{className:"date-day",children:s.toLocaleDateString("en-GB",{weekday:"short"})}),e.jsx("span",{className:"date-num",children:s.getDate()}),e.jsx("span",{className:"date-month",children:s.toLocaleDateString("en-GB",{month:"short"})})]},t))})]}),v&&e.jsxs("div",{className:"time-selection",children:[e.jsx("h4",{children:"Select Time"}),Le.length===0?e.jsx("p",{className:"no-slots",children:"No available slots on this date"}):e.jsx("div",{className:"times-grid",children:Le.map((s,t)=>e.jsx("button",{className:`time-btn ${I===s.time?"selected":""} ${s.period}`,onClick:()=>te(s.time),children:R(s.time)},t))})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"cancel-modal-btn",onClick:ie,children:"Cancel"}),e.jsx("button",{className:"submit-reschedule-btn",onClick:os,disabled:!v||!I||Me,children:Me?"Submitting...":"Request Reschedule"})]})]})}),X&&e.jsxs("div",{className:`toast-notification ${X.type}`,children:[e.jsx("span",{className:"toast-icon",children:X.type==="success"?e.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):X.type==="error"?e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),e.jsx("span",{className:"toast-message",children:X.message}),e.jsx("button",{className:"toast-close",onClick:()=>he(null),children:"✕"})]}),Y&&e.jsx("div",{className:"confirm-modal-overlay",onClick:Y.onCancel,children:e.jsxs("div",{className:"confirm-modal",onClick:s=>s.stopPropagation(),children:[e.jsx("h3",{children:Y.title}),e.jsx("p",{children:Y.message}),e.jsxs("div",{className:"confirm-modal-actions",children:[e.jsx("button",{className:"confirm-cancel-btn ripple-btn",onClick:s=>{H(s),Y.onCancel()},children:"Keep Session"}),e.jsx("button",{className:"confirm-btn ripple-btn",onClick:s=>{H(s),Y.onConfirm()},children:"Yes, Cancel"})]})]})}),e.jsxs("nav",{className:"block-bottom-nav",children:[e.jsxs("button",{className:"block-nav-tab active",children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),e.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),e.jsx("span",{children:"Home"})]}),e.jsxs("button",{className:"block-nav-tab",onClick:()=>w("/client/forms"),children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),e.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),e.jsx("span",{children:"Forms"})]}),e.jsxs("button",{className:"block-nav-tab",onClick:()=>w("/client/tools"),children:[e.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),e.jsx("span",{children:"Tools"})]}),e.jsxs("button",{className:"block-nav-tab",onClick:()=>w("/client/personal-bests"),children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12 20V10"}),e.jsx("path",{d:"M18 20V4"}),e.jsx("path",{d:"M6 20v-4"})]}),e.jsx("span",{children:"PBs"})]}),c?.circuitAccess&&e.jsxs("button",{className:"block-nav-tab",onClick:()=>w("/client/circuit"),children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M12 6v6l4 2"})]}),e.jsx("span",{children:"Circuit"})]})]})]})}export{Ms as default};
